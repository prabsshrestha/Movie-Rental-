{"version":3,"file":"kendo.spreadsheet.min.js","names":["global","factory","exports","module","require","define","amd","globalThis","self","kendospreadsheet","js","this","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","$","window","LRUCache","Class","size","_size","_length","_map","put","key","value","map","entry","_head","_tail","newer","older","get","REPLACE_REGEX","normalizeText","text","String","replace","objectKey","object","parts","sort","join","hashKey","str","hash","i","charCodeAt","defaultMeasureBox","DEFAULT_OPTIONS","baselineMarkerSize","document","createElement","style","cssText","TextMetrics","_cache","measure","width","height","baseline","cacheKey","cachedResult","measureBox","box","baselineMarker","_baselineMarker","cloneNode","textStr","textContent","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","marker","current","measureText","jQuery","now","Date","getTime","renderPos","pos","result","toHyphens","split","renderSize","sqr","romanToArabic","r","toLowerCase","digits","v","x","l","c","d","m","prev","charAt","arabicToRoman","n","literals","values","roman","shift","memoize","f","cache","Object","create","id","arguments","apply","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","withExit","obj","Return","ex","RegExp","STRING","fromCharCode","ENTITIES","amp","lt","gt","quot","apos","nbsp","CODE","out","UCS2","code","START_CDATA","END_CDATA","END_COMMENT","START_COMMENT","END_SHORT_TAG","END_TAG","END_DECLARATION","QUESTION_MARK","LESS_THAN","GREATER_THAN","SEMICOLON","EQUAL","AMPERSAND","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","EXIT","parse$2","data","callbacks","index","is","selector","j","$tag","exit","readChar","croak","msg","Error","readWhile","pred","a","readAsciiWhile","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlTag","name","attrs","xmlName","xmlAttrs","xmlComment","xmlEntity","xmlContent","pop","xmlString","quote","parseInt","isNaN","undefined","what","thing","arg1","arg2","tmp","parseXML","COMMAND_TYPES","Command","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","select","exec","setState","getState","state","rejectState","validationState","title","message","reason","type","_forEachCell","callback","_ref","forEach","ref","sheet","toRangeRef","bind","usesImage","DrawingUpdateCommand","_sheet","_drawing","drawing","_orig","clone","_previous","previous","reset","_activeDrawing","triggerChange","layout","img","image","DrawingCommand","InsertImageCommand","_blob","blob","_width","_height","aspect","Math","min","addDrawing","topLeftCell","topLeft","offsetX","offsetY","opacity","addImage","removeDrawing","DeleteDrawingCommand","ReorderDrawingsCommand","_origIndex","_drawings","indexOf","splice","_newIndex","_reorder","drawings","BringToFrontCommand","SendToBackCommand","TargetValueCommand","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_prevUnderline","underline","_hasSetValue","GridLinesChangeCommand","showGridLines","PropertyChangeCommand","prototype","skipHiddenCells","enable","ClearContentCommand","rowValues","nullValues","currentRange","canEditArrayFormula","refs","concat","row","changeType","clearContent","_getValidationState","cell","EditCommand","_editRange","arrayFormula","activeCellSelection","withCultureDecimals","_exec","editRange","input","wrap","_adjustRowHeight","calc","ParseError","InsertCommentCommand","TextWrapCommand","forEachRow","_rowHeight","AdjustDecimalsCommand","_delta","delta","formatting","batch","forEachCell","col","format","adjustDecimals","BorderChangeCommand","_type","border","_style","color","_batch","noBorders","insideBorders","outsideBorders","allBorders","leftBorder","leftColumn","borderLeft","rightBorder","rightColumn","borderRight","topBorder","topRow","borderTop","bottomBorder","bottomRow","borderBottom","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","recalc","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","parse","_event","event","_clipboardContent","_content","activeSheet","selection","pasteRef","_targetRangeRefs","UnionRef","status","canPaste","menuInvoked","pasteOnMerged","pasteOnDisabled","preventDefault","clipboardContent","_processPaste","_adjustPasteTarget","multipliers","sourceRows","sourceCols","refToSelect","rangeToSelect","multiplier","that","targetRangeRefs","RangeRef","cols","b","topLeftA","topLeftB","sourceData","_targetRanges","bottomRight","_rows","_count","_columns","resize","max","_populateTargetRange","_targetRangeDimensions","targetRangeRows","targetRangeCols","rowsMultiplier","colsMultiplier","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","support","paste","_view","focus","execCommand","CutCommand","_eventType","currentRow","canCopy","multiSelection","cut","copy","CopyCommand","noop","ToolbarCopyCommand","AutoFillCommand","origin","_origin","autoFillData","intersectingArrayFormula","_previewFillFrom","props","dest","_properties","Range","FillError","ToolbarCutCommand","cannotUndo","FilterCommand","filter","hasFilter","SortCommand","column","ascending","expandRange","cantSort","_sheetRef","ApplyFilterCommand","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","element","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","DeleteCommand","_expandedRange","_expand","_indexes","_undoOne","_restoreModifiedFormulas","formulas","isValue","DeleteRowCommand","left","Infinity","right","deleteSelectedRows","insertRow","DeleteColumnCommand","top","bottom","deleteSelectedColumns","insertColumn","AddCommand","_pos","count","base","AddColumnCommand","addColumnLeft","addColumnRight","deleteColumn","AddRowCommand","addRowAbove","addRowBelow","deleteRow","EditValidationCommand","validation","OpenCommand","match","fromFile","then","errors","excelImportErrors","openDialog","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","NameCommand","_name","nameDefinition","DefineNameCommand","defineName","DeleteNameCommand","undefineName","FormulaBar","ui","Widget","addClass","classNames","wrapper","icon","prependTo","formulaBarWidth","formulaInput","FormulaInput","appendTo","messages","destroy","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","formulaInputTitle","attr","css","autoScale","on","scale","_highlightedRefs","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","_paste","filterOperator","scalePadding","minLength","removeAttr","toggleClass","getPos","div","sel","getSelection","lookup","focusNode","focusOffset","anchorNode","anchorOffset","begin","end","collapsed","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","setPos","eiv","createRange","setStart","setEnd","getRangeAt","startOffset","endOffset","startContainer","endContainer","removeAllRanges","addRange","len","el","home","runtime","FUNCS","toUpperCase","formulaSource","DataSource","listId","guid","list","StaticList","listWrapper","insertAfter","aria","role","itemRole","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","template","e","tokenCtx","_tokenContext","_mute","activeToken","token","completion","ctx","nextToken","_replaceAt","popup","close","formulaInputEl","Popup","anchor","open","ev","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_sync","_focusTimeout","browser","msie","clipboardData","getData","originalEvent","val","substr","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","point","tok","tokens","tokenize","touches","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","field","operator","hide","rectangle","canInsertRef","isKeyboardAction","_canInsertRef","strictMode","canReplace","afterPoint","canInsertBetween","isOpenParen","refAtPoint","simplify","relative","isMerged","setSheet","print","newValue","rest","syncWith","iehandler","eventName","handler","off","horizontalBorders","context","html","outerHeight","innerText","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","isMatchingParen","reverse","htmlEncode","substring","insertNewline","eof","Mac","navigator","platform","EventListener","observer","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","touchProxy","touch","threshold","_pressLocation","documentElement","altKey","handleEvent","isAlphaNum","rightClick","which","button","pageX","y","pageY","dx","dy","sqrt","eventKey","mod","metaKey","ctrlKey","shiftKey","catchAllHandler","RangeTreeNode","level","NilNode","skew","temp","insert","start","remove","diff","heir","intersects","RangeTree","root","findrange","intersecting","ranges","tree","first","last","RangeList","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","Iterator","toJSON","fromJSON","unique","at","SparseRangeList","_defaultValue","lastRangeStart","ValueRange","Property","set","dst","JsonProperty","JSON","stringify","ValueProperty","formats","dateToNumber","culture","calendar","patterns","limitPrecision","cloneFormulaValue","deepClone","cloneFormulaTree","PropertyBag","specs","sortable","serializable","depends","rowCount","columnCount","defaultValues","cellCount","properties","lists","spec","formula","_resize","new_rows","new_cols","old_rows","cell_count","scaleIndex","scaleNode","si","prop","iter","iterators","reduce","ret","hBorders","leftBorders","rightBorders","addBorder","forEachProperty","ALL_PROPERTIES","spreadsheet$8","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","isFinite","Ref$4","hasSheet","_hasSheet","absolute","adjust","toString","intersect","NULL$1","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","r1","r2","CellRef$5","RangeRef$4","UnionRef$3","single","refs1","refs2","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","valid","renameSheet","oldSheetName","newSheetName","display","NameRef$3","trow","tcol","abs","arow","acol","forRow","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","limit","num","move","tr","u","empty","theRef","newRefs","NULLREF","SHEETREF","FIRSTREF","Ref","NameRef","CellRef","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","lower","further","bottomLeft","topRight","EdgeNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","SheetNavigator","autoFillCalculator","colEdge","columnRange","rowEdge","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","selectDrawingForContextMenu","modifySelection","action","scrollInto","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","nextUntil","makeWordMovement","prevUntil","newSelection","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","selTopLeft","selBottomRight","isFirstCell","isLastCell","setSelection","currentNavigationRange","done","navigatedAway","singleCellSelection","focusNextElement","nextNavigationRange","find","previousNavigationRange","shouldSkip","extendSelection","resizeAutoFill","isHiddenRow","isHiddenColumn","forEachMergedCell","merged","hint","_autoFillOrigin","punch","preview","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","isCol","firstVal","advanced","hidden","AxisManager","forEachSelectedColumn","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","indexes","_saveModifiedFormulas","hideColumn","hasRight","hasLeft","hideRow","hasBottom","hasTop","unhideColumn","unhideRow","selectedRows","Clipboard","_externalContent","_internalContent","iframe","className","setAttribute","_uid","intersectsMerged","origRef","plain","destination","originActiveCell","rowDelta","colDelta","external","isExternal","_isInternal","newState","setStateData","ri","ci","parseTSV","doc","contentWindow","write","table","querySelector","richState","Matrix","vBorders","td","rowSpan","colSpan","getAttribute","ignoreColspan","cellState","mergedCells","dr","dc","parseHTML","rowData","colData","internalHTML","internalPlain","foreign","stripStyle","getComputedStyle","borders","borderObject","fontSize","background","textAlign","verticalAlign","txtElem","italic","bold","PROPERTIES","skipHiddenRows","skipHiddenCols","_normalize","partition","_set","noTrigger","topLeftRef","_get","_resizedRef","existingFormat","compile","existingFormatType","currency","editorChange","isInEditMode","OUT","t1","numberToDate","_useCultureDecimals","numberFormat","_","__","setArrayFormulaRange","_forFormulas","arrayFormulaRange","intersection","_validation","_merge","mergedRef","vi","isAutofill","setProp","propName","propValue","isFilteredRow","includes","clearAll","contentsOnly","formatOnly","keepBorders","clearFormat","isSortable","mc","_getMergedCells","primary","secondary","cant","hasMerged","_sortBy","isFilterable","clearFilters","_filterBy","_filter","intersectingMerged","propertyName","Formula","Validation","internalClipboard","externalClipboard","sum","textHeight","getTextHeight","fontFamily","hasValue","defStyle","_defaultCellStyle","flag","draw","predicate","each","calc$4","spreadsheet$7","exports$3","Class$1","Ref$3","CellRef$4","RangeRef$3","UnionRef$2","NULL","CalcError$2","Context","ss","parent","resolve","resolveCells","_resolve","error","isArray","asMatrix","maybeRoundFloatErrors","_arrayArg","onFormula","add","getRefCells","pending","cellValues","wantNulls","getRefData","Matrix$1","fetchName","nameValue","Formula$1","ValidationFormulaContext","force","func","fname","args","bool","line","h","isRange","Number","hiddenInfo","getNA","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","t","inverse","augment","imax","argmax","printer","absrefs","onReady","forceRefs","lcsheet","parentContext","next","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","prevRefs","newRef","sameRef","prevRange","constructor","DEFER_INIT","compileArgumentChecks","functionName","forced","arrayArgs","main","haveForced","canBeArrayArg","hasArrayArgs","comp","cond","allowError","typeCheck","Function","limitPrecision$1","forceNum","round","err","toPrecision","withErrorHandling","loadDeferred","deferInit","cb","defineFunction$2","log","console","check","doit","xargs","arrays","kendoSpreadsheetArgs","argsAsync","makeCallback","dateToJulianDays","co","th","comatrix","thmatrix","elmatrix","BASE_DATE","DAYS_IN_MONTH","ORDINAL_ADD_DAYS","isLeapYear$1","yr","daysInMonth$2","mo","unpackDate$2","serial","jd","year","month","date","day","ord","packDate$2","MS_IN_MIN","MS_IN_HOUR","MS_IN_DAY","unpackTime","frac","ms","hours","minutes","seconds","milliseconds","serialToDate","packTime","hh","mm","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","CalcError","packDate","unpackDate","daysInMonth","validDate","da","isLeapYear","daysInYear","parseDate","makeDateFormat","parseExactDate","defineFunction","defineAlias","alias","orig","kendoSpreadsheetAliases","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","equals","binaryCompare","pow","$$2","spreadsheet$6","exports$2","calc$3","DATE_FORMAT","from","to","dataType","comparerType","allowNulls","fromIsDateValue","toIsDateValue","showButton","fromIsListValue","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","from_value","to_value","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","_getListData","cube","array","_getOptions","compareValue","compareFormat","getValue","calculateFromCallBack","prevFrom","prevTo","validationHandler","parseFormula","validationComparers","custom","valueToCompare","toValue","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","MODIFIED_FORMULAS","Selection","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","triggerSelect","pane","_currentView","Sheet","_reinit","headerHeight","headerWidth","defaultCellStyle","Axis","_filteredRows","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","newRows","newCols","oldRows","oldCols","_resizeAddRow","_resizeAddColumn","_resizeDeleteRow","_resizeDeleteColumn","_resizeForJSON","colCount","_selectionState","_inEdit","_navigator","_axisManager","_sheetName","accessor","_field","suspendChanges","_valueChanged","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","wb","sheetByName","cellRefIndex","_adjustReferences","_sheets","_forValidations","adjustNames","skipDataSourceInsert","nextRef","isEnabledRow","skipDataSourceDelete","isEnabledColumn","_filterRow","gridLinesColor","numRows","numColumns","parseReference","cellRef","forEachFilterHeader","columnRef","forEachRange","doIt","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","draggingInProgress","_draggingInProgress","completeResizing","hintPosition","resizeHintPosition","handlePosition","resizeHandlePosition","_visualRange","_renderComment","comment","_commentRef","_resizeHandlePosition","location","_resizeHintPosition","overElement","removeResizeHandle","positionResizeHandle","startDragging","completeDragging","drag","drawingBoundingBox","indexVisible","refBox","refBoundingBox","dragging","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","selectedHeaders","allCols","allRows","maxRow","maxCol","rowState","colState","rowSelection","colSelection","all","isInEdit","_setFormulaSelections","_viewActiveCell","positions","viewSelection","hyperlinks","clearDefaultStyle","src","parseColor","toCss","json","_sort","_compileFormula","_compileValidation","Drawing","activeCellRef","Filter","_refreshFilter","logToConsole","_refresh","resetFormulas","resetValidations","revalidate","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","useCultureDecimals","dot","withDecimalSeparator","Rectangle","drw","outerWidth","_outerWidth","DOT","EMPTYCHAR","SheetsBar","sheetsBarWrapper","_openDialog","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","sheetsBarRemove","_onSheetRemove","_onSheetSelect","sheetsBarActive","_createEditor","sheetsBarAdd","_onAddSelect","scrollable","distance","_editor","_renderSheets","_selectedIndex","sheetsBarEditor","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","sheetsBarScrollable","sheetsBarSheetsWrapper","_toggleScrollButtons","ul","_sheetsGroup","scrollLeft","sheetsBarPrev","sheetsBarNext","scrollWidth","scrollPrevButton","scrollNextButton","sheetsWrapper","stopPropagation","_nowScrollingSheets","_scrollSheetsByDelta","renderScrollButtons","idx","sheetElements","isSelectedSheet","sheetsBarKItem","elementContent","sheetsBarKActive","sheetsBarInactive","sheetsBarKTextbox","maxlength","sheetsBarKLink","deleteIcon","sheetsBarXIcon","itemsWrapper","childrenElements","sheetsBarKReset","baseButtonClass","sheetsBarKButton","sheetsBarKButtonBare","ariaHidden","sheetsBarArrowWIcon","iconClass","sheetsBarArrowEIcon","children","sheetsBarItems","Sortable","container","animation","ignore","draggable","sheetsBarHintWrapper","sheetsBarKResetItems","closest","oldIndex","newIndex","removedSheetName","closeCallback","sender","isConfirmed","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","sheetsBarKButtonDefaults","sheetsBarPlusIcon","item","itemPosition","sheetsGroup","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","finish","animate","scrLeft","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKSprite","ops","util$2","spreadsheet$5","Ref$2","RangeRef$2","CellRef$3","NameRef$2","exports$1","runtime$4","OPERATORS_STANDARD","OPERATORS_COMMA","op","OPERATORS","SEPARATORS","DEC","ARG","COL","setDecimalSeparator","sep","_separators","TRUE","FALSE","getcol","getrow","TokenStream$1","ast","parseExpression","addReference","allowEOF","peek","commas","maybeBinary","exp","parseAtom","parseFuncall","parseArray","upper","maybePercent","my_prec","his_prec","makeClosure","toCPS","GENSYM","cps","makeContinuation","cpsNameRef","cpsAtom","cpsRef","cpsUnary","cpsBinary","thenK","gensym","elseK","vars","cpsIf","cpsAnd","cpsOr","cpsFunc","cont","cpsLambda","cpsMatrix","elements","isMatrix","FORMULA_CACHE","makeFormula","prec","withParens","parenthesize","arg","needParens","makePrinter","jsArray","identity","ahead","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","parseFloat","symbol","space","getRC","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","readNext","forEditor","EOF","RawTokenStream","InputStream","fixCell","addPos","startToken","endToken","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","g","escaped","rx","forward","FORMAT_PARSERS","registerFormatParser","p","parseNameDefinition","def","nameRef","defAST","noThrow","stream","parseSqref","monthFirst","comma","rxnum","NUMBER_FORMAT_RX","getNumberRegexp","rxcur","suffix","has_currency","has_percent","repeat","$$1","MAP_EXCEL_OPERATOR","greaterThanOrEqual","lessThanOrEqual","ERROR_LOG","SEL_CELL","SEL_COL","SEL_DEFINED_NAME","SEL_FORMULA","SEL_MERGE","SEL_PANE","SEL_ROW","SEL_SELECTION","SEL_SHEET","SEL_STRING","SEL_TEXT","SEL_SHARED_STRING","SEL_VALUE","SEL_VIEW","SEL_SHEET_VIEW","SEL_HYPERLINK","SEL_PROTECTION","SEL_VALIDATION","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA2","SEL_VALIDATION_INSANE","SEL_VALIDATION_SQREF_INSANE","SEL_VALIDATION_FORMULA1_INSANE","SEL_VALIDATION_FORMULA2_INSANE","SEL_COMMENT","SEL_AUTHOR","SEL_COMMENT_TEXT","xl","file","async","readWorkbook","zip","progress","strings","readStrings","relationships","readRelationships","theme","readTheme","byType","readStyles","items","parse$1","enter","tag","relId","byId","dim","bytes","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","sheetDimensions","activeTab","integer","vbProcedure","localSheetId","withErrorLog","loading","Deferred","notify","recalcSheets","ready","insertSheet","promise","queueSheet","loadSheets","deferred","readSheet","pts","formulaRange","isArrayFormula","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","sharedFormulas","nCols","prevCellRef","relsFile","filters","deferredStyles","closed","percent","styleIndex","sty","stop","ht","acRef","xSplit","ySplit","addAutoFilter","colId","and","ourOp","equal","notEqual","getFilterVal","getCustomFilter","DynamicFilter","dynamicFilterType","TopFilter","blank","leave","sqref","showErrorMessage","allowBlank","showDropDown","errorTitle","logic","criteria","blanks","xf","inlineStyles","xfId","namedStyles","shouldSet","setBorder","setFont","fonts","indent","setFill","fills","setFormat","numFmts","DEFAULT_FORMATS","protection","locked","formatCode","side","BORDER_WIDTHS","up","down","applyName","applyStyle","comments","commentFile","relative_file","author","authors","authorId","readComments","drawingFile","cdr","sel_two_cell_anchor","sel_ext","sel_one_cell_anchor","sel_from","sel_to","sel_row","sel_col","sel_row_offset","sel_col_offset","sel_blip","relkeys","getContentType","getFileName","edge","Blob","File","excelToPixels","cx","cy","colOffset","rowOffset","brCell","brX","brY","readDrawings","filename","jpg","jpeg","png","gif","wmf","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","Promise","Id","Target","Type","entries","names","promises","SEL_BORDER","SEL_FILL","SEL_FONT","SEL_INLINE_STYLE","SEL_NAMED_STYLE","SEL_NUM_FMT","INDEXED_COLORS","toCSSColor","font","fill","getXf","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","addBool","getColor","defaultThemeColor","rgb","indexed","themeColor","colorScheme","tint","toHSL","toCssRgba","patternType","diagonalUp","diagonalDown","diagonal","horizontal","vertical","wrapText","SEL_SCHEME_RGBCLR","SEL_SCHEME_SYSCLR","scheme","swap","arr","part","readExcel","reader","FileReader","onload","JSZip","loadAsync","readAsArrayBuffer","_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","defaultSheetName","Workbook","_images","_imgID","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","_names","unbind","_sheetChanging","_sheetChange","_sheetInsertRow","_sheetInsertColumn","_sheetDeleteRow","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetDataBinding","_sheetDataBound","_sheetProgress","_sheetCommandRequest","_inputForRef","execute","commandOptions","cleanupImages","refresh","moveSheetToIndex","toIndex","fromIndex","sheetSelection","sheetName","insertIndex","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","sheetByIndex","forEachName","nameref","removeSheet","newSheet","_clearSheets","images","url","sheetParamsFromJSON","localName","saveJSON","ids","readAsDataURL","reject","excel","xhr","XMLHttpRequest","response","getResponseHeader","onerror","responseType","send","ooxml","saveOptions","proxyURL","forceProxy","toDataURLAsync","saveAs","dataURI","toBlob","group","nameForRef","imageUrl","URL","createObjectURL","revokeObjectURL","or","PDFMixin","_drawPDF","exportPDF","exportPDFToBlob","proxyTarget","fail","area","spreadsheet$4","CellRef$2","RangeRef$1","UnionRef$1","NameRef$1","Ref$1","fsheet","frow","fcol","states","_displayString","arrayRange","tlRow","tlCol","vrow","vcol","_formulaContextRefresh","alphaNumRegExp","ACTIONS","pageup","pagedown","ENTRY_ACTIONS","tab","delete","backspace","CONTAINER_EVENTS","wheel","contextmenu","mousemove","CLIPBOARD_EVENTS","mouseup","EDITOR_EVENTS","esc","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","rowheader","columnheader","topcorner","autofill","toActionSelector","selectors","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","drawingContextMenu","scroller","tabstrip","sheetsbar","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","onMouseDown","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","editorClose","_preventNavigation","deactivate","showError","activateEditor","_lastEditorValue","_activeTooltip","activeSheetName","clientHeight","isEditorDisabled","resetEditorValue","scroll","onWheel","deltaX","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","casual","onShiftAction","appendSelection","onMouseMove","objectAt","originFrame","_startResizingDrawing","win","widgetInstance","modal","startBox","onEditorEsc","openCustomEditor","_selectionMode","openFilterMenu","handle","translateCoords","startX","startY","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","_dragDrawing","onMouseDrag","clientX","clientY","selectToLocation","frame","scrollTop","startAutoScroll","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","clipBoardValue","_pasteImage","Image","onPaste","files","hasHTML","hasPlainText","DOMStringList","types","kind","getAsFile","onCopy","scrollRight","getBoundingClientRect","noDrawing","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","_saveEditorValue","onEditorArrayFormula","onEditorBarFocus","rect","activeCellRectangle","onEditorCellFocus","onEditorBlur","isFiltered","onEditorAction","_casualEditing","deactivateEditor","onEditorShiftAction","additionalOptions","pdfExport","excelExport","viewClassNames","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonSelected","horizontalResize","verticalResize","iconFilterDefault","sheetsBar","cellBorder","asURL","drawCell","collection","showGrid","maybeLink","textDecoration","href","shouldDraw","dBorders","defaultBorder","toHSV","outline","fontStyle","fontWeight","overflowWrap","wordWrap","__dataType","applyIndent","paneClassNames","nameBox","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","insertRowBelowLastRow","insertColAfterLastCol","tabs","menus","bringToFront","sendToBack","HtmlTable","trs","addColumn","addRow","addCell","Node","toDomTree","offset","ContextMenu","within","View","_chrome","_dialogs","append","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","contextMenuConfig","showOn","enableClipboard","isClipboardDeactivated","actionBar","formulaBar","parents","_outerHeight","tabstripHeight","formulaBarHeight","sheetsBarHeight","quickAccessAdjust","NameEditor","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","_headerWidth","frozen","locate","w","RESIZE_HANDLE_WIDTH","isRowResizer","_headerHeight","isFilterIcon","theGrid","filterIconRect","isAutoFill","isEditButton","activeCellCustomEditor","_editorInLastColumn","drawingAt","drx","dry","clientWidth","paneAt","selecting","containingPane","refreshTools","totalHeight","totalWidth","_pane","_destroyFilterMenu","FilterMenu","_filterMenu","selectClipboardContents","selectNodeContents","selectElementContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","edit","alignLeft","dialog","dialogs","reopenEditor","currentDialogs","errorMessages","hasOpenedError","focusButton","ESC","onClose","dlg","_retry","registered","dialogOptions","_filterMenuColumn","scrollbarSize","scrollbar","contentWidth","contentHeight","resizeDirection","toplevelElements","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","rangeDimensions","primaryMergedCells","secondaryMergedCells","backgroundColor","borderRightColor","borderBottomColor","sdval","sdnum","sibling","cellBefore","borderLeftColor","prevRow","cellAbove","borderTopColor","mergedCell","colspan","rowspan","vaxis","haxis","vborder","hborder","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","paneClasses","itemSelection","allHeaders","doLayout","forScreen","xCoords","borderColor","yCoords","Borders","activeCellRange","absRow","absCol","_activeFormulaColor","_directionClasses","vert","rendered","borderWidth","transform","horiz","renderDrawings","toDiv","backgroundImage","drawingResizeHandles","_start","_addDiv","iconName","filtered","classes","selections","selectionClasses","_renderCustomEditorButton","autoFillRectangle","cssClass","_axis","ed","btnClass","isLastColumn","_buttonOutOfVisiblePane","btn","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","EDITORS","registerEditor","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","setOptions","Calendar","fromValidation","toValidation","_rowAndColPresent","disableDates","kendoStaticList","getKendoStaticList","read","intersectsRect","total","PaneGrid","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","defaultValue","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startSegment","endSegment","lastPage","_pixelValues","startIndex","endIndex","nowCount","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","dayOfWeek","secondWeek","_values","_dates","_blanks","dates","_logic","_criteria","expression","Query","filterExpr","accentFoldingFiltering","_matches","criterionValue","criterionType","valueType","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","util$1","calc$2","RX_COLORS","RX_CONDITION","decimalPart","sections","haveConditional","sec","readSection","maybeColor","readFormat","maybeFraction","fraction","decimal","am","pm","maybeCondition","compileFormatPart","restart","hasDate","hasTime","hasAmpm","percentCount","scaleCount","separeThousands","declen","intFormat","decFormat","condition","preamble","checkComma","TEXT","runtime$3","section","found","fmt","padLeft","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","lastPart","shouldInsertMinus","iv","skipMinus","chf","formatDec","decimals","intpart","decpart","padRight","digNumber","span","textAndColor","adjusted","printToken","spreadsheet$3","calc$1","runtime$2","defineFunction$1","CalcError$1","CellRef$1","daysInMonth$1","packDate$1","unpackDate$1","daysInYear$1","_days_360$1","method","d1","d2","_days_360","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","PI","rad","deg","cos","sin","atan","tan","ceil","mult","numbers","prod","coef","seen","ARGS_COUNTIFS","m1","ARGS_SUMIFS","numericPredicate","ARGS_SUMIF","fetchSumRange","continuation","sumRange","_avg","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","nth","descending","res","discard","bins","asc","variance","stddev","ARGS_PERCENTRANK","_covariance","ax","ay","significance","_fact","fact","_combinations","f1","f2","p1","p2","_percentile","rank","_percentile_inc","_percentile_exc","AGGREGATE_FUNCS","fetchValuesForAggregate","fetchValues","_binom_dist","cumulative","weeksInYear","funcId","ignoreHidden","alpha","s2","a1","approx","resultCol","areanum","colRange","cmp","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","RX_NON_PRINTABLE","Hyperlink","dec","denomitator","string","noCommas","newText","oldText","valueIfError","RXCACHE","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","runtime$1","ll","ERF","ERFC","GAMMALN","GAMMA","GAMMA_DIST","GAMMA_INV","NORM_S_DIST","NORM_S_INV","NORM_DIST","NORM_INV","BETADIST","BETA_DIST","BETA_INV","chisq_left","chisq_right","chisq_left_inv","chisq_right_inv","ac","obsv","expect","eij","chisq_test","expon","poisson","Fdist","Fdist_right","Finv","Finv_right","Ftest","fisher","fisherinv","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","confidence_t","confidence_norm","gauss","phi","lognorm_dist","lognorm_inv","prob","slope","intercept","pearson","rsq","steyx","forecast","linest","logest","trend","growth","FV","PV","PMT","NPER","RATE","IPMT","PPMT","CUMPRINC","CUMIPMT","NPV","IRR","EFFECT","NOMINAL","XNPV","XIRR","ISPMT","DB","DDB","SLN","SYD","VDB","COUPS_ARGS","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","ACCRINTM","ACCRINT","DISC","INTRATE","RECEIVED","PRICE","PRICEDISC","MAX_IT","EPS","FP_MIN","f_abs","S","an","cof","ser","pi","BETALN","BETA","gamma_inc","ap","gln","g_series","aj","bj","g_contfrac","M","ab","q","plow","betastd_cdf","beta_lentz","m2","del","qab","qam","qap","betastd_inv","cdf","betastd_pdf","cds","lnf","_mean","me","_var_sq","arr1","arr2","n1","n2","va1","va2","e2","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","z","x_","p_","lw","y_","mx","my","b1","b2","whipNumberArrays","s1","s3","t2","_mat_mean","Mat","_mat_devsq","mean","sq","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","W","new_X","root_newton","guess","max_it","eps","f_d","rate","nper","pmt","pv","h1","fv","h2","per","ipmt","tn","ts","te","monthlyPayment","cip","flows","npv","npv1","nominal_rate","npery","effect_rate","cost","salvage","life","period","db","factor","prior","dep","no_switch","interest","_getGDA","gda","oldValue","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","frequency","settl","matur","mat","issue","par","year_days","brace","prev1","next1","nrc","accr","annual","_numCoupons","_borderCoupons_fw","pr","redemption","investment","discount","yld","N","beg_settl","settl_end","beg_end","den","yf","BORDER_TYPES","BORDER_TYPES_ICONS","BORDER_PALETTE_MESSAGES","borderPalette","colorPickerPalette","BorderPalette","_borderTypePalette","_borderColorPalette","colorChooser","class","kendoToggleButton","_toggle","FlatColorPicker","buttons","palette","_change","_apply","_cancel","siblings","checked","getDefaultToolElement","firstIconName","ToolBar","MESSAGES","alignment","alignmentButtons","justifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","formatTypes","automatic","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","insertComment","insertImage","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortButtons","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","defaultFormats","COLOR_PICKER_MESSAGES","colorPicker","customColor","cancel","toolDefaults","separator","extensions","overflow","togglable","component","overflowComponent","componentOptions","attributes","commandOn","toolIcon","clearButton","sample","itemTemplate","popupComponent","formatCells","selected","SpreadsheetToolBar","showText","tools","toolbarName","parentMessages","defaultTools","handleClick","_click","click","commandType","resizable","_tools","tool","isFunction","_updateTool","toArray","_getItem","enabled","label","toolbarEl","widget","menuItem","removeClass","_quickAccessButtons","toolbars","contentElements","_toolbar","contentElement","_tabIndex","quickAccessToolBar","hasOwnProperty","buttonTemplate","insertBefore","currentTarget","tabGroup","ObservableObject","retry","revert","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","confirmationDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","defaultFileName","xlsx","description","paper","a2","a3","a4","a5","b3","b4","b5","folio","legal","tabloid","executive","margin","normal","narrow","wide","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","center","modifyMergedDialog","errorMessage","rangeDisabledDialog","intersectsArrayDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","removeLink","insertCommentDialog","removeComment","insertImageDialog","info","typeError","registry","register","dialogClass","SpreadsheetDialog","translate","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","kendoWindow","_action","formattedValue","FormatCellsViewModel","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","_currency","iso","convert","categoryFilter","uniqueBy","inArray","pattern","abbr","FormatCellsDialog","defaultOptions","_generateFormats","currenciesFrom","numberFormats","dateFormats","calendarPatterns","viewModel","currencyFilter","roleSelector","MessageDialog","messageId","getter","ConfirmationDialog","confirm","_confirmed","ValidationErrorDialog","FontFamilyDialog","_list","defaultFont","default","fetch","FontSizeDialog","sizes","defaultSize","BordersDialog","_borderPalette","observable","ColorChooser","ColorPickerDialog","_colorPalette","colorPalette","kendoColorPalette","CustomColorDialog","one","_colorPicker","kendoFlatColorPicker","AlignmentDialog","dataItem","MergeDialog","FreezeDialog","ValidationViewModel","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","defaultComparers","text_comparers","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","update","fromValidationObject","useCustomMessages","toValidationObject","ValidationDialog","errorTemplate","validatable","Validator","validateOnBlur","validate","ExportAsDialog","fileFormats","autoPrint","subject","keywords","creator","fitWidth","areas","paperSizes","landscape","hCenter","vCenter","basicErrorDialog","ImportErrorDialog","UseKeyboardDialog","HyperlinkDialog","model","InsertCommentDialog","InsertImageDialog","okEnabled","hasImage","isHovered","_url","_image","stopEvent","drop","selectFile","dataTransfer","dragEnter","dragLeave","Localizable","path","trans","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetInsertRowHandler","fields","getters","normalizedRef","normalizedRefs","setValues","record","valueIndex","colValueIndex","currentValue","_skipRebind","_changeHandler","_progressHandler","_errorHandler","_requestStart","_error","_progress","getterIdx","details","detailsSummary","detailsContent","iconCollapseName","iconExpandName","iconSearchName","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","sortAscending","sortDescending","search","addToCurrent","operatorNone","operators","doesnotcontain","startswith","endswith","doesnotmatch","neq","gte","lte","Details","_summary","_icon","_container","fx","expand","binders","spreadsheetFilterValue","Binder","bindings","templates","query","hasVisibleChildren","HierarchicalDataSource","toLocaleLowerCase","itemVisible","anyVisibleChildren","filterSpread","uncheckAll","hasChildren","FilterMenuViewModel","valuesChange","valuesDataSource","appendToSearch","lastIndexOf","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","flattenOperators","FilterMenuController","valuesTree","distinctValues","filterType","filterForColumn","topValue","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","hasClass","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","barInput","cellInput","_triggerUpdate","activeElement","viewWidth","scrollerElement","scrollbarWidth","viewElement","_rect","noChange","inputType","oldRect","newRect","spreadsheet$1","ERR_INCOMPATIBLE","linearRegression","findSeries","getType","forEachSeries","findStep","lst","strl","findStringList","srcRange","destRange","srcIdx","fillFrom","CLASS_NAMES","comboBoxTitle","transport","success","comboElement","combo","kendoComboBox","ignoreCase","_on_listChange","noDataTemplate","getKendoComboBox","_on_keyDown","_on_focus","_deleteItem","_prevValue","CONT","kdrw","geo","geometry","GUIDELINE_WIDTH","distributeCoords","heights","pageHeight","maxEmpty","headerRows","headerCoords","curr","header","wholeRect","rowHeights","colWidths","relrow","relcol","rh","cw","nonEmpty","shouldDrawCell","emptyCells","pageWidth","scaleFactor","hyCoords","boxWidth","boxHeight","headerCells","orlast","orderCoords","orderCells","assign","sameBorder","drawLayout","ncols","nrows","addPage","endbottom","endright","isInside","page","Group","clip","Path","fromRect","Rect","multiplyCopy","moveTo","lineTo","stroke","guideColor","r2d2","boxSizing","lineHeight","padding","makeFontDef","createTextNode","vtrans","text_group","drawDOM","drawText","bordersGroup","paddingLeft","paddingRight","getPaperOptions","multiPage","Container","addVert","addHoriz","pb","CACHE_CHAR_WIDTH","charWidthFunction","widths","drawTabularData","headerBackground","headerColor","oddBackground","evenBackground","useGridFormat","defineFont","getFontFaces","charWidth","textWidth","mkCell","columnTitles","columnWidths","undefined$1","version","F11","I","U","H","A","DELETE","R","NS","Spreadsheet","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_keyDown","_showWatermarkOverlay","F10","_workbookChanging","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","_workbookExcelExport","_workbookExcelImport","_initProgress","kendoProgressBar","chunkCount","always","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","_workbookDataBinding","_workbookDataBound","_workbookProgress","plugin"],"sources":["kendo.spreadsheet.js"],"mappings":"CAAA,SAAWA,EAAQC,GACI,iBAAZC,SAA0C,oBAAXC,OAAyBA,OAAOD,QAAUD,EAAQG,QAAQ,iBAAkBA,QAAQ,kBAAmBA,QAAQ,wBAAyBA,QAAQ,gBAAiBA,QAAQ,mBAAoBA,QAAQ,mBAAoBA,QAAQ,iBAAkBA,QAAQ,qBAAsBA,QAAQ,kBAAmBA,QAAQ,kBAAmBA,QAAQ,qBAAsBA,QAAQ,iBAAkBA,QAAQ,kBAAmBA,QAAQ,qBAAsBA,QAAQ,qBAAsBA,QAAQ,iBAAkBA,QAAQ,gBAAiBA,QAAQ,oBAAqBA,QAAQ,wBAAyBA,QAAQ,qBAAsBA,QAAQ,yBAA0BA,QAAQ,yBAA0BA,QAAQ,sBAAuBA,QAAQ,qBAAsBA,QAAQ,2BAA4BA,QAAQ,uBAAwBA,QAAQ,4BACt0B,mBAAXC,QAAyBA,OAAOC,IAAMD,OAAO,CAAC,iBAAkB,kBAAmB,wBAAyB,gBAAiB,mBAAoB,mBAAoB,iBAAkB,qBAAsB,kBAAmB,kBAAmB,qBAAsB,iBAAkB,kBAAmB,qBAAsB,qBAAsB,iBAAkB,gBAAiB,oBAAqB,wBAAyB,qBAAsB,yBAA0B,yBAA0B,sBAAuB,qBAAsB,2BAA4B,uBAAwB,4BAA6BJ,KACznBD,EAA+B,oBAAfO,WAA6BA,WAAaP,GAAUQ,MAAcC,iBAAmBT,EAAOS,kBAAoB,CAAC,EAAGT,EAAOS,iBAAiBC,GAAKT,IACrK,CAJD,CAIGU,MAAM,YACL,SAAUC,GACN,IAAIC,EAAgBD,EAAME,WAAWC,OAAO,CACxCC,KAAM,SAASC,GACXL,EAAME,WAAWI,GAAGF,KAAKG,KAAKR,KAAMM,GACpCN,KAAKS,OACT,EACAC,OAAQ,CAAE,OAAQ,QAClBC,KAAM,SAAUC,GACZZ,KAAKa,MAAQb,KAAKa,MAAMC,MAAM,EAAGd,KAAKe,oBAAsB,GAC5Df,KAAKe,oBAAsBf,KAAKa,MAAMF,KAAKC,GAAW,CAC1D,EACAI,KAAM,WACF,GAAIhB,KAAKiB,UAAW,CAChB,IAAIL,EAAUZ,KAAKa,MAAMb,KAAKe,uBAC9BH,EAAQI,OACRhB,KAAKkB,QAAQ,OAAQ,CAAEN,QAASA,GACpC,CACJ,EACAO,KAAM,WACF,GAAInB,KAAKoB,UAAW,CAChB,IAAIR,EAAUZ,KAAKa,QAAQb,KAAKe,qBAChCH,EAAQO,OACRnB,KAAKkB,QAAQ,OAAQ,CAAEN,QAASA,GACpC,CACJ,EACAH,MAAO,WACHT,KAAKa,MAAQ,GACbb,KAAKe,qBAAuB,CAChC,EACAE,QAAS,WACL,OAAOjB,KAAKe,qBAAuB,CACvC,EACAK,QAAS,WACL,OAAOpB,KAAKe,qBAAuBf,KAAKa,MAAMQ,OAAS,CAC3D,IAGJpB,EAAMqB,WAAWrB,EAAO,CACpBsB,KAAM,CACFrB,cAAeA,IAG1B,CA1CD,CA0CGD,OASH,SAAUuB,GAGVC,OAAOxB,MAAMsB,KAAOE,OAAOxB,MAAMsB,MAAQ,CAAC,EAE1C,IAAIG,EAAWzB,MAAM0B,MAAMvB,OAAO,CAC9BC,KAAM,SAASuB,GAEX5B,KAAK6B,MAAQD,EACb5B,KAAK8B,QAAU,EACf9B,KAAK+B,KAAO,CAAC,CACjB,EAEAC,IAAK,SAASC,EAAKC,GACf,IAAIC,EAAMnC,KAAK+B,KACXK,EAAQ,CAAEH,IAAKA,EAAKC,MAAOA,GAE/BC,EAAIF,GAAOG,EAENpC,KAAKqC,OAGNrC,KAAKsC,MAAMC,MAAQH,EACnBA,EAAMI,MAAQxC,KAAKsC,MACnBtC,KAAKsC,MAAQF,GAJbpC,KAAKqC,MAAQrC,KAAKsC,MAAQF,EAO1BpC,KAAK8B,SAAW9B,KAAK6B,OACrBM,EAAInC,KAAKqC,MAAMJ,KAAO,KACtBjC,KAAKqC,MAAQrC,KAAKqC,MAAME,MACxBvC,KAAKqC,MAAMG,MAAQ,MAEnBxC,KAAK8B,SAEb,EAEAW,IAAK,SAASR,GACV,IAAIG,EAAQpC,KAAK+B,KAAKE,GAEtB,GAAIG,EAmBA,OAlBIA,IAAUpC,KAAKqC,OAASD,IAAUpC,KAAKsC,QACvCtC,KAAKqC,MAAQD,EAAMG,MACnBvC,KAAKqC,MAAMG,MAAQ,MAGnBJ,IAAUpC,KAAKsC,QACXF,EAAMI,QACNJ,EAAMI,MAAMD,MAAQH,EAAMG,MAC1BH,EAAMG,MAAMC,MAAQJ,EAAMI,OAG9BJ,EAAMI,MAAQxC,KAAKsC,MACnBF,EAAMG,MAAQ,KAEdvC,KAAKsC,MAAMC,MAAQH,EACnBpC,KAAKsC,MAAQF,GAGVA,EAAMF,KAErB,IAGAQ,EAAgB,eAGpB,SAASC,EAAcC,GACnB,OAAOC,OAAOD,GAAME,QAAQJ,EAHpB,IAIZ,CAEA,SAASK,EAAUC,GACf,IAAIC,EAAQ,GACZ,IAAK,IAAIhB,KAAOe,EACZC,EAAMtC,KAAKsB,EAAMe,EAAOf,IAG5B,OAAOgB,EAAMC,OAAOC,KAAK,GAC7B,CAIA,SAASC,EAAQC,GAKb,IAFA,IAAIC,EAAO,WAEFC,EAAI,EAAGA,EAAIF,EAAIhC,SAAUkC,EAC9BD,IAASA,GAAQ,IAAMA,GAAQ,IAAMA,GAAQ,IAAMA,GAAQ,IAAMA,GAAQ,IACzEA,GAAQD,EAAIG,WAAWD,GAG3B,OAAOD,IAAS,CACpB,CAMA,IAIIG,EAJAC,EAAkB,CAClBC,mBAAoB,GAKA,oBAAbC,YACPH,EAAoBG,SAASC,cAAc,QACzBC,MAAMC,QAAU,wQAKtC,IAAIC,EAAc/D,MAAM0B,MAAMvB,OAAO,CACjCC,KAAM,SAASC,GAEXN,KAAKiE,OAAS,IAAIvC,EAAS,KAC3B1B,KAAKM,QAAUkB,EAAEpB,OAAO,CAAC,EAAGsD,EAAiBpD,EACjD,EAEA4D,QAAS,SAAStB,EAAMkB,EAAOxD,GAG3B,QAFgB,IAAZA,IAAsBA,EAAU,CAAC,GAEjC,MAAOsC,EACP,MA3BD,CAAEuB,MAAO,EAAGC,OAAQ,EAAGC,SAAU,GA8BpC,IACIC,EAAWlB,EAAQR,EADRG,EAAUe,IAErBS,EAAevE,KAAKiE,OAAOxB,IAAI6B,GAEnC,GAAIC,EACA,OAAOA,EAGX,IAAI3C,EAtCD,CAAEuC,MAAO,EAAGC,OAAQ,EAAGC,SAAU,GAuChCG,EAAalE,EAAQmE,KAAOhB,EAC5BiB,EAAiB1E,KAAK2E,kBAAkBC,WAAU,GAEtD,IAAK,IAAI3C,KAAO6B,EAAO,CACnB,IAAI5B,EAAQ4B,EAAM7B,QACG,IAAVC,IACPsC,EAAWV,MAAM7B,GAAOC,EAEhC,CAEA,IAAI2C,GAAoC,IAA1BvE,EAAQqC,cAA0BA,EAAcC,GAAQC,OAAOD,GAkB7E,OAhBA4B,EAAWM,YAAcD,EACzBL,EAAWO,YAAYL,GACvBd,SAASoB,KAAKD,YAAYP,GAEtBK,EAAQxD,SACRO,EAAKuC,MAAQK,EAAWS,YAAcjF,KAAKM,QAAQqD,mBACnD/B,EAAKwC,OAASI,EAAWU,aACzBtD,EAAKyC,SAAWK,EAAeS,UAAYnF,KAAKM,QAAQqD,oBAGxD/B,EAAKuC,MAAQ,GAAKvC,EAAKwC,OAAS,GAChCpE,KAAKiE,OAAOjC,IAAIsC,EAAU1C,GAG9B4C,EAAWY,WAAWC,YAAYb,GAE3B5C,CACX,EAEA+C,gBAAiB,WACb,IAAIW,EAAS1B,SAASC,cAAc,OAIpC,OAHAyB,EAAOxB,MAAMC,QAAU,0DACnB/D,KAAKM,QAAQqD,mBAAqB,eAAiB3D,KAAKM,QAAQqD,mBAAqB,uBAElF2B,CACX,IAGJtB,EAAYuB,QAAU,IAAIvB,EAM1B/D,MAAMqB,WAAWrB,MAAMsB,KAAM,CACzBG,SAAUA,EACVsC,YAAaA,EACbwB,YAPJ,SAAqB5C,EAAMkB,EAAOU,GAC9B,OAAOR,EAAYuB,QAAQrB,QAAQtB,EAAMkB,EAAOU,EACpD,EAMIzB,UAAWA,EACXK,QAASA,EACTT,cAAeA,GAGlB,CA7LD,CA6LGlB,OAAOxB,MAAMwF,QAEhB,WAEI,IAAIxF,EAAQwB,OAAOxB,MACfqB,EAAarB,EAAMqB,WAMvB,IAAIoE,EAAMC,KAAKD,IACVA,IACDA,EAAM,WACF,OAAO,IAAIC,MAAOC,SACtB,GAkHJtE,EAAWrB,EAAO,CACdsB,KAAM,CACFmE,IAAKA,EACLG,UAxGR,SAAmBC,GACf,IAAIC,EAAS,GAEb,GAAID,EAGA,IAFA,IAAI7C,EAAQhD,EAAM+F,UAAUF,GAAKG,MAAM,KAE9B1C,EAAI,EAAGA,EAAIN,EAAM5B,OAAQkC,IAC9BwC,EAAOpF,KAAK,SAAWsC,EAAMM,IAIrC,OAAOwC,EAAO5C,KAAK,IACvB,EA6FQ+C,WAjHR,SAAoBtE,GAKhB,MAJoB,iBAATA,IACPA,GAAQ,MAGLA,CACX,EA4GQuE,IA/HR,SAAajE,GACT,OAAOA,EAAQA,CACnB,EA8HQkE,cAhER,SAAuBC,GACnBA,EAAIA,EAAEC,cAWN,IAVA,IAAIC,EAAS,CACThD,EAAG,EACHiD,EAAG,EACHC,EAAG,GACHC,EAAG,GACHC,EAAG,IACHC,EAAG,IACHC,EAAG,KAEH3E,EAAQ,EAAG4E,EAAO,EACbvD,EAAI,EAAGA,EAAI8C,EAAEhF,SAAUkC,EAAG,CAC/B,IAAIiD,EAAID,EAAOF,EAAEU,OAAOxD,IACxB,IAAKiD,EACD,OAAO,KAEXtE,GAASsE,EACLA,EAAIM,IACJ5E,GAAS,EAAI4E,GAEjBA,EAAON,CACX,CACA,OAAOtE,CACX,EAyCQ8E,cA9FR,SAAuBC,GAkBnB,IAjBA,IAAIC,EAAW,CACX,EAAO,IAAW,GAAO,IAAW,IAAO,IAC3C,EAAO,KAAW,GAAO,KAAW,IAAO,KAC3C,EAAO,MAAW,GAAO,MAAW,IAAO,MAC3C,EAAO,KAAW,GAAO,KAAW,IAAO,KAC3C,EAAO,IAAW,GAAO,IAAW,IAAO,IAC3C,EAAO,KAAW,GAAO,KAAW,IAAO,KAC3C,EAAO,MAAW,GAAO,MAAW,IAAO,MAC3C,EAAO,OAAW,GAAO,OAAW,IAAO,OAC3C,EAAO,KAAW,GAAO,KAAW,IAAO,KAC3C,IAAO,KAEPC,EAAS,CAAE,IACA,IAAM,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACzC,GAAM,GAAK,GAAK,GAAK,GAAK,GAAK,GAAK,GAAK,GACzC,EAAM,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,EAAK,GACpDC,EAAQ,GACLH,EAAI,GACHA,EAAIE,EAAO,GACXA,EAAOE,SAEPD,GAASF,EAASC,EAAO,IACzBF,GAAKE,EAAO,IAGpB,OAAOC,CACX,EAoEQE,QAxCR,SAAiBC,GACb,IAAIC,EAAQC,OAAOC,OAAO,MAC1B,OAAO,WAEH,IADA,IAAIC,EAAK,GACApE,EAAIqE,UAAUvG,SAAUkC,GAAK,GAClCoE,GAAM,IAAMC,UAAUrE,GAE1B,OAAOoE,KAAMH,EAAQA,EAAMG,GAAOH,EAAMG,GAAMJ,EAAEM,MAAM7H,KAAM4H,UAChE,CACJ,EAgCQE,gBA9BR,SAAyBC,GACrB,OAAOC,EAAkBC,KAAKF,EAClC,EA6BQG,SA3BR,SAAkBX,EAAGY,GACjB,IACI,OAAOZ,EAAE/G,KAAK2H,GAAK,SAASjG,GACxB,MAAM,IAAIkG,EAAOlG,EACrB,GACJ,CAAE,MAAMmG,GACJ,GAAIA,aAAcD,EACd,OAAOC,EAAGnG,MAEd,MAAMmG,CACV,CACA,SAASD,EAAOlG,GACZlC,KAAKkC,MAAQA,CACjB,CACJ,KAiBA,IAAI8F,EAAoB,IAAIM,OAAO,q2JAEtC,CA/ID,GAoJI,IAAIC,EAAS1F,OAAO2F,aAGhBC,EAAW,CACXC,IAAS,GACTC,GAAS,GACTC,GAAS,GACTC,KAAS,GACTC,KAAS,GACTC,KAAS,KAGb,SAASC,EAAK3F,GAEV,IADA,IAAI4F,EAAM,GACD1F,EAAI,EAAGA,EAAIF,EAAIhC,SAAUkC,EAC9B0F,EAAItI,KAAK0C,EAAIG,WAAWD,IAE5B,OAAO0F,CACX,CAEA,SAASC,EAAKD,EAAKE,GACXA,EAAO,OACPA,GAAQ,MACRF,EAAItI,KAAKwI,IAAS,GAAK,KAAQ,MACtB,MAAgB,KAAPA,IAElBF,EAAItI,KAAKwI,EAEjB,CAEA,IAAIC,EAAkBJ,EAAK,aACvBK,EAAkBL,EAAK,OACvBM,EAAkBN,EAAK,UACvBO,EAAkBP,EAAK,OACvBQ,EAAkBR,EAAK,MACvBS,EAAkBT,EAAK,MACvBU,EAAkBV,EAAK,MACvBW,EAAkBX,EAAK,KACvBY,EAAkBZ,EAAK,KACvBa,EAAkBb,EAAK,KACvBc,EAAkBd,EAAK,KACvBe,EAAkBf,EAAK,KACvBgB,EAAkBhB,EAAK,KACvBiB,EAAkBjB,EAAK,KACvBkB,EAAkBlB,EAAK,KACvBmB,EAAkBnB,EAAK,KACvBoB,EAAkBpB,EAAK,KACvBqB,EAAkBrB,EAAK,KAEvBsB,EAAO,CAAC,EAEZ,SAASC,EAAQC,EAAMC,GACnB,IAAIC,EAAQ,EACR7J,EAAQ,GACRmC,EAAS,CACT2H,GAAI,SAASC,GAET,IADA,IAAIrH,EAAI1C,EAAMQ,OAAQwJ,EAAID,EAASvJ,SAC1BkC,GAAK,KAAOsH,GAAK,GACtB,GAAIhK,EAAM0C,GAAGuH,MAAQF,EAASC,IAAqB,KAAfD,EAASC,GACzC,OAAO,EAGf,OAAOA,EAAI,EAAIhK,EAAMA,EAAMQ,OAAS,GAAK,IAC7C,EACA0J,KAAM,WACF,MAAMT,CACV,EACAzJ,MAAOA,GAGX,SAASmK,EAAShG,GACd,IAAImE,EAAOqB,EAAKE,KACH,IAAPvB,EAAc,IAMA,IAAPA,EAAc,IAKP,IAAPA,EAAc,IAKvBnE,EAAKrE,KAAKwI,GAJVD,EAAKlE,GACS,GAAPmE,IAAgB,EACD,GAAhBqB,EAAKE,MAPXxB,EAAKlE,GACS,GAAPmE,IAAgB,IACA,GAAhBqB,EAAKE,OAAoB,EACV,GAAhBF,EAAKE,MATXxB,EAAKlE,GACS,EAAPmE,IAAgB,IACA,GAAhBqB,EAAKE,OAAoB,IACT,GAAhBF,EAAKE,OAAoB,EACV,GAAhBF,EAAKE,KAanB,CAEA,SAASO,EAAMC,GACX,MAAM,IAAIC,MAAMD,EAAM,QAAUR,EACpC,CAEA,SAASU,EAAUC,GAEf,IADA,IAAIC,EAAI,GACDZ,EAAQF,EAAKnJ,QAAUgK,EAAKb,EAAKE,KACpCY,EAAE3K,KAAK6J,EAAKE,MAEhB,OAAOY,CACX,CAEA,SAASC,EAAeF,GACpB,OAAO9C,EAAOV,MAAM,EAAGuD,EAAUC,GACrC,CAEA,SAASG,IACLJ,EAAUK,EACd,CAEA,SAASC,EAAIJ,GAET,IADA,IAAIK,EAAOjB,EACFnH,EAAI,EAAGA,EAAI+H,EAAEjK,SAAUkC,EAC5B,GAAIiH,EAAKE,MAAYY,EAAE/H,GAEnB,OADAmH,EAAQiB,GACD,EAGf,OAAOL,CACX,CAEA,SAASM,EAAKzC,GACLuC,EAAIvC,IACL8B,EAAM,aAAe9B,EAAKhG,KAAK,MAEvC,CAEA,SAASsI,EAAatC,GAClB,OAAe,GAARA,GAAqB,IAARA,GAAsB,IAARA,GAAsB,IAARA,CACpD,CAEA,SAAS0C,EAAQ1C,GACb,OAAOA,GAAQ,IAAMA,GAAQ,EACjC,CAEA,SAAS2C,EAAW3C,GAChB,OAAQA,GAAQ,IAAMA,GAAQ,KACrBA,GAAM,KAAO,IAAMA,GAAQ,GACxC,CAEA,SAAS4C,EAAY5C,GACjB,OAAe,IAARA,GACQ,IAARA,IACEA,GAAM,KAAO,IAAMA,GAAQ,GACxC,CAEA,SAAS6C,EAAO7C,GACZ,OAAe,IAARA,GACA0C,EAAQ1C,IACR4C,EAAY5C,EACvB,CAYA,SAAS8C,IACL,IAAIC,EAAMC,EACNT,EAAI/B,IAiGRnJ,EAAK,OAAQ4L,IAAWC,KACxBT,EAAKlC,IAhGMgC,EAAInC,GAdnB,WAEI,IADA,IAAIvE,EAAO,GACJ0F,EAAQF,EAAKnJ,QAAQ,CACxB,GAAIqK,EAAIpC,GACJ,OAAO9I,EAAK,UAAW+H,EAAOV,MAAM,EAAG7C,IAE3CgG,EAAShG,EACb,CACJ,CAOQsH,IAGAH,EAAQE,EADRH,EAAOE,KAEPvL,EAAMF,KAAKwL,GACPT,EAAIlC,GACJhJ,EAAK,QAAS0L,EAAMC,GAAO,IAE3BP,EAAK/B,GACLrJ,EAAK,QAAS0L,EAAMC,GAahC,SAAoBD,GAChB,IAAIlH,EAAO,GACX,KAAO0F,EAAQF,EAAKnJ,QAAQ,CACxB,GAAIqK,EAAIjC,GACJ,OAAOzE,EAAK3D,QAAUb,EAAK,OAAQ+H,EAAOV,MAAM,EAAG7C,IAChD,GAAI0G,EAAItC,GACX,KAAOsB,EAAQF,EAAKnJ,SAAWqK,EAAIrC,IAC/B2B,EAAShG,QAEN0G,EAAI9B,IACP5E,EAAK3D,QACLb,EAAK,OAAQ+H,EAAOV,MAAM,EAAG7C,IAEjCiH,IACAjH,EAAO,IACA0G,EAAI1B,GACXuC,EAAUvH,GAEVgG,EAAShG,EAEjB,CACAiG,EAAM,gBAAkBiB,EAC5B,CAlCYM,CAAWN,GACPA,GAAQE,KACRnB,EAAM,mBAEVzK,EAAK,QAAS0L,EAAMC,GACpBX,IACAI,EAAK/B,IAEThJ,EAAM4L,MAEd,CA0BA,SAASL,IAIL,OAHKL,EAAYvB,EAAKE,KAClBO,EAAM,sBAEHM,EAAeS,EAC1B,CAEA,SAASU,IACL,IAAIC,EAAQjB,EAAIzB,IAAUyB,EAAIxB,GACzByC,GACD1B,EAAM,oBAGV,IADA,IAAIjG,EAAO,GACJ0F,EAAQF,EAAKnJ,QAAQ,CACxB,GAAIqK,EAAIiB,GACJ,OAAOpE,EAAOV,MAAM,EAAG7C,GAChB0G,EAAI1B,GACXuC,EAAUvH,GAEVgG,EAAShG,EAEjB,CACAiG,EAAM,oBACV,CAEA,SAASsB,EAAUvH,GACf,IAAImE,EACJ,GAAIuC,EAAIvB,GAEAhB,EADAuC,EAAItB,IAAgBsB,EAAIrB,GACjBuC,SAASrB,EAAeO,GAAa,IAErCc,SAASrB,EAAeM,GAAU,IAEzCgB,MAAM1D,IACN8B,EAAM,0BAEP,CACH,IAAIiB,EAAOE,SAEEU,KADb3D,EAAOV,EAASyD,KAEZjB,EAAM,kBAAoBiB,EAElC,CACAhD,EAAKlE,EAAMmE,GACXyC,EAAK9B,EACT,CAOA,SAASuC,EAASH,GAEd,IADA,IAAI/J,EAAM,CAAE2I,KAAMoB,GACXxB,EAAQF,EAAKnJ,QAAQ,CACxBmK,IACA,IAAIrC,EAAOqB,EAAKE,GAChB,GAAY,IAARvB,GAAsB,IAARA,GAAsB,IAARA,EAC5B,MAEJhH,EAAIiK,MAAeR,EAAK7B,GAAQ2C,IACpC,CACA,OAAOvK,CACX,CAEA,SAAS3B,EAAKuM,EAAMC,EAAOC,EAAMC,GAC7B,IAAI3F,EAAIkD,GAAaA,EAAUsC,GAC3BxF,GACAA,EAAE/G,KAAKwC,EAAQgK,EAAOC,EAAMC,EAEpC,CAGA,IAAIC,EAAM,GAMV,IALAnC,EAASmC,GACK,OAAVA,EAAI,KACJzC,EAAQ,GAGLA,EAAQF,EAAKnJ,QAChBmK,IACAI,EAAKhC,GACLqC,IACAT,GAER,CAGAvL,MAAMsB,KAAK6L,SAAW,WAClB,IACI,OAAO7C,EAAQ1C,MAAM7H,KAAM4H,UAC/B,CAAE,MAAMS,GACJ,GAAIA,IAAOiC,EACP,MAAMjC,CAEd,CACJ,EAEJ,SAAUpI,GACN,IAAIuB,EAAIvB,EAAMwF,OAEV4H,EACW,WADXA,EAEO,QAFPA,EAGK,MAHLA,EAIM,OAJNA,EAKO,QALPA,EAMY,aAGZC,EAAUrN,EAAMsN,YAAYD,QAAUrN,EAAM0B,MAAMvB,OAAO,CACzDC,KAAM,SAASC,GACXN,KAAKM,QAAUA,EACfN,KAAKwN,UAAYlN,EAAQmN,SACzBzN,KAAK0N,UAAYpN,GAAWA,EAAQqN,SACpC3N,KAAK4N,OAAS,CAAC,CACnB,EACAC,MAAO,SAASA,GAKZ,YAJcf,IAAVe,GACA7N,KAAK8N,UAAUD,GAGZ7N,KAAK+N,MAChB,EACAD,UAAW,SAASD,GAChB7N,KAAK+N,OAASF,CAClB,EACA1M,KAAM,WACFnB,KAAK6N,QAAQG,SACbhO,KAAKiO,MACT,EACAjN,KAAM,WACFhB,KAAKkO,SAASlO,KAAK4N,OACvB,EACAO,SAAU,WACNnO,KAAK4N,OAAS5N,KAAK6N,QAAQM,SAASnO,KAAK0N,UAC7C,EACAQ,SAAU,SAASE,GACfpO,KAAK6N,QAAQK,SAASE,EAC1B,EACAC,YAAa,SAASC,GAElB,OADAtO,KAAKgB,OACE,CACHuN,MAAOD,EAAgBC,MACvBvJ,KAAMsJ,EAAgBE,QACtBC,OAAQ,QACRC,KAAM,kBAEd,EACAC,aAAc,SAASC,GACnB,IAAIf,EAAQ7N,KAAK6N,QACPA,EAAMgB,KAEZC,QAAQ,SAASC,GACjBlB,EAAMmB,QAAQF,QAAQC,EAAIE,aAAcL,EAASM,KAAKlP,MAC1D,EAAEkP,KAAKlP,MACX,EACAmP,UAAW,WACP,OAAO,CACX,IAGJlP,EAAMsN,YAAY6B,qBAAuB9B,EAAQlN,OAAO,CACpDC,KAAM,SAASC,GACXN,KAAKqP,OAAS/O,EAAQ0O,MACtBhP,KAAKsP,SAAWhP,EAAQiP,QACxBvP,KAAKwP,MAAQxP,KAAKsP,SAASG,QAC3BzP,KAAK0P,UAAYpP,EAAQqP,QAC7B,EACA1B,KAAM,WAAY,EAClBjN,KAAM,WACFhB,KAAKsP,SAASM,MAAM5P,KAAK0P,WACzB1P,KAAKqP,OAAOQ,eAAiB7P,KAAKsP,SAClCtP,KAAKqP,OAAOS,cAAc,CAAEC,QAAQ,GACxC,EACA5O,KAAM,WACFnB,KAAKsP,SAASM,MAAM5P,KAAKwP,OACzBxP,KAAKqP,OAAOQ,eAAiB7P,KAAKsP,SAClCtP,KAAKqP,OAAOS,cAAc,CAAEC,QAAQ,GACxC,EACAZ,UAAW,SAASa,GAChB,OAAOhQ,KAAKsP,SAASW,QAAUD,GACxBhQ,KAAKwP,MAAMS,QAAUD,GACrBhQ,KAAK0P,UAAUO,QAAUD,CACpC,IAGJ,IAAIE,EAAiB5C,EAAQlN,OAAO,CAChCC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKsP,SAAWhP,EAAQiP,OAC5B,EACAJ,UAAW,SAASa,GAChB,OAAOhQ,KAAKsP,SAASW,QAAUD,CACnC,IAGJ/P,EAAMsN,YAAY4C,mBAAqBD,EAAe9P,OAAO,CACzDC,KAAM,SAASC,GACX4P,EAAe3P,GAAGF,KAAKG,KAAKR,KAAMM,GAClCN,KAAKoQ,MAAQ9P,EAAQ+P,KACrBrQ,KAAKsQ,OAAShQ,EAAQ6D,MACtBnE,KAAKuQ,QAAUjQ,EAAQ8D,MAC3B,EACA6J,KAAM,WACF,IAAIJ,EAAQ7N,KAAK6N,QACbmB,EAAQnB,EAAMmB,QACd7K,EAAQnE,KAAKsQ,OACblM,EAASpE,KAAKuQ,QACdC,EAASrM,EAAQC,EACjBD,EAAQC,EAERA,GADAD,EAAQsM,KAAKC,IAAIvM,EAAO,MACPqM,EAGjBrM,GADAC,EAASqM,KAAKC,IAAItM,EAAQ,MACToM,EAErBxQ,KAAKsP,SAAWN,EAAM2B,WAAW,CAC7BC,YAAc/C,EAAMgD,UACpBC,QAAc,EACdC,QAAc,EACd5M,MAAcA,EACdC,OAAcA,EACd4M,QAAc,EACdf,MAAcjQ,KAAKwN,UAAUyD,SAASjR,KAAKoQ,SAC5C,GACHpQ,KAAKoQ,MAAQ,IACjB,EACApP,KAAM,WACF,IAAIgO,EAAQhP,KAAK6N,QAAQmB,QACzBA,EAAMa,eAAiB,KACvBb,EAAMkC,cAAclR,KAAKsP,SAC7B,EACAnO,KAAM,WACF,IAAI6N,EAAQhP,KAAK6N,QAAQmB,QACzBA,EAAMa,eAAiB7P,KAAKsP,SAC5BN,EAAM2B,WAAW3Q,KAAKsP,SAC1B,IAGJrP,EAAMsN,YAAY4D,qBAAuBjB,EAAe9P,OAAO,CAC3D6N,KAAM,WACF,IAAIe,EAAQhP,KAAK6N,QAAQmB,QACzBA,EAAMa,eAAiB,KACvBb,EAAMkC,cAAclR,KAAKsP,SAC7B,EACAtO,KAAM,WACF,IAAIgO,EAAQhP,KAAK6N,QAAQmB,QACzBA,EAAMa,eAAiB7P,KAAKsP,SAC5BN,EAAM2B,WAAW3Q,KAAKsP,SAC1B,EACAnO,KAAM,WACFnB,KAAKiO,MACT,IAGJ,IAAImD,EAAyBlB,EAAe9P,OAAO,CAC/C6N,KAAM,WACF,IAAIe,EAAQhP,KAAK6N,QAAQmB,QACzBhP,KAAKqR,WAAarC,EAAMsC,UAAUC,QAAQvR,KAAKsP,UAC/CN,EAAMsC,UAAUE,OAAOxR,KAAKqR,WAAY,GACxCrR,KAAKyR,UAAYzR,KAAK0R,WACtB1C,EAAMsC,UAAUE,OAAOxR,KAAKyR,UAAW,EAAGzR,KAAKsP,UAC/CN,EAAMc,cAAc,CAAE6B,UAAU,GACpC,EACA3Q,KAAM,WACF,IAAIgO,EAAQhP,KAAK6N,QAAQmB,QACzBA,EAAMsC,UAAUE,OAAOxR,KAAKyR,UAAW,GACvCzC,EAAMsC,UAAUE,OAAOxR,KAAKqR,WAAY,EAAGrR,KAAKsP,UAChDN,EAAMc,cAAc,CAAE6B,UAAU,GACpC,IAGJ1R,EAAMsN,YAAYqE,oBAAsBR,EAAuBhR,OAAO,CAClEsR,SAAU,WACN,OAAO1R,KAAK6N,QAAQmB,QAAQsC,UAAUjQ,MAC1C,IAGJpB,EAAMsN,YAAYsE,kBAAoBT,EAAuBhR,OAAO,CAChEsR,SAAU,WACN,OAAO,CACX,IAGJ,IAAII,EAAqBxE,EAAQlN,OAAO,CACpCC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAK+R,QAAUzR,EAAQ0R,OACvBhS,KAAKiS,OAAS3R,EAAQ4B,KAC1B,EACA+L,KAAM,WACFjO,KAAKmO,WACLnO,KAAKkO,SAASlO,KAAKiS,OACvB,IAGJhS,EAAMsN,YAAY2E,mBAAqBJ,EAAmB1R,OAAO,CAC7D+N,SAAU,WACNnO,KAAK4N,OAAS5N,KAAK6N,QAAQmB,QAAQmD,YAAYnS,KAAK+R,QACxD,EACA7D,SAAU,SAASE,GACfpO,KAAK6N,QAAQmB,QAAQmD,YAAYnS,KAAK+R,QAAS3D,EACnD,IAGJnO,EAAMsN,YAAY6E,iBAAmBN,EAAmB1R,OAAO,CAC3D+N,SAAU,WACNnO,KAAK4N,OAAS5N,KAAK6N,QAAQmB,QAAQqD,UAAUrS,KAAK+R,QACtD,EACA7D,SAAU,SAASE,GACfpO,KAAK6N,QAAQmB,QAAQqD,UAAUrS,KAAK+R,QAAS3D,EACjD,IAGJnO,EAAMsN,YAAY+E,iBAAmBhF,EAAQlN,OAAO,CAChDC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKuS,MAAQjS,EAAQkS,IACzB,EACAvE,KAAM,WACF,IAAIJ,EAAQ7N,KAAK6N,QACjB7N,KAAKyS,UAAY5E,EAAM2E,OACvBxS,KAAK0S,eAAiB7E,EAAM8E,YAC5B9E,EAAM2E,KAAKxS,KAAKuS,OAChB1E,EAAM8E,WAAU,GACK,MAAjB9E,EAAM3L,UACNlC,KAAK4S,cAAe,EACpB/E,EAAM3L,MAAMlC,KAAKuS,OAEzB,EACAvR,KAAM,WACF,IAAI6M,EAAQ7N,KAAK6N,QACjBA,EAAM2E,KAAKxS,KAAKyS,WAChB5E,EAAM8E,UAAU3S,KAAK0S,gBACjB1S,KAAK4S,cACL/E,EAAM3L,MAAM,KAEpB,IAGJjC,EAAMsN,YAAYsF,uBAAyBf,EAAmB1R,OAAO,CACjE+N,SAAU,WACNnO,KAAK4N,OAAS5N,KAAK+N,OAAOiB,QAAQ8D,eACtC,EACA5E,SAAU,SAAS1H,GACfxG,KAAK+N,OAAOiB,QAAQ8D,cAActM,EACtC,IAGJ,IAAIuM,EAAwB9S,EAAMsN,YAAYwF,sBAAwBzF,EAAQlN,OAAO,CACjF0N,UAAW,SAASD,GAChBP,EAAQ0F,UAAUlF,UAAUtN,KAAKR,KAAM6N,EAAMoF,kBACjD,EACA5S,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKiS,OAAS3R,EAAQ4B,KAC1B,EACA+L,KAAM,WACF,IAAIJ,EAAQ7N,KAAK6N,QACbA,EAAMqF,WACNlT,KAAKmO,WAEyB,WAA1BnO,KAAKM,QAAQqN,UACb3N,KAAKwN,UAAUtM,QAAQ,eAAgB,CAAE2M,MAAOA,IAGpDA,EAAM7N,KAAK0N,WAAW1N,KAAKiS,QAEnC,IAGJhS,EAAMsN,YAAY4F,oBAAsB7F,EAAQlN,OAAO,CACnD6N,KAAM,WACF,IAAiBJ,EAAOuF,EAAWC,EAAY/E,EAAiBgF,EAA5DnM,EAAS,GACb,OAAKnH,KAAK6N,QAAQqF,SAGblT,KAAK6N,QAAQ0F,uBAGlBvT,KAAKmO,YACLN,EAAQ7N,KAAK6N,QAAQoF,mBAEZpE,KAAK2E,MAAQ3F,EAAMgB,KAAK2E,KAAKnS,OAAS,EAC3CwM,EAAMgB,KAAK2E,KAAK1E,SAAQ,SAASC,GAC7BuE,EAAezF,EAAMmB,QAAQnB,MAAMkB,GACnC5H,EAASA,EAAOsM,OAAOH,EAAanM,SACxC,IAEAA,EAAS0G,EAAM1G,SAEnBkM,EAAa,GACblM,EAAO2H,SAAQ,SAAS4E,GACpBN,EAAY,GACZM,EAAI5E,SAAQ,WACRsE,EAAUzS,KAAK,KACnB,IACA0S,EAAW1S,KAAKyS,EACpB,IACIvF,EAAMmB,QAAQ9N,QAAQ,WAAY,CAAEsJ,KAAM6I,EAAYxF,MAAOA,EAAO8F,WAAYtG,SAApF,GAGAQ,EAAM+F,gBACNtF,EAAkBT,EAAMgG,uBAEb7T,KAAKqO,YAAYC,QAD5B,IA1BW,CAAEG,OAAQ,QAASC,KAAM,mBAHzB,CAAED,OAAQ,QAASC,KAAM,uBAgCxC,EACA1N,KAAM,WACF,IAIIoS,EAJAvF,EAAQ7N,KAAK6N,QAAQoF,kBACrBjE,EAAQnB,EAAMmB,QACdxE,EAAOxK,KAAK4N,OAAOpD,KACnBrD,EAAS,GAEbqD,EAAKsE,SAAQ,SAAS4E,GAClBN,EAAY,GACZM,EAAI5E,SAAQ,SAASgF,GACjBV,EAAUzS,KAAKmT,EAAK5R,MACxB,IACAiF,EAAOxG,KAAKyS,EAChB,IACIpE,EAAM9N,QAAQ,WAAY,CAAEsJ,KAAMrD,EAAQ0G,MAAOA,EAAO8F,WAAYtG,KAGxErN,KAAKkO,SAASlO,KAAK4N,OACvB,IAGJ3N,EAAMsN,YAAYwG,YAAchB,EAAsB3S,OAAO,CACzDC,KAAM,SAASC,GACXA,EAAQqN,SAAWrN,EAAQqN,UAAY,QACvCoF,EAAsBxS,GAAGF,KAAKG,KAAKR,KAAMM,EAC7C,EACAwN,UAAW,SAASD,GAChBkF,EAAsBC,UAAUlF,UAAUjG,MAAM7H,KAAM4H,WACtD5H,KAAKgU,WAAahU,KAAKM,QAAQ2T,aAAepG,EAAQA,EAAMmB,QAAQkF,qBACxE,EACA/F,SAAU,WACNnO,KAAK4N,OAAS5N,KAAK6N,QAAQM,UAC/B,EACAF,KAAM,WACF,OAAOjO,KAAK6N,QAAQmB,QAAQmF,oBAAoBnU,KAAKoU,MAAMlF,KAAKlP,MACpE,EACAgB,KAAM,WACF,IAAIqT,EAAYrU,KAAKgU,WACjB5F,EAAQpO,KAAK4N,OACbyG,EAAUrF,QAAQ9N,QAAQ,WAAY,CAAEsJ,KAAM4D,EAAM5D,KAAK,GAAG,GAAGtI,MAAO2L,MAAOwG,EAAWV,WAAYtG,KAGxGrN,KAAKkO,SAASlO,KAAK4N,OACvB,EACAwG,MAAO,WACH,IAAIH,EAAejU,KAAKM,QAAQ2T,aAC5BI,EAAYrU,KAAKgU,WAErB,IAAKK,EAAUnB,SACX,MAAO,CAAEzE,OAAQ,QAASC,KAAM,iBAGpC,IAAK2F,EAAUd,sBACX,MAAO,CAAE9E,OAAQ,QAASC,KAAM,mBAGpC,IAAIxM,EAAQlC,KAAKiS,OAEjB,GADAjS,KAAKmO,YACDnO,KAAK6N,QAAQmB,QAAQ9N,QAAQ,WAAY,CAAEsJ,KAAMtI,EAAO2L,MAAO7N,KAAKgU,WAAYL,WAAYtG,IAIhG,GAAsB,SAAlBrN,KAAK0N,UAKT,IACI2G,EAAU7B,KAAK,MACD,KAAVtQ,EACAmS,EAAUnS,MAAM,OAEhBmS,EAAUC,MAAMpS,EAAO,CAAE+R,aAAcA,IACnC,KAAKhM,KAAKoM,EAAUnS,UACpBmS,EAAUE,MAAK,IAGvBF,EAAUG,mBAEV,IAAIlG,EAAkB+F,EAAUR,sBAChC,GAAIvF,EACA,OAAOtO,KAAKqO,YAAYC,EAEhC,CAAE,MAAMjG,GACJ,GAAIA,aAAcpI,EAAMsN,YAAYkH,KAAKC,WACrC,MAAO,CACHnG,MAAQ,mBACRvJ,KAAQqD,EAAG,GACXoG,OAAQ,SAGZ,MAAMpG,CAEd,MA9BIgM,EAAUnS,MAAMA,EA+BxB,IAGJjC,EAAMsN,YAAYoH,qBAAuB5B,EAAsB3S,OAAO,CAClEC,KAAM,SAASC,GACXA,EAAQqN,SAAW,UACnBoF,EAAsBxS,GAAGF,KAAKG,KAAKR,KAAMM,EAC7C,IAGJL,EAAMsN,YAAYqH,gBAAkB7B,EAAsB3S,OAAO,CAC7DC,KAAM,SAASC,GACXA,EAAQqN,SAAW,OACnBoF,EAAsBxS,GAAGF,KAAKG,KAAKR,KAAMM,GAEzCN,KAAKiS,OAAS3R,EAAQ4B,KAC1B,EACAiM,SAAU,WACN,IAAIkE,EAAY,CAAC,EACjBrS,KAAK6N,QAAQgH,YAAW,SAAShH,GAC7B,IAAInD,EAAQmD,EAAMgD,UAAU6C,IAE5BrB,EAAU3H,GAASmD,EAAMmB,QAAQqD,UAAU3H,EAC/C,IAEA1K,KAAK4N,OAAS5N,KAAK6N,QAAQM,SAASnO,KAAK0N,WACzC1N,KAAK8U,WAAazC,CACtB,EACArR,KAAM,WACF,IAAIgO,EAAQhP,KAAK6N,QAAQmB,QACrBqD,EAAYrS,KAAK8U,WAIrB,IAAK,IAAIpB,KAFT1T,KAAK6N,QAAQK,SAASlO,KAAK4N,QAEXyE,EACZrD,EAAMqD,UAAUqB,EAAKrB,EAAUqB,GAEvC,IAGJzT,EAAMsN,YAAYwH,sBAAwBzH,EAAQlN,OAAO,CACrDC,KAAM,SAASC,GACXN,KAAKgV,OAAS1U,EAAQ4B,MACtB5B,EAAQqN,SAAW,SACnBL,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,EAC/B,EACA2N,KAAM,WACF,IAAIe,EAAQhP,KAAK6N,QAAQmB,QACrBiG,EAAQjV,KAAKgV,OACbE,EAAajV,EAAMsN,YAAY2H,WAEnClV,KAAKmO,WAELa,EAAMmG,MAAM,WACRnV,KAAK6N,QAAQuH,aAAY,SAAS1B,EAAK2B,EAAKvB,GACxC,IAAIwB,EAASxB,EAAKwB,OAElB,IAAKA,EAAQ,CACT,IAAIpT,EAAQ4R,EAAK5R,MACG,iBAATA,GAAqB,KAAK+F,KAAK/F,KACtCoT,EAAS,KAAOzS,OAAOX,GAAO+D,MAAM,KAAK,GAAGnD,QAAQ,MAAO,KAEnE,EAEIwS,GAAUL,EAAQ,KAClBK,EAASJ,EAAWK,eAAeD,GAAU,IAAKL,GAClDjG,EAAMnB,MAAM6F,EAAK2B,GAAKC,OAAOA,GAErC,GACJ,EAAEpG,KAAKlP,MACX,IAGJC,EAAMsN,YAAYiI,oBAAsBlI,EAAQlN,OAAO,CACnDC,KAAM,SAASC,GACXA,EAAQqN,SAAW,SACnBL,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKyV,MAAQnV,EAAQoV,QAAUpV,EAAQ4B,MAAMwM,KAC7C1O,KAAK2V,OAASrV,EAAQwD,OAAS,CAAE8R,MAAOtV,EAAQ4B,MAAM0T,MAAOhU,KAAM,EACvE,EACAiU,OAAQ,SAAStO,GACb,OAAOvH,KAAK6N,QAAQmB,QAAQmG,MAAM5N,EAAG,CAAC,EAC1C,EACA0G,KAAM,WACF,IAAIpO,EAAOG,KAENH,EAAK4V,QAIV5V,EAAKsO,WACLtO,EAAKgW,QAAO,WACRhW,EAAKA,EAAK4V,OAAO5V,EAAK8V,OAC1B,IACJ,EACAG,UAAW,WACP9V,KAAK6N,QAAQkI,cAAc,MAC3B/V,KAAKgW,eAAe,KACxB,EACAC,WAAY,SAASnS,GACjB9D,KAAK6N,QAAQkI,cAAcjS,GAC3B9D,KAAKgW,eAAelS,EACxB,EACAoS,WAAY,SAASpS,GACjB9D,KAAK6N,QAAQsI,aAAaC,WAAWtS,EACzC,EACAuS,YAAa,SAASvS,GAClB9D,KAAK6N,QAAQyI,cAAcC,YAAYzS,EAC3C,EACA0S,UAAW,SAAS1S,GAChB9D,KAAK6N,QAAQ4I,SAASC,UAAU5S,EACpC,EACA6S,aAAc,SAAS7S,GACnB9D,KAAK6N,QAAQ+I,YAAYC,aAAa/S,EAC1C,EACAkS,eAAgB,SAASlS,GACrB,IAAI+J,EAAQ7N,KAAK6N,QACjBA,EAAMsI,aAAaC,WAAWtS,GAC9B+J,EAAM4I,SAASC,UAAU5S,GACzB+J,EAAMyI,cAAcC,YAAYzS,GAChC+J,EAAM+I,YAAYC,aAAa/S,EACnC,EACAiS,cAAe,SAASjS,GACpB9D,KAAK6N,QAAQkI,cAAcjS,GAC3B9D,KAAKgW,eAAe,KACxB,EACAc,wBAAyB,SAAShT,GAC9B9D,KAAK6N,QAAQiJ,wBAAwBhT,EACzC,EACAiT,sBAAuB,SAASjT,GAC5B9D,KAAK6N,QAAQkJ,sBAAsBjT,EACvC,IAGJ7D,EAAMsN,YAAYyJ,iBAAmB1J,EAAQlN,OAAO,CAChDC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKyV,MAAQnV,EAAQ4B,KACzB,EACA+L,KAAM,WACFjO,KAAKmO,WACLnO,KAAKA,KAAKyV,SACVzV,KAAK6N,QAAQmB,QAAQc,cAAc,CAAEmH,QAAQ,GACjD,EACAC,SAAU,SAASnI,GACf/O,KAAK6N,QAAQmB,QAAQmI,WAAWpI,EACpC,EACAZ,SAAU,WACNnO,KAAK4N,OAAS5N,KAAK6N,QAAQM,UAC/B,EACAnN,KAAM,WACiB,YAAfhB,KAAKyV,QACLzV,KAAK6N,QAAQuJ,UACbpX,KAAKkX,SAASlX,KAAK6N,QAAQgD,YAE/B7Q,KAAK6N,QAAQK,SAASlO,KAAK4N,OAC/B,EACAyJ,MAAO,WACH,IAAIxJ,EAAQ7N,KAAK6N,QACbkB,EAAMlB,EAAMgB,KAEhBhB,EAAMyJ,QACNtX,KAAKkX,SAASnI,EAClB,EACAwI,aAAc,WACV,IAAIxI,EAAM/O,KAAK6N,QAAQ4I,SAAS5H,KAEhC7O,KAAK6N,QAAQgH,YAAW,SAAShH,GAC7BA,EAAMyJ,OACV,IAEAtX,KAAKkX,SAASnI,EAClB,EACAyI,WAAY,WACR,IAAIzI,EAAM/O,KAAK6N,QAAQsI,aAAatH,KAEpC7O,KAAK6N,QAAQ4J,eAAc,SAAS5J,GAChCA,EAAMyJ,OACV,IAEAtX,KAAKkX,SAASnI,EAClB,EACAqI,QAAS,WACL,IAAIvJ,EAAQ7N,KAAK6N,QACbkB,EAAMlB,EAAMgB,KAAKgC,QAErBhD,EAAMuJ,UACNpX,KAAKkX,SAASnI,EAClB,IAGJ9O,EAAMsN,YAAYmK,mBAAqBpK,EAAQlN,OAAO,CAClDC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKyV,MAAQnV,EAAQ4B,KACzB,EACA+L,KAAM,WACFjO,KAAKmO,WACLnO,KAAK2X,SAAW3X,KAAK6N,QAAQgD,UAC7B7Q,KAAKA,KAAKyV,QACd,EACAtH,SAAU,WACNnO,KAAK4N,OAAS5N,KAAK6N,QAAQmB,QAAQb,UACvC,EACAnN,KAAM,WACFhB,KAAK6N,QAAQmB,QAAQd,SAASlO,KAAK4N,OACvC,EACAgK,MAAO,WACH,IAAI/G,EAAU7Q,KAAK2X,SACP3X,KAAK6N,QAAQmB,QAEnB6I,cAAchH,EAAQwE,KAAKyC,WAAWjH,EAAQ6C,IACxD,EACAqE,KAAM,WACF,IAAIlH,EAAU7Q,KAAK2X,SACP3X,KAAK6N,QAAQmB,QAEnB8I,WAAWjH,EAAQ6C,IAC7B,EACAsE,QAAS,WACL,IAAInH,EAAU7Q,KAAK2X,SACP3X,KAAK6N,QAAQmB,QAEnB6I,cAAchH,EAAQwE,IAChC,EACA4C,SAAU,WACMjY,KAAK6N,QAAQmB,QACnB8I,WAAW,GAAGD,cAAc,EACtC,IAGJ5X,EAAMsN,YAAY2K,aAAe5K,EAAQlN,OAAO,CAC5CC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKmY,WAAa7X,EAAQmN,SAAS2K,YACnCpY,KAAKmY,WAAWE,QAChBrY,KAAKsY,OAAShY,EAAQiY,MACtBvY,KAAKwY,kBAAoBxY,KAAKmY,WAAWM,SACzCzY,KAAKqP,OAASrP,KAAKwN,UAAUkL,cAC7B1Y,KAAK+N,OAAS/N,KAAKqP,OAAOsJ,UAAY3Y,KAAKqP,OAAOsJ,YAAc3Y,KAAKqP,OAAOxB,MAAM7N,KAAKmY,WAAWS,YAClG5Y,KAAK4N,OAAS5N,KAAK+N,OAAOI,WAC1BnO,KAAK6Y,kBAAoB7Y,KAAK+N,OAAOc,gBAAgB5O,EAAMsN,YAAYuL,SAAW9Y,KAAK+N,OAAOc,KAAK2E,KAAO,CAACxT,KAAK+N,OAAOc,OAAO1M,KAAI,SAAS4M,GACvI,OAAOA,EAAIE,YACf,GACJ,EACAhB,KAAM,WACF,OAAOjO,KAAK6N,QAAQmB,QAAQmF,oBAAoBnU,KAAKoU,MAAMlF,KAAKlP,MACpE,EACAgB,KAAM,WACF,IAAIgO,EAAQhP,KAAKqP,OACbxB,EAAQ7N,KAAK+N,OAEbiB,EAAM9N,QAAQ,WAAY,CAAEsJ,KAAMxK,KAAK4N,OAAOpD,KAAMqD,MAAOA,EAAO8F,WAAYtG,KAIlFrN,KAAKkO,SAASlO,KAAK4N,OACvB,EACAwG,MAAO,WACH,IAAI2E,EAAS/Y,KAAKmY,WAAWa,WAE7B,IAAKD,EAAOC,SACR,OAAID,EAAOE,YACA,CAAExK,OAAQ,QAASC,KAAM,eAEhCqK,EAAOG,cACA,CAAEzK,OAAQ,QAASC,KAAM,gBAEhCqK,EAAOI,iBACPnZ,KAAKsY,OAAOc,iBACL,CAAE3K,OAAQ,QAASC,KAAM,yBAE7B,CAAED,OAAQ,SAGrB,IAAIO,EAAQhP,KAAKqP,OACbxB,EAAQ7N,KAAK+N,OAEd/N,KAAKwN,UAAUtM,QAAQ,QAAS,CAAC2M,MAAOA,EAAOwL,iBAAkBrZ,KAAKwY,qBACrExJ,EAAM9N,QAAQ,WAAY,CAAEsJ,KAAMxK,KAAKwY,kBAAkBhO,KAAMqD,MAAOA,EAAO8F,WAAYtG,IACzFrN,KAAKsY,OAAOc,iBAGZpZ,KAAKsZ,eAEb,EACAC,mBAAoB,SAASC,EAAaC,EAAYC,GAClD,IAwBIC,EAAaC,EAAe7K,EAAK8B,EAASgJ,EAAYtW,EAxBtDuW,EAAO9Z,KACP+Z,EAAkBD,EAAKjB,iBACvB7J,EAAQ8K,EAAKzK,OACb2K,EAAW/Z,EAAMsN,YAAYyM,SAC7BlB,EAAW7Y,EAAMsN,YAAYuL,SAC7BtF,EAAO,GAqBX,IAAIjQ,EAAI,EAAGA,EAAIwW,EAAgB1Y,OAAQkC,GAAK,EACxCwL,EAAMgL,EAAgBxW,GACtBsW,EAAaL,EAAYjW,GAOzBoW,EAAc,IAAIK,EANlBnJ,EAAU9B,EAAI8B,QACA,CACV6C,IAAKmG,EAAW9B,KAAO0B,EAAa5I,EAAQ6C,IAAM,EAClD2B,IAAKwE,EAAWI,KAAOP,EAAa7I,EAAQwE,IAAM,IAItD7B,EAAK7S,KAAKgZ,GAGK,IAAhBnG,EAAKnS,OACJuY,EAAgB5K,EAAMnB,MAAM8L,IAE5BnG,EAAKtQ,MApCK,SAAUoI,EAAG4O,GACvB,IAAInU,EAAS,EACToU,EAAW7O,EAAEuF,QACbuJ,EAAWF,EAAErJ,QAYjB,OAVIsJ,EAASzG,IAAM0G,EAAS1G,IACxB3N,EAAS,EACFoU,EAASzG,IAAM0G,EAAS1G,IAC/B3N,GAAU,EACHoU,EAAS9E,IAAM+E,EAAS/E,IAC/BtP,EAAS,EACFoU,EAAS9E,IAAM+E,EAAS/E,MAC/BtP,GAAU,GAGPA,CACX,IAqBI6T,EAAgB5K,EAAMnB,MAAM,IAAIiL,EAAStF,KAG7CoG,EAAc5L,SACd8L,EAAK/L,OAAS6L,EACdE,EAAKlM,OAASkM,EAAK/L,OAAOI,UAC9B,EACAmL,cAAe,WACX,IASI/V,EATAuW,EAAO9Z,KACPgP,EAAQ8K,EAAKzK,OACbgK,EAAmBS,EAAKtB,kBACxB3K,EAAQiM,EAAK/L,OACbsM,EAAahB,EAAiB7O,KAC9BiP,EAAaY,EAAWhZ,OACxBqY,EAAaW,EAAW,GAAGhZ,OAC3B0Y,EAAkBD,EAAKjB,iBACvBW,EAAcM,EAAKQ,cAAcb,EAAYC,GAG7Cd,EAAW5Y,KAAKmY,WAAWS,YAC3BA,EAAS2B,YAAY7G,KAAO1E,EAAMwL,MAAMC,QAAU7B,EAAS2B,YAAYlF,KAAOrG,EAAM0L,SAASD,SAC7FzL,EAAM2L,OACFlK,KAAKmK,IAAIhC,EAAS2B,YAAY7G,IAAM,EAAG1E,EAAMwL,MAAMC,QACnDhK,KAAKmK,IAAIhC,EAAS2B,YAAYlF,IAAM,EAAGrG,EAAM0L,SAASD,SAI9DX,EAAKP,mBAAmBC,EAAaC,EAAYC,GAEjD1K,EAAMmG,OAAM,WACR,IAAI5R,EAAI,EAAGA,EAAIwW,EAAgB1Y,OAAQkC,IACnCuW,EAAKe,qBAAqBd,EAAgBxW,GAAIkW,EAAYC,EAAYF,EAAYjW,GAE1F,GAAG,CACC0T,QAAQ,EACRlI,IAAK+K,EAAK/L,OAAOc,OAGrBhB,EAAM2G,kBACV,EACAqG,qBAAsB,SAAS9L,EAAK0K,EAAYC,EAAYF,GACxD,IACWjW,EAAGsH,EADVgG,EAAU9B,EAAI8B,QAGlB,IAAItN,EAAI,EAAGA,EAAIiW,EAAYzB,KAAMxU,IAC7B,IAAIsH,EAAI,EAAGA,EAAI2O,EAAYS,KAAMpP,IACrB7K,KAAKqP,OAAOxB,MAAMgD,EAAQ6C,IAAM+F,EAAalW,EAAGsN,EAAQwE,IAAMqE,EAAa7O,GAC7EqD,SAASlO,KAAKwY,kBAAmBxY,KAAKmY,WAGxD,EACA2C,uBAAwB,SAAS/L,EAAK0K,EAAYC,GAC9C,IAAI7I,EAAU9B,EAAI8B,QACd0J,EAAcxL,EAAIwL,YAClBQ,EAAkBR,EAAY7G,IAAM7C,EAAQ6C,IAAM,EAClDsH,EAAkBT,EAAYlF,IAAMxE,EAAQwE,IAAM,EAClD4F,EAAiB,EACjBC,EAAiB,EAOrB,OALIH,EAAkBtB,GAAe,GAAKuB,EAAkBtB,GAAe,IACvEuB,EAAiBF,EAAkBtB,EACnCyB,EAAiBF,EAAkBtB,GAGhC,CACH3B,KAAMkD,EACNhB,KAAMiB,EAEd,EACAZ,cAAe,SAASb,EAAYC,GAChC,IAEInW,EAFAwW,EAAkB/Z,KAAK6Y,iBACvBW,EAAc,GAGlB,IAAIjW,EAAI,EAAGA,EAAIwW,EAAgB1Y,OAAQkC,IACnCiW,EAAY7Y,KAAKX,KAAK8a,uBAAuBf,EAAgBxW,GAAIkW,EAAYC,IAGjF,OAAOF,CACX,IAGJvZ,EAAMsN,YAAY4N,uBAAyB7N,EAAQlN,OAAO,CACtD6N,KAAM,WACF,IAAI3N,EAAUN,KAAKM,QACf0O,EAAQhP,KAAKwN,UAAUkL,eACfpY,EAAQuN,OAASmB,EAAMnB,MAAMvN,EAAQ8a,WAE3C5G,kBACV,IAGJvU,EAAMsN,YAAY8N,oBAAsB/N,EAAQlN,OAAO,CACnD6N,KAAM,WACF,IAAIhO,EAAMqb,QAAQlD,UAAUmD,MAKxB,MAAO,CAAE9M,OAAQ,QAASC,KAAM,eAJhC1O,KAAKwN,UAAUgO,MAAMpD,UAAUqD,QAAQzN,SAEvCpK,SAAS8X,YAAY,QAI7B,IAGJzb,EAAMsN,YAAYoO,WAAarO,EAAQlN,OAAO,CAC1Cwb,WAAY,MACZvb,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKmY,WAAa7X,EAAQmN,SAAS2K,YACnCpY,KAAKsY,OAAShY,EAAQiY,KAC1B,EACAtK,KAAM,WACF,IAC4B4N,EADxB9C,EAAS/Y,KAAKmY,WAAW2D,UACzBtR,EAAO,GACX,IAAKuO,EAAO+C,QACR,OAAI/C,EAAOE,YACA,CAAExK,OAAQ,QAASC,KAAM,eACzBqK,EAAOgD,eACP,CAAEtN,OAAQ,QAASC,KAAM,6BAEpC,EAEJ,IAAIb,EAAQ7N,KAAKwN,UAAUkL,cAAcC,YACzC,GAAuB,OAAnB3Y,KAAK4b,WAAqB,CAC1B,IAAK/N,EAAMqF,SAEP,OADAlT,KAAKsY,OAAOc,iBACL,CAAE3K,OAAQ,QAASC,KAAM,wBAEpC1O,KAAKmO,UACT,CACA,GAAInO,KAAKwN,UAAUtM,QAAQlB,KAAK4b,WAAY,CAAE/N,MAAOA,IACjD7N,KAAKsY,OAAOc,sBACT,GAAuB,OAAnBpZ,KAAK4b,WAAqB,CASjC,GARc/N,EAAM1G,SACR2H,SAAQ,SAAS4E,GACzBmI,EAAa,GACbnI,EAAI5E,SAAQ,WACR+M,EAAWlb,KAAK,CAAC,EACrB,IACA6J,EAAK7J,KAAKkb,EACd,IACIhO,EAAMmB,QAAQ9N,QAAQ,WAAY,CAAEsJ,KAAMA,EAAMqD,MAAOA,EAAO8F,WAAYtG,IAC1E,OAEJrN,KAAKmY,WAAW6D,KACpB,MACIhc,KAAKmY,WAAW8D,MAExB,EACAjb,KAAM,WACF,IAAI6M,EAAQ7N,KAAK6N,QACbA,EAAMmB,QAAQ9N,QAAQ,WAAY,CAAEsJ,KAAMxK,KAAK4N,OAAOpD,KAAMqD,MAAOA,EAAO8F,WAAYtG,KAG1FrN,KAAKkO,SAASlO,KAAK4N,OACvB,IAGJ3N,EAAMsN,YAAY2O,YAAcjc,EAAMsN,YAAYoO,WAAWvb,OAAO,CAChEwb,WAAY,OACZ5a,KAAMQ,EAAE2a,OAgBZlc,EAAMsN,YAAY6O,mBAAqB9O,EAAQlN,OAAO,CAClDC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKmY,WAAa7X,EAAQmN,SAAS2K,WACvC,EACApX,KAAMQ,EAAE2a,KACRlO,KAAM,WACF,IAAIhO,EAAMqb,QAAQlD,UAAU6D,KAGxB,MAAO,CAAExN,OAAQ,QAASC,KAAM,eAFhC9K,SAAS8X,YAAY,OAI7B,IAGJzb,EAAMsN,YAAY8O,gBAAkB/O,EAAQlN,OAAO,CAC/CC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,EAC/B,EACAgc,OAAQ,SAASA,GACbtc,KAAKuc,QAAUD,CACnB,EACArO,KAAM,WACF,IAA0BuO,EAAtB3O,EAAQ7N,KAAK6N,QACjB,IAAKA,EAAMqF,SACP,MAAO,CAAEzE,OAAQ,QAASC,KAAM,iBAEpC,GAAIb,EAAM4O,2BACN,MAAO,CAAEhO,OAAQ,QAASC,KAAM,mBAEpC1O,KAAKmO,WACL,IAEI,GADAqO,EAAe3O,EAAM6O,iBAAiB1c,KAAKuc,SACvC1O,EAAMmB,QAAQ9N,QAAQ,WAAY,CAAEsJ,KAAMgS,EAAaG,MAAO9O,MAAO2O,EAAaI,KAAMjJ,WAAYtG,IACpG,OAEJmP,EAAaI,KAAKC,YAAYL,EAAaG,OAAO,EACtD,CAAE,MAAMtU,GACJ,GAAIA,aAAcpI,EAAMsN,YAAYuP,MAAMC,UACtC,MAAO,CAAEtO,OAAQ,QAASC,KAAMrG,EAAGc,MAEvC,MAAMd,CACV,CACJ,EACArH,KAAM,WACF,IAAI6M,EAAQ7N,KAAK6N,QACbO,EAAQpO,KAAK4N,OACbC,EAAMmB,QAAQ9N,QAAQ,WAAY,CAAEsJ,KAAM4D,EAAM5D,KAAMqD,MAAOA,EAAO8F,WAAYtG,KAGpFrN,KAAKkO,SAASlO,KAAK4N,OACvB,IAGJ3N,EAAMsN,YAAYyP,kBAAoB1P,EAAQlN,OAAO,CACjD6c,YAAY,EACZ5c,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKmY,WAAa7X,EAAQmN,SAAS2K,WACvC,EACAnK,KAAM,WACF,IAAIhO,EAAMqb,QAAQlD,UAAU6D,KAGxB,MAAO,CAAExN,OAAQ,QAASC,KAAM,eAFhC9K,SAAS8X,YAAY,MAI7B,IAGJzb,EAAMsN,YAAY2P,cAAgB5P,EAAQlN,OAAO,CAC7CY,KAAM,WACFhB,KAAK6N,QAAQsP,OAAOnd,KAAK4N,OAC7B,EACAK,KAAM,WACF,IAAIJ,EAAQ7N,KAAK6N,QACjB7N,KAAK4N,OAASC,EAAMuP,YACpBvP,EAAMsP,QAAQnd,KAAK4N,OACvB,IAGJ3N,EAAMsN,YAAY8P,YAAc/P,EAAQlN,OAAO,CAC3CY,KAAM,WACUhB,KAAK6N,QAAQmB,QACnBd,SAASlO,KAAK4N,OACxB,EACAK,KAAM,WACF,IAAIJ,EAAQ7N,KAAK6N,QACbmB,EAAQnB,EAAMmB,QACdmI,EAAanI,EAAMmI,aACnB9B,EAAMrV,KAAKM,QAAQ0O,MAAQmI,EAAWtG,QAAQwE,IAAOrV,KAAKM,QAAQgd,QAAU,EAC5EC,EAAmC,QAAvBvd,KAAKM,QAAQ4B,MAE7BlC,KAAK4N,OAASoB,EAAMb,WAEhBnO,KAAKM,QAAQ0O,QACbnB,EAAQ7N,KAAKwd,eAGjB,IAAI/O,EAASZ,EAAM4P,WACnB,GAAIhP,EACA,MAAO,CAAEA,OAAQ,QAASC,KAAMD,EAAOtF,MAG3C0E,EAAM3K,KAAK,CAAEoa,OAAQjI,EAAKkI,UAAWA,GACzC,EACAC,YAAa,WACT,IAAIxO,EAAQhP,KAAK6N,QAAQmB,QACzB,OAAO,IAAI/O,EAAMsN,YAAYuP,MAAM9N,EAAM0O,UAAW1O,EACxD,IAGJ,IAAI2O,EAAqB1d,EAAMsN,YAAYoQ,mBAAqBrQ,EAAQlN,OAAO,CAC3Ekd,OAAQ,WACJ,OAAOtd,KAAKM,QAAQgd,QAAU,CAClC,EACAtc,KAAM,WACUhB,KAAK6N,QAAQmB,QAEnB4O,YAAY5d,KAAKsd,UAEnBtd,KAAK4N,OAAOvM,QACZrB,KAAK6N,QAAQsP,OAAOnd,KAAK4N,OAEjC,EACAO,SAAU,WACN,IACI5I,EADQvF,KAAK6N,QAAQmB,QACLmO,SAEhB5X,IACAvF,KAAK4N,OAASrI,EAAQyS,QAAQmF,OAAO,SAASxW,GAC1C,OAAOA,EAAE+D,OAAS1K,KAAKsd,QAC3B,EAAEpO,KAAKlP,OAEf,EACAiO,KAAM,WACF,IAGI3N,EACAud,EAJAhQ,EAAQ7N,KAAK6N,QACbyP,EAAStd,KAAKsd,SACd/X,EAAUsI,EAAMmB,QAAQmO,SAGxBW,GAAS,EAET9d,KAAKM,QAAQyd,YACbF,EAAa,CAAEP,OAAQA,EAAQH,OAAQ,IAAIld,EAAMsN,YAAYyQ,YAAYhe,KAAKM,QAAQyd,cAC/E/d,KAAKM,QAAQ2d,eACpBJ,EAAa,CAAEP,OAAQA,EAAQH,OAAQ,IAAIld,EAAMsN,YAAY2Q,aAAale,KAAKM,QAAQ2d,gBAG3Fje,KAAKmO,WAED5I,GAAWA,EAAQwJ,IAAIoP,GAAGtQ,EAAMgB,OAAStJ,EAAQyS,QAAQ3W,QACzDkE,EAAQyS,QAAQlJ,SAAQ,SAASsP,GACzBA,EAAQ1T,QAAU4S,IAClBQ,GAAS,EAEjB,IAEAxd,EAAUiF,EAAQyS,QAAQ7V,KAAI,SAASic,GACnC,OAAOA,EAAQ1T,QAAU4S,EAASO,EAAa,CAAEP,OAAQc,EAAQ1T,MAAOyS,OAAQiB,EAAQjB,OAC5F,IAEKW,GACDxd,EAAQK,KAAKkd,IAGjBvd,EAAUud,EAGdhQ,EAAMsP,OAAO7c,EACjB,IAGJL,EAAMsN,YAAY8Q,mBAAqBV,EAAmBvd,OAAO,CAC7D6N,KAAM,WACF,IAAIJ,EAAQ7N,KAAK6N,QACbyP,EAAStd,KAAKsd,SAElBtd,KAAKmO,WACLN,EAAM+P,YAAYN,EACtB,IAGJrd,EAAMsN,YAAY+Q,gBAAkBhR,EAAQlN,OAAO,CAC/CC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKue,KAAOje,EAAQie,IACxB,EAEAvd,KAAM,WACUhB,KAAK6N,QAAQmB,QACnBwP,aAAaxe,KAAK4N,OAC5B,EAEAK,KAAM,WACF,IAAIe,EAAQhP,KAAK6N,QAAQmB,QACzBhP,KAAK4N,OAASoB,EAAMyP,eAEH,OAAbze,KAAKue,KACLvP,EAAM0P,cAAcC,mBAEpB3P,EAAM0P,cAAcE,qBAE5B,IAGJ3e,EAAMsN,YAAYsR,kBAAoB5e,EAAMsN,YAAY+Q,gBAAgBle,OAAO,CAC3E6N,KAAM,WACF,IAAIe,EAAQhP,KAAK6N,QAAQmB,QACzBhP,KAAK4N,OAASoB,EAAMyP,eAEH,OAAbze,KAAKue,KACLvP,EAAM0P,cAAcI,qBAEpB9P,EAAM0P,cAAcK,uBAE5B,IAGJ,IAAIC,EAAgB1R,EAAQlN,OAAO,CAC/B6N,KAAM,WACFjO,KAAKif,eAAiBjf,KAAKkf,QAAQlf,KAAK6N,SACxC7N,KAAK4N,OAAS5N,KAAKif,eAAe9Q,WAClCnO,KAAKmf,SAAWnf,KAAKoU,MAAMpU,KAAKif,eAAejQ,QACnD,EACAhO,KAAM,WACF,IAAInB,EAAOG,KACP6N,EAAQhO,EAAKof,eACbjQ,EAAQnB,EAAMmB,QAClBA,EAAMmG,OAAM,WACRtV,EAAKsf,SAASrQ,SAAQ,SAASrI,GAC3B5G,EAAKuf,SAASpQ,EAAOvI,GACrBuI,EAAMqQ,yBAAyB5Y,EAAE6Y,SACrC,IACAzR,EAAMK,SAASrO,EAAK+N,OACxB,GAAG,CAAEmC,QAAQ,EAAMkH,QAAQ,EAAMlI,IAAKlB,EAAMgB,KAAM0Q,SAAS,GAC/D,IAGJtf,EAAMsN,YAAYiS,iBAAmBR,EAAc5e,OAAO,CACtD8e,QAAS,SAASrR,GACd,OAAOA,EAAM8M,OAAO,CAAE8E,MAAOC,IAAUC,MAAQD,KACnD,EACAtL,MAAO,SAASpF,GACZ,OAAOA,EAAM0P,cAAckB,oBAC/B,EACAR,SAAU,SAASpQ,EAAOvI,GACtBuI,EAAM6Q,UAAUpZ,EAAEiE,OAClBsE,EAAMqD,UAAU5L,EAAEiE,MAAOjE,EAAErC,OAC/B,IAGJnE,EAAMsN,YAAYuS,oBAAsBd,EAAc5e,OAAO,CACzD8e,QAAS,SAASrR,GACd,OAAOA,EAAM8M,OAAO,CAAEoF,KAAML,IAAUM,OAASN,KACnD,EACAtL,MAAO,SAASpF,GACZ,OAAOA,EAAM0P,cAAcuB,uBAC/B,EACAb,SAAU,SAASpQ,EAAOvI,GACtBuI,EAAMkR,aAAazZ,EAAEiE,OACrBsE,EAAMmD,YAAY1L,EAAEiE,MAAOjE,EAAEtC,MACjC,IAGJ,IAAIgc,EAAa7S,EAAQlN,OAAO,CAC5BC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKiS,OAAS3R,EAAQ4B,KAC1B,EACAlB,KAAM,WACF,IAAInB,EAAOG,KACPgP,EAAQnP,EAAKgO,QAAQmB,QACzBA,EAAMmG,OAAM,WACR,IAAK,IAAI5R,EAAI1D,EAAKugB,KAAKC,QAAS9c,GAAK,GACjC1D,EAAKuf,SAASpQ,EAAOnP,EAAKugB,KAAKE,KAEvC,GAAG,CAAEvQ,QAAQ,EAAMkH,QAAQ,GAC/B,IAGJhX,EAAMsN,YAAYgT,iBAAmBJ,EAAW/f,OAAO,CACnD6N,KAAM,WACF,IAAI/L,EAAQlC,KAAKiS,OACbjD,EAAQhP,KAAK6N,QAAQmB,QAGrBhP,KAAKogB,KADK,SAAVle,EACY8M,EAAM0P,cAAc8B,gBAEpBxR,EAAM0P,cAAc+B,gBAExC,EACArB,SAAU,SAASpQ,EAAOtE,GACtBsE,EAAM0R,aAAahW,EACvB,IAGJzK,EAAMsN,YAAYoT,cAAgBR,EAAW/f,OAAO,CAChD6N,KAAM,WACF,IAAI/L,EAAQlC,KAAKiS,OACbjD,EAAQhP,KAAK6N,QAAQmB,QAGrBhP,KAAKogB,KADK,UAAVle,EACY8M,EAAM0P,cAAckC,cAEpB5R,EAAM0P,cAAcmC,aAExC,EACAzB,SAAU,SAASpQ,EAAOtE,GACtBsE,EAAM8R,UAAUpW,EACpB,IAGJzK,EAAMsN,YAAYwT,sBAAwBzT,EAAQlN,OAAO,CACrDC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAKiS,OAAS3R,EAAQ4B,KAC1B,EACA+L,KAAM,WACF,IAAIpO,EAAOG,KAAMgP,EAAQnP,EAAKgO,QAAQmB,QAEtC,GADAhP,KAAKmO,YACDa,EAAM9N,QAAQ,WAAY,CAAEsJ,KAAM3K,EAAKoS,OAAQpE,MAAOhO,EAAKgO,QAAS8F,WAAYtG,IAGpF,IACI2B,EAAMmF,qBAAoB,WACtBtU,EAAKgO,QAAQmT,WAAWnhB,EAAKoS,OACjC,GACJ,CAAE,MAAM5J,GACJ,GAAIA,aAAcpI,EAAMsN,YAAYkH,KAAKC,WACrC,MAAO,CACHnG,MAAQ,mBACRvJ,KAAQqD,EAAG,GACXoG,OAAQ,SAGZ,MAAMpG,CAEd,CACJ,EACArH,KAAM,WACF,IAAIqT,EAAYrU,KAAK6N,QACjBO,EAAQpO,KAAK4N,OACbyG,EAAUrF,QAAQ9N,QAAQ,WAAY,CAAEsJ,KAAM4D,EAAM5D,KAAK,GAAG,GAAGwW,WAAYnT,MAAOwG,EAAWV,WAAYtG,KAG7GrN,KAAKkO,SAASlO,KAAK4N,OACvB,IAGJ3N,EAAMsN,YAAY0T,YAAc3T,EAAQlN,OAAO,CAC3C6c,YAAY,EACZhP,KAAM,WAEF,GAAmC,OADxBjO,KAAKM,QAAQ4B,MACfgK,KAAKgV,MAAM,WAChB,MAAO,CAAEzS,OAAQ,QAASC,KAAM,mBAGpC,IAAIjB,EAAWzN,KAAKM,QAAQmN,SAC5BA,EAAS0T,SAASnhB,KAAKM,QAAQ4B,OAAOkf,MAAK,WACvC,IAAIC,EAAS5T,EAAS6T,kBAClBD,GAAUA,EAAOhgB,QACjBoM,EAAS+N,MAAM+F,WAAW,cAAe,CACrCF,OAAQA,GAGpB,GACJ,IAGJphB,EAAMsN,YAAYiU,cAAgBlU,EAAQlN,OAAO,CAC7C6c,YAAY,EACZhP,KAAM,WACF,IAAIwT,EAAWzhB,KAAKM,QAAQ4L,KAAOlM,KAAKM,QAAQohB,UACjB,UAA3B1hB,KAAKM,QAAQohB,UACb1hB,KAAKM,QAAQmN,SAASkU,YAAY,CAC9BF,SAAUA,IAEoB,SAA3BzhB,KAAKM,QAAQohB,WACpB1hB,KAAKM,QAAQmN,SAASmU,UAAUpgB,EAAEpB,OAAOJ,KAAKM,QAAQuhB,IAAK,CAACpU,SAAUzN,KAAKM,QAAQmN,SAAUgU,SAAUA,IAE/G,IAGJ,IAAIK,EAAcxU,EAAQlN,OAAO,CAC7BC,KAAM,SAASC,GACXgN,EAAQ/M,GAAGF,KAAKG,KAAKR,KAAMM,GAC3BN,KAAK+hB,MAAQzhB,EAAQ4L,KACrBlM,KAAKiS,OAAS3R,EAAQ4B,KAC1B,EACAiM,SAAU,WACNnO,KAAK4N,OAAS5N,KAAKwN,UAAUwU,eAAehiB,KAAK+hB,MACrD,EACA7T,SAAU,WACNlO,KAAKwN,UAAUwU,eAAehiB,KAAK+hB,MAAO/hB,KAAK4N,QAC/C5N,KAAKwN,UAAUtM,QAAQ,SAAU,CAAE+V,QAAQ,GAC/C,IAGJhX,EAAMsN,YAAY0U,kBAAoBH,EAAY1hB,OAAO,CACrD6N,KAAM,WACFjO,KAAKmO,WACL,IACInO,KAAKwN,UAAU0U,WAAWliB,KAAK+hB,MAAO/hB,KAAKiS,QAC3CjS,KAAKwN,UAAUtM,QAAQ,SAAU,CAAE+V,QAAQ,GAC/C,CAAE,MAAM5O,GACJ,MAAO,CACHkG,MAAO,QACPvJ,KAAMqD,EAAG,GACToG,OAAQ,QAEhB,CACJ,IAGJxO,EAAMsN,YAAY4U,kBAAoBL,EAAY1hB,OAAO,CACrD6N,KAAM,WACFjO,KAAKmO,WACLnO,KAAKwN,UAAU4U,aAAapiB,KAAK+hB,OACjC/hB,KAAKwN,UAAUtM,QAAQ,SAAU,CAAE+V,QAAQ,GAC/C,GAGP,CApzCD,CAozCGhX,OAEH,SAAUA,GAEN,IAAIuB,EAAIvB,EAAMwF,OAMV4c,EAAapiB,EAAMqiB,GAAGC,OAAOniB,OAAO,CACpCC,KAAM,SAAS+d,EAAS9d,GACpBL,EAAMqiB,GAAGC,OAAO/hB,KAAKR,KAAMoe,EAAS9d,GAEpC8d,EAAUpe,KAAKoe,QAAQoE,SAASH,EAAWI,WAAWC,SAEtDlhB,EAAEvB,EAAMqiB,GAAGK,KAAK,eAAeC,UAAUxE,GAEzC,IAAIyE,EAAkBzE,EAAQja,QAE9BnE,KAAK8iB,aAAe,IAAI7iB,EAAMsN,YAAYwV,aAAavhB,EAAE,UACpDwhB,SAAS5E,GAAU,CAAEyE,gBAAiBA,EAAiBI,UAAW3iB,GAAW,CAAC,GAAG2iB,UAC1F,EAEAC,QAAS,WACDljB,KAAK8iB,cACL9iB,KAAK8iB,aAAaI,UAEtBljB,KAAK8iB,aAAe,IACxB,IAGJ7iB,EAAMsN,YAAY8U,WAAaA,EAC/B7gB,EAAEpB,QAAO,EAAMiiB,EAAY,CAAEI,WA3BZ,CACbC,QAAS,8BA2BhB,CAhCD,CAgCGjhB,OAAOxB,OAEV,SAAUA,EAAOwB,GAKb,IAAID,EAAIvB,EAAMwF,OACV8c,EAAStiB,EAAMqiB,GAAGC,OAClBY,EAAK,qBACLC,EAAOnjB,EAAMmjB,KAKbC,EAAS,CACT,cACA,YACA,eACA,aACA,cACA,iBACA,iBACA,eAIAC,EAAY,CACZ,GAAI,MACJ,GAAI,OACJ,GAAI,QACJ,GAAI,MACJ,GAAI,OACJ,GAAI,YAGJC,EAAwB,mBAExBR,EAAeR,EAAOniB,OAAO,CAC7BC,KAAM,SAAS+d,EAAS9d,GACpBiiB,EAAO/hB,KAAKR,KAAMoe,EAAS9d,GAC3B,IAAIkjB,IAAsBljB,GAAW,CAAC,GAAG2iB,UAAY,CAAC,GAAGH,cAAgB,iBAEzE1E,EAAUpe,KAAKoe,SAEPoE,SAASO,EAAaN,WAAWC,SACpCe,KAAK,gBAAiB,QACtBA,KAAK,OAAQ,YACbA,KAAK,QAASD,GACdC,KAAK,iBAAiB,GACtBA,KAAK,mBAAmB,GACxBA,KAAK,cAAc,GACnBC,IAAI,cAAe,OAEpBpjB,GAAWA,EAAQuiB,iBACnBzE,EAAQsF,IAAI,YAAapjB,EAAQuiB,gBAAkB,GAAK,MAGxD7iB,KAAKM,QAAQqjB,WACbvF,EAAQwF,GAAG,QAAS5jB,KAAK6jB,MAAM3U,KAAKlP,OAGxCA,KAAK8jB,iBAAmB,GAExB9jB,KAAK+jB,iBAEL/jB,KAAKgkB,eAELhkB,KAAKikB,SAELjkB,KAAKkkB,WAEL9F,EACKwF,GAAG,UAAW5jB,KAAKmkB,SAASjV,KAAKlP,OACjC4jB,GAAG,QAAS5jB,KAAKokB,OAAOlV,KAAKlP,OAC7B4jB,GAAG,OAAQ5jB,KAAKqkB,MAAMnV,KAAKlP,OAC3B4jB,GAAG,cAAe5jB,KAAKskB,OAAOpV,KAAKlP,OACnC4jB,GAAG,QAAS5jB,KAAKukB,OAAOrV,KAAKlP,OAC7B4jB,GAAG,QAAS5jB,KAAKwkB,OAAOtV,KAAKlP,MACtC,EAEAM,QAAS,CACL4L,KAAM,eACNyX,WAAW,EACXc,eAAgB,aAChBC,aAAc,GACdC,UAAW,EACX9B,gBAAiB,MAGrBniB,OAAQ,CACJ,QACA,SAGJwS,OAAQ,SAASA,GACb,QAAepG,IAAXoG,EACA,MAAgD,SAAzClT,KAAKoe,QAAQqF,KAAK,mBAGzBvQ,EACAlT,KAAKoe,QAAQqF,KAAK,kBAAmBvQ,GAErClT,KAAKoe,QAAQwG,WAAW,mBAG5B5kB,KAAKoe,QAAQyG,YAAY,cAAe3R,EAC5C,EAEA4R,OAAQ,WACJ,IAAIC,EAAM/kB,KAAKoe,QAAQ,GACnB4G,EAAMvjB,EAAOwjB,eACb3Z,EAAI4Z,EAAOF,EAAIG,UAAWH,EAAII,aAC9BlL,EAAIgL,EAAOF,EAAIK,WAAYL,EAAIM,cACnC,GAAS,MAALha,GAAkB,MAAL4O,EAAW,CACxB,GAAI5O,EAAI4O,EAAG,CACP,IAAI/M,EAAM7B,EACVA,EAAI4O,EACJA,EAAI/M,CACR,CACA,MAAO,CAAEoY,MAAOja,EAAGka,IAAKtL,EAAGuL,UAAWna,GAAK4O,EAC/C,CACA,SAASgL,EAAOQ,EAAY5f,GACxB,KACI,SAAU6f,EAAKC,GACX,GAAIA,IAASF,EACT,MAAM5f,EACH,GAAqB,GAAjB8f,EAAKC,SACZ,IAAK,IAAItiB,EAAIqiB,EAAKE,WAAYviB,EAAGA,EAAIA,EAAEwiB,YACnCJ,EAAKpiB,QAEe,GAAjBqiB,EAAKC,WACZ/f,GAAO8f,EAAKI,UAAU3kB,OAE7B,CAVD,CAUG0jB,EACP,CAAE,MAAOra,GACL,OAAOA,CACX,CACJ,CACJ,EAEAub,OAAQ,SAASV,EAAOC,GACpB,IAkBgBla,EAAG4O,EAlBfgM,EAAMlmB,KAAKoe,QAAQ,GAOvB,GANAmH,EAAQL,EAAOgB,EAAKX,GAEhBC,EADO,MAAPA,EACMN,EAAOgB,EAAKV,GAEZD,EAENA,GAASC,EAAK,CACd,IAAI3X,EAAQjK,SAASuiB,cACrBtY,EAAMuY,SAASb,EAAMK,KAAML,EAAMzf,KACjC+H,EAAMwY,OAAOb,EAAII,KAAMJ,EAAI1f,KAC3B,IAAIkf,EAAMvjB,EAAOwjB,eACb3R,EAAe0R,EAAIsB,WAAW,GAMnBpM,EALG5G,IAKNhI,EALDuC,GAOL0Y,aAAerM,EAAEqM,aACnBjb,EAAEkb,WAAatM,EAAEsM,WACjBlb,EAAEmb,gBAAkBvM,EAAEwM,cACtBpb,EAAEob,cAAgBxM,EAAEwM,gBATpB1B,EAAI2B,kBACJ3B,EAAI4B,SAAS/Y,GAErB,CASA,SAASqX,EAAOU,EAAM9f,GAClB,KACI,SAAU6f,EAAKC,GACX,GAAqB,GAAjBA,EAAKC,SAA0B,CAC/B,IAAIgB,EAAMjB,EAAKI,UAAU3kB,OACzB,GAAIwlB,GAAO/gB,EACP,MAAM8f,EAEV9f,GAAO+gB,CACX,MAAO,GAAqB,GAAjBjB,EAAKC,SACZ,IAAK,IAAItiB,EAAIqiB,EAAKE,WAAYviB,EAAGA,EAAIA,EAAEwiB,YACnCJ,EAAKpiB,EAGhB,CAZD,CAYGqiB,EACP,CAAE,MAAOkB,GACL,MAAO,CAAElB,KAAMkB,EAAIhhB,IAAKA,EAC5B,CACJ,CACJ,EAEA0f,IAAK,WACDxlB,KAAKimB,OAAOjmB,KAAKqB,SACrB,EAEA0lB,KAAM,WACF/mB,KAAKimB,OAAO,EAChB,EAEAjY,OAAQ,WACJhO,KAAKimB,OAAO,EAAGjmB,KAAKqB,SACxB,EAEAA,OAAQ,WACJ,OAAOrB,KAAKkC,QAAQb,MACxB,EAEA0iB,eAAgB,WACZ,IACI7hB,EADA6D,EAAS,GAGb,IAAK,IAAI9D,KAAOhC,EAAMsN,YAAYkH,KAAKuS,QAAQC,MACtC1D,EAAsBtb,KAAKhG,KAC5BC,EAAQD,EAAIilB,cACZnhB,EAAOpF,KAAK,CAAEuB,MAAOA,EAAOU,KAAMV,KAI1ClC,KAAKmnB,cAAgB,IAAIlnB,EAAMuK,KAAK4c,WAAW,CAAE5c,KAAMzE,GAC3D,EAEAie,aAAc,WACV,IAAIqD,EAASpnB,EAAMqnB,OACnBtnB,KAAKoe,QAAQqF,KAAK,gBAAiB4D,GACnCrnB,KAAKunB,KAAO,IAAItnB,EAAMqiB,GAAGkF,WAAWhmB,EAAE,WAAW6lB,SAC5C7E,SAASO,EAAaN,WAAWgF,aACjCC,YAAY1nB,KAAKoe,SAAU,CACxBuJ,KAAM,CACFC,KAAM,OACNC,SAAU,YAEdC,UAAU,EACVC,YAAY,EACZC,OAAQhoB,KAAKioB,mBAAmB/Y,KAAKlP,MACrCkoB,WAAYloB,KAAKmnB,cACjBgB,eAAgB,QAChBC,SAAU,kBAGlBpoB,KAAKunB,KAAKnJ,QAAQwF,GAAG,aAAa,SAASyE,GACvCA,EAAEjP,gBACN,GACJ,EAEA6O,mBAAoB,WAChB,IAAIK,EAAWtoB,KAAKuoB,gBAEpB,GAAKD,IAAYtoB,KAAKwoB,MAAtB,CAIA,IAAIC,EAAcH,EAASI,MACvBC,EAAa3oB,KAAKunB,KAAKrlB,QAAQ,GAC/B0mB,EAAM,CACN9lB,SAAS,EACT4lB,MAAOD,EACPjD,IAAKiD,EAAYjD,KAGhB8C,EAASO,WAAyC,KAA5BP,EAASO,UAAU3mB,QAC1CymB,GAAc,KAGlB3oB,KAAK8oB,WAAWF,EAAKD,GACrB3oB,KAAK+oB,MAAMC,OAfX,CAgBJ,EAEA/E,OAAQ,WACJ,IAAIgF,EAAiBjpB,KAAKoe,QAC1Bpe,KAAK+oB,MAAQ,IAAI9oB,EAAMqiB,GAAG4G,MAAMlpB,KAAKunB,KAAKnJ,QAAS,CAC/C+K,OAAQnpB,KAAKoe,QACbgL,KAAM,SAASC,GAAMJ,EAAexF,KAAK,iBAAiB,EAAO,EACjEuF,MAAO,SAASK,GAAMJ,EAAexF,KAAK,iBAAiB,EAAQ,GAE3E,EAEAY,MAAO,WACHrkB,KAAK+oB,MAAMC,QACXM,aAAatpB,KAAKupB,UAClBvpB,KAAKkB,QAAQ,OACjB,EAEAsoB,WAAY,WACR,MAAO,KAAKvhB,KAAKjI,KAAKkC,QAC1B,EAEAiiB,SAAU,SAASkE,GACf,IAAIpmB,EAAMomB,EAAEoB,QACR3P,EAAO9Z,KAEPsjB,EAAUrhB,IACV6X,EAAKiP,MAAMC,QACXlP,EAAK4P,YAAa,GACX5P,EAAK6P,MAAM1nB,KAClB6X,EAAK4P,YAAa,EAClBrB,EAAEjP,kBAGNU,EAAK8P,gBAAkBC,WAAW/P,EAAKgQ,iBAAiB5a,KAAK4K,GACjE,EAEAsK,OAAQ,WACJ,IACIliB,EADA6mB,EAAQ/oB,KAAK+oB,MAGb/oB,KAAKwpB,eAAiBxpB,KAAK0pB,aAC3BxnB,IAAUlC,KAAKuoB,iBAAmB,CAAC,GAAGG,OAAS,CAAC,GAAGxmB,MAEnDlC,KAAKmd,OAAOjb,GAEPA,GAAUlC,KAAKmnB,cAAc4C,OAAO1oB,QAGrC0nB,EAAMA,EAAMiB,UAAY,WAAa,UACrChqB,KAAKunB,KAAK0C,cAHVlB,EAAMC,SAOdhpB,KAAK0pB,YAAa,EAClB1pB,KAAK8pB,mBAEL9pB,KAAKkB,QAAQ,QACjB,EAEAojB,OAAQ,WACJtkB,KAAK8pB,kBACT,EAEAvF,OAAQ,WACJsF,WAAW7pB,KAAKkqB,MAAMhb,KAAKlP,OAC3BA,KAAKmqB,cAAgBN,WAAW7pB,KAAK8pB,iBAAiB5a,KAAKlP,OAC3DA,KAAKkB,QAAQ,QACjB,EAEAsjB,OAAQ,SAAS6E,GACbA,EAAGjQ,iBACH,IACIxW,EADAkD,EAAM9F,KAAK8kB,SAGXliB,EADA3C,EAAMqb,QAAQ8O,QAAQC,KACf5oB,EAAO6oB,cAAcC,QAAQ,QAE7BlB,EAAGmB,cAAcF,cAAcC,QAAQ,cAElD,IAAIE,EAAMzqB,KAAKkC,QACfuoB,EAAMA,EAAIC,OAAO,EAAG5kB,EAAIyf,OAAS3iB,EAAO6nB,EAAIC,OAAO5kB,EAAI0f,KACvDxlB,KAAKkC,MAAMuoB,GACXzqB,KAAKimB,OAAOngB,EAAIyf,MAAQ3iB,EAAKvB,QAC7BrB,KAAK6jB,OACT,EAEA8F,MAAO,SAAS1nB,GACZ,IAAIslB,EAAOvnB,KAAKunB,KACZwB,EAAQ/oB,KAAK+oB,MACjB,GAAIA,EAAMiB,UAAW,CACjB,GAAI/nB,IAAQmhB,EAAKuH,KAKb,OAJApD,EAAKqD,YACArD,EAAK9L,SACN8L,EAAK0C,cAEF,EAEX,GAAIhoB,IAAQmhB,EAAKyH,GAKb,OAJAtD,EAAKuD,YACAvD,EAAK9L,SACN8L,EAAKwD,aAEF,EAEX,GAAI9oB,IAAQmhB,EAAK4H,MAGb,OAFAzD,EAAKvZ,OAAOuZ,EAAK9L,SACjBsN,EAAMC,SACC,EAEX,GAAI/mB,IAAQmhB,EAAK6H,IAGb,OAFA1D,EAAKvZ,OAAOuZ,EAAK9L,SACjBsN,EAAMC,SACC,EAEX,GAAI/mB,IAAQmhB,EAAK8H,OAEb,OADA3D,EAAK0C,cACE,EAEX,GAAIhoB,IAAQmhB,EAAK+H,SAEb,OADA5D,EAAKwD,aACE,CAEf,CACA,OAAO9oB,IAAQmhB,EAAK4H,OAAS/oB,IAAQmhB,EAAK6H,GAC9C,EAEA1C,cAAe,WACX,IAAI6C,EAAQprB,KAAK8kB,SACb5iB,EAAQlC,KAAKkC,QAEjB,IAAKA,IAAUkpB,IAAUA,EAAM3F,UAC3B,OAAO,KAMX,IAHA,IACI4F,EADAC,EAASrrB,EAAMsN,YAAYkH,KAAK8W,SAASrpB,EAAOlC,KAAK0T,MAAO1T,KAAKqV,OAG5D9R,EAAI,EAAGA,EAAI+nB,EAAOjqB,SAAUkC,EAEjC,GAAIioB,EADJH,EAAMC,EAAO/nB,GACI6nB,IAAU,qBAAqBnjB,KAAKojB,EAAI3c,MACrD,MAAO,CAAEga,MAAO2C,EAAKxC,UAAWyC,EAAO/nB,EAAI,IAInD,OAAO,IACX,EAEA2mB,MAAO,WACClqB,KAAKyrB,eAAiBzrB,KAAK0rB,YAC3B1rB,KAAKyrB,cAAcvpB,MAAMlC,KAAKkC,QAEtC,EAEAypB,eAAgB,WACZ,IAAIC,EAAiB3rB,EAAM4rB,kBAAkB7rB,KAAKoe,QAAQ,GAAIiF,GAE9DuI,EAAeE,SAAW,WAC1BF,EAAeG,WAAa,SAC5BH,EAAeI,WAAa,MAC5BJ,EAAe7L,KAAO,KACtB6L,EAAenM,MAAQ,KAEvBzf,KAAKisB,MAAQzqB,EAAE,oCAAoCkiB,IAAIkI,GAAgBlE,YAAY1nB,KAAKoe,QAC5F,EAEA8F,SAAU,WACNlkB,KAAKksB,aAAe1qB,EAAE,oFAAoFkmB,YAAY1nB,KAAKoe,QAC/H,EAEA+N,QAAS,SAASjqB,GACdlC,KAAKksB,aAAatpB,KAAKV,EAC3B,EAEAkqB,cAAe,SAASC,GACpBrsB,KAAKksB,aAAaI,OAAOD,EAC7B,EAEAX,SAAU,WACN,OAAO1rB,KAAKoe,QAAQ,KAAOne,EAAMssB,gBACrC,EAEApP,OAAQ,SAASjb,IACRA,GAASA,EAAMb,OAASrB,KAAKM,QAAQqkB,YAI1C3kB,KAAKwoB,OAAQ,EACbxoB,KAAKunB,KAAKvZ,QAAQ,GAClBhO,KAAKwoB,OAAQ,EAEbxoB,KAAKmnB,cAAchK,OAAO,CACtBqP,MAAOxsB,KAAKunB,KAAKjnB,QAAQ6nB,eACzBsE,SAAUzsB,KAAKM,QAAQmkB,eACvBviB,MAAOA,IAEf,EAEAwqB,KAAM,WACF1sB,KAAKkT,QAAO,GACZlT,KAAKoe,QAAQsO,OACb1sB,KAAKksB,aAAaQ,MACtB,EAEAL,KAAM,WACFrsB,KAAKkT,QAAO,GACZlT,KAAKoe,QAAQiO,MACjB,EAEA3Y,IAAK,WACD,GAAI1T,KAAKmX,WACL,OAAOnX,KAAKmX,WAAWzD,GAE/B,EAEA2B,IAAK,WACD,GAAIrV,KAAKmX,WACL,OAAOnX,KAAKmX,WAAW9B,GAE/B,EAEAyW,SAAU,SAASa,GACVA,IAIL3sB,KAAKqsB,OAELrsB,KAAKoe,QACAsF,IAAI,CACD3D,IAAO4M,EAAU5M,IAAM,EAAI,KAC3BN,KAAQkN,EAAUlN,KAAO,EAAI,OAGrCzf,KAAKksB,aAAaxI,IAAI,CAClB3D,IAAQ4M,EAAU5M,IAAM/f,KAAKksB,aAAa9nB,SAAW,GAAM,KAC3Dqb,KAAQkN,EAAUlN,OAE1B,EAEA9E,OAAQ,SAASgS,GACRA,GAIL3sB,KAAKoe,QAAQsF,IAAI,CACbvf,MAAOwoB,EAAUxoB,MAAQ,EACzBC,OAAQuoB,EAAUvoB,OAAS,GAEnC,EAEAwoB,aAAc,SAASC,GACnB,OAAO7sB,KAAK8sB,cAAcD,EAC9B,EAEAC,cAAe,SAASD,GACpB,GAAI7sB,KAAK+oB,MAAMiB,UACX,OAAO,KAEX,IAEIsB,EAAQD,EAFR0B,EAAaF,EACbzB,EAAQprB,KAAK8kB,SAGjB,GAAIsG,GAASprB,KAAKwpB,aAAc,CAC5B,GAAoB,IAAhB4B,EAAM7F,MACN,OAAO,KAGX+F,EAASrrB,EAAMsN,YAAYkH,KAAK8W,SAASvrB,KAAKkC,QAASlC,KAAK0T,MAAO1T,KAAKqV,OAExE,IAAK,IAAI9R,EAAI,EAAGA,EAAI+nB,EAAOjqB,SAAUkC,EAAG,CAEpC,GAAIioB,EADJH,EAAMC,EAAO/nB,GACI6nB,GACb,OAAO4B,EAAW3B,GAEtB,GAAI4B,EAAW5B,GACX,OAAO6B,EAAiB5B,EAAO/nB,EAAE,GAAI8nB,EAE7C,CACA,OAAO6B,EAAiB7B,EAAK,KACjC,CAEA,OAAO,KAEP,SAAS4B,EAAW5B,GAChB,OAAOA,EAAI9F,MAAQ6F,EAAM7F,KAC7B,CACA,SAASyH,EAAW3B,GAChB,GAAIA,EAAK,CACL,GAAI,6BAA6BpjB,KAAKojB,EAAI3c,MACtC,MAAO,CAAE5L,SAAS,EAAM4lB,MAAO2C,EAAK7F,IAAK6F,EAAI7F,KAEjD,GAAI,yBAAyBvd,KAAKojB,EAAI3c,MAClC,OAAI2c,EAAI7F,KAAO4F,EAAM5F,IACV0H,EAAiB7B,EAAKC,EAAO/nB,EAAE,IAEnC2pB,EAAiB5B,EAAO/nB,EAAE,GAAI8nB,EAE7C,CACJ,CACA,SAAS6B,EAAiBzN,EAAME,GAC5B,GAAY,MAARF,EACA,OAAO,KAEX,GAAa,MAATE,EACA,MAAI,oBAAoB1X,KAAKwX,EAAK/Q,OAASye,EAAY1N,EAAKvd,OACjD,CAAEwmB,MAAOjJ,EAAM+F,IAAK4F,EAAM5F,KAE9B,KAEX,GAAIuH,GACA,GAAiB,MAAbtN,EAAK/Q,MAAgB,gBAAgBzG,KAAK0X,EAAMjR,MAChD,MAAO,CAAEga,MAAOjJ,EAAM+F,IAAK4F,EAAM5F,SAElC,CACH,GAAiB,YAAb/F,EAAK/Q,KACL,MAAO,CAAEga,MAAOjJ,EAAM+F,IAAK4F,EAAM5F,KAErC,GAAI,gBAAgBvd,KAAKwX,EAAK/Q,OAAS,WAAWzG,KAAKwX,EAAKvd,OACxD,MAAO,CAAEwmB,MAAOjJ,EAAM+F,IAAK4F,EAAM5F,KAErC,GAAI,eAAevd,KAAKwX,EAAK/Q,MACzB,MAAO,CAAEga,MAAOjJ,EAAM3c,SAAS,EAAM0iB,IAAK/F,EAAK+F,KAEnD,GAAI,eAAevd,KAAK0X,EAAMjR,MAC1B,MAAO,CAAEga,MAAO/I,EAAO7c,SAAS,EAAM0iB,IAAK7F,EAAM6F,IAEzD,CACA,OAAO,CACX,CACJ,EAEA4H,WAAY,SAASpe,GACjB,IAAIvI,EAAIzG,KAAK8sB,gBACb,GAAIrmB,EAAG,CACH,IAAIsI,EAAMC,EAAM2J,YAAY9J,KAAKwe,WAAW5d,QAAQ6d,SAAS,EAAG,EAAG,GAC/Dte,EAAMue,SAASxe,KACfA,EAAMA,EAAI8B,SAEV7B,IAAUhP,KAAK0Y,cACf3J,EAAMA,EAAIye,SAASxe,EAAM9C,QAAQ,IAErClM,KAAK8oB,WAAWriB,EAAGsI,EAAI0e,MAAM,EAAG,GACpC,CACJ,EAEA3E,WAAY,SAASF,EAAK8E,GACtB,IAAIxrB,EAAQlC,KAAKkC,QACbmpB,EAAMzC,EAAIF,MACViF,EAAOzrB,EAAMwoB,OAAO9B,EAAIpD,KAExB4F,GADJlpB,EAAQA,EAAMwoB,OAAO,EAAG9B,EAAI9lB,QAAUuoB,EAAI9F,MAAQqD,EAAIpD,KAAOkI,GAC3CrsB,OAClBa,GAASyrB,EACT3tB,KAAKiS,OAAO/P,GACZlC,KAAKimB,OAAOmF,GACZprB,KAAK6jB,QACL7jB,KAAK8pB,kBACT,EAEA8D,SAAU,SAAS9K,GACf,IAKqC+K,EALjChuB,EAAOG,KAIP8tB,EAAY,QAAU3K,EACtB4K,EAAUluB,EAAKqqB,MAAMhb,KAAKrP,GAC1BI,EAAMqb,QAAQ8O,QAAQC,OACtByD,EAAY,UAAY3K,EACxB0K,EAAY,WACRhE,WAAWkE,EACf,GAGJluB,EAAK4rB,cAAgB3I,EACrBjjB,EAAKue,QAAQ4P,IAAIF,GAAWlK,GAAGkK,EAAWD,GAAaE,EAC3D,EAEAlK,MAAO,WACH,IACI1f,EAAOC,EADPga,EAAUpe,KAAKoe,QAEf6P,EAAoBzsB,EAAE,uBAAwB4c,EAAQ8P,SAErDluB,KAAKisB,OACNjsB,KAAK2rB,iBAGT3rB,KAAKisB,MAAMkC,KAAK/P,EAAQ+P,QAExBhqB,EAAQnE,KAAKisB,MAAM9nB,QAAUnE,KAAKM,QAAQokB,aAC1CtgB,EAASpE,KAAKisB,MAAM7nB,SAAW6pB,EAAkBG,cAE7CjqB,EAAQia,EAAQja,SAChBia,EAAQja,MAAMA,GAEdC,EAASga,EAAQha,UACjBga,EAAQha,OAAOA,GAGnBpE,KAAKkqB,OACT,EAEAjY,OAAQ,SAAS/P,GACblC,KAAKoe,QAAQxb,KAAKV,EACtB,EAEAA,MAAO,SAASA,GACZ,QAAc4K,IAAV5K,EAGA,OADUlC,KAAKoe,QAAQ,GAAGiQ,UACfvrB,QAAQ,MAAO,IAG9B9C,KAAKiS,OAAO/P,GACZlC,KAAK8pB,kBACT,EAEAwE,gBAAiB,WACb,OAAOtuB,KAAK8jB,iBAAiBhjB,OACjC,EAEAgpB,iBAAkB,WACd,IAAIhkB,EAAM9F,KAAK8kB,SACX5iB,EAAQlC,KAAKkC,QACbqsB,EAAatuB,EAAMsN,YAAYihB,KAAK/L,WAAWgM,OAC/CH,EAAkB,GAClBI,EAAW,EACXC,EAAS,GACTrD,EAAS,GAGb,IAAIxlB,GAAQA,EAAI2f,UAAhB,CAQA,IAAM,KAAKxd,KAAK/F,GAaZ,OAVIlC,KAAK8jB,iBAAiBziB,SACtBrB,KAAK8jB,iBAAmB,GACxB9jB,KAAKoe,QAAQxb,KAAKV,SAIlBlC,KAAK+oB,OACL/oB,KAAK+oB,MAAMC,UAKfsC,EAASrrB,EAAMsN,YAAYkH,KAAK8W,SAASrpB,EAAOlC,KAAK0T,MAAO1T,KAAKqV,QAC1DvG,SAAQ,SAASuc,GASpB,GARAA,EAAIuD,QAAS,EACbvD,EAAIwD,IAAM,CAAE,YAAcxD,EAAI3c,MAEd,OAAZ2c,EAAI3c,OACJ2c,EAAIyD,WAAaP,EAAYG,IAAcH,EAAWltB,QACtDgqB,EAAIwD,IAAIluB,KAAK0qB,EAAIyD,YACjBR,EAAgB3tB,KAAK0qB,IAErBvlB,GAAmB,QAAZulB,EAAI3c,KACX,GAAIye,EAAY9B,EAAInpB,OAChBysB,EAAOI,QAAQ1D,QACZ,GA8EV,MADKtjB,EA7EsBsjB,EAAInpB,QA8ElB,KAAN6F,GAAmB,KAANA,EA9EmB,CAChC,IAAIqhB,EAAOuF,EAAOtnB,QACd+hB,GA+E5B,SAAyBJ,EAAOI,GAC5B,MAAe,KAARA,EAAuB,KAATJ,EACN,KAARI,EAAuB,KAATJ,EACN,KAARI,GAAuB,KAATJ,CAEzB,CAnFgCgG,CAAgB3D,EAAInpB,MAAOknB,EAAKlnB,QAMhCmpB,EAAIwD,IAAIluB,KAAK,kBACbyoB,EAAKyF,IAAIluB,KAAK,oBANV6qB,EAAQH,EAAKvlB,IAAQ0lB,EAAQpC,EAAMtjB,MACnCulB,EAAIwD,IAAIluB,KAAK,wBACbyoB,EAAKyF,IAAIluB,KAAK,yBAOtB0qB,EAAIwD,IAAIluB,KAAK,iBAErB,CA8DpB,IAAsBoH,EAeCmE,EA3EHpG,GAAO0lB,EAAQH,EAAKvlB,KACpBulB,EAAIwD,IAAIluB,KAAK,qBACb0qB,EAAIuD,QAAS,EACCvD,GAEF,QAAZA,EAAI3c,OAsEDxC,EAtEkCmf,EAAInpB,MAuElDjC,EAAMsN,YAAYkH,KAAKuS,QAAQC,MAAM/a,EAAK5F,iBAvEoBR,GAAQ0lB,EAAQH,EAAKvlB,IAC1EulB,EAAIwD,IAAIluB,KAAK,iBAErB,IACA2qB,EAAO2D,UAAUngB,SAAQ,SAASuc,GAC9B,IAAI9F,EAAQ8F,EAAI9F,MAAOC,EAAM6F,EAAI7F,IAC7B5iB,EAAO3C,EAAMivB,WAAWhtB,EAAMitB,UAAU5J,EAAOC,IACnDtjB,EAAQA,EAAMwoB,OAAO,EAAGnF,GACpB,gBAAkB8F,EAAIwD,IAAI1rB,KAAK,KAAO,KAAOP,EAAO,UACpDV,EAAMwoB,OAAOlF,EACrB,IACAxlB,KAAKoe,QAAQ+P,KAAKjsB,GAElB4D,GACA9F,KAAKimB,OAAOngB,EAAIyf,MAAOzf,EAAI0f,KAG/BxlB,KAAK8jB,iBAAmBwK,CArExB,CAsEJ,EAEApL,QAAS,WACLljB,KAAKyrB,cAAgB,KAErBzrB,KAAKoe,QAAQ4P,IAAI7K,GAEjBmG,aAAatpB,KAAKmqB,eAClBb,aAAatpB,KAAK4pB,iBAElB5pB,KAAKksB,aAAe,KACpBlsB,KAAKisB,MAAQ,KAEbjsB,KAAK+oB,MAAM7F,UACXljB,KAAK+oB,MAAQ,KAET/oB,KAAKunB,MACLvnB,KAAKunB,KAAKrE,UAGdX,EAAOhiB,GAAG2iB,QAAQ1iB,KAAKR,KAC3B,EAEAovB,cAAe,WACX,IAAI3E,EAAMzqB,KAAKkC,QACX4D,EAAM9F,KAAK8kB,SACXuK,EAAMvpB,EAAI0f,KAAOiF,EAAIppB,OACzBopB,EAAMA,EAAIC,OAAO,EAAG5kB,EAAIyf,QAAU8J,EAAM,OAAS,KAAO5E,EAAIC,OAAO5kB,EAAI0f,MACvExlB,KAAKkC,MAAMuoB,GACXzqB,KAAKimB,OAAOngB,EAAIyf,MAAQ,EAC5B,IAGJ,SAAS4H,EAAYplB,GACjB,MAAa,KAANA,GAAmB,KAANA,GAAmB,KAANA,CACrC,CAaA,SAASyjB,EAAQ1lB,EAAKkM,GAClB,OAAOlM,EAAIyf,OAASvT,EAAOuT,OAASzf,EAAI0f,KAAOxT,EAAOwT,GAC1D,CAMAvlB,EAAMsN,YAAYwV,aAAeA,EACjCvhB,EAAEpB,QAAO,EAAM2iB,EAAc,CAAEN,WA7yBd,CACbC,QAAS,8BACT+E,YAAa,+BA4yBpB,CAvzBD,CAuzBGxnB,MAAOwB,QAEV,SAAUxB,GAEN,IAAIuB,EAAIvB,EAAMwF,OAEV6d,EAAY,CACZ,EAAG,YACH,EAAG,MACH,GAAI,QACJ,GAAI,MACJ,GAAI,OACJ,GAAI,KACJ,GAAI,QACJ,GAAI,OACJ,GAAI,MACJ,GAAI,OACJ,GAAI,WACJ,GAAI,SACJ,GAAI,WACJ,GAAI,SACJ,IAAK,SAGLgM,EAAMC,UAAUC,SAAStI,cAAc3V,QAAQ,QAAU,EAmCzDke,EAAgBxvB,EAAM0B,MAAMvB,OAAO,CACnCC,KAAM,SAAS2R,EAAQ0d,EAAUC,GAkB7B,GAjBA3vB,KAAK4vB,UAAY,CAAC,EAClB5vB,KAAKgS,OAASA,EACdhS,KAAK6vB,UAAYH,GAAYjuB,OAE7BzB,KAAK8vB,aAAe9vB,KAAK+vB,QAAQ7gB,KAAKlP,MACtCA,KAAKgwB,WAAahwB,KAAKiwB,MAAM/gB,KAAKlP,MAClCA,KAAKkwB,WAAalwB,KAAKmwB,MAAMjhB,KAAKlP,MAClCA,KAAKowB,UAAY,EACjBpwB,KAAKqwB,eAAiB,KAEtBre,EAAO4R,GAAG,UAAW5jB,KAAK8vB,cAC1B9d,EAAO4R,GAAG,yEAA0E5jB,KAAKgwB,YACzFhe,EAAO4R,GAAG,qBAAsB5jB,KAAKkwB,YAErC1uB,EAAEoC,SAAS0sB,iBAAiB1M,GAAG,oBAAqB5jB,KAAKgwB,YACzDxuB,EAAEoC,SAAS0sB,iBAAiB1M,GAAG,qBAAsB5jB,KAAKkwB,YAEtDP,EACA,IAAK,IAAI1tB,KAAO0tB,EACZ3vB,KAAK4jB,GAAG3hB,EAAK0tB,EAAS1tB,GAGlC,EAEA8tB,QAAS,SAAS1H,GA7CR,IAAS9P,EACfkR,EACAvd,IA6CImc,EAAEkI,QAAqB,MAAVlI,EAAEpmB,KAAyB,MAAVomB,EAAEpmB,KAAyB,MAAVomB,EAAEpmB,MAIrDjC,KAAKwwB,YAAYnI,GAnDF9P,EAmDa8P,EAAEmC,cAlD9Bf,EAAUlR,EAAMkR,UAChBvd,EAAOoX,EAAUmG,KAhBR,SAASA,GACtB,OAAKA,EAAU,IAAMA,EAAU,IAC1BA,EAAU,IAAMA,EAAU,IAC1BA,EAAU,IAAMA,EAAU,KAC1BA,EAAU,KAAOA,EAAU,KAC3BA,EAAU,KAAOA,EAAU,KACf,MAAZA,CAMT,CAMiBgH,CAAWhH,KACpBvd,EAAO,cAONA,GAAQqM,EAAMtW,KAA2B,GAApBsW,EAAMtW,IAAIZ,SAChC6K,EAAO,aAGJA,GAoCP,EAEAikB,MAAO,SAAS9H,GACZroB,KAAKwwB,YAAYnI,EAAGA,EAAE3Z,KAC1B,EAEAuhB,MAAO,SAAS5H,GACZ,IAAIqI,EAEArI,EAAEsI,MACFD,EAAyB,GAAXrI,EAAEsI,MACTtI,EAAEuI,SACTF,EAA0B,GAAZrI,EAAEuI,QAGpB,IAAIliB,EAAO2Z,EAAE3Z,KAgBb,GAda,cAATA,IACIgiB,EACDhiB,EAAO,iBAEN1O,KAAKqwB,eAAiB,CAAE5pB,EAAG4hB,EAAEwI,MAAOC,EAAGzI,EAAE0I,QAIpC,YAATriB,IACKgiB,IACD1wB,KAAKqwB,eAAiB,OAIjB,cAAT3hB,GAAwB1O,KAAKqwB,eAAgB,CAC7C,IAAIW,EAAKhxB,KAAKqwB,eAAe5pB,EAAI4hB,EAAEwI,MAC/BI,EAAKjxB,KAAKqwB,eAAeS,EAAIzI,EAAE0I,MACpBtgB,KAAKygB,KAAKF,EAAGA,EAAKC,EAAGA,GAErBjxB,KAAKowB,YAChB1hB,EAAO,YAEf,CAEA1O,KAAKwwB,YAAYnI,EAAG3Z,EACxB,EAEA8hB,YAAa,SAASnI,EAAGnc,GACrB,IAAIilB,EAAW,GAEf9I,EAAE+I,IAAM9B,EAAMjH,EAAEgJ,QAAWhJ,EAAEiJ,UAAYjJ,EAAEkI,OAEvClI,EAAEkI,SACFY,GAAY,QAGZ9I,EAAEkJ,WACFJ,GAAY,UAGZ9I,EAAEiJ,UACFH,GAAY,SAGhBA,GAAYjlB,EAEZ,IAAIslB,EAAkBxxB,KAAK4vB,UAAU,KAAO1jB,GAExCslB,GACAA,EAAgBhxB,KAAKR,KAAK6vB,UAAWxH,EAAG8I,GAG5C,IAAIpD,EAAU/tB,KAAK4vB,UAAUuB,GAEzBpD,GACAA,EAAQvtB,KAAKR,KAAK6vB,UAAWxH,EAAG8I,EAExC,EAEAvN,GAAI,SAASrL,EAAO3J,GAChB,IAAI+gB,EAAW3vB,KAAK4vB,UAEI,iBAAbhhB,IACPA,EAAW5O,KAAK6vB,UAAUjhB,IAGT,iBAAV2J,IACPA,EAAQA,EAAMtS,MAAM,MAGxBsS,EAAMzJ,SAAQ,SAASuZ,GACnBsH,EAAStH,GAAKzZ,CAClB,GACJ,EAEAsU,QAAS,WACLljB,KAAKgS,OAAOgc,IAAI,UAAWhuB,KAAK8vB,cAChC9vB,KAAKgS,OAAOgc,IAAI,UAAWhuB,KAAKgwB,YAChCxuB,EAAEoC,SAAS0sB,iBAAiBtC,IAAI,oBAAqBhuB,KAAKgwB,WAC9D,IAGJ/vB,EAAMsN,YAAYkiB,cAAgBA,CACrC,CA9LD,CA8LGhuB,OAAOxB,OAEV,SAAUA,GAIN,IAAIwxB,EAAgBxxB,EAAM0B,MAAMvB,OAAO,CACnCC,KAAM,SAAcqxB,EAAOxvB,EAAOud,EAAME,GACpC3f,KAAK0xB,MAAQA,EACb1xB,KAAKkC,MAAQA,EACblC,KAAKyf,KAAOA,EACZzf,KAAK2f,MAAQA,CACjB,IAGAgS,EAAU,IAAI,WACd3xB,KAAKyf,KAAOzf,KACZA,KAAK2f,MAAQ3f,KACbA,KAAK0xB,MAAQ,CAChB,EAED,SAASE,EAAKhM,GACV,GAAIA,EAAKnG,KAAKiS,QAAU9L,EAAK8L,MAAO,CAChC,IAAIG,EAAOjM,EACXA,EAAOA,EAAKnG,KACZoS,EAAKpS,KAAOmG,EAAKjG,MACjBiG,EAAKjG,MAAQkS,CACjB,CAEA,OAAOjM,CACX,CAEA,SAAS3f,EAAM2f,GACX,GAAIA,EAAKjG,MAAMA,MAAM+R,QAAU9L,EAAK8L,MAAO,CACvC,IAAIG,EAAOjM,EACXA,EAAOA,EAAKjG,MACZkS,EAAKlS,MAAQiG,EAAKnG,KAClBmG,EAAKnG,KAAOoS,EACZjM,EAAK8L,OAAS,CAClB,CAEA,OAAO9L,CACX,CAEA,SAASkM,EAAOlM,EAAM1jB,GAClB,OAAI0jB,IAAS+L,EACF,IAAIF,EAAc,EAAGvvB,EAAOyvB,EAASA,IACrC/L,EAAK1jB,MAAM6vB,MAAQ7vB,EAAM6vB,MAChCnM,EAAKnG,KAAOqS,EAAOlM,EAAKnG,KAAMvd,GAE9B0jB,EAAKjG,MAAQmS,EAAOlM,EAAKjG,MAAOzd,GAG7B+D,EAAM2rB,EAAKhM,IACtB,CAEA,SAASoM,EAAOpM,EAAM1jB,GAClB,GAAI0jB,IAAS+L,EACT,OAAO/L,EAGX,IAAIqM,EAAOrM,EAAK1jB,MAAM6vB,MAAQ7vB,EAAM6vB,MACpC,GAAa,IAATE,EACA,GAAIrM,EAAKnG,OAASkS,GAAW/L,EAAKjG,QAAUgS,EAAS,CAGjD,IAFA,IAAIO,EAAOtM,EAAKnG,KAETyS,EAAKvS,QAAUgS,GAClBO,EAAOA,EAAKvS,MAGhBiG,EAAK1jB,MAAQgwB,EAAKhwB,MAClB0jB,EAAKnG,KAAOuS,EAAOpM,EAAKnG,KAAMmG,EAAK1jB,MACvC,MACI0jB,EADOA,EAAKnG,OAASkS,EACd/L,EAAKjG,MAELiG,EAAKnG,UAETwS,EAAO,EACdrM,EAAKnG,KAAOuS,EAAOpM,EAAKnG,KAAMvd,GAE9B0jB,EAAKjG,MAAQqS,EAAOpM,EAAKjG,MAAOzd,GAgBpC,OAbI0jB,EAAKnG,KAAKiS,MAAS9L,EAAK8L,MAAQ,GAAM9L,EAAKjG,MAAM+R,MAAS9L,EAAK8L,MAAQ,KACvE9L,EAAK8L,OAAS,EACV9L,EAAKjG,MAAM+R,MAAQ9L,EAAK8L,QACxB9L,EAAKjG,MAAM+R,MAAQ9L,EAAK8L,QAG5B9L,EAAOgM,EAAKhM,IACPjG,MAAQiS,EAAKhM,EAAKjG,OACvBiG,EAAKjG,MAAMA,MAAQiS,EAAKhM,EAAKjG,MAAMA,QACnCiG,EAAO3f,EAAM2f,IACRjG,MAAQ1Z,EAAM2f,EAAKjG,QAGrBiG,CACX,CAEA,IAAI9I,EAAQ7c,EAAM0B,MAAMvB,OAAO,CAC3BC,KAAM,SAAoB0xB,EAAOvM,EAAKtjB,GAClClC,KAAK+xB,MAAQA,EACb/xB,KAAKwlB,IAAMA,EACXxlB,KAAKkC,MAAQA,CACjB,EAEAiwB,WAAY,SAAStkB,GACjB,OAAOA,EAAMkkB,OAAS/xB,KAAKwlB,KAAO3X,EAAM2X,KAAOxlB,KAAK+xB,KACxD,EAEAtiB,MAAO,WACH,OAAO,IAAIqN,EAAM9c,KAAK+xB,MAAO/xB,KAAKwlB,IAAKxlB,KAAKkC,MAChD,IAGAkwB,EAAYnyB,EAAM0B,MAAMvB,OAAO,CAC/BC,KAAM,WACFL,KAAKqyB,KAAOV,CAChB,EAEAG,OAAQ,SAAS5vB,GACblC,KAAKqyB,KAAOP,EAAO9xB,KAAKqyB,KAAMnwB,EAClC,EAEA8vB,OAAQ,SAAS9vB,GACblC,KAAKqyB,KAAOL,EAAOhyB,KAAKqyB,KAAMnwB,EAClC,EAEAowB,UAAW,SAASpwB,GAGhB,IAFA,IAAI0jB,EAAO5lB,KAAKqyB,KAETzM,GAAQ+L,GACX,GAAIzvB,EAAQ0jB,EAAK1jB,MAAM6vB,MACnBnM,EAAOA,EAAKnG,SACT,MAAIvd,EAAQ0jB,EAAK1jB,MAAMsjB,KAG1B,OAAOI,EAAK1jB,MAFZ0jB,EAAOA,EAAKjG,KAGhB,CAGJ,OAAO,IACX,EAEAxY,OAAQ,WACJ,IAAIpB,EAAS,GAEb,OADAoB,EAAOnH,KAAKqyB,KAAMtsB,GACXA,CACX,EAEAwsB,aAAc,SAASR,EAAOvM,GAC1B,IAAIgN,EAAS,GAEb,OADAD,EAAavyB,KAAKqyB,KAAM,IAAIvV,EAAMiV,EAAOvM,GAAMgN,GACxCA,CACX,EAEArwB,IAAK,SAASyM,GACV,IAAI6jB,EAAO,IAAIL,EAEf,OADAjwB,EAAIswB,EAAMzyB,KAAKqyB,KAAMzjB,GACd6jB,CACX,EAEA3jB,QAAS,SAASF,GACdE,EAAQ9O,KAAKqyB,KAAMzjB,EACvB,EAEAa,MAAO,WACH,OAAOzP,KAAKmC,KAAI,SAASD,GACrB,OAAOA,EAAMuN,OACjB,GACJ,EAEAijB,MAAO,WAEH,IADA,IAAIA,EAAQ1yB,KAAKqyB,KACXK,EAAMjT,MAAQkS,GAChBe,EAAQA,EAAMjT,KAGlB,OAAOiT,CACX,EAEAC,KAAM,WAEF,IADA,IAAIA,EAAO3yB,KAAKqyB,KACVM,EAAKhT,OAASgS,GAChBgB,EAAOA,EAAKhT,MAGhB,OAAOgT,CACX,IAGJ,SAASxrB,EAAOye,EAAM7f,GACd6f,IAAS+L,IAIbxqB,EAAOye,EAAKnG,KAAM1Z,GAClBA,EAAOpF,KAAKilB,EAAK1jB,OACjBiF,EAAOye,EAAKjG,MAAO5Z,GACvB,CAEA,SAASwsB,EAAa3M,EAAM/X,EAAO2kB,GAC/B,GAAI5M,IAAS+L,EAAb,CAIA,IAAIzvB,EAAQ0jB,EAAK1jB,MAEb2L,EAAMkkB,MAAQ7vB,EAAM6vB,OACpBQ,EAAa3M,EAAKnG,KAAM5R,EAAO2kB,GAG/BtwB,EAAMiwB,WAAWtkB,IACjB2kB,EAAO7xB,KAAKuB,GAGZ2L,EAAM2X,IAAMtjB,EAAMsjB,KAClB+M,EAAa3M,EAAKjG,MAAO9R,EAAO2kB,EAbpC,CAeJ,CAEA,SAASrwB,EAAIswB,EAAMJ,EAAMzjB,GACjByjB,IAASV,IAGbxvB,EAAIswB,EAAMJ,EAAK5S,KAAM7Q,GACrB6jB,EAAKX,OAAOljB,EAASyjB,EAAKnwB,QAC1BC,EAAIswB,EAAMJ,EAAK1S,MAAO/Q,GAC1B,CAEA,SAASE,EAAQujB,EAAMzjB,GACfyjB,IAASV,IAGb7iB,EAAQujB,EAAK5S,KAAM7Q,GACnBA,EAASyjB,EAAKnwB,OACd4M,EAAQujB,EAAK1S,MAAO/Q,GACxB,CAEA,IAAIgkB,EAAY3yB,EAAM0B,MAAMvB,OAAO,CAC/BC,KAAM,SAAmB0xB,EAAOvM,EAAKtjB,QACrB4K,IAAR0Y,EACAxlB,KAAKyyB,KAAOV,GAEZ/xB,KAAKyyB,KAAO,IAAIL,EAChBpyB,KAAKyyB,KAAKX,OAAO,IAAIhV,EAAMiV,EAAOvM,EAAKtjB,IAE/C,EAEAiF,OAAQ,WACJ,OAAOnH,KAAKyyB,KAAKtrB,QACrB,EAEAhF,IAAK,SAASyM,GACV,OAAO,IAAIgkB,EAAU5yB,KAAKyyB,KAAKtwB,IAAIyM,GACvC,EAEAE,QAAS,SAASF,GACd5O,KAAKyyB,KAAK3jB,QAAQF,EACtB,EAEA2jB,aAAc,SAASR,EAAOvM,GAC1B,OAAOxlB,KAAKyyB,KAAKF,aAAaR,EAAOvM,EACzC,EAEAkN,MAAO,WACH,OAAO1yB,KAAKyyB,KAAKC,QAAQxwB,KAC7B,EAEAywB,KAAM,WACF,OAAO3yB,KAAKyyB,KAAKE,OAAOzwB,KAC5B,EAEA4vB,OAAQ,SAASC,EAAOvM,EAAKtjB,GACzB,OAAOlC,KAAKyyB,KAAKX,OAAO,IAAIhV,EAAMiV,EAAOvM,EAAKtjB,GAClD,EAEAA,MAAO,SAAS6vB,EAAOvM,EAAKtjB,GACxB,QAAc4K,IAAV5K,EAIA,YAHY4K,IAAR0Y,IACAA,EAAMuM,GAEH/xB,KAAKuyB,aAAaR,EAAOvM,GAAK,GAAGtjB,MAG5C,IAAIswB,EAASxyB,KAAKyyB,KAAKF,aAAaR,EAAQ,EAAGvM,EAAM,GAErD,GAAIgN,EAAOnxB,OAAQ,CACf,IAAIwxB,EAAaL,EAAO,GAAIM,EAAYN,EAAOA,EAAOnxB,OAAS,GAE3DwxB,EAAWrN,IAAMuM,IACbc,EAAW3wB,QAAUA,EACrB6vB,EAAQc,EAAWd,MAEnBS,EAAOnrB,SAIXyrB,EAAUf,MAAQvM,IACdsN,EAAU5wB,QAAUA,EACpBsjB,EAAMsN,EAAUtN,IAEhBgN,EAAO/lB,OAIf,IAAK,IAAIlJ,EAAI,EAAGlC,EAASmxB,EAAOnxB,OAAQkC,EAAIlC,EAAQkC,IAAK,CACrD,IAAIsK,EAAQ2kB,EAAOjvB,GACfwvB,EAAallB,EAAM3L,MACnB8wB,EAAanlB,EAAMkkB,MACnBkB,EAAWplB,EAAM2X,IAErBxlB,KAAKyyB,KAAKT,OAAOnkB,GAEbmlB,EAAajB,IACTgB,IAAe7wB,EACflC,KAAK8xB,OAAOkB,EAAYjB,EAAQ,EAAGgB,GAEnChB,EAAQiB,GAIZC,EAAWzN,IACPuN,IAAe7wB,EACflC,KAAK8xB,OAAOtM,EAAM,EAAGyN,EAAUF,GAE/BvN,EAAMyN,EAGlB,CACJ,CAEAjzB,KAAK8xB,OAAOC,EAAOvM,EAAKtjB,EAC5B,EAEAgxB,eAAgB,SAASnB,EAAOvM,GAM5B,IALA,IAAIgN,EAASxyB,KAAKuyB,aAAaR,EAAOvM,GAClCzf,EAAS,GAETotB,EAAa,EAER5vB,EAAIwuB,EAAOxuB,GAAKiiB,EAAKjiB,IACtBivB,EAAOW,GAAY3N,IAAMjiB,GACzB4vB,IAGJptB,EAAOpF,KAAK,CAAE+J,MAAOnH,EAAIwuB,EAAO7vB,MAAOswB,EAAOW,GAAYjxB,QAG9D,OAAO6D,CACX,EAEAqtB,cAAe,SAASrB,EAAOvM,EAAK6N,EAAeC,GAC/C,IAAIvtB,EAAS/F,KAAKkzB,eAAenB,EAAOvM,GAEpC+N,EAAW,SAASjoB,EAAG4O,GACvB,OAAI5O,EAAEpJ,QAAUgY,EAAEhY,MACPoJ,EAAEZ,MAAQwP,EAAExP,MAGhB2oB,EAAc/nB,EAAEpJ,MAAOgY,EAAEhY,MACpC,EAiBA,OAfIoxB,IACAC,EAAW,SAASjoB,EAAG4O,GACnB,IAAIzT,EAAI6sB,EAAQhoB,EAAEZ,OACdomB,EAAIwC,EAAQpZ,EAAExP,OAElB,OAAIjE,EAAEvE,QAAU4uB,EAAE5uB,MACPmxB,EAAc/nB,EAAEpJ,MAAOgY,EAAEhY,OAG7BoJ,EAAEZ,MAAQwP,EAAExP,KACvB,GAGJ3E,EAAO7C,KAAKqwB,GAELxtB,CACX,EAEA7C,KAAM,SAAS6uB,EAAOvM,EAAK8N,GACvB,GAA6C,IAAzCtzB,KAAKuyB,aAAaR,EAAOvM,GAAKnkB,OAMlC,IAFA,IAAI8F,EAASnH,KAAKkzB,eAAenB,EAAOvM,GAE/BjiB,EAAI,EAAGsjB,EAAMyM,EAAQjyB,OAAQkC,EAAIsjB,EAAKtjB,IAC3CvD,KAAKkC,MAAMqB,EAAIwuB,EAAOxuB,EAAIwuB,EAAO5qB,EAAOmsB,EAAQ/vB,GAAGmH,OAAOxI,MAElE,EAEA+Z,KAAM,SAASuX,EAAaC,EAAWC,GAMnC,IALA,IAGIlO,EAHAre,EAASnH,KAAKuyB,aAAaiB,EAAaC,GAExC1B,EAAQ2B,EAGHnwB,EAAI,EAAGsjB,EAAM1f,EAAO9F,OAAQkC,EAAIsjB,EAAKtjB,IAAK,CAC/C,IAAIyvB,EAAa7rB,EAAO5D,GAAGwuB,MAEvBiB,EAAaQ,IACbR,EAAaQ,GAGjB,IAAIP,EAAW9rB,EAAO5D,GAAGiiB,IAErByN,EAAWQ,IACXR,EAAWQ,GAGfjO,EAAMuM,GAASkB,EAAWD,GAE1BhzB,KAAKkC,MAAM6vB,EAAOvM,EAAKre,EAAO5D,GAAGrB,OAEjC6vB,IAAUvM,CACd,CACJ,EAEAmO,SAAU,SAAS5B,EAAOvM,GACtB,OAAO,IAAIoO,EAAS7B,EAAOvM,EAAKxlB,KAAKuyB,aAAaR,EAAOvM,GAC7D,EAEArX,SAAU,WACN,OAAOnO,KAAKyyB,KAAKhjB,OACrB,EAEAvB,SAAU,SAASE,GACfpO,KAAKyyB,KAAOrkB,EAAMqB,OACtB,EAEAokB,OAAQ,WACJ,OAAO7zB,KAAKmH,QAChB,EAEA2sB,SAAU,SAAS3sB,GACfA,EAAO2H,SAAQ,SAAStI,GACpBxG,KAAKkC,MAAMsE,EAAEurB,MAAOvrB,EAAEgf,IAAKhf,EAAEtE,MACjC,GAAGlC,KACP,IAGA4zB,EAAW3zB,EAAM0B,MAAMvB,OAAO,CAC9BC,KAAM,SAAS0xB,EAAOvM,EAAKgN,GACvBxyB,KAAK+xB,MAAQA,EACb/xB,KAAKwlB,IAAMA,EACXxlB,KAAK0K,MAAQ,EACb1K,KAAKwyB,OAASA,CAClB,EAEAuB,OAAQ,WACJ,OAAO/zB,KAAKwyB,OAAOrwB,KAAI,SAAS0L,GAC5B,OAAOA,EAAM3L,KACjB,GACJ,EAEA8xB,GAAI,SAAStpB,GACT,KAAO1K,KAAKwyB,OAAOxyB,KAAK0K,QAAU1K,KAAKwyB,OAAOxyB,KAAK0K,OAAO8a,IAAM9a,GAC5D1K,KAAK0K,QAGT,OAAO1K,KAAKwyB,OAAOxyB,KAAK0K,QAAU1K,KAAKwyB,OAAOxyB,KAAK0K,OAAOxI,KAC9D,EAEA4M,QAAS,SAASF,GACd,IAAK,IAAIrL,EAAIvD,KAAK+xB,MAAOxuB,GAAKvD,KAAKwlB,IAAKjiB,IACpCqL,EAAS5O,KAAKg0B,GAAGzwB,GAAIA,GAGzBvD,KAAK0K,MAAQ,CACjB,IAGAupB,EAAkBrB,EAAUxyB,OAAO,CACnCC,KAAM,SAAS0xB,EAAOvM,EAAKtjB,GACvBlC,KAAKk0B,cAAgBhyB,EACrBlC,KAAKyyB,KAAO,IAAIL,EAChBpyB,KAAK6N,MAAQ,IAAIiP,EAAMiV,EAAOvM,EAAKtjB,EACvC,EAEAqwB,aAAc,SAASR,EAAOvM,GAC1B,IAEI3X,EAFA2kB,EAASxyB,KAAKyyB,KAAKF,aAAaR,EAAOvM,GACvCzf,EAAS,GAGb,IAAKysB,EAAOnxB,OACR,MAAO,CAACrB,KAAK6N,OAGjB,IAAK,IAAItK,EAAI,EAAGsjB,EAAM2L,EAAOnxB,OAAQkC,EAAIsjB,EAAKtjB,KAC1CsK,EAAQ2kB,EAAOjvB,IACLwuB,MAAQA,GACdhsB,EAAOpF,KAAK,IAAImc,EAAMiV,EAAOlkB,EAAMkkB,MAAQ,EAAG/xB,KAAK6N,MAAM3L,QAG7D6D,EAAOpF,KAAKkN,GACZkkB,EAAQlkB,EAAM2X,IAAM,EAOxB,OAJI3X,EAAM2X,IAAMA,GACZzf,EAAOpF,KAAK,IAAImc,EAAMjP,EAAM2X,IAAM,EAAGA,EAAKxlB,KAAK6N,MAAM3L,QAGlD6D,CACX,EAEA+rB,OAAQ,SAASC,EAAOvM,EAAKtjB,GACZ,MAATA,IACAA,EAAQlC,KAAKk0B,eAEbhyB,IAAUlC,KAAK6N,MAAM3L,OACrBlC,KAAKyyB,KAAKX,OAAO,IAAIhV,EAAMiV,EAAOvM,EAAKtjB,GAE/C,EAEAiyB,eAAgB,WACZ,IAAIvO,EAAO5lB,KAAKyyB,KAAKJ,KAErB,GAAIzM,IAAS+L,EACT,OAAO3xB,KAAK6N,MAAMkkB,MAGtB,KAAMnM,EAAKjG,QAAUgS,GACjB/L,EAAOA,EAAKjG,MAGhB,OAAOiG,EAAK1jB,MAAMsjB,IAAM,CAC5B,IAIJvlB,EAAMsN,YAAY6kB,UAAYA,EAC9BnyB,EAAMsN,YAAYqlB,UAAYA,EAC9B3yB,EAAMsN,YAAY0mB,gBAAkBA,EACpCh0B,EAAMsN,YAAY6mB,WAAatX,CAClC,CAthBD,CAshBG7c,OAEH,SAAUA,GAEN,IAAIo0B,EAAWp0B,EAAM0B,MAAMvB,OAAO,CAC9BC,KAAM,SAASknB,GACXvnB,KAAKunB,KAAOA,CAChB,EAEA9kB,IAAK,SAASiI,GACV,OAAO1K,KAAKqY,MAAMrY,KAAKunB,KAAKrlB,MAAMwI,EAAOA,GAC7C,EAEA4pB,IAAK,SAASvC,EAAOvM,EAAKtjB,QACR4K,IAAV5K,IACAA,EAAQsjB,EACRA,EAAMuM,GAGV/xB,KAAKunB,KAAKrlB,MAAM6vB,EAAOvM,EAAKtjB,EAChC,EAEAmW,MAAO,SAASnW,GACZ,OAAOA,CACX,EAEA+Z,KAAM,SAAS8V,EAAOvM,EAAK+O,GACvBv0B,KAAKunB,KAAKtL,KAAK8V,EAAOvM,EAAK+O,EAC/B,EAEAZ,SAAU,SAAS5B,EAAOvM,GACtB,OAAOxlB,KAAKunB,KAAKoM,SAAS5B,EAAOvM,EACrC,IAGAgP,EAAeH,EAASj0B,OAAO,CAC/Bk0B,IAAK,SAASvC,EAAOvM,EAAKtjB,GACtBlC,KAAKunB,KAAKrlB,MAAM6vB,EAAOvM,EAAKiP,KAAKC,UAAUxyB,GAC/C,EAEAmW,MAAO,SAASnW,GACZ,OAAOuyB,KAAKpc,MAAMnW,EACtB,IAGAyyB,EAAgBN,EAASj0B,OAAO,CAChCC,KAAM,SAAS8G,EAAQytB,GACnBP,EAASrhB,UAAU3S,KAAKG,KAAKR,KAAMmH,GACnCnH,KAAK40B,QAAUA,CACnB,EAEAN,IAAK,SAASvC,EAAOvM,EAAKtjB,GAClBA,aAAiByD,MACjBzD,EAAQjC,EAAMsN,YAAYsnB,aAAa3yB,GAClClC,KAAK40B,QAAQ1yB,MAAM6vB,EAAMvM,IAC1BxlB,KAAK40B,QAAQ1yB,MAAM6vB,EAAOvM,EAAmBvlB,EAAM60B,UAAUC,SAASC,SAASpuB,EAW7E9D,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KAAKA,QAAQ,KAAM,WATnC,iBAATZ,IACdA,EAAQjC,EAAMsN,YAAYkH,KAAKuS,QAAQiO,eAAe/yB,IAG1DlC,KAAKunB,KAAKrlB,MAAM6vB,EAAOvM,EAAKtjB,EAChC,IAyPJ,SAASgzB,EAAkBzuB,GAGvB,OAFAA,EAAIA,EAAEgJ,SACJvN,MAAQuE,EAAEvE,MAAMizB,YACX1uB,CACX,CAEA,SAAS2uB,IACL,IAAI3C,EAAOzyB,KAAKmC,IAAI+yB,GAEpB,OADAzC,EAAKhjB,MAAQ2lB,EACN3C,CACX,CA5PAxyB,EAAMsN,YAAY8nB,YAAcp1B,EAAM0B,MAAMvB,OAAO,CAC/Ck1B,MAAO,CACH,CAAE3nB,SAAU0mB,EAAUnoB,KAAM,SAAUhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACjF,CAAE7nB,SAAUgnB,EAAezoB,KAAM,QAAShK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,EAAMC,QAAS,UACpG,CAAE9nB,SAAU0mB,EAAUnoB,KAAM,UAAWhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GAClF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,aAAchK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACrF,CAAE7nB,SAAU6mB,EAActoB,KAAM,WAAYhK,MAAO,KAAMqzB,UAAU,EAAOC,cAAc,GACxF,CAAE7nB,SAAU6mB,EAActoB,KAAM,WAAYhK,MAAO,KAAMqzB,UAAU,EAAOC,cAAc,GACxF,CAAE7nB,SAAU6mB,EAActoB,KAAM,WAAYhK,MAAO,KAAMqzB,UAAU,EAAOC,cAAc,GACxF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,QAAShK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GAChF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,aAAchK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACrF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,YAAahK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACpF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,WAAYhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACnF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,SAAUhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACjF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,OAAQhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GAC/E,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,YAAahK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACpF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,SAAUhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACjF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,gBAAiBhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACxF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,OAAQhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GAC/E,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,aAAchK,MAAO,KAAMqzB,UAAU,EAAOC,cAAc,GACtF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,SAAUhK,MAAO,KAAMqzB,UAAU,EAAOC,cAAc,GAClF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,OAAQhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GAC/E,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,SAAUhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GACjF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,UAAWhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,GAClF,CAAE7nB,SAAU0mB,EAAUnoB,KAAM,OAAQhK,MAAO,KAAMqzB,UAAU,EAAMC,cAAc,IAGnFn1B,KAAM,SAASq1B,EAAUC,EAAaC,GAClCA,EAAgBA,GAAiB,CAAC,EAClC,IAAIC,EAAYH,EAAWC,EAAc,EAEzC31B,KAAK01B,SAAWA,EAChB11B,KAAK21B,YAAcA,EACnB31B,KAAK61B,UAAYA,EACjB71B,KAAK81B,WAAa,CAAC,EACnB91B,KAAK+1B,MAAQ,CAAC,EAEd/1B,KAAKs1B,MAAMxmB,SAAQ,SAASknB,GACxB,IAAI9pB,EAAO8pB,EAAK9pB,KACZhK,EAAQ0zB,EAAc1pB,QACZY,IAAV5K,IACAA,EAAQ8zB,EAAK9zB,OAEjBlC,KAAK+1B,MAAM7pB,GAAQ,IAAIjM,EAAMsN,YAAY0mB,gBAAgB,EAAG4B,EAAW3zB,IAC5DlC,KAAK81B,WAAW5pB,GAAQ,IAAI8pB,EAAKroB,SAAS3N,KAAK+1B,MAAM7pB,GAAOlM,KAAK+1B,MAAMC,EAAKP,WAClFO,KAAOA,CAChB,GAAGh2B,MAOHA,KAAK+1B,MAAME,QAAQxD,KAAKhjB,MAAQ2lB,EAChCp1B,KAAK+1B,MAAM/U,WAAWyR,KAAKhjB,MAAQ2lB,CACvC,EAEAc,QAAS,SAASC,EAAUC,GACxB,IAAIv2B,EAAOG,KACPq2B,EAAWx2B,EAAK61B,SAChBY,EAAaH,EAAWC,EAAW,EACvC,SAASG,EAAW7rB,GAGhB,OAFUA,EAAQ2rB,EAAW,GAEhBF,EADHzrB,EAAQ2rB,CAEtB,CACA,SAASG,EAAU5Q,GAGfA,EAAKmM,MAAQwE,EAAW3Q,EAAKmM,OAC7BnM,EAAKJ,IAAM+Q,EAAW3Q,EAAKJ,IAC/B,CACA/d,OAAO2b,KAAKvjB,EAAKk2B,OAAOjnB,SAAQ,SAAS5C,GACrC,IAAIqb,EAAO1nB,EAAKk2B,MAAM7pB,GAClBiqB,GAAYE,GACZ9O,EAAKzY,QAAQ0nB,GAEjBjP,EAAK1Z,MAAM2X,IAAM8Q,CACrB,IACAz2B,EAAK61B,SAAWS,EAChBt2B,EAAK81B,YAAcS,EACnBv2B,EAAKg2B,UAAYS,CACrB,EAEAnoB,SAAU,WACN,IAAIC,EAAQ,CAAC,EAMb,OAJApO,KAAKs1B,MAAMxmB,SAAQ,SAASknB,GACzB5nB,EAAM4nB,EAAK9pB,MAAQlM,KAAK+1B,MAAMC,EAAK9pB,MAAMiC,UAC5C,GAAGnO,MAEIoO,CACX,EAEAF,SAAU,SAASE,GACfpO,KAAKs1B,MAAMxmB,SAAQ,SAASknB,GACxBh2B,KAAK+1B,MAAMC,EAAK9pB,MAAMgC,SAASE,EAAM4nB,EAAK9pB,MAC9C,GAAGlM,KACP,EAEAyC,IAAK,SAASyJ,EAAMxB,GAChB,QAAcoC,IAAVpC,EACA,OAAO1K,KAAK+1B,MAAM7pB,GAGtB,OAAQA,GACN,IAAK,cACHxB,GAAS1K,KAAK01B,SAEhB,IAAK,aACHxpB,EAAO,WACP,MAEF,IAAK,eACHxB,IAEF,IAAK,YACHwB,EAAO,WAGX,OAAOxB,EAAQ1K,KAAK61B,UAAY,KAAO71B,KAAK81B,WAAW5pB,GAAMzJ,IAAIiI,EACrE,EAEA4pB,IAAK,SAASpoB,EAAM6lB,EAAOvM,EAAKtjB,GAC5B,OAAQgK,GACN,IAAK,cACH6lB,GAAS/xB,KAAK01B,SACdlQ,GAAOxlB,KAAK01B,SAEd,IAAK,aACHxpB,EAAO,WACP,MAEF,IAAK,eACH6lB,IACAvM,IAEF,IAAK,YACHtZ,EAAO,WAGP6lB,GAASvM,GAAOA,GAAOxlB,KAAK61B,WAC5B71B,KAAK81B,WAAW5pB,GAAMooB,IAAIvC,EAAOvM,EAAKtjB,EAE9C,EAEA4xB,SAAU,SAASppB,EAAOxI,GACtB,IAAK,IAAIu0B,EAAK,EAAGA,EAAKz2B,KAAKs1B,MAAMj0B,OAAQo1B,IAAM,CAC3C,IAAIT,EAAOh2B,KAAKs1B,MAAMmB,GAElBT,EAAKR,mBACoB1oB,IAArB5K,EAAM8zB,EAAK9pB,OACXlM,KAAKs0B,IAAI0B,EAAK9pB,KAAMxB,EAAOA,EAAOxI,EAAM8zB,EAAK9pB,OAAO,EAGhE,CAEA,CAAE,aAAc,cAAe,YAAa,gBAAiB4C,SAAQ,SAASoL,QACzDpN,IAAb5K,EAAMgY,IACNla,KAAKs0B,IAAIpa,EAAGxP,EAAOA,EAAOxI,EAAMgY,GAExC,GAAGla,KACP,EAEAic,KAAM,SAASuX,EAAaC,EAAWC,GACnC1zB,KAAKs1B,MAAMxmB,SAAQ,SAASknB,GACxBh2B,KAAK81B,WAAWE,EAAK9pB,MAAM+P,KAAKuX,EAAaC,EAAWC,EAC5D,GAAG1zB,KACP,EAEA2zB,SAAU,SAASznB,EAAM6lB,EAAOvM,GAC5B,IAAIkR,EAAO12B,KAAK81B,WAAW5pB,GACvByqB,EAAOD,EAAK/C,SAAS5B,EAAOvM,GAAMwO,EAAK2C,EAAK3C,GAC5C6B,EAAY71B,KAAK61B,UAMrB,OALAc,EAAK3C,GAAK,SAAStpB,GACf,OAAOA,EAAQmrB,EAAY,KAAOa,EAAKre,MAAM2b,EAAGxzB,KAAKm2B,EAAMjsB,GAC/D,EACAisB,EAAKzqB,KAAOA,EACZyqB,EAAKz0B,MAAQw0B,EAAKV,KAAK9zB,MAChBy0B,CACX,EAEApB,SAAU,WACN,OAAOv1B,KAAKs1B,MAAMnY,QAAO,SAAS6Y,GAAQ,OAAOA,EAAKT,QAAU,IAC3DpzB,KAAI,SAAS6zB,GACV,OAAOh2B,KAAK+1B,MAAMC,EAAK9pB,KAC3B,GAAGlM,KACX,EAEA42B,UAAW,SAAS7E,EAAOvM,GACvB,OAAOxlB,KAAKs1B,MAAMuB,OAAO,SAASC,EAAKd,GAInC,OAHIA,EAAKR,cACLsB,EAAIn2B,KAAKX,KAAK2zB,SAASqC,EAAK9pB,KAAM6lB,EAAOvM,IAEtCsR,CACX,EAAE5nB,KAAKlP,MAAO,GAClB,EAEA8O,QAAS,SAASijB,EAAOvM,EAAK5W,GAC1B,IAIIzH,EAAQuD,EAJRksB,EAAY52B,KAAK42B,UAAU7E,EAAOvM,GAClCuR,EAAW/2B,KAAK2zB,SAAS,WAAY5B,EAAOvM,EAAM,GAClDwR,EAAch3B,KAAK2zB,SAAS,WAAY5B,EAAOvM,GAC/CyR,EAAej3B,KAAK2zB,SAAS,WAAY5B,EAAQ/xB,KAAK01B,SAAUlQ,EAAMxlB,KAAK01B,UAG/E,SAASwB,EAAUhrB,EAAMynB,EAAUjpB,GAC/B,IAAI+f,EAAMkJ,EAASK,GAAGtpB,GAClB+f,IAAQkJ,EAASzxB,QACjBiF,EAAO+E,GAAQue,EAEvB,CAEA,IAAK/f,EAAQqnB,EAAOrnB,GAAS8a,EAAK9a,IAAS,CACvCvD,EAAS,CAAC,EAEV,IAAK,IAAI5D,EAAI,EAAGA,EAAIqzB,EAAUv1B,OAAQkC,IAAK,CACvC,IAAIowB,EAAWiD,EAAUrzB,GACrBrB,EAAQyxB,EAASK,GAAGtpB,GAEpBxI,IAAUyxB,EAASzxB,QACnBiF,EAAOwsB,EAASznB,MAAQhK,EAEhC,CAEAg1B,EAAU,aAAcF,EAAatsB,GACrCwsB,EAAU,cAAeD,EAAcvsB,EAAQ1K,KAAK01B,UACpDwB,EAAU,YAAaH,EAAUrsB,IAC5BA,EAAQ,GAAK1K,KAAK01B,UACnBwB,EAAU,eAAgBH,EAAUrsB,EAAQ,GAGhDkE,EAASzH,EACb,CACJ,EAEAgwB,gBAAiB,SAASvoB,GACtB,IAAK,IAAI1C,KAAQlM,KAAK81B,WAClBlnB,EAAS5O,KAAK81B,WAAW5pB,GAEjC,IAeJjM,EAAMsN,YAAY6pB,eAAiBn3B,EAAMsN,YAAY8nB,YAAYriB,UAAUsiB,MAAMuB,QAAO,SAASvrB,EAAG0qB,GAIhG,OAHIA,EAAKR,cACLlqB,EAAE3K,KAAKq1B,EAAK9pB,MAETZ,CACX,GAAG,CAAE,YAAa,cAAe,eAAgB,cAEpD,CAxUD,CAwUG7J,OAAOxB,OASN,IAAIo3B,EAAgBp3B,MAAMsN,YAG1B,SAAS+pB,EAAWC,GAChB,IAAIC,EAAS/mB,KAAKgnB,MAAMF,EAAW,IAAM,EACzC,OAAQC,GAAU,EAAIF,EAAWE,GAAU,IAAM30B,OAAO2F,aAAa,GAAM+uB,EAAW,GAC1F,CAEA,SAASG,EAAa1oB,GAClB,MAAI,sBAAsB/G,KAAK+G,GACpBA,EAEJ,IAAMA,EAAMlM,QAAQ,QAAS,OAAS,GACjD,CAEA,SAAS60B,EAAW3oB,EAAO0E,EAAK2B,EAAKuiB,GACjC,IAAIC,EAAK,GAqBT,QAnBEnkB,EAEGokB,SAASpkB,GAGE,MAAPkkB,GAAuB,EAANA,IACtBlkB,EAAM,IAAMA,GAHZA,EAAM,GAMLokB,SAASziB,IAIVwiB,EAAKP,EAAWjiB,GACL,MAAPuiB,GAAuB,EAANA,IACjBC,EAAK,IAAMA,IALfxiB,EAAM,GASNrG,EACO0oB,EAAa1oB,GAAS,IAAM6oB,EAAKnkB,EAEjCmkB,EAAKnkB,CAEpB,CAIA,IAAIqkB,EA7CU93B,MAAM0B,MA6CAvB,OAAO,CACvBsO,KAAM,MACNM,MAAO,GACPS,MAAO,WACH,OAAOzP,IACX,EACAg4B,SAAU,WACN,OAAOh4B,KAAKi4B,SAChB,EACA5K,SAAU,WACN,OAAOrtB,IACX,EACAwtB,SAAU,SAASxe,EAAOgpB,GAKtB,OAJAh4B,KAAKgP,MAAQA,EACG,MAAZgpB,IACAh4B,KAAKi4B,UAAYD,GAEdh4B,IACX,EACAk4B,SAAU,WACN,OAAOl4B,IACX,EACAstB,SAAU,WACN,OAAOttB,IACX,EACAm4B,OAAQ,WACJ,OAAOn4B,IACX,EACAo4B,SAAU,WACN,OAAOp4B,KAAKstB,SAAS,EAAG,EAAG,EAAG,GAAGG,MAAM,EAAG,EAC9C,EACA3e,QAAS,SAASF,EAAUzG,GACxByG,EAASpO,KAAK2H,EAAKnI,KACvB,EACAmC,IAAK,SAASyM,EAAUzG,GACpB,OAAOyG,EAASpO,KAAK2H,EAAKnI,KAC9B,EACAmyB,WAAY,SAASpjB,GACjB,OAAO/O,KAAKq4B,UAAUtpB,KAASupB,CACnC,EACAC,OAAQ,WACJ,OAAO,CACX,EACAC,MAAO,WACH,OAAOx4B,IACX,EACAy4B,SAAU,WACN,OAAOz4B,IACX,EAGA0yB,MAAO,WACH,OAAO1yB,IACX,EACA8yB,UAAW,WACP,OAAO9yB,IACX,EACA4B,KAAM,WACF,OAAO,CACX,EACA82B,QAAS,WACL,OAAO14B,IACX,EACA24B,eAAgB,WACZ,OAAO,CACX,EACAC,mBAAoB,WAChB,OAAO,CACX,EACAza,GAAI,SAAS0a,GACT,IAAIC,EAAK94B,KACL+4B,EAAKF,EAET,GAAIC,IAAOR,GAAUS,IAAOT,EACxB,OAAOQ,IAAOC,EASlB,IALKA,aAAcC,GAAeD,aAAcE,KAAgBH,aAAcE,MAC3EF,EAAKD,EACLE,EAAK/4B,MAGJ84B,aAAcE,EAEd,OADAD,EAAKA,EAAG1L,sBACa2L,GAAaF,EAAGplB,KAAOqlB,EAAGrlB,KAAOolB,EAAGzjB,KAAO0jB,EAAG1jB,KAAOyjB,EAAG9pB,OAAS+pB,EAAG/pB,MAExF,GAAI8pB,aAAcG,EAAY,CAC/B,GAAIF,aAAcE,EACd,OAAOF,EAAGloB,QAAQsN,GAAG2a,EAAGjoB,UAAYkoB,EAAGxe,YAAY4D,GAAG2a,EAAGve,aAE7D,GAAIwe,aAAcG,EACd,OAAOH,EAAGI,UAAYL,EAAG3a,GAAG4a,EAAGvlB,KAAK,GAE5C,MACK,GAAIslB,aAAcI,GAAcH,aAAcG,EAAY,CAC3D,IAAIE,EAAQN,EAAGtlB,KACX6lB,EAAQN,EAAGvlB,KACf,GAAI4lB,EAAM/3B,QAAUg4B,EAAMh4B,OACvB,OAAO,EAGV,IAAK,IAAIkC,EAAI,EAAGsjB,EAAMuS,EAAM/3B,OAAQkC,EAAIsjB,EAAKtjB,IACzC,IAAK61B,EAAM71B,GAAG4a,GAAGkb,EAAM91B,IACnB,OAAO,EAIf,OAAO,CACX,CAEA,OAAOu1B,IAAOC,CAClB,EAEAtlB,OAAQ,SAAS1E,GACb,OAAO,IAAImqB,EAAW,CAACl5B,KAAM+O,GACjC,EAEAuqB,UAAW,SAAS5uB,EAAOqE,GACvB,OAAOA,CACX,EAEAwqB,mBAAoB,SAAS3qB,GACzB5O,KAAKw5B,iBAAiB,MAAO5qB,EACjC,EAEA6qB,gBAAiB,SAAS7qB,GACtB5O,KAAKw5B,iBAAiB,MAAO5qB,EACjC,EAEA4qB,iBAAkB,SAASjb,EAAM3P,GAC7B,IAAI8qB,EAAS,GAIb15B,KAFsB,QAATue,EAAiB,aAAe,kBAEhC,SAASxP,GAClB,IAAIrE,EAAQqE,EAAI2jB,QAAQnU,IACO,IAA3Bmb,EAAOnoB,QAAQ7G,IACfgvB,EAAO/4B,KAAK+J,EAEpB,IAEAgvB,EAAOx2B,MAAK,SAASoI,EAAE4O,GACnB,OAAO5O,EAAI4O,EAAI,EAAK5O,EAAI4O,GAAK,EAAI,CACrC,IAAGpL,QAAQF,EACf,EAEA+qB,MAAO,WACH,OAAO,CACX,EAEAC,YAAa,SAASC,EAAcC,GAChC,GAAI95B,KAAKgP,OAAShP,KAAKgP,MAAM1I,eAAiBuzB,EAAavzB,cAEvD,OADAtG,KAAKgP,MAAQ8qB,GACN,CAEf,IAGJ/B,EAAMgC,QAAUpC,EAIhB,IAAIW,EAAS,IAAKP,EAAM33B,OAAO,CAC3BC,KAAM,WAAmB,EACzBotB,MAAO,WACH,MAAO,QACX,EACAtP,GAAI,SAASpP,GACT,OAAOA,IAAQ/O,IACnB,EACA8O,QAAS,WAAY,KAKrBkrB,EAAYjC,EAAM33B,OAAO,CACzB2O,IAAK,OACL1O,KAAM,SAAiB6L,GACnBlM,KAAKkM,KAAOA,CAChB,EACAuD,MAAO,WACH,OAAO,IAAIuqB,EAAUh6B,KAAKkM,MACrBshB,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WACnC,EACAvK,MAAO,WACH,IAAIqJ,EAAMY,EAAa13B,KAAKkM,MAI5B,OAHIlM,KAAKg4B,aACLlB,EAAMY,EAAa13B,KAAKgP,OAAS,IAAM8nB,GAEpCA,CACX,IAKAkC,EAAYjB,EAAM33B,OAAO,CACzB2O,IAAK,OACL1O,KAAM,SAAiBqT,EAAK2B,EAAKuiB,GAC7B53B,KAAK0T,IAAMA,EACX1T,KAAKqV,IAAMA,EACXrV,KAAK43B,IAAMA,GAAO,CACtB,EACAnoB,MAAO,WACH,OAAO,IAAIupB,EAAUh5B,KAAK0T,IAAK1T,KAAKqV,IAAKrV,KAAK43B,KACzCpK,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WACnC,EACAK,UAAW,SAAStpB,GAChB,OAAIA,aAAeiqB,EACXh5B,KAAKme,GAAGpP,GACD/O,KAEAs4B,EAGRvpB,EAAIspB,UAAUr4B,KACzB,EACAytB,MAAO,SAASwM,EAAMC,EAAM9I,GACxB,IAAoD+I,EAAhD9kB,EAAMrV,KAAKqV,IAAK3B,EAAM1T,KAAK0T,IAAKkkB,EAAM53B,KAAK43B,IAC/C,GAAY,MAARqC,GAAgBrC,EAAK,CACrB,IAAI5oB,EAAQhP,KAAKg4B,WAAaN,EAAa13B,KAAKgP,OAAS,IAAM,GAW/D,OATIqG,EADAyiB,SAASziB,GACG,EAANuiB,EAAW,KAAOviB,EAAM,IAAQ,KAAOA,EAAM,GAE7C,GAOHrG,GAJH0E,EADAokB,SAASpkB,GACG,EAANkkB,EAAW,KAAOlkB,EAAM,IAAQ,KAAOA,EAAM,GAE7C,IAEW2B,CACzB,CAEI,OADA8kB,EAAMn6B,KAAKk4B,SAAS+B,EAAMC,GACtB9I,IAEA1d,EAAMymB,EAAIzmB,IAAM,SAEN,IACNA,GAAO,UAFX2B,EAAM8kB,EAAI9kB,IAAM,OAIN,IACNA,GAAO,OAEJsiB,EAAW33B,KAAKi4B,WAAaj4B,KAAKgP,MAAO0E,EAAK2B,EAAKuiB,IAEvDuC,EAAIR,QAAUhC,EAAW33B,KAAKi4B,WAAaj4B,KAAKgP,MAAOmrB,EAAIzmB,IAAKymB,EAAI9kB,IAAKuiB,GAAO,OAE/F,EACAM,SAAU,SAASkC,EAAMC,GACrB,IAAIvD,EAAM92B,KAAKyP,QACf,OAAc,EAAVqnB,EAAIc,MA+BM,EAAVd,EAAIc,MAEJd,EAAIzhB,KAAOyhB,EAAIzhB,IAAMglB,GAAQ,OAEnB,EAAVvD,EAAIc,MAEJd,EAAIpjB,KAAOojB,EAAIpjB,IAAM0mB,GAAQ,SAGjCtD,EAAIc,IAAM,GAvCCd,CAyCf,EACA7nB,WAAY,WACR,OAAO,IAAIgqB,EAAWj5B,KAAMA,KAChC,EACAstB,SAAU,SAAS8M,EAAMC,EAAMzC,GAChB,MAAPA,IACAA,EAAM53B,KAAK43B,KAEf,IAAIlkB,EAAY,EAANkkB,EAAU53B,KAAK0T,IAAM0mB,EAAOp6B,KAAK0T,IACvC2B,EAAY,EAANuiB,EAAU53B,KAAKqV,IAAMglB,EAAOr6B,KAAKqV,IAC3C,OAAO,IAAI2jB,EAAUtlB,EAAK2B,EAAKuiB,GAC1BpK,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WACnC,EACA5zB,OAAQ,WACJ,OAAO,CACX,EACAD,MAAO,WACH,OAAO,CACX,EACAi0B,SAAU,WACN,OAAOT,EAAW,KAAM33B,KAAK0T,IAAK1T,KAAKqV,IAAK,EAChD,EACAkjB,OAAQ,WACJ,OAAO,CACX,EACApiB,WAAY,WACR,OAAOnW,IACX,EACAsW,YAAa,WACT,OAAOtW,IACX,EACAyW,OAAQ,WACJ,OAAOzW,IACX,EACA4W,UAAW,WACP,OAAO5W,IACX,EACA6U,WAAY,SAASjG,GACjBA,EAAS5O,KAAKiP,aAClB,EACAwI,cAAe,SAAS7I,GACpBA,EAAS5O,KAAKiP,aAClB,EACAkpB,OAAQ,SAASzkB,EAAK2B,EAAK4kB,EAAMC,EAAMI,EAAQvI,EAAO9c,GAClD,IAAIlG,EAAM/O,KAAKk4B,SAASxkB,EAAK2B,GAC7B,GAAIilB,GACA,GAAIvrB,EAAI2E,KAAOqe,EAAO,CAClB,GAAI9c,EAAQ,GAAKlG,EAAI2E,IAAMqe,EAAQ9c,EAC/B,OAAOqjB,EAEXvpB,EAAI2E,KAAOuB,CACf,OAEA,GAAIlG,EAAIsG,KAAO0c,EAAO,CAClB,GAAI9c,EAAQ,GAAKlG,EAAIsG,IAAM0c,EAAQ9c,EAC/B,OAAOqjB,EAEXvpB,EAAIsG,KAAOJ,CACf,CAKJ,OAHY,MAARglB,GAAwB,MAARC,IAChBnrB,EAAMA,EAAIue,SAAS2M,EAAMC,EAAMl6B,KAAK43B,MAEjC7oB,CACX,EACA4qB,MAAO,WACH,GAAI35B,KAAK43B,IACL,MAAM,IAAIzsB,MAAM,wCAEpB,IAAIkK,EAAMrV,KAAKqV,IAAK3B,EAAM1T,KAAK0T,IAC/B,QAAUokB,SAASziB,IAAQA,EAAM,GAAOyiB,SAASpkB,IAAQA,EAAM,EACnE,IAKAulB,EAAalB,EAAM33B,OAAO,CAC1B2O,IAAK,QACL1O,KAAM,SAAkBk6B,EAAIC,GACpBD,EAAGtC,WAAauC,EAAGvC,WAAasC,EAAGvrB,MAAM1I,eAAiBk0B,EAAGxrB,MAAM1I,gBAEnEtG,KAAKy6B,SAAWD,EAAGxrB,OAGvBhP,KAAK6Q,QAAU,IAAImoB,EAAUuB,EAAG7mB,IAAK6mB,EAAGllB,IAAKklB,EAAG3C,KAChD53B,KAAKua,YAAc,IAAIye,EAAUwB,EAAG9mB,IAAK8mB,EAAGnlB,IAAKmlB,EAAG5C,KACpD53B,KAAK06B,WACT,EACAjrB,MAAO,WACH,OAAO,IAAIwpB,EAAWj5B,KAAK6Q,QAAQpB,QAASzP,KAAKua,YAAY9K,SAAS+d,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WACpG,EACA2C,eAAgB,SAAS9sB,GACrB,OAAO7N,KAAK46B,cAAc/sB,EAAMgD,UACzB7Q,KAAK46B,cAAc/sB,EAAM0M,YACpC,EACAqgB,cAAe,SAAS9mB,GACpB,OAAOA,EAAK9E,OAAShP,KAAKgP,OACnB8E,EAAKJ,KAAO1T,KAAK6Q,QAAQ6C,KACzBI,EAAKuB,KAAOrV,KAAK6Q,QAAQwE,KACzBvB,EAAKJ,KAAO1T,KAAKua,YAAY7G,KAC7BI,EAAKuB,KAAOrV,KAAKua,YAAYlF,GACxC,EACAwlB,SAAU,SAAS9rB,GACf,GAAIA,aAAe+rB,MAAO,CACtB,IAAIhhB,EAAO9Z,KAEX,OAAO+O,EAAIgsB,MAAK,SAASlsB,GAAQ,OAAOiL,EAAK+gB,SAAShsB,EAAO,GACjE,CACA,OAAIE,aAAeiqB,EACRh5B,KAAK46B,cAAc7rB,GAE1BA,aAAekqB,GACRj5B,KAAK26B,eAAe5rB,EAGnC,EACAisB,gBAAiB,SAASjsB,GACtB,GAAI/O,KAAKgP,OAASD,EAAIC,MAClB,OAAOspB,EAEX,IAAI2C,EAAYj7B,KAAK6Q,QAAQwE,IACzB6lB,EAAYl7B,KAAK6Q,QAAQ6C,IACzBynB,EAAYn7B,KAAKua,YAAYlF,IAC7B+lB,EAAYp7B,KAAKua,YAAY7G,IAC7B2nB,EAAYtsB,EAAI8B,QAAQwE,IACxBimB,EAAYvsB,EAAI8B,QAAQ6C,IACxB6nB,EAAYxsB,EAAIwL,YAAYlF,IAC5BmmB,EAAYzsB,EAAIwL,YAAY7G,IAChC,OAAIunB,GAAUM,GACVF,GAAUF,GACVD,GAASM,GACTF,GAASF,EAEF,IAAInC,EAEP,IAAID,EAAUvoB,KAAKmK,IAAIsgB,EAAOI,GAClB7qB,KAAKmK,IAAIqgB,EAAQI,IAE7B,IAAIrC,EAAUvoB,KAAKC,IAAI0qB,EAAUI,GACrB/qB,KAAKC,IAAIyqB,EAASI,KAChC/N,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,YAErBM,CAEf,EACAD,UAAW,SAAStpB,GAChB,OAAIA,aAAeiqB,EACRh5B,KAAK46B,cAAc7rB,GAAOA,EAAMupB,EAEvCvpB,aAAekqB,EACRj5B,KAAKg7B,gBAAgBjsB,GAAKse,WAEjCte,aAAemqB,EACRnqB,EAAIspB,UAAUr4B,MAElBs4B,CACX,EACAjL,SAAU,WACN,OAAIrtB,KAAKu4B,SACE,IAAIS,EACPh5B,KAAK6Q,QAAQ6C,IACb1T,KAAK6Q,QAAQwE,IACbrV,KAAK6Q,QAAQ+mB,KACfpK,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,YAEzBh4B,IACX,EACA06B,UAAW,WACP,IAIIvtB,EAJA7B,EAAItL,KAAK6Q,QAASqJ,EAAIla,KAAKua,YAC3Bue,EAAKxtB,EAAEoI,IAAK+nB,EAAKnwB,EAAE+J,IAAK0jB,EAAK7e,EAAExG,IAAKgoB,EAAKxhB,EAAE7E,IAC3CsmB,EAAc,EAARrwB,EAAEssB,IAASgE,EAAc,EAARtwB,EAAEssB,IACzBiE,EAAc,EAAR3hB,EAAE0d,IAASkE,EAAc,EAAR5hB,EAAE0d,IACpBmE,GAAU,EAmBnB,OAhBIJ,IAAQE,GAAOD,IAAQE,IACnBhD,EAAKC,IACLgD,GAAU,EACV5uB,EAAM2rB,EAAIA,EAAKC,EAAIA,EAAK5rB,EACxBA,EAAMwuB,EAAKA,EAAME,EAAKA,EAAM1uB,GAE5BsuB,EAAKC,IACLK,GAAU,EACV5uB,EAAMsuB,EAAIA,EAAKC,EAAIA,EAAKvuB,EACxBA,EAAMyuB,EAAKA,EAAME,EAAKA,EAAM3uB,GAE5B4uB,IACA/7B,KAAK6Q,QAAU,IAAImoB,EAAUF,EAAI2C,EAAIG,EAAMD,GAC3C37B,KAAKua,YAAc,IAAIye,EAAUD,EAAI2C,EAAII,EAAMD,KAGhD77B,IACX,EACAytB,MAAO,SAASwM,EAAMC,EAAM9I,GACxB,GAAIA,GAAOpxB,KAAKk4B,SAAS+B,EAAMC,GAAMP,QAAS,CAC1C,IAAI7C,EAAM92B,KAAK6Q,QAAQ4c,MAAMwM,EAAMC,EAAM9I,GACnC,IACApxB,KAAKua,YAAYkT,MAAMwM,EAAMC,EAAM9I,GAMzC,OALIpxB,KAAKg4B,aACLlB,EAAMY,EAAa13B,KAAKgP,QACjBhP,KAAKy6B,SAAW,IAAM/C,EAAa13B,KAAKy6B,UAAY,IACrD,IAAM3D,GAETA,CACX,CACA,MAAO,OACX,EACAoB,SAAU,SAASkC,EAAMC,GACrB,OAAO,IAAIpB,EACPj5B,KAAK6Q,QAAQqnB,SAASkC,EAAMC,GAC5Br6B,KAAKua,YAAY2d,SAASkC,EAAMC,IAClC7M,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WAChC,EACA1K,SAAU,SAAS8M,EAAMC,EAAM2B,EAAOC,GAIlC,OAHa,MAATA,IACAA,EAAQD,GAEL,IAAI/C,EACPj5B,KAAK6Q,QAAQyc,SAAS8M,EAAMC,EAAM2B,GAClCh8B,KAAKua,YAAY+S,SAAS8M,EAAMC,EAAM4B,IACxCzO,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WAChC,EACA5zB,OAAQ,WACJ,GAAIpE,KAAK6Q,QAAQ+mB,KAAO53B,KAAKua,YAAYqd,IACrC,MAAM,IAAIzsB,MAAM,sCAEpB,OAAOnL,KAAKua,YAAY7G,IAAM1T,KAAK6Q,QAAQ6C,IAAM,CACrD,EACAvP,MAAO,WACH,GAAInE,KAAK6Q,QAAQ+mB,KAAO53B,KAAKua,YAAYqd,IACrC,MAAM,IAAIzsB,MAAM,sCAEpB,OAAOnL,KAAKua,YAAYlF,IAAMrV,KAAK6Q,QAAQwE,IAAM,CACrD,EACA6mB,SAAU,WACN,OAAOl8B,KAAK6Q,QAAQ5B,YACxB,EACAkH,WAAY,WACR,OAAO,IAAI8iB,EAAWj5B,KAAK6Q,QAAS,IAAImoB,EAAUh5B,KAAKua,YAAY7G,IAAK1T,KAAK6Q,QAAQwE,KACzF,EACAiB,YAAa,WACT,OAAO,IAAI2iB,EAAW,IAAID,EAAUh5B,KAAK6Q,QAAQ6C,IAAK1T,KAAKua,YAAYlF,KAAMrV,KAAKua,YACtF,EACA9D,OAAQ,WACJ,OAAO,IAAIwiB,EAAWj5B,KAAK6Q,QAAS,IAAImoB,EAAUh5B,KAAK6Q,QAAQ6C,IAAK1T,KAAKua,YAAYlF,KACzF,EACAuB,UAAW,WACP,OAAO,IAAIqiB,EAAW,IAAID,EAAUh5B,KAAKua,YAAY7G,IAAK1T,KAAK6Q,QAAQwE,KAAMrV,KAAKua,YACtF,EACAtL,WAAY,WACR,OAAOjP,IACX,EACAw4B,MAAO,SAAS9kB,GAEZ,OADAA,GAAOjD,KAAKmK,IAAI,EAAG5a,KAAK6Q,QAAQ6C,KACzB,IAAIulB,EACP,IAAID,EAAUtlB,EAAK1T,KAAK6Q,QAAQwE,KAChC,IAAI2jB,EAAUtlB,EAAK1T,KAAKua,YAAYlF,MACtCmY,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WAChC,EACAS,SAAU,SAASpjB,GAEf,OADAA,GAAO5E,KAAKmK,IAAI,EAAG5a,KAAK6Q,QAAQwE,KACzB,IAAI4jB,EACP,IAAID,EAAUh5B,KAAK6Q,QAAQ6C,IAAK2B,GAChC,IAAI2jB,EAAUh5B,KAAKua,YAAY7G,IAAK2B,IACtCmY,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WAChC,EACAmE,OAAQ,SAASzoB,EAAK2B,GAGlB,OAFA3B,GAAOjD,KAAKmK,IAAI,EAAG5a,KAAK6Q,QAAQ6C,KAChC2B,GAAO5E,KAAKmK,IAAI,EAAG5a,KAAK6Q,QAAQwE,KACzB,IAAI2jB,EAAUtlB,EAAK2B,EAAK,GAC1BmY,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WACnC,EACAnjB,WAAY,SAASjG,GAMjB,IALA,IAAIwtB,EAAWp8B,KAAK6Q,QAAQ6C,IACxB2oB,EAASr8B,KAAKua,YAAY7G,IAC1B4oB,EAAWt8B,KAAK6Q,QAAQwE,IACxBknB,EAASv8B,KAAKua,YAAYlF,IAErB9R,EAAI64B,EAAU74B,GAAK84B,EAAQ94B,IAChCqL,EAAS,IAAIqqB,EACT,IAAID,EAAUz1B,EAAG+4B,GACjB,IAAItD,EAAUz1B,EAAGg5B,IAG7B,EACA9kB,cAAe,SAAS7I,GAMpB,IALA,IAAIwtB,EAAWp8B,KAAK6Q,QAAQ6C,IACxB2oB,EAASr8B,KAAKua,YAAY7G,IAC1B4oB,EAAWt8B,KAAK6Q,QAAQwE,IACxBknB,EAASv8B,KAAKua,YAAYlF,IAErB9R,EAAI+4B,EAAU/4B,GAAKg5B,EAAQh5B,IAChCqL,EAAS,IAAIqqB,EACT,IAAID,EAAUoD,EAAU74B,GACxB,IAAIy1B,EAAUqD,EAAQ94B,IAGlC,EACAgvB,aAAc,SAAS/e,GACnB,OAAOA,EAAK2J,QAAO,SAASpO,GACxB,OAAOA,EAAIE,aAAakjB,WAAWnyB,KACvC,GAAGA,KACP,EAEAw8B,MAAO,SAAShpB,EAAM5E,GAClB,IAAI2jB,EAAevyB,KAAKuyB,aAAa/e,GAEjCipB,EAAaz8B,KAAK6Q,QAAQ6C,IAC1BgpB,EAAa18B,KAAK6Q,QAAQwE,IAC1BsnB,EAAiB38B,KAAKua,YAAY7G,IAClCkpB,EAAiB58B,KAAKua,YAAYlF,IAElCwnB,GAAW,EAEftK,EAAazjB,SAAQ,SAASC,IAC1BA,EAAMA,EAAIE,cACF4B,QAAQ6C,IAAM+oB,IAClBI,GAAW,EACXJ,EAAa1tB,EAAI8B,QAAQ6C,KAGzB3E,EAAI8B,QAAQwE,IAAMqnB,IAClBG,GAAW,EACXH,EAAa3tB,EAAI8B,QAAQwE,KAGzBtG,EAAIwL,YAAY7G,IAAMipB,IACtBE,GAAW,EACXF,EAAiB5tB,EAAIwL,YAAY7G,KAGjC3E,EAAIwL,YAAYlF,IAAMunB,IACtBC,GAAW,EACXD,EAAiB7tB,EAAIwL,YAAYlF,KAGjCzG,GACAA,EAASG,EAEjB,IAEA,IAAIhJ,EAAS,IAAIkzB,EACb,IAAID,EAAUyD,EAAYC,GAC1B,IAAI1D,EAAU2D,EAAgBC,IAGlC,OAAIC,EACO92B,EAAOy2B,MAAMhpB,EAAM5E,GAEnB7I,CAEf,EACA4U,OAAQ,SAASra,GACb,IAAIw8B,EAAQrsB,KAAKmK,IAAI1L,KAAKuB,KAAM,GAChC,SAASssB,EAAI76B,GAAS,OAAOA,GAAS,CAAG,CAEzC,IAAI6d,EAAM/f,KAAK6Q,QAAQ6C,IAAMqpB,EAAIz8B,EAAQyf,KACrCN,EAAOzf,KAAK6Q,QAAQwE,IAAM0nB,EAAIz8B,EAAQmf,MACtCO,EAAShgB,KAAKua,YAAY7G,IAAMqpB,EAAIz8B,EAAQ0f,QAC5CL,EAAQ3f,KAAKua,YAAYlF,IAAM0nB,EAAIz8B,EAAQqf,OAE/C,OAAIF,EAAO,GAAKE,EAAQ,GAAKI,EAAM,GAAKC,EAAS,EACtCsY,EACAvY,GAAOC,GAAUP,GAAQE,EACzB,IAAIsZ,EAAW,IAAID,EAAU8D,EAAM/c,GAAM+c,EAAMrd,IAClC,IAAIuZ,EAAU8D,EAAM9c,GAAS8c,EAAMnd,KAEhD2Y,CAEf,EACA0E,KAAM,SAASjlB,EAAMkC,GACjB,OAAO,IAAIgf,EACP,IAAID,EAAUh5B,KAAK6Q,QAAQ6C,IAAMqE,EACrB/X,KAAK6Q,QAAQwE,IAAM4E,GAC/B,IAAI+e,EAAUh5B,KAAKua,YAAY7G,IAAMqE,EACzB/X,KAAKua,YAAYlF,IAAM4E,GAE3C,EACAyY,MAAO,WACH,OAAO1yB,KAAK6Q,QAAQpB,QAAQ+d,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,WAC1D,EACAO,OAAQ,WACJ,OAAQv4B,KAAKy6B,UAAYz6B,KAAK6Q,QAAQsN,GAAGne,KAAKua,YAClD,EACA6d,SAAU,WACN,OAAOp4B,KAAK6Q,QAAU,IAAM7Q,KAAKua,WACrC,EACA4d,OAAQ,SAASzkB,EAAK2B,EAAK4kB,EAAMC,EAAMI,EAAQvI,EAAO9c,GAClD,IAAIslB,EAAKv6B,KAAK6Q,QAAQsnB,OAAOzkB,EAAK2B,EAAK4kB,EAAMC,EAAMI,EAAQvI,EAAO9c,GAC9DgoB,EAAKj9B,KAAKua,YAAY4d,OAAOzkB,EAAK2B,EAAK4kB,EAAMC,EAAMI,EAAQvI,EAAO9c,GACtE,OAAIslB,IAAOjC,GAAU2E,IAAO3E,EACjBA,GAEPiC,IAAOjC,GACPiC,EAAKv6B,KAAK6Q,QAAQqnB,SAASxkB,EAAK2B,GAC5BilB,EACAC,EAAG7mB,IAAMqe,EAETwI,EAAGllB,IAAM0c,EAED,MAARkI,GAAwB,MAARC,IAChBK,EAAKA,EAAGjN,SAAS2M,EAAMC,EAAMl6B,KAAK6Q,QAAQ+mB,OAGzCqF,IAAO3E,IACZ2E,EAAKj9B,KAAKua,YAAY2d,SAASxkB,EAAK2B,GAChCilB,EACA2C,EAAGvpB,IAAMqe,EAAQ,EAEjBkL,EAAG5nB,IAAM0c,EAAQ,EAET,MAARkI,GAAwB,MAARC,IAChB+C,EAAKA,EAAG3P,SAAS2M,EAAMC,EAAMl6B,KAAKua,YAAYqd,OAG/C,IAAIqB,EAAWsB,EAAI0C,GACrBzP,SAASxtB,KAAKgP,MAAOhP,KAAKg4B,YAC1B3K,WACT,EACAsM,MAAO,WACH,OAAO35B,KAAK6Q,QAAQ8oB,SAAW35B,KAAKua,YAAYof,OACpD,IAKAT,EAAanB,EAAM33B,OAAO,CAC1BC,KAAM,SAAkBmT,GACpBxT,KAAKwT,KAAOA,EACZxT,KAAKqB,OAASmS,EAAKnS,MACvB,EACAoO,MAAO,WACH,OAAO,IAAIypB,EAAWl5B,KAAKwT,KAAK1S,QACpC,EACAu3B,UAAW,SAAStpB,GAEhB,IADA,IAAIzD,EAAI,GACC/H,EAAI,EAAGA,EAAIvD,KAAKqB,SAAUkC,EAAG,CAClC,IAAIkD,EAAIsI,EAAIspB,UAAUr4B,KAAKwT,KAAKjQ,IAC5BkD,IAAM6xB,GACNhtB,EAAE3K,KAAK8F,EAEf,CACA,OAAI6E,EAAEjK,OAAS,EACJ,IAAI63B,EAAW5tB,GAAG+hB,WAEtBiL,CACX,EACAjL,SAAU,WACN,IAAI6P,EAAI,IAAIhE,EAAWl5B,KAAKwT,KAAKqjB,QAAO,SAASvrB,EAAGyD,GAKhD,OAJAA,EAAMA,EAAIse,cACEiL,GACRhtB,EAAE3K,KAAKoO,GAEJzD,CACX,GAAG,KACH,OAAI4xB,EAAEC,QACK7E,EAEP4E,EAAE/D,SACK+D,EAAE1pB,KAAK,GAEX0pB,CACX,EACAhF,SAAU,SAASkC,EAAMC,GACrB,OAAO,IAAInB,EAAWl5B,KAAKwT,KAAKrR,KAAI,SAAS4M,GACzC,OAAOA,EAAImpB,SAASkC,EAAMC,EAC9B,IACJ,EACAvrB,QAAS,SAASF,EAAUzG,GACxBnI,KAAKwT,KAAK1E,SAAQ,SAASC,GACnBA,aAAemqB,EACfnqB,EAAID,QAAQF,EAAUzG,GAEtByG,EAASpO,KAAK2H,EAAK4G,EAE3B,GAAG5G,EACP,EACA8G,WAAY,WACR,OAAOjP,KAAKwT,KAAK,GAAGvE,YACxB,EACA4rB,SAAU,SAASuC,GACf,OAAOp9B,KAAKwT,KAAKunB,MAAK,SAAShsB,GAAO,OAAOA,EAAI8rB,SAASuC,EAAS,GACvE,EACAj7B,IAAK,SAASyM,EAAUzG,GACpB,IAAIqL,EAAO,GAIX,OAHAxT,KAAK8O,SAAQ,SAASC,GAClByE,EAAK7S,KAAKiO,EAASpO,KAAK2H,EAAK4G,GACjC,IACO,IAAImqB,EAAW1lB,EAC1B,EACAkf,MAAO,WACH,OAAO1yB,KAAKwT,KAAK,GAAGkf,OACxB,EACAI,UAAW,WACP,OAAO9yB,KAAKwT,KAAKxT,KAAKqB,OAAS,EACnC,EACAO,KAAM,WACF,OAAO5B,KAAKqB,MAChB,EACA83B,OAAQ,WACJ,OAAsB,GAAfn5B,KAAKqB,MAChB,EACA87B,MAAO,WACH,OAAuB,IAAhBn9B,KAAKqB,MAChB,EACAk3B,OAAQ,WACJ,OAAOv4B,KAAKm5B,UAAYn5B,KAAKwT,KAAK,GAAG+kB,QACzC,EACAG,QAAS,SAAShuB,GACd,OAAO1K,KAAKwT,KAAK9I,EACrB,EACAiuB,eAAgB,SAASjuB,GACrB,OAAIA,IAAU1K,KAAKqB,OAAS,EACjB,EAEAqJ,EAAQ,CAEvB,EACAkuB,mBAAoB,SAASluB,GACzB,OAAc,IAAVA,EACO1K,KAAKqB,OAAS,EAEdqJ,EAAQ,CAEvB,EACA+I,OAAQ,SAAS1E,GACb,OAAO,IAAImqB,EAAWl5B,KAAKwT,KAAKC,OAAO,CAAC1E,IAC5C,EACA0e,MAAO,SAAS/Z,EAAK2B,EAAK+b,GACtB,OAAOpxB,KAAKwT,KAAKrR,KAAI,SAAS4M,GAAO,OAAOA,EAAI0e,MAAM/Z,EAAK2B,EAAK+b,EAAM,IAAGjuB,KAAK,IAClF,EAEAm2B,UAAW,SAAS5uB,EAAOqE,GACvB,IAAIsuB,EAAUr9B,KAAKwT,KAAK1S,QAExB,OADAu8B,EAAQ7rB,OAAO9G,EAAO,EAAGqE,GAClB,IAAImqB,EAAWmE,EAC1B,EAEAlnB,WAAY,WACR,OAAOnW,KAAKmC,KAAI,SAAS4M,GACrB,OAAOA,EAAIoH,YACf,GACJ,EACAG,YAAa,WACT,OAAOtW,KAAKmC,KAAI,SAAS4M,GACrB,OAAOA,EAAIuH,aACf,GACJ,EACAG,OAAQ,WACJ,OAAOzW,KAAKmC,KAAI,SAAS4M,GACrB,OAAOA,EAAI0H,QACf,GACJ,EACAG,UAAW,WACP,OAAO5W,KAAKmC,KAAI,SAAS4M,GACrB,OAAOA,EAAI6H,WACf,GACJ,EACA/B,WAAY,SAASjG,GACjB5O,KAAK8O,SAAQ,SAASC,GAClBA,EAAI8F,WAAWjG,EACnB,GACJ,EACA6I,cAAe,SAAS7I,GACpB5O,KAAK8O,SAAQ,SAASC,GAClBA,EAAI0I,cAAc7I,EACtB,GACJ,EACAupB,OAAQ,SAASzkB,EAAK2B,EAAK4kB,EAAMC,EAAMI,EAAQvI,EAAO9c,GAClD,OAAOjV,KAAKmC,KAAI,SAAS4M,GACrB,OAAOA,EAAIopB,OAAOzkB,EAAK2B,EAAK4kB,EAAMC,EAAMI,EAAQvI,EAAO9c,EAC3D,IAAGoY,UACP,EACA+K,SAAU,WACN,OAAOp4B,KAAKwT,KAAKrR,KAAI,SAAS4M,GAC1B,OAAOA,EAAIqpB,UACf,IAAGj1B,KAAK,KACZ,EACAw2B,MAAO,WACH,IAAK,IAAIp2B,EAAIvD,KAAKwT,KAAKnS,SAAUkC,GAAK,GAClC,GAAIvD,KAAKwT,KAAKjQ,GAAGo2B,QACb,OAAO,EAGf,OAAO,CACX,EACAC,YAAa,SAASC,EAAcC,GAChC95B,KAAKwT,KAAK1E,SAAQ,SAASC,GACvBA,EAAI6qB,YAAYC,EAAcC,EAClC,GACJ,IAKJzC,EAAciG,QAAUhF,EACxBjB,EAAckG,SAAW,IAAItE,EAAW,IAAID,EAAU,EAAG,GAAI,IAAIA,EAAUtZ,IAAUA,MACrF2X,EAAcmG,SAAW,IAAIxE,EAAU,EAAG,GAC1C3B,EAAcoG,IAAM1F,EACpBV,EAAcqG,QAAU1D,EACxB3C,EAAcsG,QAAU3E,EACxB3B,EAAcrd,SAAWif,EACzB5B,EAAcve,SAAWogB,EAEzB7B,EAAckG,SAAS9P,MAAQ,WAC3B,MAAO,QACX,EAEJ,SAAUxtB,GAEN,IAAI+Z,EAAW/Z,EAAMsN,YAAYyM,SAC7B2jB,EAAU19B,EAAMsN,YAAYowB,QAE5BC,EAAqB39B,EAAM0B,MAAMvB,OAAO,CACxCC,KAAM,SAASw9B,GACX79B,KAAK89B,MAAQD,CACjB,EAEAE,eAAgB,SAAShM,EAAOvM,EAAK/e,EAAGqqB,GACpC,IAAIkN,EAAYh+B,KAAK89B,MAAMnR,UAAUoF,EAAM9iB,cACvCgvB,EAAUj+B,KAAK89B,MAAMnR,UAAUnH,EAAIvW,cACvC,OAAOwB,KAAK0pB,IAAI8D,EAAQnN,GAAKkN,EAAUlN,IAAMrgB,KAAK0pB,IAAI6D,EAAUv3B,GAAKw3B,EAAQx3B,GACjF,EAEAy3B,aAAc,SAASvlB,EAAWwlB,GAC9B,IAGIC,EAUAC,EAAOC,EAAUC,EAbjB1tB,EAAU8H,EAAU9H,QACpB0J,EAAc5B,EAAU4B,YAGxBikB,EAAQL,EAAOzqB,KAAO7C,EAAQ6C,IAC9B+qB,EAAUN,EAAO9oB,KAAOxE,EAAQwE,IAUpC,GAAiB,KAPb+oB,EADAI,EACWC,EAAU,EAAI,EAEdA,EAAU,EAAI,GAMzBJ,EAAQxtB,EACRytB,EAAW/jB,GAEC4jB,EAAOzqB,IAAM4qB,EAAS5qB,KAAOyqB,EAAO9oB,IAAMipB,EAASjpB,OAG3D8oB,EAAS,IAAIR,EAAQltB,KAAKmK,IAAIujB,EAAOzqB,IAAK4qB,EAAS5qB,KAAMjD,KAAKmK,IAAIujB,EAAO9oB,IAAKipB,EAASjpB,OAIvFkpB,EADAv+B,KAAK+9B,eAAeO,EAAUH,EAAQ,QAAS,UAChC,IAAIR,EAAQQ,EAAOzqB,IAAK4qB,EAASjpB,KAEjC,IAAIsoB,EAAQW,EAAS5qB,IAAKyqB,EAAO9oB,UAEjD,GAAiB,IAAb+oB,EAAgB,CACvB,IAAIM,EAAa,IAAIf,EAAQ9sB,EAAQwE,IAAKkF,EAAY7G,KAElDyqB,EAAOzqB,IAAM6G,EAAY7G,KAAO1T,KAAK+9B,eAAeW,EAAYP,EAAQ,OAAQ,WAChFE,EAAQxtB,EACR0tB,EAAe,IAAIZ,EAAQQ,EAAOzqB,IAAK6G,EAAYlF,OAEnDgpB,EAAQ9jB,EACRgkB,EAAe,IAAIZ,EAAQ9sB,EAAQ6C,IAAKyqB,EAAO9oB,KAEvD,MAAO,GAAiB,IAAb+oB,EAAe,CACtB,IAAIO,EAAW,IAAIhB,EAAQ9sB,EAAQ6C,IAAK6G,EAAYlF,KAEhD8oB,EAAO9oB,IAAMkF,EAAYlF,MAAQrV,KAAK+9B,eAAeY,EAAUR,EAAQ,QAAS,QAChFE,EAAQxtB,EACR0tB,EAAe,IAAIZ,EAAQpjB,EAAY7G,IAAKyqB,EAAO9oB,OAEnDgpB,EAAQ9jB,EACRgkB,EAAe,IAAIZ,EAAQQ,EAAOzqB,IAAK7C,EAAQwE,KAEvD,MACIgpB,EAAQ9jB,EAEJgkB,EADAv+B,KAAK+9B,eAAeltB,EAASstB,EAAQ,OAAQ,OAC9B,IAAIR,EAAQQ,EAAOzqB,IAAK7C,EAAQwE,KAEhC,IAAIsoB,EAAQ9sB,EAAQ6C,IAAKyqB,EAAO9oB,KAIvD,OAAOrV,KAAK89B,MAAMpD,UAAU,IAAI1gB,EAASqkB,EAAOE,GACpD,IAGJt+B,EAAMsN,YAAYqwB,mBAAqBA,CAC1C,CAjFD,CAiFG39B,OAEH,SAAUA,GAEN,IAAI+Z,EAAW/Z,EAAMsN,YAAYyM,SAC7B2jB,EAAU19B,EAAMsN,YAAYowB,QAE5BiB,EAAgB3+B,EAAM0B,MAAMvB,OAAO,CACnCC,KAAM,SAASmsB,EAAOjO,EAAMsgB,EAAarC,GACrCx8B,KAAK6+B,YAAcA,EAEnB7+B,KAAK8+B,SAAW,SAASp0B,GACrB,IAAInF,EAAUi3B,EAAMx8B,KAAK6N,MAAMnD,IAC3BmD,EAAQ7N,KAAK6N,MAAM0Q,EAAKwgB,YAAYx5B,EAAQsL,QAAQ2b,KACxD,OAAOgQ,EAAM3uB,GAAOgD,QAAQ2b,EAChC,EAEAxsB,KAAKg/B,UAAY,SAASt0B,GACtB,IAAInF,EAAUi3B,EAAMx8B,KAAK6N,MAAMnD,IAC3BmD,EAAQ7N,KAAK6N,MAAM0Q,EAAK0gB,YAAY15B,EAAQgV,YAAYiS,KAC5D,OAAOgQ,EAAM3uB,GAAO0M,YAAYiS,EACpC,EAGAxsB,KAAKk/B,SAAW,SAASx0B,GACrB,IAAImD,EAAQ2uB,EAAMx8B,KAAK6N,MAAMnD,IAC7B,OAAO6T,EAAK0gB,YAAYpxB,EAAM0M,YAAYiS,GAC9C,EAEAxsB,KAAKm/B,UAAY,SAASz0B,GACtB,IAAImD,EAAQ2uB,EAAMx8B,KAAK6N,MAAMnD,IAC7B,OAAO6T,EAAKwgB,YAAYlxB,EAAMgD,QAAQ2b,GAC1C,CACJ,EAEA4S,SAAU,SAASrf,EAAKC,GACpBhgB,KAAK+f,IAAMA,EACX/f,KAAKggB,OAASA,CAClB,EAEAnS,MAAO,SAASnD,GACZ,OAAO1K,KAAK6+B,YAAYn0B,EAAO1K,KAAK+f,IAAK/f,KAAKggB,OAClD,IAGAqf,EAAiBp/B,EAAM0B,MAAMvB,OAAO,CACpCC,KAAM,SAAS2O,GACXhP,KAAKqP,OAASL,EACdhP,KAAKs/B,mBAAqB,IAAIr/B,EAAMsN,YAAYqwB,mBAAmB5uB,EAAM8uB,OAEzE99B,KAAKu/B,QAAU,IAAIX,EAAc,MAAO5+B,KAAKqP,OAAOyuB,MAAMpjB,SAAU1a,KAAKw/B,YAAYtwB,KAAKlP,MAAOA,KAAKw8B,MAAMttB,KAAKlP,OACjHA,KAAKy/B,QAAU,IAAIb,EAAc,MAAO5+B,KAAKqP,OAAOyuB,MAAMtjB,MAAOxa,KAAK0/B,SAASxwB,KAAKlP,MAAOA,KAAKw8B,MAAMttB,KAAKlP,MAC/G,EAEAoE,OAAQ,SAASA,GACbpE,KAAK2/B,gBAAkBv7B,CAC3B,EAEAo4B,MAAO,SAASztB,GACZ,OAAO/O,KAAKqP,OAAOuwB,gBAAgB7wB,EACvC,EAEAywB,YAAa,SAASnqB,EAAKoB,EAAQG,GAC/B,OAAO5W,KAAKqP,OAAOR,KAAK4H,EAAQpB,EAAKuB,EAAYH,EAAQ,EAC7D,EAEAipB,SAAU,SAAShsB,EAAKmsB,EAASC,GAC7B,OAAO9/B,KAAKqP,OAAOR,KAAK6E,EAAKmsB,EAAS,EAAGC,EAAWD,EACxD,EAEAE,6BAA8B,WAC1B,OAAO//B,KAAKqP,OAAOrB,SAAS6sB,SAAS76B,KAAKqP,OAAO2wB,aACrD,EAEAC,kBAAmB,SAAS/9B,GACxB,IAAIyW,EAAY3Y,KAAKqP,OAAOsJ,YAE5BkR,YAAW,WACPlR,EAAUzW,MAAMA,IACpB,GACJ,EAEAg+B,UAAW,WACPlgC,KAAKqP,OAAOrB,OAAOhO,KAAKqP,OAAOqO,UACnC,EAEA1P,OAAQ,SAASe,EAAKoxB,EAAMC,GACxBrxB,EAAM/O,KAAKqgC,WAAWtxB,EAAKoxB,GAEvBC,IACArxB,EAAM/O,KAAKqP,OAAOrB,SAASyF,OAAO1E,IAGtC/O,KAAKqP,OAAOrB,OAAOe,EACvB,EAEAsxB,WAAY,SAAStxB,EAAKoxB,GACtB,IAAItC,EAAO79B,KAAKqP,OAAOyuB,MAEvB,OAAOqC,GACH,IAAK,QACDpxB,EAAM8uB,EAAKnD,UAAU3rB,GACrB,MACJ,IAAK,MACDA,EAAM8uB,EAAKyC,OAAOvxB,EAAI2E,KACtB,MACJ,IAAK,SACD3E,EAAM8uB,EAAK0C,OAAOxxB,EAAIsG,KACtB,MACJ,IAAK,QACDtG,EAAM/O,KAAKqP,OAAOqO,UAI1B,OAAO3O,CACX,EAEAyxB,eAAgB,SAASzxB,EAAKoxB,EAAMC,EAAe7O,EAAUxH,GACzD,GAAY,YAARoW,EACAngC,KAAKqP,OAAOoxB,qBACT,GAAIlP,GAAoB,SAAR4O,EAAiB,CACpC,IAAItyB,EAAQ,IAAImM,EAASha,KAAKqP,OAAO8H,aAAaub,QAAS3jB,GAC3D/O,KAAKqP,OAAOrB,OAAOH,GAAO,GAAO,GACjC7N,KAAKqP,OAAOmxB,eAAezW,EAC/B,MACI/pB,KAAKqP,OAAOmxB,eAAezW,GAC3B/pB,KAAKgO,OAAOe,EAAKoxB,EAAMC,EAE/B,EAEAM,kBAAmB,WACf1gC,KAAKqP,OAAOqxB,mBAChB,EAEAC,qBAAsB,SAAS5xB,EAAKoxB,GAChC,IAAInxB,EAAQhP,KAAKqP,OACjBL,EAAMa,eAAiB,KAClBb,EAAMhB,SAAS6sB,SAAS76B,KAAKqgC,WAAWtxB,EAAKoxB,KAC9CngC,KAAKgO,OAAOe,EAAKoxB,EAEzB,EAEAS,4BAA6B,SAASrxB,GAClC,IAAIP,EAAQhP,KAAKqP,OACjBL,EAAMa,eAAiBN,EACvBP,EAAMc,cAAc,CAAE6I,WAAW,GACrC,EAEAkoB,gBAAiB,SAASC,GACtB,IAeIC,EAfAC,EAAYhhC,KAAKihC,mBAAmBH,GAEpC9xB,EAAQhP,KAAKqP,OACb6xB,EAAiBlhC,KAAK2/B,gBACtB5nB,EAAO/I,EAAM8uB,MAAMtjB,MACnBxC,EAAUhJ,EAAM8uB,MAAMpjB,SAEtBymB,EAAoBnyB,EAAMoyB,gCAC1BzoB,EAAY3J,EAAMhB,SAASiB,aAC3BkI,EAAanI,EAAMmI,aAEnBtG,EAAUswB,EAAkBtwB,QAAQpB,QACpC8K,EAAc4mB,EAAkB5mB,YAAY9K,QAC5CivB,EAAa,IAAIf,EAAQpjB,EAAY7G,IAAK7C,EAAQwE,KAOtD,OAHArV,KAAKu/B,QAAQH,SAASzmB,EAAU9H,QAAQ6C,IAAKiF,EAAU4B,YAAY7G,KACnE1T,KAAKy/B,QAAQL,SAASzmB,EAAU9H,QAAQwE,IAAKsD,EAAU4B,YAAYlF,KAE3D2rB,GACN,IAAK,cACHnwB,EAAQwE,IAAMrV,KAAKu/B,QAAQT,SAASjuB,EAAQwE,KAC5C0rB,EAAalwB,EACb,MACF,IAAK,eACHA,EAAQwE,IAAMrV,KAAKu/B,QAAQL,SAASruB,EAAQwE,KAC5C0rB,EAAalwB,EACb,MACF,IAAK,eACH0J,EAAYlF,IAAMrV,KAAKu/B,QAAQP,UAAUzkB,EAAYlF,KACrD0rB,EAAaxmB,EACb,MACF,IAAK,cACHA,EAAYlF,IAAMrV,KAAKu/B,QAAQJ,UAAU5kB,EAAYlF,KACrD0rB,EAAaxmB,EACb,MAGF,IAAK,YACH1J,EAAQ6C,IAAM1T,KAAKy/B,QAAQX,SAASjuB,EAAQ6C,KAC5CqtB,EAAalwB,EACb,MACF,IAAK,cACHA,EAAQ6C,IAAM1T,KAAKy/B,QAAQP,SAASruB,EAAQ6C,KAC5CqtB,EAAalwB,EACb,MACF,IAAK,cACH0J,EAAY7G,IAAM1T,KAAKy/B,QAAQT,UAAUzkB,EAAY7G,KACrDqtB,EAAaxmB,EACb,MACF,IAAK,YACHA,EAAY7G,IAAM1T,KAAKy/B,QAAQN,UAAU5kB,EAAY7G,KACrDqtB,EAAaxmB,EACb,MAGF,IAAK,iBACH1J,EAAQ6C,IAAMqE,EAAKspB,SAASxwB,EAAQ6C,IAAKwtB,GACzC,MACF,IAAK,iBACH3mB,EAAY7G,IAAMqE,EAAKspB,SAAS9mB,EAAY7G,IAAKwtB,GACjD,MACF,IAAK,mBACH3mB,EAAY7G,IAAMqE,EAAKupB,SAAS/mB,EAAY7G,IAAKwtB,GACjD,MACF,IAAK,mBACHrwB,EAAQ6C,IAAMqE,EAAKupB,SAASzwB,EAAQ6C,IAAKwtB,GACzC,MAEF,IAAK,YACHrwB,EAAQwE,IAAM2C,EAAQupB,eACtBhnB,EAAYlF,IAAM8B,EAAWoD,YAAYlF,IACzC0rB,EAAalwB,EACb,MACF,IAAK,WACH0J,EAAYlF,IAAM2C,EAAQwpB,cAC1B3wB,EAAQwE,IAAM8B,EAAWtG,QAAQwE,IACjC0rB,EAAaxmB,EACb,MACF,IAAK,YACH1J,EAAQ6C,IAAMqE,EAAKwpB,eACnBhnB,EAAY7G,IAAMyD,EAAWoD,YAAY7G,IACzCqtB,EAAalwB,EACb,MACF,IAAK,WACH0J,EAAY7G,IAAMqE,EAAKypB,cACvB3wB,EAAQ6C,IAAMyD,EAAWtG,QAAQ6C,IACjCqtB,EAAaxmB,EACb,MACF,IAAK,OACHA,EAAY7G,IAAMqE,EAAKypB,cACvBjnB,EAAYlF,IAAM2C,EAAQwpB,cAC1B3wB,EAAUsG,EAAWtG,QACrBkwB,EAAaxmB,EACb,MACF,IAAK,QACH1J,EAAQ6C,IAAMqE,EAAKwpB,eACnB1wB,EAAQwE,IAAM2C,EAAQupB,eACtBhnB,EAAcpD,EAAWoD,YACzBwmB,EAAalwB,EACb,MAEF,IAAK,oBACH0J,EAAYlF,IAAM2C,EAAQypB,UAAUlnB,EAAYlF,IAAKqsB,EAAiB1yB,EAAOuL,GAAa,IAC1FwmB,EAAaxmB,EACb,MACF,IAAK,oBACH1J,EAAQwE,IAAM2C,EAAQypB,UAAU/C,EAAWrpB,IAAKqsB,EAAiB1yB,EAAO0vB,GAAY,IACpFqC,EAAalwB,EACb,MACF,IAAK,mBACHA,EAAQwE,IAAM2C,EAAQ2pB,UAAUjD,EAAWrpB,IAAKqsB,EAAiB1yB,EAAO0vB,GAAY,IACpFqC,EAAalwB,EACb,MACF,IAAK,mBACH0J,EAAYlF,IAAM2C,EAAQ2pB,UAAUpnB,EAAYlF,IAAKqsB,EAAiB1yB,EAAOuL,GAAa,IAC1FwmB,EAAaxmB,EACb,MACF,IAAK,iBACH1J,EAAQ6C,IAAMqE,EAAK4pB,UAAU9wB,EAAQ6C,IAAKguB,EAAiB1yB,EAAO6B,GAAS,IAC3EkwB,EAAalwB,EACb,MACF,IAAK,iBACH0J,EAAY7G,IAAMqE,EAAK4pB,UAAUpnB,EAAY7G,IAAKguB,EAAiB1yB,EAAOuL,GAAa,IACvFwmB,EAAaxmB,EACb,MACF,IAAK,mBACHA,EAAY7G,IAAMqE,EAAK0pB,UAAUlnB,EAAY7G,IAAKguB,EAAiB1yB,EAAOuL,GAAa,IACvFwmB,EAAaxmB,EACb,MACF,IAAK,mBACH1J,EAAQ6C,IAAMqE,EAAK0pB,UAAU5wB,EAAQ6C,IAAKguB,EAAiB1yB,EAAO6B,GAAS,IAC3EkwB,EAAalwB,EAIjB,IAAI+wB,EAAe,IAAI5nB,EAASnJ,EAAS0J,GAEpCva,KAAKw8B,MAAMoF,GAAczP,WAAWhb,IAMrC4pB,GACA/xB,EAAMyM,MAAMslB,GAGhB/gC,KAAK6hC,4BAA4BD,IAR7B5hC,KAAK6gC,gBAAgBG,EAAUl+B,QAAQ,SAAU,UASzD,EAEAg/B,eAAgB,SAASd,GACrB,IAAIhyB,EAAQhP,KAAKqP,OACb8H,EAAanI,EAAMmI,aACnBtG,EAAUsG,EAAWtG,QACrB0J,EAAcpD,EAAWoD,YAEzBzG,EAAO9E,EAAM+yB,qBACbhqB,EAAO/I,EAAM8uB,MAAMtjB,MACnBxC,EAAUhJ,EAAM8uB,MAAMpjB,SAEtBhH,EAAMI,EAAKJ,IACX4J,EAASxJ,EAAKuB,IAElB,OAAQ2rB,GACN,IAAK,OACH1jB,EAAStF,EAAQ+mB,YAAYluB,EAAQwE,KACrC,MACF,IAAK,KACH3B,EAAMqE,EAAKgnB,YAAYluB,EAAQ6C,KAC/B,MACF,IAAK,QACH4J,EAAStF,EAAQinB,YAAY1kB,EAAYlF,KACzC,MACF,IAAK,OACH3B,EAAMqE,EAAKknB,YAAY1kB,EAAY7G,KACnC,MACF,IAAK,YACH4J,EAAStF,EAAQupB,eACjB,MACF,IAAK,WACHjkB,EAAStF,EAAQwpB,cACjB,MACF,IAAK,YACH9tB,EAAMqE,EAAKwpB,eACX,MACF,IAAK,WACH7tB,EAAMqE,EAAKypB,cACX,MACF,IAAK,OACH9tB,EAAMqE,EAAKypB,cACXlkB,EAAStF,EAAQwpB,cACjB,MACF,IAAK,QACH9tB,EAAMqE,EAAKwpB,eACXjkB,EAAStF,EAAQupB,eACjB,MACF,IAAK,YACH7tB,EAAMqE,EAAKupB,SAAS/mB,EAAY7G,IAAK1T,KAAK2/B,iBAC1C,MACF,IAAK,YACHjsB,EAAMqE,EAAKspB,SAAS9mB,EAAY7G,IAAK1T,KAAK2/B,iBAC1C,MAEF,IAAK,aACHriB,EAAStF,EAAQypB,UAAUnkB,EAAQokB,EAAiB1yB,EAAOuL,GAAa,IACxE,MACF,IAAK,YACH+C,EAAStF,EAAQ2pB,UAAUrkB,EAAQokB,EAAiB1yB,EAAOuL,GAAa,IACxE,MACF,IAAK,UACH7G,EAAMqE,EAAK4pB,UAAUjuB,EAAKguB,EAAiB1yB,EAAOuL,GAAa,IAC/D,MACF,IAAK,YACH7G,EAAMqE,EAAK0pB,UAAU/tB,EAAKguB,EAAiB1yB,EAAOuL,GAAa,IAInEvL,EAAMhB,OAAO,IAAI2vB,EAAQjqB,EAAK4J,GAClC,EAEA0kB,oBAAqB,SAAShB,GAC1B,IAcIiB,EAAYC,EAIZ/0B,EAlBA6B,EAAQhP,KAAKqP,OAEbwB,EADa7B,EAAMmI,aACEtG,QAErBiD,EAAO9E,EAAM+yB,qBACbhqB,EAAO/I,EAAM8uB,MAAMtjB,MACnBxC,EAAUhJ,EAAM8uB,MAAMpjB,SAEtBhH,EAAMI,EAAKJ,IACX4J,EAASxJ,EAAKuB,IAEd8sB,GAAc,EACdC,GAAa,EAIb1F,EAAa7rB,EAAQwE,IACrBonB,EAAa5rB,EAAQ6C,IAGzB,SAAS2uB,EAAard,GAClBid,EAAajd,EAAInU,QACjBqxB,EAAiBld,EAAIzK,WACzB,CAEA8nB,EAAarzB,EAAMszB,0BAKnB,IAHA,IAAIC,GAAO,EACPC,GAAgB,GAEZD,IAASC,GAAe,CAC5B,IAAIj9B,EAAU,IAAIo4B,EAAQjqB,EAAK4J,GAgB/B,OAf2BtO,EAAMyzB,wBAG7BN,EAAcF,EAAW9jB,GAAG5Y,IAAYyJ,EAAM0O,UAAU7M,QAAQsN,GAAG5Y,GACnE68B,EAAaF,EAAe/jB,GAAG5Y,IAAYyJ,EAAM0O,UAAUnD,YAAY4D,GAAG5Y,GAEtE48B,IACAA,EAAcnqB,EAAQupB,iBAAmBjkB,GAAUvF,EAAKwpB,iBAAmB7tB,GAG3E0uB,IACAA,EAAapqB,EAAQwpB,gBAAkBlkB,GAAUvF,EAAKypB,gBAAkB9tB,IAIxEstB,GACJ,IAAK,OACEoB,GACCI,GAAgB,EAChBviC,EAAMyiC,oBACCR,EAAe/jB,GAAG5Y,IACzB88B,EAAarzB,EAAM2zB,uBACnBjvB,EAAMuuB,EAAWvuB,IACjB4J,EAAS2kB,EAAW5sB,OAEpBiI,EAAStF,EAAQinB,YAAYvC,KACfA,GAAcpf,EAAS4kB,EAAe7sB,OAChDiI,EAAS2kB,EAAW5sB,IAGhB3B,GAFJvG,EAAM4K,EAAKknB,YAAYvrB,KACZA,GAAOvG,EAAM+0B,EAAexuB,IAC7BuuB,EAAWvuB,IAEXvG,GAIlB,MACJ,IAAK,WACEg1B,GACCK,GAAgB,EAChBxiC,KAAKqP,OAAO7B,UAAUgO,MAAM4C,QAAQwkB,KAAK,6CAA6C1hC,QAAQ,UACvF+gC,EAAW9jB,GAAG5Y,IACrB88B,EAAarzB,EAAM6zB,2BACnBnvB,EAAMwuB,EAAexuB,IACrB4J,EAAS4kB,EAAe7sB,OAExBiI,EAAStF,EAAQ+mB,YAAYrC,KACfA,GAAcpf,EAAS2kB,EAAW5sB,OAC5CiI,EAAS4kB,EAAe7sB,IAGpB3B,GAFJvG,EAAM4K,EAAKgnB,YAAYrrB,KACZA,GAAOvG,EAAM80B,EAAWvuB,IACzBwuB,EAAexuB,IAEfvG,GAIlB,MACJ,IAAK,QACG+0B,EAAe/jB,GAAG5Y,IAClB88B,EAAarzB,EAAM2zB,uBACnBjvB,EAAMuuB,EAAWvuB,IACjB4J,EAAS2kB,EAAW5sB,OAEpB3B,EAAMqE,EAAKknB,YAAYxC,KACZA,GAAc/oB,EAAMwuB,EAAexuB,OAC1CA,EAAMuuB,EAAWvuB,IAGb4J,GAFJnQ,EAAM6K,EAAQinB,YAAY3hB,KACfA,GAAUnQ,EAAM+0B,EAAe7sB,IAC7B4sB,EAAW5sB,IAEXlI,GAIrB,MACJ,IAAK,QACG80B,EAAW9jB,GAAG5Y,IACd88B,EAAarzB,EAAM6zB,2BACnBnvB,EAAMwuB,EAAexuB,IACrB4J,EAAS4kB,EAAe7sB,OAExB3B,EAAMqE,EAAKgnB,YAAYtC,KACZA,GAAc/oB,EAAMuuB,EAAWvuB,OACtCA,EAAMwuB,EAAexuB,IAGjB4J,GAFJnQ,EAAM6K,EAAQ+mB,YAAYzhB,KACfA,GAAUnQ,EAAM80B,EAAW5sB,IACzB6sB,EAAe7sB,IAEflI,GAIrB,MACJ,QACI,MAAM,IAAIhC,MAAM,6BAA+B61B,GAGvDuB,GAAQviC,KAAK8iC,WAAWpvB,EAAK4J,GAE7Bof,EAAapf,EACbmf,EAAa/oB,CACjB,CAEG6uB,IACKvzB,EAAMyzB,sBACNzzB,EAAMhB,OAAO,IAAI2vB,EAAQjqB,EAAK4J,IAE9BtO,EAAMmI,WAAW,IAAIwmB,EAAQjqB,EAAK4J,IAG9C,EAEAylB,gBAAiB,SAASh0B,EAAKoxB,GAC3B,IAAInxB,EAAQhP,KAAKqP,OACbwuB,EAAO7uB,EAAM8uB,MAEjB,GAAa,aAATqC,EAAJ,CAIa,UAATA,EACApxB,EAAM8uB,EAAKnD,UAAU3rB,GAEP,QAAToxB,EACLpxB,EAAM8uB,EAAKyC,OAAOvxB,EAAI2E,KAAK6G,YACX,WAAT4lB,IACPpxB,EAAM8uB,EAAK0C,OAAOxxB,EAAIsG,KAAKkF,aAG/B,IAAIpD,EAAanI,EAAM+yB,qBAAqB9yB,aAE5CjP,KAAK6hC,4BAA4B,IAAI7nB,EAAS7C,EAAWtG,QAAS9B,GAZlE,MAFG/O,KAAKgjC,eAAej0B,EAe3B,EAEA+zB,WAAY,SAASpvB,EAAK2B,GACtB,GAAIrV,KAAKqP,OAAO4zB,YAAYvvB,IAAQ1T,KAAKqP,OAAO6zB,eAAe7tB,GAC3D,OAAO,EAEX,IAAItG,EAAM,IAAI4uB,EAAQjqB,EAAK2B,GACvBkY,GAAW,EAOf,OANAvtB,KAAKqP,OAAO8zB,mBAAkB,SAASC,GAC/BA,EAAOjR,WAAWpjB,KAASq0B,EAAOlH,WAAW/d,GAAGpP,KAChDwe,GAAW,EAEnB,IAEOA,CACX,EAEAyV,eAAgB,SAASj0B,GACrB,IAMIs0B,EAAMrC,EANNhyB,EAAQhP,KAAKqP,OACbsJ,EAAY3J,EAAMhB,SAClBsO,EAAStN,EAAMs0B,gBACf1mB,EAAO5c,KAAKs/B,mBAAmBpB,aAAavlB,EAAW5J,GAEvDw0B,EAAQvjC,KAAKujC,MAAM5qB,EAAWiE,GAGlC,IAAK2mB,EAAO,CACR,IAAIC,EAAUx0B,EAAMnB,MAAM+O,GAAMF,iBAAiB1N,EAAMnB,MAAMyO,IACzDknB,IACAxC,EAAYwC,EAAQxC,UACpBqC,EAAOG,EAAQH,KAEvB,CAEAr0B,EAAMy0B,eAAe7mB,EAAM2mB,EAAOF,EAAMrC,EAC5C,EAEAC,mBAAoB,SAASH,GACzB,IAAInoB,EAAY3Y,KAAKqP,OAAOq0B,wBACxBvsB,EAAanX,KAAKqP,OAAO8H,aAKzBwsB,EAAWxsB,EAAWtG,QAAQwE,KAAOsD,EAAU9H,QAAQwE,IACvDuuB,EAAYzsB,EAAWoD,YAAYlF,KAAOsD,EAAU4B,YAAYlF,IAChEwuB,EAAU1sB,EAAWtG,QAAQ6C,KAAOiF,EAAU9H,QAAQ6C,IACtDowB,EAAa3sB,EAAWoD,YAAY7G,KAAOiF,EAAU4B,YAAY7G,IAErE,OAAQotB,GACN,IAAK,OACHA,EAAS8C,EAAY,cAAgB,cACrC,MACF,IAAK,QACH9C,EAAS6C,EAAW,eAAiB,eACrC,MACF,IAAK,KACH7C,EAASgD,EAAa,YAAc,YACpC,MACF,IAAK,OACHhD,EAAS+C,EAAU,cAAgB,cACnC,MACF,IAAK,YACH/C,EAASgD,EAAa,iBAAmB,iBACzC,MACF,IAAK,YACHhD,EAAS+C,EAAU,mBAAqB,mBACxC,MACF,IAAK,YACH/C,EAAS8C,EAAY,mBAAqB,mBAC1C,MACF,IAAK,aACH9C,EAAS6C,EAAW,oBAAsB,oBAC1C,MACF,IAAK,UACH7C,EAASgD,EAAa,iBAAmB,iBACzC,MACF,IAAK,YACHhD,EAAS+C,EAAU,mBAAqB,mBAI5C,OAAO/C,CACX,EAEAe,4BAA6B,SAAS9yB,GAClC,IAAIC,EAAQhP,KAAKqP,OACjBL,EAAMhB,OAAOgB,EAAM+0B,iBAAiBzK,UAAUtqB,EAAMg1B,sBAAuBj1B,IAAM,EACrF,EAEAw0B,MAAO,SAAS5qB,EAAWsrB,GACvB,IAAIV,EACJ,GAAIU,EAAOpzB,QAAQsN,GAAGxF,EAAU9H,SAC5B,GAAIozB,EAAO1pB,YAAY7G,IAAMiF,EAAU4B,YAAY7G,IAAK,CACpD,IAAIkD,EAAY5W,KAAKy/B,QAAQT,UAAUiF,EAAO1pB,YAAY7G,KAE1D6vB,EAAQ,IAAIvpB,EACR,IAAI2jB,EAAQ/mB,EAAW+B,EAAU9H,QAAQwE,KACzCsD,EAAU4B,YAElB,MAAO,GAAI0pB,EAAO1pB,YAAYlF,IAAMsD,EAAU4B,YAAYlF,IAAK,CAC3D,IAAI6uB,EAAYlkC,KAAKu/B,QAAQP,UAAUiF,EAAO1pB,YAAYlF,KAE1DkuB,EAAQ,IAAIvpB,EACR,IAAI2jB,EAAQhlB,EAAU9H,QAAQ6C,IAAKwwB,GACnCvrB,EAAU4B,YAElB,CAGJ,OAAOgpB,CACX,IAGJ,SAAS7B,EAAiB1yB,EAAOqvB,EAAO8F,GAYpC,IAAIC,EAAWp1B,EAAMnB,MAAMwwB,GAAOn8B,QAClC,OAAO,SAAS4D,EAAKu+B,EAAUC,GAC3B,GAAIA,EAAU,OAAO,EACrB,IAAI7Z,GAAQ0Z,EACAn1B,EAAMnB,MAAMwwB,EAAM3qB,IAAK5N,GACvBkJ,EAAMnB,MAAM/H,EAAKu4B,EAAMhpB,MAAOnT,QAC1C,OAAiB,OAAbkiC,EACe,OAAR3Z,GAAuB3kB,EACtBu+B,GAAoB,OAAR5Z,EAIL,OAARA,GAHP2Z,EAAW,MACJ,EAIf,CACJ,CAEAnkC,EAAMsN,YAAY8xB,eAAiBA,CACtC,CAvqBD,CAuqBGp/B,OAEH,SAAUA,GAEN,IAAIskC,EAActkC,EAAM0B,MAAMvB,OAAO,CACjCC,KAAM,SAAS2O,GACXhP,KAAKqP,OAASL,CAClB,EAEAw1B,sBAAuB,SAAS51B,GAC5B,IAAII,EAAQhP,KAAKqP,OAEjBL,EAAMmG,OAAM,WACRnG,EAAMhB,SAASurB,oBAAmB,SAAS7uB,EAAOnH,GAC9CqL,EAASI,EAAOtE,EAAOnH,EAC3B,GACJ,GAAG,CAAEwM,QAAQ,EAAMkH,QAAQ,GAC/B,EAEAwtB,mBAAoB,SAAS71B,GACzB,IAAII,EAAQhP,KAAKqP,OAEjBL,EAAMmG,OAAM,WACRnG,EAAMhB,SAASyrB,iBAAgB,SAAS/uB,EAAOnH,GAC3CqL,EAASI,EAAOtE,EAAOnH,EAC3B,GACJ,GAAG,CAAEwM,QAAQ,EAAMkH,QAAQ,GAC/B,EAEAytB,sBAAuB,SAAS31B,GAC5B,OAAO/O,KAAKqP,OAAOyuB,MAAMpjB,SAASiqB,eAAe51B,EAAI8B,QAAQwE,IAAKtG,EAAIwL,YAAYlF,IACtF,EAEAuvB,mBAAoB,SAAS71B,GACzB,OAAO/O,KAAKqP,OAAOyuB,MAAMtjB,MAAMmqB,eAAe51B,EAAI8B,QAAQ6C,IAAK3E,EAAIwL,YAAY7G,IACnF,EAEAmxB,+BAAgC,WAC5B,OAAO7kC,KAAK0kC,sBAAsB1kC,KAAKqP,OAAOrB,SAClD,EAEA82B,4BAA6B,WACzB,OAAO9kC,KAAK4kC,mBAAmB5kC,KAAKqP,OAAOrB,SAC/C,EAEAiS,sBAAuB,WACnB,IAAI8kB,EAAU,GAAI9vB,EAAQ,EAiB1B,OAhBAjV,KAAKwkC,uBAAsB,SAASx1B,EAAOtE,GAEvC,GADAA,GAASuK,GACLjG,EAAMk0B,eAAex4B,GAAzB,CAGAuK,IACA,IAAIqK,EAAW,GACfylB,EAAQhW,QAAQ,CACZrkB,MAAWA,EACX4U,SAAWA,EACXnb,MAAW6K,EAAMmD,YAAYzH,KAEjCsE,EAAMg2B,sBAAsB1lB,GAAU,WAClCtQ,EAAM0R,aAAahW,EACvB,GAVA,CAWJ,IACOq6B,CACX,EAEAnlB,mBAAoB,WAChB,IAAImlB,EAAU,GAAI9vB,EAAQ,EAiB1B,OAhBAjV,KAAKykC,oBAAmB,SAASz1B,EAAOtE,GAEpC,GADAA,GAASuK,GACLjG,EAAMi0B,YAAYv4B,GAAtB,CAGAuK,IACA,IAAIqK,EAAW,GACfylB,EAAQhW,QAAQ,CACZrkB,MAAWA,EACX4U,SAAWA,EACXlb,OAAW4K,EAAMqD,UAAU3H,KAE/BsE,EAAMg2B,sBAAsB1lB,GAAU,WAClCtQ,EAAM8R,UAAUpW,EACpB,GAVA,CAWJ,IACOq6B,CACX,EAEAnmB,oBAAqB,WACjB5e,KAAKwkC,uBAAsB,SAASx1B,EAAOtE,GACvCsE,EAAMi2B,WAAWv6B,EACrB,IAMA,IALA,IAAIsE,EAAQhP,KAAKqP,OACbN,EAAMC,EAAMhB,SAASiB,aACrBwQ,EAAO1Q,EAAI8B,QAAQwE,IACnBsK,EAAQ5Q,EAAIwL,YAAYlF,IACxB2P,EAAM,OACG,CACT,IAAIkgB,EAAWvlB,EAAQ3Q,EAAM0L,SAASD,OAClC0qB,EAAU1lB,GAAQ,EACtB,IAAK0lB,IAAYD,EACb,MAEJ,GAAIA,IAAal2B,EAAMk0B,eAAevjB,GAAQ,CAC1CqF,EAAMrF,EACN,KACJ,CACA,GAAIwlB,IAAYn2B,EAAMk0B,eAAezjB,GAAO,CACxCuF,EAAMvF,EACN,KACJ,CACAA,IACAE,GACJ,CACY,OAARqF,IACAjW,EAAM,IAAI9O,EAAMsN,YAAYyM,SACxB,IAAI/Z,EAAMsN,YAAYowB,QAAQ,EAAG3Y,GACjC,IAAI/kB,EAAMsN,YAAYowB,QAAQ3uB,EAAMwL,MAAMC,OAAS,EAAGuK,IAE1DhW,EAAMnB,MAAMkB,GAAKf,SAEzB,EAEA2Q,iBAAkB,WACd3e,KAAKykC,oBAAmB,SAASz1B,EAAOtE,GACpCsE,EAAMo2B,QAAQ16B,EAClB,IAMA,IALA,IAAIsE,EAAQhP,KAAKqP,OACbN,EAAMC,EAAMhB,SAASiB,aACrB8Q,EAAMhR,EAAI8B,QAAQ6C,IAClBsM,EAASjR,EAAIwL,YAAY7G,IACzBsR,EAAM,OACG,CACT,IAAIqgB,EAAYrlB,EAAShR,EAAMwL,MAAMC,OACjC6qB,EAASvlB,GAAO,EACpB,IAAKulB,IAAWD,EACZ,MAEJ,GAAIA,IAAcr2B,EAAMi0B,YAAYjjB,GAAS,CACzCgF,EAAMhF,EACN,KACJ,CACA,GAAIslB,IAAWt2B,EAAMi0B,YAAYljB,GAAM,CACnCiF,EAAMjF,EACN,KACJ,CACAA,IACAC,GACJ,CACY,OAARgF,IACAjW,EAAM,IAAI9O,EAAMsN,YAAYyM,SACxB,IAAI/Z,EAAMsN,YAAYowB,QAAQ3Y,EAAK,GACnC,IAAI/kB,EAAMsN,YAAYowB,QAAQ3Y,EAAKhW,EAAM0L,SAASD,OAAS,IAE/DzL,EAAMnB,MAAMkB,GAAKf,SAEzB,EAEA+Q,sBAAuB,WACnB/e,KAAKwkC,uBAAsB,SAASx1B,EAAOtE,GACvCsE,EAAMu2B,aAAa76B,EACvB,GACJ,EAEAoU,mBAAoB,WAChB9e,KAAKykC,oBAAmB,SAASz1B,EAAOtE,GACpCsE,EAAMw2B,UAAU96B,EACpB,GACJ,EAEA8V,cAAe,WACX,IACIF,EADAtR,EAAQhP,KAAKqP,OACPgR,EAAQ,EAUlB,OATArR,EAAMmG,OAAM,WACRnG,EAAMhB,SAASurB,oBAAmB,SAAS7uB,GAClC4V,IACDA,EAAO5V,GAEXsE,EAAMkR,aAAaI,KACjBD,CACN,GACJ,GAAG,CAAEpJ,QAAQ,EAAMlH,QAAQ,IACpB,CAAEuQ,KAAMA,EAAMD,MAAOA,EAChC,EAEAI,eAAgB,WACZ,IACIH,EADAtR,EAAQhP,KAAKqP,OACPgR,EAAQ,EAUlB,OATArR,EAAMmG,OAAM,WACRnG,EAAMhB,SAASurB,oBAAmB,SAAS7uB,GACvC4V,EAAO5V,EAAQ,IACb2V,CACN,IACA,IAAK,IAAI9c,EAAI,EAAGA,EAAI8c,IAAS9c,EACzByL,EAAMkR,aAAaI,EAE3B,GAAG,CAAErJ,QAAQ,EAAMlH,QAAQ,IACpB,CAAEuQ,KAAMA,EAAMD,MAAOA,EAChC,EAEAO,YAAa,WACT,IACIN,EADAtR,EAAQhP,KAAKqP,OACPgR,EAAQ,EACdolB,EAAez2B,EAAMhB,SAYzB,OAVAgB,EAAMmG,OAAM,WACRswB,EAAahM,iBAAgB,SAAS/uB,GAC7B4V,IACDA,EAAO5V,GAEXsE,EAAM6Q,UAAUS,KACdD,CACN,GACJ,GAAG,CAAEpJ,QAAQ,EAAMlH,QAAQ,IAEpB,CAAEuQ,KAAMA,EAAMD,MAAOA,EAChC,EAEAQ,YAAa,WACT,IACIP,EADAtR,EAAQhP,KAAKqP,OACPgR,EAAQ,EAYlB,OAVArR,EAAMmG,OAAM,WACRnG,EAAMhB,SAASyrB,iBAAgB,SAAS/uB,GACpC4V,EAAO5V,EAAQ,IACb2V,CACN,IACA,IAAK,IAAI9c,EAAI,EAAGA,EAAI8c,IAAS9c,EACzByL,EAAM6Q,UAAUS,EAExB,GAAG,CAAErJ,QAAQ,EAAMlH,QAAQ,IAEpB,CAAEuQ,KAAMA,EAAMD,MAAOA,EAChC,IAGJpgB,EAAMsN,YAAYg3B,YAAcA,CACnC,CA1OD,CA0OGtkC,OAEH,SAAUA,GAEN,IAAIuB,EAAIvB,EAAMwF,OACVk4B,EAAU19B,EAAMsN,YAAYowB,QAE5B+H,EAAYzlC,EAAM0B,MAAMvB,OAAO,CAC/BC,KAAM,SAASoN,GACXzN,KAAKyY,SAAW,CAAC,EACjBzY,KAAK2lC,iBAAmB,CAAC,EACzB3lC,KAAK4lC,iBAAmB,CAAC,EACzB5lC,KAAKyN,SAAWA,EAChBzN,KAAKsc,OAASrc,EAAMsN,YAAY+vB,QAChCt9B,KAAK6lC,OAASjiC,SAASC,cAAc,UACrC7D,KAAK6lC,OAAOC,UAAY,gCACxB9lC,KAAK6lC,OAAOE,aAAa,QAAS,gCAClC/lC,KAAKiZ,aAAc,EACnBjZ,KAAKgmC,KAAO/lC,EAAMqnB,OAClB1jB,SAASoB,KAAKD,YAAY/E,KAAK6lC,OACnC,EAEA3iB,QAAS,WACL1hB,EAAExB,KAAK6lC,QAAQ7T,QACnB,EAEAlW,QAAS,WACL,IAAI/C,EAAS,CAAC+C,SAAS,GACnBnD,EAAY3Y,KAAKyN,SAASiL,cAAc1K,SAY5C,OAXI2K,IAAc1Y,EAAMsN,YAAY+vB,UAChCvkB,EAAO+C,SAAU,GAEjBnD,aAAqB1Y,EAAMsN,YAAYuL,WACvCC,EAAO+C,SAAU,EACjB/C,EAAOgD,gBAAiB,GAExB/b,KAAKiZ,cACLF,EAAO+C,SAAU,EACjB/C,EAAOE,aAAc,GAElBF,CACX,EAEAC,SAAU,WACN,IAAIhK,EAAQhP,KAAKyN,SAASiL,cACtB3J,EAAM/O,KAAK4Y,WAEXG,EAAS,CAAEC,UAAU,EAAME,eAAe,EAAOC,iBAAiB,GActE,OAfYnK,EAAMnB,MAAMkB,GAGbmE,WACP6F,EAAOC,UAAY,EACnBD,EAAOI,iBAAkB,GAExBpK,EAAIoP,GAAGnP,EAAM4wB,gBAAgB7wB,MAC9BgK,EAAOC,UAAW,EAClBD,EAAOG,eAAgB,GAEvBlZ,KAAKiZ,cACLF,EAAOC,UAAW,EAClBD,EAAOE,aAAc,GAElBF,CACX,EAEAktB,iBAAkB,WACd,IAAIj3B,EAAQhP,KAAKyN,SAASiL,cAC1B1Y,KAAKqY,QACLrY,KAAKsc,OAAStc,KAAKyY,SAASytB,QAC5B,IAAIn3B,EAAM/O,KAAK4Y,WACf,OAAQ7J,EAAIoP,GAAGnP,EAAM4wB,gBAAgB7wB,GACzC,EAEAkN,KAAM,WACF,IAAIjN,EAAQhP,KAAKyN,SAASiL,cAC1B1Y,KAAKsc,OAAStN,EAAMhB,SACpBhO,KAAK4lC,iBAAmB52B,EAAM2J,YAAYxK,kBACnCnO,KAAK2lC,iBAAiBxX,YACtBnuB,KAAK2lC,iBAAiBQ,KACjC,EAEAnqB,IAAK,WACD,IAAIhN,EAAQhP,KAAKyN,SAASiL,cAC1B1Y,KAAKic,OACLjN,EAAMnB,MAAMmB,EAAMhB,UAAUvN,OAChC,EAEAmY,SAAU,WACN,IAAI5J,EAAQhP,KAAKyN,SAASiL,cAK1B,GAAI1Y,KAAKsc,SAAWrc,EAAMsN,YAAY+vB,QAClC,OAAOtuB,EAAMhB,SAGjB,IAAIo4B,EAAcp3B,EAAMmI,aAAaub,QACjC2T,EAAmBrmC,KAAKsc,OAAOoW,QAC/B4T,EAAWD,EAAiB3yB,IAAM0yB,EAAY1yB,IAC9C6yB,EAAWF,EAAiBhxB,IAAM+wB,EAAY/wB,IAElD,OAAOrV,KAAKsc,OAAOgR,SAASgZ,EAAUC,EAAU,EACpD,EAEAhrB,MAAO,WACH,IAAIvM,EAAQhP,KAAKyN,SAASiL,cACtBE,EAAW5Y,KAAK4Y,YAChBA,EAAS2B,YAAY7G,KAAO1E,EAAMwL,MAAMC,QAAU7B,EAAS2B,YAAYlF,KAAOrG,EAAM0L,SAASD,SAC7FzL,EAAM2L,OACFlK,KAAKmK,IAAIhC,EAAS2B,YAAY7G,IAAM,EAAG1E,EAAMwL,MAAMC,QACnDhK,KAAKmK,IAAIhC,EAAS2B,YAAYlF,IAAM,EAAGrG,EAAM0L,SAASD,SAG9DzL,EAAMnB,MAAM+K,GAAU1K,SAASlO,KAAKyY,SAAUzY,MAC9CgP,EAAMc,cAAc,CAAEmH,QAAQ,EAAMlI,IAAK6J,GAC7C,EAEA4tB,SAAU,SAASh8B,GACf,IAAIA,IAASA,EAAK2jB,OAAQ3jB,EAAK27B,MAG3B,OAAOnmC,KAAK2lC,iBAFZ3lC,KAAK2lC,iBAAmBn7B,CAIhC,EAEAi8B,WAAY,WACR,OAAQzmC,KAAK0mC,aACjB,EAEAruB,MAAO,WACH,IAAIjK,EAEJ,GAAIpO,KAAK0mC,cACLt4B,EAAQpO,KAAK4lC,qBACV,CACH,IAAIp7B,EAAOxK,KAAK2lC,iBAEhB,GADAv3B,EAAQ5D,EAAK27B,MA8OzB,SAAkB37B,GACd,IAAI4D,EAAQu4B,IACZ,IAA4B,IAAxBn8B,EAAK+G,QAAQ,QAAuC,GAAvB/G,EAAK+G,QAAQ,MAC1Cq1B,EAAax4B,EAAO,EAAG,EAAG,CAAElM,MAAOsI,SAGnC,IADA,IAAIuN,EAAOvN,EAAKvE,MAAM,MACb4gC,EAAK,EAAGA,EAAK9uB,EAAK1W,OAAQwlC,IAE/B,IADA,IAAI5sB,EAAOlC,EAAK8uB,GAAI5gC,MAAM,MACjB6gC,EAAK,EAAGA,EAAK7sB,EAAK5Y,OAAQylC,IAC/BF,EAAax4B,EAAOy4B,EAAIC,EAAI,CAAE5kC,MAAO+X,EAAK6sB,KAItD,OAAO14B,CACX,CA5PiC24B,CAASv8B,EAAK27B,OAASQ,IACxCn8B,EAAK2jB,KAAM,CACX,IAAI6Y,EAAMhnC,KAAK6lC,OAAOoB,cAAcrjC,SACpCojC,EAAI5d,OACJ4d,EAAIE,MAAM18B,EAAK2jB,MACf6Y,EAAIhe,QACJ,IAAIme,EAAQH,EAAII,cAAc,SAC9B,GAAID,EAAO,CACP,IAAIE,EAkLxB,SAAmBF,GAIf,IAHA,IAAI/4B,EAAQu4B,IAERpE,EAAO,GAAI7uB,EAAM,EAAG2B,EAAM,EACrB9R,EAAI,EAAGA,EAAI4jC,EAAMpvB,KAAK1W,SAAUkC,EACrCg/B,EAAK5hC,KAAK,IAKd,IAHA,IAAIo2B,EAAW,IAAI92B,EAAMsN,YAAYkH,KAAKuS,QAAQsgB,OAC9CC,EAAW,IAAItnC,EAAMsN,YAAYkH,KAAKuS,QAAQsgB,OAEzCT,EAAK,EAAGA,EAAKM,EAAMpvB,KAAK1W,SAAUwlC,IAAMnzB,EAAK,CAClD,IAAIupB,EAAKkK,EAAMpvB,KAAK8uB,GACpBxxB,EAAM,EACN,IAAK,IAAIyxB,EAAK,EAAGA,EAAK7J,EAAG5lB,MAAMhW,SAAUylC,EAAI,CAIzC,IAHA,IAAIU,EAAKvK,EAAG5lB,MAAMyvB,GACdW,EAAUD,EAAGC,QACbC,EAAUF,EAAGE,QACVnF,EAAK7uB,GAAK2B,IACbA,IAOJ,IAAIvR,EAAQ0jC,EAAGG,aAAa,SACxBC,EAAgB,qBAAqB3/B,KAAKnE,GAE9C8iC,EAAax4B,EAAOsF,EAAK2B,EAAKwyB,EAAUn0B,EAAK2B,EAAKmyB,EAAIzQ,EAAUwQ,KAC5DE,EAAU,GAAMC,EAAU,IAAME,IAChCx5B,EAAM05B,YAAYnnC,KACd,IAAIV,EAAMsN,YAAYyM,SAClB,IAAI2jB,EAAQjqB,EAAK2B,GACjB,IAAIsoB,EAAQjqB,EAAM+zB,EAAU,EAAGpyB,EAAMqyB,EAAU,IACjDtP,YAEV,IAAK,IAAI2P,EAAKr0B,EAAM+zB,IAAWM,GAAMr0B,GACjC,IAAK,IAAIs0B,EAAK3yB,EAAMqyB,IAAWM,GAAM3yB,GAC7B0yB,EAAKxF,EAAKlhC,SACVkhC,EAAKwF,GAAIC,IAAM,EACTD,GAAMr0B,GAAOs0B,GAAM3yB,GACrBuxB,EAAax4B,EAAO25B,EAAIC,EAAI,CAAC,GAKjD,CACJ,CAEA,OAAO55B,CACX,CApOoC65B,CAAUd,GAK1BE,EAAU78B,KAAKsE,SAAQ,SAASo5B,EAAS9sB,GACrC8sB,EAAQp5B,SAAQ,SAASq5B,EAAS5Q,GAC1B,aAAatvB,KAAKkgC,EAAQjmC,SAC1BimC,EAAQjmC,MAAQkM,EAAM5D,KAAK4Q,GAAUmc,GAAUr1B,MAEvD,GACJ,IACAkM,EAAQi5B,CACZ,CACJ,CACArnC,KAAKsc,OAASlO,EAAM83B,OACxB,CAEAlmC,KAAKyY,SAAWrK,CACpB,EAEAs4B,YAAa,WACT,QAAmC55B,IAA/B9M,KAAK2lC,iBAAiBxX,KACtB,OAAO,EAEX,IAAIia,IAAe5mC,EAAE,UAAU2sB,KAAKnuB,KAAK2lC,iBAAiBxX,MAAMyU,KAAK,yBAA0B5iC,KAAKgmC,MAAM3kC,OACtGgnC,IAAgB7mC,EAAE,UAAU2sB,KAAKnuB,KAAK2lC,iBAAiBQ,OAAOvD,KAAK,yBAA0B5iC,KAAKgmC,MAAM3kC,OAC5G,OAAQ+mC,GAAgBC,CAC5B,IAIJ,SAAS1B,IACL,IAAI53B,EAAM,IAAI4uB,EAAQ,EAAG,EAAG,GAC5B,MAAO,CACH5uB,IAAcA,EACd+4B,YAAc,GACdt9B,KAAc,GACd89B,SAAc,EACdpC,QAAcn3B,EAAIE,aAE1B,CAEA,SAAS23B,EAAax4B,EAAOsF,EAAK2B,EAAKnT,GACnC,IAAIsI,EAAO4D,EAAM5D,OAAS4D,EAAM5D,KAAO,IAClCA,EAAKkJ,KACNlJ,EAAKkJ,GAAO,IAEhBlJ,EAAKkJ,GAAK2B,GAAOnT,EACjB,IAAIs4B,EAAKpsB,EAAM83B,QAAQ3rB,YACvBigB,EAAG9mB,IAAMjD,KAAKmK,IAAI4f,EAAG9mB,IAAKA,GAC1B8mB,EAAGnlB,IAAM5E,KAAKmK,IAAI4f,EAAGnlB,IAAKA,EAC9B,CAEA,SAASkzB,EAAWzkC,GAChB,OAAOA,EAAMhB,QAAQ,uBAAwB,GACjD,CA8BA,SAAS+kC,EAAUn0B,EAAK2B,EAAK+I,EAAS2Y,EAAUwQ,GAC5C,IACIrlC,EAAOoT,EAAQ2gB,EADf5S,EAAS5hB,OAAO+mC,iBAAiBpqB,IAIhClc,EAAQkc,EAAQupB,aAAa,wBAE9BzlC,GADAA,EAAQuyB,KAAKpc,MAAMnW,IACLA,EAAM,MAEnBoT,EAAS8I,EAAQupB,aAAa,+BAE/BryB,GADAA,EAASmf,KAAKpc,MAAM/C,IACJA,EAAO,KAE3B2gB,EAAU7X,EAAQupB,aAAa,uBAGlB,MAATzlC,GAA2B,MAAVoT,GAA6B,MAAX2gB,IACnC/zB,EAAQkc,EAAQupB,aAAa,UAC7BryB,EAAS8I,EAAQupB,aAAa,YAI1BryB,EAASA,EAAOxS,QAAQ,gBAAiB,MAUpC,MAATZ,IACAA,EAAQkc,EAAQiQ,UAAUvrB,QAAQ,MAAO,KAG7C,IAAI2lC,EAhER,SAAsBrqB,EAASiF,GAItBjF,EAAQ0nB,YACTziB,EAASjF,EAAQta,OAErB,IAAIqE,EAAM,CAAC,EAkBX,MAjBA,CACI,eACA,cACA,aACA,aACF2G,SAAQ,SAAS7M,GACf,IAAIkC,EAAQkf,EAAOphB,EAAM,SACrBkC,IACAA,EAAQyI,SAASzI,EAAO,KAExBA,IACAgE,EAAIlG,GAAO,CACPL,KAAMuC,EACNyR,MAAOyN,EAAOphB,EAAM,UAAY,QAG5C,IACOkG,CACX,CAsCkBugC,CAAatqB,EAASiF,GAChCjV,EAAQ,CACRlM,MAAiB,KAAVA,EAAe,KAAOA,EAC7B+zB,QAASA,EAETvf,UAAe+xB,EAAQ/xB,WAAgBqgB,EAASt0B,IAAIiR,EAAK2B,IAAY,KACrEwB,aAAe4xB,EAAQ5xB,cAAgBkgB,EAASt0B,IAAIiR,EAAM,EAAG2B,IAAQ,KACrEe,WAAeqyB,EAAQryB,YAAgBmxB,EAAS9kC,IAAIiR,EAAK2B,IAAY,KACrEkB,YAAekyB,EAAQlyB,aAAgBgxB,EAAS9kC,IAAIiR,EAAK2B,EAAM,IAAM,KAErEszB,SAAW/7B,SAASyW,EAAiB,SAAG,KAG9B,MAAV/N,IACAlH,EAAMkH,OAASA,GAGnByhB,EAASzC,IAAI5gB,EAAK2B,EAAKjH,EAAMsI,WAC7BqgB,EAASzC,IAAI5gB,EAAM,EAAG2B,EAAKjH,EAAMyI,cACjC0wB,EAASjT,IAAI5gB,EAAK2B,EAAKjH,EAAMgI,YAC7BmxB,EAASjT,IAAI5gB,EAAK2B,EAAM,EAAGjH,EAAMmI,aAEC,iBAA9B8M,EAAwB,iBAAsD,qBAA9BA,EAAwB,kBACxEjV,EAAMw6B,WAAavlB,EAAwB,iBAEP,UAApCklB,EAAWllB,EAAkB,aAC7BjV,EAAMy6B,UAAYN,EAAWllB,EAAkB,YAEnB,WAA5BA,EAAsB,gBACtBjV,EAAM06B,cAAgBzlB,EAAsB,eAErB,WAAvBA,EAAiB,WACjBjV,EAAMmG,MAAO,GAGjB,IAAIw0B,EAAU3qB,EAAQgpB,cAAc,QAkBpC,OAjBI2B,IACA1lB,EAAS5hB,OAAO+mC,iBAAiBO,IAGhB,iBAAjB1lB,EAAOzN,OAA6C,qBAAjByN,EAAOzN,QAC1CxH,EAAMwH,MAAQyN,EAAOzN,OAErB,aAAa3N,KAAKob,EAAuB,kBACzCjV,EAAMuE,WAAY,GAEK,UAAvB0Q,EAAkB,YAClBjV,EAAM46B,QAAS,GAEf,qBAAqB/gC,KAAKob,EAAmB,cAC7CjV,EAAM66B,MAAO,GAGV76B,CACX,CAlJAnO,EAAMsN,YAAYm4B,UAAYA,CAwNjC,CApYD,CAoYGzlC,OAEH,SAAUA,GAEN,IAAIuB,EAAIvB,EAAMwF,OAEVqT,EAAW7Y,EAAMsN,YAAYuL,SAC7B6kB,EAAU19B,EAAMsN,YAAYowB,QAC5B3jB,EAAW/Z,EAAMsN,YAAYyM,SAE7BkvB,EAAa,CACb,QAAS,aAAc,YACvB,SAAU,OAAQ,YAAa,SAC/B,gBAAiB,aAAc,SAAU,OAAQ,SACjD,YAAa,cAAe,eAAgB,aAC5C,UAAW,QAGXpsB,EAAQ7c,EAAM0B,MAAMvB,OAAO,CAC3BC,KAAM,SAAS0O,EAAKC,GAChBhP,KAAKqP,OAASL,EACdhP,KAAK6O,KAAOE,CAChB,EAEAU,MAAO,WACH,OAAO,IAAIqN,EAAM9c,KAAK6O,KAAKY,QAASzP,KAAKqP,OAC7C,EAEA4D,gBAAiB,WACb,IAAIO,EAAO,GACP3T,EAAOG,KAAMgP,EAAQnP,EAAKwP,OAC1B85B,EAAiBn6B,EAAMi0B,YAAY/zB,KAAKF,GACxCo6B,EAAiBp6B,EAAMk0B,eAAeh0B,KAAKF,GAe/C,OAdAnP,EAAKgP,KAAKC,SAAQ,SAASC,GAKvB,IAHA,IAAIwrB,GADJxrB,EAAMlP,EAAKwpC,WAAWt6B,EAAIE,eACb4B,QAAS2pB,EAAKzrB,EAAIwL,YAC3BxC,EAAOuxB,EAAU/O,EAAG7mB,IAAK8mB,EAAG9mB,IAAKy1B,GACjClvB,EAAOqvB,EAAU/O,EAAGllB,IAAKmlB,EAAGnlB,IAAK+zB,GAC5B7lC,EAAI,EAAGA,EAAIwU,EAAK1W,SAAUkC,EAC/B,IAAK,IAAIsH,EAAI,EAAGA,EAAIoP,EAAK5Y,SAAUwJ,EAC/B2I,EAAK7S,KAAK,IAAIqZ,EACV,IAAI2jB,EAAQ5lB,EAAKxU,GAAGgiB,MAAOtL,EAAKpP,GAAG0a,OACnC,IAAIoY,EAAQ5lB,EAAKxU,GAAGiiB,IAAKvL,EAAKpP,GAAG2a,MAIjD,IACOxW,EAAMnB,MAAM2F,EAAKnS,OAAS,EAAI,IAAIyX,EAAStF,GAAQA,EAAK,GACnE,EAEA61B,WAAY,SAASt6B,GACjB,OAAO/O,KAAKqP,OAAOyuB,MAAMpD,UAAU3rB,EACvC,EAEAw6B,KAAM,SAASr9B,EAAMhK,EAAOsnC,GACxB,IAAI3pC,EAAOG,KACPgP,EAAQnP,EAAKwP,OA2BjB,OA1BAxP,EAAKgP,KAAKC,SAAQ,SAASC,GACvB,IAAIhJ,EAASgJ,EAIb,IAHyB,UAAT7C,GAA6B,YAATA,GAA+B,SAATA,IAG1C6C,EAAI8B,QAAS,CACzB,IAAI44B,EAAa,IAAI9L,EAAQ5uB,EAAI8B,QAAQ6C,IAAK3E,EAAI8B,QAAQwE,KAE1DrG,EAAMm0B,mBAAkB,SAAS57B,GAC1BA,EAAE4qB,WAAWsX,KACZ1jC,EAAS0jC,EAEjB,GACJ,CAEAz6B,EAAMu6B,KAAKxjC,EAAOkJ,aAAc/C,EAAMhK,EAC1C,IACKsnC,GACDx6B,EAAMc,cAAc,CAChBmH,OAAkB,WAAR/K,GAA6B,SAARA,GAA2B,cAARA,EAClDhK,MAAUA,EACV2L,MAAUhO,EACVkP,IAAUlP,EAAKgP,KACf0Q,QAAkB,SAARrT,IAGXrM,CACX,EAEA6pC,KAAM,SAASx9B,GACX,OAAOlM,KAAKqP,OAAOq6B,KAAK1pC,KAAK6O,KAAKI,aAAc/C,EACpD,EAEAwB,UAAW,SAASxB,EAAMhK,GACtB,YAAc4K,IAAV5K,EACOlC,KAAK0pC,KAAKx9B,GAEVlM,KAAKupC,KAAKr9B,EAAMhK,EAE/B,EAEAA,MAAO,SAASA,GAOZ,YANc4K,IAAV5K,GAIAlC,KAAKupC,KAAK,UAAW,MAAM,GAExBvpC,KAAK0N,UAAU,QAASxL,EACnC,EAEAisB,KAAM,SAASjsB,GACX,OAAOlC,KAAK0N,UAAU,OAAQxL,EAClC,EAEAyY,OAAQ,SAASqmB,GACb,IAAIjyB,EAAM/O,KAAK2pC,YAAY3I,GAC3B,OAAO,IAAIlkB,EAAM/N,EAAK/O,KAAKqP,OAC/B,EAEAs6B,YAAa,SAAS3I,GAClB,OAAOhhC,KAAK6O,KAAK1M,KAAI,SAAS4M,GAC1B,OAAOA,EAAIE,aAAa0L,OAAOqmB,EACnC,GACJ,EAEA1sB,MAAO,SAASpS,EAAO5B,GACnBA,EAAUkB,EAAEpB,OAAO,CACf6T,cAAc,GACf3T,GACH,IAA0CmG,EAAtCmjC,EAAiB5pC,KAAK0pC,KAAK,UAC/B,QAAc58B,IAAV5K,EAAqB,CACrB,IAAIq4B,EAAKv6B,KAAK6O,KAAKI,aAAa4B,QAuChC,OAtCApK,EAAIxG,EAAMsN,YAAYkH,KAAK4D,MAAMrY,KAAKqP,OAAOnD,OAAQquB,EAAG7mB,IAAK6mB,EAAGllB,IAAKnT,EAAO0nC,GAC5E5pC,KAAKqP,OAAO8F,MAAM,WACd,IAAI8gB,EAAU,KACd,GAAc,OAAVxvB,EAAEiI,KACFunB,EAAUh2B,EAAMsN,YAAYkH,KAAKo1B,QAAQpjC,QACtC,GAAsB,KAAlBmjC,EAAuB,CAC9B,IAAIE,EAAqBF,GACrB3pC,EAAMsN,YAAY2H,WAAWxG,KAAKjI,EAAEvE,MAAO0nC,GACjC,QAAVnjC,EAAEiI,MAAwC,QAAtBo7B,EACpB9pC,KAAKsV,OAAO7O,EAAE6O,QAAwBrV,EAAM60B,UAAUC,SAASC,SAASpuB,EAyzB9E9D,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KAAKA,QAAQ,KAAM,UAxzB7B,WAAV2D,EAAEiI,MAA2C,WAAtBo7B,EAC9B9pC,KAAKsV,OAAe,IAAR7O,EAAEvE,QAAsB,IAARuE,EAAEvE,MAAU,GAAK,KAAO,SAC7CuE,EAAE6O,UACJs0B,GAAkBnjC,EAAEsjC,UACE,UAAtBD,GAA4C,UAAVrjC,EAAEiI,MACpCjI,EAAE6O,OAAOjU,OAASuoC,EAAevoC,SAClCrB,KAAKsV,OAAO7O,EAAE6O,OAG1B,KAAqB,UAAV7O,EAAEiI,OACTjI,EAAEvE,MAAQA,GAEdlC,KAAKi2B,QAAQA,EAAS31B,EAAQ2T,cACzBgiB,GAKDj2B,KAAKkC,MAAMuE,EAAEvE,MAErB,EAAEgN,KAAKlP,MAAO,CACViX,QAAe,EACf/U,MAAeA,EACf6M,IAAe/O,KAAK6O,KACpBm7B,aAAehqC,KAAKqP,OAAO46B,eAC3B1qB,SAAe,IAGZvf,IACX,CACIkC,EAAQlC,KAAK0pC,KAAK,SAClB,IA4xBcrmC,EA5xBV4yB,EAAUj2B,KAAK0pC,KAAK,WACpBh7B,EAAOk7B,IAAmB3T,GAAWh2B,EAAMsN,YAAY2H,WAAWxG,KAAKxM,EAAO0nC,GAElF,GAAI3T,EAGA/zB,EAAQ,IAAM+zB,OACXiU,EAAK,CACR,GAAIN,GAA0B,QAARl7B,EAAgB,CAGlC,IAAIy7B,EAAKlqC,EAAMsN,YAAY2H,WAAWtS,KAAKV,EAAO0nC,GAGlD,GAFAnjC,EAAIxG,EAAMsN,YAAYkH,KAAK4D,MAAM,KAAM,KAAM,KAAM8xB,EAAIP,GAEnDO,GADKlqC,EAAMsN,YAAY2H,WAAWtS,KAAK6D,EAAEvE,MAAO0nC,GACtC,CACV1nC,EAAQioC,EACR,MAAMD,CACV,CACJ,CACa,SAATx7B,EACAxM,EAAQjC,EAAMm4B,SAASn4B,EAAMsN,YAAY68B,aAAaloC,GAAQjC,EAAM60B,UAAUC,SAASC,SAASpuB,GAChF,YAAT8H,EACPxM,EAAQjC,EAAMsN,YAAYkH,KAAKuS,QAAQiO,eAAuB,IAAR/yB,GAAe,IAC9C,iBAATA,IACN,QAAQ+F,KAAK/F,IACb,oBAAsB+F,KAAK/F,KAqwB1C,KAAK+F,KAFQ5E,EAlwBmBnB,IAowBb,iBAAmB+F,KAAKhI,EAAMsN,YAAYkH,KAAK4D,MAAM,KAAM,EAAG,EAAGhV,GAAKqL,OAnwBlFxM,EAAQ,IAAMA,EACPlC,KAAKqP,OAAOg7B,uBACI,iBAATnoC,GACPA,GAASuO,KAAKgnB,MAAMv1B,KAC3BA,EAAQW,OAAOX,GAAOY,QAAQ,IAAK7C,EAAM60B,UAAUwV,aAAa,MAExE,CAEA,OAAOpoC,CAEf,EAEAgR,OAAQ,SAAShR,GACb,YAAc4K,IAAV5K,GACQjC,EAAMsB,KAAK2G,UAAS,SAAS6C,GACjC/K,KAAKqP,OAAOP,QAAQ9O,KAAK6O,MAAM,SAAS07B,EAAGC,EAAIhgC,IACvB,IAAhBA,EAAK0I,QACLnI,GAAK,EAEb,GACJ,GAAG/K,MAGAA,KAAK0N,UAAU,SAAUxL,EACpC,EAEA+zB,QAAS,SAAS/zB,EAAO+R,GACrB,IAAIpU,EAAOG,KACX,QAAc8M,IAAV5K,EAAqB,CACrB,IAAIqF,EAAI1H,EAAK6pC,KAAK,WAClB,OAAOniC,EAAI,GAAKA,EAAI,IACxB,CACA,GAAI0M,EAAc,CAId,IAAIlF,EAAM/O,KAAK6O,KAAKI,cACpB/M,EAAQrC,EAAKwP,OAAOxB,MAAMkB,EAAI8B,SACzB04B,KAAK,UAAWrnC,GAChBwnC,KAAK,aAKNxnC,EAAMuoC,qBAAqB17B,EAEnC,MACIlP,EAAK0pC,KAAK,UAAWrnC,GAEzB,OAAOrC,CACX,EAEA4c,yBAA0B,WACtB,IAAI1N,EAAM/O,KAAK6O,KAAKY,QAAQ4d,WAAWG,SAASxtB,KAAKqP,OAAOnD,QAC5D,OAAOjM,EAAMsB,KAAK2G,UAAS,SAAS6C,GAChC/K,KAAKqP,OAAOq7B,cAAa,SAASnjC,GAC9B,IAAIlB,EAAIkB,EAAEojC,kBACNtkC,IAAMA,EAAI0I,EAAIspB,UAAUhyB,MAAQpG,EAAMsN,YAAY+vB,SAClDvyB,EAAK,CAAEkrB,QAAS1uB,EAAGqjC,aAAcvkC,GAEzC,GACJ,GAAGrG,KACP,EAEAuT,oBAAqB,WACjB,IAAI9M,EAAIzG,KAAKyc,2BACb,OAAIhW,GAIOA,EAAEwvB,QAAQ0U,kBAAkBxsB,GAAG1X,EAAEmkC,aAGhD,EAEA5pB,WAAY,SAAS9e,GAGjB,QAAc4K,IAAV5K,EAAqB,CACrB,IAAIqF,EAAIvH,KAAK0pC,KAAK,cAElB,OAAOniC,EAAIA,EAAEssB,SAAW,IAC5B,CACA,OAAO7zB,KAAK0N,UAAU,aAAcxL,EACxC,EAEA2R,oBAAqB,WACjB,IAKIizB,EAAID,EALJ93B,EAAM/O,KAAK6O,KAAKI,aAChBwtB,EAAa1tB,EAAI8B,QAAQ6C,IACzBgpB,EAAa3tB,EAAI8B,QAAQwE,IACzBsnB,EAAiB5tB,EAAIwL,YAAY7G,IACjCkpB,EAAiB7tB,EAAIwL,YAAYlF,IAGrC,IAAKyxB,EAAKpK,EAAYoK,GAAMlK,EAAgBkK,IACxC,IAAKD,EAAKpK,EAAYoK,GAAMlK,EAAgBkK,IAAO,CAC/C,IAAI7lB,EAAahhB,KAAKqP,OAAOw7B,YAAYhE,EAAIC,GAE7C,GAAI9lB,GAAkC,WAApBA,EAAWtS,OAA0C,IAArBsS,EAAW9e,MACzD,OAAO8e,CAEf,CAGJ,OAAO,CACX,EAEA1J,MAAO,WAEH,OADAtX,KAAK6O,KAAO7O,KAAKqP,OAAOy7B,OAAO9qC,KAAK6O,MAC7B7O,IACX,EAEAoX,QAAS,WACL,IAAI0wB,EAAc9nC,KAAKqP,OAAO2wB,aAU9B,OARAhgC,KAAK6O,KAAKC,SAAQ,SAASC,GACvBA,EAAIE,aAAasjB,aAAauV,GAAah5B,SAAQ,SAASi8B,GACxDjD,EAAYt2B,OAAOs2B,EAAYv2B,QAAQw5B,GAAY,EACvD,GACJ,IAEA/qC,KAAKqP,OAAOS,cAAc,CAAC,GAEpB9P,IACX,EAEAgO,OAAQ,WAGJ,OAFAhO,KAAKqP,OAAOrB,OAAOhO,KAAK6O,MAEjB7O,IACX,EAEAmH,OAAQ,SAASA,GACb,GAAInH,KAAK6O,gBAAgBiK,EACrB,MAAM,IAAI3N,MAAM,oCAGpB,GAAInL,KAAK6O,OAAS5O,EAAMsN,YAAY+vB,QAAS,CACzC,QAAexwB,IAAX3F,EACA,MAAM,IAAIgE,MAAM,4BAEhB,MAAO,EAEf,CAEA,IAKI27B,EAAID,EALJ93B,EAAM/O,KAAK6O,KAAKI,aAChBwtB,EAAa1tB,EAAI8B,QAAQ6C,IACzBgpB,EAAa3tB,EAAI8B,QAAQwE,IACzBsnB,EAAiB5tB,EAAIwL,YAAY7G,IACjCkpB,EAAiB7tB,EAAIwL,YAAYlF,IAGrC,QAAevI,IAAX3F,EAAsB,CACtBA,EAAS,IAAI2zB,MAAM/rB,EAAI3K,UAEvB,IAAK,IAAI4mC,EAAK,EAAGA,EAAK7jC,EAAO9F,OAAQ2pC,IACjC7jC,EAAO6jC,GAAM,IAAIlQ,MAAM/rB,EAAI5K,SAG/B,IAAK2iC,EAAKpK,EAAYoK,GAAMlK,EAAgBkK,IACxC,IAAKD,EAAKpK,EAAYoK,GAAMlK,EAAgBkK,IACxC1/B,EAAO0/B,EAAKpK,GAAYqK,EAAKpK,GAAc18B,KAAKqP,OAAO4C,OAAO40B,EAAIC,GAI1E,OAAO3/B,CACX,CAGI,IAFAnH,KAAKqP,OAAOk6B,KAAKx6B,EAAK,UAAW,MAE5B+3B,EAAKpK,EAAYoK,GAAMlK,EAAgBkK,IACxC,IAAKD,EAAKpK,EAAYoK,GAAMlK,EAAgBkK,IAAO,CAC/C,IAAInzB,EAAMvM,EAAO0/B,EAAKpK,GAEtB,GAAI/oB,EAAK,CACL,IAAIxR,EAAQwR,EAAIozB,EAAKpK,QAEP5vB,IAAV5K,GACAlC,KAAKqP,OAAO4C,OAAO40B,EAAIC,EAAI5kC,EAEnC,CACJ,CAKJ,OAFAlC,KAAKqP,OAAOS,cAAc,CAAEmH,QAAQ,EAAMlI,IAAKA,IAExC/O,IAEf,EAEA6c,YAAa,SAASF,EAAOsuB,GACzB,GAAIjrC,KAAK6O,gBAAgBiK,EACrB,MAAM,IAAI3N,MAAM,oCAGpB,GAAInL,KAAK6O,OAAS5O,EAAMsN,YAAY+vB,QAAS,CACzC,QAAcxwB,IAAV6P,EACA,MAAM,IAAIxR,MAAM,4BAEhB,MAAO,EAEf,CAEA,IAKI27B,EAAID,EAcAr8B,EAnBJuE,EAAM/O,KAAK6O,KAAKI,aAChBwtB,EAAa1tB,EAAI8B,QAAQ6C,IACzBgpB,EAAa3tB,EAAI8B,QAAQwE,IACzBsnB,EAAiB5tB,EAAIwL,YAAY7G,IACjCkpB,EAAiB7tB,EAAIwL,YAAYlF,IAEjCrG,EAAQhP,KAAKqP,OAEjB,QAAcvC,IAAV6P,EAQA,OAPAA,EAAQ,IAAIme,MAAM/rB,EAAI3K,UACtB4K,EAAMF,QAAQC,GAAK,SAAS2E,EAAK2B,EAAK7K,GAElC6K,GAAOqnB,GACI/f,EAFXjJ,GAAO+oB,KAEmB9f,EAAMjJ,GAAO,KAClC2B,GAAO7K,CAChB,IACOmS,EAIP5N,EAAMA,EAAIU,QACV,IAAIy7B,EAAU,SAASC,GACnB,IAAIC,EAAY5gC,EAAK2gC,GACrBp8B,EAAI8B,QAAQ6C,IAAM3E,EAAIwL,YAAY7G,IAAMmzB,EACxC93B,EAAI8B,QAAQwE,IAAMtG,EAAIwL,YAAYlF,IAAMyxB,EAExB,SAAZqE,GACAn8B,EAAMu6B,KAAKx6B,EAAK,UAAW,MAG/BC,EAAMu6B,KAAKx6B,EAAKo8B,EAAUC,EAC9B,EAEI7rB,GAAU,EACd,IAAKunB,EAAKpK,EAAYoK,GAAMlK,EAAgBkK,IACxC,GAAKmE,IAAcj8B,EAAMk0B,eAAe4D,GAGxC,IAAKD,EAAKpK,EAAYoK,GAAMlK,EAAgBkK,IACxC,IAAKoE,IAAcj8B,EAAMi0B,YAAY4D,OAGjCoE,IAAcj8B,EAAMq8B,cAAcxE,IAAtC,CAGA,IAAInzB,EAAMiJ,EAAMkqB,EAAKpK,GACrB,GAAI/oB,IACAlJ,EAAOkJ,EAAIozB,EAAKpK,IACN,CACN,IAAItZ,EAAO3b,OAAO2b,KAAK5Y,GACvB4Y,EAAKtU,QAAQo8B,GACb3rB,EAAUA,GAAW6D,EAAKkoB,SAAS,QACvC,CARJ,CAaR,OADAt8B,EAAMc,cAAc,CAAEmH,QAAQ,EAAMlI,IAAK/O,KAAK6O,KAAM0Q,QAASA,IACtDvf,IAEf,EAEAS,MAAO,SAASH,GAEZ,IAAIirC,GADJjrC,EAAUA,GAAW,CAAC,GACCirC,WAAa9jC,OAAO2b,KAAK9iB,GAASe,OAErD2N,EAAQhP,KAAKqP,OAEbZ,EAAS,CACTwI,OAAQs0B,GAAYjrC,EAAQkrC,aAC5Bz8B,IAAK/O,KAAK6O,KACV0Q,SAAS,GA0Bb,OAvBAvQ,EAAMmG,MAAM,WAEJ1G,EAAOwI,QACPjX,KAAKi2B,QAAQ,MAGbsV,GACAvrC,KAAKghB,WAAW,OAGhBuqB,GAAYjrC,EAAQmrC,cACpBvC,EAAWp6B,QAAQ,SAASrI,GAClBnG,EAAQorC,aAAe,WAAWzjC,KAAKxB,IACzCzG,KAAKyG,GAAG,KAEhB,EAAEyI,KAAKlP,OACPA,KAAK2oC,SAAS,MACd3oC,KAAKuU,KAAK,MACVvU,KAAKoX,UAGb,EAAElI,KAAKlP,MAAOyO,GAEPzO,IACX,EAEA4T,aAAc,WACV,OAAO5T,KAAKS,MAAM,CAAE+qC,cAAc,GACtC,EAEAG,YAAa,WACT,OAAO3rC,KAAKS,MAAM,CAAEgrC,YAAY,GACpC,EAEAG,WAAY,WACR,OAAQ5rC,KAAKyd,UACjB,EAEAA,SAAU,WACN,GAAIzd,KAAK6O,gBAAgBiK,EACrB,MAAO,CAAE3P,KAAM,4BACNqF,QAAS,oCAEtB,GAAIxO,KAAK6O,OAAS5O,EAAMsN,YAAY+vB,QAChC,MAAO,CAAEn0B,KAAM,kBACNqF,QAAS,4BAEtB,IAAIq9B,EAAK7rC,KAAKqP,OAAOy8B,gBAAgB9rC,KAAK6O,KAAKI,cAC3C88B,EAAUF,EAAGE,QACbC,EAAYH,EAAGG,UACf7nC,EAAQ,KAAMC,EAAS,KACvB6nC,EAAO,CAAC,EACZ,IACIjsC,KAAKqP,OAAOP,QAAQ9O,MAAM,SAAS0T,EAAK2B,GACpC,IAAI1N,EAAK,IAAIg2B,EAAQjqB,EAAK2B,GAAKoY,QAC3B2V,EAAS2I,EAAQpkC,GACrB,GAAIy7B,GACA,GAAc,OAAVj/B,EACAA,EAAQi/B,EAAOj/B,QACfC,EAASg/B,EAAOh/B,cACb,GAAMD,GAASi/B,EAAOj/B,SAAWC,GAAUg/B,EAAOh/B,SACrD,MAAM6nC,OAGT,IAAKD,EAAUrkC,IAAOkkC,EAAGK,UAC1B,MAAMD,CAEd,GACJ,CAAE,MAAM5jC,GACJ,GAAIA,IAAO4jC,EACP,MAAM5jC,EAEV,MAAO,CACHc,KAAM,qBACNqF,QAAS,8DAEjB,CACA,OAAO,CACX,EAEAtL,KAAM,SAAS8yB,GACX,IAAIvnB,EAASzO,KAAKyd,WAClB,GAAIhP,EACA,MAAM,IAAItD,MAAMsD,EAAOD,SAoB3B,YAjBa1B,IAATkpB,IACAA,EAAO,CAAE1Y,OAAQ,IAGrB0Y,EAAOA,aAAgB8E,MAAQ9E,EAAO,CAACA,GAEvCh2B,KAAKqP,OAAO88B,QAAQnsC,KAAK6O,KAAKI,aAAc+mB,EAAK7zB,KAAI,SAAS6zB,EAAMtrB,GAKhE,MAJoB,iBAATsrB,IACPA,EAAO,CAAE1Y,OAAQ0Y,IAGd,CACHtrB,WAAuBoC,IAAhBkpB,EAAK1Y,OAAuB5S,EAAQsrB,EAAK1Y,OAChDC,eAA8BzQ,IAAnBkpB,EAAKzY,WAAiCyY,EAAKzY,UAE9D,KAEOvd,IACX,EAEAosC,aAAc,WACV,QAASpsC,KAAK6O,gBAAgBiK,EAClC,EAEAqE,OAAQ,SAAS6Y,GACb,GAAIh2B,KAAK6O,gBAAgBiK,EACrB,MAAM,IAAI3N,MAAM,oCAgBpB,OAba,IAAT6qB,EACAh2B,KAAKqsC,gBAELrW,GAAgB,IAATA,EAAgB,GAAKA,aAAgB8E,MAAQ9E,EAAO,CAACA,GAE5Dh2B,KAAKqP,OAAOi9B,UAAUtsC,KAAK6O,KAAKI,aAAc+mB,EAAK7zB,KAAI,SAAS6zB,EAAMtrB,GAClE,MAAO,CACHA,WAAuBoC,IAAhBkpB,EAAK1Y,YAAsCxQ,IAAfkpB,EAAKtrB,MAAsBA,EAAQsrB,EAAKtrB,MAAQsrB,EAAK1Y,OACxFH,OAAQ6Y,EAAK7Y,OAErB,MAGGnd,IACX,EAEA4d,YAAa,SAASoY,GAClBh2B,KAAKqP,OAAOuO,YAAYoY,EAC5B,EAEAqW,aAAc,WACV,IAAIlvB,EAASnd,KAAKqP,OAAO8N,SACrB6Y,EAAO,GAEX,GAAI7Y,EAAQ,CACR,IAAK,IAAI5Z,EAAI,EAAGA,EAAI4Z,EAAOnF,QAAQ3W,OAAQkC,IACvCyyB,EAAKr1B,KAAKwc,EAAOnF,QAAQzU,GAAGmH,OAGhC1K,KAAKqP,OAAO8F,OAAM,WACdnV,KAAK4d,YAAYoY,GACjBh2B,KAAKusC,QAAU,IACnB,GAAG,CAAEx8B,QAAQ,EAAMoN,QAAQ,GAC/B,CACJ,EAEAC,UAAW,WAEP,QADapd,KAAKqP,OAAO8N,QAE7B,EAEAhH,WAAY,WACR,OAAO,IAAI2G,EAAM9c,KAAK6O,KAAKsH,aAAcnW,KAAKqP,OAClD,EAEAiH,YAAa,WACT,OAAO,IAAIwG,EAAM9c,KAAK6O,KAAKyH,cAAetW,KAAKqP,OACnD,EAEAoH,OAAQ,WACJ,OAAO,IAAIqG,EAAM9c,KAAK6O,KAAK4H,SAAUzW,KAAKqP,OAC9C,EAEAuH,UAAW,WACP,OAAO,IAAIkG,EAAM9c,KAAK6O,KAAK+H,YAAa5W,KAAKqP,OACjD,EAEAiO,OAAQ,SAASA,GACb,OAAO,IAAIR,EAAM9c,KAAK6O,KAAK4pB,SAASnb,GAAStd,KAAKqP,OACtD,EAEAqE,IAAK,SAASA,GACV,OAAO,IAAIoJ,EAAM9c,KAAK6O,KAAK2pB,MAAM9kB,GAAM1T,KAAKqP,OAChD,EAEAwF,WAAY,SAASjG,GACjB5O,KAAK6O,KAAKgG,WAAW,SAAS9F,GAC1BH,EAAS,IAAIkO,EAAM/N,EAAK/O,KAAKqP,QACjC,EAAEH,KAAKlP,MACX,EAEAyX,cAAe,SAAS7I,GACpB5O,KAAK6O,KAAK4I,cAAc,SAAS1I,GAC7BH,EAAS,IAAIkO,EAAM/N,EAAK/O,KAAKqP,QACjC,EAAEH,KAAKlP,MACX,EAEAgP,MAAO,WACH,OAAOhP,KAAKqP,MAChB,EAEAwB,QAAS,WACL,OAAO7Q,KAAK6O,KAAKI,aAAa4B,OAClC,EAEA27B,mBAAoB,WAChB,IAAIx9B,EAAQhP,KAAKqP,OACby4B,EAAc,GAQlB,OANA94B,EAAMgxB,aAAalxB,QAAQ,SAASC,GAC5BA,EAAIojB,WAAWnyB,KAAK6O,OACpBi5B,EAAYnnC,KAAKoO,EAAIqpB,WAE7B,EAAElpB,KAAKlP,OAEA8nC,CACX,EAEA35B,SAAU,SAASs+B,GACf,IASI3W,EATAjlB,EAAU7Q,KAAK6O,KAAK6jB,QACpBtkB,EAAQ,CACRW,IAAU8B,EACVrG,KAAU,GACV07B,QAAUlmC,KAAK6O,KAGfkJ,KAAU/X,KAAKqP,OAAOmL,MAAMrM,YAG3Bs+B,EAID3W,EADwB,UAAjB2W,EACM,CAAC,QAAS,WACC,WAAjBA,EACM,CAAC,aAAc,YAAa,cAAe,gBAE3C,CAACA,IAPd3W,EAAa71B,EAAMsN,YAAY6pB,eAC/BhpB,EAAM05B,YAAc9nC,KAAKwsC,sBAS7B,IAAIhiC,EAAO4D,EAAM5D,KAqBjB,OApBAxK,KAAKoV,aAAY,SAAS1B,EAAK2B,EAAKvB,GAChC,IAAI+zB,EAAY,CAAC,EACbE,EAAKr0B,EAAM7C,EAAQ6C,IACnBs0B,EAAK3yB,EAAMxE,EAAQwE,IAClB7K,EAAKu9B,KACNv9B,EAAKu9B,GAAM,IAEfv9B,EAAKu9B,GAAIC,GAAMH,EAEf/R,EAAWhnB,SAAQ,SAASnB,GACxB,IAAIzL,OAAiC,IAAlB4R,EAAKnG,GAA2B,KAAOmG,EAAKnG,IAC3DzL,aAAiBjC,EAAMsN,YAAYkH,KAAKuS,QAAQ0lB,SAChDxqC,aAAiBjC,EAAMsN,YAAYyT,WAAW2rB,cAE9CzqC,EAAQA,EAAMizB,aAElB0S,EAAUl6B,GAAYzL,CAC1B,GACJ,IAEOkM,CACX,EAEAF,SAAU,SAASE,EAAOgK,GACtB,IAAIpJ,EAAQhP,KAAKqP,OACbiN,EAAStc,KAAK6O,KAAK6jB,QACnB4T,EAAWl4B,EAAMW,IAAI2E,IAAM4I,EAAO5I,IAClC6yB,EAAWn4B,EAAMW,IAAIsG,IAAMiH,EAAOjH,IAClCu3B,EAAoBx0B,IAAcA,EAAUquB,aAC5CoG,EAAoBz0B,IAAcw0B,EAEtC59B,EAAMmG,MAAM,WACJ/G,EAAM05B,aACN9nC,KAAKoX,UAGJgB,GAIDpY,KAAKqP,OAAOmL,MAAMtM,SAASE,EAAM2J,MAGrC,IAAIrE,EAAM4I,EAAO5I,IACb0J,EAAYpd,KAAKod,YACrBhP,EAAM5D,KAAKsE,SAAQ,SAAStE,EAAMu9B,GAC9B,KAAI3qB,GAAawvB,GAAqB59B,EAAMi0B,YAAY70B,EAAMW,IAAI2E,IAAMq0B,IAAxE,CAGA,IAAI1yB,EAAMiH,EAAOjH,IACjB7K,EAAKsE,SAAQ,SAAS+4B,EAAWG,GAC7B,KAAI5qB,GAAawvB,GAAqB59B,EAAMk0B,eAAe90B,EAAMW,IAAIsG,IAAM2yB,IAA3E,CAGA,IAAIn6B,EAAQuK,EAAYpJ,EAAMnB,MAAM6F,EAAK2B,GACnCrG,EAAMnB,MAAMyO,EAAO5I,IAAMq0B,EAAIzrB,EAAOjH,IAAM2yB,GAChD,GAAIn6B,EAAMqF,SAAU,CAChB,IAAK,IAAIvF,KAAYk6B,EACD,SAAZl6B,IAOMyK,GAAyB,UAAZzK,GACfE,EAAM07B,KAAK57B,EAAUk6B,EAAUl6B,KAI3C,IAAKk6B,EAAU5R,QAKX,GAAI4W,EAQA,IAC2B,MAAnBhF,EAAU3lC,MACV2L,EAAM07B,KAAK,QAAS,MAEpB17B,EAAMyG,MAAMuzB,EAAU3lC,MAE9B,CAAE,MAAMmG,GACJwF,EAAM07B,KAAK,QAAS1B,EAAU3lC,MAClC,MAEA2L,EAAM07B,KAAK,QAAS1B,EAAU3lC,MAG1C,CACAmT,GA5CA,CA6CJ,IACA3B,GAnDA,CAoDJ,IAEItF,EAAM05B,aACN15B,EAAM05B,YAAYh5B,SAAQ,SAASs0B,GAC/BA,EAASp0B,EAAMH,KAAKu0B,GAAQ9V,SAASgZ,EAAUC,EAAU,GACzDv3B,EAAMnB,MAAMu1B,GAAQ9rB,OACxB,GAAGtX,KAEX,EAAEkP,KAAKlP,MAAO,CAAEiX,QAAQ,EAAMlI,IAAK/O,KAAK6O,MAC5C,EAEA2F,iBAAkB,WACd,IAAIsF,EAAO9Z,KACPgP,EAAQ8K,EAAKzK,OACbw8B,EAAK78B,EAAM88B,gBAAgBhyB,EAAKjL,KAAKI,cACrC88B,EAAUF,EAAGE,QACbC,EAAYH,EAAGG,UAEnBh9B,EAAMmG,OAAM,WACR2E,EAAKjF,YAAW,SAAS6qB,GACrB,IAAIhsB,EAAMgsB,EAAS7wB,KAAKgC,QAAQ6C,IAC5BtP,EAAS4K,EAAMqD,UAAUqB,GACxBtP,IAMLs7B,EAAStqB,aAAY,SAAS1B,EAAK2B,EAAKvB,GACpC,IAAInM,EAAK,IAAIg2B,EAAQjqB,EAAK2B,GAAKoY,QAC/B,IAAIue,EAAUrkC,GAAd,CAGA,IACIxD,EADAi/B,EAAS2I,EAAQpkC,GAGjBxD,EADAi/B,EACQp0B,EAAM0L,SAASoyB,IAAI1J,EAAOvyB,QAAQwE,IACf+tB,EAAO7oB,YAAYlF,KAEtCrG,EAAMmD,YAAYkD,GAE9B,IAAI7K,EAAOsJ,EAAK5R,MACZ4R,EAAKwB,QAAkB,MAAR9K,IACfA,EAAOvK,EAAMsN,YAAY2H,WAAWI,OAAO9K,EAAMsJ,EAAKwB,SAE1D,IAAIy3B,EAAa9sC,EAAMsN,YAAYhM,KAAKyrC,cACpCxiC,EAAMrG,EAAO2P,EAAKm5B,WAAYn5B,EAAK60B,SAAU70B,EAAKS,MACtDnQ,EAASqM,KAAKmK,IAAIxW,EAAQ2oC,EAf1B,CAgBJ,IACA/9B,EAAMqD,UAAUqB,EAAKtP,GACzB,GACJ,GAAG,CAAE2L,QAAQ,GACjB,EAEAqF,YAAa,SAASxG,GAClB5O,KAAK6O,KAAKC,QAAQ,SAASC,GACvB/O,KAAKqP,OAAOP,QAAQC,EAAIE,aAAcL,EAASM,KAAKlP,MACxD,EAAEkP,KAAKlP,MACX,EAEAktC,SAAU,WACN,IAAIC,EAAWntC,KAAKqP,OAAO+9B,kBAC3B,OAAOntC,EAAMsB,KAAK2G,UAAS,SAAS6C,GAChC/K,KAAKoV,aAAY,SAAS1B,EAAK2B,EAAKvB,GAIhC,IAAK,IAAI7R,KAAO6R,EAAM,CAClB,IAAI2W,EAAM3W,EAAK7R,GACXwoB,SAAqCA,IAAQ0iB,EAASlrC,IACtD8I,GAAK,EAEb,CACJ,GACJ,GAAG/K,KACP,EAEAuU,KAAM,SAAS84B,GACX,YAAavgC,IAATugC,IACSrtC,KAAK0N,UAAU,SAE5B1N,KAAK0N,UAAU,OAAQ2/B,GACV,OAATA,GACArtC,KAAKwU,mBAEFxU,KACX,EAEA2oC,SAAU,SAAS/mC,GACf,YAAakL,IAATlL,EACO5B,KAAK0N,UAAU,aAE1B1N,KAAK0N,UAAU,WAAY9L,GACd,OAATA,GACA5B,KAAKwU,mBAEFxU,KACX,EAEAstC,KAAM,SAAShtC,EAASsO,GACpB5O,KAAKqP,OAAOi+B,KAAKttC,KAAMM,EAASsO,EACpC,EAEAmH,cAAe,SAAS7T,GACpB,OAAOlC,KAAK+W,sBAAsB7U,GAAO4U,wBAAwB5U,EACrE,EAEA6U,sBAAuB,SAAS7U,GAQ5B,OAPAlC,KAAK6O,KAAKC,SAAQ,SAASC,GACnBA,aAAeiL,GAAYjL,EAAI5K,QAAU,KACzC4K,EAAMA,EAAIU,SACNoB,QAAQwE,MACZrV,KAAKqP,OAAOxB,MAAMkB,GAAKw6B,KAAK,WAAYrnC,GAEhD,GAAGlC,MACIA,IACX,EAEA8W,wBAAyB,SAAS5U,GAQ9B,OAPAlC,KAAK6O,KAAKC,SAAQ,SAASC,GACnBA,aAAeiL,GAAYjL,EAAI3K,SAAW,KAC1C2K,EAAMA,EAAIU,SACNoB,QAAQ6C,MACZ1T,KAAKqP,OAAOxB,MAAMkB,GAAKw6B,KAAK,WAAYrnC,GAEhD,GAAGlC,MACIA,IACX,IAGJ,SAASspC,EAAU/jB,EAAOC,EAAK+nB,GAC3B,KAAOhoB,GAASC,GAAO+nB,EAAUhoB,IAC7BA,IAEJ,GAAIA,EAAQC,EACR,MAAO,GAEX,IAAK,IAAIjiB,EAAIgiB,EAAQ,EAAGhiB,GAAKiiB,IAAOjiB,EAChC,GAAIgqC,EAAUhqC,GACV,MAAO,CACH,CAAEgiB,MAAOA,EAAOC,IAAKjiB,EAAI,IAC3BkQ,OAAO61B,EAAU/lC,EAAI,EAAGiiB,EAAK+nB,IAGvC,MAAO,CAAC,CAAEhoB,MAAOA,EAAOC,IAAKA,GACjC,CAGAhkB,EAAEgsC,KAAKtE,GAAY,SAAS3lC,EAAGoK,GAC3BmP,EAAM9J,UAAUrF,GAAY,SAASzL,GACjC,OAAOlC,KAAK0N,UAAUC,EAAUzL,EACpC,CACJ,IAWA,IAAIsC,EAAahD,EAAE,eAAe,GAClCgD,EAAWV,MAAMC,QAAU,qRAmB3B9D,EAAMsN,YAAYhM,KAAO,CAAEyrC,cAd3B,SAAuBpqC,EAAMuB,EAAO8oC,EAAYtE,EAAUp0B,GACtD,IAAI8O,EAAS,CACT1f,mBAAuB,EACvBQ,OAAoB,IAAToQ,EAAiBpQ,EAAQ,KAAO,OAC3C,aAAewkC,GAAY,IAAM,KACjC,cAAgBsE,GAAc,QAC9B,eAA0B,IAAT14B,EAAiB,WAAa,MAC/C,iBAA4B,IAATA,EAAiB,aAAe,SACnD,aAAwB,IAATA,EAAiB,aAAe,UAGnD,OAAOtU,EAAMsB,KAAKiE,YAAY5C,EAAMygB,EAAQ,CAAE5e,IAAKD,EAAY7B,eAAe,IAASyB,MAC3F,GAGAnE,EAAMsN,YAAYuP,MAAQA,CAC7B,CAh+BD,CAg+BGrb,OAAOxB,OAWN,IAAIwtC,EAAS,CAAC,EACVC,EAAgBztC,MAAMsN,YAC1BmgC,EAAcj5B,KAAOg5B,EACrB,IAAIE,EAAYF,EAAOzmB,QAAU,CAAC,EAC9B4mB,EAAU3tC,MAAM0B,MAEhBksC,EAAQH,EAAcjQ,IACtBqQ,EAAYJ,EAAc/P,QAC1BoQ,EAAaL,EAAc1zB,SAC3Bg0B,EAAaN,EAAc50B,SAC3Bm1B,EAAOP,EAAcpQ,QAIzB,SAAS4Q,EAAY/kC,GACjB,GAAIA,aAAgB+kC,EAChB,OAAO/kC,EAEXnJ,KAAKmJ,KAAOA,CAChB,CAEA+kC,EAAYl7B,UAAUolB,SAAW,WAC7B,MAAO,IAAMp4B,KAAKmJ,MAAqB,QAAbnJ,KAAKmJ,KAAiB,IAAM,IAC1D,EAIA,IAAIglC,EAAUP,EAAQxtC,OAAO,CACzBC,KAAM,SAAiBuO,EAAUqnB,EAASmY,EAAIC,GAC1CruC,KAAK4O,SAAWA,EAChB5O,KAAKi2B,QAAUA,EACfj2B,KAAKouC,GAAKA,EACVpuC,KAAKquC,OAASA,CAClB,EAEAC,QAAS,SAAS7jB,GACd,IAAI5qB,EAAOG,KACPyqB,aAAeojB,EACfhuC,EAAK0uC,aAAa,CAAE9jB,IAAO,WACvB5qB,EAAK2uC,SAAS/jB,EAClB,IAEA5qB,EAAK2uC,SAAS/jB,EAEtB,EAEAgkB,MAAO,SAAShkB,GACZ,OAAO,IAAIyjB,EAAYzjB,EAC3B,EAEA+jB,SAAU,SAAS/jB,GAEXA,OADQ3d,IAAR2d,EACM,KACCqQ,MAAM4T,QAAQjkB,GACfzqB,KAAK2uC,SAASlkB,GAEdmkB,GAAsBnkB,GAEhC,IAAIljB,EAAIvH,KAAKi2B,QACT1uB,EAAEojC,kBAGFlgB,EAAMzqB,KAAK2uC,SAASlkB,IAAQzqB,KAAK2uC,SAAS,CAAC,CAAElkB,KACtCA,aAAesjB,IACtBtjB,EAAMzqB,KAAK6uC,UAAUpkB,IAEzBljB,EAAErF,MAAQuoB,EACNzqB,KAAKouC,GAAGU,UAAUvnC,IAAMvH,KAAK4O,UAC7B5O,KAAK4O,SAASpO,KAAK+G,EAAGkjB,EAE9B,EAEA8jB,aAAc,SAASjjC,EAAG/D,GACtB,IAAI2mB,EAAUluB,KAAMsf,EAAW,GAe/B,GAbA,SAAUqG,EAAKra,GACX,IAAK,IAAI/H,EAAI,EAAGA,EAAI+H,EAAEjK,SAAUkC,EAAG,CAC/B,IAAIkD,EAAI6E,EAAE/H,GACNkD,aAAaonC,GACbkB,EAAI7gB,EAAQ8gB,YAAYvoC,IAExBq0B,MAAM4T,QAAQjoC,IAEdkf,EAAKlf,EAEb,CACH,CAXD,CAWG6E,IAEEgU,EAASje,OACV,OAAOkG,EAAE/G,KAAK0tB,GAGlB,IAAK,IAAI+gB,EAAU3vB,EAASje,OAAQkC,EAAI,EAAGA,EAAI+b,EAASje,SAAUkC,EACxD+b,EAAS/b,GAGP0K,KAAKigB,EAAQkgB,IAAI,aACda,GACH1nC,EAAE/G,KAAK0tB,EAEf,GAAGA,GAEP,SAAS6gB,EAAIzjC,GACT,IAAK,IAAI/H,EAAI,EAAGA,EAAI+H,EAAEjK,SAAUkC,EAAG,CAC/B,IAAIuQ,EAAOxI,EAAE/H,GACTuQ,EAAKmiB,SACL3W,EAAS3e,KAAKmT,EAAKmiB,QAE3B,CACA,OAAO,CACX,CACJ,EAEAiZ,WAAY,SAAS5jC,EAAG6jC,GAEpB,IADA,IAAIrY,EAAM,GACDvzB,EAAI,EAAGA,EAAI+H,EAAEjK,SAAUkC,EAAG,CAC/B,IAAIknB,EAAMnf,EAAE/H,GACRknB,aAAeojB,GACfpjB,EAAMzqB,KAAKovC,WAAW3kB,EAAK0kB,GAC3BrY,EAAMA,EAAIrjB,OAAOgX,IACVqQ,MAAM4T,QAAQjkB,GACrBqM,EAAMA,EAAIrjB,OAAOzT,KAAKkvC,WAAWzkB,EAAK0kB,IAC/B1kB,aAAe4kB,EACtBvY,EAAMA,EAAIrjB,OAAOzT,KAAKkvC,WAAWzkB,EAAIjgB,KAAM2kC,IAE3CrY,EAAIn2B,KAAK8pB,EAEjB,CACA,OAAOqM,CACX,EAEAwY,UAAW,SAASvgC,EAAKH,GACrB,IAAIrH,EAAIvH,KAAKi2B,QACTxL,EAAMzqB,KAAKouC,GAAGmB,UAAUxgC,EAAKxH,EAAEyH,MAAOzH,EAAEmM,IAAKnM,EAAE8N,KACnD,GAAIoV,aAAe+kB,EAAW,CAG1B/kB,EAAMA,EAAIhb,MAAMlI,EAAEyH,MAAOzH,EAAEmM,IAAKnM,EAAE8N,KAAK,GAIvC,IAAI+4B,EAAK,IAAIV,EAAc+B,yBAAyBzvC,KAAKouC,GAAG3gC,UAE5Dgd,EAAIxc,KAAKmgC,EAAIx/B,EAAU5O,KAC3B,MACQyqB,aAAeojB,KAEfpjB,EAAMA,EAAIyN,SAAS3wB,EAAEmM,IAAKnM,EAAE8N,gBACT04B,GAAc/tC,KAAKouC,GAAG7gB,SAAS9C,KAC9CA,EAAMA,EAAI5Z,SAET4Z,EAAIzb,QACLyb,EAAIzb,MAAQzH,EAAEyH,QAGtBJ,EAAgB,MAAP6b,EAAc,IAAIyjB,EAAY,QAAUzjB,EAEzD,EAEAilB,MAAO,SAASjlB,GACZ,OAAIA,aAAeojB,EACR7tC,KAAKovC,WAAW3kB,GAEpBA,CACX,EAEAklB,KAAM,SAASC,EAAOhhC,EAAUihC,GAC5BD,EAAQA,EAAMtpC,cACd,IAAIiB,EAAI0f,EAAM2oB,GACd,GAAIroC,EACA,OAAOA,EAAE/G,KAAKR,KAAM4O,EAAUihC,GAElCjhC,EAAS,IAAIs/B,EAAY,QAC7B,EAEA4B,KAAM,SAASrlB,GAIX,OAHIA,aAAeojB,IACfpjB,EAAMzqB,KAAKovC,WAAW3kB,IAER,iBAAPA,EACqB,QAArBA,EAAInkB,cAEG,iBAAPmkB,EACQ,IAARA,EAEO,kBAAPA,EACAA,EAEG,MAAPA,CACX,EAEAokB,UAAW,SAAS9/B,GAChB,IAAIxH,EAAIvH,KAAKi2B,QACb,OAAK1uB,EAAEojC,mBAAqB57B,aAAeg/B,EAanB,GAAhBh/B,EAAI3K,UAAiBmD,EAAE8N,KAAOtG,EAAI8B,QAAQwE,KAAO9N,EAAE8N,KAAOtG,EAAIwL,YAAYlF,IACnErV,KAAKovC,WAAW,IAAItB,EAAU/+B,EAAI8B,QAAQ6C,IAAKnM,EAAE8N,KAAKmY,SAASze,EAAIC,QAE3D,GAAfD,EAAI5K,SAAgBoD,EAAEmM,KAAO3E,EAAI8B,QAAQ6C,KAAOnM,EAAEmM,KAAO3E,EAAIwL,YAAY7G,IAClE1T,KAAKovC,WAAW,IAAItB,EAAUvmC,EAAEmM,IAAK3E,EAAI8B,QAAQwE,KAAKmY,SAASze,EAAIC,QAEvE,IAAIk/B,EAAY,SAEhBluC,KAAK2uC,SAAS5/B,EAE7B,EAEA4/B,SAAU,SAAS9gC,GACf,GAAIA,aAAiBwhC,EACjB,OAAOxhC,EAEX,IAAIhO,EAAOG,KACX,GAAI6N,aAAiBkgC,EAAY,CAC7B,IAAIxT,EAAK1sB,EAAMgD,QACXkP,EAAMwa,EAAG7mB,IAAK+L,EAAO8a,EAAGllB,IACxBgC,EAAQxX,EAAKmvC,YAAYnhC,GACzBhH,EAAI,IAAIwoC,EAASxvC,GAkBrB,OAjBIi4B,SAASjqB,EAAM1J,WACf0C,EAAE1C,MAAQ0J,EAAM1J,SAEhB2zB,SAASjqB,EAAMzJ,YACfyC,EAAEzC,OAASyJ,EAAMzJ,UAEhB0zB,SAAS/X,KACVA,EAAM,GAEL+X,SAASrY,KACVA,EAAO,GAEXpI,EAAMvI,SAAQ,SAASgF,GACnBjN,EAAEytB,IAAIxgB,EAAKJ,IAAMqM,EACXjM,EAAKuB,IAAMoK,EACX3L,EAAK5R,MACf,IACO2E,CACX,CACA,GAAIi0B,MAAM4T,QAAQ7gC,IAAUA,EAAMxM,OAAS,EAAG,CACtCwF,EAAI,IAAIwoC,EAASxvC,GAArB,IAA4B6T,EAAM,EA4BlC,OA3BA7F,EAAMiB,SAAQ,SAASihC,GACnB,IAAI16B,EAAM,EACN26B,EAAI,EACRD,EAAKjhC,SAAQ,SAASgY,GAClB,IAAImpB,EAAUnpB,aAAcinB,EACxBjnB,aAAc+mB,IAAUoC,IACxBnpB,EAAKjnB,EAAKuvC,WAAWtoB,KAErBmpB,GAAWnV,MAAM4T,QAAQ5nB,MACzBA,EAAKjnB,EAAK8uC,SAAS7nB,IAEnBA,aAAcuoB,GACdvoB,EAAG0mB,MAAK,SAAS1mB,EAAIzgB,EAAGM,GACpBE,EAAEytB,IAAI5gB,EAAMrN,EAAGgP,EAAM1O,EAAGmgB,EAC5B,IACAkpB,EAAIv/B,KAAKmK,IAAIo1B,EAAGlpB,EAAG1iB,QACnBiR,GAAOyR,EAAG3iB,QAEO,iBAAP2iB,GAAmBA,EAAGzlB,SAAWwL,MAAMia,KAC7CA,EAAKopB,OAAOppB,IAGhBjgB,EAAEytB,IAAI5gB,EAAK2B,IAAOyR,GAE1B,IACApT,GAAOs8B,CACX,IACOnpC,CACX,CACJ,EAEAmoC,YAAa,SAASx7B,EAAM28B,EAAYhB,GACpC,IAAI5nC,EAAIvH,KAAKi2B,QACb,OAAOj2B,KAAKouC,GAAGY,YAAYx7B,EAAM28B,EAAY5oC,EAAEyH,MAAOzH,EAAEmM,IAAKnM,EAAE8N,IAAK85B,EACxE,EAEAC,WAAY,SAASrgC,EAAKogC,GACtB,IAAI5nC,EAAIvH,KAAKi2B,QACb,OAAOj2B,KAAKouC,GAAG7jB,QAAQxb,EAAKxH,EAAEyH,MAAOzH,EAAEmM,IAAKnM,EAAE8N,IAAK85B,EACvD,EAEA1hC,SAAU,WACN,OAAOzN,KAAKouC,GAAG3gC,QACnB,IAGA4hC,EAAWzB,EAAQxtC,OAAO,CAC1BC,KAAM,SAAgB6tB,GAClBluB,KAAKkuB,QAAUA,EACfluB,KAAKoE,OAAS,EACdpE,KAAKmE,MAAQ,EACbnE,KAAKwK,KAAO,EAChB,EACAiF,MAAO,WACH,IAAI5I,EAAI,IAAIwoC,EAASrvC,KAAKkuB,SAI1B,OAHArnB,EAAEzC,OAASpE,KAAKoE,OAChByC,EAAE1C,MAAQnE,KAAKmE,MACf0C,EAAE2D,KAAOxK,KAAKwK,KAAKrI,KAAI,SAASuR,GAAM,OAAOA,EAAI5S,OAAS,IACnD+F,CACX,EACApE,IAAK,SAASiR,EAAK2B,GACf,IAAI06B,EAAO/vC,KAAKwK,KAAKkJ,GACjB+W,EAAMslB,EAAOA,EAAK16B,GAAO,KAC7B,OAAOoV,aAAeojB,EAAQ7tC,KAAKkuB,QAAQkhB,WAAW3kB,GAAOA,CACjE,EACA2lB,MAAO,SAAS18B,EAAK2B,GAOjB,OANmB,GAAfrV,KAAKoE,SACLsP,EAAM,GAEQ,GAAd1T,KAAKmE,QACLkR,EAAM,GAEN3B,EAAM1T,KAAKoE,QAAUiR,EAAMrV,KAAKmE,MACzBnE,KAAKyC,IAAIiR,EAAK2B,GAElB,IAAI64B,EAAY,MAC3B,EACA5Z,IAAK,SAAS5gB,EAAK2B,EAAK7K,GACpB,IAAIulC,EAAO/vC,KAAKwK,KAAKkJ,GACT,MAARq8B,IACAA,EAAO/vC,KAAKwK,KAAKkJ,GAAO,IAE5Bq8B,EAAK16B,GAAO7K,EACRkJ,GAAO1T,KAAKoE,SACZpE,KAAKoE,OAASsP,EAAM,GAEpB2B,GAAOrV,KAAKmE,QACZnE,KAAKmE,MAAQkR,EAAM,EAE3B,EACAm4B,KAAM,SAASjmC,EAAG8oC,GACd,IAAK,IAAI38B,EAAM,EAAGA,EAAM1T,KAAKoE,SAAUsP,EACnC,IAAK,IAAI2B,EAAM,EAAGA,EAAMrV,KAAKmE,QAASkR,EAAK,CACvC,IAAIoV,EAAMzqB,KAAKyC,IAAIiR,EAAK2B,GACxB,IAAIg7B,GAAuB,MAAP5lB,SAEJ3d,KADZ2d,EAAMljB,EAAE/G,KAAKR,KAAKkuB,QAASzD,EAAK/W,EAAK2B,IAEjC,OAAOoV,CAGnB,CAER,EACAtoB,IAAK,SAASoF,EAAG8oC,GACb,IAAIxpC,EAAI,IAAIwoC,EAASrvC,KAAKkuB,SAK1B,OAJAluB,KAAKwtC,MAAK,SAAS1mB,EAAIpT,EAAK2B,GAExBxO,EAAEytB,IAAI5gB,EAAK2B,EAAK9N,EAAE/G,KAAKR,KAAM8mB,EAAIpT,EAAK2B,GAC1C,GAAGg7B,GACIxpC,CACX,EACAypC,QAAS,SAAS/oC,GACd,IAAK,IAAImM,EAAM,EAAGA,EAAM1T,KAAKoE,SAAUsP,EAAK,CACxC,IAAI+W,EAAMljB,EAAE/G,KAAKR,KAAKkuB,QAASxa,GAC/B,QAAY5G,IAAR2d,EACA,OAAOA,CAEf,CACJ,EACA8lB,QAAS,SAAShpC,GACd,IAAK,IAAI8N,EAAM,EAAGA,EAAMrV,KAAKmE,QAASkR,EAAK,CACvC,IAAIoV,EAAMljB,EAAE/G,KAAKR,KAAKkuB,QAAS7Y,GAC/B,QAAYvI,IAAR2d,EACA,OAAOA,CAEf,CACJ,EACA+lB,OAAQ,SAASjpC,GACb,IAAIV,EAAI,IAAIwoC,EAASrvC,KAAKkuB,SAI1B,OAHAluB,KAAKswC,SAAQ,SAAS58B,GAClB7M,EAAEytB,IAAI5gB,EAAK,EAAGnM,EAAE/G,KAAKR,KAAKkuB,QAASxa,GACvC,IACO7M,CACX,EACA4pC,OAAQ,SAASlpC,GACb,IAAIV,EAAI,IAAIwoC,EAASrvC,KAAKkuB,SAI1B,OAHAluB,KAAKuwC,SAAQ,SAASl7B,GAClBxO,EAAEytB,IAAI,EAAGjf,EAAK9N,EAAE/G,KAAKR,KAAKkuB,QAAS7Y,GACvC,IACOxO,CACX,EACAuxB,SAAU,WACN,OAAO3D,KAAKC,UAAU10B,KAAKwK,KAC/B,EACAkmC,UAAW,WACP,IAAI7pC,EAAI,IAAIwoC,EAASrvC,KAAKkuB,SAI1B,OAHAluB,KAAKwtC,MAAK,SAAS1mB,EAAIpT,EAAK2B,GACxBxO,EAAEytB,IAAIjf,EAAK3B,EAAKoT,EACpB,IACOjgB,CACX,EACA8pC,KAAM,SAAS1pC,GACXjH,KAAKmE,MAAQnE,KAAKoE,OAAS6C,EAE3B,IADA,IAAIqE,EAAItL,KAAKwK,KAAO,IAAIswB,MAAM7zB,GACrB1D,EAAI0D,IAAK1D,GAAK,GAEnB,IADA,IAAImQ,EAAMpI,EAAE/H,GAAK,IAAIu3B,MAAM7zB,GAClB4D,EAAI5D,IAAK4D,GAAK,GACnB6I,EAAI7I,GAAKtH,GAAKsH,EAAI,EAAI,EAG9B,OAAO7K,IACX,EACA4wC,SAAU,SAAS12B,GAEf,IADA,IAAI5O,EAAItL,KAAM6G,EAAI,IAAIwoC,EAAS/jC,EAAE4iB,SACxBxa,EAAM,EAAGA,EAAMpI,EAAElH,SAAUsP,EAChC,IAAK,IAAI2B,EAAM,EAAGA,EAAM6E,EAAE/V,QAASkR,EAAK,CAEpC,IADA,IAAIw7B,EAAI,EACCttC,EAAI,EAAGA,EAAI+H,EAAEnH,QAASZ,EAAG,CAC9B,IAAIutC,EAAKxlC,EAAE7I,IAAIiR,EAAKnQ,GAChBwtC,EAAK72B,EAAEzX,IAAIc,EAAG8R,GAClB,GAAiB,iBAANy7B,GAA+B,iBAANC,EAChC,MAAM,IAAI7C,EAAY,SAE1B2C,GAAKC,EAAKC,CACd,CACAlqC,EAAEytB,IAAI5gB,EAAK2B,EAAKw7B,EACpB,CAEJ,OAAOhqC,CACX,EACAmqC,KAAM,SAAS92B,EAAG22B,GAGd,IAFA,IAAIvlC,EAAItL,KAAM6G,EAAI,IAAIwoC,EAAS/jC,EAAE4iB,SAC7B+iB,EAAOJ,GAAK,EAAI,EACXn9B,EAAM,EAAGA,EAAMpI,EAAElH,SAAUsP,EAChC,IAAK,IAAI2B,EAAM,EAAGA,EAAM/J,EAAEnH,QAASkR,EAAK,CACpC,IAAI5O,EAAI6E,EAAE7I,IAAIiR,EAAK2B,GACfyb,EAAI5W,EAAEzX,IAAIiR,EAAK2B,GACnBxO,EAAEytB,IAAI5gB,EAAK2B,EAAK5O,EAAIwqC,EAAOngB,EAC/B,CAEJ,OAAOjqB,CACX,EACAqqC,YAAa,WACT,IAEWC,EAAGC,EAAG7tC,EAAG8tC,EAFhB/lC,EAAItL,KAAKyP,QAAQjF,KACjBvD,EAAIqE,EAAEjK,OACNuF,EAAI,EACR,IAAKuqC,EAAI,EAAGA,EAAIlqC,EAAGkqC,IAAK,CACpB,IAAKC,EAAID,EAAIC,EAAInqC,IAAQqE,EAAE8lC,GAAGD,GAAKC,KACnC,GAAIA,GAAKnqC,EACL,OAAO,EAEX,GAAImqC,GAAKD,EAEL,IADAvqC,GAAKA,EACAyqC,EAAIF,EAAGE,EAAIpqC,EAAGoqC,IAAK,CACpB,IAAIC,EAAIhmC,EAAE6lC,GAAGE,GACb/lC,EAAE6lC,GAAGE,GAAK/lC,EAAE8lC,GAAGC,GACf/lC,EAAE8lC,GAAGC,GAAKC,CACd,CAEJ,IAAK/tC,EAAI4tC,EAAE,EAAG5tC,EAAI0D,EAAG1D,IACjB,IAAK8tC,EAAIF,EAAE,EAAGE,EAAIpqC,EAAGoqC,IACjB/lC,EAAE/H,GAAG8tC,IAAM/lC,EAAE6lC,GAAGE,GAAK/lC,EAAE/H,GAAG4tC,GAAK7lC,EAAE6lC,GAAGA,GAG5CvqC,GAAK0E,EAAE6lC,GAAGA,EACd,CACA,OAAOvqC,CACX,EACA2qC,QAAS,WAUL,IATA,IAGIpkC,EAHAlG,EAAIjH,KAAKmE,MACT0C,EAAI7G,KAAKwxC,QAAQ,IAAInC,EAASrvC,KAAKkuB,SAASyiB,KAAK1pC,IACjDqE,EAAIzE,EAAE2D,KAOD6mC,EAAI,EAAGA,EAAIpqC,IAAKoqC,EAAG,CACxB,IAAII,EAAOC,EAAOL,EAAGpqC,GAAG,SAAS1D,GAAI,OAAO+H,EAAE/H,GAAG8tC,EAAI,IACrD,IAAK/lC,EAAEmmC,GAAMJ,GACT,OAAO,KAEPA,GAAKI,IACLtkC,EAAM7B,EAAE+lC,GACR/lC,EAAE+lC,GAAK/lC,EAAEmmC,GACTnmC,EAAEmmC,GAAQtkC,GAEd,IAAK,IAAI5J,EAAI8tC,EAAE,EAAG9tC,EAAI0D,IAAK1D,EAAG,CAC1B,IAAK,IAAIsH,EAAIwmC,EAAE,EAAGxmC,EAAI,EAAE5D,IAAK4D,EACzBS,EAAE/H,GAAGsH,IAAMS,EAAE+lC,GAAGxmC,GAAKS,EAAE/H,GAAG8tC,GAAK/lC,EAAE+lC,GAAGA,GAExC/lC,EAAE/H,GAAG8tC,GAAK,CACd,CACJ,CAGA,IAAS9tC,EAAI,EAAGA,EAAI0D,IAAK1D,EAChB,KAAIgE,EAAI+D,EAAE/H,GAAGA,GAAlB,IAAsBsH,EAAI,EAAGA,EAAI,EAAE5D,IAAK4D,EACpCS,EAAE/H,GAAGsH,IAAMtD,CADW,CAQ9B,IAAS8pC,EAAIpqC,IAAKoqC,GAAK,GACnB,IAAS9tC,EAAI8tC,IAAK9tC,GAAK,GACnB,GAAI+H,EAAE/H,GAAG8tC,GACL,IAASxmC,EAAI,EAAE5D,IAAK4D,GAAK5D,GACrBqE,EAAE/H,GAAGsH,IAAMS,EAAE+lC,GAAGxmC,GAAKS,EAAE/H,GAAG8tC,GAM1C,OAAOxqC,EAAE/F,MAAM,EAAGmG,EAAGA,EAAGA,EAC5B,EACAuqC,QAAS,SAAS3qC,GACd,IAAIiwB,EAAM92B,KAAKyP,QAASxI,EAAI6vB,EAAI3yB,MAIhC,OAHA0C,EAAE2mC,MAAK,SAAS/iB,EAAK/W,EAAK2B,GACtByhB,EAAIxC,IAAI5gB,EAAK2B,EAAMpO,EAAGwjB,EAC1B,IACOqM,CACX,EACAh2B,MAAO,SAAS4S,EAAK2B,EAAKjR,EAAQD,GAE9B,IADA,IAAI0C,EAAI,IAAIwoC,EAASrvC,KAAKkuB,SACjB3qB,EAAI,EAAGA,EAAIa,IAAUb,EAC1B,IAAK,IAAIsH,EAAI,EAAGA,EAAI1G,IAAS0G,EACzBhE,EAAEytB,IAAI/wB,EAAGsH,EAAG7K,KAAKyC,IAAIiR,EAAMnQ,EAAG8R,EAAMxK,IAG5C,OAAOhE,CACX,IAgBJ,SAAS6qC,EAAOnuC,EAAGiiB,EAAKje,GAEpB,IADA,IAAIqT,EAAMrT,EAAEhE,GAAIuC,EAAMvC,IACbA,EAAIiiB,GAAK,CACd,IAAIhf,EAAIe,EAAEhE,GACNiD,EAAIoU,IACJA,EAAMpU,EACNV,EAAMvC,EAEd,CACA,OAAOuC,CACX,CAIA,IAAI0pC,EAAY5B,EAAQxtC,OAAO,CAC3BC,KAAM,SAAiBmT,EAAMua,EAAS4jB,EAAS3iC,EAAO0E,EAAK2B,EAAKs1B,GAC5D3qC,KAAKwT,KAAOA,EACZxT,KAAK+tB,QAAUA,EACf/tB,KAAKytB,MAAQkkB,EACb3xC,KAAK4xC,QAAU,KACf5xC,KAAKgP,MAAQA,EACbhP,KAAK0T,IAAMA,EACX1T,KAAKqV,IAAMA,EACXrV,KAAK6xC,QAAU,GACf7xC,KAAKivC,SAAU,EACfjvC,KAAK2qC,kBAAoBA,CAC7B,EACAF,qBAAsB,SAAS17B,GAC3B/O,KAAK2qC,kBAAoB57B,EAAIU,QAAQ+d,SAASxtB,KAAKgP,MACvD,EACAS,MAAO,SAAST,EAAO0E,EAAK2B,EAAKy8B,GAC7B,IAAIC,EAAU/iC,EAAM1I,cAChBkN,EAAOxT,KAAKwT,KACZ3F,EAAQ7N,KAAK2qC,kBAYjB,OAXImH,GAAaC,GAAW/xC,KAAKgP,MAAM1I,iBACnCkN,EAAOA,EAAKrR,KAAI,SAAS4M,GAIrB,OAHKA,EAAIipB,YAAgBjpB,EAAIC,OAASD,EAAIC,MAAM1I,eAAiByrC,IAC7DhjC,EAAMA,EAAIU,QAAQ+d,SAASxe,IAExBD,CACX,IACIlB,IACAA,EAAQA,EAAM4B,QAAQ+d,SAASxe,KAGhC,IAAIwgC,EAAUh8B,EAAMxT,KAAK+tB,QAAS/tB,KAAKytB,MAAOze,EAAO0E,EAAK2B,EAAKxH,EAC1E,EACAsnB,UAAW,WACP,IAAI3hB,EAAOxT,KAAKwT,KAAKrR,KAAI,SAAS4M,GAAM,OAAOA,EAAIU,OAAS,IAC5D,OAAO,IAAI+/B,EAAUh8B,EAAMxT,KAAK+tB,QAAS/tB,KAAKytB,MAAOztB,KAAKgP,MAAOhP,KAAK0T,IAAK1T,KAAKqV,IAAKrV,KAAK2qC,kBAC9F,EACA2D,QAAS,SAAS7jB,GACdzqB,KAAKivC,SAAU,EACfjvC,KAAK6xC,QAAQ/iC,SAAQ,SAASF,GAC1BA,EAAS6b,EACb,GACJ,EACAxc,KAAM,SAASmgC,EAAIx/B,EAAUojC,GACzB,GAAI,UAAWhyC,KACP4O,GACAA,EAAS5O,KAAKkC,WAEf,CACC0M,GACA5O,KAAK6xC,QAAQlxC,KAAKiO,GAMtB,IAHA,IAAIga,EAAM,IAAIulB,EAAQnuC,KAAKsuC,QAAStuC,KAAMouC,EAAI4D,GAC1CtgB,EAAQ,EAELsgB,GAAe,CAClB,GAAIA,EAAc/b,UAAYj2B,KAG1B,OAFAA,KAAKivC,SAAU,OACfrmB,EAAI0lB,QAAQ,IAAIJ,EAAY,aAGhC8D,EAAgBA,EAAc3D,SAC5B3c,CACN,CAGA,GAAI1xB,KAAKivC,QACL,OAEJjvC,KAAKivC,SAAU,EAEf,IAAIgD,EAAO,WAEFjyC,KAAK4xC,UACN5xC,KAAK4xC,QAAU5xC,KAAKwT,KAAKrR,KAAI,SAAS4M,GAClC,OAAOA,EAAImpB,SAASl4B,KAAK0T,IAAK1T,KAAKqV,IACvC,GAAGrV,OAIPA,KAAK+tB,QAAQvtB,KAAKooB,EACtB,EAAE1Z,KAAKlP,MAEH0xB,EAAQ,GACRugB,IAEApoB,WAAWooB,EAAM,EAEzB,CACJ,EACAriC,MAAO,WACH5P,KAAK6xC,QAAU,GACf7xC,KAAKivC,SAAU,SACRjvC,KAAKkC,KAChB,EACA03B,YAAa,SAASC,EAAcC,GAChCD,EAAeA,EAAavzB,cAC5BtG,KAAK4xC,QAAU,KACX5xC,KAAKgP,MAAM1I,eAAiBuzB,IAC5B75B,KAAKgP,MAAQ8qB,GAEjB95B,KAAKwT,KAAK1E,SAAQ,SAASC,GACvBA,EAAI6qB,YAAYC,EAAcC,EAClC,GACJ,EACA3B,OAAQ,SAAS+Z,EAAeC,EAAWpgB,EAAO9c,GAC9Ci9B,EAAgBA,EAAc5rC,cAC9B,IAAI8rC,EAAapyC,KAAK0T,IAClB2+B,EAAaryC,KAAKqV,IAClBi9B,EAAetyC,KAAKgP,MAAM1I,cAC1BisC,GAAe,EACfD,GAAgBJ,IAEC,OAAbC,GAAsBC,GAAcrgB,IACpC/xB,KAAK0T,KAAOuB,EACZs9B,GAAe,GAEF,OAAbJ,GAAsBE,GAActgB,IACpC/xB,KAAKqV,KAAOJ,EACZs9B,GAAe,IAGvB,IAAIC,EAAgBxyC,KAAK0T,IACrB++B,EAAgBzyC,KAAKqV,IACzBrV,KAAK4xC,QAAU,KACf,IAAIc,EAAW1yC,KAAKwT,KAChBqpB,EAAW0V,EACfvyC,KAAKwT,KAAOk/B,EAASvwC,KAAI,SAAS4M,GAC9B,IAAI4jC,EAASxa,EAAOppB,GAIpB,OAHK8tB,GAAa+V,EAAQD,EAAQ5jC,KAC9B8tB,GAAW,GAER8V,CACX,IAEA,IAAIE,EAAY7yC,KAAK2qC,kBAQrB,GAPIkI,IACA7yC,KAAK2qC,kBAAoBxS,EAAO0a,GAC3BhW,GAAa+V,EAAQC,EAAW7yC,KAAK2qC,qBACtC9N,GAAW,IAIfA,EAGA,OAAO,IAAI2S,EAAUkD,EAAU1yC,KAAK+tB,QAAS/tB,KAAKytB,MAAOztB,KAAKgP,MAAOojC,EAAYC,EAAYQ,GAGjG,SAAS1a,EAAOppB,GACZ,OAAIA,IAAQk/B,EACDl/B,EAEPA,EAAIC,MAAM1I,eAAiB4rC,GACvBK,IAIiB,OAAbJ,GAAsBC,GAAcrgB,IACpChjB,EAAMA,EAAIue,SAASrY,EAAO,IAEb,OAAbk9B,GAAsBE,GAActgB,IACpChjB,EAAMA,EAAIue,SAAS,EAAGrY,KAGvBlG,GAEJA,EAAIopB,OACPia,EAAYC,EACZG,EAAeC,EACF,OAAbN,EACApgB,EAAO9c,EAEf,CACJ,EACAmjB,SAAU,WACN,OAAOp4B,KAAKytB,MAAMztB,KAAK0T,IAAK1T,KAAKqV,IACrC,IAGJ,SAASu9B,EAAQ9Z,EAAIC,GAIjB,GAAID,EAAGga,cAAgB/Z,EAAG+Z,YACtB,OAAO,EAEX,GAAIha,aAAcgV,EACd,OAAOhV,EAAG9pB,OAAS+pB,EAAG/pB,OACf8pB,EAAGplB,KAAOqlB,EAAGrlB,KACbolB,EAAGzjB,KAAO0jB,EAAG1jB,KACbyjB,EAAGlB,KAAOmB,EAAGnB,IAExB,GAAIkB,aAAciV,EACd,OAAO6E,EAAQ9Z,EAAGjoB,QAAckoB,EAAGloB,UAC5B+hC,EAAQ9Z,EAAGve,YAAcwe,EAAGxe,cAC5Bue,EAAG2B,UAAY1B,EAAG0B,SAE7B,GAAI3B,aAAckV,EAAY,CAC1B,IAAIzqC,EAAIu1B,EAAGtlB,KAAKnS,OAChB,GAAIkC,GAAKw1B,EAAGvlB,KAAKnS,OACb,OAAO,EAEX,OAASkC,GAAK,GACV,IAAKqvC,EAAQ9Z,EAAGtlB,KAAKjQ,GAAIw1B,EAAGvlB,KAAKjQ,IAC7B,OAAO,CAGnB,CACA,OAAO,CACX,CAGA,IAAI0jB,EAAQxf,OAAOC,OAAO,MACtBqrC,EAAa,GA+CjB,SAASC,EAAsBC,EAAcpD,GACzC,IAEI3jC,EAAMgnC,EAON3rC,EATA4rC,EAAY,yFACZ7E,EAAU,iEACI8E,EAAO,kGAAmGC,GAAa,EACrIC,GAAgB,EAAOC,GAAe,EAiB1C,OAhBAH,GAAQvD,EAAK1tC,KAkBb,SAASqxC,EAAK/sC,GACVyF,EAAOzF,EAAE,GACT,IAAI0C,EAAO,KACX,GAAI2xB,MAAM4T,QAAQxiC,GACdinC,GAAa,6BACb7E,GAAW,6BACXnlC,GAAQ,yDACRA,GAAQ,6BACRA,GAAQ1C,EAAEtE,IAAIqxC,GAAMrwC,KAAK,IACzBgG,GAAQ,KACRA,GAAQ,wBACRmlC,GAAW,KACX6E,GAAa,UACV,GAAY,KAARjnC,EACPinC,GAAa,6BACb7E,GAAW,6BACXnlC,GAAQ,sDACRA,GAAQ,yDACRA,GAAQ,QACRA,GAAQ1C,EAAE3F,MAAM,GAAGqB,IAAIqxC,GAAMrwC,KAAK,IAClCgG,GAAQ,8BACRA,GAAQ,wBACRmlC,GAAW,KACX6E,GAAa,UACV,GAAY,KAARjnC,EAEP/C,GAAQ,SAAWsqC,EAAKhtC,EAAE,IAAM,qCAC7B,CACH,IAAIiI,EAAOjI,EAAE,GACb,GAAIq0B,MAAM4T,QAAQhgC,IAAS,aAAazG,KAAKyG,EAAK,IAAK,CACnD,IAAIygC,EAAY,KAAKlnC,KAAKyG,EAAK,IAC3BzH,EAAIyH,EAAK,GACbghC,IACAvmC,GAAQ,aACQ+C,EAAO,kCACnBjF,IACAkC,GAAQ,SAAWlC,GAEvBkC,GAAQ,KAAOgmC,EAAY,QAAU,IAAM,2BAA2BjjC,EAAK,MAClD,KAArBwC,EAAK,GAAG3H,OAAO,KACfoC,GAAQ,QAAQ+C,EAAK,iCAAiCA,EAAK,MAE/D/C,GAAQ,OAASsqC,EAAK/kC,EAAK,IAAM,eAAexC,EAAK,MACrD/C,GAAQ,eACRA,GAAQ,sBAEJA,GADAlC,EACQ,QAAUA,EAAI,KAEd,oBAEZkC,GAAQ,eAAe+C,EAAf,sEAERoiC,GAAW,iCACf,MAAO,GAAY,QAAR5/B,EACPvF,GAAQ,mDACL,EACEmqC,EAAgB,MAAMrrC,KAAKiE,MAC5BqnC,GAAe,EACfrnC,EAAOA,EAAKwe,OAAO,IAEvBvhB,GAAQ,QAAU+C,EAAO,iBACzB,IAAIwnC,GAAa,EACb,KAAKzrC,KAAKyG,IACVA,EAAOA,EAAKgc,OAAO,EAAGhc,EAAKrN,OAAS,GACpCqyC,GAAa,GAEbvqC,GAAQ,QAAQ+C,EAAK,kCAAkCA,EAAK,KAEhE/C,GA8BZ,SAAmBuF,EAAMglC,GACrBR,GAAS,EACT,IAAIpc,EAAM,SAAW2c,EAAK/kC,GAAQ,QAC9BwkC,IAAWQ,IACX5c,GAAO,SAAW5qB,EAAO,kCAAoCA,EAAO,MAGnEgnC,IACD5E,GAAW,SAGX6E,GADAG,EACa,QAAUpnC,EAAV,oCACGA,EADH,mBAEUA,EAFV,+BAGuBA,EAHvB,uCAIyBA,EAJzB,wFASA,8CAEjB,OAhBA4qB,GAAO,+BAiBX,CArDoB6c,CAAUjlC,EAAMglC,GAAc,eAAexnC,EAAK,KAC9D,CACJ,CAEA,OADA/C,GAAQ,IAEZ,IA3FuBhG,KAAK,IAC5BiwC,GAAQ,qDACRA,GAAQ,mBACRD,GAAa,2EAGTE,GACA/E,GAAW,6CACX/mC,EAAI,IAAIqsC,SAAS,YAAa,QAASR,EAAO9E,EAAU6E,EAAY,sEAEpE5rC,EAAI,IAAIqsC,SAAS,YAAa,QAASR,EAAO,6BAElD7rC,EAAIA,EAAE2mC,EAAa2F,GACdN,UACMhsC,EAAE4rC,UAEN5rC,EA6EP,SAASmoC,IACL,OAAIwD,EACO,IAAIhnC,GAEfmnC,GAAa,EACbH,GAAS,EACT5E,GAAW,8BACJ,KAAKpiC,EAAK,kBAAkBA,EAAK,KAC5C,CAEA,SAAS4nC,EAASC,GACd,MAAO,KACIA,EACG,WAAarE,IAAU,oBAAoBxjC,EAAK,aAAaA,EAAK,wBAClE,WAAawjC,IAAU,qBAC3B,YAAYxjC,EAAK,qBAAqBA,EAAK,QAAUA,EAJxD,gCAKeA,EAAK,+CAA+CA,EALnE,qDAMqDA,EANrD,iDAOmDA,EAPnD,yCAUX,CA2BA,SAASunC,EAAK/kC,GACV,GAAIosB,MAAM4T,QAAQhgC,GAAO,CACrB,GAAe,MAAXA,EAAK,GACL,MAAO,IAAMA,EAAK5N,MAAM,GAAGqB,IAAIsxC,GAAMtwC,KAAK,UAAY,IAE1D,GAAe,OAAXuL,EAAK,GACL,MAAO,IAAMA,EAAK5N,MAAM,GAAGqB,IAAIsxC,GAAMtwC,KAAK,UAAY,IAE1D,GAAe,UAAXuL,EAAK,GACL,MAAO,IAAMA,EAAK5N,MAAM,GAAGqB,KAAI,SAASsoB,GACpC,OAAOilB,IAAU,QAAUjlB,CAC/B,IAAGtnB,KAAK,UAAY,IAExB,GAAe,QAAXuL,EAAK,GACL,MAAO,IAAM+kC,EAAK,QAAU,SAASvnC,EAAK,MAAQwC,EAAK,GAAK,oBAEhE,GAAe,WAAXA,EAAK,IAA8B,aAAXA,EAAK,GAC7B,MAAO,IAAMghC,IAAU,OAAShhC,EAAK,GAA9B,QAAgDxC,EAAK,OAASwC,EAAK,GAAK,oCAEnF,GAAe,aAAXA,EAAK,GACL,MAAO,IAAMghC,IAAU,MAAQhhC,EAAK,GAA7B,QAA+CxC,EAAK,MAAQwC,EAAK,GAAK,oCAEjF,GAAe,aAAXA,EAAK,GACL,MAAO,IAAMghC,IAAU,MAAQhhC,EAAK,GAA7B,QAA+CxC,EAAK,OAASwC,EAAK,GAAK,oCAElF,GAAe,aAAXA,EAAK,GACL,MAAO,IAAMghC,IAAU,OAAShhC,EAAK,GAA9B,QAAgDxC,EAAK,MAAQwC,EAAK,GAAK,oCAElF,GAAe,UAAXA,EAAK,GAAgB,CACrB,IAAIslC,EAAMtlC,EAAK,IAAM,MACrB,MAAO,KAAOA,EAAK,GAAK,qBAAuB+lB,KAAKC,UAAUsf,GAAO,WACzE,CACA,GAAe,OAAXtlC,EAAK,GACL,MAAO,KAAO+kC,EAAK/kC,EAAK,IAAM,IAElC,MAAM,IAAIvD,MAAM,iCAAmCuD,EAAK,GAC5D,CACA,GAAY,UAARA,GAA4B,YAARA,EACpB,OAAOolC,GAAS,GAEpB,GAAY,WAARplC,EACA,MAAO,WAAaghC,IAAU,oBAAoBxjC,EAAK,aAAaA,EAAK,oBAE7E,GAAY,WAARwC,GAA6B,QAARA,EACrB,MAAO,IAAMolC,IAAa,UAAU5nC,EAAK,iBAE7C,GAAY,WAARwC,EACA,MAAO,IAAMolC,GAAS,GAAQ,SAAS5nC,EAAK,4CAEhD,GAAY,WAARwC,EACA,MAAO,IAAMolC,GAAS,GAAQ,SAAS5nC,EAAK,0CAEhD,GAAY,YAARwC,EACA,MAAO,IAAMolC,IAAa,UAAU5nC,EAAK,gDAE7C,GAAY,YAARwC,EACA,MAAO,IAAMolC,GAAS,GAAQ,SAAS5nC,EAAK,yCAEhD,GAAY,aAARwC,EACA,MAAO,IAAMolC,IAAa,UAAU5nC,EAAK,+CAE7C,GAAY,UAARwC,EACA,MAAO,YAAcghC,IAAU,2BAA2BxjC,EAAK,4BAA4BA,EAAK,qBAAqBA,EAAK,qBAAqBA,EAAK,uBAAuBA,EAAK,0BAEpL,GAAY,WAARwC,EACA,MAAO,WAAaghC,IAAU,iBAElC,GAAY,WAARhhC,EACA,MAAO,WAAaghC,IAAU,6BAA6BxjC,EAAK,oBAAoBA,EAAK,SAASA,EAAK,oBAE3G,GAAY,UAARwC,EAEA,OADAghC,IACO,wBAAwBxjC,EAAK,UAAUA,EAAK,iBAEvD,GAAY,WAARwC,EACA,MAAO,wBAAwBxC,EAAK,UAAUA,EAAK,iBAEvD,GAAY,OAARwC,EACA,MAAO,KAAKxC,EAAK,qCAErB,GAAY,QAARwC,EACA,MAAO,KAAKxC,EAAK,6CAA6CA,EAAK,0CAEvE,GAAY,QAARwC,EACA,MAAO,KAAKxC,EAAK,yCAErB,GAAY,QAARwC,EACA,MAAO,IAAMghC,IAAU,YAE3B,GAAY,YAARhhC,EACA,MAAO,IAAMghC,IAAU,gCAE3B,GAAY,UAARhhC,EACA,MAAO,IAAMghC,IAAU,sBAE3B,GAAY,YAARhhC,EACA,MAAO,qBAEX,GAAY,SAARA,EACA,MAAO,IAAMghC,IAAU,gBAAgBxjC,EAAK,WAEhD,MAAM,IAAIf,MAAM,yBAA2BuD,EAC/C,CACJ,CAEA,SAASmlC,EAAiB9W,EAAKx2B,GAC3B,OAAOw2B,IAAQnwB,SAASmwB,EAAK,IAAMA,GAAOA,EAAIkX,YAAY1tC,GAAU,GACxE,CAEA,SAASqoC,GAAsB7R,EAAKx2B,GAChC,MAAkB,iBAAPw2B,EACA8W,EAAiB9W,EAAKx2B,GAEtBw2B,CAEf,CAEA,SAASmX,GAAkB/rC,EAAKZ,EAAGsoC,GAC/B,GAAIA,aAAgB3B,EAChB,OAAO2B,EAEX,IACI,OAAOtoC,EAAEM,MAAMM,EAAK0nC,EACxB,CAAE,MAAMxnC,GACJ,GAAIA,aAAc6lC,EACd,OAAO7lC,EAEP,MAAMA,CAEd,CACJ,CAkGA,SAAS8rC,KACL,KAAMpB,EAAW1xC,QACb0xC,EAAW1rC,OAAX0rC,EAER,CAEA,SAASqB,GAAUC,GACftB,EAAWpyC,KAAK0zC,EACpB,CAEA,SAASC,GAAiBpoC,EAAMyjC,GAG5B,OAFAzjC,EAAOA,EAAK5F,cACZ2gB,EAAM/a,GAAQyjC,EACP,CACHE,KAAM,SAASA,EAAM0E,GACjB,IAAIprC,EAAO6pC,EAAsB9mC,EAAM2jC,GAEnC0E,IACIprC,EAAKgqC,WAAYqB,QAAQD,IAAIprC,EAAKgqC,UAAU/a,YAC5CjvB,EAAKmlC,SAAUkG,QAAQD,IAAIprC,EAAKmlC,QAAQlW,YACxCjvB,EAAKsrC,OAAQD,QAAQD,IAAIprC,EAAKsrC,MAAMrc,aAE5C,IAtHcrK,EAASugB,EAASmG,EAAOtB,EAsHnC5rC,EAAI0f,EAAM/a,IAtHA6hB,EAsHyB4hB,EAtHhBrB,EAsHsBnlC,EAAKmlC,QAtHlBmG,EAsH2BtrC,EAAKsrC,MAtHzBtB,EAsHgChqC,EAAKgqC,UArH7E,SAASvkC,EAAUihC,GACtB,SAAS6E,IACL,GAAIvB,EAAW,CACX,IAAI1sC,EAAI0sC,EAAU3yC,KAAKR,KAAM6vC,GAE7B,GADAA,EAAOppC,EAAEopC,KACLppC,EAAEtC,MAAQ,GAAKsC,EAAErC,OAAS,EAAG,CAE7B,IADA,IAAI2B,EAAS,IAAIspC,EAASrvC,MACjB0T,EAAM,EAAGA,EAAMjN,EAAErC,SAAUsP,EAChC,IAAK,IAAI2B,EAAM,EAAGA,EAAM5O,EAAEtC,QAASkR,EAAK,CAEpC,IADA,IAAIs/B,EAAQ,GACHpxC,EAAI,EAAGA,EAAIssC,EAAKxuC,SAAUkC,EAC3BkD,EAAEmuC,OAAOrxC,GACToxC,EAAMpxC,GAAKssC,EAAKtsC,GAAG6sC,MAAM18B,EAAK2B,GAE9Bs/B,EAAMpxC,GAAKssC,EAAKtsC,GAGxBoxC,EAAQF,EAAMj0C,KAAKR,KAAM20C,GACzB5uC,EAAOuuB,IAAI5gB,EAAK2B,EAAK6+B,GAAkBl0C,KAAM+tB,EAAS4mB,GAC1D,CAEJ,OAAO/lC,EAAS7I,EACpB,CACJ,CACI4uC,EAAQF,EAAMj0C,KAAKR,KAAM6vC,GAC7BjhC,EAASslC,GAAkBl0C,KAAM+tB,EAAS4mB,GAC9C,CACIrG,EACAA,EAAQ9tC,KAAKR,KAAM6vC,EAAM6E,GAEzBA,EAAKl0C,KAAKR,KAElB,GAuFQ,OADAuH,EAAEstC,qBAAuBhF,EAClB7vC,IACX,EACA80C,UAAW,SAASjF,EAAM0E,GACtB,IAAIprC,EAAO6pC,EAAsB9mC,EAAM2jC,GAEnC0E,IACIprC,EAAKgqC,WAAYqB,QAAQD,IAAIprC,EAAKgqC,UAAU/a,YAC5CjvB,EAAKmlC,SAAUkG,QAAQD,IAAIprC,EAAKmlC,QAAQlW,YACxCjvB,EAAKsrC,OAAQD,QAAQD,IAAIprC,EAAKsrC,MAAMrc,aAE5C,IA9FerK,EAASugB,EAASmG,EAAOtB,EA8FpC5rC,EAAI0f,EAAM/a,IA9FC6hB,EA8FyB4hB,EA9FhBrB,EA8FsBnlC,EAAKmlC,QA9FlBmG,EA8F2BtrC,EAAKsrC,MA9FzBtB,EA8FgChqC,EAAKgqC,UA7F9E,SAASvkC,EAAUihC,GACtB,SAAS6E,IACL,GAAIvB,EAAW,CACX,IAAI1sC,EAAI0sC,EAAU3yC,KAAKR,KAAM6vC,GAE7B,GADAA,EAAOppC,EAAEopC,KACLppC,EAAEtC,MAAQ,GAAKsC,EAAErC,OAAS,EAAG,CAY7B,IAXA,IAAI2B,EAAS,IAAIspC,EAASrvC,MACtBqgB,EAAQ5Z,EAAEtC,MAAQsC,EAAErC,OACpB2wC,EAAe,SAASrhC,EAAK2B,GAC7B,OAAO,SAASnT,GAGZ,GAFA6D,EAAOuuB,IAAI5gB,EAAK2B,EAAKnT,GAEP,KADZme,EAEE,OAAOzR,EAAS7I,EAExB,CACJ,EACS2N,EAAM,EAAGA,EAAMjN,EAAErC,QAAUic,EAAQ,IAAK3M,EAC7C,IAAK,IAAI2B,EAAM,EAAGA,EAAM5O,EAAEtC,OAASkc,EAAQ,IAAKhL,EAAK,CAEjD,IADA,IAAIs/B,EAAQ,GACHpxC,EAAI,EAAGA,EAAIssC,EAAKxuC,SAAUkC,EAC3BkD,EAAEmuC,OAAOrxC,GACToxC,EAAMpxC,GAAKssC,EAAKtsC,GAAG6sC,MAAM18B,EAAK2B,GAE9Bs/B,EAAMpxC,GAAKssC,EAAKtsC,GAIxB,IADAoxC,EAAQF,EAAMj0C,KAAKR,KAAM20C,cACJzG,GAGjB,GAFAnoC,EAAOuuB,IAAI5gB,EAAK2B,EAAKs/B,GAEP,KADZt0B,EAEE,OAAOzR,EAAS7I,QAGpB4uC,EAAM5lB,QAAQgmB,EAAarhC,EAAK2B,IAChC0Y,EAAQlmB,MAAM7H,KAAM20C,EAE5B,CAEJ,MACJ,CACJ,EACIluC,EAAIguC,EAAMj0C,KAAKR,KAAM6vC,cACR3B,EACbt/B,EAASnI,IAETA,EAAEsoB,QAAQngB,GACVmf,EAAQlmB,MAAM7H,KAAMyG,GAE5B,CACI6nC,EACAA,EAAQ9tC,KAAKR,KAAM6vC,EAAM6E,GAEzBA,EAAKl0C,KAAKR,KAElB,GAuCQ,OADAuH,EAAEstC,qBAAuBhF,EAClB7vC,IACX,EAER,CAMA,SAASg1C,GAAiBlkB,EAAGjqB,EAAGD,GAE5B,OAAS,MAAQkqB,EAAI,SADrBjqB,EACkC,IAAM,GAAK,IAAO,EAAI,IAClD,KAAOA,EAAI,EAAI,KAAOA,EAAI,IAAM,GAAK,IAAO,GAAK,IACjD,IAAOiqB,EAAI,OAASjqB,EAAI,IAAM,GAAK,IAAM,IAAM,GAAO,EAAI,GAC5DD,EAAI,KACZ,CAtdAqgB,EAAU,GAAI,SAASrY,EAAUihC,GAC7B,IAAIhwC,EAAOG,KACPi1C,EAAKpF,EAAK,GAAIqF,EAAKrF,EAAK,GAAI/oB,EAAK+oB,EAAK,GAG1C7vC,KAAKuuC,aAAa,CAAE0G,IAAM,WACtB,IAAIE,EAAWt1C,EAAK8uC,SAASsG,GACzBE,EAGAD,GAAG,SAASA,GACRpuB,GAAG,SAASA,GACR,IAAIsuB,EAAWv1C,EAAK8uC,SAASuG,GACzBG,EAAWx1C,EAAK8uC,SAAS7nB,GAC7BlY,EAASumC,EAAShzC,KAAI,SAASsoB,EAAK/W,EAAK2B,GACrC,OAAIoV,aAAeyjB,EACRzjB,EACA5qB,EAAKiwC,KAAKrlB,GACV2qB,EAAWA,EAAS3yC,IAAIiR,EAAK2B,GAAO6/B,EAEpCG,EAAWA,EAAS5yC,IAAIiR,EAAK2B,GAAOyR,CAEnD,IACJ,GACJ,KAEAmuB,EAAKj1C,KAAK0vC,MAAMuF,cACE/G,EACdt/B,EAASqmC,GACFp1C,EAAKiwC,KAAKmF,GACjBC,EAAGtmC,GAEHkY,EAAGlY,EAGf,GACJ,EAEAqY,EAAM,KAAO,SAASrY,GAClBA,GAAU,EAAE6B,KAAKygB,KAAK,IAAI,EAC9B,EAwcA,IAAIokB,GAAYN,GAAiB,KAAM,GAAI,GAEvCO,GAAgB,CAAE,GAAI,GAAI,GACR,GAAI,GAAI,GACR,GAAI,GAAI,GACR,GAAI,GAAI,IAE1BC,GAAmB,CACnB,CAAE,EAAG,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KACpD,CAAE,EAAG,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,MAGxD,SAASC,GAAaC,GAClB,OAAIA,EAAK,EACE,EAEPA,EAAK,IACE,EAEPA,EAAK,IACE,EAEJ,CACX,CAMA,SAASC,GAAcD,EAAIE,GACvB,OAAQH,GAAaC,IAAa,GAANE,EAAW,GAAKL,GAAcK,EAC9D,CAMA,SAASC,GAAaC,GAClB,OA5DApvC,GAFsBqvC,GA8DY,EAATD,GAAcR,IA5D9B,MAMT1uC,GAFAF,GAFAA,IAAU,QADVO,EAAK,EAAIP,EAAK,OAAS,GACA,GAAK,EAAI,IAEtB,MADVnD,EAAK,KAAQmD,EAAI,GAAK,QAAW,GACX,EAAI,GAAK,KAErB,MADVmE,EAAK,GAAKnE,EAAK,KAAO,GACA,GAAK,GAE3BG,EAAIgE,EAAI,EAAK,IADbnE,EAAImE,EAAI,GAAK,GAIN,CACHmrC,KAHJllB,EAAI,KAAO7pB,EAAI,IAAM1D,EAAImD,EAIrBuvC,QAHJpvC,EAIIqvC,KAAQtvC,EACRuvC,KAASJ,EAAK,GAAK,EACnBK,IAAQZ,GAAiBC,GAAa3kB,IAAIjqB,GAAKD,GAlBvD,IAA0BmvC,EAClBrvC,EAAGO,EAAG4D,EAAGtH,EAAGsD,EAAGD,EAAGkqB,CA8D1B,CAEA,SAASulB,GAAWL,EAAMC,EAAOC,GAC7B,OAAOlB,GAAiBgB,EAAMC,EAAOC,GAAQZ,EACjD,CAEA,IAAIgB,GAAY,IACZC,GAAa,GAAKD,GAClBE,GAAY,GAAKD,GAErB,SAASE,GAAWX,GAChB,IAAIY,EAAOZ,GAAiB,EAAPA,GACjBY,EAAO,GACPA,IAEJ,IAAIC,EAAKlmC,KAAKsjC,MAAMyC,GAAYE,GAC5BE,EAAQnmC,KAAKgnB,MAAMkf,EAAKJ,IAC5BI,GAAMC,EAAQL,GACd,IAAIM,EAAUpmC,KAAKgnB,MAAMkf,EAAKL,IAC9BK,GAAME,EAAUP,GAChB,IAAIQ,EAAUrmC,KAAKgnB,MAAMkf,EAAK,KAE9B,MAAO,CACHC,MAAOA,EACPC,QAASA,EACTC,QAASA,EACTC,aALJJ,GAAgB,IAAVG,EAOV,CAEA,SAASE,GAAalB,GAClB,IAAIlvC,EAAIivC,GAAaC,GAASxE,EAAImF,GAAWX,GAC7C,OAAO,IAAInwC,KAAKiB,EAAEovC,KAAMpvC,EAAEqvC,MAAOrvC,EAAEsvC,KACnB5E,EAAEsF,MAAOtF,EAAEuF,QAASvF,EAAEwF,QAASxF,EAAEyF,aACrD,CAEA,SAASE,GAASC,EAAIC,EAAI/I,EAAIuI,GAC1B,OAAQO,GAAIC,GAAI/I,EAAGuI,EAAG,KAAM,IAAI,IAAI,EACxC,CAEA,SAASS,GAAalB,GAClB,IAAImB,EAAOJ,GAASf,EAAKoB,WACLpB,EAAKqB,aACLrB,EAAKsB,aACLtB,EAAKuB,mBAIzB,OAHAvB,EAAOG,GAAWH,EAAKwB,cACPxB,EAAKyB,WACLzB,EAAK0B,YACV,EACA1B,EAAO,EAAImB,EAEXnB,EAAOmB,CAEtB,CAgCA1J,EAAUkK,UAAY3J,EACtBP,EAAUjB,QAAU8C,EACpB7B,EAAUrG,OAAS+H,EAEnB1B,EAAUmK,SAAWzB,GACrB1I,EAAUoK,WAAalC,GACvBlI,EAAUsJ,SAAWA,GACrBtJ,EAAU8I,WAAaA,GACvB9I,EAAUqJ,aAAeA,GACzBrJ,EAAUyJ,aAAeA,GACzBzJ,EAAUqK,YAAcrC,GACxBhI,EAAUsK,UAtGV,SAAmBvC,EAAIE,EAAIsC,GACvB,OAAOtC,GAAM,GAAKA,GAAM,IAAMsC,GAAM,GAAKA,GAAMvC,GAAcD,EAAIE,EAAK,EAC1E,EAqGAjI,EAAUwK,WAAa1C,GACvB9H,EAAUyK,WAhHV,SAAsB1C,GAClB,OAAOD,GAAaC,GAAM,IAAM,GACpC,EA+GA/H,EAAU0K,UA5CV,SAAmBh1C,EAAKiS,GAIpB,OAHIA,IACAA,EAASrV,MAAMsN,YAAY2H,WAAWojC,eAAehjC,IAElDrV,MAAMs4C,eAAel1C,EAAKiS,IAC1BrV,MAAMs4C,eAAel1C,IACrBpD,MAAMs4C,eAAel1C,EAAK,CACzB,eACA,aACA,cACA,YACA,eACA,aACA,cACA,YACA,gBACA,cACA,eACA,aACA,UACA,SACA,YACA,WACA,UACA,UAEZ,EAmBAsqC,EAAU1Y,eAAiB4e,EAE3BnG,EAAc7Y,aAAeuiB,GAC7B1J,EAActD,aAAe4M,GAC7BtJ,EAAc8K,eAAiBlE,GAC/B5G,EAAcyG,aAAeA,GAC7BzG,EAAc0G,UAAYA,GAC1B1G,EAAcmK,UAAY3J,EAE1BP,EAAU6K,eAAiBlE,GAC3B3G,EAAUwG,aAAeA,GACzBxG,EAAUyG,UAAYA,GACtBzG,EAAU8K,YAAc,SAASC,EAAOxsC,GACpC,IAAIysC,EAAO1xB,EAAM/a,GACjB,IAAKysC,EACD,MAAM,IAAIxtC,MAAM,YAAce,EAAO,uBAEpCysC,EAAKC,0BACND,EAAKC,wBAA0B,CAAE1sC,IAErCysC,EAAKC,wBAAwBj4C,KAAK+3C,GAClCzxB,EAAMyxB,GAASC,CACnB,EACAhL,EAAU1mB,MAAQA,EAIlB,IAAI4xB,GAAiB,CAAE,KAAM,SAAU,CAAE,OAAQ,IAE7CC,GAAe,CACf,CAAE,KAAMD,IACR,CAAE,KAAMA,KAGRE,GAAgB,CAChB,CAAE,KAAM,UACR,CAAE,KAAM,WAqCZ,SAASC,GAAO1tC,EAAG4O,GAKf,OAJA5O,EAAkB,iBAAR,EAAmBA,EAAEhF,cAAgBgF,EAC/C4O,EAAkB,iBAAR,EAAmBA,EAAE5T,cAAgB4T,GAGrC,IAAN5O,GAAoB,MAAL4O,KACT,IAANA,GAAoB,MAAL5O,IACT,IAANA,GAAoB,MAAL4O,IACT,IAANA,GAAoB,MAAL5O,IACT,KAANA,GAAoB,MAAL4O,IACT,KAANA,GAAoB,MAAL5O,GAEZA,IAAM4O,MACjB,CAkJA,SAAS++B,GAActJ,GACnB,OAAO,SAASlwB,EAAME,GAkBlB,MAjBmB,iBAARF,GAAoC,iBAATE,IAClCA,EAAiB,MAATA,EAAgB,GAAKA,EAAQ,IAEtB,iBAARF,GAAoC,iBAATE,IAClCF,EAAe,MAARA,EAAe,GAAKA,EAAO,IAEnB,iBAARA,GAA6B,MAATE,IAC3BA,EAAQ,GAEQ,iBAATA,GAA6B,MAARF,IAC5BA,EAAO,GAEQ,iBAARA,GAAoC,iBAATE,IAElCF,EAAOA,EAAKnZ,cACZqZ,EAAQA,EAAMrZ,sBAEPqZ,UAAgBF,GAIvBA,EAAOmvB,GAAsBnvB,EAAM,IACnCE,EAAQivB,GAAsBjvB,EAAO,IAC9BgwB,EAAKlwB,EAAME,IAEX,IAAIuuB,EAAY,QAE/B,CACJ,CA/NAkG,IAAU,KACNE,GAAiB,WAAW,SAAShpC,EAAG4O,GACpC,OAAO5O,EAAI4O,CACf,IAAG21B,KAAKiJ,IAERxE,GAAiB,WAAW,SAAShpC,EAAG4O,GACpC,OAAO5O,EAAI4O,CACf,IAAG21B,KAAKiJ,IAERxE,GAAiB,WAAW,SAAShpC,EAAG4O,GACpC,OAAO5O,EAAI4O,CACf,IAAG21B,KAAKiJ,IAERxE,GAAiB,WAAW,SAAShpC,EAAG4O,GACpC,OAAO5O,EAAI4O,CACf,IAAG21B,KAAK,CACJ,CAAE,KAAMgJ,IACR,CAAE,KAAM,aAGZvE,GAAiB,WAAW,SAAShpC,EAAG4O,GACpC,OAAOzJ,KAAKyoC,IAAI5tC,EAAG4O,EACvB,IAAG21B,KAAKiJ,IAERxE,GAAiB,WAAW,SAAShpC,EAAG4O,GAGpC,OAFS,MAAL5O,IAAaA,EAAI,IACZ,MAAL4O,IAAaA,EAAI,IACd,GAAK5O,EAAI4O,CACpB,IAAG21B,KAAK,CACJ,CAAE,KAAM,CAAE,KAAM,SAAU,SAAU,UAAW,SAC/C,CAAE,KAAM,CAAE,KAAM,SAAU,SAAU,UAAW,UACjD,IAkBNuE,IAAU,KACNE,GAAiB,UAAW0E,IAAQnJ,KAAKkJ,IAEzCzE,GAAiB,YAAY,SAAShpC,EAAG4O,GACrC,OAAQ8+B,GAAO1tC,EAAG4O,EACtB,IAAG21B,KAAKkJ,IAERzE,GAAiB,UAAW2E,IAAc,SAAS3tC,EAAG4O,GAClD,OAAO5O,EAAI4O,CACf,KAAI21B,KAAKkJ,IAETzE,GAAiB,WAAY2E,IAAc,SAAS3tC,EAAG4O,GACnD,OAAO5O,GAAK4O,CAChB,KAAI21B,KAAKkJ,IAETzE,GAAiB,UAAW2E,IAAc,SAAS3tC,EAAG4O,GAClD,OAAO5O,EAAI4O,CACf,KAAI21B,KAAKkJ,IAETzE,GAAiB,WAAY2E,IAAc,SAAS3tC,EAAG4O,GACnD,OAAO5O,GAAK4O,CAChB,KAAI21B,KAAKkJ,IAETzE,GAAiB,UAAU,SAAShpC,GAChC,OAAOA,CACX,IAAGukC,KAAK,CACJ,CAAE,KAAMgJ,MAGZvE,GAAiB,UAAU,SAAShpC,GAChC,OAAQA,CACZ,IAAGukC,KAAK,CACJ,CAAE,KAAMgJ,MAGZvE,GAAiB,UAAU,SAAShpC,GAChC,OAAOA,EAAI,GACf,IAAGukC,KAAK,CACJ,CAAE,KAAMgJ,MAIZvE,GAAiB,WAAW,SAAShpC,EAAG4O,GACpC,OAAO,IAAI6zB,EAAWziC,EAAG4O,GACpBsT,SAASliB,EAAE0D,OAAShP,KAAKi2B,QAAQjnB,MAAO1D,EAAE0sB,WACnD,IAAG6X,KAAK,CACJ,CAAE,IAAK,QACP,CAAE,IAAK,UAIXyE,GAAiB,WAAW,SAAShpC,EAAG4O,GACpC,OAAO,IAAI8zB,EAAW,CAAE1iC,EAAG4O,GAC/B,IAAG21B,KAAK,CACJ,CAAE,IAAK,OACP,CAAE,IAAK,SAIXyE,GAAiB,WAAW,SAAShpC,EAAG4O,GACpC,OAAO5O,EAAE+sB,UAAUne,EACvB,IAAG21B,KAAK,CACJ,CAAE,IAAK,OACP,CAAE,IAAK,SAKXyE,GAAiB,OAAO,SAAShpC,GAC7B,OAAQtL,KAAK8vC,KAAKxkC,EACtB,IAAGukC,KAAK,CACJ,CAAE,KAAM,CAAE,KAAM,WAAY,CAAE,OAAQ,OAK1CyE,GAAiB,WAAW,SAAS7pB,GACjC,OAAIA,aAAeqjB,GAED,OADdrjB,EAAMzqB,KAAKovC,WAAW3kB,GAI9B,IAAGolB,KAAK,CACJ,CAAE,SAAU,eAGhByE,GAAiB,WAAW,SAAS7pB,GACjC,OAAOA,aAAeyjB,CAC1B,IAAG2B,KAAK,CACJ,CAAE,SAAU,aAGhByE,GAAiB,SAAS,SAAS7pB,GAC/B,OAAOA,aAAeyjB,GAA2B,OAAZzjB,EAAIthB,IAC7C,IAAG0mC,KAAK,CACJ,CAAE,SAAU,aAGhByE,GAAiB,QAAQ,SAAS7pB,GAC9B,OAAOA,aAAeyjB,GAA2B,OAAZzjB,EAAIthB,IAC7C,IAAG0mC,KAAK,CACJ,CAAE,SAAU,aAGhByE,GAAiB,aAAa,SAAS7pB,GACnC,MAAqB,kBAAPA,CAClB,IAAGolB,KAAK,CACJ,CAAE,SAAU,aAGhByE,GAAiB,aAAa,SAAS7pB,GACnC,MAAqB,iBAAPA,CAClB,IAAGolB,KAAK,CACJ,CAAE,SAAU,aAGhByE,GAAiB,UAAU,SAAS7pB,GAChC,MAAqB,iBAAPA,CAClB,IAAGolB,KAAK,CACJ,CAAE,SAAU,aAGhByE,GAAiB,YAAY,SAAS7pB,GAClC,MAAqB,iBAAPA,CAClB,IAAGolB,KAAK,CACJ,CAAE,SAAU,aAGhByE,GAAiB,SAAS,SAAS7pB,GAE/B,OAAOA,aAAeqjB,GAAarjB,aAAesjB,CACtD,IAAG8B,KAAK,CACJ,CAAE,SAAU,cACd,IAKN5oB,EAAM,YAAc,SAASrY,EAAUihC,GACnC7vC,KAAKsvC,UAAUO,EAAK,GAAIjhC,EAC5B,EAsCA,IAAIuqC,GAAMl5C,MAAMwF,OAEZ2zC,GAAgBn5C,MAAMsN,YAEtB8rC,GAAY,CAAC,EACjBD,GAAcp4B,WAAaq4B,GAC3B,IAAIC,GAASF,GAAc3kC,KACvB9S,GAAQ1B,MAAM0B,MAEd43C,GAAc,mBAElBD,GAAOtyB,QAAQotB,WAAU,KACrBkF,GAAOtyB,QAAQwxB,eAAe,WAAW,SAAS3xC,GAM9C,MALgB,iBAALA,IAGPA,EAAI7G,KAAK2uC,SAAS,CAAE9nC,EAAEZ,MAAM,cAEzBY,CACX,IAAGgpC,KAAK,CACJ,CAAE,IAAK,CAAE,KAAM,SAAU,YAC3B,IAyFN,IAAIlD,GAAahrC,GAAMvB,OAAO,CAC1BC,KAAM,SAAoBC,GACtBN,KAAK+tB,QAAUztB,EAAQytB,QACvB/tB,KAAKw5C,KAAOl5C,EAAQk5C,KACpBx5C,KAAKy5C,GAAKn5C,EAAQm5C,GAClBz5C,KAAK05C,SAAWp5C,EAAQo5C,SACxB15C,KAAK25C,aAAgBr5C,EAAQq5C,aAC7B35C,KAAK0O,KAAOpO,EAAQoO,KAAOpO,EAAQoO,KAAO,UAC1C1O,KAAK45C,aAAat5C,EAAQs5C,WAC1B55C,KAAK65C,kBAAkBv5C,EAAQu5C,gBAC/B75C,KAAK85C,gBAAgBx5C,EAAQw5C,cAC7B95C,KAAK+5C,WAAaz5C,EAAQy5C,WAC1B/5C,KAAKg6C,kBAAkB15C,EAAQ05C,gBAG/Bh6C,KAAKgP,MAAQ1O,EAAQ0O,MACrBhP,KAAK0T,IAAMpT,EAAQoT,IACnB1T,KAAKqV,IAAM/U,EAAQ+U,IAEf/U,EAAQ25C,yBACRj6C,KAAKi6C,uBAAyB35C,EAAQ25C,wBAGtC35C,EAAQ45C,uBACRl6C,KAAKk6C,qBAAuB55C,EAAQ45C,sBAGpC55C,EAAQ65C,kBACRn6C,KAAKm6C,gBAAkB75C,EAAQ65C,iBAG/B75C,EAAQ85C,gBACRp6C,KAAKo6C,cAAgB95C,EAAQ85C,cAErC,EAEAC,gBAAiB,SAAS/kC,GACtB,IAAIkkC,EAAOx5C,KAAKw5C,KAAOx5C,KAAKs6C,WAAa,GACrCb,EAAKz5C,KAAKy5C,GAAKz5C,KAAKu6C,SAAW,GAE/BC,EAAcx6C,KAAKw5C,KAAOx5C,KAAKw5C,KAAKphB,WAAa,GACjDqiB,EAAYz6C,KAAKy5C,GAAKz5C,KAAKy5C,GAAGrhB,WAAa,GAC3CshB,EAAW15C,KAAK05C,SAChBhrC,EAAO1O,KAAK0O,KACZirC,EAAe35C,KAAK25C,aAExB,OAAO15C,MAAMqV,OAAOA,EAAQkkC,EAAMC,EAAIe,EAAaC,EAAWf,EAAUhrC,EAAMirC,EAClF,EAEAe,aAAc,WACV16C,KAAKuO,MAAQ,GACbvO,KAAKwO,QAAU,GAEXxO,KAAKk6C,uBACLl6C,KAAK26C,aAAe36C,KAAKq6C,gBAAgBr6C,KAAKk6C,uBAG9Cl6C,KAAKi6C,yBACLj6C,KAAK46C,eAAiB56C,KAAKq6C,gBAAgBr6C,KAAKi6C,yBAGhDj6C,KAAKo6C,gBACLp6C,KAAKuO,MAAQvO,KAAKq6C,gBAAgBr6C,KAAKo6C,gBAGvCp6C,KAAKm6C,kBACLn6C,KAAKwO,QAAUxO,KAAKq6C,gBAAgBr6C,KAAKm6C,iBAEjD,EAEAU,aAAc,WACV,IAAK76C,KAAKs6C,aAAet6C,KAAKs6C,WAAW9vC,KACrC,MAAO,GAGX,IACIjH,EACAutB,EAFAgqB,EAAO96C,KAAKs6C,WAAW9vC,KAGvBA,EAAO,GAEX,IAAKjH,EAAI,EAAGA,EAAIu3C,EAAKz5C,OAAQkC,IAAM,CAC/B,IAAIw3C,EAAQD,EAAKv3C,GAEjB,GAAIw3C,EACA,IAAKjqB,EAAI,EAAGA,EAAIiqB,EAAM15C,OAAQyvB,IAC1BtmB,EAAK7J,KAAKo6C,EAAMjqB,GAG5B,CAEA,OAAOtmB,CACX,EAEAiF,MAAO,SAAST,EAAO0E,EAAK2B,GACxB,IAAI/U,EAAUN,KAAKg7C,cAUnB,OARI16C,EAAQk5C,OACRl5C,EAAQk5C,KAAOl5C,EAAQk5C,KAAK/pC,MAAMT,EAAO0E,EAAK2B,IAG9C/U,EAAQm5C,KACRn5C,EAAQm5C,GAAKn5C,EAAQm5C,GAAGhqC,MAAMT,EAAO0E,EAAK2B,IAGvC,IAAIs3B,GAAWwM,GAAI/4C,OAAOE,EAC7B,CAAEytB,QAAS/tB,KAAK+tB,SAChB,CAAE/e,MAAOA,EAAO0E,IAAKA,EAAK2B,IAAKA,IAEvC,EAEA8f,UAAW,WACP,IAAI3uB,EAAI,IAAImmC,GAAW3sC,MAKvB,OAJAwG,EAAEgzC,KAAOhzC,EAAEgzC,KAAKrkB,YACZ3uB,EAAEizC,KACFjzC,EAAEizC,GAAKjzC,EAAEizC,GAAGtkB,aAET3uB,CACX,EAEAyH,KAAM,SAASmgC,EAAI6M,EAAcC,EAAetsC,GAC5C,IAAI/O,EAAOG,KAEX,SAASm7C,EAAS1wB,GAOd,OANIA,aAAexqB,MAAMsN,YAAYkwB,MACjChT,EAAM2jB,EAAG7jB,QAAQE,GACbqQ,MAAM4T,QAAQjkB,KACdA,EAAMA,EAAI,KAGXA,CACX,CAEA,IAAI2wB,EAAwB,SAAS3wB,GACjC5qB,EAAKy6C,WAAaa,EAAS1wB,GAC3B5qB,EAAKqC,MAAQrC,EAAKkuB,QAAQvtB,KAAKX,EAAMo7C,EAAcC,GACnDr7C,EAAK66C,eACD9rC,GACAA,EAAS/O,EAAKqC,MAEtB,EAEIrC,EAAK45C,GACL55C,EAAK45C,GAAGxrC,KAAKmgC,GAAI,SAAS3jB,GACtB5qB,EAAK06C,SAAWY,EAAS1wB,GACzB5qB,EAAK25C,KAAKvrC,KAAKmgC,EAAIgN,EACvB,IAEAv7C,EAAK25C,KAAKvrC,KAAKmgC,EAAIgN,EAE3B,EAEAxrC,MAAO,WACC5P,KAAKw5C,MACLx5C,KAAKw5C,KAAK5pC,QAEV5P,KAAKy5C,IACLz5C,KAAKy5C,GAAG7pC,eAEL5P,KAAKkC,KAChB,EAEAi2B,OAAQ,SAAS+Z,EAAeC,EAAWpgB,EAAO9c,GAC9C,IAAIomC,EAAUC,EAAQze,EAClBuV,EAAapyC,KAAK0T,IAClB2+B,EAAaryC,KAAKqV,IAOtB,GANIrV,KAAKw5C,OACL6B,EAAWr7C,KAAKw5C,KAAKrhB,OAAO+Z,EAAeC,EAAWpgB,EAAO9c,IAE7DjV,KAAKy5C,KACL6B,EAASt7C,KAAKy5C,GAAGthB,OAAO+Z,EAAeC,EAAWpgB,EAAO9c,IAEzDjV,KAAKgP,MAAM1I,eAAiB4rC,EAAc5rC,cAC1C,OAAQ6rC,GACN,IAAK,MACCC,GAAcrgB,IACd8K,GAAW,EACX78B,KAAK0T,KAAOuB,GAEhB,MACF,IAAK,MACCo9B,GAActgB,IACd8K,GAAW,EACX78B,KAAKqV,KAAOJ,GAKxB,GAAI4nB,GAAYwe,GAAYC,EAAQ,CAChC,IAAI90C,EAAI,IAAImmC,GAAW3sC,MAKvB,OAJAwG,EAAEgzC,KAAO6B,EACT70C,EAAEizC,GAAK6B,EACP90C,EAAEkN,IAAM0+B,EACR5rC,EAAE6O,IAAMg9B,EACD7rC,CACX,CACJ,EAEAqtB,OAAQ,WACJ,IAAIvzB,EAAUN,KAAKg7C,cA6BnB,OA3BI16C,EAAQk5C,OACRl5C,EAAQk5C,KAAOl5C,EAAQk5C,KAAKphB,WAEH,SAArB93B,EAAQo5C,WACRp5C,EAAQk5C,KAAOl5C,EAAQk5C,KAAK12C,QAAQ,qBAAsB,aACnDxC,EAAQ05C,iBAGM,SAArB15C,EAAQo5C,UACJ15C,KAAK65C,kBACLv5C,EAAQk5C,KAAOl5C,EAAQk5C,KAAK12C,QAAQ,yBAA0B,aACvDxC,EAAQu5C,kBAKvBv5C,EAAQm5C,KACRn5C,EAAQm5C,GAAKn5C,EAAQm5C,GAAGrhB,WAEC,SAArB93B,EAAQo5C,UACJ15C,KAAK85C,gBACLx5C,EAAQm5C,GAAKn5C,EAAQm5C,GAAG32C,QAAQ,yBAA0B,aACnDxC,EAAQw5C,gBAKpBx5C,CACX,EAEA06C,YAAa,WACT,MAAO,CACHxB,KAAMx5C,KAAKw5C,KACXC,GAAIz5C,KAAKy5C,GACTC,SAAU15C,KAAK05C,SACfhrC,KAAM1O,KAAK0O,KACXirC,aAAc35C,KAAK25C,aACnBjmC,IAAK1T,KAAK0T,IACV2B,IAAKrV,KAAKqV,IACVrG,MAAOhP,KAAKgP,MACZ4qC,WAAY55C,KAAK45C,WACjBI,gBAAiBh6C,KAAKg6C,gBACtBH,gBAAiB75C,KAAK65C,gBACtBC,cAAe95C,KAAK85C,cACpBG,uBAAwBj6C,KAAKi6C,uBAC7BC,qBAAsBl6C,KAAKk6C,qBAE3BC,gBAAiBn6C,KAAKm6C,gBACtBC,cAAep6C,KAAKo6C,cACpBL,WAAY/5C,KAAK+5C,WAEzB,IAEJV,GAAUxP,QAnVV,SAA2B76B,EAAO0E,EAAK2B,EAAK2L,GACxC,IAAIu6B,EACAhoB,EAiDJ,GA7C0B,iBAAfvS,IACPA,EAAayT,KAAKpc,MAAM2I,IAGxBA,EAAWw4B,OACiB,SAAxBx4B,EAAW04B,UAAwB14B,EAAWg5B,kBAE3Ch5B,EAAWw4B,KAAKjoC,QAAQ,MAAQ,IAC/ByP,EAAWw4B,KAAOx4B,EAAWw4B,KAAK12C,QAAQ,MAAM,IAAIA,QAAQ,IAAI,KAAMA,QAAQ,IAAK,MAEvFke,EAAWw4B,KAAOv5C,MAAMqV,OAhCb,eAgCsC0L,EAAWw4B,MAC5Dx4B,EAAWg5B,iBAAkB,GAGL,SAAxBh5B,EAAW04B,UACMJ,GAAOtyB,QAAQqxB,UAAUr3B,EAAWw4B,QAEjDx4B,EAAWw4B,KAAOv5C,MAAMqV,OAAOikC,GAAav4B,EAAWw4B,MACvDx4B,EAAW64B,iBAAkB,GAIrC74B,EAAWw4B,KAAOF,GAAOzP,QAAQyP,GAAOkC,aAAaxsC,EAAO0E,EAAK2B,EAAK2L,EAAWw4B,QAGjFx4B,EAAWy4B,KACiB,SAAxBz4B,EAAW04B,UACIJ,GAAOtyB,QAAQqxB,UAAUr3B,EAAWy4B,MAE/Cz4B,EAAWy4B,GAAKx5C,MAAMqV,OAAOikC,GAAav4B,EAAWy4B,IACrDz4B,EAAW84B,eAAgB,GAInC94B,EAAWy4B,GAAKH,GAAOzP,QAAQyP,GAAOkC,aAAaxsC,EAAO0E,EAAK2B,EAAK2L,EAAWy4B,QAI/ElmB,EADuB,UAAvBvS,EAAW04B,SACAL,GAAUoC,oBAAoBC,OACX,QAAvB16B,EAAW04B,SACPL,GAAUoC,oBAAoBl0B,KAE9B8xB,GAAUoC,oBAAoBz6B,EAAW24B,eAIpD,MAAM15C,MAAMqV,OAAO,qCAAsC0L,EAAW24B,cA0BxE,OAvBA4B,EAAoB,SAAUI,GAC1B,IAAIC,EAAU57C,KAAKy5C,KAAOz5C,KAAKu6C,UAA8B,IAAlBv6C,KAAKu6C,UAAkBv6C,KAAKu6C,cAAWztC,EAElF,GAAuB,OAAnB6uC,GAA8C,KAAnBA,EACvB37C,KAAK45C,WACL55C,KAAKkC,OAAQ,EAEblC,KAAKkC,OAAQ,OAEd,GAAqB,UAAjBlC,KAAK05C,SACZ15C,KAAKkC,MAAQqxB,EAASooB,EAAgB37C,KAAKs6C,WAAasB,QACrD,GAAqB,QAAjB57C,KAAK05C,SAAoB,CAChC,IAAIlvC,EAAOxK,KAAK66C,eAEhB76C,KAAKkC,MAAQqxB,EAASooB,EAAgBnxC,EAAMoxC,EAChD,MAEI57C,KAAKkC,MAAQqxB,EAASooB,EAAgB37C,KAAKs6C,WAAasB,GAG5D,OAAO57C,KAAKkC,KAChB,EAEO,IAAIjC,MAAMsN,YAAYyT,WAAW2rB,WAAWwM,GAAI/4C,OAAO4gB,EAAY,CACtE+M,QAASwtB,EACTvsC,MAAOA,EACP0E,IAAKA,EACL2B,IAAKA,IAEb,EAgQAgkC,GAAUoC,oBAAsB,CAC5BI,YAAa,SAAUF,EAAgBnC,GACnC,OAAOmC,EAAiBnC,CAC5B,EAEAsC,SAAU,SAAUH,EAAgBnC,GAChC,OAAOmC,EAAiBnC,CAC5B,EAEAuC,QAAS,SAAUJ,EAAgBnC,EAAMC,GACrC,OAAOkC,GAAkBnC,GAAQmC,GAAkBlC,CACvD,EAEAuC,QAAS,SAAUL,EAAgBnC,GAC/B,OAAOmC,GAAkBnC,CAC7B,EAEAyC,WAAY,SAAUN,EAAgBnC,GAClC,OAAOmC,GAAkBnC,CAC7B,EAEA0C,qBAAsB,SAAUP,EAAgBnC,GAC5C,OAAOmC,GAAkBnC,CAC7B,EAEA2C,kBAAmB,SAAUR,EAAgBnC,GACzC,OAAOmC,GAAkBnC,CAC7B,EAEA4C,WAAY,SAAUT,EAAgBnC,EAAMC,GACxC,OAAOkC,EAAiBnC,GAAQmC,EAAiBlC,CACrD,EAEAiC,OAAQ,SAAUC,EAAgBnC,GAC9B,OAAOA,CACX,EAEAjyB,KAAM,SAAUo0B,EAAgBnxC,GAC5B,OAAOA,EAAK+G,QAAQoqC,IAAmB,CAC3C,GAGJtC,GAAU1M,WAAaA,GAE3B,SAAU1sC,GAIN,IAgBIo8C,EAhBAriC,EAAW/Z,EAAMsN,YAAYyM,SAC7BlB,EAAW7Y,EAAMsN,YAAYuL,SAC7B6kB,EAAU19B,EAAMsN,YAAYowB,QAC5B7gB,EAAQ7c,EAAMsN,YAAYuP,MAe1Bw/B,EAAYr8C,EAAM0B,MAAMvB,OAAO,CAC/BC,KAAM,SAAS2O,GACXhP,KAAKqP,OAASL,EACdhP,KAAK2Y,UAAY1Y,EAAMsN,YAAYiwB,SAASvuB,aAC5CjP,KAAKmhC,kBAAoBlhC,EAAMsN,YAAYiwB,SAASvuB,aACpDjP,KAAKu8C,YAAct8C,EAAMsN,YAAYiwB,SAASvuB,aAC9CjP,KAAK+hC,mBAAqB9hC,EAAMsN,YAAYiwB,QAChD,EAEAkG,sBAAuB,WACnB,OAAO1jC,KAAK2Y,UAAU+f,QAAQ14B,KAAKgkC,qBAAqB/0B,YAC5D,EAEAutC,+BAAgC,WAC5B,OAAOx8C,KAAKmhC,kBAAkBzI,QAAQ14B,KAAKgkC,qBAAqB/0B,YACpE,EAEAqzB,uBAAwB,WACpB,OAAItiC,KAAKyiC,sBACEziC,KAAKqP,OAAOqO,UAEZ1d,KAAK2Y,UAAU+f,QAAQ14B,KAAKgkC,qBAAqB/0B,YAEhE,EAEA0zB,oBAAqB,WAKjB,OAJK3iC,KAAKyiC,wBACNziC,KAAKgkC,oBAAsBhkC,KAAK2Y,UAAUggB,eAAe34B,KAAKgkC,sBAG3DhkC,KAAKsiC,wBAChB,EAEAO,wBAAyB,WAKrB,OAJK7iC,KAAKyiC,wBACNziC,KAAKgkC,oBAAsBhkC,KAAK2Y,UAAUigB,mBAAmB54B,KAAKgkC,sBAG/DhkC,KAAKsiC,wBAChB,EAEAnrB,WAAY,SAASpI,GAQjB,OAPIA,IACA/O,KAAK+hC,mBAAqBhzB,EAAI2jB,QAC9B1yB,KAAKu8C,YAAcv8C,KAAKqP,OAAOuwB,gBAAgB7wB,EAAIE,cACnDjP,KAAKqP,OAAOoM,MAAM1M,GAClB/O,KAAKqP,OAAOS,cAAc,CAAEqH,YAAY,EAAMwB,WAAW,KAGtD3Y,KAAKu8C,WAChB,EAEAvuC,OAAQ,SAASe,EAAK0tC,EAAUC,EAAkB3yB,GAC9C,GAAIhb,EAAK,CACL,GAAIA,EAAIoP,GAAGne,KAAKmhC,mBACZ,OASJ,GANAnhC,KAAKqP,OAAOstC,cAAc,IAAI7/B,EAAM/N,EAAK/O,KAAKqP,SAE9CrP,KAAKmhC,kBAAoBpyB,EAEzB/O,KAAK2Y,UAAY8jC,GAEQ,IAArBC,EAA4B,CAC5B,GAAI3tC,EAAIwpB,SAIJv4B,KAAKqP,OAAO8zB,kBAAkBp0B,GAAK,SAASq0B,GACxCr0B,EAAMq0B,EAAOvyB,OACjB,IACA7Q,KAAKmX,WAAWpI,OACb,CAEH,GADAA,EAAM/O,KAAK2Y,UAAUma,YACjB/I,GAAQA,EAAK1a,SAAWrP,KAAKqP,QAAU0a,EAAKnS,MAAM,GAAI,CAMtD,IACIrU,EAAGq5C,EAAM7kC,EAAMkC,EAAM+P,EAAS2oB,EAD9B/6B,EAAQmS,EAAKnS,MAGjB,IAAKrU,EAAI,EAAGA,EAAIqU,EAAMvW,WAClBu7C,EAAOhlC,EAAMrU,IACHs5C,eAGV9kC,EAAO6kC,EAAKC,aAAa9kC,KAAK5Q,OAC9B8S,EAAO2iC,EAAKC,aAAa7kC,QAAQ7Q,OAEjC6iB,EAAU,IAAIhQ,EACV,IAAI2jB,EAAQ5lB,EAAKga,MAAO9X,EAAK8X,OAC7B,IAAI4L,EAAQ5lB,EAAKyN,IAAKvL,EAAKuL,OAG/BmtB,EAAS5jC,EAAIspB,UAAUrO,MAER/pB,EAAMsN,YAAY+vB,UAfP/5B,KAoB1BovC,GAAUA,IAAW1yC,EAAMsN,YAAY+vB,UACvCvuB,EAAM4jC,EAEd,CACA3yC,KAAKmX,WAAWpI,EAAI2jB,QACxB,CAEA1yB,KAAKgkC,oBAAsBhkC,KAAK2Y,UAAU/W,OAAS,CACvD,MACI5B,KAAKqP,OAAOS,cAAc,CAAE6I,WAAW,GAE/C,CAEA,OAAO3Y,KAAK2Y,SAChB,EAEA8pB,oBAAqB,WACjB,OAAOziC,KAAKu8C,YAAYp+B,GAAGne,KAAK2Y,UACpC,IAGAmkC,EAAQ78C,EAAME,WAAWC,OAAO,CAChCC,KAAM,WACFJ,EAAME,WAAW6S,UAAU3S,KAAKG,KAAKR,MACrCA,KAAK+8C,QAAQl1C,MAAM7H,KAAM4H,UAC7B,EAGAlH,OAAQ,CACJ,WACA,iBACA,iBACA,iBACA,YACA,eACA,YACA,eACA,UACA,aACA,YACA,eACA,SACA,cACA,YACA,YAGJq8C,QAAS,SAASrnB,EAAUC,EAAatjB,EAAWF,EAAa6qC,EAAcC,EAAaC,GACxFA,EAAmBA,GAAoB,CAAC,EAExCl9C,KAAKotC,kBAAoB,CACrBxE,WAAYsU,EAAiBtU,WAC7BhzB,MAAOsnC,EAAiBtnC,MACxBq3B,WAAYiQ,EAAiBjQ,WAC7BtE,SAAUuU,EAAiBvU,SAC3BK,OAAQkU,EAAiBlU,OACzBC,KAAMiU,EAAiBjU,KACvBt2B,UAAWuqC,EAAiBvqC,UAC5B4B,KAAM2oC,EAAiB3oC,KACvBu0B,cAAeoU,EAAiBpU,cAChCD,UAAWqU,EAAiBrU,WAGhC7oC,KAAKwa,MAAQ,IAAIva,EAAMsN,YAAY4vC,KAAKznB,EAAUrjB,GAClDrS,KAAK0a,SAAW,IAAIza,EAAMsN,YAAY4vC,KAAKxnB,EAAaxjB,GACxDnS,KAAKo9C,cAAgB,IAAIn9C,EAAMsN,YAAYqlB,UAAU,EAAG8C,EAAW,GAAG,GACtE11B,KAAKggC,aAAe,GACpBhgC,KAAKq9C,YAAc,EACnBr9C,KAAKs9C,eAAiB,EACtBt9C,KAAKu9C,iBAAkB,EACvBv9C,KAAKusC,QAAU,KACfvsC,KAAKw9C,gBAAiB,EACtBx9C,KAAKy9C,gBAAkB,KACvBz9C,KAAK89B,MAAQ,IAAI79B,EAAMsN,YAAYmwC,KAAK19C,KAAKwa,MAAOxa,KAAK0a,SAAUgb,EAAUC,EAAaqnB,EAAcC,GACxGj9C,KAAK0d,UAAY1d,KAAK89B,MAAMpD,UAAUz6B,EAAMsN,YAAYgwB,UACxDv9B,KAAK6c,YAAc,IAAI5c,EAAMsN,YAAY8nB,YAAYK,EAAUC,EAAa31B,KAAKotC,mBACjFptC,KAAK29C,QAAU,IAAI19C,EAAMsN,YAAYqwC,OAAO59C,KAAK89B,MAAO99B,KAAK6c,YAAY0Y,YAEzEv1B,KAAK69C,eAAiB,IAAIvB,EAAUt8C,MAEpCA,KAAK89C,eAAiB,IAAIxB,EAAUt8C,MAEpCA,KAAK+9C,mBAAqB,GAC1B/9C,KAAKsR,UAAY,EACrB,EAEAqJ,OAAQ,SAASqjC,EAASC,GACtBD,EAAUvtC,KAAKmK,IAAIojC,EAAS,GAC5BC,EAAUxtC,KAAKmK,IAAIqjC,EAAS,GAC5B,IAAIC,EAAUl+C,KAAKwa,MAAMC,OACrB0jC,EAAUn+C,KAAK0a,SAASD,OACxBujC,EAAUE,GACVl+C,KAAK6N,MAAMmwC,EAAS,EAAGE,EAAUF,EAASG,GAAS19C,QAEnDw9C,EAAUE,GACVn+C,KAAK6N,MAAM,EAAGowC,EAASC,EAASC,EAAUF,GAASx9C,QAEvDT,KAAKwa,MAAM0b,QAAQ8nB,GACnBh+C,KAAK0a,SAASwb,QAAQ+nB,GACtBj+C,KAAK89B,MAAM5H,QAAQ8nB,EAASC,GAC5Bj+C,KAAK6c,YAAYqZ,QAAQ8nB,EAASC,GAClCj+C,KAAK0d,UAAY1d,KAAK89B,MAAMpD,UAAUz6B,EAAMsN,YAAYgwB,UACpDygB,EAAUE,IACVl+C,KAAK6N,MAAMqwC,EAAS,EAAGF,EAAUE,EAASD,GAASx9C,QACnDT,KAAKo9C,cAAcl7C,MAAMg8C,EAASF,EAAU,GAAG,IAE/CC,EAAUE,GACVn+C,KAAK6N,MAAM,EAAGswC,EAASH,EAASC,EAAUE,GAAS19C,QAEvDT,KAAK8P,cAAc,CAAEC,QAAQ,GACjC,EAEAquC,cAAe,SAAS/9B,GACpBrgB,KAAK2a,OAAO3a,KAAKwa,MAAMC,QAAU4F,GAAS,GAAIrgB,KAAK0a,SAASD,OAChE,EAEA4jC,iBAAkB,SAASh+B,GACvBrgB,KAAK2a,OAAO3a,KAAKwa,MAAMC,OAAQza,KAAK0a,SAASD,QAAU4F,GAAS,GACpE,EAEAi+B,iBAAkB,SAASj+B,GACvBrgB,KAAKo+C,gBAAgB/9B,GAAS,GAClC,EAEAk+B,oBAAqB,SAASl+B,GAC1BrgB,KAAKq+C,mBAAmBh+B,GAAS,GACrC,EAEAm+B,eAAgB,SAASzmC,GAErB,IADA,IAAI2d,EAAW3d,EAAK1W,OAAQo9C,EAAW,EAC9B5X,EAAK,EAAGA,EAAK9uB,EAAK1W,SAAUwlC,EAAI,CACrC,IAAInzB,EAAMqE,EAAK8uB,GAIf,GAHiB,MAAbnzB,EAAIhJ,QACJgrB,EAAWjlB,KAAKmK,IAAI8a,EAAUhiB,EAAIhJ,MAAQ,IAE1CgJ,EAAI2D,MAAO,CACXonC,EAAWhuC,KAAKmK,IAAI6jC,EAAU/qC,EAAI2D,MAAMhW,QACxC,IAAK,IAAIylC,EAAK,EAAGA,EAAKpzB,EAAI2D,MAAMhW,SAAUylC,EAAI,CAC1C,IAAIhzB,EAAOJ,EAAI2D,MAAMyvB,GACH,MAAdhzB,EAAKpJ,QACL+zC,EAAWhuC,KAAKmK,IAAI6jC,EAAU3qC,EAAKpJ,MAAQ,GAEnD,CACJ,CACJ,CACA1K,KAAK2a,OAAOlK,KAAKmK,IAAI8a,EAAU11B,KAAKwa,MAAMC,QAC9BhK,KAAKmK,IAAI6jC,EAAUz+C,KAAK0a,SAASD,QACjD,EAEAikC,gBAAiB,WACb,OAAO1+C,KAAK2+C,QAAU3+C,KAAK89C,eAAiB99C,KAAK69C,cACrD,EAEAtuB,UAAW,WAIP,OAHIvvB,KAAK4+C,aACJ5+C,KAAK4+C,WAAa,IAAI3+C,EAAMsN,YAAY8xB,eAAer/B,OAErDA,KAAK4+C,UAChB,EAEAlgC,YAAa,WAKT,OAJI1e,KAAK6+C,eACJ7+C,KAAK6+C,aAAe,IAAI5+C,EAAMsN,YAAYg3B,YAAYvkC,OAGpDA,KAAK6+C,YAChB,EAEA98B,MAAO,SAAS7f,GACZ,OAAKA,GAILlC,KAAK8+C,WAAa58C,EAEXlC,MALIA,KAAK8+C,UAMpB,EAEA5yC,KAAM,WACF,OAAOlM,KAAK+hB,OAChB,EAEArU,UAAW,SAASqxC,EAAU78C,EAAOuM,GACjC,YAAc3B,IAAV5K,EACO68C,KAEPA,EAAS78C,GAEFlC,KAAK8P,cAAcrB,GAElC,EAEAuwC,OAAQ,SAAS9yC,EAAMhK,EAAOuM,GAC1B,YAAc3B,IAAV5K,EACOlC,KAAKkM,IAEZlM,KAAKkM,GAAQhK,EAENlC,KAAK8P,cAAcrB,GAElC,EAEAwwC,eAAgB,SAAS/8C,GACrB,YAAc4K,IAAV5K,EACOlC,KAAKu9C,iBAGhBv9C,KAAKu9C,gBAAkBr7C,EAEhBlC,KACX,EAEA8P,cAAe,SAASrB,GAMpB,OALKzO,KAAKu9C,gBAEC9uC,GAAUA,EAAO8Q,UACxBvf,KAAKk/C,eAAgB,GAFrBl/C,KAAKkB,QAAQ,SAAUuN,GAIpBzO,IACX,EAEA28C,cAAe,SAAS9uC,GACpB7N,KAAKkB,QAAQ,SAAU,CAAE2M,MAAOA,GACpC,EAEAsxC,cAAe,SAASj3B,EAAYlQ,GAC5BhY,KAAKo/C,kBACLp/C,KAAKo/C,iBAAiBl8B,UAG1BljB,KAAKo/C,iBAAmB,IAAIn/C,EAAMsN,YAAY8xC,sBAAsB,CAChEn3B,WAAYA,EACZlZ,MAAOhP,KACPgY,QAASA,IAGbhY,KAAKkoB,WAAaloB,KAAKo/C,iBAAiBl3B,UAC5C,EAEA+c,WAAY,SAASqa,GACjB,IAAIt/C,KAAKkB,QAAQ,aAAc,CAAEwJ,MAAO40C,IAIxC,OAAOt/C,KAAK0N,UAAU1N,KAAK0a,SAASgS,KAAKxd,KAAKlP,KAAK0a,UAAW4kC,EAAa,CAAEvvC,QAAQ,GACzF,EAEAw1B,aAAc,SAAS+Z,GACnB,IAAIt/C,KAAKkB,QAAQ,eAAgB,CAAEwJ,MAAO40C,IAI1C,OAAOt/C,KAAK0N,UAAU1N,KAAK0a,SAAS6kC,OAAOrwC,KAAKlP,KAAK0a,UAAW4kC,EAAa,CAAEvvC,QAAQ,GAC3F,EAEAmzB,eAAgB,SAASoc,GACrB,OAAOt/C,KAAK89B,MAAMpjB,SAAS4pB,OAAOgb,EACtC,EAEAE,WAAY,SAASC,EAAgBC,GACjC,IAAI7hB,EAAO79B,KAAK89B,MACZpI,EAAWmI,EAAKnI,SAEhBiqB,EAAiB9hB,EAAKnD,UAAU+kB,EAAe5uC,SAC/C+uC,EAAqB/hB,EAAKnD,UAAU+kB,EAAellC,aAEnDslC,EAAYF,EAAetqC,IAAMqgB,EAAWiqB,EAAejsC,IAC3DosC,EAAkBF,EAAmBvqC,IAAMqgB,EAAWkqB,EAAmBlsC,IAEzEqsC,EAAcL,EAAUrqC,IAAMqgB,EAAWgqB,EAAUhsC,IAEvD1T,KAAK6c,YAAYZ,KAAK4jC,EAAWC,EAAiBC,EACtD,EAEA/a,sBAAuB,SAAS+V,EAAOnsC,GACnC,IAAIjD,EAAO0wC,EACXA,EAAoBtB,EACpB,IAAIjkB,EAAMloB,IAEV,OADAytC,EAAoB1wC,EACbmrB,CACX,EAEAzX,yBAA0B,SAAS07B,GAC/B,IAAIiF,EAAKhgD,KAAKwN,UACdutC,EAAMjsC,SAAQ,SAASvH,GACnB,IAAqCmD,EAAjCsE,EAAQgxC,EAAGC,YAAY14C,EAAEyH,OACzBzH,aAAatH,EAAMsN,YAAYkH,KAAKuS,QAAQ0lB,UAC5ChiC,EAAQsE,EAAM8uB,MAAMoiB,aAAa34C,GACjCyH,EAAM6N,YAAYyX,IAAI,UAAW5pB,EAAOA,EAAOnD,IAE/CA,aAAatH,EAAMsN,YAAYyT,WAAW2rB,aAC1CjiC,EAAQsE,EAAM8uB,MAAMoiB,aAAa34C,GACjCyH,EAAM6N,YAAYyX,IAAI,aAAc5pB,EAAOA,EAAOnD,GAE1D,GACJ,EAEA44C,kBAAmB,SAAShO,EAAWpgB,EAAO9c,EAAO6yB,GAQjD,GAPA9nC,KAAKggC,aAAe8H,EAAYjR,QAAO,SAASvrB,EAAGyD,GAK/C,OAJAA,EAAMA,EAAIopB,OAAO,KAAM,KAAM,KAAM,KAAmB,OAAbga,EAAoBpgB,EAAO9c,cACjD+E,GACf1O,EAAE3K,KAAKoO,GAEJzD,CACX,GAAG,IACCtL,KAAKwN,UAAW,CAChB,IAAI0kC,EAAgBlyC,KAAK+hB,QACzB/hB,KAAKwN,UAAU4yC,QAAQtxC,SAAQ,SAASE,GACpCA,EAAM07B,cAAa,SAASzU,GACxB,IAAInvB,EAAOmvB,EAAQkC,OAAO+Z,EAAeC,EAAWpgB,EAAO9c,GACvDnO,GAAQu1C,GAMRA,EAAkB17C,KAAKmG,EAE/B,IAEAkI,EAAMqxC,iBAAgB,SAASr/B,GAC3B,IAAIla,EAAOka,EAAWmX,OAAO+Z,EAAeC,EAAWpgB,EAAO9c,GAC1DnO,GAAQu1C,GACRA,EAAkB17C,KAAKmG,EAE/B,GACJ,IACA9G,KAAKwN,UAAU8yC,YAAYpO,EAA4B,OAAbC,EAAoBpgB,EAAO9c,EACzE,CACA,IAAI0D,EAAY3Y,KAAKgO,UACrB2K,EAAYA,EAAUwf,OAAO,KAAM,KAAM,KAAM,KAAmB,OAAbga,EAAoBpgB,EAAO9c,MAC9DhV,EAAMsN,YAAY+vB,SAChCt9B,KAAKgO,OAAO2K,IAGQ,OAAbw5B,EAAqBnyC,KAAK0a,SAAW1a,KAAKwa,OAChD2d,OAAOpG,EAAO9c,GAEF,OAAbk9B,IACIl9B,EAAQ,EACRjV,KAAKo9C,cAAcnhC,KAAK8V,EAAQ9c,EAAOjV,KAAKwa,MAAMC,OAAS,EAAGsX,IAE9D/xB,KAAKo9C,cAAcnhC,KAAK8V,EAAO/xB,KAAKwa,MAAMC,OAAQsX,EAAQ9c,GAC1DjV,KAAKo9C,cAAcl7C,MAAM6vB,EAAOA,EAAQ9c,EAAQ,GAAG,KAK3DjV,KAAKsR,UAAUxC,SAAQ,SAASS,GACxBA,EAAQqB,cACRrB,EAAQqB,YAAcrB,EAAQqB,YAAYunB,OAAO,KAAM,KAAM,KAAM,KACL,OAAbga,EAAoBpgB,EAAO9c,GAEpF,GACJ,EAEAy1B,aAAc,SAAS97B,GACnB,IACI0Q,EADQtf,KAAK6c,YACIpa,IAAI,WAAW0E,SAChCF,EAAIqY,EAASje,OACjBie,EAASxQ,SAAQ,SAASvH,EAAGhE,GACzBqL,EAASpO,KAAKR,KAAMuH,EAAErF,MAAOqB,EAAG0D,EACpC,GAAGjH,KACP,EAEAqgD,gBAAiB,SAASzxC,GACV5O,KAAK6c,YACXpa,IAAI,cAAc0E,SAAS2H,SAAQ,SAAStI,GAC9CoI,EAASpO,KAAKR,KAAMwG,EAAEtE,MAC1B,GAAGlC,KACP,EAEA6f,UAAW,SAASzE,EAAUmlC,GAC1B,IAAIvgD,KAAKkB,QAAQ,YAAa,CAAEwJ,MAAO0Q,IAoDvC,OAhDApb,KAAKmV,OAAM,WACPnV,KAAKo+C,gBAEL,IAAIvgB,EAAO79B,KAAK89B,MACZnI,EAAckI,EAAKlI,YACnBD,EAAWmI,EAAKnI,SAEpB,GAAIta,EAAW,GAAKsa,EAApB,CAKA,IAAI5d,EAAa9X,KAAK8X,aAElBsD,EAAWtD,GACX9X,KAAK8X,WAAWA,EAAa,GAKjC,IAFA,IAAIgwB,EAAc9nC,KAAKggC,aAAal/B,QAE3BgmC,EAAK,EAAGA,EAAKnR,EAAamR,IAAM,CACrC,IAAI/3B,EAAM,IAAIiL,EAAS,IAAI2jB,EAAQviB,EAAU0rB,GAAK,IAAInJ,EAAQviB,EAAU0rB,IAEpEj2B,EAAUgtB,EAAKnD,UAAU3rB,EAAI8B,SAC7B0J,EAAcsjB,EAAKnD,UAAU3rB,EAAIwL,aAEjCimC,EAAU,IAAIxmC,EACd,IAAI2jB,EAAQ9sB,EAAQ6C,IAAK7C,EAAQwE,KACjC,IAAIsoB,EAAQjI,EAAW,EAAGnb,EAAYlF,MAG1CrV,KAAKw/C,WAAWgB,EAAS,IAAI7iB,EAAQ9sB,EAAQ6C,IAAM,EAAG7C,EAAQwE,MAE9D,IAAIyH,EAAM/N,EAAK/O,MAAMS,MAAM,CAAE8qC,UAAU,EAAMG,aAAa,GAC9D,CAEA1rC,KAAKmgD,kBAAkB,MAAO/kC,EAAU,EAAG0sB,EA1B3C,CA2BJ,GAAG,CACC7wB,QAAQ,EACRlH,QAAQ,EACR8P,UAAW,CAAEnV,MAAO0Q,GACpBrM,IAAK,IAAIiL,EAAS,IAAI2jB,EAAQviB,EAAU,GAAI,IAAIuiB,EAAQje,IAAUA,QAGjE6gC,GACDvgD,KAAKkB,QAAQ,iBAAkB,CAAEwJ,MAAO0Q,IAGrCpb,IACX,EAEAygD,aAAc,SAASrlC,GACnB,IAAIrM,EAAM,IAAIiL,EAAS,IAAI2jB,EAAQviB,EAAU,GAAI,IAAIuiB,EAAQviB,EAAUpb,KAAK89B,MAAMnI,cAClF,OAAO,IAAI7Y,EAAM/N,EAAK/O,MAAMkT,QAChC,EAEA4N,UAAW,SAAS1F,EAAUslC,GAC1B,OAAK1gD,KAAKygD,aAAarlC,GAInBpb,KAAKkB,QAAQ,YAAa,CAAEwJ,MAAO0Q,SAAvC,GAIApb,KAAKmV,OAAM,WACP,IAAI0oB,EAAO79B,KAAK89B,MACZnI,EAAckI,EAAKlI,YAEnB7d,EAAa9X,KAAK8X,aAClBsD,EAAWtD,GACX9X,KAAK8X,WAAWA,EAAa,GAKjC,IAFA,IAAIgwB,EAAc9nC,KAAKggC,aAAal/B,QAE3BgmC,EAAK,EAAGA,EAAKnR,EAAamR,IAAM,CACrC,IAAI/3B,EAAM,IAAIiL,EAAS,IAAI2jB,EAAQviB,EAAU0rB,GAAK,IAAInJ,EAAQviB,EAAU0rB,IAExE,IAAIhqB,EAAM/N,EAAK/O,MAAMS,MAAM,CAAE8qC,UAAU,EAAMG,aAAa,IAE1D,IAAI76B,EAAUgtB,EAAKnD,UAAU3rB,EAAI8B,SAC7B0J,EAAcsjB,EAAKnD,UAAU3rB,EAAIwL,aAEjCimC,EAAU,IAAIxmC,EACd,IAAI2jB,EAAQ9sB,EAAQ6C,IAAM,EAAG7C,EAAQwE,KACrC,IAAIsoB,EAAQje,IAAUnF,EAAYlF,MAGtCrV,KAAKw/C,WAAWgB,EAAS3vC,GAEzB,IAAI+uC,EAAqB/hB,EAAKnD,UAAU8lB,EAAQjmC,aAEhD,IAAIuC,EAAM,IAAI9C,EAAS4lC,EAAoBA,GAAqB5/C,MAAMS,OAC1E,CAEAT,KAAKmgD,kBAAkB,MAAO/kC,GAAW,EAAG0sB,GAE5C9nC,KAAKs+C,kBACT,GAAG,CACCrnC,QAAQ,EACRlH,QAAQ,EACR+Q,UAAW,CAAEpW,MAAO0Q,GACpBrM,IAAK,IAAIiL,EAAS,IAAI2jB,EAAQviB,EAAU,GAAI,IAAIuiB,EAAQje,IAAUA,QAGjEghC,GACD1gD,KAAKkB,QAAQ,iBAAkB,CAAEwJ,MAAO0Q,IAGrCpb,MApDIA,IAqDf,EAEAkgB,aAAc,SAASo/B,GACnB,IAAIt/C,KAAKkB,QAAQ,eAAgB,CAAEwJ,MAAO40C,IAmD1C,OA/CAt/C,KAAKmV,OAAM,WACPnV,KAAKq+C,mBAEL,IAAIxgB,EAAO79B,KAAK89B,MACZnI,EAAckI,EAAKlI,YAEvB,GAAI2pB,EAAc,GAAK3pB,EAAvB,CAKA,IAAI9d,EAAgB7X,KAAK6X,gBAErBynC,EAAcznC,GACd7X,KAAK6X,cAAcA,EAAgB,GAKvC,IAFA,IAAIiwB,EAAc9nC,KAAKggC,aAAal/B,QAE3BgmC,EAAKnR,EAAamR,GAAMwY,EAAaxY,IAAM,CAChD,IAAI/3B,EAAM,IAAIiL,EAAS,IAAI2jB,EAAQ,EAAGmJ,GAAK,IAAInJ,EAAQje,IAAUonB,IAIjE,GAFA,IAAIhqB,EAAM/N,EAAK/O,MAAMS,MAAM,CAAE8qC,UAAU,EAAMG,aAAa,IAEtD5E,GAAMwY,EACN,MAGJ,IAAIzuC,EAAUgtB,EAAKnD,UAAU3rB,EAAI8B,SAC7B0J,EAAcsjB,EAAKnD,UAAU3rB,EAAIwL,aAEjCimC,EAAU,IAAIxmC,EACd,IAAI2jB,EAAQ9sB,EAAQ6C,IAAK7C,EAAQwE,IAAM,GACvC,IAAIsoB,EAAQpjB,EAAY7G,IAAK6G,EAAYlF,IAAM,IAGnDrV,KAAKw/C,WAAWgB,EAAS3vC,EAC7B,CAEA7Q,KAAKmgD,kBAAkB,MAAOb,EAAa,EAAGxX,EA9B9C,CA+BJ,GAAG,CACC7wB,QAAQ,EACRlH,QAAQ,EACRmQ,aAAc,CAAExV,MAAO40C,GACvBvwC,IAAK,IAAIiL,EAAS,IAAI2jB,EAAQ,EAAG2hB,GAAc,IAAI3hB,EAAQje,IAAUA,QAGlE1f,IACX,EAEA2gD,gBAAiB,SAASrB,GACtB,IAAIvwC,EAAM,IAAIiL,EAAS,IAAI2jB,EAAQ,EAAG2hB,GAAc,IAAI3hB,EAAQje,IAAU4/B,IAC1E,OAAO,IAAIxiC,EAAM/N,EAAK/O,MAAMkT,QAChC,EAEAwN,aAAc,SAAS4+B,GACnB,OAAKt/C,KAAK2gD,gBAAgBrB,GAItBt/C,KAAKkB,QAAQ,eAAgB,CAAEwJ,MAAO40C,SAA1C,GAIAt/C,KAAKmV,OAAM,WACP,IAAI0oB,EAAO79B,KAAK89B,MACZnI,EAAckI,EAAKlI,YAEnB9d,EAAgB7X,KAAK6X,gBAErBynC,EAAcznC,GACd7X,KAAK6X,cAAcA,EAAgB,GAKvC,IAFA,IAAIiwB,EAAc9nC,KAAKggC,aAAal/B,QAE3BgmC,EAAKwY,EAAaxY,EAAKnR,EAAamR,IAAM,CAC/C,IAAI/3B,EAAM,IAAIiL,EAAS,IAAI2jB,EAAQ,EAAGmJ,GAAK,IAAInJ,EAAQje,IAAUonB,IAIjE,GAFA,IAAIhqB,EAAM/N,EAAK/O,MAAMS,MAAM,CAAE8qC,UAAU,EAAMG,aAAa,IAEtD5E,GAAMnR,EAAc,EACpB,MAGJ,IAAI9kB,EAAUgtB,EAAKnD,UAAU3rB,EAAI8B,SAC7B0J,EAAcsjB,EAAKnD,UAAU3rB,EAAIwL,aAEjCimC,EAAU,IAAIxmC,EACd,IAAI2jB,EAAQ9sB,EAAQ6C,IAAK7C,EAAQwE,IAAM,GACvC,IAAIsoB,EAAQpjB,EAAY7G,IAAK6G,EAAYlF,IAAM,IAGnDrV,KAAKw/C,WAAWgB,EAAS3vC,EAC7B,CAEA7Q,KAAKmgD,kBAAkB,MAAOb,GAAc,EAAGxX,GAE/C9nC,KAAKu+C,qBACT,GAAG,CACCtnC,QAAQ,EACRlH,QAAQ,EACR2Q,aAAc,CAAEhW,MAAO40C,GACvBvwC,IAAK,IAAIiL,EAAS,IAAI2jB,EAAQ,EAAG2hB,GAAc,IAAI3hB,EAAQje,IAAUA,QAGlE1f,MAjDIA,IAkDf,EAEA4gD,WAAY,SAASxlC,GACjBpb,KAAKwa,MAAMkS,KAAKtR,GAChBpb,KAAKo9C,cAAcl7C,MAAMkZ,EAAUA,GAAU,GAC7Cpb,KAAK8P,cAAc,CAAEC,QAAQ,GACjC,EAEAq1B,QAAS,SAAShqB,GACd,IAAIpb,KAAKkB,QAAQ,UAAW,CAAEwJ,MAAO0Q,IAGrC,OAAOpb,KAAK0N,UAAU1N,KAAKwa,MAAMkS,KAAKxd,KAAKlP,KAAKwa,OAAQY,EAAU,CAAErL,QAAQ,GAChF,EAEAy1B,UAAW,SAASpqB,GAChB,IAAIpb,KAAKkB,QAAQ,YAAa,CAAEwJ,MAAO0Q,IAGvC,OAAOpb,KAAK0N,UAAU1N,KAAKwa,MAAM+kC,OAAOrwC,KAAKlP,KAAKwa,OAAQY,EAAU,CAAErL,QAAQ,GAClF,EAEAkzB,YAAa,SAAS7nB,GAClB,OAAOpb,KAAK89B,MAAMtjB,MAAM8pB,OAAOlpB,EACnC,EAEAiwB,cAAe,SAASjwB,GACpB,OAAOpb,KAAKo9C,cAAcl7C,MAAMkZ,EACpC,EAEAjJ,YAAa,SAASmtC,EAAan7C,GAC/B,OAAOnE,KAAK0N,UAAU1N,KAAK0a,SAASxY,MAAMgN,KAAKlP,KAAK0a,SAAU4kC,EAAaA,GAAcn7C,EAAO,CAAE4L,QAAQ,GAC9G,EAEAsC,UAAW,SAAS+I,EAAUhX,GAC1B,OAAOpE,KAAK0N,UAAU1N,KAAKwa,MAAMtY,MAAMgN,KAAKlP,KAAKwa,MAAOY,EAAUA,GAAWhX,EAAQ,CAAE2L,QAAQ,GACnG,EAEA+H,WAAY,SAAS5V,GACjB,OAAOlC,KAAKg/C,OAAO,cAAe98C,EAAO,CAAE6N,QAAQ,GACvD,EAEA8H,cAAe,SAAS3V,GACpB,OAAOlC,KAAKg/C,OAAO,iBAAkB98C,EAAO,CAAE6N,QAAQ,GAC1D,EAEA+C,cAAe,SAAS5Q,GACpB,OAAOlC,KAAKg/C,OAAO,iBAAkB98C,EAAO,CAAE6N,QAAQ,GAC1D,EAEA8wC,eAAgB,SAAS3+C,GACrB,OAAOlC,KAAKg/C,OAAO,kBAAmB98C,EAAO,CAAE6N,QAAQ,GAC3D,EAEAlB,KAAM,SAAS6E,EAAK4J,EAAQwjC,EAASC,GACjC,IAAIhyC,EAAM,KAEV,OAAI2E,aAAezT,EAAMsN,YAAYkwB,IAC1B/pB,EAGPA,aAAezT,EAAMsN,YAAYuP,MAC1BpJ,EAAI7E,KAAKI,cAGD,iBAARyE,EACP3E,EAAM9O,EAAMsN,YAAYkH,KAAKusC,eAAettC,IAEvCotC,IACDA,EAAU,GAGTC,IACDA,EAAa,GAEjBhyC,EAAM,IAAIiL,EAAS,IAAI2jB,EAAQjqB,EAAK4J,GAAS,IAAIqgB,EAAQjqB,EAAMotC,EAAU,EAAGxjC,EAASyjC,EAAa,KAG/FhyC,EACX,EAEAlB,MAAO,SAAS6F,EAAK4J,EAAQwjC,EAASC,GAClC,OAAO,IAAIjkC,EAAM9c,KAAK6O,KAAK6E,EAAK4J,EAAQwjC,EAASC,GAAa/gD,KAClE,EAEA8rC,gBAAiB,SAASj+B,GACtB,IAAIgwB,EAAO79B,KAAK89B,MACZiO,EAAU,CAAC,EACXC,EAAY,CAAC,EACbE,GAAY,EAehB,OAbAlsC,KAAKmjC,kBAAkBt1B,GAAO,SAASkB,GACnC,IAAI8B,EAAU9B,EAAI8B,QAClBgtB,EAAK/uB,QAAQC,GAAK,SAASkyC,GACnBpwC,EAAQsN,GAAG8iC,IACXlV,EAAQkV,EAAQxzB,SAAW1e,EAC3Bm9B,GAAY,GACLr+B,EAAMgtB,SAASomB,KACtBjV,EAAUiV,EAAQxzB,SAAW5c,EAC7Bq7B,GAAY,EAEpB,GACJ,IAEO,CAAEH,QAASA,EAASC,UAAWA,EAAWE,UAAWA,EAChE,EAEA/I,kBAAmB,SAASp0B,EAAKH,GAC7B,IAAIsxB,GAAY,OAEQ,IAAbtxB,IACPA,EAAWG,EACXmxB,GAAY,GAGhBlgC,KAAKggC,aAAalxB,SAAQ,SAASs0B,IAC3BlD,GAAakD,EAAOjR,WAAWpjB,KAC/BH,EAASw0B,EAEjB,GACJ,EAEA8d,oBAAqB,SAASnyC,EAAKH,GAC/B,IAAIsxB,GAAY,EAOhB,QALwB,IAAbtxB,IACPA,EAAWG,EACXmxB,GAAY,GAGZlgC,KAAKusC,QAAS,CACd,IAAI/4B,EAAO,GAGXxT,KAAKusC,QAAQx9B,IAAI0I,eAAc,SAAS0pC,IAChCjhB,GAAaihB,EAAUhvB,WAAWpjB,KAClCyE,EAAK7S,KAAKwgD,EAAUtwC,QAE5B,IAGA7Q,KAAKggC,aAAalxB,SAAQ,SAASs0B,GAC/B5vB,EAAOA,EAAKrR,KAAI,SAAS4M,GACrB,OAAIq0B,EAAOjR,WAAWpjB,GACXq0B,EAGJr0B,CACX,GACJ,IAGAyE,EAAKqjB,QAAO,SAAgB9wB,EAAQqY,GAKhC,OAJIrY,EAAOwL,QAAQ6M,GAAW,GAC1BrY,EAAOpF,KAAKyd,GAGTrY,CACX,GAAG,IAAI+I,QAAQF,EACnB,CACJ,EAEAE,QAAS,SAASC,EAAKH,GACnB,IAAI/O,EAAOG,KACX,SAASohD,EAAaryC,GACZA,aAAeiL,IACjBjL,EAAMA,EAAIE,cAEd,IAEI63B,EAAID,EAFJh2B,EAAUhR,EAAKi+B,MAAMpD,UAAU3rB,EAAI8B,SACnC0J,EAAc1a,EAAKi+B,MAAMpD,UAAU3rB,EAAIwL,aAG3C,SAAS8mC,EAAKn/C,GACV0M,EAASi4B,IAAMC,EAAI5kC,EACvB,CAEA,IAAK4kC,EAAKj2B,EAAQwE,IAAKyxB,GAAMvsB,EAAYlF,IAAKyxB,IAAM,CAChDD,EAAKh2B,EAAQ6C,IACb,IAAI4tC,EAAiBzhD,EAAKi+B,MAAMpzB,MAAMm8B,EAAIC,GACtCya,EAAe1hD,EAAKi+B,MAAMpzB,MAAM6P,EAAY7G,IAAKozB,GACrDjnC,EAAKgd,YAAY/N,QAAQwyC,EAAgBC,EAAcF,EAC3D,CACJ,CAEMtyC,aAAeiL,IACjBjL,EAAMlP,EAAKgP,KAAKE,IAGhBA,aAAe+J,EAIf/J,EAAID,QAAQsyC,GAEZA,EAAaryC,EAErB,EAEAyyC,cAAe,SAASC,GACpBzhD,KAAK0hD,iBAAmBD,EACxBzhD,KAAK2hD,mBAAoB,CAC7B,EAEAlhB,cAAe,WACXzgC,KAAK4hD,qBAAsB,EAC3B,IAAIjpC,EAAY3Y,KAAKgO,SACrBhO,KAAKsjC,gBAAkB3qB,EACvB3Y,KAAK6hD,cAAgBlpC,EACrB3Y,KAAK8P,cAAc,CAAE6I,WAAW,GACpC,EAEA8qB,eAAgB,SAAS7mB,EAAM2mB,EAAOF,EAAMrC,GACxChhC,KAAK6hD,cAAgBjlC,EACrB5c,KAAK8hD,eAAiBve,EACtBvjC,KAAK+hD,cAAgB1e,EACrBrjC,KAAKgiD,mBAAqBhhB,EAC1BhhC,KAAK8P,cAAc,CAAE6I,WAAW,GACpC,EAEAspC,YAAa,WACT,OAAOjiD,KAAK6hD,aAChB,EAEAK,cAAe,WACX,OAAOliD,KAAK8hD,cAChB,EAEAK,mBAAoB,WAChB,OAAOniD,KAAK4hD,mBAChB,EAEAQ,mBAAoB,WAChB,OAAOpiD,KAAK2hD,iBAChB,EAEAU,mBAAoB,WAChB,OAAOriD,KAAKsiD,mBAChB,EAEAC,iBAAkB,WACd,GAAIviD,KAAK2hD,kBAAmB,CACxB3hD,KAAK2hD,mBAAoB,EACzB,IAAIa,EAAexiD,KAAKyiD,qBAExB,GAAIziD,KAAK0hD,kBAAoBc,EAAc,CACvC,IAAIE,EAAiB1iD,KAAK2iD,uBACtBD,EAAertC,OAASqK,IACxB1f,KAAKkB,QAAQ,iBAAkB,CAC3BN,QAAS,qBACTN,QAAS,CACL0R,OAAQ0wC,EAAertC,IACvBnT,MAAOlC,KAAKmS,YAAYuwC,EAAertC,MAAQrV,KAAK0hD,iBAAiBj7C,EAAI+7C,EAAa/7C,MAI9FzG,KAAKkB,QAAQ,iBAAkB,CAC3BN,QAAS,mBACTN,QAAS,CACL0R,OAAQ0wC,EAAehvC,IACvBxR,MAAOlC,KAAKqS,UAAUqwC,EAAehvC,MAAQ1T,KAAK0hD,iBAAiB5wB,EAAI0xB,EAAa1xB,KAIpG,MACI9wB,KAAKkB,QAAQ,SAAU,CAAEyZ,QAAQ,GAEzC,CACJ,EAEAioC,aAAc,SAAS7zC,GAEnB,IADA,IAAIq0B,EAASpjC,KAAKggC,aACTz8B,EAAI6/B,EAAO/hC,SAAUkC,GAAK,GAC/B,GAAI6/B,EAAO7/B,GAAG4uB,WAAWpjB,GACrB,OAAO/O,KAAK6N,MAAMu1B,EAAO7/B,IAGjC,OAAOvD,KAAK6N,MAAMkB,EACtB,EAEA8zC,eAAgB,SAAS9zC,GACrB,IAAI+zC,EAAU,KACd,GAAI/zC,EAAK,CACL,IAAIlB,EAAQ7N,KAAK4iD,aAAa7zC,GAC9B+zC,EAAUj1C,EAAMi1C,UAChB/zC,EAAMlB,EAAMgB,KAAKI,aAAa4B,OAClC,CACIiyC,EACK9iD,KAAK+iD,aAAgBh0C,EAAIoP,GAAGne,KAAK+iD,eAClC/iD,KAAK+iD,YAAch0C,EACnB/O,KAAKkB,QAAQ,SAAU,CAAE4hD,SAAS,KAGlC9iD,KAAK+iD,cACL/iD,KAAK+iD,YAAc,KACnB/iD,KAAKkB,QAAQ,SAAU,CAAE4hD,SAAS,IAG9C,EAEAH,qBAAsB,WAClB,OAAO3iD,KAAKgjD,qBAChB,EAEAP,mBAAoB,SAASQ,GAKzB,YAJiBn2C,IAAbm2C,IACAjjD,KAAKkjD,oBAAsBD,EAC3BjjD,KAAKkB,QAAQ,SAAU,CAAEyZ,QAAQ,EAAMwoC,aAAa,KAEjDnjD,KAAKkjD,mBAChB,EAEAE,mBAAoB,WACZpjD,KAAKgjD,wBACLhjD,KAAKkjD,yBAAsBp2C,EAC3B9M,KAAKgjD,2BAAwBl2C,EAC7B9M,KAAK0hD,sBAAmB50C,EACxB9M,KAAKkB,QAAQ,SAAU,CAAEyZ,QAAQ,EAAMwoC,aAAa,IAE5D,EAEAE,qBAAsB,SAASt0C,GAC3B/O,KAAKgjD,sBAAwBj0C,EAC7B/O,KAAKkB,QAAQ,SAAU,CAAEyZ,QAAQ,EAAMwoC,aAAa,GACxD,EAEAG,cAAe,SAAS94C,GACpBxK,KAAKsiD,oBAAsB93C,CAC/B,EAEA+4C,iBAAkB,WACd,IAAIC,EAAOxjD,KAAKsiD,oBAChB,GAAIkB,EAAM,CACNxjD,KAAKsiD,oBAAsB,KAC3B,IAAI/yC,EAAUi0C,EAAKj0C,QACnB,GAAIA,EAAQ4O,GAAGqlC,EAAKvnC,MAChB,OAEJ,GAAI1M,EAAQqB,YAAa,CAGrB,IAAInM,EAAMzE,KAAKyjD,mBAAmBl0C,GAC9BmE,EAAM1T,KAAKwa,MAAMkpC,aAAaj/C,EAAIsb,KAClC1K,EAAMrV,KAAK0a,SAASgpC,aAAaj/C,EAAIgb,MACrC1Q,EAAM,IAAI4uB,EAAQjqB,EAAK2B,GACvBsuC,EAAS3jD,KAAK4jD,eAAe70C,GACjCQ,EAAQuB,QAAUrM,EAAIgb,KAAOkkC,EAAOlkC,KACpClQ,EAAQwB,QAAUtM,EAAIsb,IAAM4jC,EAAO5jC,IACnCxQ,EAAQqB,YAAc7B,EACtB/O,KAAK8P,cAAc,CAAE+zC,UAAU,GACnC,CACA7jD,KAAKkB,QAAQ,iBAAkB,CAC3BN,QAAS,uBACTN,QAAS,CACL0O,MAAWhP,KACXuP,QAAWA,EACXI,SAAW6zC,EAAKvnC,OAG5B,CACJ,EAEAukB,eAAgB,SAASzW,GACjB/pB,KAAK8X,cAAgB9X,KAAK6X,gBAC1B7X,KAAK68C,aAAe,KACb9yB,GAAQA,EAAK1a,SAAWrP,OAC/BA,KAAK68C,aAAe9yB,GAExB/pB,KAAK8jD,sBAAuB,CAChC,EAEApjB,kBAAmB,WAMf,GALI1gC,KAAK8jD,uBACL9jD,KAAK8jD,sBAAuB,EAC5B9jD,KAAKkjD,yBAAsBp2C,EAC3B9M,KAAKkB,QAAQ,SAAU,CAAEyX,WAAW,KAEpC3Y,KAAK4hD,oBAAqB,CAC1B5hD,KAAK4hD,qBAAsB,EAC3B,IAAIhlC,EAAO5c,KAAK6hD,cACZvlC,EAAStc,KAAKsjC,gBAEdtjC,KAAK8hD,eACL9hD,KAAKkB,QAAQ,iBAAkB,CAC3BN,QAAS,sBAAuBN,QAAS,CAAEyjD,eAAgB/jD,KAAK6N,MAAM7N,KAAK8hD,mBAG1EllC,EAAKuB,GAAG7B,GAKTtc,KAAK8P,cAAc,CAAE6I,WAAW,IAJhC3Y,KAAKkB,QAAQ,iBAAkB,CAC3BN,QAAS,kBAAmBN,QAAS,CAAEyjD,eAAgB/jD,KAAK6N,MAAM+O,GAAON,OAAQtc,KAAK6N,MAAMyO,MAOxGtc,KAAK6hD,cAAgB,KACrB7hD,KAAK8hD,eAAiB,KACtB9hD,KAAKsjC,gBAAkB,KAEvBtjC,KAAKgO,OAAO4O,EAChB,CACJ,EAEAonC,oBAAqB,WACjB,OAAOhkD,KAAK8jD,oBAChB,EAEA91C,OAAQ,SAASe,EAAK2tC,GAClB,IAEIuH,EAFAC,EAAiBlkD,KAAK0+C,kBAU1B,OANI3vC,IACAA,EAAM/O,KAAK6O,KAAKE,GAChBA,EAAM/O,KAAK89B,MAAMpD,UAAU3rB,GAC3Bk1C,EAAcjkD,KAAK89B,MAAMqmB,OAAOp1C,GAAOA,EAAM/O,KAAK4/B,gBAAgB7wB,IAG/Dm1C,EAAel2C,OAAOe,EAAKk1C,EAAavH,EAAkB18C,KAAK68C,aAC1E,EAEA9Y,eAAgB,WACZ,OAAO/jC,KAAK0+C,kBAAkBvd,iBAClC,EAEAuC,sBAAuB,WACnB,OAAO1jC,KAAK0+C,kBAAkBhb,uBAClC,EAEAtC,8BAA+B,WAC3B,OAAOphC,KAAK0+C,kBAAkBlC,gCAClC,EAEAla,uBAAwB,WACpB,OAAOtiC,KAAK0+C,kBAAkBpc,wBAClC,EAEAK,oBAAqB,WACjB,OAAO3iC,KAAK0+C,kBAAkB/b,qBAClC,EAEAE,wBAAyB,WACrB,OAAO7iC,KAAK0+C,kBAAkB7b,yBAClC,EAEAmB,oBAAqB,WACjB,OAAOhkC,KAAK0+C,kBAAkB1a,mBAClC,EAEA7sB,WAAY,SAASpI,GACjB,OAAO/O,KAAK0+C,kBAAkBvnC,WAAWpI,EAC7C,EAEAgzB,mBAAoB,WAChB,OAAO/hC,KAAK0+C,kBAAkB3c,kBAClC,EAEAU,oBAAqB,WACjB,OAAOziC,KAAK0+C,kBAAkBjc,qBAClC,EAEA7C,gBAAiB,SAAS7wB,GACtB,IAAI+4B,EAAc9nC,KAAKggC,aAEvB,OAAOjxB,EAAI5M,KAAI,SAAS4M,GACpB,OAAOA,EAAIE,aAAautB,MAAMsL,EAClC,GACJ,EAEAsc,KAAM,SAASr1C,GACX,IAAIs1C,EAAQ,GACRxmB,EAAO79B,KAAK89B,MAIhB,OAHA99B,KAAK6c,YAAYsa,iBAAgB,SAASxpB,GACtC02C,EAAM1jD,KAAKk9B,EAAKumB,KAAKr1C,EAAKpB,EAAS4Z,MACvC,IACOvnB,KAAK4/B,gBAAgB7wB,EAAI8B,QAAQ5B,aAAautB,MAAM6nB,GAC/D,EAEA5oC,MAAO,SAAS1M,GACZ,IAAIA,EAEG,CACH,IAAI0M,EAAQzb,KAAKukB,OAEjB,OADAvkB,KAAKukB,OAAS,KACP9I,CACX,CALIzb,KAAKukB,OAASxV,EAAIE,YAM1B,EAEAiF,oBAAqB,WACjB,OAAO,IAAI4I,EAAM9c,KAAK89B,MAAMpD,UAAU16B,KAAKmX,cAAenX,KAC9D,EAEA2Y,UAAW,WACP,OAAO,IAAImE,EAAM9c,KAAK89B,MAAMpD,UAAU16B,KAAK0+C,kBAAkB/lC,WAAY3Y,KAC7E,EAEAskD,gBAAiB,WACb,IAAI3rC,EAAY3Y,KAAKgO,SAEjB+J,EAAO,CAAC,EACRkC,EAAO,CAAC,EACRsqC,GAAU,EACVC,GAAU,EACVC,EAASzkD,KAAK89B,MAAMpI,SAAW,EAC/BgvB,EAAS1kD,KAAK89B,MAAMnI,YAAc,EAyCtC,OAvCAhd,EAAU7J,SAAQ,SAASC,GACvB,IAAIxL,EACAohD,EAAW,UACXC,EAAW,UAGXrqC,GAFJxL,EAAMA,EAAIE,cAEYsL,YAClB1J,EAAU9B,EAAI8B,QAEdg0C,EAAeh0C,EAAQwE,KAAO,GAAKkF,EAAYlF,KAAOqvC,EACtDI,EAAej0C,EAAQ6C,KAAO,GAAK6G,EAAY7G,KAAO+wC,EAY1D,GAVIK,IACAN,GAAU,EACVI,EAAW,QAGXC,IACAN,GAAU,EACVI,EAAW,SAGVG,EACD,IAAKvhD,EAAIsN,EAAQ6C,IAAKnQ,GAAKgX,EAAY7G,IAAKnQ,IACxB,SAAZwU,EAAKxU,KACLwU,EAAKxU,GAAKohD,GAKtB,IAAKE,EACD,IAAKthD,EAAIsN,EAAQwE,IAAK9R,GAAKgX,EAAYlF,IAAK9R,IACxB,SAAZ0W,EAAK1W,KACL0W,EAAK1W,GAAKqhD,EAI1B,IAEO,CACH7sC,KAAMA,EACNkC,KAAMA,EACNuqC,QAASA,EACTD,QAASA,EACTQ,IAAKP,GAAWD,EAExB,EAEAta,aAAc,SAAS+a,GACnB,QAAiBl4C,IAAbk4C,EACA,OAAOhlD,KAAK2+C,QAGhB3+C,KAAK2+C,QAAUqG,EAEXA,IACAhlD,KAAK89C,eAAenlC,UAAY3Y,KAAK69C,eAAellC,UAAUlJ,QAC9DzP,KAAK89C,eAAe3c,kBAAoBnhC,KAAK69C,eAAe1c,kBAAkB1xB,QAC9EzP,KAAK89C,eAAevB,YAAcv8C,KAAK69C,eAAetB,YAAY9sC,QAClEzP,KAAK89C,eAAe/b,mBAAqB/hC,KAAK69C,eAAe9b,mBAAmBtyB,QAExF,EAEAw1C,sBAAuB,SAAStsC,GAC5B3Y,KAAK+9C,oBAAsBplC,GAAa,IAAI7X,QAC5Cd,KAAK8P,cAAc,CAAE6I,WAAW,GACpC,EAEAusC,gBAAiB,WACb,OAAOllD,KAAK69C,eAAetB,YAAYttC,YAC3C,EAEA4kB,OAAQ,WACJ,IAAIsxB,EAAY,CAAC,EAEbptC,EAAO/X,KAAKwa,MAAMqZ,OAAO,SAAUsxB,GACnCntC,EAAUhY,KAAK0a,SAASmZ,OAAO,QAAS,CAAC,GACzCuxB,EAAgBplD,KAAK69C,eACrBwH,EAAa,GACbnI,EAAmBl9C,KAAKotC,mBAAqB,CAAC,EAUlDptC,KAAK8O,QAAQ7O,EAAMsN,YAAYgwB,UAAU,SAAS7pB,EAAK2B,EAAKvB,GAGxD,GAXJ,SAA2BA,GACvBrM,OAAO2b,KAAK85B,GAAkBpuC,SAAQ,SAAS7M,GACvC6R,EAAK7R,KAASi7C,EAAiBj7C,WACxB6R,EAAK7R,EAEpB,GACJ,CAGIqjD,CAAkBxxC,GAEe,IAA7BrM,OAAO2b,KAAKtP,GAAMzS,OAAtB,CAIIyS,EAAKtB,MACL6yC,EAAW1kD,KAAK,CACZoO,IAAS9O,EAAMsN,YAAYkwB,IAAI1D,QAAQ,KAAMrmB,EAAK2B,GAClDrD,OAAS8B,EAAKtB,OAItB,IAAIsZ,EAAWq5B,EAAUzxC,QAER5G,IAAbgf,IACAA,EAAW/T,EAAK1W,OAChB0W,EAAKpX,KAAK,CAAE+J,MAAOgJ,IACnByxC,EAAUzxC,GAAOoY,GAGrBpY,EAAMqE,EAAK+T,GAEXhY,EAAKpJ,MAAQ2K,OAEKvI,IAAd4G,EAAI2D,QACJ3D,EAAI2D,MAAQ,IAGZvD,EAAKmiB,UAEDniB,EAAKmiB,QAAQ0U,kBACb72B,EAAKmiB,QAAU,CACXsvB,IAAKzxC,EAAKmiB,QAAQmC,WAClBrpB,IAAK+E,EAAKmiB,QAAQ0U,kBAAkBvS,YAGxCtkB,EAAKmiB,QAAUniB,EAAKmiB,QAAQmC,YAIhCtkB,EAAKkN,aACLlN,EAAKkN,WAAalN,EAAKkN,WAAW6S,UAGlC/f,EAAK8B,QACL9B,EAAK8B,MAAQ3V,EAAMulD,WAAW1xC,EAAK8B,OAAO6vC,SAG1C3xC,EAAK80B,aACL90B,EAAK80B,WAAa3oC,EAAMulD,WAAW1xC,EAAK80B,YAAY6c,SAGpD3xC,EAAK4C,WAAa5C,EAAK4C,UAAUd,QACjC9B,EAAK4C,UAAUd,MAAQ3V,EAAMulD,WAAW1xC,EAAK4C,UAAUd,OAAO6vC,SAG9D3xC,EAAK+C,cAAgB/C,EAAK+C,aAAajB,QACvC9B,EAAK+C,aAAajB,MAAQ3V,EAAMulD,WAAW1xC,EAAK+C,aAAajB,OAAO6vC,SAGpE3xC,EAAKyC,aAAezC,EAAKyC,YAAYX,QACrC9B,EAAKyC,YAAYX,MAAQ3V,EAAMulD,WAAW1xC,EAAKyC,YAAYX,OAAO6vC,SAGlE3xC,EAAKsC,YAActC,EAAKsC,WAAWR,QACnC9B,EAAKsC,WAAWR,MAAQ3V,EAAMulD,WAAW1xC,EAAKsC,WAAWR,OAAO6vC,SAGpE/xC,EAAI2D,MAAM1W,KAAKmT,EAjEf,CAkEJ,IAEA,IAAI4xC,EAAO,CACPx5C,KAAMlM,KAAK+hB,QACXhK,KAAMA,EACNC,QAASA,EACTW,UAAWysC,EAAczsC,UAAUyf,WACnCjhB,WAAYiuC,EAAcjuC,aAAaihB,WACvCtgB,WAAY9X,KAAK8X,aACjBD,cAAe7X,KAAK6X,gBACpB/E,cAAe9S,KAAK8S,gBACpB+tC,eAAgB7gD,KAAK6gD,iBACrB/Y,YAAa9nC,KAAKggC,aAAa79B,KAAI,SAAS4M,GACxC,OAAOA,EAAIqpB,UACf,IACAitB,WAAYA,EACZnI,iBAAkBA,EAClBvrC,SAAU3R,KAAKsR,UAAUnP,KAAI,SAAS4lC,GAClC,OAAOA,EAAGlU,QACd,KA0BJ,OAvBI7zB,KAAK2lD,QACND,EAAKxiD,KAAO,CACR6L,IAAK/O,KAAK2lD,MAAM52C,IAAIqpB,WACpBpgB,QAAShY,KAAK2lD,MAAM3tC,QAAQ7V,KAAI,SAASmb,GACrC,MAAO,CACH5S,MAAO4S,EAAO5S,MACd6S,UAAWD,EAAOC,UAE1B,MAIHvd,KAAKusC,UACNmZ,EAAKvoC,OAAS,CACVpO,IAAK/O,KAAKusC,QAAQx9B,IAAIqpB,WACtBpgB,QAAShY,KAAKusC,QAAQv0B,QAAQ7V,KAAI,SAASmb,GACtC,IAAIH,EAASG,EAAOH,OAAO0W,SAE3B,OADA1W,EAAOzS,MAAQ4S,EAAO5S,MACfyS,CACZ,MAIAuoC,CACX,EAEA5xB,SAAU,SAAS4xB,GACf1lD,KAAKmV,OAAM,WAiBP,QAhBkBrI,IAAd44C,EAAKx5C,MACLlM,KAAK+hB,MAAM2jC,EAAKx5C,WAGOY,IAAvB44C,EAAK7tC,eACL7X,KAAK6X,cAAc6tC,EAAK7tC,oBAGJ/K,IAApB44C,EAAK5tC,YACL9X,KAAK8X,WAAW4tC,EAAK5tC,iBAGJhL,IAAjB44C,EAAK1tC,SACLhY,KAAK0a,SAASoZ,SAAS,QAAS4xB,EAAK1tC,cAGvBlL,IAAd44C,EAAK3tC,KAAoB,CACzB/X,KAAKw+C,eAAekH,EAAK3tC,MACzB/X,KAAKwa,MAAMsZ,SAAS,SAAU4xB,EAAK3tC,MAEnC,IAAK,IAAI8uB,EAAK,EAAGA,EAAK6e,EAAK3tC,KAAK1W,OAAQwlC,IAAM,CAC1C,IAAInzB,EAAMgyC,EAAK3tC,KAAK8uB,GAChBzrB,EAAW1H,EAAIhJ,MAMnB,QAJiBoC,IAAbsO,IACAA,EAAWyrB,GAGXnzB,EAAI2D,MACJ,IAAK,IAAIyvB,EAAK,EAAGA,EAAKpzB,EAAI2D,MAAMhW,OAAQylC,IAAM,CAC1C,IAAIhzB,EAAOJ,EAAI2D,MAAMyvB,GACjBwY,EAAcxrC,EAAKpJ,MAMvB,QAJoBoC,IAAhBwyC,IACAA,EAAcxY,GAGdhzB,EAAKmiB,QAAS,CACd,IAAIyY,EAAiC,iBAAhB56B,EAAKmiB,QACtBsvB,EAAM7W,EAAU56B,EAAKmiB,QAAQsvB,IAAMzxC,EAAKmiB,QACxCA,EAAUj2B,KAAK4lD,gBAAgBxqC,EAAUkkC,EAAaiG,GACtD7W,GACAzY,EAAQwU,qBACJxqC,EAAMsN,YAAYkH,KAAKusC,eAAeltC,EAAKmiB,QAAQlnB,MAE3D+E,EAAKmiB,QAAUA,CACnB,CAEIniB,EAAKkN,aACLlN,EAAKkN,WAAahhB,KAAK6lD,mBAAmBzqC,EAAUkkC,EAAaxrC,EAAKkN,aAG1EhhB,KAAK6c,YAAYiX,SAAS9zB,KAAK89B,MAAMpzB,MAAM0Q,EAAUkkC,GAAcxrC,EACvE,CAER,CACJ,CAWA,GATI4xC,EAAK/zC,WACL3R,KAAKsR,UAAYo0C,EAAK/zC,SAASxP,IAAI2jD,EAAQhyB,WAG3C4xB,EAAK/sC,YACL3Y,KAAK69C,eAAellC,UAChB3Y,KAAK69C,eAAe1c,kBAAoBnhC,KAAK6O,KAAK62C,EAAK/sC,YAG3D+sC,EAAKvuC,WAAY,CACjB,IAAI4uC,EAAgB/lD,KAAK6O,KAAK62C,EAAKvuC,YAEnCnX,KAAK69C,eAAetB,YAAcwJ,EAAc92C,aAChDjP,KAAK69C,eAAe9b,mBAAqBgkB,EAAcrzB,OAC3D,CASA,GANIgzB,EAAK5d,aACL4d,EAAK5d,YAAYh5B,SAAQ,SAASC,GAC/B/O,KAAK6N,MAAMkB,GAAKuI,OACnB,GAAGtX,MAGH0lD,EAAKvoC,OAAQ,CACb,IAAIpO,EAAM22C,EAAKvoC,OAAOpO,IAClBiJ,OAAmClL,IAAzB44C,EAAKvoC,OAAOnF,QAAyB,GAAK0tC,EAAKvoC,OAAOnF,QAE/DjJ,GAGD/O,KAAKusC,QAAU,CACXx9B,IAAK/O,KAAK6O,KAAKE,GACfiJ,QAASA,EAAQ7V,KAAI,SAASmb,GAC1B,MAAO,CACH5S,MAAO4S,EAAO5S,MACdyS,OAAQld,EAAMsN,YAAYy4C,OAAOt+C,OAAO4V,GAEhD,KAGJtd,KAAKimD,kBAZLhmD,EAAMimD,aAAa,8BAAgCR,EAAKx5C,KAAO,uBAcvE,MAE2BY,IAAvB44C,EAAK5yC,gBACL9S,KAAKw9C,eAAiBkI,EAAK5yC,eAG/B9S,KAAKy9C,gBAAkBiI,EAAK7E,eAExB6E,EAAKxiD,MACLlD,KAAKmsC,QAAQnsC,KAAK6O,KAAK62C,EAAKxiD,KAAK6L,KAAM22C,EAAKxiD,KAAK8U,QAAQlX,MAAM,GAEvE,IAEAd,KAAKwa,MAAM2rC,WACXnmD,KAAK0a,SAASyrC,UAClB,EAEAlwB,QAAS,SAASlnB,GACd,OAAO/O,KAAK6c,YAAYpa,IAAI,UAAWzC,KAAK89B,MAAMoiB,aAAanxC,GACnE,EAEAiS,WAAY,SAASjS,GACjB,OAAO/O,KAAK6c,YAAYpa,IAAI,aAAczC,KAAK89B,MAAMoiB,aAAanxC,GACtE,EAKAq3C,cAAe,WACXpmD,KAAK0qC,cAAa,SAASzU,GACvBA,EAAQrmB,OACZ,GACJ,EAEAy2C,iBAAkB,WACdrmD,KAAKqgD,iBAAgB,SAASr/B,GAC1BA,EAAWpR,OACf,GACJ,EAEAqH,OAAQ,SAASiX,EAAStf,GACtB,IAAI0Q,EAAWtf,KAAK6c,YAAYpa,IAAI,WAAW0E,SAC3CkZ,EAAQf,EAASje,OAAQ4tC,EAAU,EAAG1rC,EAAI,EAC9C,IAAK8c,GAASzR,EACV,OAAOA,IAEX,SAASqjC,IACLhD,IACI1rC,GAAK8c,GAAU4uB,GACfrgC,GAER,CACA,KAAOrL,EAAI8c,GACP4uB,IACA3vB,EAAS/b,KAAKrB,MAAM+L,KAAKigB,EAAStf,EAAWqjC,EAAO,KAE5D,EAEAqU,WAAY,SAASp4B,GACjB,IAAIruB,EAAOG,KACXA,KAAKqgD,iBAAgB,SAASr/B,GAC1B,IAAIigC,EAAU,IAAItjB,EAAQ3c,EAAWtN,IAAKsN,EAAW3L,KACjDtG,EAAO,IAAIiL,EAASinC,EAASA,GACjCjgC,EAAW/S,KAAKigB,EAASruB,EAAK6pC,KAAK36B,EAAK,SAAUlP,EAAK6pC,KAAK36B,EAAK,UACrE,GACJ,EAEAkD,OAAQ,SAASyB,EAAK2B,EAAKnT,GACvB,IAAIwI,EAAQ1K,KAAK89B,MAAMpzB,MAAMgJ,EAAK2B,GAElC,QAAcvI,IAAV5K,EAGA,OAAOlC,KAAK6c,YAAYpa,IAAI,QAASiI,GAFrC1K,KAAK6c,YAAYyX,IAAI,QAAS5pB,EAAOA,EAAOxI,EAIpD,EAEA2oC,YAAa,SAASn3B,EAAK2B,GACvB,IAAI3K,EAAQ1K,KAAK89B,MAAMpzB,MAAMgJ,EAAK2B,GAElC,OAAOrV,KAAK6c,YAAYpa,IAAI,aAAciI,EAC9C,EAEAm7C,mBAAoB,SAASnyC,EAAK2B,EAAK2L,GACnC,OAAIA,aAAsB/gB,EAAMsN,YAAYyT,WAAW2rB,WAE5C3rB,EAAWvR,MAAMzP,KAAK+hB,QAASrO,EAAK2B,IAGxB,MAAnB2L,EAAWw4B,OACXx4B,EAAWw4B,MAAQx4B,EAAWw4B,KAAO,IAAI12C,QAAQ,KAAM,KAGtC,MAAjBke,EAAWy4B,KACXz4B,EAAWy4B,IAAMz4B,EAAWy4B,GAAK,IAAI32C,QAAQ,KAAM,KAGhD7C,EAAMsN,YAAYyT,WAAW6oB,QAAQ7pC,KAAK+hB,QAASrO,EAAK2B,EAAK2L,GACxE,EAEA4kC,gBAAiB,SAASlyC,EAAK2B,EAAK9N,GAGhC,OAFAA,EAAIA,EAAEzE,QAAQ,KAAM,IACpByE,EAAItH,EAAMsN,YAAYkH,KAAK+mC,aAAax7C,KAAK+hB,QAASrO,EAAK2B,EAAK9N,GACzDtH,EAAMsN,YAAYkH,KAAKo1B,QAAQtiC,EAC1C,EAEAg/C,mBAAoB,SAAU11C,EAAS0J,EAAarY,EAAOyL,GACvD,IAAIm5B,EAAI/U,EAAOvM,EAEf,IAAKshB,EAAKj2B,EAAQwE,IAAKyxB,GAAMvsB,EAAYlF,IAAKyxB,IAAM,CAChD/U,EAAQ/xB,KAAK89B,MAAMpzB,MAAMmG,EAAQ6C,IAAKozB,GACtCthB,EAAMxlB,KAAK89B,MAAMpzB,MAAM6P,EAAY7G,IAAKozB,GACxC,IAAK,IAAIp8B,EAAQqnB,EAAOre,EAAM7C,EAAQ6C,IAAKhJ,GAAS8a,IAAO9a,IAASgJ,EAIhExR,EAAQA,EAAMuN,MAAMzP,KAAK+hB,QAASrO,EAAKozB,GACvC9mC,KAAK6c,YAAYyX,IAAI3mB,EAAUjD,EAAOA,EAAOxI,EAErD,CACA,OAAOA,CACX,EAEAqnC,KAAM,SAASx6B,EAAK7C,EAAMhK,GACtB,IAEI4kC,EAAI/U,EAAOvM,EAFX3U,EAAU7Q,KAAK89B,MAAMpD,UAAU3rB,EAAI8B,SACnC0J,EAAcva,KAAK89B,MAAMpD,UAAU3rB,EAAIwL,aAa3C,GAVoB,iBAATrY,IAOPA,EAAQjC,EAAMsN,YAAYkH,KAAKuS,QAAQiO,eAAe/yB,IAGtDA,GAAiB,WAARgK,EACW,iBAAThK,IAGPA,EAAQlC,KAAK4lD,gBAAgB/0C,EAAQ6C,IAAK7C,EAAQwE,IAAKnT,IAG3DA,EAAQlC,KAAKumD,mBAAmB11C,EAAS0J,EAAarY,EAAO,gBAE1D,GAAIA,GAAiB,cAARgK,EAChBhK,EAAQlC,KAAK6lD,mBAAmBh1C,EAAQ6C,IAAK7C,EAAQwE,IAAKnT,GAC1DA,EAAQlC,KAAKumD,mBAAmB11C,EAAS0J,EAAarY,EAAO,mBAG7D,IAAK4kC,EAAKj2B,EAAQwE,IAAKyxB,GAAMvsB,EAAYlF,IAAKyxB,IAC1C/U,EAAQ/xB,KAAK89B,MAAMpzB,MAAMmG,EAAQ6C,IAAKozB,GACtCthB,EAAMxlB,KAAK89B,MAAMpzB,MAAM6P,EAAY7G,IAAKozB,GACxC9mC,KAAK6c,YAAYyX,IAAIpoB,EAAM6lB,EAAOvM,EAAKtjB,GAC3B,WAARgK,GAEAlM,KAAK6c,YAAYyX,IAAI,QAASvC,EAAOvM,EAAK,KAI1D,EAEAkkB,KAAM,SAAS36B,EAAK7C,GAChB,IAAI2E,EAAU7Q,KAAK89B,MAAMpD,UAAU3rB,EAAI8B,SAEnCnG,EAAQ1K,KAAK89B,MAAMpzB,MAAMmG,EAAQ6C,IAAK7C,EAAQwE,KAElD,OAAOrV,KAAK6c,YAAYpa,IAAIyJ,EAAMxB,EACtC,EAEAyK,MAAO,SAASvG,EAAUH,GACtB,IAAI+3C,EAAYxmD,KAAKi/C,iBAcrB,OAZAj/C,KAAKi/C,gBAAe,GACpBj/C,KAAKk/C,eAAgB,EAErBtwC,EAASpO,KAAKR,MAETyO,IACDA,EAAS,CAAEwI,QAAQ,IAEnBjX,KAAKk/C,gBACLzwC,EAAO8Q,SAAU,GAGdvf,KAAKi/C,eAAeuH,GAAW12C,cAAcrB,EACxD,EAEA09B,QAAS,SAASp9B,EAAKiJ,GACnB,IAAIsb,EAAU,KAEdtb,EAAQlJ,SAAQ,SAASwO,GACrBgW,EAAUtzB,KAAK29C,QAAQ8I,OAAO13C,EAAKuO,EAAO5S,MAAO1K,KAAK6c,YAAYpa,IAAI,SAAU6a,EAAOC,UAAW+V,EACtG,GAAGtzB,MAEHA,KAAK2lD,MAAQ,CACT52C,IAAKA,EACLiJ,QAASA,GAGbhY,KAAKimD,iBAELjmD,KAAK8O,QAAQC,EAAK,SAAS2E,EAAK2B,EAAKsH,GACjC,IAAIsZ,EAAUtZ,EAAMsZ,QACpB,GAAIA,EAAS,CACT,IAAIhE,EAAOve,EAAMuiB,EAAQviB,IACzB,GAAa,IAATue,EAAY,CACZ,IAAIF,EAAQE,EAAO,EAAIgE,EAAQviB,IAAMuiB,EAAQviB,IAAMue,EACnDgE,EAAQkC,OAAOn4B,KAAKkM,OAAQ,MAAO6lB,EAAOE,EAC9C,CACJ,CACJ,EAAE/iB,KAAKlP,OAEPA,KAAK8P,cAAc,CAAEmH,QAAQ,GACjC,EAEAgvC,eAAgB,WACRjmD,KAAKusC,SACLvsC,KAAKssC,UAAUtsC,KAAKusC,QAAQx9B,IAAK/O,KAAKusC,QAAQv0B,QAEtD,EAEAs0B,UAAW,SAASv9B,EAAKiJ,GACrBhY,KAAKmV,OAAM,WACP,IAAK,IAAI0xB,EAAK93B,EAAI8B,QAAQ6C,IAAKmzB,GAAM93B,EAAIwL,YAAY7G,IAAKmzB,IAClD7mC,KAAKqrC,cAAcxE,KACnB7mC,KAAKo9C,cAAcl7C,MAAM2kC,EAAIA,GAAI,GACjC7mC,KAAKwa,MAAM+kC,OAAO1Y,IAI1B7uB,EAAQlJ,SAAQ,SAASwO,GAErB,IAAI6jC,EAAYpyC,EAAI4L,OAAO,CAAEoF,IAAK,IAAK0Y,SAASnb,EAAO5S,OAEnD2M,EAAQ,GAEZ,GAAI8pC,IAAclhD,EAAMsN,YAAY+vB,QAApC,CAIAt9B,KAAK8O,QAAQqyC,GAAW,SAASztC,EAAK2B,EAAKvB,GACvCA,EAAKJ,IAAMA,EACX2D,EAAM1W,KAAKmT,EACf,IAEAwJ,EAAOH,OAAOupC,QAAQrvC,GAEtB,IAAK,IAAIyvB,EAAK,EAAGA,EAAKzvB,EAAMhW,OAAQylC,IAAM,CACtC,IAAIhzB,EAAOuD,EAAMyvB,GACb5kC,EAAQob,EAAOH,OAAOjb,MAAM4R,IAEK,IAAjCwJ,EAAOH,OAAOwpC,QAAQzkD,IACtBlC,KAAK4gD,WAAW9sC,EAAKJ,IAE7B,CAhBA,CAiBJ,GAAG1T,MAEHA,KAAKusC,QAAU,CACXx9B,IAAKA,EACLiJ,QAASA,EAEjB,GAAG,CAAEf,QAAQ,EAAMlH,QAAQ,EAAMoN,QAAQ,GAC7C,EAEAypC,aAAc,SAAS73C,GACnB,IAAI83C,EAAY7mD,KAAKmd,SAASpO,IAC9B,OAAOA,EAAIE,aAAa4B,QAAQwE,IAAMwxC,EAAUh2C,QAAQwE,GAC5D,EAEA8H,OAAQ,WACJ,OAAOnd,KAAKusC,OAChB,EAEA3uB,YAAa,SAASoY,GAClBh2B,KAAK8mD,aAAa9wB,aAAgB8E,MAAQ9E,EAAO,CAACA,GACtD,EAEA8wB,aAAc,SAASxzB,GACftzB,KAAKusC,SACLvsC,KAAKmV,OAAM,WACPnV,KAAKusC,QAAQv0B,QAAUhY,KAAKusC,QAAQv0B,QAAQmF,QAAO,SAASG,GACxD,OAAOgW,EAAQ/hB,QAAQ+L,EAAO5S,OAAS,CAC3C,IAEA1K,KAAKimD,gBACT,GAAG,CAAEhvC,QAAQ,EAAMlH,QAAQ,EAAMoN,QAAQ,GAEjD,EAEAsB,aAAc,WACV,MAAO,CACH1G,KAAM/X,KAAKwa,MAAMrM,WACjB6J,QAAShY,KAAK0a,SAASvM,WAE/B,EAEAqQ,aAAc,SAASpQ,GACnBpO,KAAKwa,MAAMtM,SAASE,EAAM2J,MAC1B/X,KAAK0a,SAASxM,SAASE,EAAM4J,SAC7BhY,KAAK8P,cAAc,CAAEC,QAAQ,GACjC,EAEA5B,SAAU,WACN,MAAO,CACH4J,KAAM/X,KAAKwa,MAAMrM,WACjB6J,QAAShY,KAAK0a,SAASvM,WACvB25B,YAAa9nC,KAAKggC,aAAa79B,KAAI,SAAS2R,GAAQ,OAAOA,EAAKrE,OAAS,IACzEqmB,WAAY91B,KAAK6c,YAAY1O,WAErC,EAEAD,SAAU,SAASE,GACfpO,KAAKwa,MAAMtM,SAASE,EAAM2J,MAC1B/X,KAAK0a,SAASxM,SAASE,EAAM4J,SAC7BhY,KAAKggC,aAAe5xB,EAAM05B,YAC1B9nC,KAAK6c,YAAY3O,SAASE,EAAM0nB,YAChC91B,KAAK8P,cAAc7P,EAAMsN,YAAYw5C,YACzC,EAEAjc,OAAQ,SAAS/7B,GACb,IAGIg8B,EAHAjD,EAAc9nC,KAAKggC,aAEnBhxB,EAAQhP,KA0CZ,OAxCAA,KAAKmV,OAAM,WACP41B,EAAYh8B,EAAI5M,KAAI,SAAS4M,GACzB,GAAIA,aAAe9O,EAAMsN,YAAYowB,QACjC,OAAO5uB,EAGX,IAAIi4C,EAAaj4C,EAAIE,aAAautB,MAAMsL,GAAa,SAAS/4B,GAC1D+4B,EAAYt2B,OAAOs2B,EAAYv2B,QAAQxC,GAAM,EACjD,IAEIlB,EAAQ,IAAIiP,EAAMkqC,EAAYh4C,GAC9BinB,EAAUpoB,EAAM67B,KAAK,WACrBxnC,EAAQ2L,EAAM3L,QACdoT,EAASzH,EAAMyH,SACfszB,EAAa/6B,EAAM+6B,aAEvB/6B,EAAM3L,MAAM,MACZ2L,EAAMyH,OAAO,MACbzH,EAAM+6B,WAAW,MAEjB,IAAI/3B,EAAU,IAAIiM,EAAMkqC,EAAW9qB,WAAYltB,GAW/C,OATIinB,EACAplB,EAAQ04B,KAAK,UAAWtT,GAExBplB,EAAQ3O,MAAMA,GAElB2O,EAAQyE,OAAOA,GACfzE,EAAQ+3B,WAAWA,GAEnBd,EAAYnnC,KAAKqmD,GACVA,CACX,IAEA,IAAI5B,EAAgBp2C,EAAM6uC,eAE1BuH,EAAczsC,UAAY3J,EAAM4wB,gBAAgBwlB,EAAcjkB,mBAC9DikB,EAAc7I,YAAcvtC,EAAM4wB,gBAAgBwlB,EAAcrjB,mBACpE,GAAG,CAAE5qB,YAAY,EAAMwB,WAAW,IAE3BoyB,CACX,EAEAV,oBAAqB,WACjB,OAAOrqC,KAAKwN,WAAaxN,KAAKwN,UAAUlN,QAAQ2mD,kBACpD,EAEA9yC,oBAAqB,SAAS5M,GAC1B,IAAI2/C,EAAM,IAIV,OAHIlnD,KAAKqqC,wBACL6c,EAAMjnD,EAAM60B,UAAUwV,aAAa,MAEhCrqC,EAAMsN,YAAYkH,KAAK0yC,qBAAqBD,EAAK3/C,EAC5D,EAEAk8C,mBAAoB,SAASl0C,GACzB,IAAIkQ,EAAOlQ,EAAQuB,QACfiP,EAAMxQ,EAAQwB,QAMlB,OALIxB,EAAQqB,cAER6O,GAAQzf,KAAK0a,SAASoyB,IAAI,EAAGv9B,EAAQqB,YAAYyE,IAAM,GACvD0K,GAAO/f,KAAKwa,MAAMsyB,IAAI,EAAGv9B,EAAQqB,YAAY8C,IAAM,IAEhD,IAAIzT,EAAMsN,YAAY65C,UAAU3nC,EAAMM,EAAKxQ,EAAQpL,MAAOoL,EAAQnL,OAC7E,EAEAw/C,eAAgB,SAAS70C,GACrB,OAAO/O,KAAK89B,MAAMnR,UAAU5d,EAAIE,aACpC,EAEA0B,WAAY,SAAS02C,EAAKnwC,GAStB,OARMmwC,aAAevB,IACjBuB,EAAM,IAAIvB,EAAQuB,IAEtBrnD,KAAKsR,UAAU3Q,KAAK0mD,GAChBnwC,IACAlX,KAAK6P,eAAiBw3C,GAE1BrnD,KAAK8P,cAAc,CAAEC,QAAQ,IACtBs3C,CACX,EAEAn2C,cAAe,SAAS3B,GACpB,IAAIzJ,EAAM9F,KAAKsR,UAAUC,QAAQhC,GAC7BzJ,GAAO,IACP9F,KAAKsR,UAAUE,OAAO1L,EAAK,GAC3B9F,KAAK8P,cAAc,CAAEC,QAAQ,IAErC,EAEAZ,UAAW,SAASa,GAChB,IAAK,IAAIzM,EAAIvD,KAAKsR,UAAUjQ,SAAUkC,GAAK,GACvC,GAAIvD,KAAKsR,UAAU/N,GAAG0M,QAAUD,EAC5B,OAAO,EAGf,OAAO,CACX,EAEAud,SAAU,SAASxe,GAEf,IADA,IAAIq0B,EAASpjC,KAAKggC,aACTz8B,EAAI6/B,EAAO/hC,SAAUkC,GAAK,GAC/B,GAAI6/B,EAAO7/B,GAAG4a,GAAGpP,GACb,OAAO,EAGf,OAAO,CACX,IAGA+2C,EAAU7lD,EAAM0B,MAAMvB,OAAO,CAC7BC,KAAM,SAAiBwvC,GACnB7vC,KAAK4P,MAAMigC,EACf,EAEAhc,OAAQ,WACJ,MAAO,CACHjjB,YAAa5Q,KAAK4Q,YAAYwnB,WAC9BtnB,QAAS9Q,KAAK8Q,QACdC,QAAS/Q,KAAK+Q,QACd5M,MAAOnE,KAAKmE,MACZC,OAAQpE,KAAKoE,OACb6L,MAAOjQ,KAAKiQ,MACZe,QAAShR,KAAKgR,QAEtB,EAEAvB,MAAO,WACH,OAAO,IAAIq2C,EAAQ9lD,KACvB,EAEA4P,MAAO,SAASm4B,GACZ,IAAI5e,EAAS4e,EAAGn3B,YACK,iBAAVuY,IACPA,EAASlpB,EAAMsN,YAAYkH,KAAKusC,eAAe73B,IAEnDnpB,KAAK4Q,YAAcuY,EACnBnpB,KAAK8Q,QAAUi3B,EAAGj3B,SAAW,EAC7B9Q,KAAK+Q,QAAUg3B,EAAGh3B,SAAW,EAC7B/Q,KAAKmE,MAAQ4jC,EAAG5jC,MAChBnE,KAAKoE,OAAS2jC,EAAG3jC,OACjBpE,KAAKiQ,MAAQ83B,EAAG93B,MAChBjQ,KAAKgR,QAAwB,MAAd+2B,EAAG/2B,QAAkB+2B,EAAG/2B,QAAU,CACrD,EAEAmN,GAAI,SAAS4pB,GACT,QAAU/nC,KAAK4Q,cAAgBm3B,EAAGn3B,aACtB5Q,KAAK4Q,aAAem3B,EAAGn3B,aACpB5Q,KAAK4Q,YAAYuN,GAAG4pB,EAAGn3B,eAC/B5Q,KAAK8Q,UAAYi3B,EAAGj3B,SACpB9Q,KAAK+Q,UAAYg3B,EAAGh3B,SACpB/Q,KAAKmE,QAAU4jC,EAAG5jC,OAClBnE,KAAKoE,SAAW2jC,EAAG3jC,QACnBpE,KAAKiQ,QAAU83B,EAAG93B,OAClBjQ,KAAKgR,UAAY+2B,EAAG/2B,OAC/B,IAGJ80C,EAAQhyB,SAAW,SAAS+b,GACxB,OAAO,IAAIiW,EAAQjW,EACvB,EAEA5vC,EAAMsN,YAAYuvC,MAAQA,EAC1B78C,EAAMsN,YAAYu4C,QAAUA,CAC/B,CAn/DD,CAm/DG7lD,OAEH,SAAUA,GAEF,IAAIuB,EAAIvB,EAAMwF,OACV6hD,EAAarnD,EAAMsnD,YACnBC,EAAM,IACNC,EAAY,IAgCZC,EAAYznD,EAAMqiB,GAAGC,OAAOniB,OAAO,CACnCC,KAAM,SAAS+d,EAAS9d,GACpB,IAAImiB,EAAailC,EAAUjlC,WAE3BxiB,EAAMqiB,GAAGC,OAAO/hB,KAAKR,KAAMoe,EAAS9d,IAEpC8d,EAAUpe,KAAKoe,SAEPoE,SAASC,EAAWklC,kBAE5B3nD,KAAK4nD,YAActnD,EAAQihB,WAE3BvhB,KAAK6nD,MAAQ,IAAI5nD,EAAM6nD,IAAIC,KAAK3pC,EAAQ,IAExCpe,KAAK6nD,MAAMG,OAAO,CAAChoD,KAAKioD,aAAcjoD,KAAKkoD,qBAAqB,MAEhEloD,KAAKmoD,qBAAoB,GAEzBnoD,KAAKooD,kBAELpoD,KAAKqoD,UAAUn5C,KAAK,QAASlP,KAAKsoD,qBAAqBp5C,KAAKlP,OAE5DA,KAAKqoD,UAAUn5C,KAAK,MAAOlP,KAAKuoD,mBAAmBr5C,KAAKlP,OAExDoe,EAAQwF,GAAG,QAAS4jC,EAAM/kC,EAAW+lC,gBAAiBxoD,KAAKyoD,eAAev5C,KAAKlP,OAE/Eoe,EAAQwF,GAAG,QAAS,KAAM5jB,KAAK0oD,eAAex5C,KAAKlP,OAEnDoe,EAAQwF,GAAG,WAAY,MAAanB,EAAWkmC,gBAAiB3oD,KAAK4oD,cAAc15C,KAAKlP,OAExFoe,EAAQwF,GAAG,QAAS4jC,EAAM/kC,EAAWomC,aAAc7oD,KAAK8oD,aAAa55C,KAAKlP,MAC9E,EAEAM,QAAS,CACL4L,KAAM,YACN68C,WAAY,CACRC,SAAU,MAIlBtoD,OAAQ,CACJ,SACA,UACA,UAGJkoD,cAAe,WACP5oD,KAAKipD,UAITjpD,KAAKkpD,cAAclpD,KAAKogD,QAASpgD,KAAKmpD,gBAAgB,GACtDnpD,KAAKipD,QAAUjpD,KAAKoe,QACfwkB,KAAK3iC,EAAMqV,OAAO,cAAckyC,EAAIE,EAAUjlC,WAAW2mC,kBACzDloD,QAAQ,SACR0iB,GAAG,UAAW5jB,KAAKqpD,iBAAiBn6C,KAAKlP,OACzC4jB,GAAG,OAAQ5jB,KAAKspD,cAAcp6C,KAAKlP,OAC5C,EAEAupD,eAAgB,SAASC,GACrB,IAAI1vB,EAAe0vB,EAAW,KAAOxpD,KAAKipD,QAAQx+B,MAClDzqB,KAAKipD,QAAQj7B,MACbhuB,KAAKipD,QAAU,KACfjpD,KAAKkpD,cAAclpD,KAAKogD,QAASpgD,KAAKmpD,gBAAgB,GACtDnpD,KAAKypD,eAAe3vB,EACxB,EAEA4vB,aAAc,SAASC,EAAQC,IACtBD,GAAUC,EAAgB,GAI/B5pD,KAAKkpD,cAAcS,EAAQC,GAAe,EAC9C,EAEAV,cAAe,SAASS,EAAQC,EAAe3f,GAC3C,IAAInwB,EAAO9Z,KACPyiB,EAAailC,EAAUjlC,YAE3B3I,EAAK+vC,OAAS5pD,EAAMqb,QAAQwuC,MAAMhwC,EAAKsE,SACvCtE,EAAKsmC,QAAUuJ,EACf7vC,EAAKqvC,eAAiBS,EAEtB9vC,EAAKiwC,YAAY9f,GAAc,GAE1BnwB,EAAKkwC,wBAIUlwC,EAAKmwC,iBAEXznC,SAASC,EAAWynC,oBAAsBzC,EAAYhlC,EAAW0nC,wBAE/ErwC,EAAKswC,uBACT,EAEAA,qBAAsB,SAAU99B,GAC5B,IAAIxS,EAAO9Z,KACPqqD,EAAKvwC,EAAKwwC,eACV5nC,EAAU5I,EAAKmwC,iBACfM,EAAatqD,EAAMsqD,WAAWF,GAC9BvjD,EAAO4b,EAAQkgB,KAAK4kB,EAAME,EAAUjlC,WAAW+nC,eAC/CvY,EAAOvvB,EAAQkgB,KAAK4kB,EAAME,EAAUjlC,WAAWgoC,gBAEpC,IAAXn+B,GACAxlB,EAAK0b,SAAU,cACfyvB,EAAKzvB,SAAU,gBAEf1b,EAAK+d,YAAa,eAAgB/K,EAAK+vC,OAASU,EAAaF,EAAG,GAAGK,YAAcL,EAAG,GAAGplD,YAAc,EAAmB,IAAfslD,IACzGtY,EAAKptB,YAAa,eAAgB/K,EAAK+vC,OAAwB,IAAfU,EAAmBA,EAAaF,EAAG,GAAGK,YAAcL,EAAG,GAAGplD,YAAc,IAGhI,EAEAkjD,oBAAqB,SAAS77B,GAC1B,IAGIq+B,EACAC,EAJA9wC,EAAO9Z,KACPyiB,EAAailC,EAAUjlC,WACvBniB,EAAUwZ,EAAKxZ,QAGfuqD,EAAgB/wC,EAAKmwC,iBACzBU,EAAmBE,EAAcjoB,KAAK4kB,EAAM/kC,EAAW+nC,eACvDI,EAAmBC,EAAcjoB,KAAK4kB,EAAM/kC,EAAWgoC,eAEnDn+B,GACAq+B,EAAiB/mC,GAAG,aAAa,SAAUrL,GACvCA,EAAMa,iBACNb,EAAMuyC,kBACNhxC,EAAKixC,qBAAsB,EAC3BjxC,EAAKkxC,qBAAqB1qD,EAAQyoD,WAAWC,UAAYlvC,EAAK+vC,OAAS,GAAK,GAChF,IAEAe,EAAiBhnC,GAAG,aAAa,SAAUrL,GACvCA,EAAMa,iBACNb,EAAMuyC,kBACNhxC,EAAKixC,qBAAsB,EAC3BjxC,EAAKkxC,qBAAqB1qD,EAAQyoD,WAAWC,UAAYlvC,EAAK+vC,QAAU,EAAI,GAChF,IAEAc,EAAiB5b,IAAI6b,GAAkBhnC,GAAG,WAAW,WACjD9J,EAAKixC,qBAAsB,CAC/B,MAEAJ,EAAiB38B,MACjB48B,EAAiB58B,MAEzB,EAEA+7B,YAAa,SAAS9f,EAAcghB,GAChC,IAAIC,EACAC,EAAgB,GAChBrD,EAAM7nD,EAAM6nD,IACZ1pC,EAAU0pC,EAAI1pC,QACdurC,EAAS3pD,KAAKogD,QACdwJ,EAAgB5pD,KAAKmpD,eACrB1mC,EAAailC,EAAUjlC,WAE3B,IAAKyoC,EAAM,EAAGA,EAAMvB,EAAOtoD,OAAQ6pD,IAAO,CACtC,IAAIl8C,EAAQ26C,EAAOuB,GACfE,EAAmBF,IAAQtB,EAC3BnmC,EAAO,CAAEqiB,UAAWrjB,EAAW4oC,eAAiB5D,EAAW7/B,KAAM,OACjE0jC,EAAiB,GAQrB,GALI7nC,EAAKqiB,WADLslB,EACkB3oC,EAAW8oC,iBAAmB9D,EAAYhlC,EAAWkmC,gBAErDlmC,EAAW+oC,kBAG7BJ,GAAmBnhB,EACnBqhB,EAAe3qD,KAAKyd,EAAQ,QAAS,CACjC1P,KAAM,OACNxM,MAAO8M,EAAM9C,OACb45B,UAAWrjB,EAAWgpC,kBAAoBhE,EAAYhlC,EAAW2mC,gBACjEsC,UAAW,IACZ,UAOH,GALAJ,EAAe3qD,KAAKyd,EAAQ,OAAQ,CAChC0nB,UAAWrjB,EAAWkpC,eACtBp9C,MAAOS,EAAM9C,QACd,CAAC47C,EAAIllD,KAAKoM,EAAM9C,WAEfy9C,EAAOtoD,OAAS,EAAG,CACnB,IAAIuqD,EAAaxtC,EAAQ5c,EAAEvB,EAAMqiB,GAAGK,KAAKF,EAAWopC,iBAAiB,IAErEP,EAAe3qD,KAAKyd,EAAQ,OAAQ,CAChC0nB,UAAWrjB,EAAWkpC,eAAiBlE,EAAYhlC,EAAW+lC,gBAC9D,YAAa,UACd,CAACoD,IACR,CAGJT,EAAcxqD,KAAKyd,EAAQ,KAAMqF,EAAM6nC,GAC3C,CAEAtrD,KAAK6nD,MAAMG,OAAO,CAAChoD,KAAKioD,aAAejoD,KAAKkoD,qBAAqBiD,EAAeF,IACpF,EAEA/C,qBAAsB,SAASiD,EAAeF,GAC1C,IAAI7sC,EAAUne,EAAM6nD,IAAI1pC,QACpBqE,EAAailC,EAAUjlC,WACvBqpC,EAAe1tC,EAAQ,MAAO,CAAE0nB,UAAW,sCAC3CimB,EAAmB,CAAC,KAAM3tC,EAAQ,KAAM,CACxC0nB,UAAWrjB,EAAWupC,gBACtBpkC,KAAM,WACPujC,GAAgB,MAKf,IAAIc,EAAkBxpC,EAAWypC,iBAAmBzE,EAAYhlC,EAAW0pC,qBAAuB1E,EAatG,OAXIsE,EAAiB,GAAM3tC,EAAQ,OAAQ,CAAEguC,WAAY,OAAQtmB,UAAWmmB,EAAkBxpC,EAAW+nC,eAAiB,CAClHpsC,EAAQ5c,EAAEvB,EAAMqiB,GAAGK,KAAK,CAAEA,KAAMF,EAAW4pC,oBAAqBC,UAAW,mBAAoB,MAGnGP,EAAiB,GAAM3tC,EAAQ,OAAQ,CAAEguC,WAAY,OAAQtmB,UAAWmmB,EAAkBxpC,EAAWgoC,eAAiB,CAClHrsC,EAAQ5c,EAAEvB,EAAMqiB,GAAGK,KAAK,CAAEA,KAAMF,EAAW8pC,oBAAqBD,UAAW,mBAAoB,MAIvGR,EAAaU,SAAWT,EAEjB3tC,EAAQ,MAAO,CAAE0nB,UAAWrjB,EAAWgqC,gBAAkB,CAAEX,GACtE,EAEA1D,gBAAiB,WACb,IAAI3lC,EAAailC,EAAUjlC,WAC3BziB,KAAKqoD,UAAY,IAAIpoD,EAAMqiB,GAAGoqC,SAAS1sD,KAAKoe,QAAS,CACjDjB,OAAQld,EAAMqV,OAAO,sBAAuBmN,EAAWkmC,gBAAiBlmC,EAAW+oC,mBACnFmB,UAAWnF,EAAM/kC,EAAWgqC,eAC5BluC,KAAM,IACNquC,WAAW,EACXC,OAAQ,QACRrnC,IAAK,WACGxlB,KAAK8sD,UAAUzpB,MACfrjC,KAAK8sD,UAAUzpB,KAAKrR,QAE5B,EACAqR,KAAM,SAAUjlB,GAEZ,OADW5c,EAAE4c,GAAS3O,QACV8E,KAAK,eAAiBkO,EAAWsqC,qBAAuB,gBAAkBtqC,EAAWuqC,qBAAuB,iBAAiBC,QAAQ,MACrJ,GAER,EAEA5D,iBAAkB,SAAShhC,GACnBroB,KAAKipD,UACW,KAAZ5gC,EAAEsI,OACF3wB,KAAKupD,iBAGO,KAAZlhC,EAAEsI,OACF3wB,KAAKupD,gBAAe,GAGhC,EAEAD,cAAe,WACPtpD,KAAKipD,SACLjpD,KAAKupD,gBAEb,EAEAhB,mBAAoB,SAASlgC,GACzBA,EAAEjP,iBACFpZ,KAAKkB,QAAQ,UAAW,CAACgsD,SAAU7kC,EAAE6kC,SAAUC,SAAU9kC,EAAE8kC,UAC/D,EAEA7E,qBAAsB,SAASjgC,GACvBroB,KAAKipD,SACL5gC,EAAEjP,gBAEV,EAEAqvC,eAAgB,SAASpgC,GACrB,IAAI+kC,EAAmB5rD,EAAE6mB,EAAErW,QAAQi7C,QAAQ,MAAMrqD,OAE7C5C,KAAKipD,SACLjpD,KAAKupD,iBAGT,IAAI8D,EAAgB,SAAShlC,GACfA,EAAEilC,OAEJC,eACJvtD,KAAKkB,QAAQ,SAAU,CAAEgL,KAAMkhD,EAAkBI,cAAc,GAEvE,EAAEt+C,KAAKlP,MAEPA,KAAK4nD,YAAY,eAAgB,CAC7B5+B,MAAOqkC,GAEf,EAEA3E,eAAgB,SAASrgC,GACrB,IAAIolC,EAAoBjsD,EAAE6mB,EAAErW,QAAQpP,QAEhCpB,EAAE6mB,EAAErW,QAAQrH,GAAG68C,EAAME,EAAUjlC,WAAW2mC,kBAAqBqE,GAK/DztD,KAAKipD,SACLjpD,KAAKupD,iBAGTvpD,KAAK0tD,oBAAoBlsD,EAAE6mB,EAAErW,QAAQi7C,QAAQ,OAE7CjtD,KAAKkB,QAAQ,SAAU,CAACgL,KAAMuhD,EAAmBE,aAAa,KAV1DtlC,EAAEjP,gBAWV,EAEAqwC,eAAgB,SAAS3vB,GACjB95B,KAAKogD,QAAQpgD,KAAKmpD,gBAAgBj9C,SAAW4tB,GAAiC,OAAjBA,GAIjE95B,KAAKkB,QAAQ,SAAU,CAACgL,KAAM4tB,EAAc8zB,WAAY5tD,KAAKmpD,gBACjE,EAEAL,aAAc,WACV9oD,KAAKkB,QAAQ,SAAU,CAACysD,aAAa,GACzC,EAEA1F,WAAY,WACR,IAAI7pC,EAAUne,EAAM6nD,IAAI1pC,QACpBqE,EAAailC,EAAUjlC,WAC3B,OAAOrE,EAAQ,IAAK,CAChBwJ,KAAM,SACN,aAAc,gBACdke,UAAWrjB,EAAWomC,aAAepB,EAAYhlC,EAAWypC,iBAAmBzE,EAAYhlC,EAAWorC,0BACvG,CAACzvC,EAAQ5c,EAAEvB,EAAMqiB,GAAGK,KAAK,CAAEA,KAAMF,EAAWqrC,kBAAmBxB,UAAW,mBAAoB,KACrG,EAEAppC,QAAS,WACLljB,KAAKqoD,UAAUnlC,SACnB,EAEA8mC,mBAAoB,WAChB,IAAI1pD,EAAUN,KAAKM,QACnB,OAAOA,EAAQyoD,aAAel8C,MAAMvM,EAAQyoD,WAAWC,SAC3D,EAEA0E,oBAAqB,SAAUK,GAC3B,IAMIC,EANAl0C,EAAO9Z,KACPiuD,EAAcn0C,EAAKwwC,eACnB4D,EAAsBjuD,EAAMsqD,WAAW0D,GACvCE,EAAY7G,EAAWyG,GACvBK,EAAat0C,EAAK+vC,OAASkE,EAAKjiC,WAAWrM,KAAOsuC,EAAKjiC,WAAWrM,KAAOwuC,EAAYzB,WAAW95B,QAAQ5G,WAAWrM,KACnH4uC,EAAmBJ,EAAY,GAAGhpD,YAGlC6U,EAAK+vC,OACDuE,EAAa,EACbJ,EAAeE,EAAsBE,GAAcC,EAAmBH,GAC/DE,EAAaD,EAAYE,IAChCL,EAAeE,EAAsBE,EAAaD,GAGlDD,EAAsBG,EAAmBD,EAAaD,EACtDH,EAAeI,EAAaD,EAAYE,EACjCH,EAAsBE,IAC7BJ,EAAeI,GAIvBH,EAAYK,SAASC,QAAQ,CAAEhE,WAAcyD,GAAgB,OAAQ,UAAU,WAC3El0C,EAAKswC,sBACT,GACJ,EAEAE,aAAc,WACV,OAAOtqD,KAAKiqD,iBAAiBrnB,KAAK,KACtC,EAEAqnB,eAAgB,WACZ,OAAOjqD,KAAKoe,QAAQwkB,KAAK4kB,EAAME,EAAUjlC,WAAWgqC,eACxD,EAEAzB,qBAAsB,SAAU/1C,GAC5B,IAAI6E,EAAO9Z,KACPiuD,EAAcn0C,EAAKwwC,eACnBkE,EAAUvuD,EAAMsqD,WAAW0D,GAE/BA,EAAYK,SAASC,QAAQ,CAAEhE,WAAciE,EAAUv5C,GAAS,OAAQ,UAAU,WAC1E6E,EAAKixC,oBACLjxC,EAAKkxC,qBAAqB/1C,GAE1B6E,EAAKswC,sBAEb,GACJ,IAGJnqD,EAAMsN,YAAYm6C,UAAYA,EAC9BlmD,EAAEpB,QAAO,EAAMsnD,EAAW,CAAEjlC,WA1aF,CACtBklC,iBAAkB,oBAClBwC,uBAAwB,2CACxBxB,gBAAiB,kCACjB6C,kBAAmB,oCACnB3C,aAAc,+BACdL,gBAAiB,8BACjBiE,eAAgB,6BAChBrD,gBAAiB,8BACjBc,oBAAqB,wBACrBO,cAAe,kBACfD,cAAe,kBACfa,eAAgB,yBAChBE,iBAAkB,8BAClBE,kBAAmB,YACnBE,eAAgB,SAChB8C,eAAgB,SAChBC,mBAAoB,SACpBxC,iBAAkB,yBAClB2B,yBAA0B,8DAC1B1B,qBAAsB,4DACtBE,oBAAqB,iBACrBE,oBAAqB,kBACrBP,gBAAiB,2BACjBH,eAAgB,IAChB8C,iBAAkB,WAClBb,kBAAmB,OACnBf,qBAAsB,wEACtBC,qBAAsB,6BA+Y7B,CAjbL,CAibOvrD,OAAOxB,OAQV,IAiBU2uD,GAjBNC,GAAS5uD,MAAMsB,KACfutD,GAAgB7uD,MAAMsN,YACtBwhD,GAAQD,GAAcrxB,IACtBuxB,GAAaF,GAAc90C,SAC3Bi1C,GAAYH,GAAcnxB,QAC1BuxB,GAAYJ,GAAcpxB,QAC1ByxB,GAAYL,GAAcr6C,KAC1B26C,GAAYD,GAAUnoC,QAOtBqoC,GAAqB5nD,OAAOC,OAAO,MACnC4nD,GAAkB7nD,OAAOC,OAAO,OAE1BknD,GAOP,CACC,CAAE,KACF,CAAE,KACF,CAAE,KACF,CAAE,KACF,CAAE,KACF,CAAE,IAAK,KACP,CAAE,IAAK,KACP,CAAE,KACF,CAAE,IAAK,IAAK,IAAK,KAAM,KAAM,QAfzB9/C,SAAQ,SAAS+f,EAAKtrB,GACtBsrB,EAAI/f,SAAQ,SAASygD,GACjBF,GAAmBE,GAAMX,GAAIvtD,OAASkC,EACtC+rD,GAAsB,KAANC,EAAY,IAAMA,GAAMX,GAAIvtD,OAASkC,CACzD,GACJ,IAaJ,IAAIisD,GAAYH,GAEZI,GAAa,CACbC,IAAK,IACLC,IAAK,IACLC,IAAK,KAGT,SAASC,GAAoBC,GACzBL,GAAWC,IAAMI,EACjBL,GAAWE,IAAa,KAAPG,EAAa,IAAM,IACpCL,GAAWG,IAAa,KAAPE,EAAa,KAAO,IACrCN,GAAmB,KAAPM,EAAaR,GAAkBD,EAC/C,CAEAF,GAAUhI,qBAAuB,SAAS2I,EAAKvoD,GAC3C,GAAIkoD,GAAWC,KAAOI,EAClB,OAAOvoD,IAEX,IAAIoE,EAAO8jD,GAAWC,IACtBG,GAAoBC,GACpB,IACI,OAAOvoD,GACX,CAAE,QACEsoD,GAAoBlkD,EACxB,CACJ,EAEAwjD,GAAUY,YAAcN,GAExB,IAAI/6C,GAAazU,MAAM0B,MAAMvB,OAAO,CAChCC,KAAM,SAAoBmO,EAAS1I,GAC/B9F,KAAKwO,QAAUA,EACfxO,KAAK8F,IAAMA,CACf,EACAsyB,SAAU,WACN,OAAOp4B,KAAKwO,OAChB,IAGAwhD,GAAO,CAAEthD,KAAM,OAAQxM,OAAO,GAC9B+tD,GAAQ,CAAEvhD,KAAM,OAAQxM,OAAO,GAEnC,SAASguD,GAAO7sD,GACZA,EAAMA,EAAI6jB,cACV,IAAK,IAAI7R,EAAM,EAAG9R,EAAI,EAAGA,EAAIF,EAAIhC,SAAUkC,EACvC8R,EAAY,GAANA,EAAWhS,EAAIG,WAAWD,GAAK,GAEzC,OAAO8R,EAAM,CACjB,CAEA,SAAS86C,GAAO9sD,GACZ,OAAOuJ,SAASvJ,EAAK,IAAM,CAC/B,CAgDA,SAASm4C,GAAaxsC,EAAO0E,EAAK2B,EAAKf,GACnC,IAAId,EAAO,GAEP7I,GADJ2J,EAAQ87C,GAAc97C,EAAO,CAAEZ,IAAKA,EAAK2B,IAAKA,KAC/B1K,GAEf,MAAO,CACH+D,KAAM,MACN2hD,IAAKC,GAAgB,GACrB98C,KAAMA,EACNxE,MAAOA,EACP0E,IAAKA,EACL2B,IAAKA,GAGT,SAASk7C,EAAaxhD,GAGlB,OAFAA,EAAIrE,MAAQ8I,EAAKnS,OACjBmS,EAAK7S,KAAKoO,GACHA,CACX,CAEA,SAASnD,EAAK8C,EAAMxM,EAAOsuD,GACvB,GAAI7lD,EAAG+D,EAAMxM,GACT,OAAOoS,EAAM29B,OAEb,IAAI5mB,EAAM/W,EAAMm8C,OACZplC,EACA/W,EAAMrJ,MAAM,YAAcyD,EAAO,KAAOxM,EAAQ,eAAiBmpB,EAAI3c,KAAO,KAAO2c,EAAInpB,MAAQ,KACvFsuD,GACRl8C,EAAMrJ,MAAM,YAAcyD,EAAO,KAAOxM,EAAQ,IAG5D,CAEA,SAASouD,EAAgBI,GACrB,OAAOC,GA2GaC,EA3GcC,IA4G9BlmD,EAAG,OAAQ,MAAQA,EAAG,QAAUA,EAAG,QAAUA,EAAG,QACzC,CACH+D,KAAM,SACN6gD,GAAI,IACJ9vC,KAAMmxC,EACNjxC,MAAO2wC,GAAgB,IAGpBM,GApHqC,EAAGF,GA2GvD,IAAwBE,CA1GxB,CA4CA,SAASC,IACL,IAAID,EA3CavlC,EAmCCtc,EA+ClB,OAtCIpE,EAAG,SATWoE,EAUKuF,EAAM29B,QATpBja,YACLjpB,EAAIye,SAASxe,GAQb4hD,EANGL,EAAaxhD,IAQXpE,EAAG,QACRimD,EAzCR,WACI,IAAIhhB,EAAQt7B,EAAM29B,OAClBrC,EAAQA,EAAM1tC,MACd0J,EAAK,OAAQ,KAEb,IADA,IAAIikC,EAAO,IAEHllC,EAAG,OAAQ,MAGf,GAAIA,EAAG,KAAM8kD,GAAWE,KACpB9f,EAAKlvC,KAAK,CAAE+N,KAAM,SAClB4F,EAAM29B,WAFV,CAMA,GADApC,EAAKlvC,KAAK2vD,GAAgB,IACtBh8C,EAAM+a,OAAS1kB,EAAG,OAAQ,KAC1B,MAEJiB,EAAK,KAAM6jD,GAAWE,IALtB,CAQJ,OADA/jD,EAAK,OAAQ,KAAK,GACX,CACH8C,KAAM,OACNihC,KAAMC,EACNC,KAAMA,EAEd,CAecihB,GAEDnmD,EAAG,OAAQ,MAChB2J,EAAM29B,OACN2e,EAAMN,GAAgB,GACtB1kD,EAAK,OAAQ,KAAK,IAEbjB,EAAG,OAAQ,MAChB2J,EAAM29B,OACN2e,EA4BR,WACI,IAAIl9C,EAAM,GAAIxR,EAAQ,CAAEwR,GAAOgf,GAAQ,EACvC,MAAQpe,EAAM+a,QAAU1kB,EAAG,OAAQ,MAC3B+nB,EACAA,GAAQ,EACD/nB,EAAG,KAAM,MAChBzI,EAAMvB,KAAK+S,EAAM,IACjBY,EAAM29B,QAENrmC,EAAK,KAAM6jD,GAAWG,KAE1Bl8C,EAAI/S,KAAK2vD,GAAgB,IAE7B,MAAO,CACH5hD,KAAM,SACNxM,MAAOA,EAEf,CA7Cc6uD,GACNnlD,EAAK,OAAQ,KAAK,IAEbjB,EAAG,QAAUA,EAAG,QAAUA,EAAG,SAClCimD,EAAMt8C,EAAM29B,OAEPtnC,EAAG,OACRimD,EA/Da,SADAvlC,EAgEK/W,EAAM29B,QA/DpB+e,OAAgC,SAAb3lC,EAAI2lC,MACP,QAAb3lC,EAAI2lC,MAAkBhB,GAAOC,GAEjCM,EAAa,IAAIrB,GAAU7jC,EAAInpB,QA8D7ByI,EAAG,KAAM,MAAQA,EAAG,KAAM,KAC/BimD,EAAM,CACFliD,KAAM,SACN6gD,GAAIj7C,EAAM29B,OAAO/vC,MACjB0uD,IAAKC,KAGHv8C,EAAMm8C,OAGP9lD,EAAG,OAAQ,KAChB2J,EAAMrJ,MAAM,oCAGZqJ,EAAMrJ,MAAM,eANZqJ,EAAMrJ,MAAM,yBAQTgmD,EAAaL,EACxB,CAkCA,SAASK,EAAaL,GAClB,OAAIjmD,EAAG,KAAM,MACT2J,EAAM29B,OACCgf,EAAa,CAChBviD,KAAM,UACN6gD,GAAI,IACJqB,IAAKA,KAGFA,CAEf,CAEA,SAASD,EAAYlxC,EAAMyxC,EAASR,GAChC,IAAIrlC,EAAM1gB,EAAG,MACb,GAAI0gB,IAAQqlC,GAAUrlC,EAAInpB,OAASutD,GAAWE,KAAM,CAChD,IAAIwB,EAAW3B,GAAUnkC,EAAInpB,OAC7B,GAAIivD,EAAWD,EAAS,CACpB58C,EAAM29B,OACN,IAAItyB,EAAQgxC,EAAYE,IAAaM,EAAUT,GAC/C,OAAOC,EAAY,CACfjiD,KAAM,SACN6gD,GAAiB,KAAblkC,EAAInpB,MAAe,IAAMmpB,EAAInpB,MACjCud,KAAMA,EACNE,MAAOA,GACRuxC,EAASR,EAChB,CACJ,CACA,OAAOjxC,CACX,CACJ,CA0BA,IAA4BjY,GAAxB4pD,IAAwB5pD,GAQzBC,OAAOC,OAAO,MAPN,SAASyB,GACZ,IAAI5B,EAAIC,GAAM2B,GAId,OAHK5B,IACDA,EAAIC,GAAM2B,GAAQ,IAAIyqC,SAAS,uBAAyBzqC,EAAO,IAA7C,IAEf5B,CACX,GA6EJ,SAAS8pD,GAAMhB,EAAKhf,GAChB,IAAIigB,EAAS,EACb,OAAOC,EAAIlB,EAAKhf,GAEhB,SAASkgB,EAAI3rC,EAAMyrB,GACf,OAAQzrB,EAAKlX,MACX,IAAK,MAAY,OAgBvB,SAAgBkX,EAAMyrB,GAClB,MAAmB,QAAZzrB,EAAK7W,IAOhB,SAAoB6W,EAAMyrB,GACtB,MAAO,CACH3iC,KAAM,OACNihC,KAAM,WACNE,KAAM,CAAE2hB,EAAiBngB,GAAIzrB,GAErC,CAbgC6rC,CAAW7rC,EAAMyrB,GAAKqgB,EAAQ9rC,EAAMyrB,EACpE,CAlB8BsgB,CAAO/rC,EAAMyrB,GACrC,IAAK,MACL,IAAK,MACL,IAAK,OACL,IAAK,QACL,IAAK,OAAY,OAAOqgB,EAAQ9rC,EAAMyrB,GACtC,IAAK,SACL,IAAK,UAAY,OAyBvB,SAAkBzrB,EAAMyrB,GACpB,OAAOkgB,EAAI,CACP7iD,KAAM,OACNihC,KAAM,QAAU/pB,EAAK2pC,GACrB1f,KAAM,CAAEjqB,EAAKgrC,MACdvf,EACP,CA/B8BugB,CAAShsC,EAAMyrB,GACvC,IAAK,SAAY,OAgCvB,SAAmBzrB,EAAMyrB,GACrB,OAAOkgB,EAAI,CACP7iD,KAAM,OACNihC,KAAM,SAAW/pB,EAAK2pC,GACtB1f,KAAM,CAAEjqB,EAAKnG,KAAMmG,EAAKjG,QACzB0xB,EACP,CAtC8BwgB,CAAUjsC,EAAMyrB,GACxC,IAAK,OAAY,OA4HvB,SAAiBzrB,EAAMyrB,GACnB,OAAQzrB,EAAK+pB,KAAKrpC,eAChB,IAAK,KACH,OAxFR,SAAe2uC,EAAIC,EAAIpuB,EAAIuqB,GACvB,OAAOkgB,EAAItc,GAAI,SAASA,GAIpB,IAAItnB,EAAO6jC,EAAiBngB,GACxBygB,EAAQC,EAAO,KACfC,EAAQD,EAAO,KACnB,MAAO,CACHrjD,KAAM,OACNihC,KAAM,KACNE,KAAM,CACFliB,EACAsnB,EACA,CACIvmC,KAAM,SACNujD,KAAM,CAAEH,GACR9sD,KAAMusD,EAAIrc,GAAM8a,IAAM,SAAS9a,GAC3B,MAAO,CACHxmC,KAAM,OACNihC,KAAM,CAAEjhC,KAAM,MAAOxC,KAAM4lD,GAC3BjiB,KAAM,CAAEqF,GAEhB,KAEJ,CACIxmC,KAAM,SACNujD,KAAM,CAAED,GACRhtD,KAAMusD,EAAIzqC,GAAMmpC,IAAO,SAASnpC,GAC5B,MAAO,CACHpY,KAAM,OACNihC,KAAM,CAAEjhC,KAAM,MAAOxC,KAAM8lD,GAC3BniB,KAAM,CAAE/oB,GAEhB,MAIhB,GACJ,CAiDeorC,CAAMtsC,EAAKiqB,KAAK,GAAIjqB,EAAKiqB,KAAK,GAAIjqB,EAAKiqB,KAAK,GAAIwB,GACzD,IAAK,MACH,OAjDR,SAAgBxB,EAAMwB,GAClB,GAAoB,IAAhBxB,EAAKxuC,OACL,OAAOqwD,EAAQ1B,GAAM3e,GAEzB,OAAOkgB,EAAI,CACP7iD,KAAM,OACNihC,KAAM,KACNE,KAAM,CAEFA,EAAK,GAEL,CACInhC,KAAM,OACNihC,KAAM,MACNE,KAAMA,EAAK/uC,MAAM,IAGrBmvD,KAEL5e,EACP,CA6Be8gB,CAAOvsC,EAAKiqB,KAAMwB,GAC3B,IAAK,KACH,OA7BR,SAAexB,EAAMwB,GACjB,GAAoB,IAAhBxB,EAAKxuC,OACL,OAAOqwD,EAAQzB,GAAO5e,GAE1B,OAAOkgB,EAAI,CACP7iD,KAAM,OACNihC,KAAM,KACNE,KAAM,CAEFA,EAAK,GAELmgB,GAEA,CACIthD,KAAM,OACNihC,KAAM,KACNE,KAAMA,EAAK/uC,MAAM,MAG1BuwC,EACP,CASe+gB,CAAMxsC,EAAKiqB,KAAMwB,GAC1B,IAAK,OACH,OAAOA,EAAE2e,IACX,IAAK,QACH,OAAO3e,EAAE4e,IAGb,OAAO,SAAUtqC,EAAKkqB,EAAMtsC,GACxB,OAAIA,GAAKqiB,EAAKiqB,KAAKxuC,OACR,CACHqN,KAAO,OACPihC,KAAO/pB,EAAK+pB,KACZE,KAAOA,GAIJ0hB,EAAI3rC,EAAKiqB,KAAKtsC,IAAI,SAASrB,GAC9B,OAAOyjB,EAAKkqB,EAAKp8B,OAAO,CAAEvR,IAAUqB,EAAI,EAC5C,GAEP,CAbM,CAaJ,CAAEiuD,EAAiBngB,IAAM,EAChC,CAxJ8BghB,CAAQzsC,EAAMyrB,GACtC,IAAK,SAAY,OAyJvB,SAAmBzrB,EAAMyrB,GACrB,IAAIihB,EAAOP,EAAO,KACd/sD,EAAOusD,EAAI3rC,EAAK5gB,MAAM,SAASA,GAC/B,MAAO,CAAE0J,KAAM,OACNihC,KAAM,CAAEjhC,KAAM,MAAOxM,MAAOowD,GAC5BziB,KAAM,CAAE7qC,GACrB,IACA,OAAOqsC,EAAE,CAAE3iC,KAAM,SACNujD,KAAM,CAAEK,GAAO7+C,OAAOmS,EAAKqsC,MAC3BjtD,KAAMA,GACrB,CAnK8ButD,CAAU3sC,EAAMyrB,GACxC,IAAK,SAAY,OAAOmhB,EAAU5sC,EAAK1jB,MAAOmvC,GAAG,GAEnD,MAAM,IAAIlmC,MAAM,cAAgBya,EAAKlX,KACzC,CAMA,SAASgjD,EAAQ9rC,EAAMyrB,GACnB,OAAOA,EAAEzrB,EACb,CAyJA,SAAS4sC,EAAUC,EAAUphB,EAAGqhB,GAC5B,IAAIpnD,EAAI,GACR,OAAO,SAAUqa,EAAKpiB,GAClB,OAAIA,GAAKkvD,EAASpxD,OACPgwC,EAAE,CACL3iC,KAAM,SACNxM,MAAOoJ,KAGHonD,EAAWF,EAAYjB,GAAKkB,EAASlvD,IAAI,SAASknB,GAEtD,OADAnf,EAAE/H,GAAKknB,EACA9E,EAAKpiB,EAAI,EACpB,GAEP,CAZM,CAYJ,EACP,CAEA,SAASiuD,EAAiBngB,GACtB,IAAIihB,EAAOP,EAAO,KAClB,MAAO,CACHrjD,KAAO,SACPujD,KAAO,CAAEK,GACTttD,KAAOqsC,EAAE,CAAE3iC,KAAM,MAAOxC,KAAMomD,IAEtC,CAEA,SAASP,EAAO7lD,GAKZ,OAJKA,IACDA,EAAO,KAEXA,EAAO,IAAMA,MACIolD,CACrB,CACJ,CAEA,IAAIqB,GAAgBlrD,OAAOC,OAAO,MAElC,SAASkrD,GAAYhC,GACjB,IAAIjf,EArSR,SAAqBif,GACjB,OAAOQ,GAAY,kCACnB,SAAS3jC,EAAM7H,EAAMyoB,EAAQwkB,GACzB,OAAQjtC,EAAKlX,MACX,IAAK,MACH,MAAO,oDACA+lB,KAAKC,UAAUD,KAAKC,UAAU9O,EAAK1jB,QAAU,MAC7CuyB,KAAKC,UAAUD,KAAKC,UAAU9O,EAAK1jB,QACnC,0DACT,IAAK,OACH,OAAOuyB,KAAKC,UAAU9O,EAAK1jB,OAC7B,IAAK,QACH,OAAOuyB,KAAKC,UAAU,IAAM9O,EAAK1jB,OACnC,IAAK,MACH,OAAOuyB,KAAKC,UAAUD,KAAKC,UAAU9O,EAAK1jB,QAC5C,IAAK,MACH,MAAO,aAAe0jB,EAAKlb,MAAQ,yBACrC,IAAK,SACH,OAAOooD,GAAW,WACd,OAAOr+B,KAAKC,UAAU9O,EAAK2pC,IAAM,MAAQ9hC,EAAM7H,EAAKgrC,IAAKhrC,EAAM4pC,GAAU5pC,EAAK2pC,IAClF,IACF,IAAK,UACH,OAAOuD,GAAW,WACd,OAAOrlC,EAAM7H,EAAKgrC,IAAKhrC,EAAM4pC,GAAU5pC,EAAK2pC,KAAO,MAAQ96B,KAAKC,UAAU9O,EAAK2pC,GACnF,IACF,IAAK,SACH,OAAOuD,GAAW,WACd,IAAIrzC,EAAOszC,EACPtlC,EAAM7H,EAAKnG,KAAMmG,EAAM4pC,GAAU5pC,EAAK2pC,KACtC3pC,EAAKnG,gBAAgByvC,IAAwB,KAAXtpC,EAAK2pC,IAEvC5vC,EAAQozC,EACRtlC,EAAM7H,EAAKjG,MAAOiG,EAAM4pC,GAAU5pC,EAAK2pC,KACvC3pC,EAAKjG,iBAAiBuvC,IAAwB,KAAXtpC,EAAK2pC,IAE5C,MAAI,QAAQtnD,KAAK2d,EAAK2pC,IACX9vC,EAAO,+CAAiDE,EAExDF,EAAO,MAAQgV,KAAKC,UAAU9O,EAAK2pC,IAAM,MAAQ5vC,CAEhE,IACF,IAAK,OACH,OAAO8U,KAAKC,UAAU9O,EAAK+pB,KAAO,KAAO,OAClC/pB,EAAKiqB,KAAKxuC,OAAS,EACjBukB,EAAKiqB,KAAK1tC,KAAI,SAAS6wD,GACrB,OAAOvlC,EAAMulC,EAAKptC,EAAM,EAC5B,IAAGziB,KAAK,sDACN,MACH,SACR,IAAK,SACH,MAAO,UAAYyiB,EAAK1jB,MAAMC,KAAI,SAAS2kB,GACvC,OAAOA,EAAG3kB,KAAI,SAAS2kB,GACnB,OAAO2G,EAAM3G,EAAIlB,EAAM,EAC3B,IAAGziB,KAAK,qDACZ,IAAGA,KAAK,cAAgB,SAC1B,IAAK,OACH,MAAO,KAEX,MAAM,IAAIgI,MAAM,gCAAkCya,EAAKlX,MAEvD,SAASokD,EAAWvrD,GAChB,IAAIgoD,EAAK3pC,EAAK2pC,GACV0D,EAAczD,GAAUD,GAAMsD,IACXA,GAAc,KAANtD,GACM,UAAflhB,EAAO3/B,MAAoBmkD,GAAQrD,GAAUD,IAAoB,KAAblhB,EAAOkhB,IAC5C,UAAflhB,EAAO3/B,MAAoBmkD,GAAQrD,GAAUD,IAAO3pC,IAASyoB,EAAO1uB,MAC1F,OAAOozC,EAAaxrD,IAAK0rD,EAC7B,CACJ,CAnEuDxlC,CAAMmjC,EAAIP,IAAKO,EAAK,GAAK,MAoEhF,SAASmC,EAAa5pD,EAAMsqC,GACxB,OAAOA,EAAO,SAAWtqC,EAAO,SAAWA,CAC/C,CACJ,CA6NkB+pD,CAAYtC,GACtBttD,EAAOquC,EAAQnxC,KAAKowD,GACpB36B,EAAU08B,GAAcrvD,GAC5B,GAAI2yB,EAKA,OAAOA,EAAQxmB,MAAMmhD,EAAI5hD,MAAO4hD,EAAIl9C,IAAKk9C,EAAIv7C,KAEjD,IAAIlM,EAAOpJ,EAAGsxD,GAAMT,EAAIP,KAAK,SAASv5B,GAClC,MAAO,CACHpoB,KAAM,SACNxM,MAAO40B,EAEf,KAWA,OATA3tB,EAAO,CACH,cACA,qDACAA,EACA,KACFhG,KAAK,OAEP8yB,EAAU,IAAIm5B,GAAU1iB,QAAQkkB,EAAIp9C,KAAM49C,GAAYjoD,GAAOwoC,EAASif,EAAI5hD,MAAO4hD,EAAIl9C,IAAKk9C,EAAIv7C,KAC9Fs9C,GAAcrvD,GAAQ2yB,EAAQxmB,MAAMmhD,EAAI5hD,MAAO4hD,EAAIl9C,IAAKk9C,EAAIv7C,KACrD4gB,EAEP,SAASl2B,EAAG6lB,GACR,IAAIlX,EAAOkX,EAAKlX,KAChB,GAAY,OAARA,EACA,OAAOkX,EAAK1jB,MAAQ,GAEnB,GAAY,OAARwM,EACL,OAAO+lB,KAAKC,UAAU9O,EAAK1jB,OAE1B,GAAY,SAARwM,EACL,MAAO,iBAAmB+lB,KAAKC,UAAU9O,EAAK1jB,OAAS,IAEtD,GAAY,UAARwM,EACL,MAAO,mBAAqB3O,EAAG6lB,EAAK1jB,OAAS,IAE5C,GAAY,QAARwM,EACL,MAAO,gBAAkB+lB,KAAKC,UAAU9O,EAAK+pB,MAAQ,KAC/C5vC,EAAG6lB,EAAKiqB,KAAK,IAAM,KACnBsjB,EAAQvtC,EAAKiqB,KAAK/uC,MAAM,IACxB,IAEL,GAAY,QAAR4N,EACL,OAAO3O,EAAG6lB,EAAK+pB,MAAQ,IAAM/pB,EAAKiqB,KAAK1tC,IAAIpC,GAAIoD,KAAK,MAAQ,IAE3D,GAAY,OAARuL,EACL,MAAO,QAAUkX,EAAKlb,MAAQ,IAE7B,GAAY,QAARgE,EACL,MAAO,GAAKkX,EAAK1jB,MAEhB,GAAY,MAARwM,EACL,MAAO,iBAAmB3O,EAAG6lB,EAAKqvB,IAAM,OAASl1C,EAAG6lB,EAAKsvB,IAAM,MAAQn1C,EAAG6lB,EAAKkB,IAAM,IAEpF,GAAY,UAARpY,EACL,MAAO,aACDkX,EAAKqsC,KAAK9uD,KAAK,MACf,aAAepD,EAAG6lB,EAAK5gB,MAAQ,OAEpC,GAAY,OAAR0J,EACL,OAAOkX,EAAK1Z,KAEX,GAAY,UAARwC,EACL,OAAOykD,EAAQvtC,EAAK1jB,OAEnB,GAAY,QAARwM,EACL,MAAO,OAGP,MAAM,IAAIvD,MAAM,6BAA+BuD,EAEvD,CAEA,SAASykD,EAAQ7nD,GACb,MAAO,KAAOA,EAAEnJ,IAAIpC,GAAIoD,KAAK,MAAQ,IACzC,CACJ,CAEA,SAASiwD,GAAS3sD,GACd,OAAOA,CACX,CAEA,SAAS2pD,GAAc97C,EAAOhU,GAC1BgU,EAsQJ,SAAwBA,EAAOhU,GAC3B,IAAIgrB,EAAS,GAAI5gB,EAAQ,EACrBU,EAAYkJ,EAAMlJ,UAEtB,MAAO,CACH6mC,KAAQA,EACRwe,KAAQA,EACRphC,IAAQA,EACRpkB,MAAQqJ,EAAMrJ,MACdooD,MAAQA,EACRznD,KAAQA,GAGZ,SAASC,EAAQ9D,GACb,MAAQ,SAASE,KAAKF,EAC1B,CAEA,SAASurD,EAAUvrD,GACf,MAAQ,WAAWE,KAAKF,IAAO8mD,GAAO/mD,gBAAgBC,EAC1D,CAEA,SAASwrD,EAAKxrD,GACV,OAAOurD,EAAUvrD,IAAO8D,EAAQ9D,IAAa,KAANA,CAC3C,CAEA,SAASyrD,EAASzrD,GACd,OAAOA,KAAMynD,EACjB,CAEA,SAASiE,EAAO1rD,GACZ,MAAO,aAAawJ,QAAQxJ,IAAO,CACvC,CAEA,SAAS2rD,IAEL,IAAIC,GAAU,EACVC,EAASxoD,GAAU,SAASrD,GAC5B,OAAIA,GAAM0nD,GAAWC,KACbiE,IAGJA,GAAU,GACH,GAEJ9nD,EAAQ9D,EACnB,IACA,OAAI6rD,GAAUnE,GAAWC,IACd,CAAEhhD,KAAM,OAAQxM,MAAOutD,GAAWC,KAElC,CAAEhhD,KAAM,MAAOxM,MAAO2xD,WAAWD,EAAO9wD,QAAQ2sD,GAAWC,IAAK,MAE/E,CAEA,SAASoE,EAAOnsD,EAAIgF,GAChB,MAAO,CACH+B,KAAQ,MACRxM,MAAQyF,EACRqpD,MAAQrpD,EAAGuf,cACX6sC,MAAQtoD,GAAa6I,EAAMm8C,QAC3B9jD,MAAQA,EAEhB,CAEA,SAASqnD,EAAM1oD,EAAG4O,EAAGvT,GACjB,IAAK2E,IAAM4O,IAAMvT,EACb,OAAO,KAEX,IAAM2E,IAAM3E,GAAO2E,GAAK3E,EAAI,CACxB,IAAIo2B,EAAM7iB,EAAItN,SAASsN,EAAG,IAAM,EAChC,OAAO5O,EAAIyxB,EAAMA,EAAM,CAC3B,CACJ,CAEA,SAASk3B,IACL,IAAIptD,EAAIyN,EAAM4/C,UAAU,kDACxB,GAAIrtD,EAAG,CACH,IAAI6M,EAAMsgD,EAAMntD,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAC1BwO,EAAM2+C,EAAMntD,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAC9B,GAAW,MAAP6M,GAAsB,MAAP2B,EAEf,OADAf,EAAM1I,KAAK/E,GACJ,CACH6H,KAAM,KACNgF,IAAKA,EACL2B,IAAKA,EACLuiB,KAAO/wB,EAAE,MAAQA,EAAE,IAAMA,EAAE,IAAMA,EAAE,IAAM,EAAI,IAEtCA,EAAE,MAAQA,EAAE,IAAMA,EAAE,IAAMA,EAAE,IAAM,EAAI,GAIzD,CACA,OAAOitD,EAAO1oD,EAAUmoD,GAC5B,CAEA,SAASY,IAEL,OADA7/C,EAAM29B,OACC,CAAEvjC,KAAM,MAAOxM,MAAOoS,EAAM8/C,YAAY,KACnD,CAEA,SAASC,IAEL,OADA//C,EAAM29B,OACC6hB,EAAOx/C,EAAM8/C,YAAY,MAAM,EAC1C,CAEA,SAASE,IACL,MAAO,CACH5lD,KAAQ,KACRxM,MAAQkJ,GAAU,SAASrD,EAAIwnD,GAC3B,OAAQA,EAAKxnD,KAAOynD,EACxB,IAER,CAEA,SAAS+E,IACL,MAAO,CACH7lD,KAAQ,OACRxM,MAAQoS,EAAM29B,OAEtB,CAEA,SAASuiB,IACL,GAAIlgD,EAAM+a,MACN,OAAO,KAEX,IAAuBxoB,EAAnBkB,EAAKuM,EAAMm8C,OACf,MAAU,KAAN1oD,EACOosD,IAED,KAANpsD,EACOssD,IAEPxoD,EAAQ9D,IAAOA,GAAM0nD,GAAWC,IACzBgE,IAEPJ,EAAUvrD,GACHksD,IAEPT,EAASzrD,GACFusD,IAEPb,EAAO1rD,GACAwsD,KAEN1tD,EAAIyN,EAAM4/C,UAAU,wBACrB5/C,EAAM1I,KAAK/E,GACJ,CAAE6H,KAAM,QAASxM,MAAO2E,EAAE,MAEhCvG,EAAQm0D,WACTngD,EAAMrJ,MAAM,qCAAuClD,EAAGvE,WAAW,IAE9D,CAAEkL,KAAM,QAASxM,MAAOoS,EAAM29B,QACzC,CAEA,SAASwe,IACL,KAAOnlC,EAAOjqB,QAAUqJ,GAAO,CAC3BU,EAAUK,IACV,IAAI8Z,EAAQjR,EAAMxO,MACdulB,EAAMmpC,IACNl0D,EAAQm0D,WAAappC,IACrBA,EAAI9F,MAAQA,EACZ8F,EAAI7F,IAAMlR,EAAMxO,OAEpBwlB,EAAO3qB,KAAK0qB,EAChB,CACA,OAAOC,EAAO5gB,EAClB,CAEA,SAASunC,IACL,IAAI5mB,EAAMolC,IAIV,OAHIplC,GACA3gB,IAEG2gB,CACX,CAEA,SAASgoC,EAAMpsD,EAAGM,GAEd,IADA,IAAIzB,EAAM4E,EAAOY,EAAI,GACdrE,KAAM,GACTqE,EAAE3K,KAAKsxC,KAAUyiB,IAGrB,OADAhqD,EAAQ5E,EACDyB,EAAEM,MAAMyD,EAAGA,EACtB,CAEA,SAASM,EAAK3E,GACVyD,GAASzD,CACb,CAEA,SAASooB,IACL,OAAiB,MAAVohC,GACX,CACJ,CArcYkE,CAAeC,GAAYtgD,GAAQhU,GAC3C,IAAI+yD,EAAQ/+C,EAAM++C,MACdznD,EAAO0I,EAAM1I,KACb8c,EAAQ,KACRmsC,EAAyB,MAAfv0D,EAAQoT,KAA8B,MAAfpT,EAAQ+U,IACvC,SAASvB,GAOP,OANe,EAAXA,EAAK8jB,MACL9jB,EAAKuB,KAAO/U,EAAQ+U,KAET,EAAXvB,EAAK8jB,MACL9jB,EAAKJ,KAAOpT,EAAQoT,KAEjBI,CACX,EACEs/C,GAEF0B,EAASx0D,EAAQm0D,UACf,SAASznD,EAAO+nD,EAAYC,GAG1B,OAFAhoD,EAAMuY,MAAQwvC,EAAWxvC,MACzBvY,EAAMwY,IAAMwvC,EAASxvC,IACdxY,CACX,EACEomD,GAEN,MAAO,CACH3C,KAAQA,EACRxe,KAqBJ,WACI,GAAa,MAATvpB,EAAe,CACf,IAAIvb,EAAMub,EAEV,OADAA,EAAQ,KACDvb,CACX,CACA,OAAOqnD,GACX,EA3BIvpD,MAAQqJ,EAAMrJ,MACdokB,IAAQ/a,EAAM+a,IACd1kB,GAGJ,SAAY+D,EAAMxM,GACd,IAAImpB,EAAMolC,IACV,OAAc,MAAPplC,GACS,MAAR3c,GAAgB2c,EAAI3c,OAASA,GACpB,MAATxM,GAAiBmpB,EAAInpB,QAAUA,EAC3B,KAANmpB,CACV,GAEA,SAASolC,IAIL,OAHa,MAAT/nC,IACAA,EAAQ8rC,KAEL9rC,CACX,CAWA,SAAS8rC,IACL,IAAI19B,EACAwa,EAAIh9B,EAAMm8C,OAed,OAdInf,IACc,OAAVA,EAAE5iC,MAA2B,MAAV4iC,EAAE5iC,MAA0B,OAAV4iC,EAAE5iC,OACvCooB,EAAOu8B,EAAM,EAAG4B,IACT5B,EAAM,EAAG6B,IACT7B,EAAM,EAAG8B,IACT9B,EAAM,EAAG+B,IACT/B,EAAM,EAAGgC,IACThC,EAAM,EAAGiC,IACTjC,EAAM,EAAGkC,IAEfz+B,IACDA,EAAMxiB,EAAM29B,SAGbnb,CACX,CAEA,SAASqF,EAAO9Q,EAAKmqC,GACjB,GAAgB,MAAZnqC,EAAI3c,KASJ,OAHI2c,EAAIuM,KAAQt3B,EAAQm0D,WAA6B,MAAfn0D,EAAQoT,KAA8B,MAAfpT,EAAQ+U,KACjEf,EAAMrJ,MAAM,4CAET,IAAIgkD,GAAU5jC,EAAI3X,IAAK2X,EAAIhW,IAAKgW,EAAIuM,KAE/C,GAAgB,OAAZvM,EAAI3c,KACJ,OAAI2c,EAAInpB,OAAS,QAEN2yD,EAAQ,IAAI5F,GACfkB,GAAO9kC,EAAInpB,OACXszD,GAAW91C,IAAYA,IACvB,IAGG,KAMf,IAAIxT,EAAOmf,EAAInpB,MACX2E,EAAI,6BAA6BoH,KAAK/B,GAC1C,GAAIrF,EAAG,CACH,IAAI6M,EAAMy8C,GAAOtpD,EAAE,IAAKwO,EAAM66C,GAAOrpD,EAAE,IACvC,OAAI6M,GAAO,SAAW2B,GAAO,MAClBw/C,EAAQ,IAAI5F,GACfkB,GAAOtpD,EAAE,IACTqpD,GAAOrpD,EAAE,KACRA,EAAE,GAAK,EAAI,IAAMA,EAAE,GAAK,EAAI,KAG1B,IAEf,CACA,IAAIszB,EAAwB,KAAlBjuB,EAAKnF,OAAO,GAItB,GAHIozB,IACAjuB,EAAOA,EAAKwe,OAAO,IAEnB,QAAQziB,KAAKiE,IAEb,IADIwH,EAAMy8C,GAAOjkD,KACN,QACP,OAAO2oD,EAAQ,IAAI5F,GACfkB,GAAOjkD,GACPspD,GAAW91C,IAAYA,IACtBya,EAAM,EAAI,SAKnB,IADI9kB,EAAM66C,GAAOhkD,KACN,MACP,OAAO2oD,EAAQ,IAAI5F,GACfuG,GAAW91C,IAAYA,IACvBwwC,GAAOhkD,GACNiuB,EAAM,EAAI,GAI3B,CAGA,SAAS86B,EAAW3pD,EAAG4O,EAAGvT,EAAGC,EAAGyhB,EAAG9gB,EAAGkuD,EAAGzlB,GACrC,GAAc,OAAV1kC,EAAEoD,MACQ,MAAVwL,EAAExL,MAA2B,KAAXwL,EAAEhY,OACV,OAAVyE,EAAE+H,MACQ,QAAV9H,EAAE8H,MAA6B,KAAX9H,EAAE1E,QACX,OAAVmmB,EAAE3Z,MAA2B,MAAV2Z,EAAE3Z,MAA2B,OAAV2Z,EAAE3Z,MAAiB2Z,EAAEnmB,OAASmmB,EAAEnmB,MAAM,IACnE,MAAVqF,EAAEmH,MAA2B,KAAXnH,EAAErF,QACT,OAAVuzD,EAAE/mD,MAA2B,MAAV+mD,EAAE/mD,MAA2B,OAAV+mD,EAAE/mD,MAAiB+mD,EAAEvzD,OAASuzD,EAAEvzD,MAAM,IAC7EuzD,EAAE/mD,MAAQ2Z,EAAE3Z,OACA,QAAVshC,EAAEthC,MAA6B,KAAXshC,EAAE9tC,OAAiBuzD,EAAE1B,OAC/C,CACI,IAAIx5B,EAAK4B,EAAO9T,GAAG,GAAOmS,EAAK2B,EAAOs5B,GAAG,GACzC,GAAIl7B,GAAMC,EAIN,OADA5uB,EAAK,GACEkpD,EAAO,IAAI9F,GACdz0B,EAAG/M,SAASliB,EAAEpJ,OAAO,GACrBs4B,EAAGhN,SAAS7mB,EAAEzE,OAAO,IACvBsrB,SAASliB,EAAEpJ,OAAO,GAAOoJ,EAAGmqD,EAEtC,CACJ,CAGA,SAASP,EAAU5pD,EAAG4O,EAAGvT,EAAGC,EAAGyhB,EAAG9gB,GAC9B,GAAc,OAAV+D,EAAEoD,MACQ,MAAVwL,EAAExL,MAA2B,KAAXwL,EAAEhY,OACV,OAAVyE,EAAE+H,MACQ,QAAV9H,EAAE8H,MAA6B,KAAX9H,EAAE1E,QACX,OAAVmmB,EAAE3Z,MAA2B,MAAV2Z,EAAE3Z,MAA2B,OAAV2Z,EAAE3Z,MAAiB2Z,EAAEnmB,OAASmmB,EAAEnmB,MAAM,KACjE,QAAVqF,EAAEmH,MAA6B,KAAXnH,EAAErF,OAAiBmmB,EAAE0rC,OAC/C,CACI,IAAIx5B,EAAK4B,EAAO9T,GAChB,GAAIkS,EAAI,CACJ3uB,EAAK,GACL,IAAI4uB,EAAKD,EAAG9qB,QACZ,OAAOqlD,EAAO,IAAI9F,GACdz0B,EAAG/M,SAASliB,EAAEpJ,OAAO,GACrBs4B,EAAGhN,SAAS7mB,EAAEzE,OAAO,IACvBsrB,SAASliB,EAAEpJ,OAAO,GAAOoJ,EAAG+c,EAClC,CACJ,CACJ,CAGA,SAAS8sC,EAAc7pD,EAAG4O,EAAGvT,EAAGC,EAAGyhB,EAAG9gB,GAClC,GAAc,OAAV+D,EAAEoD,MACQ,QAAVwL,EAAExL,MAA6B,KAAXwL,EAAEhY,QACX,OAAVyE,EAAE+H,MAA2B,MAAV/H,EAAE+H,MAA2B,OAAV/H,EAAE+H,MAAiB/H,EAAEzE,OAASyE,EAAEzE,MAAM,IACnE,MAAV0E,EAAE8H,MAA2B,KAAX9H,EAAE1E,QACT,OAAVmmB,EAAE3Z,MAA2B,MAAV2Z,EAAE3Z,MAA2B,OAAV2Z,EAAE3Z,MAAiB2Z,EAAEnmB,OAASmmB,EAAEnmB,MAAM,KACjE,QAAVqF,EAAEmH,MAA6B,KAAXnH,EAAErF,OAAiBmmB,EAAE0rC,OAC/C,CACI,IAAIx5B,EAAK4B,EAAOx1B,GAAG,GAAO6zB,EAAK2B,EAAO9T,GAAG,GACzC,GAAIkS,GAAMC,EAEN,OADA5uB,EAAK,GACEkpD,EAAO,IAAI9F,GAAWz0B,EAAIC,GAAIhN,SAASliB,EAAEpJ,OAAO,GAAOoJ,EAAG+c,EAEzE,CACJ,CAGA,SAAS+sC,EAAa9pD,EAAG4O,EAAGvT,EAAGC,GAC3B,GAAc,OAAV0E,EAAEoD,MACQ,QAAVwL,EAAExL,MAA6B,KAAXwL,EAAEhY,QACX,OAAVyE,EAAE+H,MAA2B,MAAV/H,EAAE+H,MAA2B,OAAV/H,EAAE+H,MAAiB/H,EAAEzE,OAASyE,EAAEzE,MAAM,KACjE,QAAV0E,EAAE8H,MAA6B,KAAX9H,EAAE1E,OAAiByE,EAAEotD,OAC/C,CACInoD,EAAK,GACL,IAAInF,EAAI01B,EAAOx1B,GAIf,OAHKF,GAAMqxB,SAASrxB,EAAEiN,OAClBjN,EAAI,IAAIyoD,GAAUvoD,EAAEzE,QAEjB4yD,EAAOruD,EAAE+mB,SAASliB,EAAEpJ,OAAO,GAAOoJ,EAAG3E,EAChD,CACJ,CAGA,SAAS0uD,EAAS/pD,EAAG4O,EAAGvT,EAAGC,GACvB,IAAe,OAAV0E,EAAEoD,MAA2B,MAAVpD,EAAEoD,MAA2B,OAAVpD,EAAEoD,MAAiBpD,EAAEpJ,OAASoJ,EAAEpJ,MAAM,IAClE,MAAVgY,EAAExL,MAA2B,KAAXwL,EAAEhY,QACV,OAAVyE,EAAE+H,MAA2B,MAAV/H,EAAE+H,MAA2B,OAAV/H,EAAE+H,MAAiB/H,EAAEzE,OAASyE,EAAEzE,MAAM,KACjE,QAAV0E,EAAE8H,MAA6B,KAAX9H,EAAE1E,OAAiByE,EAAEotD,OAC/C,CACI,IAAIx5B,EAAK4B,EAAO7wB,GAAG,GAAOkvB,EAAK2B,EAAOx1B,GAAG,GACzC,GAAI4zB,GAAMC,EAEN,OADA5uB,EAAK,GACEkpD,EAAO,IAAI9F,GAAWz0B,EAAIC,GAAKlvB,EAAG3E,EAEjD,CACJ,CAGA,SAAS2uD,EAAQhqD,EAAG4O,GAChB,IAAe,OAAV5O,EAAEoD,MAA2B,MAAVpD,EAAEoD,QAA6B,QAAVwL,EAAExL,MAA6B,KAAXwL,EAAEhY,OAAiBoJ,EAAEyoD,OAAQ,CAC1F,IAAIttD,EAAI01B,EAAO7wB,GACf,GAAI7E,GAAKqxB,SAASrxB,EAAEiN,MAAQokB,SAASrxB,EAAE4O,KAEnC,OADAzJ,EAAK,GACEkpD,EAAOruD,EAAG6E,EAAGA,EAE5B,CACJ,CAEA,SAASiqD,EAAQjqD,EAAG4O,GAChB,GAAc,OAAV5O,EAAEoD,MAA2B,QAAVwL,EAAExL,MAA6B,KAAXwL,EAAEhY,QAAiBoJ,EAAEyoD,MAG5D,OAFAzoD,EAAEoD,KAAO,OACT9C,EAAK,GACEN,CAEf,CACJ,CAEA,SAASG,GAAa1D,GAClB,MAAO,YAAoBwJ,QAAQxJ,IAAO,CAC9C,CAEA,IAAI2sD,GAAM,CAAEhmD,KAAM,OAmMlB,SAASkmD,GAAYtgD,GACjB,IAAIxO,EAAM,EACV,MAAO,CACHmsC,KAAcA,EACdwe,KAAcA,EACdphC,IAAcA,EACdpkB,MAAcA,EACdG,UAoEJ,SAAmBmiC,GACf,IAAIlqC,EAAM,GACV,MAAQgsB,KAASke,EAAUkjB,IAAQptD,IAC/BA,GAAO4uC,IAEX,OAAO5uC,CACX,EAzEI+wD,YAkDJ,SAAqB5uC,GACjB,IAAIkwC,GAAU,EAAOryD,EAAM,GAC3B,MAAQgsB,KAAO,CACX,IAAItnB,EAAKkqC,IACT,GAAIyjB,EACAryD,GAAO0E,EACP2tD,GAAU,OACP,GAAU,MAAN3tD,EACP2tD,GAAU,MACP,IAAI3tD,GAAMyd,EACb,MAEAniB,GAAO0E,CACX,CACJ,CACA,OAAO1E,CACX,EAjEI6wD,UAyEJ,SAAmByB,GACf,OAAOA,EAAG1nD,KAAKqG,EAAMoW,OAAO5kB,GAChC,EA1EI8F,KA0BJ,SAAc7D,GACV,GAAiB,iBAANA,EACHuM,EAAMoW,OAAO5kB,EAAKiC,EAAG1G,SAAW0G,GAChCkD,EAAM,YAAclD,GAExB6tD,EAAQ7tD,EAAG1G,aACR,GAAI0G,aAAcO,OAAQ,CAC7B,IAAIzB,EAAIkB,EAAGkG,KAAKqG,EAAMoW,OAAO5kB,IAC7B,GAAIe,EAEA,OADA+uD,EAAQ/uD,EAAE,GAAGxF,QACNwF,CAEf,MAEI+uD,EAAQ7tD,EAAG,GAAG1G,OAEtB,EAzCIu0D,QAAcA,EACd9vD,IAEJ,WACI,OAAOA,CACX,GACA,SAASmsC,IACL,IAAIlqC,EAAKuM,EAAMvN,OAAOjB,KAOtB,MANU,MAANiC,GAEM,GAENsN,EAEGtN,CACX,CACA,SAAS0oD,IACL,OAAOn8C,EAAMvN,OAAOjB,EACxB,CACA,SAASupB,IACL,MAAkB,KAAXohC,GACX,CACA,SAASxlD,EAAMC,GACX,MAAM,IAAIwJ,GAAWxJ,EAAM,YAAcoJ,EAAQ,IAAKxO,EAC1D,CAkBA,SAAS8vD,EAAQ3uD,GACb,KAAOA,KAAM,GACTgrC,GAER,CA4BJ,CAIA,IAAI4jB,GAAiB,GAEjBC,GAAuB3G,GAAU2G,qBAAuB,SAASC,GACjEF,GAAel1D,KAAKo1D,EACxB,EAEA5G,GAAU92C,MAAQ,SAASrJ,EAAO0E,EAAK2B,EAAKf,EAAOgB,GAC/C,GAAIhB,aAAiB3O,KACjB,MAAO,CAAE+I,KAAM,OAAQxM,MAAOktD,GAAUhY,aAAa9iC,IAEzD,GAAoB,iBAATA,EACP,MAAO,CAAE5F,KAAM,SAAUxM,MAAOoS,GAEpC,GAAoB,kBAATA,EACP,MAAO,CAAE5F,KAAM,UAAWxM,MAAOoS,GAGrC,GAAI,KAAKrM,KADTqM,GAAS,IAEL,MAAO,CACH5F,KAAM,SACNxM,MAAOoS,EAAMoW,OAAO,IAK5B,GAAI,cAAcziB,KAAKqM,GAAQ,CAC3B,IAAIjR,EAAMiR,EAAMoW,OAAO,EAAGpW,EAAMjT,OAAS,GACrC07B,EAAM82B,WAAWxwD,GACrB,IAAKwJ,MAAMkwB,IAAQA,GAAO15B,EACtB,MAAO,CACHqL,KAAM,UACNxM,MAAO66B,EAAM,IAGzB,CACA,GAAI,KAAK90B,KAAKqM,GAEV,OADAA,EAAQA,EAAMoW,OAAO,GACjB,KAAKziB,KAAKqM,GACHknC,GAAaxsC,EAAO0E,EAAK2B,EAAKf,GAE9B,CACH5F,KAAM,SACNxM,MAAO,IAAMoS,GAIzB,IAAK,IAAI/Q,EAAI,EAAGA,EAAIsyD,GAAex0D,SAAUkC,EAAG,CAC5C,IAAIwC,EAAS8vD,GAAetyD,GAAG+Q,EAAOgB,GACtC,GAAIvP,EACA,OAAOA,CAEf,CACA,GAA2B,QAAvBuO,EAAMhO,cACN,MAAO,CAAEoI,KAAM,UAAWxM,OAAO,GAErC,GAA2B,SAAvBoS,EAAMhO,cACN,MAAO,CAAEoI,KAAM,UAAWxM,OAAO,GAErC,IAAIg0C,EAAOkZ,GAAU/W,UAAU/jC,EAAOgB,GACtC,GAAI4gC,EACA,MAAO,CAAExnC,KAAM,OAAQxM,MAAOktD,GAAUhY,aAAalB,IAErDnZ,EAAM82B,WAAWv/C,GACrB,OAAKzH,MAAMkwB,IAAQzoB,EAAMjT,OAAS,GAAK07B,GAAOzoB,GAC1CgB,EAAS,KACLynB,GAAOtsB,KAAKgnB,MAAMsF,KAClBznB,EAAS,KAAOzS,OAAOk6B,GAAK92B,MAAM,KAAK,GAAGnD,QAAQ,MAAO,MAEtD,CACH4L,KAAM,SACNxM,MAAO66B,EACPznB,OAAQA,IAGT,CACH5G,KAAM,SACNxM,MAAOoS,EAEf,EAqDA66C,GAAU6G,oBAnkCV,SAA6B9pD,EAAM+pD,GAC/B,IAAIC,EAAU1a,GAAa,KAAM,EAAG,EAAGtvC,GACvC,KAAMgqD,EAAQ7F,eAAenB,IACzB,MAAM,IAAIx6C,GAAW,iBAAmBxI,GAI5C,GAFAgqD,EAAUA,EAAQ7F,MAEZ4F,aAAelH,IAAQ,CACzB,IAAIoH,EAAS3a,GAAa0a,EAAQlnD,MAAO,EAAG,EAAGinD,GAE3CA,EADAE,EAAO9F,eAAetB,GAChBoH,EAAO9F,IACN,2BAA2BpoD,KAAKkuD,EAAO9F,IAAI3hD,MAC5CynD,EAAO9F,IAAInuD,MAEX0wD,GAAYuD,EAE1B,CAEA,MAAO,CACHjqD,KAAMgqD,EACNh0D,MAAO+zD,EAEf,EA8iCA9G,GAAU3T,aAAeA,GACzB2T,GAAUnO,eA7yCV,SAA0B90C,EAAMkqD,GAC5B,GAA0B,UAAtBlqD,EAAK5F,cACL,OAAOwoD,GAAcvxB,SAEzB2M,EAAK,CAID,IAAIrjC,EACJ,KAAKA,EAAI,6BAA6BoH,KAAK/B,IAA3C,CAUA,IAFA,IAAImqD,EAASjG,GAAclkD,EAAM,CAAC,GAC9BZ,EAAI,KACK,CACT,IAAIyD,EAAMsnD,EAAOpkB,OACjB,GAAIljC,aAAekgD,GAEflgD,EAAI6oB,IAAM,MACP,MAAI7oB,aAAeigD,IAItB,MAAM9kB,EAHNn7B,EAAI8B,QAAQ+mB,IAAM,EAClB7oB,EAAIwL,YAAYqd,IAAM,CAG1B,CAEA,GADAtsB,EAAE3K,KAAKoO,GACHsnD,EAAOhnC,MACP,MAEJ,IAAKgnC,EAAO1rD,GAAG,KAAM8kD,GAAWE,KAC5B,MAAMzlB,EAEVmsB,EAAOpkB,MACX,CACA,OAAmB,GAAZ3mC,EAAEjK,OAAciK,EAAE,GAAK,IAAIwjD,GAAch2C,SAASxN,EAvBzD,CANI,IAAIoI,EAAMy8C,GAAOtpD,EAAE,IAAKwO,EAAM66C,GAAOrpD,EAAE,IACvC,GAAI6M,EAAM,SAAY2B,EAAM,MACxB,OAAO,IAAI45C,GAAUkB,GAAOtpD,EAAE,IAAKqpD,GAAOrpD,EAAE,IA4BxD,CACA,IAAKuvD,EACD,MAAM,IAAIjrD,MAAM,2BAA6Be,EAErD,EAkwCAijD,GAAUtlB,QAAU+oB,GACpBzD,GAAUmH,WAnBV,SAAoBhiD,EAAOZ,EAAK2B,GAG5Bf,EAAQ87C,GAAc97C,EAAO,CAAEZ,IAF/BA,EAAMA,GAAO,EAE4B2B,IADzCA,EAAMA,GAAO,IAGb,IADA,IAAI7B,EAAO,IACHc,EAAM+a,OAAO,CACjB,IAAItgB,EAAMuF,EAAM29B,OAChB,GAAgB,OAAZljC,EAAIL,KACJ,MAAM,IAAIgG,GAAW,kCAAoC+f,KAAKC,UAAU3lB,IAE5EyE,EAAK7S,KAAKoO,EAAImpB,SAASxkB,EAAK2B,GAChC,CACA,OAAO7B,CACX,EAQA27C,GAAUyF,YAAcA,GACxBzF,GAAUz6C,WAAaA,GACvBy6C,GAAU5jC,SA3DV,SAAkBjX,EAAOZ,EAAK2B,GAC1B,IAAIiW,EAAS,GAEb,IADAhX,EAAQ87C,GAAc97C,EAAO,CAAEmgD,WAAW,EAAM/gD,IAAKA,EAAK2B,IAAKA,KACvDf,EAAM+a,OACV/D,EAAO3qB,KAAKsxC,KAEhB,IAAI5mB,EAAMC,EAAO,GAIjB,MAHgB,MAAZD,EAAI3c,MAA6B,KAAb2c,EAAInpB,QACxBmpB,EAAI3c,KAAO,YAER4c,EAEP,SAAS2mB,IACL,IAAI5mB,EAAM/W,EAAM29B,OAiBhB,MAhBgB,OAAZ5mB,EAAI3c,KACa,QAAb2c,EAAI2lC,OACJ3lC,EAAI3c,KAAO,OACX2c,EAAInpB,OAAQ,GACQ,SAAbmpB,EAAI2lC,QACX3lC,EAAI3c,KAAO,OACX2c,EAAInpB,OAAQ,GAEG,OAAZmpB,EAAI3c,OACX2c,EAAM,CACF3c,KAAQ,MACRK,IAAgB,MAAP2E,GAAsB,MAAP2B,EAAcgW,EAAI6M,SAASxkB,EAAK2B,GAAOgW,EAC/D9F,MAAQ8F,EAAI9F,MACZC,IAAQ6F,EAAI7F,MAGb6F,CACX,CACJ,EAgCAyqC,IAAqB,SAASxhD,EAAOs1B,GACjC,IAAI/iC,EAAGqvC,EAAO,EAAG5gC,EAAS,GAK1B,GAHKs0B,IACDA,EAAiB3pC,MAAM60B,UAAUC,SAASC,SAASpuB,GAElDC,EAAI,6CAA6CoH,KAAKqG,GAAS,CAChE,IAAIshC,EAAKhpC,SAAS/F,EAAE,GAAI,IACpBipD,EAAMjpD,EAAE,GACRqxC,EAAKtrC,SAAS/F,EAAE,GAAI,IACpB6uC,EAAK9oC,SAAS/F,EAAE,GAAI,IACpB6uC,EAAK,GACLA,GAAM,IACCA,EAAK,MACZA,GAAM,MAEV,IAAI6gB,GAAa3sB,GAAiBA,EAAer4B,QAAQ,KAAOq4B,EAAer4B,QAAQ,KACvF,GAAIqkC,EAAK,KAAO2gB,EAAY,CACxB,IAAIppD,EAAMyoC,EACVA,EAAKsC,EACLA,EAAK/qC,EACLopD,GAAa,CACjB,CACA,IAAKnH,GAAUnX,UAAUvC,EAAIE,EAAIsC,GAC7B,OAAO,MAEXhC,EAAOkZ,GAAUtX,SAASpC,EAAIE,EAAK,EAAGsC,IAC3B,GAAKhC,IAEZ5gC,EADAihD,EACS,CAAC,KAAM,KAAM,QAAQpzD,KAAK2sD,GAE1B,CAAC,KAAM,KAAM,QAAQ3sD,KAAK2sD,GAEvCx6C,GAAUzO,EAAE,GACZyN,EAAQA,EAAMoW,OAAO7jB,EAAE,GAAGxF,OAC9B,CAEA,GAAKwF,EAAI,gBAAgBoH,KAAKqG,GAAS,CACnC,IAAI4iC,EAAKtqC,SAAS/F,EAAE,GAAI,IACpBswC,EAAKvqC,SAAS/F,EAAE,GAAI,IACxB,MAAO,CACH6H,KAAS,OACT4G,OAASA,EAAS,QAClBpT,MAASg0C,EAAOkZ,GAAUnY,SAASC,EAAIC,EAAI,EAAG,GAEtD,CAEA,GAAKtwC,EAAI,uBAAuBoH,KAAKqG,GAAS,CACtC6iC,EAAKvqC,SAAS/F,EAAE,GAAI,IAAxB,IACIunC,EAAKxhC,SAAS/F,EAAE,GAAI,IACpB8vC,EAAwB,IAAnBkd,WAAWhtD,EAAE,IACtB,MAAO,CACH6H,KAAS,OACT4G,OAASA,EAAS,WAClBpT,MAASg0C,EAAOkZ,GAAUnY,SAAS,EAAGE,EAAI/I,EAAIuI,GAEtD,CAEA,GAAK9vC,EAAI,sBAAsBoH,KAAKqG,GAAS,CACrC4iC,EAAKtqC,SAAS/F,EAAE,GAAI,IACpBswC,EAAKvqC,SAAS/F,EAAE,GAAI,IACpBunC,EAAKxhC,SAAS/F,EAAE,GAAI,IACxB,MAAO,CACH6H,KAAS,OACT4G,OAASA,EAAS,WAClBpT,MAASg0C,EAAOkZ,GAAUnY,SAASC,EAAIC,EAAI/I,EAAI,GAEvD,CAEA,GAAKvnC,EAAI,6BAA6BoH,KAAKqG,GAAS,CAC5C4iC,EAAKtqC,SAAS/F,EAAE,GAAI,IACpBswC,EAAKvqC,SAAS/F,EAAE,GAAI,IACpBunC,EAAKxhC,SAAS/F,EAAE,GAAI,IACpB8vC,EAAwB,IAAnBkd,WAAWhtD,EAAE,IACtB,MAAO,CACH6H,KAAS,OACT4G,OAASA,EAAS,cAClBpT,MAASg0C,EAAOkZ,GAAUnY,SAASC,EAAIC,EAAI/I,EAAIuI,GAEvD,CACJ,IAIAmf,IAAqB,SAASxhD,GAC1B,IAAIzN,EAAGI,EACH6tB,EAAU70B,MAAM60B,UAChB0hC,EAAQ1hC,EAAQwV,aAAa,KAC7B4c,EAAMpyB,EAAQwV,aAAa,KAC3BP,EAAWjV,EAAQwV,aAAaP,SAAS+pB,OACzC2C,EA+FR,SAAyBD,EAAOtP,GAC5B,IAAIv/C,EAAK6uD,EAAQtP,EACbyO,EAAKe,GAAiB/uD,GACrBguD,IAEDA,GADAA,EAAK,iCACG7yD,QAAQ,OAAQ,KAAOokD,GAAKpkD,QAAQ,OAAQ,KAAO0zD,GAC3Db,EAAK,IAAIrtD,OAAOqtD,GAChBe,GAAiB/uD,GAAMguD,GAE3B,OAAOA,CACX,CAzGgBgB,CAAgBH,EAAOtP,GAC/B0P,EAAQ,IAAItuD,OAAO,UAAYyhC,EAAW,QAC1CkH,EAAO,EACP37B,EAAS,GACTuhD,EAAS,GACTC,GAAe,EACfC,GAAc,EAgBlB,IAdAziD,EAAQsgD,GAAYtgD,EAAMxR,QAAQ,aAAc,MAGtC8I,KAAK,WACXqlC,GAAQ,IAIPpqC,EAAIyN,EAAM1I,KAAKgrD,MAChBE,GAAe,EACfxhD,GAAU,IAAMzO,EAAE,GAAK,KAIvByN,EAAM1I,KAAK,SAAU,CACrB,GAAIqlC,EAAO,EACP,OAAO,KAEXA,GAAQ,CACZ,CAGA,KAAMhqC,EAAIqN,EAAM1I,KAAK6qD,IACjB,OAAO,KAKX,GAHAnhD,GAAU,IAGLzO,EAAIyN,EAAM1I,KAAKgrD,GAAS,CACzB,GAAIE,EACA,OAAO,KAEXA,GAAe,EACfD,EAAS,IAAMhwD,EAAE,GAAK,GAC1B,CAQA,IALKiwD,IAAiBjwD,EAAIyN,EAAM1I,KAAK,eACjCmrD,GAAc,EACdF,EAAShwD,EAAE,KAGVyN,EAAM+a,MACP,OAAO,MAGPpoB,EAAE,IAAM6vD,KACRxhD,EAASA,EAAOxS,QAAQ,IAAK,KAC7BwS,GAAU,MAEVrO,EAAE,KACFqO,GAAU,IAAM0hD,GAAO,IAAK/vD,EAAE,GAAG5F,OAAS,IAE9C,IAAIa,EAAQ+E,EAAE,GACTnE,QAAQ,IAAIwF,OAAO,KAAOkuD,EAAO,KAAM,IACvC1zD,QAAQ,IAAIwF,OAAO,KAAO4+C,EAAK,KAAM,KAY1C,OAVAhlD,EAAQ2xD,WAAW3xD,GACf60D,IACA70D,GAAS,KAGboT,GAAUuhD,EACNC,IACAxhD,GAAU,KAAOA,GAGd,CACH5G,KAAM,SACNq7B,SAAU+sB,EACVxhD,OAAQA,EACRpT,MAAO+uC,EAAO/uC,EAEtB,IAEA4zD,IAAqB,SAASxhD,GAC1B,IAAIzN,EACJ,GAAKA,EAAI,6BAA6BoH,KAAKqG,GACvC,MAAO,CACH5F,KAAM,SACNxM,MAAO2xD,WAAWv/C,GAAS,IAC3BgB,OAAQ,KAAO0hD,GAAO,IAAKnwD,EAAE,GAAGxF,QAAUwF,EAAE,GAGxD,IAEA,IAAI6vD,GAAmB,CAAC,EAaxB,SAASM,GAAO3zD,EAAKwjB,GAEjB,IADA,IAAI5d,EAAM,GACH4d,KAAQ,GACX5d,GAAO5F,EAEX,OAAO4F,CACX,CAWA,IAAIguD,GAAMh3D,MAAMwF,OACZ2H,GAAWnN,MAAMsB,KAAK6L,SACtB4zC,GAAiB/gD,MAAMsN,YAAYkH,KAAKusC,eAExCkW,GAAqB,CAGrBC,mBAAqB,uBACrBC,gBAAqB,qBAGrBC,GAAY,KAWhB,IAAIC,GAAW,CAAC,YAAa,MAAO,KAChCC,GAAU,CAAC,OAAQ,OACnBC,GAAmB,CAAC,eAAgB,eACpCC,GAAc,CAAC,YAAa,MAAO,IAAK,KACxCC,GAAY,CAAC,aAAc,aAC3BC,GAAW,CAAC,aAAc,YAAa,QACvCC,GAAU,CAAC,YAAa,OACxBC,GAAgB,CAAC,aAAc,YAAa,aAC5CC,GAAY,CAAC,SAAU,SACvBC,GAAa,CAAC,YAAa,MAAO,IAAK,MACvCC,GAAW,CAAC,KACZC,GAAoB,CAAC,MACrBC,GAAY,CAAC,YAAa,MAAO,IAAK,KACtCC,GAAW,CAAC,YAAa,gBACzBC,GAAiB,CAAC,aAAc,aAChCC,GAAgB,CAAC,aAAc,aAC/BC,GAAiB,CAAC,mBAUlBC,GAAiB,CAAC,kBAAmB,kBACrCC,GAA0B,CAAC,kBAAmB,iBAAkB,YAChEC,GAA0B,CAAC,kBAAmB,iBAAkB,YA6BhEC,GAAwB,CAAC,sBAAuB,sBAChDC,GAA8B,CAAC,sBAAuB,qBAAsB,YAC5EC,GAAiC,CAAC,sBAAuB,qBAAsB,eAAgB,QAC/FC,GAAiC,CAAC,sBAAuB,qBAAsB,eAAgB,QAG/FC,GAAc,CAAC,cAAe,WAC9BC,GAAa,CAAC,UAAW,UACzBC,GAAmB,CAAC,KAExB,SAASC,GAAGC,GAQR,MAPK,MAAMjxD,KAAKixD,GAKZA,EAAOA,EAAKxuC,OAAO,GAJd,QAAQziB,KAAKixD,KACdA,EAAO,MAAQA,GAKhBA,CACX,CAEAC,eAAeC,GAAaC,EAAK5rD,EAAU6rD,GACvCjC,GAAY5pD,EAAS6T,kBAAoB,GAEzC,IAAIi4C,QAAgBC,GAAYH,GAC5BI,QAAsBC,GAAkBL,EAAK,sBAC7CM,QAAcC,GAAUP,EAAKI,EAAcI,OAAOF,MAAM,IACxDt2C,QAAey2C,GAAWT,EAAKM,GAC/BI,EAAQ,GACRrhD,EAAc,QAEZshD,GAAQX,EAAK,kBAAmB,CAClCY,MAAO,SAASC,EAAK/tD,GACjB,GAAInM,KAAK2K,GAAGmtD,IAAY,CACpB,IAAIqC,EAAQhuD,EAAM,QACd+sD,EAAOO,EAAcW,KAAKD,GAC1BjuD,EAAOC,EAAMD,KACbmuD,EAiHpB,SAAyBC,GACrB,IAAIvrD,EAAKsrD,EAAM,CACXtiD,KAAM,EACNkC,KAAM,GA6BV,OA1BA7M,GAASktD,EAAO,CACZL,MAAO,SAASC,EAAK/tD,GACN,aAAP+tD,GACAnrD,EAAMiyC,GAAe70C,EAAM4C,MACnBwL,cACJ8/C,EAAIpgD,KAAOlL,EAAIwL,YAAYlF,IAAM,EACjCglD,EAAItiD,KAAOhJ,EAAIwL,YAAY7G,IAAM,GAEtB,kBAARwmD,GACH/tD,EAAMouD,kBACNF,EAAIloD,YAAcqoD,GAAW3G,WAAW1nD,EAAMouD,mBAG9CpuD,EAAMsuD,mBACNJ,EAAIhoD,UAAYqoD,GAAY7G,WAAW1nD,EAAMsuD,qBAE1Cz6D,KAAK2K,GAAGitD,KAAYzrD,EAAM9F,EACjCg0D,EAAItiD,KAAOtH,KAAKmK,IAAIy/C,EAAItiD,MAAO5L,EAAM9F,GAC9BrG,KAAK2K,GAAG2sD,KAAanrD,EAAM9F,IAClC0I,EAAMiyC,GAAe70C,EAAM9F,GAC3Bg0D,EAAItiD,KAAOtH,KAAKmK,IAAIy/C,EAAItiD,KAAMhJ,EAAI2E,IAAM,GACxC2mD,EAAIpgD,KAAOxJ,KAAKmK,IAAIy/C,EAAIpgD,KAAMlL,EAAIsG,IAAM,GAEhD,IAGGglD,CACX,CAlJ0BM,CAAgBlB,EAAca,MAAMpB,IAE9CzrD,EAASnN,QAAQ6R,YAAckoD,EAAIloD,aAAe1E,EAASnN,QAAQ6R,YACnE1E,EAASnN,QAAQ+R,UAAYgoD,EAAIhoD,WAAa5E,EAASnN,QAAQ+R,UAE/D0nD,EAAMp5D,KAAK,CACP8M,SAAUA,EACV4rD,IAAKA,EACLE,QAASA,EACTl2C,OAAQA,EACR61C,KAAMA,EACN54D,QAAS,CACL4L,KAAMA,EACN6L,KAAMtH,KAAKmK,IAAInN,EAASnN,QAAQyX,MAAQ,EAAGsiD,EAAItiD,MAC/CC,QAASvH,KAAKmK,IAAInN,EAASnN,QAAQ0X,SAAW,EAAGqiD,EAAIpgD,MACrD9H,YAAakoD,EAAIloD,YACjBE,UAAWgoD,EAAIhoD,YAG3B,MAAWrS,KAAK2K,GAAGwtD,KACXhsD,EAAMyuD,YACNliD,EAAcmiD,GAAQ1uD,EAAMyuD,WAGxC,EACAh4D,KAAM,SAASA,GACX,IAAIuJ,EAAQnM,KAAK2K,GAAG6sD,IACpB,GAAIrrD,IAAW2jC,GAAK3jC,EAAgB,YAAM2jC,GAAK3jC,EAAM2uD,aAAe,CAChE,IAAIC,EAAe5uD,EAAM4uD,aACrB/rD,EAAQ,KACQ,MAAhB+rD,IACA/rD,EAAQ+qD,EAAMgB,GAAcz6D,QAAQ4L,MAExC,IAAIA,EAAOC,EAAMD,KACL,yBAARA,IACI8C,IACA9C,EAAO,IAAM8C,EAAMlM,QAAQ,MAAO,OAAS,KAAOoJ,GAEtD8uD,GAAahsD,EAAO,MAAM,WACtBvB,EAASyU,WAAWhW,EAAMtJ,EAAMktC,GAAK3jC,EAAMm4B,QAC/C,GAAG,8BAAgCp4B,GAE3C,CACJ,IAGJ,IAAI+uD,EAAU,IAAIhE,GAAIiE,SACtBD,EAAQ3B,UAAS,SAASzpB,GAClBypB,GACAA,EAAS6B,OAAOtrB,EAExB,IACCzuB,MAAK,WACF,IAAIuoC,EAASl8C,EAASk8C,UAoD9B,SAAsBA,GAClB,IAAK,IAAIpmD,EAAI,EAAGA,EAAIomD,EAAOtoD,OAAQkC,IAC/BomD,EAAOpmD,GACF07C,gBAAe,GACfnvC,cAAc,CAAEmH,QAAQ,GAErC,CAzDQmkD,CAAazR,GAEbl8C,EAASiL,YAAYixC,EAAOjxC,IAExB4gD,GACAA,EAAShrB,SAEjB,IAKJ,SAAoByrB,EAAOtsD,EAAU6rD,GAEjC,IADA,IAAI+B,GAAQ,IAAKpE,GAAIiE,UAAY5sB,UACxB/qC,EAAI,EAAGA,EAAIw2D,EAAM14D,OAAQkC,KAC9B,SAAUnB,EAAOmB,GACb83D,EAAQA,EAAMj6C,MAAK,WACf,IAAIpS,EAAQvB,EAAS6tD,YAAYl5D,EAAM9B,SACvC0O,EAAMiwC,gBAAe,GAErB,IAAIsc,EAAUC,GAAWxsD,EAAO5M,GAC5BytC,EAAO,CACP7gC,MAAOA,EACPsqD,SAAU/1D,GAAKw2D,EAAM14D,OAAS,IAOlC,OAJAk6D,EAAQn6C,MAAK,WACTk4C,EAAS6B,OAAOtrB,EACpB,IAEO0rB,CACX,GACH,CAjBD,CAiBGxB,EAAMx2D,GAAIA,GAGjB83D,EAAMj6C,MAAK,WACPk4C,EAAShrB,SACb,GACJ,CA7BImtB,CAAW1B,EAAOtsD,EAAUwtD,EAChC,CA8BA,SAASO,GAAWxsD,EAAO4Z,GACvB,IAAI8yC,EAAW,IAAIzE,GAAIiE,SAOvB,OALArxC,YAAWsvC,uBACDwC,GAAU/yC,EAAIywC,IAAKzwC,EAAIswC,KAAMlqD,EAAO4Z,EAAI2wC,QAAS3wC,EAAIvF,QAC3Dq4C,EAASptB,SACb,GAAG,GAEIotB,CACX,CA6CA,SAASlB,GAAW54D,GAMhB,OAJwB,IAGR,IAAMA,EAAO6O,KAAKgnB,MAAM,IAHhB,IAG4C,IAExE,CAEA,SAASijC,GAAYkB,GACjB,OAAOA,GAAO,EAAI,EACtB,CAEAzC,eAAewC,GAAUtC,EAAKH,EAAMlqD,EAAOuqD,EAASl2C,GAChD,IACItU,EAAKL,EAAMxM,EAAO+zB,EAAS4lC,EAAcC,EAKzCC,EAAUC,EAEVnV,EACAD,EACAqV,EACAC,EACAC,EACAC,EAbAC,EAAiB,CAAC,EAElBC,EAAQttD,EAAM0L,SAASD,OACvB8hD,EAAc,KACdC,EAAWtD,EAAKp2D,QAAQ,eAAgB,qBACxC22D,QAAsBC,GAAkBL,EAAKmD,GAS7CC,EAAU,GACVC,EAAiB,GA2SrB,GAzSArF,GAAYroD,EAAMxB,UAAU8T,kBAE5B43C,EAAOD,GAAGC,SAEJc,GAAQX,EAAKH,EAAM,CACrBe,MAAO,SAASC,EAAK/tD,EAAOwwD,GACxB,IAAIxvD,EAuJ4ByvD,EAAS78C,EAtJzC,GAAI/f,KAAK2K,GAAG8sD,IACJkF,GACe,UAAXxwD,EAAMmlC,GAA6B,MAAZnlC,EAAMsqB,KAC7BR,EAAUjnB,EAAMnB,MAAMwuD,EAAelwD,EAAMsqB,KAAKiT,KAAK,iBAI5D,GAAI1pC,KAAK2K,GAAG2sD,IAAW,CACxBp1D,EAAQ,KACR+zB,EAAU,KACVlnB,EAAM5C,EAAM9F,EACZw1D,EAAe,KAEJ,MAAP9sD,KAOAA,EAAMiyC,GAAeub,IACjBlnD,MACJtG,EAAMA,EAAIqpB,YAEdmkC,EAAcxtD,EASdL,EAAOvC,EAAMmlC,EAEb,IAAIurB,EAAa1wD,EAAM0kC,EACL,MAAdgsB,GACAH,EAAe/7D,KAAK,CAAEoO,IAAKA,EAAM+tD,KAAMD,GAE/C,MACK,GAAI78D,KAAK2K,GAAG+sD,IACb1oD,EAAMnB,MAAM1B,EAAM4C,KAAKuI,aAEtB,GAAItX,KAAK2K,GAAG4sD,IAAU,CACvB,IAEIpzD,EAFA4tB,EAAQ8oC,GAAQ1uD,EAAMuE,KAAO,EAC7BqsD,EAAOtsD,KAAKC,IAAI4rD,EAAOzB,GAAQ1uD,EAAMyO,MAAQ,EAQjD,GANIzO,EAAMhI,OAEQ,KADdA,EAAQq2D,GAAW3G,WAAW1nD,EAAMhI,UAEhC6K,EAAM0L,SAASvT,OAAOjF,MAAM6vB,EAAOgrC,EAAM54D,GAG5B,MAAjBgI,EAAMm4B,QAA4B,IAAVngC,EACxB,IAAK,IAAI2iC,EAAK/U,EAAO+U,GAAMi2B,EAAMj2B,IAC7B93B,EAAMi2B,WAAW6B,GAGN,MAAf36B,EAAMrI,OAEN44D,EAAe3tC,QAAQ,CACnBhgB,IAAK,IAAI9O,MAAMsN,YAAYyM,SACvB,IAAI/Z,MAAMsN,YAAYowB,SAASje,IAAUqS,GACzC,IAAI9xB,MAAMsN,YAAYowB,QAASje,IAAUq9C,IAE7CD,KAAM3wD,EAAMrI,OAGxB,MACK,GAAI9D,KAAK2K,GAAGitD,IAAU,CACvB,IACIxzD,EADAsP,EAAMmnD,GAAQ1uD,EAAM9F,GAAK,EAEzB8F,EAAM6wD,IAES,KADf54D,EAASs2D,GAAY7G,WAAW1nD,EAAM6wD,OAElChuD,EAAMwL,MAAMrT,OAAOjF,MAAMwR,EAAKA,EAAKtP,GAGtB,MAAjB+H,EAAMm4B,QAA6B,IAAXlgC,GACxB4K,EAAMo2B,QAAQ1xB,EAEtB,MACK,GAAI1T,KAAK2K,GAAGktD,KACb,GAAI1rD,EAAMgL,WAAY,CAClB,IAAI8lD,EAAQjc,GAAe70C,EAAMgL,YACjCnI,EAAMhB,OAAOivD,GAAO,EACxB,OAEC,GAAIj9D,KAAK2K,GAAGgtD,IACTxrD,EAAMiC,OAASjC,EAAMiC,MAAMmD,QAAQ,WAAa,IAC5CpF,EAAM+wD,QACNluD,EAAM6I,cAAcgjD,GAAQ1uD,EAAM+wD,SAGlC/wD,EAAMgxD,QACNnuD,EAAM8I,WAAW+iD,GAAQ1uD,EAAMgxD,eAItC,GAAIn9D,KAAK2K,GAAGytD,IACbppD,EAAM8D,cAAcg9B,GAAK3jC,EAAM2G,eAAe,SAE7C,GAAI9S,KAAK2K,GAAG0tD,IAAgB,CAC7B,IAAI8B,EAAQhuD,EAAM,QACd6F,EAASynD,EAAcW,KAAKD,GAC5BnoD,GACAhD,EAAMnB,MAAM1B,EAAM4C,KAAKyD,KAAKR,EAEpC,MACShS,KAAK2K,GAAG2tD,IACTnsD,EAAM6C,OACNA,EAAMnB,MAAM5N,MAAMsN,YAAYgwB,UAAUrqB,QAAO,GAG9ClT,KAAK2K,GAAG,CAAC,gBACdk8C,EAAY16C,EAAM4C,IACd4tD,GACAS,KAGCvW,IACD7mD,KAAK2K,GAAG,CAAC,iBACTi8C,EAAeh6C,SAAST,EAAMkxD,MAAO,IAEhCr9D,KAAK2K,GAAG,CAAC,mBACdsxD,EAAoBnsB,GAAK3jC,EAAMmxD,KAAO,MAAQ,KAC9CpB,EAAuB,IAElBl8D,KAAK2K,GAAG,CAAC,kBACdwC,EAgVpB,SAAyBoiD,EAAIrtD,GACzB,IAAIq7D,EAAQ,CACRC,MAAsB,KACtBC,SAAsB,KACtB5hB,YAAsB,KACtBsb,mBAAsB,MACtBrb,SAAsB,KACtBsb,gBAAsB,OACxB7H,GAIF,GAFArtD,EAAQw7D,GAAax7D,GAEjBq7D,GAAyB,iBAATr7D,EAChB,MAAO,CAAEuqB,SAAU8wC,EAAOr7D,MAAOA,GAGrC,IAAW,YAANqtD,IAAqBA,IAAuB,iBAATrtD,EAKpC,MAAO,CACHuqB,SAAU8iC,EAAK,eAAiB,UAChCrtD,MAAOA,EAGnB,CA1W0By7D,CAAgBxxD,EAAMsgB,SAAUtgB,EAAMse,KACxCtd,GACA+uD,EAAqBv7D,KAAK,CACtB8rB,SAAUtf,EAAIsf,SACdvqB,MAAOiL,EAAIjL,SAIdlC,KAAK2K,GAAG,CAAC,kBACd8xD,EAAQ97D,KAAK,CACT2c,OAAQspC,EACRzpC,OAAQ,IAAIld,MAAMsN,YAAYqwD,cAAc,CACxClvD,KAAMmvD,GAAkB1xD,EAAMuC,UAIjC1O,KAAK2K,GAAG,CAAC,UACd8xD,EAAQ97D,KAAK,CACT2c,OAAQspC,EACRzpC,OAAQ,IAAIld,MAAMsN,YAAYuwD,UAAU,CACpC57D,MAAOw7D,GAAavxD,EAAMse,KAC1B/b,MAAgBkuD,EAKb9sB,GAAK3jC,EAAMywD,SALW78C,EAKD+vB,GAAK3jC,EAAM4T,KAJxB68C,GAAW78C,EAAM,aACjBA,EAAM,YACN68C,EAAU,gBACV,oBAKd58D,KAAK2K,GAAG,CAAC,aACdwxD,EAAoBrsB,GAAK3jC,EAAM4xD,OAC/B3B,EAAoB,IAEfp8D,KAAK2K,GAAG,CAAC,YACdyxD,EAAkBz7D,KAAK+8D,GAAavxD,EAAMse,MAGtD,EACAuzC,MAAO,SAAS9D,EAAK/tD,GACjB,GAAInM,KAAK2K,GAAG8sD,IACHxhC,GAAsB,UAAX9pB,EAAMmlC,GAA6B,MAAZnlC,EAAMsqB,KACzCR,EAAUjnB,EAAMnB,MAAMwuD,EAAelwD,EAAMsqB,KAAKiT,KAAK,iBAGxD,GAAI1pC,KAAK2K,GAAG2sD,IAAW,CACxB,GAAe,MAAXrhC,EACa+kC,GAAahsD,EAAO6sD,GAAgB9sD,GAAK,WAClDC,EAAMnB,MAAMguD,GAAgB9sD,GAAKknB,QAAQA,EAAS6lC,EACtD,GAAG,oBAEC9sD,EAAMnB,MAAMguD,GAAgB9sD,GAAK7M,MAAM+zB,GAClC2S,WAAW,gBAEjB,GAAa,MAAT1mC,EAAe,CACtB,IAAI2L,EAAQmB,EAAMnB,MAAMkB,GAEnBlB,EAAM67B,KAAK,aAEPh7B,GAAgB,KAARA,EAEM,KAARA,EACPxM,EAAQq3D,EAAQsB,GAAQ34D,IACT,KAARwM,EACPxM,EAAkB,MAAVA,EACO,KAARwM,IACPxM,EAAQjC,MAAMo4C,UAAUn2C,IANxBA,EAAQ2xD,WAAW3xD,GASV,MAATA,GACA2L,EAAM3L,MAAMA,GAGxB,CACJ,MAAWlC,KAAK2K,GAAG4tD,KACRv4D,KAAK2K,GAAG+tD,IACf,WACI,IAAIllD,EAAOvT,MAAMsN,YAAYkH,KAAK6hD,WAAWnqD,EAAM8xD,OAC/CvvD,EAAOvC,EAAMuC,KAAKpI,cAClBmmB,EAAWtgB,EAAMsgB,SACjB,sBAAsBxkB,KAAKyG,GAE3BA,EAAO,SACQ,QAARA,IAEP+d,EAAW,SAEVA,GAAY,oBAAoBxkB,KAAKyG,KAGtC+d,EAAW,WAEfjZ,EAAK1E,SAAQ,SAASC,GAClBisD,GAAahsD,EAAOD,GAAK,WACrBC,EAAMnB,MAAMkB,GAAKiS,WAAW,CACxBtS,KAAmBohC,GAAK3jC,EAAM+xD,kBAAkB,GAAQ,SAAW,UACnE1kB,KAAmBuiB,EACnBtiB,GAAmBuiB,EACnBtiB,SAAmBhrC,EACnBirC,aAAmBud,GAAmBzqC,IAAaA,EACnDmtB,WAAmB9J,GAAK3jC,EAAMgyD,YAC9BpkB,WAAmBjK,GAAK3jC,EAAMiyD,eAAyB,QAAR1vD,GAA0B,QAARA,EACjEyrC,gBAAmBhuC,EAAMsiC,MACzB2L,cAAmBjuC,EAAMkyD,YAEjC,GAAG,qBACP,GACH,CA/BD,GAgCc,QAAPnE,EACPlrD,EAAM0L,SAASyrC,WACD,aAAP+T,EACPlrD,EAAMwL,MAAM2rC,WACE,cAAP+T,EACPkD,IACOvW,IACI,iBAAPqT,EACAuC,EAAQ97D,KAAK,CACT2c,OAAQspC,EACRzpC,OAAQ,IAAIld,MAAMsN,YAAY2Q,aAAa,CACvCogD,MAAOrC,EACPsC,SAAUrC,MAGJ,WAAPhC,GACPuC,EAAQ97D,KAAK,CACT2c,OAAQspC,EACRzpC,OAAQ,IAAIld,MAAMsN,YAAYyQ,YAAY,CACtC7W,OAAQi1D,EACRoC,OAAQrC,MAK5B,EACAv5D,KAAM,SAASA,GACX,IAAIuJ,EACAnM,KAAK2K,GAAGutD,KAAcl4D,KAAK2K,GAAGotD,IAC9B71D,EAAQU,GACAuJ,EAAQnM,KAAK2K,GAAG8sD,MACxBxhC,EAAUrzB,GACVk5D,EAA4B,SAAX3vD,EAAMmlC,GAEnBuqB,EAAe1vD,EAAM4C,IACH,UAAX5C,EAAMmlC,IACb+qB,EAAelwD,EAAMsqB,IAAM1nB,IAExB/O,KAAK2K,GAAG6tD,KACRx4D,KAAK2K,GAAGiuD,IACfmD,EAAWn5D,EACJ5C,KAAK2K,GAAG8tD,KACRz4D,KAAK2K,GAAGkuD,IACfmD,EAAWp5D,EACJ5C,KAAK2K,GAAGguD,MAEf34D,KAAKa,MAAMb,KAAKa,MAAMQ,OAAS,GAAG48D,MAAQr7D,EAElD,IAGJ85D,EAAe5tD,SAAQ,EAAGC,MAAK+tD,SA6SnC,SAAoB9tD,EAAOD,EAAKsU,EAAQw5C,GACpC,IAC0Cv8C,EAAMpe,EAD5C2L,EAAQmB,EAAMnB,MAAMkB,GACpB0vD,EAAKp7C,EAAOq7C,aAAa7B,GACzB4B,EAAGE,OACHr+C,EAAO+C,EAAOu7C,YAAYH,EAAGE,OAE7BE,EAAU,cAAe,aACzBC,EAAUz7C,EAAOolB,QAAQvmC,IAEzB28D,EAAU,YAAa,WACvBE,EAAQ17C,EAAO27C,MAAM98D,IAErB28D,EAAU,iBAAkB,cAC5BhxD,EAAMg7B,UAAU3mC,GAEhB28D,EAAU,iBAAkB,kBAC5BhxD,EAAMi7B,cAAc5mC,GAEpB28D,EAAU,iBAAkB,WAC5BhxD,EAAMoxD,OAAO/8D,GAEb28D,EAAU,iBAAkB,aAE5BhxD,EAAMH,UAAU,OAAQxL,GAExB28D,EAAU,YAAa,WACvBK,EAAQ77C,EAAO87C,MAAMj9D,IAErB28D,EAAU,oBAAqB,aAC/BO,EAAU/7C,EAAOg8C,QAAQn9D,IAAUo9D,GAAgBp9D,IAEnD28D,EAAU,kBAAmB,eAC7BhxD,EAAMqF,QAAQurD,EAAGc,WAAWC,QAGhC,SAASJ,EAAU73D,GACf,IAAI+N,EAAqB,iBAAL/N,EAAgBA,EAAIA,EAAEk4D,WAC5B,MAAVnqD,GAAmB,aAAarN,KAAKqN,KAIrCA,EAASA,EAAOxS,QAAQ,iBAAkB,IAC1C+K,EAAMyH,OAAOA,GAErB,CAEA,SAAS4pD,EAAQ33D,GACC,SAAVA,EAAEmH,MACFb,EAAM+6B,WAAWrhC,EAAEqO,MAE3B,CAEA,SAASmpD,EAAQx3D,GACbsG,EAAMo/B,WAAW1lC,EAAE2E,MAGf3E,EAAE3F,MACFiM,EAAMH,UAAU,WAAqB,EAATnG,EAAE3F,KAAW,GAEzC2F,EAAE0hC,MACFp7B,EAAMo7B,MAAK,GAEX1hC,EAAEyhC,QACFn7B,EAAMm7B,QAAO,GAEbzhC,EAAEoL,WACF9E,EAAM8E,WAAU,GAEhBpL,EAAEqO,OACF/H,EAAM+H,MAAMrO,EAAEqO,MAEtB,CAEA,SAASkpD,EAAU5kD,GACf,SAASoa,EAAIorC,EAAMhpC,GACf,IAAIhhB,EAASwE,EAAEwlD,GACf,GAAKhqD,EAAL,CAIA,IAAIvR,EAAQw7D,GAAcjqD,EAAO5R,OACjC,GAAKK,EAAL,CAIA,IAAIyR,EAAQF,EAAOE,MACN,MAATA,IACAA,EAAQ,QAGZ,IAAI1T,EAAQ,CAAEN,KAAMuC,EAAOyR,MAAOA,GACtB,YAAR8pD,IACAx9D,EAAMwM,KAAOgH,EAAOkqD,IAAM,EAAIlqD,EAAOmqD,MAGzChyD,EAAMH,UAAUgpB,EAAMx0B,EAZtB,CALA,CAkBJ,CAEAoyB,EAAI,OAAQ,cACZA,EAAI,MAAO,aACXA,EAAI,QAAS,eACbA,EAAI,SAAU,gBACdA,EAAI,WAAY,WACpB,CAEA,SAASuqC,EAAUiB,EAAW30B,GAC1B,IAAImG,EAAImtB,EAAGqB,GACX,GAAS,MAALxuB,IAAcA,EACd,OAAO,EAGX,GADApvC,EAAQu8D,EAAGtzB,GACP7qB,GAAiB,MAATpe,EAAe,CAEvB,GAAS,OADTovC,EAAIhxB,EAAKw/C,MACSxuB,EACd,OAAO,EAEXpvC,EAAQoe,EAAK6qB,EACjB,CACA,OAAgB,MAATjpC,CACX,CACJ,CAra6C69D,CAAW/wD,EAAOD,EAAKsU,EAAQy5C,KAEpErD,EAAcI,OAAOmG,SAAU,CAC/B,IAAIC,EAAcC,GAAchH,EAAMO,EAAcI,OAAOmG,SAAS,UA6I5E7G,eAA4BE,EAAKH,EAAMlqD,GACnC,IACImxD,EACArd,EAFAsd,EAAU,SAGRpG,GAAQX,EAAKH,EAAM,CACrBe,MAAO,SAASC,EAAK/tD,GACbnM,KAAK2K,GAAGmuD,IACRhW,EAAU,CACNqd,OAAQC,EAAQj0D,EAAMk0D,UACtBtxD,IAAK5C,EAAM4C,IACXnM,KAAM,IAEH5C,KAAK2K,GAAGouD,MACfoH,EAAS,GAEjB,EACAnC,MAAO,WACCh+D,KAAK2K,GAAGmuD,IACR9pD,EAAMnB,MAAMi1C,EAAQ/zC,KAAK+zC,QAAQA,EAAQlgD,MAClC5C,KAAK2K,GAAGouD,KACfqH,EAAQz/D,KAAKw/D,EAErB,EACAv9D,KAAM,SAASA,GACP5C,KAAK2K,GAAGquD,IACRlW,EAAQlgD,MAAQA,EACT5C,KAAK2K,GAAGouD,MACfoH,GAAUv9D,EAElB,GAER,CA3Kc09D,CAAajH,EAAK4G,EAAajxD,EACzC,CAEA,GAAIyqD,EAAcI,OAAOtqD,QAAS,CAC9B,IAAIgxD,EAAcL,GAAchH,EAAMO,EAAcI,OAAOtqD,QAAQ,UA4B3E4pD,eAA4BE,EAAKH,EAAMlqD,GACnC,IA+BIwxD,EAAKzxD,EAAK5K,EAAOC,EA/BjBq8D,EAAsB,CAAE,qBACxBC,EAAU,CAAE,WACZC,EAAsB,CAAE,qBACxBC,EAAW,CAAE,YACbC,EAAS,CAAE,UACXC,EAAU,CAAE,WACZC,EAAU,CAAE,WACZC,EAAiB,CAAE,cACnBC,EAAiB,CAAE,cACnBC,EAAW,CAAE,eAAgB,UAE7B1E,EAAWtD,EAAKp2D,QAAQ,aAAc,mBACtC22D,QAAsBC,GAAkBL,EAAKmD,GAEjD,GAAI/C,EAAcI,OAAO5pD,MAAO,CAC5B,IAAIkxD,EAAU15D,OAAO2b,KAAKq2C,EAAcW,MACxC,IAAK,IAAI72D,EAAI,EAAGA,EAAI49D,EAAQ9/D,SAAUkC,EAAG,CACrC,IAAIoE,EAAKw5D,EAAQ59D,GACbyM,EAAMkwD,GAAchH,EAAMO,EAAcW,KAAKzyD,IAC7C+G,EAAO0yD,GAAepxD,GAC1B,GAAItB,EAAM,CACN,IAAIlE,QAAa6uD,EAAIH,KAAKlpD,GAAKmpD,MAAM,eACjCjtD,EAAOm1D,GAAYrxD,GACnBK,GAAOnE,GAAUjM,MAAMqb,QAAQ8O,QAAQC,MAAQpqB,MAAMqb,QAAQ8O,QAAQk3C,KAEnE,IAAI7/D,OAAO8/D,KAAK,CAAE/2D,GAAQ,CAAEkE,KAAMA,IADlC,IAAIjN,OAAO+/D,KAAK,CAAEh3D,GAAQ0B,EAAM,CAAEwC,KAAMA,IAE9C+qD,EAAcW,KAAKzyD,GAAMqH,EAAMxB,UAAUyD,SAASZ,EACtD,CACJ,CACJ,OAGM2pD,GAAQX,EAAKH,EAAM,CACrBe,MAAO,SAASC,EAAK/tD,GACjB,GAAInM,KAAK2K,GAAG81D,IAAwBzgE,KAAK2K,GAAGg2D,GACxCH,EAAM,CAAC,OAEN,GAAIxgE,KAAK2K,GAAGi2D,IAAa5gE,KAAK2K,GAAGk2D,GAClC9xD,EAAM,CAAC,OAEN,GAAI/O,KAAK2K,GAAGu2D,GAAW,CACxB,IAAIv5D,EAAKwE,EAAM,WACfq0D,EAAIvwD,MAAQwpD,EAAcW,KAAKzyD,EACnC,MACS3H,KAAK2K,GAAG+1D,KACbv8D,EAAQs9D,GAAc5N,WAAW1nD,EAAMu1D,KACvCt9D,EAASq9D,GAAc5N,WAAW1nD,EAAMw1D,KAEhD,EACA3D,MAAO,WACH,GAAIh+D,KAAK2K,GAAGi2D,GACRJ,EAAI5vD,YAAc,IAAI3Q,MAAMsN,YAAYowB,QAAQ5uB,EAAI2E,IAAK3E,EAAIsG,KAC7DmrD,EAAI1vD,QAAU2wD,GAAc1yD,EAAI6yD,WAChCpB,EAAIzvD,QAAU0wD,GAAc1yD,EAAI8yD,gBAE/B,GAAI7hE,KAAK2K,GAAGk2D,GACbL,EAAIsB,OAAS,IAAI7hE,MAAMsN,YAAYowB,QAAQ5uB,EAAI2E,IAAK3E,EAAIsG,KACxDmrD,EAAIuB,IAAMN,GAAc1yD,EAAI6yD,WAC5BpB,EAAIwB,IAAMP,GAAc1yD,EAAI8yD,gBAG3B,GAAI7hE,KAAK2K,GAAG81D,IAAwBD,EAAIvwD,MAAO,CAChD,IAAIwP,EAAOzQ,EAAM0L,SAASoyB,IAAI,EAAG0zB,EAAI5vD,YAAYyE,IAAM,GAAKmrD,EAAI1vD,QAC5DiP,EAAM/Q,EAAMwL,MAAMsyB,IAAI,EAAG0zB,EAAI5vD,YAAY8C,IAAM,GAAK8sD,EAAIzvD,QACxD4O,EAAQ3Q,EAAM0L,SAASoyB,IAAI,EAAG0zB,EAAIsB,OAAOzsD,IAAM,GAAKmrD,EAAIuB,IACxD/hD,EAAShR,EAAMwL,MAAMsyB,IAAI,EAAG0zB,EAAIsB,OAAOpuD,IAAM,GAAK8sD,EAAIwB,IAE1DhzD,EAAM2B,WAAW,CACbC,YAAc4vD,EAAI5vD,YAClBE,QAAc0vD,EAAI1vD,QAClBC,QAAcyvD,EAAIzvD,QAClB5M,MAAuB,MAATA,EAAgBA,EAAQwb,EAAQF,EAC9Crb,OAAwB,MAAVA,EAAiBA,EAAS4b,EAASD,EACjD9P,MAAcuwD,EAAIvwD,MAClBe,QAAc,GAEtB,MAEShR,KAAK2K,GAAGg2D,IAAwBH,EAAIvwD,OACzCjB,EAAM2B,WAAW,CACbC,YAAc4vD,EAAI5vD,YAClBE,QAAc0vD,EAAI1vD,QAClBC,QAAcyvD,EAAIzvD,QAClB5M,MAAcA,EACdC,OAAcA,EACd6L,MAAcuwD,EAAIvwD,MAClBe,QAAc,GAG1B,EACApO,KAAM,SAASA,GACP5C,KAAK2K,GAAGm2D,GACR/xD,EAAI2E,IAAMmgD,WAAWjxD,GAEhB5C,KAAK2K,GAAGo2D,GACbhyD,EAAIsG,IAAMw+C,WAAWjxD,GAEhB5C,KAAK2K,GAAGq2D,GACbjyD,EAAI8yD,UAAYhO,WAAWjxD,GAEtB5C,KAAK2K,GAAGs2D,KACblyD,EAAI6yD,UAAY/N,WAAWjxD,GAEnC,GAER,CArIcq/D,CAAa5I,EAAKkH,EAAavxD,EACzC,CAEA,SAASouD,IACLpuD,EAAMnB,MAAMg5C,GAAW1pC,OAAOs/C,GAC9B5V,EAAY,IAChB,CACJ,CAEA,SAASua,GAAec,GACpB,IAAIr7D,EAAI,aAAaoH,KAAKi0D,GAC1B,GAAIr7D,GAAKA,EAAE,GACP,MAAO,CACHs7D,IAAO,aACPC,KAAO,aACPC,IAAO,YACPC,IAAO,YACPC,IAAO,aACT17D,EAAE,GAAGP,cAEf,CAEA,SAAS+6D,GAAYa,GACjB,IAAIr7D,EAAI,SAASoH,KAAKi0D,GACtB,OAAOr7D,GAAKA,EAAE,EAClB,CA2KA,SAASg3D,GAAkBnvD,GACvB,MAAO,CACH8zD,GAAM,WACNC,GAAM,WACNC,GAAM,WACNC,GAAM,WACNC,GAAM,UACNC,GAAM,WACNC,GAAM,QACNC,GAAM,QACNC,GAAM,MACNC,GAAM,OACNC,GAAM,OACNC,GAAM,SACNC,GAAM,YACNC,IAAM,UACNC,IAAM,WACNC,IAAM,YACR70D,EAAKwY,gBAAkBxY,CAC7B,CAEA,SAASgvD,GAAajzC,GAClB,IAAItd,EAAM0mD,WAAWppC,GACrB,OAAK5d,MAAMM,IAAQA,GAAOsd,EAGnBA,EAFItd,CAGf,CAEA,SAAS6tD,GAAahsD,EAAOD,EAAK4gC,EAAMzhB,GACpC,IAEI,OADAyhB,KACO,CACX,CAAE,MAAMtnC,GACJ,IAAI2rC,EAAM,CAAE9lB,QAASA,EAASugB,MAAO5rC,OAAOwF,IAU5C,OATI2G,GAASA,EAAM9C,KACf8nC,EAAIhlC,MAAQA,EAAM9C,OACX8C,IACPglC,EAAIhlC,MAAQA,GAEZD,IACAilC,EAAIiP,SAAWpgD,OAAOkM,IAE1BsoD,GAAU12D,KAAKqzC,IACR,CACX,CACJ,CAEA,IAAI2rB,GAAgB,CAChB6D,KAAoB,EACpBC,KAAoB,EACpBC,OAAoB,EACpBC,OAAoB,EACpBC,OAAoB,EACpBC,MAAoB,EACpBC,OAAoB,EACpBC,KAAoB,EACpBC,aAAoB,EACpBC,QAAoB,EACpBC,cAAoB,EACpBC,WAAoB,EACpBC,iBAAoB,EACpBC,aAAoB,GAGpB/E,GAAkB,CAClB,EAAK,UACL,EAAK,IACL,EAAK,OACL,EAAK,QACL,EAAK,WACL,EAAK,KACL,GAAK,QACL,GAAK,WACL,GAAK,QACL,GAAK,UACL,GAAK,WACL,GAAK,WACL,GAAK,QACL,GAAK,SACL,GAAK,aACL,GAAK,gBACL,GAAK,OACL,GAAK,UACL,GAAK,cACL,GAAK,iBACL,GAAK,sBACL,GAAK,sBACL,GAAK,2BACL,GAAK,QACL,GAAK,YACL,GAAK,SACL,GAAK,WACL,GAAK,KA6HT,SAAStF,GAAQX,EAAKH,EAAMzuD,GACxB,OAAO,IAAI65D,SAAQh2B,IACf,IAAInmC,EAAMkxD,EAAIH,KAAKA,GACf/wD,EACAA,EAAIgxD,MAAM,cAAc/3C,MAAKk5C,IACzBltD,GAASktD,EAAO7vD,GAChB6jC,GAAS,IAGbA,GACJ,GAER,CAEA6qB,eAAeK,GAAYH,GACvB,IAAIE,EAAU,GACVh0D,EAAU,KAiBd,aAhBMy0D,GAAQX,EAAK,uBAAwB,CACvC2E,MAAO,WACCh+D,KAAK2K,GAAGstD,MACRsB,EAAQ54D,KAAK4E,GACbA,EAAU,KAElB,EACA3C,KAAM,SAASA,GACP5C,KAAK2K,GAAGqtD,MACO,MAAXzyD,IACAA,EAAU,IAEdA,GAAW3C,EAEnB,IAEG22D,CACX,CAEAJ,eAAeO,GAAkBL,EAAKH,GAClC,IAAI/2D,EAAM,CAAEi4D,KAAM,CAAC,EAAGP,OAAQ,CAAEF,MAAO,IAAMW,MAAO,CAAC,SAC/CN,GAAQX,EAAKJ,GAAGC,GAAQ,QAAS,CACnCe,MAAO,SAASC,EAAK/tD,GACjB,GAAW,gBAAP+tD,EAAuB,CACvB/3D,EAAIi4D,KAAKjuD,EAAMo4D,IAAMp4D,EAAMq4D,OAE3B,IAAI91D,EAAOvC,EAAMs4D,KAAKvjD,MAAM,QAAQ,GAChCwjD,EAAUviE,EAAI03D,OAAOnrD,IAAS,GAClCg2D,EAAQ/jE,KAAKwL,EAAMq4D,QACnBriE,EAAI03D,OAAOnrD,GAAQg2D,CACvB,CACJ,IAEJ,IAAIC,EAAQ,GACRC,EAAW,GACfn9D,OAAO2b,KAAKjhB,EAAIi4D,MAAMtrD,SAAQnH,IAC1B,IAAIu6D,EAAW//D,EAAIi4D,KAAKzyD,GACpBQ,EAAMkxD,EAAIH,KAAKD,GAAGiJ,IAClB/5D,IACAw8D,EAAMhkE,KAAKuhE,GACX0C,EAASjkE,KAAKwH,EAAIgxD,MAAM,eAC5B,IAEJ,IAAI3uD,QAAa85D,QAAQvf,IAAI6f,GAE7B,OADAD,EAAM71D,SAAQ,CAAC5C,EAAM3I,IAAMpB,EAAIm4D,MAAMpuD,GAAQ1B,EAAKjH,KAC3CpB,CACX,CAEA,IAAI0iE,GAAa,CAAC,UAAW,UACzBC,GAAW,CAAC,QAAS,QACrBC,GAAW,CAAC,QAAS,QACrBC,GAAmB,CAAC,UAAW,MAC/BC,GAAkB,CAAC,eAAgB,MACnCC,GAAc,CAAC,UAAW,UAE1BC,GAAiB,CACjBC,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YAAaA,GAAW,YAAaA,GAAW,YAC3DA,GAAW,YACXA,GAAW,YACXA,GAAW,aAGfjM,eAAeW,GAAWT,EAAKM,GAC3B,IAAIt2C,EAAS,CACT27C,MAAe,GACfK,QAAe,CAAC,EAChBF,MAAe,GACf12B,QAAe,GACfm2B,YAAe,GACfF,aAAe,IAEf2G,EAAO,KACPC,EAAO,KACP5vD,EAAS,KACT+oD,EAAK,KAgHT,SAAS8G,EAAMp5D,GACX,IAAIsyD,EAAK,CACL+G,SAAoB3K,GAAQ1uD,EAAMq5D,UAClCC,OAAoB5K,GAAQ1uD,EAAMs5D,QAClCC,OAAoB7K,GAAQ1uD,EAAMu5D,QAClCC,SAAoB9K,GAAQ1uD,EAAMw5D,UAClCC,YAAoB91B,GAAK3jC,EAAMy5D,aAC/BC,YAAoB/1B,GAAK3jC,EAAM05D,aAC/BlH,KAAoB9D,GAAQ1uD,EAAMwyD,OAUtC,SAASmH,EAAQ55D,GACb,GAAmB,MAAfC,EAAMD,GACN,OAAOuyD,EAAGvyD,GAAQ4jC,GAAK3jC,EAAMD,GAErC,CACA,OAbA45D,EAAQ,kBACRA,EAAQ,eACRA,EAAQ,aACRA,EAAQ,aACRA,EAAQ,qBACJA,EAAQ,qBACRrH,EAAGc,WAAa,CAAEC,QAAQ,IAOvBf,CACX,CAEA,SAASsH,EAAS55D,EAAO65D,GACrB,GAAI75D,EAAM85D,IACN,OAAOb,GAAWj5D,EAAM85D,KACrB,GAAI95D,EAAM+5D,QACb,OAAOf,GAAetK,GAAQ1uD,EAAM+5D,UACjC,GAAI/5D,EAAMwtD,MAAO,CACpB,IAAIwM,EAAaxM,EAAMyM,YAAYvL,GAAQ1uD,EAAMwtD,QACjD,IAAKwM,EAID,OAAOH,EAGX,IAAIpwD,EAAQ3V,MAAMulD,WAAW2gB,GAE7B,GAAIh6D,EAAMk6D,KAAM,CACZzwD,EAAQA,EAAM0wD,QAEd,IAAID,EAAOxS,WAAW1nD,EAAMk6D,MAExBzwD,EAAMlP,EADN2/D,EAAO,EACGzwD,EAAMlP,GAAK,EAAI2/D,GAEfzwD,EAAMlP,GAAK,EAAI2/D,IAAS,IAAM,KAAO,EAAIA,GAE3D,CAEA,OAAOzwD,EAAM2wD,WACjB,CACJ,CAEA,aAxKMvM,GAAQX,EAAK,gBAAiB,CAChCY,MAAO,SAASC,EAAK/tD,EAAOwwD,GACxB,GAAI38D,KAAK2K,GAAGu6D,IACR7hD,EAAOg8C,QAAQlzD,EAAMw5D,UAAYx5D,OAEhC,GAAInM,KAAK2K,GAAGo6D,IACb1hD,EAAO27C,MAAMr+D,KAAK0kE,EAAO,CAAC,GACtB1I,IAMA0I,EAAO,WAER,GAAIA,EACI,MAAPnL,EACAmL,EAAKzjE,KAAOiyD,WAAW1nD,EAAMse,KACf,QAAPyvC,EACPmL,EAAKn5D,KAAOC,EAAMse,IACJ,KAAPyvC,EACPmL,EAAKp8B,KAAO6G,GAAK3jC,EAAMse,KAAK,GACd,KAAPyvC,EACPmL,EAAKr8B,OAAS8G,GAAK3jC,EAAMse,KAAK,GAChB,KAAPyvC,EACPmL,EAAK1yD,UAA0B,MAAbxG,EAAMse,KAA4B,UAAbte,EAAMse,IAC/B,SAAPyvC,IACPmL,EAAKzvD,MAAQmwD,EAAS55D,EAAO,YAGhC,GAAInM,KAAK2K,GAAGm6D,IACbzhD,EAAO87C,MAAMx+D,KAAK2kE,EAAO,CAAC,GACtB3I,IACA2I,EAAO,WAER,GAAIA,EACI,eAAPpL,EACAoL,EAAK52D,KAAOvC,EAAMq6D,aACJ,WAAPtM,GAAkC,UAAdoL,EAAK52D,MAElB,WAAPwrD,GAAkC,UAAdoL,EAAK52D,QADhC42D,EAAK1vD,MAAQmwD,EAAS55D,EAAOg5D,GAAe,UAK/C,GAAInlE,KAAK2K,GAAGk6D,IACbxhD,EAAOolB,QAAQ9nC,KAAK+U,EAAS,CACzB+wD,YAAgB32B,GAAK3jC,EAAMs6D,WAAY,GACvCC,cAAgB52B,GAAK3jC,EAAMu6D,aAAc,KAEzC/J,IACAjnD,EAAS,WAEV,GAAIA,GAQP,GAPI,uCAAuCzN,KAAKiyD,KAC5CxkD,EAAOwkD,GAAO,CAAEp2D,MAAOqI,EAAMrI,OAAS,QAC3B,YAAPo2D,IACAxkD,EAAOixD,SAAS/G,GAAKlqD,EAAO+wD,WAC5B/wD,EAAOixD,SAAS9G,KAAOnqD,EAAOgxD,eAG3B,SAAPxM,EAAgB,CAChB,IAAIwF,EAAO1/D,KAAKa,MAAMb,KAAKa,MAAMQ,OAAS,GAAGyJ,KAC7C4K,EAAOgqD,GAAM9pD,MAAQmwD,EAAS55D,EAAOg5D,GAAe,GACxD,OAEKnlE,KAAK2K,GAAGs6D,KACbxG,EAAK8G,EAAMp5D,GACXkX,EAAOu7C,YAAYj+D,KAAK89D,GACpB9B,IACA8B,EAAK,OAEFz+D,KAAK2K,GAAGq6D,KACfvG,EAAK8G,EAAMp5D,GACXkX,EAAOq7C,aAAa/9D,KAAK89D,GACrB9B,IACA8B,EAAK,OAEFA,IACI,aAAPvE,GACI,kCAAkCjyD,KAAKkE,EAAMy6D,cAC7CnI,EAAG51B,UAAY18B,EAAMy6D,YAErB,0BAA0B3+D,KAAKkE,EAAM06D,YACrCpI,EAAG31B,cAAgB38B,EAAM06D,UAEP,MAAlB16D,EAAM26D,WACNrI,EAAGqI,SAAWh3B,GAAK3jC,EAAM26D,WAET,MAAhB36D,EAAM8yD,SACNR,EAAGQ,OAASpE,GAAQ1uD,EAAM8yD,UAEhB,cAAP/E,IACPuE,EAAGc,WAAa,CACZC,OAAQ1vB,GAAK3jC,EAAMqzD,UAInC,EACAxB,MAAO,SAAS9D,GACRl6D,KAAK2K,GAAGo6D,IACRM,EAAO,KACArlE,KAAK2K,GAAGm6D,IACfQ,EAAO,KACAtlE,KAAK2K,GAAGk6D,IACfnvD,EAAS,KACK,MAAPwkD,IACPuE,EAAK,KAEb,IA4DGp7C,CACX,CAEA,IAAI0jD,GAAoB,CAAC,cAAe,IAAK,aACzCC,GAAoB,CAAC,cAAe,IAAK,YAC7C7N,eAAeS,GAAUP,EAAKzhC,GAC1B,IAAIqvC,EAAS,GACTtN,EAAQ,CACRyM,YAAaa,GAGb/N,EAAOD,GAAGrhC,GAsBd,SAASsvC,EAAKC,EAAK77D,EAAG4O,GAClB,IAAI/M,EAAMg6D,EAAI77D,GACd67D,EAAI77D,GAAK67D,EAAIjtD,GACbitD,EAAIjtD,GAAK/M,CACb,CAEA,OA3BIksD,EAAIH,KAAKA,WACHc,GAAQX,EAAKH,EAAM,CACrBe,MAAO,SAASC,EAAK/tD,GACbnM,KAAK2K,GAAGq8D,IACRC,EAAOtmE,KAAKykE,GACK,UAAbj5D,EAAMse,IAAkB,WAAa,aAElCzqB,KAAK2K,GAAGo8D,KACfE,EAAOtmE,KAAKykE,GAAW,KAAOj5D,EAAMse,KAE5C,IAGAw8C,EAAO5lE,OAAS,IAEhB6lE,EAAKD,EAAQ,EAAG,GAEhBC,EAAKD,EAAQ,EAAG,KAUjBtN,CACX,CAEA,SAASkB,GAAQpwC,GACb,OAAc,MAAPA,EAAc,KAAO7d,SAAS6d,EAAK,GAC9C,CAEA,SAASqlB,GAAKrlB,EAAKwrC,GACf,OAAW,MAAPxrC,EACOwrC,EAEG,QAAPxrC,IAAyB,IAARA,GAAuB,GAAPA,CAC5C,CAEA,SAAS26C,GAAWa,GAChB,IAAIp/D,EAAI,0DAA0DoH,KAAKg4D,GACvE,MAAO,QACHr5D,SAAS/F,EAAE,GAAI,IAAM,KACrB+F,SAAS/F,EAAE,GAAI,IAAM,KACrB+F,SAAS/F,EAAE,GAAI,IAAM,KACrB+F,SAAS/F,EAAE,GAAI,IAAM,IAAM,GACnC,CAEA,SAASq5D,GAAc5/C,EAAMpU,GAIzB,IAHAoU,EAAOA,EAAKra,MAAM,OAClBiG,EAAOA,EAAKjG,MAAM,OAClBqa,EAAK7T,MACEP,EAAK7K,QAAQ,CAChB,IAAI+lE,EAAOl7D,EAAK7E,QAChB,GAAa,KAAT+/D,EACA9mD,EAAO,OACJ,IAAa,MAAT8mD,EACP,SACgB,OAATA,EACP9mD,EAAK7T,MAEL6T,EAAK3f,KAAKymE,EACd,CACJ,CACA,OAAO9mD,EAAKnd,KAAK,IACrB,CAEA,SAASs+D,GAAch3C,GACnB,OAAOA,EAAM,IACjB,CAEAxqB,MAAMsN,YAAY85D,UAr1ClB,SAAmBnO,EAAMzrD,EAAUiuD,GAC/B,IAAI4L,EAAS,IAAIC,WACjBD,EAAOE,OAASrO,eAAe9wC,GAC3Bo/C,MAAMC,UAAUr/C,EAAErW,OAAOjM,QACpBqb,MAAK+3C,eAAmBC,GAAaC,EAAK5rD,EAAUiuD,IAC7D,EACA4L,EAAOK,kBAAkBzO,EAC7B,EA+0CAj5D,MAAMsN,YAAYq6D,WAAajM,GAC/B17D,MAAMsN,YAAYs6D,aAAerO,GACjCv5D,MAAMsN,YAAYu6D,YAAchO,GAChC75D,MAAMsN,YAAYw6D,WAAanO,GAC/B35D,MAAMsN,YAAYy6D,cAAgB5O,GAEtC,SAAUn5D,GAKN,IAAIuB,EAAIvB,EAAMwF,OACVinC,EAAUzsC,EAAMsN,YAAYkH,KAAKuS,QAAQ0lB,QACzCjP,EAAMx9B,EAAMsN,YAAYkwB,IACxBoa,EAAY53C,EAAMsN,YAAYsqC,UAElC53C,EAAMsN,YAAY0V,SAASxV,SAAW,CAClCw6D,iBAAkB,SAgBtB,IAAIC,EAAWjoE,EAAME,WAAWC,OAAO,CACnCE,QAAS,CAAC,EAEVD,KAAM,SAASC,EAASypB,GACpB9pB,EAAME,WAAWI,GAAGF,KAAKG,KAAKR,MAE9BA,KAAKM,QAAUA,EAEfN,KAAKwb,MAAQuO,EACb/pB,KAAKogD,QAAU,GACfpgD,KAAKmoE,QAAU,CAAC,EAChBnoE,KAAKooE,OAAS,EAEdpoE,KAAKqoE,mBAAqB,CAAC,EAE3BroE,KAAKqP,OAASrP,KAAKs7D,YAAY,CAC3BvjD,KAAM/X,KAAKM,QAAQyX,KACnBC,QAAShY,KAAKM,QAAQ0X,QACtB3F,UAAWrS,KAAKM,QAAQ+R,UACxBF,YAAanS,KAAKM,QAAQ6R,YAC1B6qC,aAAch9C,KAAKM,QAAQ08C,aAC3BC,YAAaj9C,KAAKM,QAAQ28C,YAC1B/0B,WAAYloB,KAAKM,QAAQ4nB,aAG7BloB,KAAKsoE,cAAgB,IAAIroE,EAAMsB,KAAKrB,cACpCF,KAAKsoE,cAAcp5D,KAAK,CAAC,OAAQ,QAASlP,KAAKuoE,YAAYr5D,KAAKlP,OAEhEA,KAAKwoE,SAAW,IAAIvoE,EAAMsN,YAAYk7D,eAAezoE,MACrDA,KAAK0oE,mBAAqB,IAAIzoE,EAAMsN,YAAYkiC,yBAAyBzvC,MACzEA,KAAK2oE,OAASlhE,OAAOC,OAAO,MAE5B1H,KAAK8zB,SAAS9zB,KAAKM,QACvB,EAEA8X,UAAW,WAIP,OAHIpY,KAAKmY,aACJnY,KAAKmY,WAAa,IAAIlY,EAAMsN,YAAYm4B,UAAU1lC,OAEhDA,KAAKmY,UAChB,EAEA+K,QAAS,WACLljB,KAAK4oE,SAED5oE,KAAKmY,YACLnY,KAAKmY,WAAW+K,SAExB,EAEAxiB,OAAQ,CACJ,MACA,OACA,QACA,WACA,SACA,cACA,cACA,cACA,cACA,cACA,cACA,YACA,eACA,YACA,eACA,UACA,aACA,YACA,eACA,SACA,eACA,cACA,YACA,YAGJmoE,eAAgB,SAASxgD,GACjBroB,KAAKkB,QAAQ,WAAYmnB,IACzBA,EAAEjP,gBAEV,EAEA0vD,aAAc,SAASzgD,GACnBroB,KAAKkB,QAAQ,SAAUmnB,EAC3B,EAEA0gD,gBAAiB,SAAS1gD,GAClBroB,KAAKkB,QAAQ,YAAa,CAC1B8N,MAAOqZ,EAAEilC,OACT5iD,MAAO2d,EAAE3d,SAET2d,EAAEjP,gBAEV,EAEA4vD,mBAAoB,SAAS3gD,GACrBroB,KAAKkB,QAAQ,eAAgB,CAC7B8N,MAAOqZ,EAAEilC,OACT5iD,MAAO2d,EAAE3d,SAET2d,EAAEjP,gBAEV,EAEA6vD,gBAAiB,SAAS5gD,GAClBroB,KAAKkB,QAAQ,YAAa,CAC1B8N,MAAOqZ,EAAEilC,OACT5iD,MAAO2d,EAAE3d,SAET2d,EAAEjP,gBAEV,EAEA8vD,mBAAoB,SAAS7gD,GACrBroB,KAAKkB,QAAQ,eAAgB,CAC7B8N,MAAOqZ,EAAEilC,OACT5iD,MAAO2d,EAAE3d,SAET2d,EAAEjP,gBAEV,EAEA+vD,cAAe,SAAS9gD,GAChBroB,KAAKkB,QAAQ,UAAW,CACxB8N,MAAOqZ,EAAEilC,OACT5iD,MAAO2d,EAAE3d,SAET2d,EAAEjP,gBAEV,EAEAgwD,iBAAkB,SAAS/gD,GACnBroB,KAAKkB,QAAQ,aAAc,CAC3B8N,MAAOqZ,EAAEilC,OACT5iD,MAAO2d,EAAE3d,SAET2d,EAAEjP,gBAEV,EAEAiwD,gBAAiB,SAAShhD,GAClBroB,KAAKkB,QAAQ,YAAa,CAC1B8N,MAAOqZ,EAAEilC,OACT5iD,MAAO2d,EAAE3d,SAET2d,EAAEjP,gBAEV,EAEAkwD,mBAAoB,SAASjhD,GACrBroB,KAAKkB,QAAQ,eAAgB,CAC7B8N,MAAOqZ,EAAEilC,OACT5iD,MAAO2d,EAAE3d,SAET2d,EAAEjP,gBAEV,EAEAmwD,aAAc,SAASlhD,GACnBroB,KAAKkB,QAAQ,SAAUmnB,EAC3B,EAEAmhD,kBAAmB,SAASnhD,GACpBroB,KAAKkB,QAAQ,cAAe,CAC5B8N,MAAOqZ,EAAEilC,UAETjlC,EAAEjP,gBAEV,EAEAqwD,gBAAiB,SAASphD,GACtBroB,KAAKkB,QAAQ,YAAa,CACtB8N,MAAOqZ,EAAEilC,QAEjB,EAEAoc,eAAgB,SAASrhD,GACrB,IAAIvO,EAAO9Z,KAEX6pB,YAAW,WACP/P,EAAK5Y,QAAQ,WAAY,CACrBorB,OAAQjE,EAAEiE,QAElB,GACJ,EAEAq9C,qBAAsB,SAASthD,GAC3BroB,KAAKkB,QAAQ,iBAAkBmnB,EACnC,EAEAuhD,aAAc,SAAS76D,GACnB,IAAIlP,EAAOG,KACX,OAAOH,EAAKwP,OAAO8E,qBAAoB,WACnC,OAAO,IAAIlU,EAAMsN,YAAYuP,MAAM/N,EAAKlP,EAAKwP,QAAQiF,OACzD,GACJ,EAEAi0D,YAAa,SAASlgD,GAClBA,EAAEznB,QAAQiN,QAAQG,QACtB,EAEA67D,QAAS,SAASvpE,GACd,IAAIwpE,EAAiBtoE,EAAEpB,OAAO,CAAEqN,SAAUzN,MAAQM,EAAQA,SACtDM,EAAU,IAAIX,EAAMsN,YAAYjN,EAAQM,SAASkpE,GACjD96D,EAAQhP,KAAK0Y,cAEboxD,EAAextD,QACf1b,EAAQ0b,OAAOwtD,EAAextD,QAG9BwtD,EAAe/lB,eACfnjD,EAAQiN,MAAMi8D,EAAe/lB,gBAE7BnjD,EAAQiN,MAAMmB,EAAM2J,aAGpBmxD,EAAez1D,YACfzT,EAAQoT,WAAa81D,EAAez1D,WAGxC,IAAItO,EAASnF,EAAQqN,OAarB,OAXKlI,GAA4B,UAAlBA,EAAO0I,QACb7N,EAAQqc,YACTjd,KAAKsoE,cAAc3nE,KAAKC,GAOhCZ,KAAK+pE,gBAEEhkE,CACX,EAEAqgD,cAAe,WACXpmD,KAAKogD,QAAQtxC,SAAQ,SAASE,GAC1BA,EAAMo3C,eACV,GACJ,EAEAC,iBAAkB,WACdrmD,KAAKogD,QAAQtxC,SAAQ,SAASE,GAC1BA,EAAMq3C,kBACV,GACJ,EAEA2jB,QAAS,SAASv7D,GACVA,EAAOwI,SACPjX,KAAKomD,gBACLpmD,KAAKqmD,mBACLrmD,KAAKqP,OAAO4H,OAAOjX,KAAKwoE,UACxBxoE,KAAKqP,OAAOi3C,WAAWtmD,KAAK0oE,oBAEpC,EAEAhwD,YAAa,SAAS1J,GAClB,QAAclC,IAAVkC,EACA,OAAOhP,KAAKqP,OAGXrP,KAAKigD,YAAYjxC,EAAM9C,UAI5BlM,KAAKqP,OAASL,EAGdA,EAAMc,cAAc7P,EAAMsN,YAAYw5C,aAC1C,EAEAkjB,iBAAkB,SAASj7D,EAAOk7D,GAC9B,IAAIC,EAAYnqE,KAAK4tD,WAAW5+C,GAC5B26C,EAAS3pD,KAAKogD,SAEC,IAAf+pB,IAIJnqE,KAAKqoE,mBAAqB,CAAC,EAE3B1e,EAAOn4C,OAAO04D,EAAS,EAAGvgB,EAAOn4C,OAAO24D,EAAW,GAAG,IAEtDnqE,KAAKkB,QAAQ,SAAU,CAAEkpE,gBAAgB,IAC7C,EAEA9O,YAAa,SAASh7D,GAElB,IAEI+pE,EAFAvwD,EAAO9Z,KACPsqE,EAAuC,iBAF3ChqE,EAAUA,GAAW,CAAC,GAEWoK,MAAqBpK,EAAQoK,MAAQoP,EAAKsmC,QAAQ/+C,OAE/EsoD,EAAS7vC,EAAKsmC,QAEdmqB,EAAqB,SAASC,GAC9BA,EAAkBA,GAAoC,EAEtD,IAAIt+D,EAAOjM,EAAMsN,YAAY0V,SAASxV,SAASw6D,iBAAmBuC,EAElE,OAAK1wD,EAAKmmC,YAAY/zC,GAIfq+D,EAAmBC,EAAkB,GAHjCt+D,CAIf,EAEA,IAAI5L,EAAQ4L,OAAQ4N,EAAKmmC,YAAY3/C,EAAQ4L,MAA7C,CAIAlM,KAAKqoE,mBAAqB,CAAC,EAE3BgC,EAAY/pE,EAAQ4L,MAAQq+D,IAE5B,IAAIv7D,EAAQ,IAAI/O,EAAMsN,YAAYuvC,MAC9Bx8C,EAAQyX,MAAQ/X,KAAKM,QAAQyX,KAC7BzX,EAAQ0X,SAAWhY,KAAKM,QAAQ0X,QAChC1X,EAAQ+R,WAAarS,KAAKM,QAAQ+R,UAClC/R,EAAQ6R,aAAenS,KAAKM,QAAQ6R,YACpC7R,EAAQ08C,cAAgBh9C,KAAKM,QAAQ08C,aACrC18C,EAAQ28C,aAAej9C,KAAKM,QAAQ28C,YACpC38C,EAAQ48C,kBAAoBl9C,KAAKM,QAAQ48C,kBAqB7C,OAlBAluC,EAAMxB,UAAYxN,KAElBgP,EAAM+S,MAAMsoD,GAEZrqE,KAAKyqE,iBAAiBz7D,GAEtB26C,EAAOn4C,OAAO84D,EAAa,EAAGt7D,GAE1B1O,EAAQkK,MACRwE,EAAM8kB,SAASxzB,EAAQkK,MAGvBlK,EAAQ4nB,YACRlZ,EAAMmwC,cAAc7+C,EAAQ4nB,YAGhCloB,KAAKkB,QAAQ,SAAU,CAAEkpE,gBAAgB,IAElCp7D,CAlCP,CAmCJ,EAEAy7D,iBAAkB,SAASz7D,GACvBA,EAAME,KAAK,WAAYlP,KAAK6oE,eAAe35D,KAAKlP,OAChDgP,EAAME,KAAK,SAAUlP,KAAK8oE,aAAa55D,KAAKlP,OAC5CgP,EAAME,KAAK,YAAalP,KAAK+oE,gBAAgB75D,KAAKlP,OAClDgP,EAAME,KAAK,eAAgBlP,KAAKgpE,mBAAmB95D,KAAKlP,OACxDgP,EAAME,KAAK,YAAalP,KAAKipE,gBAAgB/5D,KAAKlP,OAClDgP,EAAME,KAAK,eAAgBlP,KAAKkpE,mBAAmBh6D,KAAKlP,OACxDgP,EAAME,KAAK,UAAWlP,KAAKmpE,cAAcj6D,KAAKlP,OAC9CgP,EAAME,KAAK,aAAclP,KAAKopE,iBAAiBl6D,KAAKlP,OACpDgP,EAAME,KAAK,YAAalP,KAAKqpE,gBAAgBn6D,KAAKlP,OAClDgP,EAAME,KAAK,eAAgBlP,KAAKspE,mBAAmBp6D,KAAKlP,OACxDgP,EAAME,KAAK,SAAUlP,KAAKupE,aAAar6D,KAAKlP,OAC5CgP,EAAME,KAAK,iBAAkBlP,KAAK2pE,qBAAqBz6D,KAAKlP,OAC5DgP,EAAME,KAAK,cAAelP,KAAKwpE,kBAAkBt6D,KAAKlP,OACtDgP,EAAME,KAAK,YAAalP,KAAKypE,gBAAgBv6D,KAAKlP,OAClDgP,EAAME,KAAK,WAAYlP,KAAK0pE,eAAex6D,KAAKlP,MACpD,EAEA2pD,OAAQ,WACJ,OAAO3pD,KAAKogD,QAAQt/C,OACxB,EAEAm/C,YAAa,SAAUoqB,GACnB,OAAOrqE,KAAKogD,QAAQpgD,KAAK4tD,WAAWyc,GACxC,EAEAK,aAAc,SAAShgE,GACnB,OAAO1K,KAAKogD,QAAQ11C,EACxB,EAEAkjD,WAAY,SAAS5+C,GACjB,IAAI26C,EAAS3pD,KAAKogD,QACdiqB,GAA6B,iBAATr7D,EAAoBA,EAAQA,EAAM9C,QAAQ5F,cAC9D4kD,EAAMlrD,KAAKqoE,mBAAmBgC,GAElC,GAAInf,GAAO,EACP,OAAOA,EAGX,IAAIA,EAAM,EAAGA,EAAMvB,EAAOtoD,OAAQ6pD,IAAO,CACrC,IAAIh/C,EAAOy9C,EAAOuB,GAAKh/C,OAAO5F,cAG9B,GAFAtG,KAAKqoE,mBAAmBn8D,GAAQg/C,EAE5Bh/C,IAASm+D,EACT,OAAOnf,CAEf,CAEA,OAAQ,CACZ,EAEAtxB,YAAa,SAAS5qB,EAAO8qB,GACzB,IAAID,EAAe7qB,EAAM9C,OAAO5F,cAEhC,GAAKwzB,GACDD,IAAiBC,EAAaxzB,gBAC9BtG,KAAKigD,YAAYnmB,KAIrB9qB,EAAQhP,KAAKigD,YAAYpmB,MAMzB75B,KAAKqoE,mBAAqB,CAAC,GAEvBroE,KAAKkB,QAAQ,cAAe,CAC5B8N,MAAOA,EACP8qB,aAAcA,KA6BlB,OAvBA95B,KAAKogD,QAAQtxC,SAAQ,SAASE,GAC1BA,EAAM07B,cAAa,SAASzU,GACxBA,EAAQ2D,YAAYC,EAAcC,EACtC,GACJ,IAEA95B,KAAK2qE,YAAY,SAAS1U,EAAK/pD,GAEvB+pD,EAAI2U,QAAQhxC,YAAYC,EAAcC,KACtC95B,KAAKoiB,aAAalW,GAClB+pD,EAAI/pD,KAAO+pD,EAAI2U,QAAQn9C,QACvBztB,KAAKgiB,eAAei0C,EAAI/pD,KAAM+pD,KAG9BA,EAAI/zD,iBAAiBu7B,GAAOw4B,EAAI/zD,iBAAiBwqC,IACjDupB,EAAI/zD,MAAM03B,YAAYC,EAAcC,EAE5C,EAAE5qB,KAAKlP,OAEPgP,EAAM+S,MAAM+X,GAEZ95B,KAAKkB,QAAQ,SAAU,CAAEkpE,gBAAgB,IAElCp7D,CACX,EAEA67D,YAAa,SAAS77D,GAClB,IAAI8K,EAAO9Z,KACP2pD,EAAS7vC,EAAKsmC,QACdl0C,EAAO8C,EAAM9C,OACbxB,EAAQoP,EAAK8zC,WAAW5+C,GAE5B,GAAsB,IAAlB26C,EAAOtoD,SAIPrB,KAAKkB,QAAQ,cAAe,CAAE8N,MAAOA,MAIzChP,KAAKqoE,mBAAqB,CAAC,EAEvB39D,GAAS,GAKT,GAJAsE,EAAM45D,SAENjf,EAAOn4C,OAAO9G,EAAO,GAEjBoP,EAAKpB,cAAcxM,SAAWA,EAAM,CACpC,IAAI4+D,EAAWnhB,EAAOj/C,IAAUi/C,EAAOtoD,OAASqJ,EAAM,EAAIA,GAC1DoP,EAAKpB,YAAYoyD,EACrB,MACI9qE,KAAKkB,QAAQ,SAAU,CAAE+V,QAAQ,EAAOmzD,gBAAgB,GAGpE,EAEAW,aAAc,WACV,IAAK,IAAIxnE,EAAI,EAAGA,EAAIvD,KAAKogD,QAAQ/+C,OAAQkC,IACrCvD,KAAKogD,QAAQ78C,GAAGsM,eAAiB,GACjC7P,KAAKogD,QAAQ78C,GAAG+N,UAAY,GAC5BtR,KAAKogD,QAAQ78C,GAAGqlE,SAEpB5oE,KAAKogD,QAAU,GACfpgD,KAAKqoE,mBAAqB,CAAC,EAC3BroE,KAAK2oE,OAAS,CAAC,EACf3oE,KAAKmoE,QAAU,CAAC,EAChBnoE,KAAKooE,OAAS,CAClB,EA8BAt0C,SAAU,SAAS4xB,GACf,GAAIA,EAAKiE,OAAQ,CACb3pD,KAAK+qE,eAEDrlB,EAAKslB,SACLhrE,KAAKooE,OAAS,EACdpoE,KAAKmoE,QAAU,CAAC,EAChB1gE,OAAO2b,KAAKsiC,EAAKslB,QAAQl8D,SAAQ,SAASnH,GACtC,IAAKkF,MAAMlF,GAAK,CACZ,IAAIo1B,EAAM82B,WAAWlsD,GACjBmwB,SAASiF,KACT/8B,KAAKooE,OAAS33D,KAAKmK,IAAI5a,KAAKooE,OAAQrrC,GAE5C,CACA/8B,KAAKmoE,QAAQxgE,GAAM,CAAEsjE,IAAKvlB,EAAKslB,OAAOrjE,GAC1C,GAAG3H,OAIP,IAAK,IAAIkrD,EAAM,EAAGA,EAAMxF,EAAKiE,OAAOtoD,OAAQ6pD,IAAO,CAC/C,IAAI1gD,EAAOk7C,EAAKiE,OAAOuB,GACnBrb,EAAOq7B,EAAoB1gE,EAAMxK,KAAKM,SACtC0O,EAAQhP,KAAKs7D,YAAY,CACzBvjD,KAAe83B,EAAKna,SACpB1d,QAAe63B,EAAKla,YACpBtjB,UAAew9B,EAAKx9B,UACpBF,YAAe09B,EAAK19B,YACpB6qC,aAAenN,EAAKmN,aACpBC,YAAepN,EAAKoN,YACpBzyC,KAAeA,IAGfA,EAAK0d,YACLlZ,EAAMmwC,cAAc30C,EAAK0d,WAEjC,CACJ,CAEIw9B,EAAKhtC,YACL1Y,KAAK0Y,YAAY1Y,KAAKigD,YAAYyF,EAAKhtC,cAEvC1Y,KAAK0Y,YAAY1Y,KAAKogD,QAAQ,IAG9BsF,EAAKif,OACLjf,EAAKif,MAAM71D,SAAQ,SAASmnD,GACxBj2D,KAAKkiB,WAAW+zC,EAAI/pD,KAAM+pD,EAAI/zD,MAAO+zD,EAAI3xB,OAC7C,GAAGtkC,KAEX,EAEA6zB,OAAQ,WACJ7zB,KAAKomD,gBACLpmD,KAAKqmD,mBACL,IAAIse,EAAQl9D,OAAO2b,KAAKpjB,KAAK2oE,QAAQxmE,KAAI,SAAS+J,GAC9C,IAAI+pD,EAAMj2D,KAAK2oE,OAAOz8D,GAClBue,EAAMwrC,EAAI/zD,MAQd,OAPIuoB,aAAegT,GAAOhT,aAAeiiB,EACrCjiB,EAAMA,EAAIgD,MAAM,EAAG,GAAG,GACfhD,aAAeotB,EACtBptB,GAAY,GAEZA,EAAMgK,KAAKC,UAAUjK,GAElB,CACHvoB,MAAYuoB,EACZ6Z,OAAY2xB,EAAI3xB,OAChBp4B,KAAY+pD,EAAI/pD,KAIhB8C,MAAYinD,EAAI2U,QAAQ57D,MACxBm8D,UAAYlV,EAAI2U,QAAQ1+D,KAEhC,GAAGlM,MACH,MAAO,CACH0Y,YAAa1Y,KAAK0Y,cAAcxM,OAChCy9C,OAAQ3pD,KAAKogD,QAAQj+C,KAAI,SAAS6M,GAG9B,OAFAA,EAAMiI,OAAOjX,KAAKwoE,UAClBx5D,EAAMs3C,WAAWtmD,KAAK0oE,oBACf15D,EAAM6kB,QACjB,GAAG7zB,MACH2kE,MAAOA,EACPxyD,YAAanS,KAAKM,QAAQ6R,YAC1BE,UAAWrS,KAAKM,QAAQ+R,UAEhC,EAEA+4D,SAAU,WACN,IAAIvrE,EAAOG,KACP07D,EAAW,IAAIl6D,EAAE05D,SACjB1wD,EAAO3K,EAAKg0B,SACZw3C,EAAM5jE,OAAO2b,KAAKvjB,EAAKsoE,SAAShrD,QAAO,SAASxV,GAChD,OAA8B,IAAvB9H,EAAKsP,UAAUxH,EAC1B,IACI0Y,EAAQgrD,EAAIhqE,OAoBhB,OAnBAmJ,EAAKwgE,OAAS,CAAC,EACX3qD,EACAgrD,EAAIv8D,SAAQ,SAASnH,GACjB,IAAIqI,EAAMnQ,EAAKsoE,QAAQxgE,GACvB,GAAIqI,EAAIK,KAAM,CACV,IAAIi3D,EAAS,IAAIC,WACjBD,EAAOE,OAAS,WACZh9D,EAAKwgE,OAAOrjE,GAAM2/D,EAAOvhE,OACzBksC,GACJ,EACAq1B,EAAOgE,cAAct7D,EAAIK,KAC7B,MACI7F,EAAKwgE,OAAOrjE,GAAMqI,EAAIi7D,IACtBh5B,GAER,IAEAA,IAEGypB,EAASH,UAEhB,SAAStpB,MACC5xB,GAAS,GACXq7C,EAASptB,QAAQ9jC,EAEzB,CACJ,EAEA2W,SAAU,SAAS+3C,GACf,IAAIwC,EAAW,IAAIl6D,EAAE05D,SACjBK,EAAUG,EAASH,UACnB1rB,EAAO,CAAEqpB,KAAMA,EAAMqC,QAASA,GASlC,OAPIrC,IAASl5D,KAAKkB,QAAQ,cAAe2uC,IACrC7vC,KAAK+qE,eACL9qE,EAAMsN,YAAY85D,UAAUnO,EAAMl5D,KAAM07D,IAExCA,EAAS6P,SAGNhQ,CACX,EAEA55C,YAAa,SAASrhB,GAClB,IAAIT,EAAOG,KACXM,EAAUkB,EAAEpB,OAAO,CAAC,EAAGP,EAAKS,QAAQkrE,MAAOlrE,GAC3C,IAAIkK,EAAO3K,EAAKg0B,SAEhB,IAAIh0B,EAAKqB,QAAQ,cAAe,CAAEuM,SAAUjD,IAA5C,CAIA,IAAI6gE,EAAM5jE,OAAO2b,KAAKvjB,EAAKsoE,SAAShrD,QAAO,SAASxV,GAChD,OAA8B,IAAvB9H,EAAKsP,UAAUxH,EAC1B,IACI0Y,EAAQgrD,EAAIhqE,OACZ2pE,EAAS3qD,EAAQ,CAAC,EAAI,KACtBA,EACAgrD,EAAIv8D,SAAQ,SAASnH,GACjB,IA/qBIsjE,EAAKr8D,EACjB68D,EA8qBYz7D,EAAMnQ,EAAKsoE,QAAQxgE,GACvB,GAAIqI,EAAIK,KAAM,CACV,IAAIi3D,EAAS,IAAIC,WACjBD,EAAOE,OAAS,WACZwD,EAAOrjE,GAAM,CACT+G,KAAMsB,EAAIK,KAAK3B,KACfxC,KAAM8D,EAAIK,KAAKnE,KACf1B,KAAM88D,EAAOvhE,QAEjBksC,GACJ,EACAq1B,EAAOK,kBAAkB33D,EAAIK,KACjC,MA3rBI46D,EA4rBWj7D,EAAIi7D,IA5rBVr8D,EA4rBe,SAASpE,EAAMkE,GAC/Bs8D,EAAOrjE,GAAM,CAAE+G,KAAMA,EAAMlE,KAAMA,GACjCynC,GACJ,GA9rBZw5B,EAAM,IAAIC,gBACVlE,OAAS,WACT54D,EAAS68D,EAAIE,SAAUF,EAAIG,kBAAkB,gBACjD,EACAH,EAAII,QAAU,WACVj9D,EAAS,KACb,EACA68D,EAAIriD,KAAK,MAAO6hD,GAChBQ,EAAIK,aAAe,cACnBL,EAAIM,MAurBI,IAEA95B,GA7BJ,CAgCA,SAASA,IACL,KAAM5xB,GAAS,EAAG,CACd7V,EAAKwgE,OAASA,EACd,IAAIv9D,EAAW,IAAIxN,EAAM+rE,MAAM9D,SAAS19D,GACpCyhE,EAAc,CACdxqD,SAAUjX,EAAKiX,UAAYnhB,EAAQmhB,SACnCyqD,SAAU5rE,EAAQ4rE,SAClBC,WAAY7rE,EAAQ6rE,YAGpB7rE,EAAQ6rE,WACR1+D,EAAS2+D,iBAAiBhrD,MAAK,SAAS5W,GACpCvK,EAAMosE,OAAO7qE,EAAEpB,OAAO6rE,EAAa,CAC/BK,QAAS9hE,IAEjB,IAEA85D,QAAQh2B,QAAQ7gC,EAAS8+D,UAAUnrD,MAAK,SAAS5W,GAC7CvK,EAAMosE,OAAO7qE,EAAEpB,OAAO6rE,EAAa,CAC/BK,QAAS9hE,IAEjB,GAER,CACJ,CACJ,EAEA8iC,KAAM,SAAShtC,EAASsO,GACE,mBAAXtO,GAA0BsO,IACjCA,EAAWtO,EACXA,EAAU,CAAC,GAEf,IAAI2C,EAAQ,GAAI0mD,EAAS3pD,KAAKogD,SAC9B,SAAUz6B,EAAKpiB,GACX,GAAIA,EAAIomD,EAAOtoD,OACXsoD,EAAOpmD,GAAG+pC,KAAKrtC,EAAMsN,YAAYgwB,SAAUj9B,GAAS,SAASksE,GACzDvpE,EAAMtC,KAAK6rE,GACX7mD,EAAKpiB,EAAI,EACb,QACG,CACH,IAAIipE,EAAQvpE,EAAM,GAClB,IAAKM,EAAI,EAAGA,EAAIN,EAAM5B,SAAUkC,EAC5BipE,EAAMhgB,SAAWggB,EAAMhgB,SAAS/4C,OAAOxQ,EAAMM,GAAGipD,UAEpD59C,EAAS49D,EACb,CACH,CAbD,CAaG,EACP,EAEAC,WAAY,SAAS19D,EAAKC,QACRlC,IAAVkC,IACAA,EAAQD,EAAIC,OAEhBA,EAAQA,EAAM1I,cACd,IAAIjD,EAAM0L,EAAM,GAChB,IAAK,IAAI7C,KAAQlM,KAAK2oE,OAAQ,CAC1B,IAAI1S,EAAMj2D,KAAK2oE,OAAOz8D,GAClBue,EAAMwrC,EAAI/zD,MACd,GAAIuoB,aAAegT,KACVhT,EAAIzb,OAAUyb,EAAIzb,OAASA,GAASyb,EAAIzb,MAAM1I,gBAC3CmkB,EAAM,IAAMpnB,EACZ,OAAO4yD,CAIvB,CACA,MAAO,CAAE/pD,KAAM7I,EACnB,EAEA6e,WAAY,SAAShW,EAAMhK,EAAOoiC,GAC9B,IAAI79B,EAAIxG,EAAMsN,YAAYkH,KAAKuhD,oBAAoB9pD,EAAMhK,GACzDgK,EAAOzF,EAAEyF,KAAKuhB,QACdztB,KAAK2oE,OAAOz8D,EAAK5F,eAAiB,CAC9BpE,MAAUuE,EAAEvE,MACZoiC,OAAUA,EACVp4B,KAAUA,EACV0+D,QAAUnkE,EAAEyF,KAEpB,EAEAkW,aAAc,SAASlW,UACZlM,KAAK2oE,OAAOz8D,EAAK5F,cAC5B,EAEAipC,UAAW,SAASrjC,GAEhB,OADAA,EAAOA,EAAK5F,iBACAtG,KAAK2oE,OACN3oE,KAAK2oE,OAAOz8D,GAAMhK,MAEtB,IACX,EAEA8f,eAAgB,SAAS9V,EAAM+pD,GAS3B,OARA/pD,EAAOA,EAAK5F,cACRsB,UAAUvG,OAAS,SACPyL,IAARmpD,SACOj2D,KAAK2oE,OAAOz8D,GAEnBlM,KAAK2oE,OAAOz8D,GAAQ+pD,GAGrBj2D,KAAK2oE,OAAOz8D,EACvB,EAEAy+D,YAAa,SAASh7B,GAClBloC,OAAO2b,KAAKpjB,KAAK2oE,QAAQ75D,SAAQ,SAAS5C,GACtCyjC,EAAK3vC,KAAK2oE,OAAOz8D,GAAOA,EAC5B,GAAGlM,KACP,EAEAsgD,YAAa,SAASpO,EAAe5X,EAAQvI,EAAO9c,GAChDi9B,EAAgBA,EAAc5rC,cAC9BmB,OAAO2b,KAAKpjB,KAAK2oE,QAAQ75D,SAAQ,SAAS5C,GACtC,IAAI+pD,EAAMj2D,KAAK2oE,OAAOz8D,GAClBzF,EAAIwvD,EAAI/zD,MACRuE,aAAag3B,GACbh3B,EAAEuI,MAAM1I,eAAiB4rC,EACzB+jB,EAAI/zD,MAAQuE,EAAE0xB,OAAO,KAAM,KAAM,KAAM,KAAMmC,EAAQvI,EAAO9c,GAEvDxO,aAAaimC,GAClBjmC,EAAE0xB,OAAO+Z,EAAe5X,EAAS,MAAQ,MAAOvI,EAAO9c,EAE/D,GAAGjV,KACP,EAEAiR,SAAU,SAAShB,GACf,IAAItI,EAAK9E,SAAS7C,KAAKooE,QAMvB,OAJIpoE,KAAKmoE,QAAQxgE,GADG,iBAATsI,EACY,CAAEg7D,IAAKh7D,GAEP,CAAEI,KAAMJ,GAExBtI,CACX,EAEA+kE,SAAU,SAAS/kE,GACf,IAAIqI,EAAMhQ,KAAKmoE,QAAQxgE,GACnBsjE,EAAMj7D,EAAIi7D,IAId,OAHKA,IACDA,EAAMj7D,EAAIi7D,IAAMxpE,OAAOkrE,IAAIC,gBAAgB58D,EAAIK,OAE5C46D,CACX,EAEAlB,cAAe,WACXtiE,OAAO2b,KAAKpjB,KAAKmoE,SAASr5D,SAAQ,SAASnH,GACvC,IAAK3H,KAAKmP,UAAUxH,GAAK,CACrB,IAAIsjE,EAAMjrE,KAAKmoE,QAAQxgE,GAAIsjE,IACvBA,GACAxpE,OAAOkrE,IAAIE,gBAAgB5B,UAExBjrE,KAAKmoE,QAAQxgE,EACxB,CACJ,GAAG3H,KACP,EAEAmP,UAAW,SAASa,GAChB,IAAIzM,EACAomD,EAAS3pD,KAAKogD,QAClB,IAAK78C,EAAIomD,EAAOtoD,SAAUkC,GAAK,GAC3B,GAAIomD,EAAOpmD,GAAG4L,UAAUa,GACpB,OAAO,EAGf,IAAInP,EAAQb,KAAKsoE,cAAcznE,MAC/B,IAAK0C,EAAI1C,EAAMQ,SAAUkC,GAAK,GAC1B,GAAI1C,EAAM0C,GAAG4L,UAAUa,GACnB,OAAO,EAGf,OAAO,CACX,IAIJ,SAASk7D,EAAoB1gE,EAAMlK,GAC/B,SAASwsE,EAAGxhE,EAAG4O,EAAGvT,GACd,YAAamG,IAANxB,EAAkBA,OAAUwB,IAANoN,EAAkBA,EAAIvT,CACvD,CAEA,IAAI+uB,EAAeo3C,EAAGtiE,EAAKkrB,SAAUp1B,EAAQyX,KAAM,KAC/C4d,EAAem3C,EAAGtiE,EAAKmrB,YAAar1B,EAAQ0X,QAAS,IACrD3F,EAAey6D,EAAGtiE,EAAK6H,UAAW/R,EAAQ+R,UAAW,IACrDF,EAAe26D,EAAGtiE,EAAK2H,YAAa7R,EAAQ6R,YAAa,IACzD6qC,EAAe8vB,EAAGtiE,EAAKwyC,aAAc18C,EAAQ08C,aAAc,IAC3DC,EAAe6vB,EAAGtiE,EAAKyyC,YAAa38C,EAAQ28C,YAAa,IAE7D,QAAkBnwC,IAAdtC,EAAKuN,KACL,IAAK,IAAIxU,EAAI,EAAGA,EAAIiH,EAAKuN,KAAK1W,SAAUkC,EAAG,CACvC,IAAImQ,EAAMlJ,EAAKuN,KAAKxU,GAChBsjC,EAAKimC,EAAGp5D,EAAIhJ,MAAOnH,GAEvB,GADIsjC,GAAMnR,IAAYA,EAAWmR,EAAK,GAClCnzB,EAAI2D,MACJ,IAAK,IAAIxM,EAAI,EAAGA,EAAI6I,EAAI2D,MAAMhW,SAAUwJ,EAAG,CACvC,IACIi8B,EAAKgmC,EADEp5D,EAAI2D,MAAMxM,GACJH,MAAOG,GACpBi8B,GAAMnR,IAAeA,EAAcmR,EAAK,EAChD,CAER,CAGJ,MAAO,CACHpR,SAAeA,EACfC,YAAeA,EACftjB,UAAeA,EACfF,YAAeA,EACf6qC,aAAeA,EACfC,YAAeA,EAEvB,CAEAh9C,EAAMsN,YAAY26D,SAAWA,EACzBjoE,EAAM8sE,WACN9sE,EAAM8sE,SAAS3sE,OAAO8nE,EAASl1D,WAE/Bk1D,EAASl1D,UAAU4O,UAAY,SAASthB,GACpC,IAAIg5D,EAAW,IAAI93D,EAAE05D,SACjBK,EAAUjC,EAASiC,UACnB1rB,EAAO,CAAE0rB,QAASA,GACtB,IAAIv7D,KAAKkB,QAAQ,YAAa2uC,GAyB9B,OArBA7vC,KAAKgtE,SAAS1sE,EAASg5D,GACtBl4C,MAAK,SAASiR,GACX,OAAO/xB,EAAQ6rE,WACTlsE,EAAM4hB,IAAIorD,UAAU56C,GACpBpyB,EAAM4hB,IAAIqrD,gBAAgB76C,EACpC,IACCkQ,MAAK,SAAS+pC,GACXrsE,EAAMosE,OAAO,CACTC,QAASA,EACT7qD,SAAUnhB,EAAQmhB,SAClByqD,SAAU5rE,EAAQ4rE,SAClBC,WAAY7rE,EAAQ6rE,WACpBgB,YAAa7sE,EAAQ6sE,cAGzB7T,EAAShrB,SACb,IACC8+B,MAAK,SAASp5B,GACXslB,EAASiS,OAAOv3B,EACpB,IAEOunB,CACX,EAEA2M,EAASl1D,UAAUg6D,SAAW,SAAS1sE,GACnC,IAAIyF,EAAS,IAAIvE,EAAE05D,SACftsD,EAAW,SAAS49D,GACpBzmE,EAAOuoC,QAAQk+B,EACnB,EACA,OAAOlsE,EAAQ+sE,MACf,IAAK,WACD/sE,EAAQmN,SAAS6/B,KAAKhtC,EAASsO,GAC/B,MACJ,IAAK,QACDtO,EAAQmN,SAASiL,cAAc40B,KAAKhtC,EAASsO,GAC7C,MACJ,IAAK,YACDtO,EAAQmN,SAASiL,cAAcC,YAAY20B,KAAKhtC,EAASsO,GAI7D,OAAO7I,EAAOw1D,SAClB,EAEP,CAh+BD,CAg+BGt7D,OAEH,IAAIqtE,GAAgBrtE,MAAMsN,YAClBggE,GAAYD,GAAc3vC,QAC1B6vC,GAAaF,GAActzD,SAC3ByzD,GAAaH,GAAcx0D,SAC3B40D,GAAYJ,GAAc5vC,QAC1BiwC,GAAQL,GAAc7vC,IAEtBgrC,GAAiBxoE,MAAM0B,MAAMvB,OAAO,CACpCC,KAAM,SAAUoN,GACZzN,KAAKyN,SAAWA,CACpB,EAEAuhC,YAAa,SAASjgC,EAAKohC,EAAYy9B,EAAQC,EAAMC,EAAM3+B,GACvD,IAAIngC,EAAOinB,EAAS/zB,EAAOqB,EAC3B,GAAIwL,aAAew+D,GAEf,OADAv+D,EAAQhP,KAAKyN,SAASwyC,YAAYlxC,EAAIC,SACvBD,EAAI4qB,SAKnB1D,EAAUjnB,EAAMinB,QAAQlnB,GACxB7M,EAAQ8M,EAAMnB,MAAMkB,EAAI2E,IAAK3E,EAAIsG,KAAKnT,QAElCitC,GAAwB,MAAXlZ,GAA4B,MAAT/zB,EACzB,CAAC,CACJ+zB,QAASA,EACT/zB,MAAOA,EACPwR,IAAK3E,EAAI2E,IACT2B,IAAKtG,EAAIsG,IACTrG,MAAOD,EAAIC,MACXs1B,SAAQ6L,IAA6C,IAA/BnhC,EAAMmD,YAAYpD,EAAIsG,MAA2C,IAA7BrG,EAAMqD,UAAUtD,EAAI2E,QAG3E,IAjBA,CAAC,CACJxR,MAAO,IAAIjC,MAAMsN,YAAYkH,KAAKuS,QAAQ6wB,UAAU,SAmBhE,GAAI9oC,aAAey+D,GAAY,CAE3B,IAAIO,EAAS,GAAI9mE,EADjB1D,EAAIvD,KAAKyN,SAASmgD,WAAW7+C,EAAIC,OAEjC,GAAID,EAAI0rB,UAGAl3B,GADJ0D,EAAIjH,KAAKyN,SAASmgD,WAAW7+C,EAAI0rB,WACtB,CACP,IAAIttB,EAAM5J,EACVA,EAAI0D,EACJA,EAAIkG,CACR,CAGJ,GAAI5J,EAAI,GAAK0D,EAAI,IAAM8H,EAAI4qB,QACvB,MAAO,CAAC,CACJz3B,MAAO,IAAIjC,MAAMsN,YAAYkH,KAAKuS,QAAQ6wB,UAAU,SAsB5D,KAAOt0C,GAAK0D,GAUR,IARA,IAAIszB,GADJvrB,EAAQhP,KAAKyN,SAASi9D,aAAannE,MACpBu6B,MAAMpD,UAAU3rB,EAAI8B,SAC/B2pB,EAAKxrB,EAAM8uB,MAAMpD,UAAU3rB,EAAIwL,aAE/B+mC,EAAiBtyC,EAAM8uB,MAAMoiB,aAAa3lB,GAC1CgnB,EAAevyC,EAAM8uB,MAAMoiB,aAAa1lB,GAExCrzB,EAAS6H,EAAM6N,YAAY8W,SAAS,QAAS2tB,EAAgBC,GAExDlsC,EAAMklB,EAAGllB,IAAKA,GAAOmlB,EAAGnlB,MAAOA,EACpC,IAAK,IAAI3B,EAAM6mB,EAAG7mB,IAAKA,GAAO8mB,EAAG9mB,MAAOA,EAAK,CACzC,IAAIhJ,EAAQsE,EAAM8uB,MAAMpzB,MAAMgJ,EAAK2B,GACnC4gB,EAAUjnB,EAAM6N,YAAYpa,IAAI,UAAWiI,GAC3CxI,EAAQiF,EAAO6sB,GAAGtpB,IACdykC,GAAwB,MAAXlZ,GAA4B,MAAT/zB,IAChC6rE,EAAOptE,KAAK,CACRs1B,QAAUA,EACV/zB,MAAUA,EACVwR,IAAUA,EACV2B,IAAUA,EACVrG,MAAUA,EAAM9C,OAChBo4B,SAAU6L,IAAyC,IAA3BnhC,EAAMmD,YAAYkD,IAAuC,IAAzBrG,EAAMqD,UAAUqB,KAGpF,CAIR,OAAOq6D,CACX,CACA,GAAIh/D,aAAe0+D,GAAY,CAC3B,IAAIniE,EAAI,GACR,IAAK/H,EAAI,EAAGA,EAAIwL,EAAIyE,KAAKnS,SAAUkC,EAC/B+H,EAAIA,EAAEmI,OAAOzT,KAAKgvC,YAAYjgC,EAAIyE,KAAKjQ,GAAI4sC,EAAYy9B,EAAQC,EAAMC,IAEzE,OAAOxiE,CACX,CACA,GAAIyD,aAAe2+D,GAAW,CAC1B,IAAIjjD,EAAMzqB,KAAKuvC,UAAUxgC,EAAK6+D,EAAQC,EAAMC,GAE5C,OAAIrjD,aAAekjD,GACR3tE,KAAKgvC,YAAYvkB,EAAK0lB,EAAYy9B,EAAQC,EAAMC,GAEpD,CAAC,CACJ5rE,MAAc,MAAPuoB,EAAc,IAAIxqB,MAAMsN,YAAYkH,KAAKuS,QAAQ6wB,UAAU,QAAUptB,GAEpF,CACA,MAAO,EACX,EAEA8C,SAAU,SAASxe,GAEf,OADY/O,KAAKyN,SAASwyC,YAAYlxC,EAAIC,OAC7Bue,SAASxe,EAC1B,EAEAwgC,UAAW,SAASxgC,EAAK6+D,EAAQC,EAAMC,GACnC,IAAIrjD,EAoBJ,OAnBI1b,EAAIipB,WAEJvN,EAAMzqB,KAAKyN,SAAS8hC,UAAUvvC,KAAKguE,eAAej/D,EAAI0e,WAGtD1e,EAAMA,EAAIU,QAAQ+d,SAASogD,GAAQ,GAExB,OADXnjD,EAAMzqB,KAAKyN,SAAS8hC,UAAUvvC,KAAKguE,eAAej/D,EAAI0e,aAGlDhD,EAAMzqB,KAAKyN,SAAS8hC,UAAUvvC,KAAKguE,eAAej/D,EAAI7C,QAE/C,MAAPue,IAEAA,EAAMzqB,KAAKyN,SAAS8hC,UAAUxgC,EAAI0e,UAAYztB,KAAKyN,SAAS8hC,UAAUxgC,EAAI7C,QAG9Eue,aAAekjD,KACfljD,EAAMA,EAAIyN,SAAS21C,EAAMC,IAEtBrjD,CACX,EAEAF,QAAS,SAASxb,EAAK6+D,EAAQC,EAAMC,EAAM3+B,GACvC,IAAIhW,EAASpqB,aAAew+D,GACxBx+D,aAAe2+D,KACfv0C,EAASn5B,KAAKyN,SAAS8hC,UAAUxgC,EAAI7C,gBAAiBqhE,IAE1D,IAAI/iE,EAAOxK,KAAKgvC,YAAYjgC,GAAK,EAAO6+D,EAAQC,EAAMC,EAAM3+B,GAAWhtC,KAAI,SAAS2R,GAChF,IAAI2W,EAAM3W,EAAK5R,MAIf,OAHIuoB,aAAexqB,MAAMsN,YAAYkH,KAAKuS,QAAQ0lB,UAC9CjiB,EAAMA,EAAIvoB,OAEPuoB,CACX,IACA,OAAO0O,EAAS3uB,EAAK,GAAKA,CAC9B,EAEAskC,UAAW,SAASvnC,GAChB,IAAIyH,EAAQhP,KAAKyN,SAASwyC,YAAY14C,EAAEyH,OACpC0E,EAAMnM,EAAEmM,IAAK2B,EAAM9N,EAAE8N,IAAKnT,EAAQqF,EAAErF,MAExC,GADqB8M,EAAMinB,QAAQ,CAAEviB,IAAKA,EAAK2B,IAAKA,MAC7B9N,EAGnB,OAAO,EAGX,IAAI0mE,EAAa1mE,EAAEojC,kBACnB,GAAIsjC,EAAY,CAIZ,IAAIC,EAAOC,EACPhqE,EAAQjC,EAAMiC,MACdC,EAASlC,EAAMkC,OACnB4K,EAAMF,QAAQm/D,GAAY,SAASv6D,EAAK2B,QACtBvI,IAAVohE,IACAA,EAAQx6D,EACRy6D,EAAQ94D,GAEZ,IAEIoV,EAFA2jD,EAAO16D,EAAMw6D,EACbG,EAAOh5D,EAAM84D,EAGb1jD,EADA2jD,EAAOhqE,GAAUiqE,EAAOlqE,EAClBjC,EAAMO,IAAI2rE,EAAMC,GAEhB,IAAIpuE,MAAMsN,YAAYkH,KAAKuS,QAAQ6wB,UAAU,OAEvD7oC,EAAMiD,OAAOyB,EAAK2B,EAAKoV,EAC3B,GACJ,MAIQvoB,aAAiByrE,KACjBzrE,EAAQlC,KAAKuqB,QAAQroB,EAAOqF,EAAEyH,MAAO0E,EAAK2B,GACtCylB,MAAM4T,QAAQxsC,KACdA,EAAQA,EAAM,SAEJ4K,IAAV5K,IACAA,EAAQ,OAMZA,aAAiBjC,MAAMsN,YAAYkH,KAAKuS,QAAQsgB,SAChDplC,EAAQA,EAAMO,IAAI,EAAG,IAGzBuM,EAAMiD,OAAOyB,EAAK2B,EAAKnT,GAQ3B,OALAonB,aAAata,EAAMs/D,wBACnBt/D,EAAMs/D,uBAAyBzkD,YAAW,WACtC7a,EAAMmG,OAAM,WAAW,GAAG,CAAEpF,QAAQ,GACxC,GAAG,KAEI,CACX,EACAi+D,eAAgB,SAASvjD,GACrB,MAAI,sBAAsBxiB,KAAKwiB,GACpBA,EAEJ,IAAMA,EAAI3nB,QAAQ,QAAS,OAAS,GAC/C,IAGA2sC,GAA2Bg5B,GAAeroE,OAAO,CACjD0uC,UAAW,WACP,OAAO,CACX,IAGJw+B,GAAc7E,eAAiBA,GAC/B6E,GAAc79B,yBAA2BA,GAE7C,SAAUxvC,GACN,aAEA,IAAIuB,EAAIvB,EAAMwF,OACV8oE,EAAiB,aAEjBC,EAAU,CACV5O,GAAM,KACNC,KAAQ,OACRpgD,KAAQ,OACRE,MAAS,QACToH,KAAQ,YACRvB,IAAO,WACP,YAAa,YACb,aAAc,aACd,UAAW,UACX,YAAa,YACb,YAAa,QACb,WAAY,OACZipD,OAAU,YACVC,SAAY,aAGZC,EAAgB,CAChBC,IAAO,OACP,YAAa,WACb3U,MAAS,QACT,cAAe,QACf4U,OAAU,gBACVC,UAAa,gBACb,kBAAmB,OACnB,gBAAiB,OACjB,YAAa,OACb,iBAAkB,OAClB,qBAAsB,OACtB,QAAS,QAGTC,EAAmB,CACnBC,MAAS,UACT,cAAe,cACfC,YAAe,gBACf,cAAe,cACf,YAAa,YACb,aAAc,aACdC,UAAa,eAGbC,EAAmB,CACnBV,OAAU,WACVC,SAAY,aACZU,QAAW,YACX,QAAS,QACT,UAAW,UACX,SAAU,UAGVC,EAAgB,CAChBC,IAAO,cACPrV,MAAS,eACT,YAAa,gBACb,cAAe,eACf2U,IAAO,eACP,YAAa,eACb,mBAAoB,wBAGpBW,EAAoB/tE,EAAEpB,OAAO,CAAEqb,MAAO,oBAAsB4zD,GAC5DG,EAAsBhuE,EAAEpB,OAAO,CAAEqb,MAAO,qBAAuB4zD,GAE/DI,EAAkB,CACnB37D,KAAM,QACN47D,UAAW,MACXC,aAAc,SACdC,UAAW,QACXC,SAAU,YAGb,SAASC,EAAiBC,GACtB,OAAOA,EAAU5tE,KAAI,SAAS2+B,GAC1B,MAAO,iBAAmBA,EAAS,IACvC,IAAG39B,KAAK,IACZ,CAEA,IAAI6sE,EAAyCF,EAAiB,CAAE,MAAO,OAAQ,QAAS,cAAe,eAAgB,eAAgB,iBACnIG,EAA0BH,EAAiB,CAAE,aAAc,kBAE3DI,EAAc,GACdC,EAAoB,GACpBC,EAAoB,GAExB,IAAK,IAAInuE,KAAOusE,EACZ0B,EAAYvvE,KAAKsB,GACjBkuE,EAAkBxvE,KAAK,SAAWsB,GAGtC,IAAKA,KAAO0sE,EACRyB,EAAkBzvE,KAAKsB,GAG3BktE,EAAiBe,GAAe,WAChCf,EAAiBgB,GAAqB,gBACtChB,EAAiBiB,GAAqB,gBAEtCZ,EAAoBU,GAAe,iBACnCV,EAAoBW,GAAqB,sBAEzC,IAAIE,EAAapwE,EAAM0B,MAAMvB,OAAO,CAChCC,KAAM,SAAS0pB,EAAMtc,GACjBzN,KAAK+pB,KAAOA,EACZ/pB,KAAKyN,SAASA,GACdzN,KAAK2sD,UAAYnrD,EAAEuoB,EAAK4iC,WACxB3sD,KAAKswE,iBAAmB9uE,EAAEuoB,EAAK3R,WAC/BpY,KAAKuwE,gBAAkBxmD,EAAKwmD,gBAC5BvwE,KAAKwwE,qBAAuBzmD,EAAKymD,qBACjCxwE,KAAKywE,qBAAuB1mD,EAAK0mD,qBACjCzwE,KAAK0wE,mBAAqB3mD,EAAK2mD,mBAC/B1wE,KAAK2wE,SAAW5mD,EAAK4mD,SACrB3wE,KAAK4wE,SAAW7mD,EAAK6mD,SACrB5wE,KAAK6wE,UAAY9mD,EAAK8mD,UAEtB9mD,EAAK+mD,WAAW5hE,KAAK,QAASlP,KAAK+wE,kBAAkB7hE,KAAKlP,OAC1D+pB,EAAK+mD,WAAW5hE,KAAK,SAAUlP,KAAKgxE,mBAAmB9hE,KAAKlP,OAC5D+pB,EAAK+mD,WAAW5hE,KAAK,SAAUlP,KAAKixE,mBAAmB/hE,KAAKlP,OAC5D+pB,EAAK+mD,WAAW5hE,KAAK,SAAUlP,KAAKkxE,mBAAmBhiE,KAAKlP,OAE5DA,KAAKmxE,OAASpnD,EAAKonD,OACnBnxE,KAAKmxE,OAAOjiE,KAAK,SAAUlP,KAAKoxE,eAAeliE,KAAKlP,OACpDA,KAAKmxE,OAAOjiE,KAAK,WAAYlP,KAAKqxE,iBAAiBniE,KAAKlP,OACxDA,KAAKmxE,OAAOjiE,KAAK,aAAclP,KAAKsxE,mBAAmBpiE,KAAKlP,OAC5DA,KAAKmxE,OAAOjiE,KAAK,SAAUlP,KAAKuxE,eAAeriE,KAAKlP,OAEpDwB,EAAEuoB,EAAK4mD,UAAU/sD,GAAG,SAAU5jB,KAAKwxE,SAAStiE,KAAKlP,OACjDA,KAAKyxE,SAAW,IAAIxxE,EAAMsN,YAAYkiB,cAAczvB,KAAK2sD,UAAW3sD,KAAM+uE,GAC1EvtE,EAAEuoB,EAAK4mD,UAAU/sD,GAAG,YAAa5jB,KAAK0xE,YAAYxiE,KAAKlP,OAEvDA,KAAK2xE,sBAED3xE,KAAK6wE,YACL7wE,KAAK6wE,UAAU3hE,KAAK,SAAUlP,KAAK4xE,iBAAiB1iE,KAAKlP,OACzDA,KAAK6wE,UAAU3hE,KAAK,UAAWlP,KAAK6xE,kBAAkB3iE,KAAKlP,OAC3DA,KAAK6wE,UAAU3hE,KAAK,SAAUlP,KAAK8xE,iBAAiB5iE,KAAKlP,OACzDA,KAAK6wE,UAAU3hE,KAAK,SAAUlP,KAAK+xE,iBAAiB7iE,KAAKlP,QAG7DA,KAAKuwE,gBAAgBrhE,KAAK,SAAUlP,KAAKgyE,oBAAoB9iE,KAAKlP,OAClEA,KAAKwwE,qBAAqBthE,KAAK,SAAUlP,KAAKgyE,oBAAoB9iE,KAAKlP,OACvEA,KAAKywE,qBAAqBvhE,KAAK,SAAUlP,KAAKgyE,oBAAoB9iE,KAAKlP,OACvEA,KAAK0wE,mBAAmBxhE,KAAK,SAAUlP,KAAKgyE,oBAAoB9iE,KAAKlP,OAGrEA,KAAKuwE,gBAAgBnyD,QAChB2wB,IAAI/uC,KAAKwwE,qBAAqBpyD,SAC9B2wB,IAAI/uC,KAAKywE,qBAAqBryD,SAC9B2wB,IAAI/uC,KAAK0wE,mBAAmBtyD,SAC5BwF,GAAG,eAAe,GAEnB5jB,KAAK4wE,WACL5wE,KAAK4wE,SAAS1hE,KAAK,SAAUlP,KAAKiyE,iBAAiB/iE,KAAKlP,OACxDA,KAAK4wE,SAAS1hE,KAAK,SAAUlP,KAAKkyE,gBAAgBhjE,KAAKlP,OAE/D,EAEA2xE,oBAAqB,SAAUz+D,QACZpG,IAAXoG,GAAwBA,GACxBlT,KAAKmyE,YAAc,IAAIlyE,EAAMsN,YAAYkiB,cAAczvB,KAAKswE,iBAAkBtwE,KAAMmvE,GACpFnvE,KAAKoyE,eAAiB,IAAInyE,EAAMsN,YAAYkiB,cAAczvB,KAAKmxE,OAAOkB,aAAcryE,KAAMuvE,GAC1FvvE,KAAKsyE,iBAAmB,IAAIryE,EAAMsN,YAAYkiB,cAAczvB,KAAKmxE,OAAOoB,cAAevyE,KAAMwvE,KAE7FxvE,KAAKmyE,YAAYjvD,UACjBljB,KAAKoyE,eAAelvD,UACpBljB,KAAKsyE,iBAAiBpvD,UAE9B,EAEAsvD,SAAU,SAASlyE,GACf,IAAIyF,EAAS/F,KAAKwN,UAAUq8D,QAAQvpE,GAyBpC,MAvBwB,gBAApBA,EAAQM,SAA8BmF,GACtC/F,KAAKwN,UAAUtM,QAAQ,SAAU,CAAEuxE,aAAa,IAGhD1sE,IACA/F,KAAK0yE,oBAAqB,EACJ,UAAlB3sE,EAAO0I,QACPzO,KAAKmxE,OAAOwB,YAAW,GACvB3yE,KAAK+pB,KAAK6oD,UAAU7sE,EAAQ,WAExB/F,KAAK6yE,gBAAe,GAEpB7yE,KAAKmxE,OAAOjvE,MAAMlC,KAAK8yE,kBAEvB9yE,KAAKmxE,OAAOl/D,OAASjS,KAAKwN,UAAUo8D,aAAa5pE,KAAKwN,UAAUkL,cAAcwsC,mBAE9EllD,KAAKmxE,OAAOnjE,QAChB,EAAEkB,KAAKlP,QAEPA,KAAK+pB,KAAKxI,WAAWxb,EAAO0I,SAI7B1I,CACX,EAEAgtE,eAAgB,WACZ,OAAO/yE,KAAKwN,UAAUkL,cAAcvB,aAAakW,WAAW+K,UAChE,EAEA45C,oBAAqB,SAAS3pD,GAC1B,IACIznB,EACJ,OAFaY,EAAE6mB,EAAE0lC,MAAMvjD,KAAK,WAG1B,IAAK,MACH5J,EAAU,CAAEA,QAAS,oBAAqBN,QAAS,CAAEmN,SAAUzN,KAAKwN,YACpE,MACF,IAAK,OACH5M,EAAU,CAAEA,QAAS,qBAAsBN,QAAS,CAAEmN,SAAUzN,KAAKwN,YACrE,MACF,IAAK,QACH5M,EAAU,CAAEA,QAAS,sBAAuBN,QAAS,CAAEmN,SAAUzN,KAAKwN,YACtE,MACF,IAAK,iBACH5M,EAAU,CAAEA,QAAS,uBAAwBN,QAAS,CAAEiP,QAASvP,KAAKuvB,UAAUlgB,OAAOQ,iBACvF,MACF,IAAK,iBACHjP,EAAU,CAAEA,QAAS,sBAAuBN,QAAS,CAAEiP,QAASvP,KAAKuvB,UAAUlgB,OAAOQ,iBACtF,MACF,IAAK,eACHjP,EAAU,CAAEA,QAAS,oBAAqBN,QAAS,CAAEiP,QAASvP,KAAKuvB,UAAUlgB,OAAOQ,iBACpF,MACF,IAAK,UACHjP,EAAU,CAAEA,QAAS,mBAAoBN,QAAS,CAAE4B,MAAO,YAC3D,MACF,IAAK,QACHlC,KAAK+pB,KAAKxI,WAAW,SACrB,MACF,IAAK,WACH3gB,EAAU,CAAEA,QAAS,kBAAmBN,QAAS,CAAEie,KAAM,QACzD,MACF,IAAK,cACH3d,EAAU,CAAEA,QAAS,kBAAmBN,QAAS,CAAEie,KAAM,WACzD,MACF,IAAK,aACH3d,EAAU,CAAEA,QAAS,oBAAqBN,QAAS,CAAEie,KAAM,QAC3D,MACF,IAAK,gBACH3d,EAAU,CAAEA,QAAS,oBAAqBN,QAAS,CAAEie,KAAM,WAC3D,MACF,IAAK,aACH3d,EAAU,CAAEA,QAAS,oBACrB,MACF,IAAK,gBACHA,EAAU,CAAEA,QAAS,uBAIrBA,GACAZ,KAAKwyE,SAAS5xE,EAEtB,EAEAmxE,iBAAkB,SAAS1pD,GACvB,IAAIrZ,EAAQhP,KAAKwN,UAAUyyC,YAAY53B,EAAEnc,MAGpC8C,GAILhP,KAAKwN,UAAUq9D,YAAY77D,EAC/B,EAEAkU,QAAS,WACLljB,KAAKyxE,SAASvuD,UACdljB,KAAK2xE,qBAAoB,GACzB3xE,KAAKmyE,YAAYjvD,UACjBljB,KAAKsyE,iBAAiBpvD,SAC1B,EAEA0uD,iBAAkB,SAASvpD,GACvB,IAAIrZ,EACAvB,EAAWzN,KAAKwN,UAEpB,GAAI6a,EAAEslC,YAAa,CACf,GAAI3tD,KAAKwN,UAAUtM,QAAQ,eACvB,OAGJ8N,EAAQvB,EAAS6tD,aACrB,MACItsD,EAAQvB,EAASwyC,YAAY53B,EAAEnc,MAInC,GAAIuB,EAASiL,cAAcxM,SAAW8C,EAAM9C,OAAQ,CAChD,GAAIlM,KAAKwN,UAAUtM,QAAQ,cAAe,CAAE8N,MAAOA,IAC/C,OAGChP,KAAKmxE,OAAOvkD,cAAa,IAC1B5sB,KAAKmxE,OAAOwB,aAGhBllE,EAASiL,YAAY1J,EACzB,CACJ,EAEA6iE,kBAAmB,SAASxpD,GACxB,IAAI5a,EAAWzN,KAAKwN,UAChBwB,EAAQvB,EAASi9D,aAAariD,EAAE6kC,UAChCx0C,EAAcjL,EAASiL,cACvBs6D,EAAkBt6D,EAAYxM,OAIlC,GAFAuB,EAASw8D,iBAAiBj7D,EAAOqZ,EAAE8kC,UAE/B6lB,IAAoBhkE,EAAM9C,OAAQ,CAClC,GAAIuB,EAASvM,QAAQ,cAAe,CAAE8N,MAAOA,IAEzC,YADAvB,EAASiL,YAAYA,GAIpB1Y,KAAKmxE,OAAOvkD,cAAa,IAC1B5sB,KAAKmxE,OAAOwB,aAGhBllE,EAASiL,YAAY1J,EACzB,CACJ,EAEA8iE,iBAAkB,SAASzpD,GACvB,IAAIrZ,EAAQhP,KAAKwN,UAAUk9D,aAAariD,EAAEulC,YAEtC5tD,KAAKwN,UAAUyyC,YAAY53B,EAAEnc,MAC7BlM,KAAK+pB,KAAK6oD,UAAU,CAAEnkE,OAAQ,QAASC,KAAM,wBAIjD1O,KAAKwN,UAAUosB,YAAY5qB,EAAOqZ,EAAEnc,MAEpClM,KAAKswE,iBAAiB70D,QAC1B,EAEAzM,MAAO,SAASA,GACZhP,KAAKuvB,UAAYvgB,EAAMugB,YACvBvvB,KAAK0e,YAAc1P,EAAM0P,aAC7B,EAEAjR,SAAU,SAASA,GACfzN,KAAKwN,UAAYC,EACjBzN,KAAKoY,UAAY3K,EAAS2K,YAC1B3K,EAASyB,KAAK,iBAAkBlP,KAAKiyE,iBAAiB/iE,KAAKlP,MAC/D,EAEAgqE,QAAS,WACL,IAAImH,EAASnxE,KAAKmxE,OAEdniE,EADWhP,KAAKwN,UACCkL,cAErB1Y,KAAK2/B,gBAAkB3/B,KAAK+pB,KAAK4mD,SAASsC,aAC1CjzE,KAAKuvB,UAAUnrB,OAAOpE,KAAK2/B,iBAEtBwxC,EAAOzlD,YAAe1rB,KAAKkzE,mBAC5B/B,EAAOj+D,QAAsC,IAA/BlE,EAAM2J,YAAYzF,UAChClT,KAAKmzE,oBAGT,IAAIpkE,EAAMC,EAAM2J,YAAY9J,KAAKwe,WAC7B4oC,EAAMj2D,KAAKwN,UAAUi/D,WAAW19D,EAAKC,EAAM9C,QAC/ClM,KAAK+pB,KAAK+mD,WAAW5uE,MAAM+zD,EAAI/pD,KACnC,EAEAslE,SAAU,WACNxxE,KAAK+pB,KAAKi+B,OAAO,CAAEorB,QAAQ,GAC/B,EAEAC,QAAS,SAAS96D,GACd,IAAI+6D,EAAS/6D,EAAMiS,cAAc8oD,OAC7BC,EAASh7D,EAAMiS,cAAc+oD,OAEK,IAAlCh7D,EAAMiS,cAAcgpD,YACpBF,GAAU,GACVC,GAAU,IAGdvzE,KAAKyzE,WAAWH,EAAQC,GAExBh7D,EAAMa,gBACV,EAEAs6D,SAAU,SAASn7D,EAAOuoB,GACV9gC,KAAKwN,UAAUkL,cACrB7I,eAAiB,KACvB7P,KAAKuvB,UAAUuS,eAAe0sC,EAAQ1tC,IACtCvoB,EAAMa,gBACV,EAEAu6D,SAAU,WACN3zE,KAAK4zE,YAAY5zE,KAAK2/B,gBAC1B,EAEAk0C,WAAY,WACR7zE,KAAK4zE,WAAW5zE,KAAK2/B,gBACzB,EAEAm0C,cAAe,SAASv7D,EAAOuoB,GAC3B,IAAI9xB,EAAQhP,KAAKwN,UAAUkL,cAE3B,GAAIH,EAAM6Y,IAAK,CACX,IACI2iD,GAAgB,EAEpB,OAHUlxE,OAAO2F,aAAa+P,EAAMkR,UAIlC,IAAK,IACHza,EAAMa,eAAiB,KACvB7P,KAAKuvB,UAAU2Q,YACf,MACF,IAAK,IACHlgC,KAAKwN,UAAU86D,cAAcnnE,OAC7B,MACF,IAAK,IACHnB,KAAKwN,UAAU86D,cAActnE,OAC7B,MACF,QACE+yE,GAAgB,EAGhBA,GACAx7D,EAAMa,gBAEd,KAAO,CACH,IAAI46D,GAA0C,IAA/BhlE,EAAM2J,YAAYzF,SAC7B+gE,EAAoB,UAAXnzC,EAEb,GAAc,UAAVA,GAAgC,aAAVA,EAClB9xB,EAAMa,eACN7P,KAAKwyE,SAAS,CACV5xE,QAAS,uBACTN,QAAS,CAAEiP,QAASP,EAAMa,kBAEtBmkE,GACRh0E,KAAKwyE,SAAS,CAAE5xE,QAAS,wBAE7B2X,EAAMa,sBACH,GAAIm1D,EAAetmE,KAAK64B,KAAYmzC,EAAQ,CAE/C,GADAjlE,EAAMa,eAAiB,KACnBmkE,EAEA,YADAz7D,EAAMa,iBAGN66D,GACAj0E,KAAKmxE,OAAOjvE,MAAM,IAEtBlC,KAAK6yE,eAAeoB,EACxB,MACIj0E,KAAKuvB,UAAUyS,oBAAoB2sC,EAAc7tC,IACjDvoB,EAAMa,gBAEd,CACJ,EAEA86D,cAAe,SAAS37D,EAAOuoB,GAC3B9gC,KAAKuvB,UAAUsR,gBAAgB2tC,EAAQ1tC,EAAOh+B,QAAQ,SAAU,KAAM9C,KAAKm0E,iBAC3E57D,EAAMa,gBACV,EAEAg7D,YAAa,SAAS77D,GAClB,IAAIvJ,EAAQhP,KAAKwN,UAAUkL,cAE3B,IAAI1J,EAAMozC,uBAAwBpzC,EAAMg1C,sBAAxC,CAIA,IAAIhhD,EAAShD,KAAKq0E,SAAS97D,GACP,uBAAhBvV,EAAO0L,MAAiD,oBAAhB1L,EAAO0L,KAC/CM,EAAMq0C,qBAAqBrgD,EAAO+L,KAElCC,EAAMo0C,qBAGVp0C,EAAM6zC,eAA8B,QAAf7/C,EAAO0L,KAAiB1L,EAAO+L,IAAM,KAT1D,CAUJ,EAEA2iE,YAAa,SAASn5D,GAClB,IAAIvV,EAAShD,KAAKq0E,SAAS97D,GAK3B,GAJIvV,EAAO45C,OACP58C,KAAKs0E,YAActxE,EAAO45C,MAG1B58C,KAAKu0E,sBAAsBh8D,EAAOvV,GAClCuV,EAAMuyC,sBADV,CAKA,IAAI97C,EAAQhP,KAAKwN,UAAUkL,cACvB87D,EAAMx0E,KAAK2sD,UAAUM,QAAQ,IAAMhtD,EAAMwjB,KAAK,QAAU,cAS5D,GARI+wD,EAAInzE,SACJmzE,EAAMv0E,EAAMw0E,eAAeD,KAChBA,EAAIl0E,QAAQo0E,OACnBn8D,EAAMuyC,kBAId97C,EAAMa,eAAiB,KACH,YAAhB7M,EAAO0L,KAOP,OANAM,EAAMa,eAAiB7M,EAAOuM,QAC9BvM,EAAOiZ,KAAOjZ,EAAOuM,QAAQE,QAC7BzM,EAAO2xE,SAAW3lE,EAAMy0C,mBAAmBzgD,EAAOiZ,MAClDjN,EAAMs0C,cAActgD,GACpBgM,EAAMc,cAAc,CAAE+zC,UAAU,SAChCtrC,EAAMa,iBAIV,GAAoB,YAAhBpW,EAAO0L,KAGP,OAFA6J,EAAMa,sBACNb,EAAMuyC,kBAIV,GAAoB,WAAhB9nD,EAAO0L,KAMP,OAHA1O,KAAK40E,cACL50E,KAAK60E,wBACLt8D,EAAMa,iBAIV,GAAIpZ,KAAKmxE,OAAOvkD,cAAa,IAAU5pB,EAAO+L,IAI1C,OAHA/O,KAAKwN,UAAUkL,cAAcusC,sBAAsBjlD,KAAKmxE,OAAO7iD,mBAC/DtuB,KAAKuvB,UAAUiR,eAAex9B,EAAO+L,IAAK/O,KAAK80E,eAAgB90E,KAAKm0E,gBAAiB57D,EAAMgZ,SAAUvxB,KAAK+pB,WAC1GxR,EAAMa,iBAKN,GAFApZ,KAAK0yE,oBAAqB,EAC1B1yE,KAAKmxE,OAAOwB,cACR3yE,KAAK0yE,mBAAT,CAKJ,GAAoB,uBAAhB1vE,EAAO0L,MAAiD,oBAAhB1L,EAAO0L,KAG/C,OAFAM,EAAMwyC,cAAc,CAAE/6C,EAAGzD,EAAOyD,EAAGqqB,EAAG9tB,EAAO8tB,SAC7CvY,EAAMa,iBAIV,GAAoB,eAAhBpW,EAAO0L,KAGP,OAFA1O,KAAK+0E,eAAex8D,QACpBA,EAAMa,iBAIVpZ,KAAK80E,eAAiBrF,EAAgBzsE,EAAO0L,MAC7C1O,KAAKm0E,gBAAkB57D,EAAM6Y,IAC7BpxB,KAAKuvB,UAAUiR,eAAex9B,EAAO+L,IAAK/O,KAAK80E,eAAgB90E,KAAKm0E,gBAAiB57D,EAAMgZ,SAAUvxB,KAAK+pB,KAjBtG,CA/CJ,CAiEJ,EAEAwqD,sBAAuB,SAASh8D,GAC5B,IAAIy8D,EAASxzE,EAAE+W,EAAMvG,QAAQi7C,QAAQ,iCACrC,GAAI+nB,EAAO3zE,OAAQ,CACf,IAAI4hD,EAAWjjD,KAAKi1E,gBAAgB18D,GAChCyoB,EAAYg0C,EAAOxqE,KAAK,aACxBwE,EAAQhP,KAAKwN,UAAUkL,cACvBnJ,EAAUP,EAAMa,eAWpB,OAVAb,EAAMs0C,cAAc,CAChB1G,KAAW58C,KAAKs0E,YAChB/kE,QAAWA,EACX0M,KAAW1M,EAAQE,QACnBklE,SAAW3lE,EAAMy0C,mBAAmBl0C,GACpCoL,OAAWqmB,EAEXk0C,OAAWjyB,EAASx8C,EACpB0uE,OAAWlyB,EAASnyB,KAEjB,CACX,CACJ,EAEAskD,cAAe,SAAS78D,GACpB,IAAIvJ,EAAQhP,KAAKwN,UAAUkL,cAI3B,GAFAH,EAAMa,kBAEFpK,EAAMozC,uBAAwBpzC,EAAMqzC,qBAAxC,CASA,IAAIgzB,EALJr1E,KAAKuwE,gBAAgBvnD,QACrBhpB,KAAKywE,qBAAqBznD,QAC1BhpB,KAAKwwE,qBAAqBxnD,QAC1BhpB,KAAK0wE,mBAAmB1nD,QAIxB,IAAIhmB,EAAShD,KAAKq0E,SAAS97D,GAE3B,GAAoB,uBAAhBvV,EAAO0L,MAAiD,oBAAhB1L,EAAO0L,KAAnD,CAII1L,EAAO+L,IACP/O,KAAKuvB,UAAUoR,qBAAqB39B,EAAO+L,IAAK0gE,EAAgBzsE,EAAO0L,OACjD,WAAf1L,EAAO0L,MACd1O,KAAKuvB,UAAUqR,4BAA4B59B,EAAOuM,SAGtD,IAAI+lE,EAAct1E,KAAKuvB,UAAUlgB,OAAOrB,mBAAoB/N,EAAMsN,YAAYuL,SAC1Ey8D,GAAa,EACbC,GAAc,EAEC,gBAAfxyE,EAAO0L,MACP2mE,EAAOr1E,KAAKywE,qBACZ8E,GAAcD,GAAet1E,KAAK0e,YAAYmmB,kCACxB,aAAf7hC,EAAO0L,MACd2mE,EAAOr1E,KAAKwwE,qBACZ+E,GAAcD,GAAet1E,KAAK0e,YAAYomB,+BACxB,WAAf9hC,EAAO0L,KACd2mE,EAAOr1E,KAAK0wE,oBAEZ2E,EAAOr1E,KAAKuwE,gBACZiF,EAAcx1E,KAAKuvB,UAAUwQ,gCAGjCs1C,EAAKj3D,QAAQwkB,KAAKotC,GAAwC1jD,QAAQgpD,GAClED,EAAKj3D,QAAQwkB,KAAKqtC,GAAyB3jD,OAAOipD,GAClDF,EAAKj3D,QAAQwkB,KAAK,yBAAyBtW,OAAOkpD,GAGlD3rD,YAAW,WACPwrD,EAAKjsD,KAAK7Q,EAAMsY,MAAOtY,EAAMwY,MACjC,GAhCA,CAbA,CA8CJ,EAEA0kD,QAAS,SAASl9D,GACdA,EAAMa,gBACV,EAEAs8D,gBAAiB,SAAShnE,EAAMK,GAC5B,IACI4mE,EADQ31E,KAAKwN,UAAUkL,cACFiqC,uBAEzB,OAAQgzB,GAAyB,YAATjnE,GAA+B,cAATA,GAAwBK,EAAIsG,IAAMsgE,EAAatgE,KAAOtG,EAAI2E,IAAMiiE,EAAajiE,GAC/H,EAEAkiE,aAAc,SAASr9D,GACnB,IAAIvJ,EAAQhP,KAAKwN,UAAUkL,cACvB8qC,EAAOx0C,EAAMqzC,qBACjB,IAAKmB,EACD,OAAO,EAGX,IAAIP,EAAWjjD,KAAKi1E,gBAAgB18D,GAChChJ,EAAUi0C,EAAKj0C,QACf+jE,EAASrwB,EAASx8C,EAAI+8C,EAAK0xB,OAC3B3B,EAAStwB,EAASnyB,EAAI0yB,EAAK2xB,OAkE/B,MAhEmB,MAAf3xB,EAAK7oC,OACD6oC,EAAKhzC,OACDC,KAAK0pB,IAAIm5C,GAAU7iE,KAAK0pB,IAAIo5C,IAC5BhkE,EAAQpL,MAAQsM,KAAKmK,IAAI4oC,EAAKvnC,KAAK9X,MAAQmvE,EAAQ,IACnD/jE,EAAQnL,OAASmL,EAAQpL,MAAQq/C,EAAKhzC,SAEtCjB,EAAQnL,OAASqM,KAAKmK,IAAI4oC,EAAKvnC,KAAK7X,OAASmvE,EAAQ,IACrDhkE,EAAQpL,MAAQoL,EAAQnL,OAASo/C,EAAKhzC,SAG1CjB,EAAQpL,MAAQsM,KAAKmK,IAAI4oC,EAAKvnC,KAAK9X,MAAQmvE,EAAQ,IACnD/jE,EAAQnL,OAASqM,KAAKmK,IAAI4oC,EAAKvnC,KAAK7X,OAASmvE,EAAQ,KAGrC,KAAf/vB,EAAK7oC,OACVpL,EAAQpL,MAAQsM,KAAKmK,IAAI4oC,EAAKvnC,KAAK9X,MAAQmvE,EAAQ,IAE/B,KAAf9vB,EAAK7oC,OACVpL,EAAQnL,OAASqM,KAAKmK,IAAI4oC,EAAKvnC,KAAK7X,OAASmvE,EAAQ,IAEjC,KAAf/vB,EAAK7oC,OACN6oC,EAAKvnC,KAAK7X,OAASmvE,EAAS,KAC5BhkE,EAAQnL,OAASo/C,EAAKvnC,KAAK7X,OAASmvE,EACpChkE,EAAQwB,QAAUyyC,EAAKvnC,KAAKlL,QAAUwiE,GAGtB,KAAf/vB,EAAK7oC,OACN6oC,EAAKvnC,KAAK9X,MAAQmvE,EAAS,KAC3B/jE,EAAQpL,MAAQq/C,EAAKvnC,KAAK9X,MAAQmvE,EAClC/jE,EAAQuB,QAAU0yC,EAAKvnC,KAAKnL,QAAUwiE,GAGtB,MAAf9vB,EAAK7oC,QACVpL,EAAQpL,MAAQsM,KAAKmK,IAAI4oC,EAAKvnC,KAAK9X,MAAQmvE,EAAQ,IAC/C9vB,EAAKvnC,KAAK7X,OAASmvE,EAAS,KAC5BhkE,EAAQnL,OAASo/C,EAAKvnC,KAAK7X,OAASmvE,EACpChkE,EAAQwB,QAAUyyC,EAAKvnC,KAAKlL,QAAUwiE,IAGtB,MAAf/vB,EAAK7oC,QACVpL,EAAQnL,OAASqM,KAAKmK,IAAI4oC,EAAKvnC,KAAK7X,OAASmvE,EAAQ,IACjD/vB,EAAKvnC,KAAK9X,MAAQmvE,EAAS,KAC3B/jE,EAAQpL,MAAQq/C,EAAKvnC,KAAK9X,MAAQmvE,EAClC/jE,EAAQuB,QAAU0yC,EAAKvnC,KAAKnL,QAAUwiE,IAGtB,MAAf9vB,EAAK7oC,QACN6oC,EAAKvnC,KAAK7X,OAASmvE,EAAS,KAC5BhkE,EAAQnL,OAASo/C,EAAKvnC,KAAK7X,OAASmvE,EACpChkE,EAAQwB,QAAUyyC,EAAKvnC,KAAKlL,QAAUwiE,GAEtC/vB,EAAKvnC,KAAK9X,MAAQmvE,EAAS,KAC3B/jE,EAAQpL,MAAQq/C,EAAKvnC,KAAK9X,MAAQmvE,EAClC/jE,EAAQuB,QAAU0yC,EAAKvnC,KAAKnL,QAAUwiE,KAK1C/jE,EAAQuB,QAAU0yC,EAAKvnC,KAAKnL,QAAUwiE,EACtC/jE,EAAQwB,QAAUyyC,EAAKvnC,KAAKlL,QAAUwiE,GAG1CvkE,EAAMc,cAAc,CAAE+zC,UAAU,KAEzB,CACX,EAEAgyB,YAAa,SAASt9D,GAClB,GAA4B,UAAxBvY,KAAK80E,eAAT,CAIA,IAAI7xB,EAAW,CAAE6yB,QAASv9D,EAAMu9D,QAASC,QAASx9D,EAAMw9D,SACpD/mE,EAAQhP,KAAKwN,UAAUkL,cAE3B,IAAI1Y,KAAK41E,aAAar9D,GAAtB,CAIA,IAAIvV,EAAShD,KAAKq0E,SAASpxB,GAE3B,GAAIj0C,EAAMozC,qBAEDpiD,KAAK01E,gBAAgB1yE,EAAO0L,KAAM1L,EAAO+L,MAC1CC,EAAMyzC,mBAAmB,CAAEh8C,EAAGzD,EAAOyD,EAAGqqB,EAAG9tB,EAAO8tB,SAM1D,GAAoB,YAAhB9tB,EAAO0L,KAAX,CAKA,GAAI1O,KAAKs0E,cAAgBtxE,EAAO45C,KAC5B58C,KAAKg2E,iBAAiB/yB,OACnB,CACH,IAAIgzB,EAAQj2E,KAAKs0E,YAAYx2C,MAEzB96B,EAAOyD,EAAIwvE,EAAMt2D,OACjB1f,EAAMsqD,WAAWvqD,MAGjBgD,EAAO8tB,EAAImlD,EAAMj2D,QACjBhgB,KAAKk2E,YAGLlzE,EAAO8tB,EAAImlD,EAAMl2D,KAAO/c,EAAOyD,EAAIwvE,EAAMx2D,KACzCzf,KAAKm2E,gBAAgBnzE,EAAQigD,GAE7BjjD,KAAKg2E,iBAAiB/yB,EAE9B,CAEA1qC,EAAMa,gBAtBN,MAFIpZ,KAAKm2E,gBAAgBnzE,EAdzB,CAPA,CA8CJ,EAEAozE,UAAW,SAAS79D,GAChB,IAAIvJ,EAAQhP,KAAKwN,UAAUkL,cAC3B1J,EAAMuzC,mBACNvzC,EAAMu0C,mBAENvjD,KAAKuvB,UAAUmR,oBACf1gC,KAAKq2E,iBAEL,IAAIlF,EAASnxE,KAAKmxE,OAAOmF,eACzB,GAAKnF,EAAL,CAIA,IADA,IAAIrqD,EAAKvO,EAAMvG,OACR8U,GAAI,CACP,GAAIA,IAAOqqD,EAAO/yD,QAAQ,GACtB,OAEJ0I,EAAKA,EAAG1hB,UACZ,CAEA,IAAIpC,EAAShD,KAAKq0E,SAAS97D,GACvBvV,GAAUA,EAAO+L,KAAOoiE,EAAOvkD,cAAa,KAC5CukD,EAAO/jD,WAAWpe,GAClBA,EAAMi2C,sBAAsBksB,EAAO7iD,mBAZvC,CAcJ,EAEAioD,WAAY,SAASh+D,GACjB,IAAIvV,EAAShD,KAAKq0E,SAAS97D,GACvBy7D,GAAiE,IAAtDh0E,KAAKwN,UAAUkL,cAAcC,YAAYzF,SAExD,GAAoB,SAAhBlQ,EAAO0L,OAAmBslE,EAA9B,CAIA,IAAIhvD,EAAMhlB,KAAKwN,UAAUkL,cAAcC,YACvC3Y,KAAK6yE,gBAAgB7tD,EAAI9iB,UAAY8iB,EAAIiR,WACzCj2B,KAAKuxE,gBAJL,CAKJ,EAEAiF,MAAO,SAASnuD,GACZ,IAAIxoB,EAAOG,KACX6pB,YAAW,WACPhqB,EAAKuY,UAAUa,iBAAqBnM,IAANub,EAC9BxoB,EAAK2yE,SAAS,CACV5xE,QAAS,aACTN,QAAS,CAAEmN,SAAU5N,EAAKkqB,KAAKvc,UAAW+K,MAAO8P,EAAEmC,eAAiBnC,IAE5E,GACJ,EAEAouD,eAAgB,WACZ,OAAOz2E,KAAKswE,iBAAiBniD,MACjC,EAEAuoD,YAAa,SAASrmE,GAClB,IAAIxQ,EAAOG,KACPgQ,EAAM,IAAIvO,OAAOk1E,MACrB3mE,EAAIu1C,IAAM9jD,OAAOkrE,IAAIC,gBAAgBv8D,GACrCL,EAAIw3D,OAAS,WACT3nE,EAAK2yE,SAAS,CACV5xE,QAAS,qBACTN,QAAS,CACL+P,KAAMA,EACNlM,MAAO6L,EAAI7L,MACXC,OAAQ4L,EAAI5L,SAGxB,EACAylB,YAAW,WACPpoB,OAAOkrE,IAAIE,gBAAgB78D,EAAIu1C,IACnC,GAAG,GACP,EAEAqxB,QAAS,SAASvuD,GACd,IAAIxoB,EAAOG,KACPmuB,EAAO,GACPgY,EAAQ,GAEZ,GADAtmC,EAAKuY,UAAUa,iBAAqBnM,IAANub,EAC1BA,EAAG,CACH,IAAIiC,EAAgBjC,EAAEmC,cAAcF,cACpC,IAAIA,IAAiBA,EAAcC,QA6B5B,CACH,GAAI9oB,OAAO6oB,cAAcusD,OAASp1E,OAAO6oB,cAAcusD,MAAMx1E,OAAQ,CACjE,IAAI63D,EAAOz3D,OAAO6oB,cAAcusD,MAAM,GACtC,GAAI,8BAA8B5uE,KAAKixD,EAAKxqD,MACxC,OAAO7O,EAAK62E,YAAYxd,EAEhC,CAsBA,OApBA/yB,EAAQ1kC,OAAO6oB,cAAcC,QAAQ,WAEjC4b,EAAQA,EAAMie,QAMlBvkD,EAAKywE,iBAAiBnzC,aACtBtT,YAAW,aACPsE,EAAOtuB,EAAKywE,iBAAiBniD,SACjBgY,KACRtmC,EAAKuY,UAAUouB,SAAS,CAAErY,KAAMA,EAAMgY,MAAOA,IAC7CtmC,EAAK2yE,SAAS,CACV5xE,QAAS,eACTN,QAAS,CAAEmN,SAAU5N,EAAKkqB,KAAKvc,UAAW+K,MAAO8P,EAAEmC,eAAiBnC,KAGhF,GAGJ,CAzDIA,EAAEjP,iBACF,IAAI09D,GAAU,EACVC,GAAe,EAkBnB,GAhBIt1E,OAAOu1E,eAAiB1sD,EAAc2sD,iBAAiBx1E,OAAOu1E,eAC9DF,EAAUxsD,EAAc2sD,MAAMp8C,SAAS,aACvCk8C,EAAezsD,EAAc2sD,MAAMp8C,SAAS,eACrCC,MAAM4T,QAAQpkB,EAAc2sD,QACnCH,EAAUxsD,EAAc2sD,MAAM1lE,QAAQ,cAAgB,EACtDwlE,EAAezsD,EAAc2sD,MAAM1lE,QAAQ,eAAiB,IAE5DulE,EAAU,aAAa7uE,KAAKqiB,EAAc2sD,OAC1CF,EAAe,cAAc9uE,KAAKqiB,EAAc2sD,QAEhDH,IACA3oD,EAAO7D,EAAcC,QAAQ,aAAa65B,QAE1C2yB,IACA5wC,EAAQ7b,EAAcC,QAAQ,cAAc65B,SAE3Cj2B,IAASgY,GAAS7b,EAAcyvC,OAASzvC,EAAcyvC,MAAM14D,OAC9D,IAAK,IAAIkC,EAAI,EAAGA,EAAI+mB,EAAcyvC,MAAM14D,SAAUkC,EAAG,CACjD,IAAIwqD,EAAOzjC,EAAcyvC,MAAMx2D,GAC/B,GAAiB,QAAbwqD,EAAKmpB,MAAkB,8BAA8BjvE,KAAK8lD,EAAKr/C,MAC/D,OAAO7O,EAAK62E,YAAY3oB,EAAKopB,YAErC,CAgCZ,KAAO,CACH,GAAIl3E,EAAMqb,QAAQ8O,QAAQC,KAGtB,OAFAxqB,EAAKywE,iBAAiBpvE,QAAQ,SAAS8M,cACvCpK,SAAS8X,YAAY,SAGrB7b,EAAKuY,UAAUa,aAAc,CAErC,EAEKkV,GAASgY,KAGdtmC,EAAKuY,UAAUouB,SAAS,CAAErY,KAAMA,EAAMgY,MAAMA,IAC5CtmC,EAAK2yE,SAAS,CACV5xE,QAAS,eACTN,QAAS,CAAEmN,SAAU5N,EAAKkqB,KAAKvc,UAAW+K,MAAO8P,EAAEmC,eAAiBnC,KAE5E,EAEA+uD,OAAQ,SAAS/uD,GACbroB,KAAKoY,UAAUa,iBAAqBnM,IAANub,EAC9BroB,KAAKwyE,SAAS,CACV5xE,QAAS,cACTN,QAAS,CAAEmN,SAAUzN,KAAK+pB,KAAKvc,UAAW+K,MAAO8P,EAAEmC,eAAiBnC,IAE5E,EAIA6tD,UAAW,WACPl2E,KAAK2wE,SAASuF,UAAY,CAC9B,EAEA3rB,WAAY,WACRvqD,KAAK2wE,SAASpmB,WAAa,CAC/B,EAEAqpB,WAAY,SAAS1xE,GACjBlC,KAAK2wE,SAASuF,WAAah0E,CAC/B,EAEAm1E,YAAa,SAASn1E,GAClBlC,KAAK2wE,SAASpmB,YAAcroD,CAChC,EAEAuxE,WAAY,SAAS9zD,EAAOkgD,GACxB7/D,KAAK2wE,SAASuF,WAAarW,EAC3B7/D,KAAK2wE,SAASpmB,YAAc5qC,CAChC,EAEAs1D,gBAAiB,SAAShyB,GACtB,IAAIx+C,EAAMzE,KAAK2sD,UAAU,GAAG2qB,wBAC5B,MAAO,CACH7wE,EAAGw8C,EAAS6yB,QAAUrxE,EAAIgb,KAC1BqR,EAAGmyB,EAAS8yB,QAAUtxE,EAAIsb,IAElC,EAEAs0D,SAAU,SAASpxB,EAAUs0B,GACzB,GAAKt0B,EAIL,OADAA,EAAWjjD,KAAKi1E,gBAAgBhyB,GACzBjjD,KAAK+pB,KAAKsqD,SAASpxB,EAASx8C,EAAGw8C,EAASnyB,EAAGymD,EACtD,EAEAvB,iBAAkB,SAASwB,GACvB,IAAIx0E,EAAShD,KAAKq0E,SAASmD,GAAc,GAErCx0E,EAAO45C,MAAQ55C,EAAO+L,MACtB/O,KAAK+iC,gBAAgB//B,GACrBhD,KAAKy3E,sBAAwBD,EAC7Bx3E,KAAKs0E,YAActxE,EAAO45C,MAG9B58C,KAAKq2E,gBACT,EAEAtzC,gBAAiB,SAAS//B,GACtBhD,KAAKuvB,UAAUwT,gBAAgB//B,EAAO+L,IAAK/O,KAAK80E,eACpD,EAEA4C,WAAY,WACR,IAAIjxE,EAAIzG,KAAK23E,kBAAkBlxE,EAC3BqqB,EAAI9wB,KAAK23E,kBAAkB7mD,EAC3B8mD,EAAa53E,KAAKs0E,YAAYx2C,MAC9B6yC,EAAW3wE,KAAK+pB,KAAK4mD,SAGrBpmB,EAAaomB,EAASpmB,WACtB2rB,EAAYvF,EAASuF,UAErBzvE,EAAImxE,EAAWn4D,MACfzf,KAAKq3E,aANQ,GAQb5wE,EAAImxE,EAAWj4D,OACf3f,KAAKq3E,YATQ,GAWbvmD,EAAI8mD,EAAW73D,KACf/f,KAAK4zE,YAZQ,GAcb9iD,EAAI8mD,EAAW53D,QACfhgB,KAAK4zE,WAfQ,GAkBbsC,IAAcvF,EAASuF,WAAa3rB,IAAeomB,EAASpmB,WAC5DvqD,KAAKg2E,iBAAiBh2E,KAAK63E,eAE3B73E,KAAK+iC,gBAAgB/iC,KAAKq0E,SAASr0E,KAAKy3E,uBAEhD,EAEAtB,gBAAiB,SAAS2B,EAAY70B,GAC7BjjD,KAAK+3E,kBACN/3E,KAAK+3E,gBAAkBC,YAAYh4E,KAAK03E,WAAWxoE,KAAKlP,MAAO,KAGnEA,KAAK63E,cAAgB50B,GAAYjjD,KAAKy3E,sBAEtCz3E,KAAK23E,kBAAoBG,CAC7B,EAEAzB,eAAgB,WACZ4B,cAAcj4E,KAAK+3E,iBACnB/3E,KAAK+3E,gBAAkB,IAC3B,EAEAlD,iBAAkB,WACd70E,KAAK+pB,KAAK8qD,kBACd,EAEAE,eAAgB,SAASx8D,GACrB,IAAIvV,EAAShD,KAAKq0E,SAAS97D,GAEvB+E,EADQtd,KAAKwN,UAAUkL,cACRkuC,aAAa5jD,EAAO+L,KACnCmpE,EAAal4E,KAAK+pB,KAAKouD,iBAAiB76D,GAE5C46D,EAAWhpE,KAAK,SAAUlP,KAAKiyE,iBAAiB/iE,KAAKlP,OACrDk4E,EAAWhpE,KAAK,SAAUgpE,EAAWlvD,MAAM9Z,KAAKgpE,IAEhDA,EAAWE,QAAQ7/D,EAAMvG,OAAQuG,EACrC,EAIA8/D,iBAAkB,SAASpkE,GACvB,IAAIjF,EAAQhP,KAAKmxE,OAAOpjE,OAAOiB,QAC3B9M,EAAQlC,KAAKmxE,OAAOjvE,QACpBlC,KAAKwN,UAAUkL,gBAAkB1J,IAEjChP,KAAKwN,UAAUkL,cAAcusC,wBAE7BjlD,KAAKwN,UAAUkL,YAAY1J,IAE/BA,EAAMi7B,cAAa,GACnBjqC,KAAK8yE,iBAAmB5wE,EACxBlC,KAAKwyE,SAAS,CACV5xE,QAAS,cACTN,QAAS,CACL4B,MAAOA,EACP+R,aAAcA,IAG1B,EAEAm9D,eAAgB,WACZpxE,KAAKq4E,kBAAiB,EAC1B,EAEAC,qBAAsB,WAClBt4E,KAAKq4E,kBAAiB,GACtBr4E,KAAKmxE,OAAOwB,YAAW,EAC3B,EAEAtB,iBAAkB,WACd,IACIriE,EADWhP,KAAKwN,UACCkL,cAErB1J,EAAMi2C,sBAAsBjlD,KAAKmxE,OAAO7iD,mBACxCtf,EAAMi7B,cAAa,EACvB,EAEAqnC,mBAAoB,WAChB,IAAItiE,EAAQhP,KAAKwN,UAAUkL,cAE3B1J,EAAMi7B,cAAa,GACnBj7B,EAAMi2C,sBAAsB,GAChC,EAEAssB,eAAgB,WACZvxE,KAAKwN,UAAUkL,cAAcusC,sBAAsBjlD,KAAKmxE,OAAO7iD,kBACnE,EAEAiqD,iBAAkB,YACuD,IAAtDv4E,KAAKwN,UAAUkL,cAAcC,YAAYzF,UAIxDlT,KAAKmxE,OACAj6D,SAAS,CACNrJ,MAAO7N,KAAKwN,UAAUkL,cAAcC,YACpC6/D,KAAMx4E,KAAK+pB,KAAK0uD,sBAChBtsD,QAASnsB,KAAK+yE,kBAE1B,EAEA2F,kBAAmB,WACf14E,KAAKmxE,OAAOttD,OAChB,EAEA+wD,YAAa,WACT50E,KAAKmzE,mBACLnzE,KAAKmxE,OAAOwB,aAEZ3yE,KAAKswE,iBAAiBpvE,QAAQ,QAClC,EAEAkuB,cAAe,SAAS/G,GACpBA,EAAEjP,iBACFpZ,KAAKmxE,OAAO/hD,eAChB,EAEAupD,aAAc,SAASpuC,EAAGzJ,GAClB9gC,KAAKmxE,OAAOyH,eAIhB54E,KAAK0yE,oBAAqB,EAC1B1yE,KAAKmxE,OAAOwB,aAEP3yE,KAAK0yE,qBACN1yE,KAAKswE,iBAAiBpvE,QAAQ,SAC9BlB,KAAKuvB,UAAUyS,oBAAoB2sC,EAAc7tC,KAEzD,EAEA+3C,eAAgB,SAAStgE,EAAOuoB,GAC5B,IAAIqwC,EAASnxE,KAAKmxE,OACdniE,EAAQhP,KAAKwN,UAAUkL,cAEvB1Y,KAAK84E,gBAAkB,2BAA2B7wE,KAAK64B,IACvD9gC,KAAK+4E,mBACL/4E,KAAKuvB,UAAUuS,eAAe0sC,EAAQ1tC,IACtCvoB,EAAMa,kBAED+3D,EAAOvkD,cAAa,KACzB5sB,KAAKuvB,UAAUuS,eAAe0sC,EAAQ1tC,IACtCqwC,EAAOmF,eAAelpD,WAAWpe,GACjCA,EAAMi2C,sBAAsBksB,EAAO7iD,mBACnC/V,EAAMa,iBAEd,EAEA4/D,oBAAqB,SAASzgE,EAAOuoB,GACjC,IAAIqwC,EAASnxE,KAAKmxE,OACdniE,EAAQhP,KAAKwN,UAAUkL,cAEvBy4D,EAAOvkD,cAAa,KACpB5sB,KAAKuvB,UAAUsR,gBAAgB2tC,EAAQ1tC,EAAOh+B,QAAQ,SAAU,KAAM9C,KAAKm0E,iBAE3EhD,EAAOmF,eAAelpD,WAAWpe,GACjCA,EAAMi2C,sBAAsBksB,EAAO7iD,mBAEnC/V,EAAMa,iBAEd,EAGA+5D,iBAAkB,WACd,IAAInkE,EAAQhP,KAAKwN,UAAUkL,cACvB3J,EAAMC,EAAMmI,aACZ7C,EAAQtU,KAAKwN,UAAUo8D,aAAa76D,GACpCtI,EAAIuI,EAAMnB,MAAMkB,GAAK0N,2BACrBhW,IACA6N,EAAQ,IAAM7N,EAAEwvB,SAEpBj2B,KAAKmxE,OAAOjvE,MAAMoS,IAAS7N,EAC/B,EAEAosE,eAAgB,SAASoB,GAMrBj0E,KAAK84E,eAAiB7E,EAEtBj0E,KAAKmxE,OAAOj6D,SAAS,CACjBrJ,MAAO7N,KAAKwN,UAAUkL,cAAcC,YACpC6/D,KAAMx4E,KAAK+pB,KAAK0uD,sBAChBtsD,QAASnsB,KAAK+yE,mBACft3D,OACP,EAEAs9D,iBAAkB,WACd/4E,KAAK+pB,KAAKonD,OAAOwB,YACrB,EAEAV,iBAAkB,SAAS5pD,GACnBA,EAAEznB,QACFZ,KAAKwyE,SAASnqD,GAEdroB,KAAKwN,UAAU86D,cAAcjgD,EAAEyY,SAEvC,EAEAoxC,gBAAiB,SAAS7pD,GACtB,IAAI4wD,EAAoB,CACpBC,UAAWl5E,KAAKwN,UAAUlN,QAAQuhB,IAClCs3D,YAAan5E,KAAKwN,UAAUlN,QAAQkrE,OAGpCnjD,EAAE/nB,QACFkB,EAAEpB,QAAO,EAAMioB,EAAE/nB,QAAS24E,GAE1B5wD,EAAE/nB,QAAU24E,EAGhBj5E,KAAK+pB,KAAKxI,WAAW8G,EAAEnc,KAAMmc,EAAE/nB,QACnC,EAEAywE,kBAAmB,WACf,IAAIhiE,EACAtB,EAAWzN,KAAKwN,UAChBwB,EAAQvB,EAASiL,cACjBxM,EAAOlM,KAAK+pB,KAAK+mD,WAAW5uE,QAMhC,IADA6M,EAAM9O,EAAMsN,YAAYkH,KAAKusC,eAAe90C,GAAM,IAASuB,EAAS8hC,UAAUrjC,cAC3DjM,EAAMsN,YAAYkwB,IAArC,CACI,GAAI1uB,EAAIC,OAASD,EAAIC,MAAM1I,eAAiB0I,EAAM9C,OAAO5F,cAAe,CAEpE,IAAI6G,EAAMM,EAASwyC,YAAYlxC,EAAIC,OAC/B7B,IACAM,EAASiL,YAAYvL,GACrB6B,EAAQ7B,EAEhB,CACA6B,EAAMnB,MAAMkB,GAAKf,QAErB,MAEAe,EAAMC,EAAM2J,YAAY9J,KAAKY,QAAQ4d,WAAWG,SAASxe,EAAM9C,QAAQ,GAOvElM,KAAKwyE,SAAS,CACV5xE,QAAS,oBACTN,QAAS,CAAE4L,KAAMA,EAAMhK,MAAO6M,KAGlC/O,KAAKswE,iBAAiBpvE,QAAQ,QAClC,EACA8vE,mBAAoB,WAChBhxE,KAAKswE,iBAAiBpvE,QAAQ,QAClC,EACA+vE,mBAAoB,SAAS5nD,GACzB,IAAInd,EAAOmd,EAAGnd,KACVuB,EAAWzN,KAAKwN,UAChBwB,EAAQvB,EAASiL,cACjB3J,EAAMtB,EAAS8hC,UAAUrjC,GAC7B,GAAI6C,aAAe9O,EAAMsN,YAAYkwB,IAArC,CACI,GAAI1uB,EAAIC,OAASD,EAAIC,MAAM1I,eAAiB0I,EAAM9C,OAAO5F,cAAe,CAEpE,IAAI6G,EAAMM,EAASwyC,YAAYlxC,EAAIC,OAC/B7B,IACAM,EAASiL,YAAYvL,GACrB6B,EAAQ7B,EAEhB,CACA6B,EAAMnB,MAAMkB,GAAKf,QAErB,MACAhO,KAAKswE,iBAAiBpvE,QAAQ,QAClC,EACAgwE,mBAAoB,SAAS7nD,GACzBrpB,KAAKwyE,SAAS,CACV5xE,QAAS,oBACTN,QAAS,CAAE4L,KAAMmd,EAAGnd,QAExBlM,KAAKswE,iBAAiBpvE,QAAQ,QAClC,IAGJjB,EAAMsN,YAAY8iE,WAAaA,CAClC,CA1xCD,CA0xCG5uE,OAAOxB,OAEV,SAAUA,GAEN,IAAIuB,EAAIvB,EAAMwF,OACVk4B,EAAU19B,EAAMsN,YAAYowB,QAC5B6pB,EAAM,IAIN4xB,EAAiB,CACjBrvD,KAAM,qBACNsvD,eAAgB,gCAChBC,cAAe,+BACf3I,SAAU,yBACV4I,SAAU,0BACVnhE,UAAW,0BACXohE,WAAY,4BACZC,UAAW,uBACXC,UAAW,2BACXC,qBAAsB,mBACtBC,YAAa,iBACbC,aAAc,uBACdC,qBAAsB,aACtBC,iBAAkB,sBAClBC,eAAgB,oBAChBr3D,KAAM,SACNs3D,kBAAmB,iBACnBC,UAAW,2BACXvxB,gBAAiB,kCACjB6C,kBAAmB,oCACnB+kB,gBAAiB,kCACjBC,qBAAsB,wCACtBC,qBAAsB,wCACtBC,mBAAoB,sCAiExB,SAASyJ,EAAWj4E,GAChB,OAAQA,EAAMN,MAAQ,GAAK,aAAeM,EAAM0T,OAAS,OAC7D,CAEA,SAASwkE,EAAM5nE,GAIX,MAHK,QAAQvK,KAAKuK,KACdA,EAAO,UAAYA,GAEhBA,CACX,CAEA,SAAS6nE,EAASC,EAAYxmE,EAAM+a,EAAK0rD,GACrC,SAASC,EAAU1zD,GACf,IAAItU,EAAOsB,EAAKtB,KAMhB,GALKA,GACwB,iBAAdsB,EAAK5R,QACZsQ,EAAOsB,EAAK5R,MAAMsQ,MAGtBA,EAAM,CACN,IAAI1O,EAAQ,CACR22E,eAAgB,QAQpB,OANI3mE,EAAK8B,QACL9R,EAAM8R,MAAQ9B,EAAK8B,OAEnB9B,EAAKnB,YACL7O,EAAM22E,eAAiB,aAEpBx6E,EAAM6nD,IAAI1pC,QAAQ,IAAK,CAC1Bs8D,KAASN,EAAM5nE,GACf1O,MAASA,EACTkO,OAAS,UACV8U,EAAK,CAAEA,GAAO,GACrB,CACA,OAAOA,CACX,CAEA,IAAI6zD,EAA4B,MAAd7mE,EAAK5R,OAAqC,MAAnB4R,EAAKkN,aAAuBlN,EAAKkN,WAAW9e,OACnE4R,EAAK80B,YAAc90B,EAAKsvB,QAAUtvB,EAAKgvC,SAAWhvC,EAAK8mE,SACzE,GAAK/rD,GAAQ8rD,EAAb,CAIA,IAAI72E,EAAQ,CAAE8kC,WAAY,IACtBA,EAAa90B,EAAK80B,WACtB,GAAIA,EAAY,CACZ,IAAIiyC,EAAgBjyC,EAChB2xC,KAEAM,EAAgB56E,EAAMulD,WAAWq1B,GAAeC,SAClCt0E,GAAK,GACnBq0E,EAAgBA,EAActU,aAElCsU,EAAgBV,EAAW,CAAEvkE,MAAOilE,IACpC/2E,EAAMi3E,QAAUF,CACpB,CAEI/mE,EAAK8mE,WACoB,EAArB9mE,EAAK8mE,SAASlsE,MACd5K,EAAM8kC,WAAWjoC,KAAK,iFACAmT,EAAK8mE,SAASh5E,KAAO,QAAUkS,EAAK8mE,SAAShlE,MAAQ,qCACrD9B,EAAK8mE,SAASh5E,KAAO,+BAEtB,EAArBkS,EAAK8mE,SAASlsE,MACd5K,EAAM8kC,WAAWjoC,KAAK,kFACAmT,EAAK8mE,SAASh5E,KAAO,QAAUkS,EAAK8mE,SAAShlE,MAAQ,qCACrD9B,EAAK8mE,SAASh5E,KAAO,gCAI/CgnC,GACA9kC,EAAM8kC,WAAWjoC,KAAKioC,GAGtB90B,EAAK8B,QACL9R,EAAM8R,MAAQ9B,EAAK8B,OAGnB9B,EAAKm5B,aACLnpC,EAAMmpC,WAAan5B,EAAKm5B,YAGxBn5B,EAAKnB,YACL7O,EAAM22E,eAAiB,aAGvB3mE,EAAKk1B,SACLllC,EAAMk3E,UAAY,UAGlBlnE,EAAK+0B,YACL/kC,EAAM+kC,UAAY/0B,EAAK+0B,WAGvB/0B,EAAKm1B,OACLnlC,EAAMm3E,WAAa,QAGnBnnE,EAAK60B,WACL7kC,EAAM6kC,SAAW70B,EAAK60B,SAAW,OAGnB,IAAd70B,EAAKS,MACLzQ,EAAMkoB,WAAa,WACnBloB,EAAMo3E,aAAe,aACrBp3E,EAAMq3E,SAAW,eAEjBr3E,EAAMkoB,WAAa,MACnBloB,EAAMo3E,aAAe,SACrBp3E,EAAMq3E,SAAW,UAGrBr3E,EAAM2b,KAAQ3L,EAAK2L,KAAO,EAAK,KAC/B3b,EAAMic,IAAOjM,EAAKiM,IAAM,EAAK,KAC7Bjc,EAAMK,MAAS2P,EAAK3P,MAAQ,EAAK,KACjCL,EAAMM,OAAU0P,EAAK1P,OAAS,EAAK,KAEnC,IAAIoG,EAAOsJ,EAAK5R,MAAOwM,SAAclE,EAAM8K,EAASxB,EAAKwB,OAiBzD,GAhBKA,GAAkB,UAAR5G,GAAoBlE,GAAQiG,KAAKgnB,MAAMjtB,KAClD8K,EAAS,oBAETA,GAAkB,MAAR9K,GACVA,EAAOvK,EAAMsN,YAAY2H,WAAWI,OAAO9K,EAAM8K,IACxC8lE,aACL1sE,EAAOlE,EAAK4wE,YAED,MAAR5wE,IAEHA,EADAsJ,EAAKqa,KACEluB,EAAM6nD,IAAI35B,KAAK3jB,GAEfvK,EAAM6nD,IAAIllD,KAAK4H,KAIzB1G,EAAM+kC,UACP,OAAQn6B,GACN,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,WACH5K,EAAM+kC,UAAY,QAClB,MACF,IAAK,UACH/kC,EAAM+kC,UAAY,SAM1B5oC,EAAMsN,YAAY+/B,KAAK+tC,YAAYvnE,EAAMhQ,GAEzC,IAAI2e,EAAa,CAAE64D,EAAexnE,MAE9B+a,GACApM,EAAW9hB,KAAKkuB,IAEA,IAAhB/a,EAAKZ,QACLuP,EAAW9hB,KAAK,cAEhBmT,EAAKsvB,SACL3gB,EAAW9hB,KAAK,6BACXmT,EAAKZ,QACNonE,EAAW35E,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACrC0nB,UAAW,8BACXhiC,MAAO,CACH2b,KAAO3L,EAAK2L,KAAO,EAAK,KACxBM,IAAMjM,EAAKiM,IAAM,EAAK,KACtB5b,MAAQ2P,EAAK3P,MAAQ,EAAK,KAC1BC,OAAS0P,EAAK1P,OAAS,EAAK,UAKxC0P,EAAKgvC,SACLrgC,EAAW9hB,KAAK,6BAGpB,IAAImoC,EAAgBh1B,EAAKg1B,eAAiB,SAGtCt+B,EADAs+B,GAAiBt+B,EACVvK,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAAE0nB,UAAW,oBAAsBgD,GAAiB,CAAE0xC,EAAUhwE,KAEzFgwE,EAAUhwE,GAGjB1G,EAAM8kC,WAAWvnC,OACjByC,EAAM8kC,WAAa9kC,EAAM8kC,WAAWzlC,KAAK,YAElCW,EAAM8kC,WAGjB,IAAI4jB,EAAWhiD,EAAO,CAAEA,GAAS,GAC7BsrB,EAAa,CACbhyB,MAAOA,GAEPkd,EAAalN,EAAKkN,WAClBA,IAAeA,EAAW9e,QAC1BsqD,EAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,OAAQ,CAAE0nB,UAAW,aACrDrjB,EAAW9hB,KAAK,gBAEhBm1B,EAAWvnB,MAAQyS,EAAWxS,SAElCsnB,EAAWgQ,UAAYrjB,EAAWtf,KAAK,KAEvC,IAAI4hB,EAAM9kB,EAAM6nD,IAAI1pC,QAAQ,MAAO0X,EAAY02B,GAE/C,OADA8tB,EAAW35E,KAAKokB,GACTA,CArKP,CAsKJ,CA9QA9kB,EAAMsN,YAAY0V,SAAS8G,KAAO,CAC9BwxD,QAAS,WACTz4D,aAAc,gBACdzB,OAAQ,CACJm6D,gBAAiB,mDACjBC,sBAAuB,sIACvBC,8BAA+B,sDAC/BC,8BAA+B,gDAC/BC,4BAA6B,0DAC7BC,0BAA2B,wCAC3BC,0BAA2B,iCAC3BC,gBAAiB,8BACjBC,mBAAoB,qDACpBC,gBAAiB,4EACjBC,qBAAsB,gCACtBC,sBAAuB,wCACvBC,sBAAuB,yDAE3BC,KAAM,CACFt1D,KAAM,OACN+K,OAAQ,SACRtnB,KAAM,SAIdvK,EAAMsN,YAAY0V,SAASq5D,MAAQ,CAC/BtgE,IAAiB,MACjBC,KAAiB,OACjBV,MAAiB,QACjBjE,MAAiB,QACjBF,QAAiB,UACjBy3D,OAAiB,SACjBniD,KAAiB,OACjB6yB,OAAiB,SACjBg9B,aAAiB,iBACjBC,WAAiB,gBA8WrB,IAAIC,EAAYx8E,EAAM0B,MAAMvB,OAAO,CAC/BC,KAAM,WACFL,KAAKia,KAAO,GACZja,KAAK08E,IAAM,GACX18E,KAAKuQ,QAAU,EACfvQ,KAAKsQ,OAAS,CAClB,EAEAqsE,UAAW,SAASx4E,GAChBnE,KAAKsQ,QAAUnM,EAEf,IAAIkR,EAAMpV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAAEta,MAAO,CAAEK,MAAOA,EAAQ,QAE7DkR,EAAI2U,QAAU7lB,EAAQ,EAEtBnE,KAAKia,KAAKtZ,KAAK0U,EACnB,EAEAunE,OAAQ,SAASx4E,GACb,IAAIqf,EAEJA,EAAO,CAAE3f,MAAO,CAAEM,OAAQA,EAAS,OAEnCpE,KAAKuQ,SAAWnM,EAEhB,IAAI64B,EAAKh9B,EAAM6nD,IAAI1pC,QAAQ,KAAMqF,GAEjCwZ,EAAGjT,QAAU5lB,EAAS,EAEtBpE,KAAK08E,IAAI/7E,KAAKs8B,EAClB,EAEA4/C,QAAS,SAASzhE,EAAUxY,EAAMuJ,EAAO25B,EAAW9kB,GAC5Cpe,UACAA,EAAO,IAELA,aAAgB3C,EAAM6nD,IAAIg1B,OAC5Bl6E,EAAO3C,EAAM6nD,IAAIllD,KAAKA,IAG1B,IAAI4pD,EAAW,CAAE5pD,GAEboe,IAAeA,EAAW9e,QAC1BsqD,EAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,OAAQ,CAAE0nB,UAAW,aAErDA,GAAaA,GAAa,KAAOA,EAAY,IAAM,IAAM,eACzD35B,EAAMoC,MAAQyS,EAAWxS,SAGzBs3B,IACA35B,EAAM25B,UAAYA,GAEtB,IAAI0B,EAAKvnC,EAAM6nD,IAAI1pC,QAAQ,KAAMjS,EAAOqgD,GAGxC,OADAxsD,KAAK08E,IAAIthE,GAAUoxC,SAAS7rD,KAAK6mC,GAC1BA,CACX,EAEAu1C,UAAW,SAASt2E,EAAGqqB,EAAGgV,GACtB9lC,KAAK08E,IAAM18E,KAAK08E,IAAIv/D,QAAO,SAAS8f,GAChC,OAAOA,EAAGjT,OACd,IAEA,IAAIgzD,EAAS,EAYb,OAXAh9E,KAAKia,KAAOja,KAAKia,KAAKkD,QAAO,SAAS9H,EAAKyxB,GAQvC,OAPKzxB,EAAI2U,UACLhqB,KAAK08E,IAAI5tE,SAAQ,SAASmuB,GACtBA,EAAGuvB,SAASh7C,OAAOs1B,EAAKk2C,EAAQ,EACpC,IACAA,KAGG3nE,EAAI2U,OACf,GAAGhqB,MAEIC,EAAM6nD,IAAI1pC,QAAQ,QAAS,CAC9Bta,MAAO,CAAE2b,KAAMhZ,EAAI,KAAMsZ,IAAK+Q,EAAI,KAAM1sB,OAAQpE,KAAKuQ,QAAU,KAAMpM,MAAOnE,KAAKsQ,OAAS,MAC1Fw1B,UAAWA,EACXle,KAAM,gBACR,CACE3nB,EAAM6nD,IAAI1pC,QAAQ,WAAY,KAAMpe,KAAKia,MACzCha,EAAM6nD,IAAI1pC,QAAQ,QAAS,KAAMpe,KAAK08E,MAE9C,IA2CJz8E,EAAMsN,YAAY0vE,YAAch9E,EAAMqiB,GAAG26D,YAMzC,SAASC,EAAOh7E,EAAOwO,EAAKkK,GACxB,OAAO1Y,GAASwO,GAAOxO,GAAS0Y,CACpC,CAEA,IAAIuiE,EAAOl9E,EAAM0B,MAAMvB,OAAO,CAC1BC,KAAM,SAAS+d,EAAS9d,GACpB,IAAImiB,EAAa06D,EAAK16D,WAEtBziB,KAAKoe,QAAUA,EAEfpe,KAAKM,QAAUkB,EAAEpB,QAAO,EAAM,CAC1B6iB,SAAUhjB,EAAMsN,YAAY0V,SAAS8G,MACtC/pB,KAAKM,QAASA,GAEjBN,KAAKo9E,UAELp9E,KAAKq9E,SAAW,GAEhBj/D,EAAQk/D,OAAOr9E,EAAMmoB,SAtBT,qnDAsBGnoB,CAA8B,CACzCwiB,WAAYA,EACZQ,SAAUhjB,EAAMsN,YAAY0V,SAASq5D,SAGzCt8E,KAAKu9E,gBAELv9E,KAAK0iB,QAAetE,EAAQwkB,KAAK4kB,EAAM/kC,EAAWsH,MAClD/pB,KAAK2sD,UAAevuC,EAAQwkB,KAAK4kB,EAAM/kC,EAAW42D,gBAAgB,GAClEr5E,KAAK2wE,SAAevyD,EAAQwkB,KAAK4kB,EAAM/kC,EAAWkuD,UAAU,GAC5D3wE,KAAKoY,UAAegG,EAAQwkB,KAAK4kB,EAAM/kC,EAAWrK,WAElDpY,KAAKu5E,SAAW/3E,EAAExB,KAAK2wE,SAAS7qD,YAEhC9lB,KAAKyyB,KAAO,IAAIxyB,EAAM6nD,IAAIC,KAAK/nD,KAAK2sD,WACpC3sD,KAAKw9E,kBAAoB,IAAIv9E,EAAM6nD,IAAIC,KAAK/nD,KAAKoY,UAAU,IAE3DpY,KAAKmxE,OAAS,IAAIlxE,EAAMsN,YAAYkwE,YAAYz9E,MAEhDA,KAAK09E,aAEL,IAAIC,EAAoB,CACpB3rE,OAAQoM,EACRwuC,WAAW,EACXgxB,OAAQ,SAGZ59E,KAAKuwE,gBAAkB,IAAItwE,EAAMsN,YAAY0vE,YAAY7+D,EAAQwkB,KAAK4kB,EAAM/kC,EAAW8tD,iBAAkBoN,GAEzG39E,KAAKywE,qBAAuB,IAAIxwE,EAAMsN,YAAY0vE,YAAY7+D,EAAQwkB,KAAK4kB,EAAM/kC,EAAWguD,sBAAuBkN,GAEnH39E,KAAKwwE,qBAAuB,IAAIvwE,EAAMsN,YAAY0vE,YAAY7+D,EAAQwkB,KAAK4kB,EAAM/kC,EAAW+tD,sBAAuBmN,GAEnH39E,KAAK0wE,mBAAqB,IAAIzwE,EAAMsN,YAAY0vE,YAAY7+D,EAAQwkB,KAAK4kB,EAAM/kC,EAAWiuD,oBAAqBiN,EACnH,EAEAE,gBAAiB,SAAS3qE,GACtBlT,KAAK89E,wBAA0B5qE,EAE3BA,EACAlT,KAAKoY,UAAUqL,KAAK,kBAAmBvQ,GAEvClT,KAAKoY,UAAUwM,WAAW,kBAElC,EAEAsR,QAAS,WACL,IAAI6nD,EAAYv8E,EAAExB,KAAKg+E,WAAW5/D,SAAS6/D,QAAQ,6BAC/C7vD,EAAcnuB,EAAMi+E,aACpBC,EAAiBn+E,KAAK4wE,SAAWxiD,EAAYpuB,KAAK4wE,SAASxyD,SAAW,EACtEggE,EAAmBL,EAAY3vD,EAAY2vD,GAAa,EACxDM,EAAkBr+E,KAAK6wE,UAAYziD,EAAYpuB,KAAK6wE,UAAUzyD,SAAW,EAE7Epe,KAAK0iB,QAAQte,OACTpE,KAAKoe,QAAQha,UACR+5E,EAAiBC,EAAmBC,IAGzCr+E,KAAK4wE,UACL5wE,KAAK4wE,SAAS0N,mBAEtB,EAEAlB,QAAS,WACL,IAAI16D,EAAUlhB,EAAE,4CAA4CohB,UAAU5iB,KAAKoe,SAEvE0yD,EAAatvE,EAAE,6CAA6CwhB,SAASN,GACzE1iB,KAAK8wE,WAAa,IAAI7wE,EAAMsN,YAAYgxE,WAAWzN,EAAY9wE,KAAKM,SAEpE,IAAI09E,EAAax8E,EAAE,WAAWwhB,SAASN,GACvC1iB,KAAKg+E,WAAa,IAAI/9E,EAAMsN,YAAY8U,WAAW27D,EAAYh+E,KAAKM,SAEhEN,KAAKM,QAAQk+E,SACbx+E,KAAKy+E,WAEb,EAEAlB,cAAe,WACX,IAAIpM,EAASnxE,KAAKoe,QAAQwkB,KAAK4kB,EAAM21B,EAAK16D,WAAW+2D,YAErDx5E,KAAK8iB,aAAe,IAAI7iB,EAAMsN,YAAYwV,aAAaouD,EAAQ,CAC3DxtD,WAAW,GAEnB,EAEA+5D,WAAY,WACR,GAAI19E,KAAKM,QAAQuwE,UAAW,CACxB,IAAIvwE,EAAUkB,EAAEpB,QAAO,EAAM,CACzBmhB,WAAYvhB,KAAKuhB,WAAWrS,KAAKlP,OAClCA,KAAKM,QAAQuwE,WAEhB7wE,KAAK6wE,UAAY,IAAI5wE,EAAMsN,YAAYm6C,UAAU1nD,KAAKoe,QAAQwkB,KAAK4kB,EAAM21B,EAAK16D,WAAWy3D,WAAY55E,EACzG,CACJ,EAEAm+E,UAAW,WACP,IAAIx7D,EAAWjjB,KAAKM,QAAQ2iB,SAASo5D,KACjC/7E,EAAUkB,EAAEpB,QAAO,EAAM,CAAE2mB,MAAM,EAAM+K,QAAQ,EAAMtnB,MAAM,GAAQxK,KAAKM,QAAQk+E,SAChFnC,EAAO,GAOX,IAAK,IAAInwE,KALLlM,KAAK4wE,WACL5wE,KAAK4wE,SAAS1tD,UACdljB,KAAKoe,QAAQouC,SAAS,eAAex6B,UAGxB1xB,IACS,IAAlBA,EAAQ4L,IAAkB5L,EAAQ4L,aAAiB4uB,QACnDuhD,EAAK17E,KAAK,CAAEgH,GAAIuE,EAAMtJ,KAAMqgB,EAAS/W,GAAOwyE,QAAS,KAI7D1+E,KAAK4wE,SAAW,IAAI3wE,EAAMsN,YAAYoxE,SAASn9E,EAAE,WAAWohB,UAAU5iB,KAAKoe,SAAU,CACjFwuC,WAAW,EACXgyB,cAAe,OACfC,iBAAkB,UAClB32D,WAAYm0D,EACZyC,eAAgBx+E,EAChBypB,KAAM/pB,OAGVA,KAAK4wE,SAAS5iE,OAAO,EACzB,EAEA+wE,gBAAiB,SAAS12D,GACtBroB,KAAKqP,OAAOnO,QAAQ,iBAAkBmnB,EAC1C,EAEA5a,SAAU,SAASA,GACfzN,KAAKwN,UAAYC,EACjBA,EAAS+N,MAAQxb,KACjBA,KAAK8wE,WAAWtjE,UAAYC,CAChC,EAEAuB,MAAO,SAASA,GACZhP,KAAKqP,OAASL,CAClB,EAEAypE,oBAAqB,WACjB,OAAOz4E,KAAKg/E,cAAch/E,KAAKqP,OAAO61C,kBAC1C,EAEA+5B,WAAY,SAASriC,EAAM7tC,GACvB,OAAO6tC,EAAK9e,MAAMohD,kBAAkBnwE,EAAIE,aAC5C,EAEAkwE,gBAAiB,SAAS14E,EAAGm2C,EAAMvnC,GAa/B,OAXA5O,GAAKzG,KAAKqP,OAAOyuB,MAAMshD,aAGlBxiC,EAAK9e,MAAM9lB,QAAQqnE,SACpB54E,GAAKzG,KAAK2wE,SAASpmB,YAOR,QAJfl1C,EAAMrV,KAAKqP,OAAOyuB,MAAMpjB,SAAS4kE,OAAO,EAAGjqE,GAAK,SAASkqE,GACrD,OAAO9uE,KAAK0pB,IAAI1zB,EAAI84E,IAAMC,GAC9B,MAEwBx/E,KAAKqP,OAAO6zB,eAAe7tB,GAAa,KAANA,CAC9D,EAEAoqE,aAAc,SAAS3uD,EAAG8rB,EAAMlpC,GAa5B,OAXAod,GAAK9wB,KAAKqP,OAAOyuB,MAAM4hD,cAGlB9iC,EAAK9e,MAAM/lB,KAAKsnE,SACjBvuD,GAAK9wB,KAAK2wE,SAASuF,WAOR,QAJfxiE,EAAM1T,KAAKqP,OAAOyuB,MAAMtjB,MAAM8kE,OAAO,EAAG5rE,GAAK,SAASs8B,GAClD,OAAOv/B,KAAK0pB,IAAIrJ,EAAIkf,IAAMwvC,GAC9B,MAEwBx/E,KAAKqP,OAAO4zB,YAAYvvB,GAAa,KAANA,CAC3D,EAEAisE,aAAc,SAASl5E,EAAGqqB,EAAG8rB,EAAM7tC,GAC/B,IAAIlP,EAAOG,KACP4/E,EAAUhjC,EAAK9e,MACfo4C,EAAY0J,EAAQ7nE,KAAKsnE,OAAS,EAAIx/E,EAAK8wE,SAASuF,UACpD3rB,EAAaq1B,EAAQ5nE,QAAQqnE,OAAS,EAAIx/E,EAAK8wE,SAASpmB,WAK5D,OAHA9jD,GAAK5G,EAAKwP,OAAOyuB,MAAMshD,aAAe70B,EACtCz5B,GAAKjxB,EAAKwP,OAAOyuB,MAAM4hD,cAAgBxJ,EAEhCj2E,EAAMsB,KAAK2G,UAAS,SAAS6C,GAChClL,EAAKwP,OAAO6xC,oBAAoBnyC,GAAK,SAASA,GAC1C,IAAIypE,EAAO34E,EAAKo/E,WAAWriC,EAAM7tC,GAC7B6tC,EAAKijC,eAAerH,GAAMrmD,WAAW1rB,EAAGqqB,IACxC/lB,GAAK,EAEb,GACJ,GACJ,EAEA+0E,WAAY,SAASr5E,EAAGqqB,EAAG8rB,GACvB,IAAIjkC,EAAY3Y,KAAKqP,OAAOrB,SAE5B,GAAI2K,EAAU/W,KAAO,EACjB,OAAO,EAGX6E,GAAKzG,KAAKqP,OAAOyuB,MAAMshD,aACvBtuD,GAAK9wB,KAAKqP,OAAOyuB,MAAM4hD,cAElB9iC,EAAK9e,MAAM9lB,QAAQqnE,SACpB54E,GAAKzG,KAAK2wE,SAASpmB,YAGlB3N,EAAK9e,MAAM/lB,KAAKsnE,SACjBvuD,GAAK9wB,KAAK2wE,SAASuF,WAGvB,IAAIvpD,EAAY3sB,KAAKi/E,WAAWriC,EAAMjkC,GAEtC,OAAOlI,KAAK0pB,IAAIxN,EAAUhN,MAAQlZ,GAAK,GAAKgK,KAAK0pB,IAAIxN,EAAU3M,OAAS8Q,GAAK,CACjF,EAEAivD,aAAc,SAASt5E,EAAGqqB,EAAG8rB,GAEzB,GADS58C,KAAKqP,OAAO2wE,yBACb,CACJ,IAAI35E,EAAIrG,KAAKy4E,sBAGb,GAAI3nD,GAAKzqB,EAAE0Z,KAAO+Q,GAAKzqB,EAAE2Z,OAErB,OADAhgB,KAAKigF,oBAAsBrjC,EAAKqjC,oBACzBrjC,EAAKqjC,oBAAsBx5E,EAAIJ,EAAEoZ,MAAQhZ,GAAKJ,EAAEoZ,KAvyB/C,GAwyBFhZ,EAAIJ,EAAEsZ,OAASlZ,GAAKJ,EAAEsZ,MAxyBpB,EA0yBhB,CACJ,EAEAugE,UAAW,SAASz5E,EAAGqqB,EAAG8rB,GACtBn2C,GAAKzG,KAAKqP,OAAOyuB,MAAMshD,aACvBtuD,GAAK9wB,KAAKqP,OAAOyuB,MAAM4hD,cAElB9iC,EAAK9e,MAAM9lB,QAAQqnE,SACpB54E,GAAKzG,KAAK2wE,SAASpmB,YAGlB3N,EAAK9e,MAAM/lB,KAAKsnE,SACjBvuD,GAAK9wB,KAAK2wE,SAASuF,WAKvB,IAFA,IAAIlnE,EAAQhP,KAAKqP,OACbsC,EAAW3R,KAAKqP,OAAOiC,UAClB/N,EAAIoO,EAAStQ,SAAUkC,GAAK,GAAI,CACrC,IAAIqD,EAAI+K,EAASpO,GACbkB,EAAMuK,EAAMy0C,mBAAmB78C,GACnC,GAAInC,EAAI0tB,WAAW1rB,EAAGqqB,GAClB,MAAO,CACHvhB,QAAS3I,EAKTu5E,IAAK17E,EAAIgb,KAAOhZ,EAChB25E,IAAK37E,EAAIsb,IAAM+Q,EAG3B,CACJ,EAEAujD,SAAU,SAAS5tE,EAAGqqB,EAAGymD,GACrB,IACIv0E,EAAQ45C,EADR/e,EAAO79B,KAAKqP,OAAOyuB,MAGvB,GAAIr3B,EAAI,GAAKqqB,EAAI,GAAKrqB,EAAIzG,KAAK2wE,SAAS0P,aAAevvD,EAAI9wB,KAAK2wE,SAASsC,aACrEjwE,EAAS,CAAE0L,KAAM,gBACd,GAAIjI,EAAIo3B,EAAKuhD,cAAgBtuD,EAAI+M,EAAK6hD,cACzC18E,EAAS,CAAE0L,KAAM,kBAIjB,GAFAkuC,EAAO58C,KAAKsgF,OAAO75E,EAAGqqB,GAIf,CACH,IAAKymD,EAAW,CACZ,IAAIhoE,EAAUvP,KAAKkgF,UAAUz5E,EAAGqqB,EAAG8rB,GACnC,GAAIrtC,EACA,MAAO,CACHb,KAAM,UACNa,QAASA,EAAQA,QACjB4wE,IAAK5wE,EAAQ4wE,IACbC,IAAK7wE,EAAQ6wE,IACbxjC,KAAMA,EACNs4B,OAAQzuE,EACR0uE,OAAQrkD,EAGpB,CAEA,IAAIpd,EAAMkpC,EAAK9e,MAAM/lB,KAAK2rC,aAAa5yB,EAAG9wB,KAAK2wE,SAASuF,WACpD54D,EAASs/B,EAAK9e,MAAM9lB,QAAQ0rC,aAAaj9C,EAAGzG,KAAK2wE,SAASpmB,YAE1D77C,EAAO,OACPK,EAAM,IAAI4uB,EAAQjqB,EAAK4J,GACvBijE,EAAYvgF,KAAKqP,OAAO20C,sBAExBhkD,KAAK8/E,WAAWr5E,EAAGqqB,EAAG8rB,GACtBluC,EAAO,WACA1O,KAAK2/E,aAAal5E,EAAGqqB,EAAG8rB,EAAM7tC,GACrCL,EAAO,cACC6xE,GAAa95E,EAAIo3B,EAAKuhD,cAC9B1wE,EAAO,YACyC,QAA3CgF,EAAM1T,KAAKy/E,aAAa3uD,EAAG8rB,EAAMlpC,MAClC3E,EAAM,IAAI4uB,EAAQjqB,GAAMgM,KACxBhR,EAAO,qBAEH6xE,GAAazvD,EAAI+M,EAAK6hD,eAC9BhxE,EAAO,eACkD,QAApD4O,EAAStd,KAAKm/E,gBAAgB14E,EAAGm2C,EAAMt/B,MACxCvO,EAAM,IAAI4uB,GAASje,IAAUpC,GAC7B5O,EAAO,uBAEJ1O,KAAK+/E,aAAat5E,EAAGqqB,EAAG8rB,KAC/BluC,EAAO,UAGX1L,EAAS,CAAE0L,KAAMA,EAAMK,IAAKA,EAChC,MA7CI/L,EAAS,CAAE0L,KAAM,WAmDzB,OAHA1L,EAAO45C,KAAOA,EACd55C,EAAOyD,EAAIA,EACXzD,EAAO8tB,EAAIA,EACJ9tB,CACX,EAEAs9E,OAAQ,SAAS75E,EAAGqqB,GAChB,OAAO9wB,KAAK4X,MAAMuF,QAAO,SAA4By/B,GACjD,IAAI/e,EAAO+e,EAAK9e,MAChB,OAAOo/C,EAAOpsD,EAAG+M,EAAK9d,IAAK8d,EAAK7d,SAAWk9D,EAAOz2E,EAAGo3B,EAAKpe,KAAMoe,EAAKle,MACzE,IAAG,EACP,EAEA6gE,eAAgB,SAAS1sE,GACrB,OAAO9T,KAAK4X,MAAMuF,QAAO,SAASy/B,GAC9B,QAAIA,EAAK9e,MAAMjD,SAAS/mB,EAI5B,IAAG,EACP,EAEAkrE,cAAe,SAASlrE,GACpB,IAAI8rE,EAAU5/E,KAAKwgF,eAAe1sE,GAAMgqB,MAGxC,OAFgB99B,KAAKqP,OAAOyuB,MAAMnR,UAAU7Y,GAE3BkpE,OACb4C,EAAQ3iC,aAAe2iC,EAAQ5nE,QAAQqnE,OAAS,EAAIr/E,KAAK2wE,SAASpmB,YAClEq1B,EAAQ5iC,cAAgB4iC,EAAQ7nE,KAAKsnE,OAAS,EAAIr/E,KAAK2wE,SAASuF,WAExE,EAEAlM,QAAS,SAASv7D,GACd,IAAIO,EAAQhP,KAAKqP,OAgBjB,GAdIrP,KAAK4wE,UACL5wE,KAAK4wE,SAAS6P,aAAazxE,EAAMnB,MAAMmB,EAAMmI,cAAe1I,GAG5DA,EAAO27D,gBAAkBpqE,KAAK6wE,WAC9B7wE,KAAK6wE,UAAUnnB,aAAa1pD,KAAKwN,UAAUm8C,SAAU3pD,KAAKwN,UAAUogD,WAAW5tD,KAAKqP,SAGxFrP,KAAKk2B,UAGLl2B,KAAKu5E,SAAS,GAAGz1E,MAAMM,OAAS4K,EAAM8uB,MAAM4iD,cAAgB,KAC5D1gF,KAAKu5E,SAAS,GAAGz1E,MAAMK,MAAQ6K,EAAM8uB,MAAM6iD,aAAe,KAEtDlyE,EAAOsB,OAAQ,CACf,IAAI8H,EAAgB7I,EAAM6I,gBACtBC,EAAa9I,EAAM8I,aAGvB9X,KAAK4X,MAAQ,CAAE5X,KAAK4gF,MAAM9oE,EAAYD,IAGlCA,EAAgB,GAChB7X,KAAK4X,MAAMjX,KAAKX,KAAK4gF,MAAM9oE,EAAY,EAAG,KAAMD,IAIhDC,EAAa,GACb9X,KAAK4X,MAAMjX,KAAKX,KAAK4gF,MAAM,EAAG/oE,EAAeC,EAAY,OAIzDA,EAAa,GAAKD,EAAgB,GAClC7X,KAAK4X,MAAMjX,KAAKX,KAAK4gF,MAAM,EAAG,EAAG9oE,EAAYD,GAErD,CAEIpJ,EAAO0O,QACPnd,KAAK6gF,qBAGLpyE,EAAO0I,aACPnX,KAAKukB,OAASvV,EAAMmI,aAAalI,aAEzC,EAEAkpE,iBAAkB,SAAS76D,GACvBtd,KAAK6gF,qBAEL,IAAI7xE,EAAQhP,KAAKqP,OACbN,EAAMC,EAAMmO,SAASpO,IACrBlB,EAAQ,IAAI5N,EAAMsN,YAAYuP,MAAM/N,EAAKC,GACzCoP,EAAU5c,EAAE,WAAWwhB,SAAShjB,KAAKoe,SACrC9d,EAAU,CAAEgd,OAAQA,EAAQzP,MAAOA,GACnCqqE,EAAa,IAAIj4E,EAAMsN,YAAYuzE,WAAW1iE,EAAS9d,GAI3D,OAFAN,KAAK+gF,YAAc7I,EAEZA,CACX,EAEA8I,wBAAyB,WAChBhhF,KAAK89E,yBACN99E,KAAKoY,UAAUqD,QAv6B3B,SAA+BqL,GAC3B,IAAI9B,EAAMvjB,OAAOwjB,eACjBD,EAAI2B,kBAEJ,IAAI9Y,EAAQjK,SAASuiB,cACrBtY,EAAMozE,mBAAmBn6D,GAEzB9B,EAAI4B,SAAS/Y,EACjB,CAg6BYqzE,CAAsBlhF,KAAKoY,UAAU,IAE7C,EAEA+oE,eAAgB,SAASrtE,GACrB,IAAIstE,GAAa,EACbxB,EAAU5/E,KAAKwgF,eAAe1sE,GAAMgqB,MAEpC85C,EAAagI,EAAQyB,iBAAiBvtE,GAEtC68D,EAAW3wE,KAAK2wE,SAChBuF,EAAY0J,EAAQ7nE,KAAKsnE,OAAS,EAAI1O,EAASuF,UAC/C3rB,EAAaq1B,EAAQ5nE,QAAQqnE,OAAS,EAAI1O,EAASpmB,WAsBvD,OApBIqtB,EAAW73D,IAAMm2D,IACjBkL,GAAa,EACbzQ,EAASuF,UAAY0B,EAAW1B,WAGhC0B,EAAW53D,OAASk2D,IACpBkL,GAAa,EACbzQ,EAASuF,UAAY0B,EAAW0J,cAGhC1J,EAAWn4D,KAAO8qC,IAClB62B,GAAa,EACbzQ,EAASpmB,WAAaqtB,EAAWrtB,YAGjCqtB,EAAWj4D,MAAQ4qC,IACnB62B,GAAa,EACbzQ,EAASpmB,WAAaqtB,EAAWP,aAG9B+J,CACX,EAEAG,eAAgB,WACZvhF,KAAKq9E,SAAS5wE,KAClB,EAEAooE,iBAAkB,WACd,IAAIh1E,EAAOG,KACP8T,EAAOjU,EAAKwP,OAAO8H,aAAaub,QAChCy+C,EAAStxE,EAAKwP,OAAO2wE,yBACrBnyE,EAAQhO,EAAKwP,OAAOxB,MAAMiG,GAC9Bq9D,EAAOqQ,KAAK,CACR3zE,MAAaA,EACb2qE,KAAa34E,EAAK44E,sBAClB1uD,KAAa/pB,KACbghB,WAAahhB,KAAKqP,OAAO2R,WAAWlN,GACpC2tE,UAAazhF,KAAKigF,oBAClBrxE,SAAa,SAAS1M,EAAOmW,GACzBxY,EAAKk/E,gBAAgB,CACjBn+E,QAAS,cACTN,QAAS,CACLyjD,eAAgBl2C,EAChBwG,UAAWxG,EACXF,SAAU0K,EAAQ,QAAU,QAC5BnW,MAAOA,IAGnB,GAER,EAEAqf,WAAY,SAASrV,EAAM5L,GACvB,IAAIwZ,EAAO9Z,KACPgP,EAAQhP,KAAKqP,OAEjB,OAAOL,EAAMmF,oBAAoB,WAC7B,IAAIutE,EAASzhF,EAAMsN,YAAYo0E,QAAQj6E,OAAOwE,EAAM5L,GAEpD,GAAIohF,EAAQ,CACRA,EAAOxyE,KAAK,SAAU4K,EAAKilE,gBAAgB7vE,KAAK4K,IAChD4nE,EAAOxyE,KAAK,cAAc,KACtBwyE,EAAOx+D,UACPpJ,EAAKynE,gBAAgB,IAEzBznE,EAAKujE,SAAS18E,KAAK+gF,GAEnB,IAAI3yE,EAAMC,EAAMmI,aACZtJ,EAAQ,IAAI5N,EAAMsN,YAAYuP,MAAM/N,EAAKC,GAG7C,OADA0yE,EAAOt4D,KAAKvb,GACL6zE,CACX,CACJ,EAAExyE,KAAKlP,MACX,EAEA4yE,UAAW,SAAStyE,EAASshF,GACzB,IAAIC,EAAiB7hF,KAAKq9E,SACtByE,EAAgB9hF,KAAKM,QAAQ2iB,SAAS5B,OACtC0gE,GAAiB,EASrB,GAPIF,EAAexgF,OAAS,GACxBwgF,EAAe/yE,SAAQ,SAAS4yE,GACxBA,EAAOphF,SA3kCf,UA2kC0BohF,EAAOphF,QAAQiO,QACjCwzE,GAAiB,EAEzB,KAEAA,EAAJ,CAIA,IAAIC,EAAc,SAAS35D,GACvB,IAAIiqC,EAAOjqC,EAAEilC,OAAOo0B,SAAStjE,QAC7Bk0C,EAAK1vB,KAAK,aAAalQ,QAAQxxB,QAAQ,SACvCoxD,EAAK1vB,KAAK,oBAAoBhf,GAAG,WAAW,SAASyF,GAC7CA,EAAGI,SAAWxpB,EAAMmjB,KAAK6+D,KACzB55D,EAAEilC,OAAOtkC,OAEjB,GACJ,EAEIk5D,EAAU,SAAS75D,GACnB,IAAI85D,EAAM95D,EAAEilC,OACZttD,KAAKghF,0BACDmB,EAAIC,QAAUR,GACdA,GAER,EAAE1yE,KAAKlP,MAEP,GAAIC,EAAMsN,YAAYo0E,QAAQU,WAAW/hF,EAAQoO,MAAO,CACpD,IAAI4zE,EAAgB,CAChBt5D,MAAOk5D,GAGU,oBAAjB5hF,EAAQoO,OACR4zE,EAAgB9gF,EAAEpB,OAAOkiF,EAAe,CACpC/zE,MAAOjO,EAAQiO,OAAS,QACxB3L,KAAMtC,EAAQ0E,KAAO1E,EAAQ0E,KAAO88E,EAAcxhF,EAAQoO,MAC1DwI,SAAU8qE,KAIlBhiF,KAAKuhB,WAAWjhB,EAAQoO,KAAM4zE,EAClC,MACItiF,KAAKuhB,WAAW,UAAW,CACvBhT,MAAQjO,EAAQiO,OAAS,QACzB3L,KAAQtC,EAAQ0E,KAAO1E,EAAQ0E,KAAO88E,EAAcxhF,EAAQoO,MAC5DwI,SAAU8qE,EACVh5D,MAAOk5D,GAvCf,CA0CJ,EAEAh/D,QAAS,WACLljB,KAAKq9E,SAASvuE,SAAQ,SAAS4yE,GAC3BA,EAAOx+D,SACX,IAEIljB,KAAKuwE,iBACLvwE,KAAKuwE,gBAAgBrtD,UAGzBljB,KAAKwwE,qBAAqBttD,UAC1BljB,KAAKywE,qBAAqBvtD,UAC1BljB,KAAK0wE,mBAAmBxtD,UAExBljB,KAAKuwE,gBAAkBvwE,KAAKwwE,qBACLxwE,KAAKywE,qBACLzwE,KAAK0wE,mBAAqB,KAE7C1wE,KAAK4wE,WACL5wE,KAAK4wE,SAAS1tD,UACdljB,KAAK4wE,SAAW,MAGhB5wE,KAAK8wE,YACL9wE,KAAK8wE,WAAW5tD,UAGhBljB,KAAK8iB,cACL9iB,KAAK8iB,aAAaI,UAGlBljB,KAAKg+E,YACLh+E,KAAKg+E,WAAW96D,UAGpBljB,KAAK6gF,oBACT,EAEAA,mBAAoB,WACZ7gF,KAAK+gF,cACL/gF,KAAK+gF,YAAY79D,UACjBljB,KAAK+gF,iBAAcj0E,EACnB9M,KAAKuiF,uBAAoBz1E,EAEjC,EAEAk7C,OAAQ,SAASv5C,GACb,GAAKzO,KAAKoe,QAAQzT,GAAG,YAArB,CAGA,IAAIqE,EAAQhP,KAAKqP,OACboM,EAAQzM,EAAMyM,QACd+mE,EAAgBviF,EAAMqb,QAAQmnE,YAC9BC,EAAe1iF,KAAK0iB,QAAQ,GAAG29D,YAAcmC,EAC7CG,EAAgB3iF,KAAK0iB,QAAQ,GAAGuwD,aAAeuP,EAEnD,IAAI/mE,IAASzb,KAAKmhF,eAAe1lE,GAAjC,CAIA,IAAImnE,EACC5zE,EAAMozC,qBACPpzC,EAAM2zC,uBAAuBttC,OAASqK,IAAW,SACjD,MAF8B,OAIlC1f,KAAK0iB,QACAmC,YAAYu0D,EAAeE,cAAet5E,KAAKmxE,OAAOzlD,YACtD7G,YAAYu0D,EAAeW,iBAAqC,OAAnB6I,GAC7C/9D,YAAYu0D,EAAeY,eAAmC,UAAnB4I,GAEhD,IAAI/kD,EAAO7uB,EAAM8uB,MACb4gD,EAAU,GACV7uC,EAAO,CACP8gC,SAAU3wE,KAAK2wE,SACfkS,iBAAkBnE,EAClBgE,aAAcA,EACdC,cAAeA,GAEnB3iF,KAAK4X,MAAM9I,SAAQ,SAAS8tC,GACxB8hC,EAAQ/9E,KAAKi8C,EAAKoL,OAAOnY,GAC7B,IAEA,IAAI6pC,EAAYz5E,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACrCta,MAAO,CAAEK,MAAO05B,EAAKuhD,aAAe,KAAMh7E,OAAQy5B,EAAK6hD,cAAgB,MACvE55C,UAAWq3C,EAAK16D,WAAWi3D,YAG/BgF,EAAQ/9E,KAAK+4E,GAET1qE,EAAM2zC,wBAA0B3zC,EAAMyzC,sBACtCi8B,EAAQ/9E,KAAKX,KAAK8iF,oBAGtB9iF,KAAKyyB,KAAKu1B,OAAO02B,GAEjBl9E,EAAExB,KAAK2sD,WAAWjpC,IAAI,CAClBvf,MAAOu+E,EACPt+E,OAAQu+E,IAGR3iF,KAAKmxE,OAAOzlD,WACZ1rB,KAAKmxE,OAAO/kD,cAAcpsB,KAAKy4E,uBACtBhqE,EAAOkM,QACPlM,EAAOq0C,SACP9zC,EAAMg1C,uBACNh1C,EAAMozC,sBACNpzC,EAAMqzC,sBACNrzC,EAAMi7B,gBACfjqC,KAAK+iF,yBAlDT,CATA,CA6DJ,EAGAD,iBAAkB,WACd,IAKIh/E,EALAkL,EAAQhP,KAAKqP,OAGbu3D,EAFM53D,EAAM2zC,uBAEKttC,OAASqK,IAI1B5b,EADA8iE,EACQ,CACJxiE,OAAQpE,KAAK2wE,SAASsC,aAAe,KACrC9uE,MAAOq7E,MACP//D,KAAMzQ,EAAMyzC,qBAAqBh8C,EAAI,KACrCsZ,IAAK,OAGD,CACJ3b,OAAQo7E,MACRr7E,MAAOnE,KAAK2wE,SAAS0P,YAAc,KACnCtgE,IAAK/Q,EAAMyzC,qBAAqB3xB,EAAI,KACpCrR,KAAM,OAId,IAAIgD,EAAa+L,EAAK/L,WAEtB,OAAOxiB,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAC5B0nB,UAAWrjB,EAAWugE,YAAepc,EAAmD,GAAtC,IAAMnkD,EAAWwgE,oBACnEn/E,MAAOA,GACT,CACE7D,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAAE0nB,UAAWrjB,EAAWygE,mBACjDjjF,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAAE0nB,UAAWrjB,EAAW0gE,oBAEzD,EAEAJ,wBAAyB,WACrB,IAAI/zE,EAAQhP,KAAKqP,OACbwuB,EAAO7uB,EAAM8uB,MAgBbnlB,EAAYklB,EAAKnD,UAAU1rB,EAAMhB,SAASiB,cAC1C8J,EAAS/Y,KAAKwN,UAAU4K,YAAY0D,UACxC,IAAuB,IAAnB/C,EAAO+C,SAAqB/C,EAAOgD,eAGnC,OAFA/b,KAAKw9E,kBAAkBx1B,OAAO,SAC9BhoD,KAAKghF,0BAITroE,EAAY3J,EAAMo1C,KAAKzrC,GAEvB,IAAIwuB,EAAQ,IAAIs1C,EAEZ2G,EAAgBvlD,EAAKwlD,gBAAgB1qE,GAEzCyqE,EAAcrrE,KAAKjJ,SAAQ,SAAS1K,GAChC+iC,EAAMy1C,OAAOx4E,EACjB,IAEAg/E,EAAcprE,QAAQlJ,SAAQ,SAAS3K,GACnCgjC,EAAMw1C,UAAUx4E,EACpB,IAEA,IAAIgJ,EAAM6B,EAAM88B,gBAAgBnzB,GAC5B2qE,EAAqBn2E,EAAI4+B,QACzBw3C,EAAuBp2E,EAAI6+B,UAE/Bh9B,EAAMF,QAAQ6J,GAAW,SAASjF,EAAK2B,EAAKvB,GACxC,IAAImvC,EAAW,IAAItlB,EAAQjqB,EAAK2B,GAAKoY,QAErC,IAAK81D,EAAqBtgC,GAAW,CACjC,IAAIzb,EAphCpB,SAAiBL,EAAOzzB,EAAKI,GACzB,IAAIhQ,EAAQ,CAAC,EAETgQ,EAAK80B,aACL9kC,EAAM0/E,gBAAkB1vE,EAAK80B,YAG7B90B,EAAK8B,QACL9R,EAAM8R,MAAQ9B,EAAK8B,OAGnB9B,EAAKm5B,aACLnpC,EAAMmpC,WAAan5B,EAAKm5B,YAGxBn5B,EAAKnB,YACL7O,EAAM22E,eAAiB,aAGvB3mE,EAAKk1B,SACLllC,EAAMk3E,UAAY,UAGlBlnE,EAAK+0B,YACL/kC,EAAM+kC,UAAY/0B,EAAK+0B,WAGvB/0B,EAAKg1B,gBACLhlC,EAAMglC,cAAwC,WAAvBh1B,EAAKg1B,cAA8B,SAAWh1B,EAAKg1B,eAG1Eh1B,EAAKm1B,OACLnlC,EAAMm3E,WAAa,QAGnBnnE,EAAK60B,WACL7kC,EAAM6kC,SAAW70B,EAAK60B,SAAW,OAGnB,IAAd70B,EAAKS,OACLzQ,EAAMkoB,WAAa,YAGnBlY,EAAKyC,YACLzS,EAAMyS,YAAc4jE,EAAWrmE,EAAKyC,aAC7BzC,EAAK80B,aACZ9kC,EAAM2/E,iBAAmB3vE,EAAK80B,YAG9B90B,EAAK+C,aACL/S,EAAM+S,aAAesjE,EAAWrmE,EAAK+C,cAC9B/C,EAAK80B,aACZ9kC,EAAM4/E,kBAAoB5vE,EAAK80B,YAGnC,IAAIp+B,EAAOsJ,EAAK5R,MAAOwM,SAAclE,EAAM8K,EAASxB,EAAKwB,OACpDA,GAAkB,UAAR5G,GAAoBlE,GAAQiG,KAAKgnB,MAAMjtB,KAClD8K,EAAS,oBAETA,GAAkB,MAAR9K,IACVA,EAAOvK,EAAMsN,YAAY2H,WAAWI,OAAO9K,EAAM8K,IACxC8lE,aACL1sE,EAAOlE,EAAK4wE,YAIpB,IAAIjvE,EAAQ,CAAErI,MAAOA,GAErB,IAAKA,EAAM+kC,UACP,OAAQn6B,GACN,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,WACH5K,EAAM+kC,UAAY,QAClB,MACF,IAAK,UACH/kC,EAAM+kC,UAAY,SAKrB,yBAAyB5gC,KAAKyG,KAG/BvC,EAAMw3E,MAAQ7vE,EAAK5R,MACnBiK,EAAM,qBAAuBsoB,KAAKC,UAAU,CAAE,EAAG,EAAG,EAAG5gB,EAAK5R,QACxDoT,IACAnJ,EAAMy3E,MAAQtuE,EACdnJ,EAAM,4BAA8BsoB,KAAKC,UAAU,CAAE,EAAG,EAAG,EAAGpf,EAAQ,EAAG,MAG7ExB,EAAKmiB,UACL9pB,EAAM,uBAAyB,IAAM2H,EAAKmiB,QAAQxI,SAGtD,IAAIqY,EAAY,MAEI,IAAhBhyB,EAAKZ,SACL4yB,EAAY,cAGhB,IAEIpwB,EAAQmuE,EAFRr8C,EAAKL,EAAM01C,QAAQnpE,EAAKlJ,EAAM2B,EAAO25B,EAAWhyB,EAAKkN,YAwBzD,OApBIlN,EAAKsC,YACLytE,EA3UR,SAAoB18C,EAAOzzB,GACvB,IAAI2D,EAAQ8vB,EAAMu1C,IAAIhpE,GAAK84C,SAC3B,OAAOn1C,EAAMA,EAAMhW,OAAS,EAChC,CAwUkByiF,CAAW38C,EAAOzzB,GAC5BgC,EAASykE,EAAWrmE,EAAKsC,YACrBytE,GAAWnuE,IACXmuE,EAAQpgE,KAAK3f,MAAMyS,YAAcb,IAE9B5B,EAAK80B,aACZ9kC,EAAMigF,gBAAkBjwE,EAAK80B,YAG7B90B,EAAK4C,WACLmtE,EAhVR,SAAmB18C,EAAOzzB,GACtB,IAAIswE,EAAU78C,EAAMu1C,IAAIhpE,EAAI,GACxBhJ,EAAQy8B,EAAMu1C,IAAIhpE,GAAK84C,SAASnrD,OAAO,EAE3C,GAAI2iF,GAAWt5E,GAAS,EACpB,OAAOs5E,EAAQx3B,SAAS9hD,EAEhC,CAyUkBu5E,CAAU98C,EAAOzzB,GAC3BgC,EAASykE,EAAWrmE,EAAK4C,WACrBmtE,GAAWnuE,IACXmuE,EAAQpgE,KAAK3f,MAAM+S,aAAenB,IAE/B5B,EAAK80B,aACZ9kC,EAAMogF,eAAiBpwE,EAAK80B,YAGzBpB,CACX,CAq5ByBq1C,CAAQ11C,EAAOzzB,EAAMiF,EAAU9H,QAAQ6C,IAAKI,GAEjDqwE,EAAab,EAAmBrgC,GAEhCkhC,IACA38C,EAAG/jB,KAAK2gE,QAAUD,EAAWhgF,QAC7BqjC,EAAG/jB,KAAK4gE,QAAUF,EAAW//E,SAErC,CACJ,IAEInE,EAAMqb,QAAQ8O,QAAQC,MACtBrqB,KAAKoY,UAAU+kB,QAGnBn9B,KAAKw9E,kBAAkBx1B,OAAO,CAAE7gB,EAAM41C,UAAU,EAAG,EAAG,mBAAqB/8E,KAAKwN,UAAU4K,YAAY4tB,QAEtGhmC,KAAKghF,yBACT,EAEAJ,MAAO,SAASltE,EAAK4J,EAAQoY,EAAUC,GACnC,IAAIinB,EAAO,IAAIpuB,EAAKxuB,KAAKqP,OAAQrP,KAAKqP,OAAOyuB,MAAM8e,KAAK,CAAElpC,IAAKA,EAAK4J,OAAQA,EAAQoY,SAAUA,EAAUC,YAAaA,KAErH,OADAinB,EAAKotB,QAAQhqE,KAAK2wE,SAAS0P,YAAargF,KAAK2wE,SAASsC,cAC/Cr2B,CACX,IAGA0+B,EAAiB,CACjBxnE,KAAM,qBACNwwE,MAAO,sBACPC,MAAO,sBACPC,QAAS,wBACTC,QAAS,wBACTC,UAAW,2BACXC,aAAc,8BACd/nC,KAAM,qBACNpyC,KAAM,qBACN25E,WAAY,4BACZS,mBAAoB,yBACpBztE,WAAY,4BACZwB,UAAW,0BACXksE,iBAAkB,sBAClBC,gBAAiB,sBACjB3rD,OAAQ,WACRpZ,IAAK,QACLJ,MAAO,UACPK,OAAQ,WACRP,KAAM,SACNk2D,aAAc,kBACdoP,mBAAoB,yBACpBC,gBAAiB,sBACjBhC,WAAY,gBACZE,iBAAkB,uBAClBC,iBAAkB,uBAClBF,mBAAoB,yBACpBgC,mBAAoB,oCACpBx2D,OAAQ,CACJ,aACA,aACA,aACA,aACA,aACA,eAIJD,EAAOvuB,EAAM0B,MAAMvB,OAAO,CAC1BC,KAAM,SAAS2O,EAAO6uB,GAClB79B,KAAKqP,OAASL,EACdhP,KAAK89B,MAAQD,CACjB,EAEAmsC,QAAS,SAAS7lE,EAAOC,GACrBpE,KAAK89B,MAAMksC,QAAQ7lE,EAAOC,EAC9B,EAEA8gF,UAAW,SAAS36B,EAAY2rB,EAAWnnE,GACvC,OAAO/O,KAAK89B,MAAM/T,KAAKwgC,EAAY2rB,GAAWnnE,IAAIojB,WAAWpjB,EACjE,EAEAi5C,OAAQ,SAASnY,GACb,IAAI8gC,EAAW9gC,EAAK8gC,SAChBpmB,EAAaomB,EAASpmB,WACtB2rB,EAAYvF,EAASuF,UAErBA,EAAY,IACZA,EAAY,GAGZ3rB,EAAa,IACbA,EAAa,GAGjB,IAAI9nC,EAAa+L,EAAK/L,WAClBzT,EAAQhP,KAAKqP,OACbwuB,EAAO79B,KAAK89B,MACZ/T,EAAO8T,EAAK9T,KAAKwgC,EAAY2rB,GACjCl2E,KAAK68C,aAAe9yB,EACpB/pB,KAAKmlF,aAAenlF,KAAKi/E,WAAWl1D,EAAKhb,KACzC/O,KAAKolF,iBAAmBp2E,EAAMs1C,kBAE9B,IAAIkI,EAAW,GAcf,GAZAA,EAAS7rD,KAAKX,KAAKqlF,WAAWx1C,IAEzB7gC,EAAMa,gBACP28C,EAAS7rD,KAAKX,KAAKslF,gBAAgB3U,IAGvCnkB,EAAS7rD,KAAKX,KAAKulF,kBAEnB/4B,EAAS7rD,KAAKX,KAAKwlF,yBAEnBh5B,EAAS7rD,KAAKX,KAAKylF,uBAEf5nD,EAAK6nD,aAAc,CACnB,IAAIhB,EAAYzkF,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACrC0nB,UAAWrjB,EAAWiiE,UACtB5gF,MAAO,CACHK,MAAO05B,EAAKof,YAAc,KAC1Bl9B,IAAKgK,EAAK83C,UAAY,QAG9BrV,EAAS7rD,KAAK+jF,GACd11E,EAAMF,QAAQib,EAAKhb,IAAIoH,aAAc,SAASzC,GAC1C,IAAK1E,EAAMi0B,YAAYvvB,GAAM,CACzB,IAAI9Q,EAAO8Q,EAAM,EAAGtP,EAAS4K,EAAMqD,UAAUqB,GAC7CgxE,EAAUl4B,SAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAC7C0nB,UAAW9lC,KAAK2lF,gBAAgBjyE,EAAK,OACrC5P,MAAO,CACHK,MAAO05B,EAAKof,YAAc,KAC1B74C,OAAQA,EAAS,OAEtB,CAAEnE,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAC1B0nB,UAAW,2BACZ,CAAE7lC,EAAM6nD,IAAIllD,KAAKA,EAAK,QAC7B,CACJ,EAAEsM,KAAKlP,MACX,CAEA,GAAI69B,EAAK+nD,gBAAiB,CACtB,IAAIjB,EAAe1kF,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACxC0nB,UAAWrjB,EAAWkiE,aACtB7gF,MAAO,CACHic,IAAK,MACLN,KAAMsK,EAAK87D,aAAe,KAC1B1hF,MAAOnE,KAAKmlF,aAAahhF,MAAQ,KACjCC,OAAQy5B,EAAKmf,aAAe,QAGpCwP,EAAS7rD,KAAKgkF,GACd,IAAIllE,EAAO,EACXzQ,EAAMF,QAAQib,EAAKhb,IAAI0H,SAAU,SAAS/C,EAAK2B,GAC3C,IAAKrG,EAAMk0B,eAAe7tB,GAAM,CAC5B,IAAIzS,EAAO3C,EAAMsN,YAAYkwB,IAAI1D,QAAQ,KAAMra,IAAUrK,GACrDlR,EAAQ6K,EAAMmD,YAAYkD,GAC9BsvE,EAAan4B,SAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAChD0nB,UAAW9lC,KAAK2lF,gBAAgBtwE,EAAK,OACrCvR,MAAO,CACHgoB,SAAU,WACVrM,KAAMA,EAAO,KACbtb,MAAOA,EAAQ,KACfC,OAAQy5B,EAAKmf,aAAe,OAEjC,CAAE/8C,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAC1B0nB,UAAW,2BACZ,CAAE7lC,EAAM6nD,IAAIllD,KAAKA,EAAK,SACzB6c,GAAQtb,CACZ,CACJ,EAAE+K,KAAKlP,MACX,CAEIgP,EAAM2zC,yBAA2B9kB,EAAK+nD,iBAAmB/nD,EAAK6nD,gBACzD12E,EAAMyzC,sBACPziD,KAAK8lF,mBAAmBt5B,IAIhC,IAAIu5B,EAAc,CAACtjE,EAAWm6B,MAU9B,OARI/e,EAAK+nD,iBACLG,EAAYplF,KAAK8hB,EAAW1C,KAG5B8d,EAAK6nD,cACLK,EAAYplF,KAAK8hB,EAAWhD,MAGzBxf,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAC5Bta,MAAO+5B,EAAK/5B,MACZgiC,UAAWigD,EAAY5iF,KAAK,MAC7BqpD,EACP,EAEAm5B,gBAAiB,SAASj7E,EAAOgE,GAC7B,IAEIs3E,EACAC,EAHA3hC,EAAkBtkD,KAAKolF,iBAKd,QAAT12E,GACAs3E,EAAgB1hC,EAAgBvsC,KAAKrN,GACrCu7E,EAAa3hC,EAAgBE,UAE7BwhC,EAAgB1hC,EAAgBrqC,KAAKvP,GACrCu7E,EAAa3hC,EAAgBC,SAGjC,IAAIze,EAAYkgD,IAAkB1hC,EAAgBS,IAAM,OAAUkhC,EAAa,UAAY,QAM3F,OAJIngD,IACAA,EAAY,eAAiBA,GAG1BA,CACX,EAEAu/C,WAAY,SAASx1C,GACjB,IAWoF/oC,EAXhFkI,EAAQhP,KAAKqP,OACb0a,EAAO/pB,KAAK68C,aACZyV,EAAOryD,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAChC0nB,UAAWtX,EAAK/L,WAAWjY,KAC3B1G,MAAO,CACHgoB,SAAU,WACVrM,KAAMsK,EAAK87D,aAAe,KAC1B9lE,IAAKgK,EAAK83C,UAAY,QAG1B2W,EAAOx4E,KAAKmlF,aACZp1E,EAAS9P,EAAMsN,YAAY+/B,KAAK44C,SAASl3E,EAAO+a,EAAKhb,IAAK,CAAEo3E,WAAW,IACvEtoD,EAAO79B,KAAK89B,MACZhrB,EAAgB9D,EAAMwuC,eACtB1qC,IAEAhM,EAAO,KACPiJ,EAAOq2E,QAAQt3E,SAAQ,SAASrI,GACxBA,IAAMK,IACNA,EAAOL,EACP6rD,EAAK9F,SAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACxC0nB,UAAWw1C,EAAegJ,MAC1BxgF,MAAO,CACH2b,KAAMhZ,EAAI,KACVrC,OAAQo0E,EAAKp0E,OAAS,KACtBiiF,YAAar3E,EAAM6xC,qBAInC,IACA/5C,EAAO,KACPiJ,EAAOu2E,QAAQx3E,SAAQ,SAASgiB,GACxBA,IAAMhqB,IACNA,EAAOgqB,EACPwhC,EAAK9F,SAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACxC0nB,UAAWw1C,EAAeiJ,MAC1BzgF,MAAO,CACHic,IAAK+Q,EAAI,KACT3sB,MAAOq0E,EAAKr0E,MAAQ,KACpBkiF,YAAar3E,EAAM6xC,qBAInC,KAEJ,IAAIpY,EAAUxoC,EAAMsN,YAAY+/B,KAAKi5C,UACjCC,EAAkBx3E,EAAMmI,aAAalI,aACrCkI,EAAaqvE,EAAgB31E,QAoFjC,OAlFAd,EAAOsH,MAAMvI,SAAQ,SAASgF,GAC1B,IAAI+a,EAAM,KACN43D,EAAS3yE,EAAKJ,IAAMqW,EAAKhb,IAAI8B,QAAQ6C,IACrCgzE,EAAS5yE,EAAKuB,IAAM0U,EAAKhb,IAAI8B,QAAQwE,IACzC,GAAIrG,EAAMa,eAAgB,CACtB,IAAId,EAAMC,EAAMa,eAAee,YAC3B7B,GAAOA,EAAI2E,KAAO+yE,GAAU13E,EAAIsG,KAAOqxE,IACvC73D,EAAM,oCAEd,MAAW43D,GAAUtvE,EAAWzD,KAAOgzE,GAAUvvE,EAAW9B,MAExDwZ,EAAM,CACFL,EAAK/L,WAAWtL,YAClB1D,OAAOzT,KAAK2mF,sBACL3mF,KAAK4mF,kBAAkBJ,IAC5Bx3E,EAAMyzB,uBACN5T,EAAIluB,KAAK6tB,EAAK/L,WAAW0W,QAE7BtK,EAAMA,EAAI1rB,KAAK,MAInB,GAFAslC,EAAQsG,IAAIj7B,GACZumE,EAAS/nB,EAAK9F,SAAU14C,EAAM+a,EAAK/b,GAC/BgB,EAAKgvC,SAAW9zC,EAAM+zC,aACtB0jC,GAAUz3E,EAAM+zC,YAAYrvC,KAAOgzE,GAAU13E,EAAM+zC,YAAY1tC,IAAK,CACpE,IACIoK,EAAO3L,EAAK6L,MAAQke,EAAKpe,KAAOsK,EAAK87D,aAD1B,EAEX/hF,EAAQ,CAAEic,IAAMjM,EAAKiM,IAAM8d,EAAK9d,IAAMgK,EAAK83C,UAAa,MACxDpiD,EAAO,IAAMowB,EAAK6yC,aAClB5+E,EAAM6b,MAASkwB,EAAK6yC,aAAe7kD,EAAKpe,KAAO3L,EAAK2L,KAAOsK,EAAK87D,aAJrD,EAIgF,KAE3F/hF,EAAM2b,KAAOA,EAAO,KAExB,IAAIsF,EAAM9kB,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAC/B0nB,UAAW,uCACXhiC,MAAOA,GACR,CAAE7D,EAAM6nD,IAAIllD,KAAKkR,EAAKgvC,WACzBjT,EAAKgzC,iBAAiBliF,KAAKokB,EAC/B,CACJ,GAAG/kB,MACHyoC,EAAQo+C,KAAK/3E,SAAQ,SAASxD,GAC1BA,EAAEwD,SAAQ,SAASoL,GACf,IAAKA,EAAE4sE,SAAU,CACb5sE,EAAE4sE,UAAW,EACb,IAAIhjF,EAAQ,CACR2b,KAAcvF,EAAEzT,EAAI,KACpBsZ,IAAc7F,EAAE6F,IAAM,KACtB3b,OAAe8V,EAAE8F,OAAS9F,EAAE6F,IAAM,EAAK,KACvCgnE,YAAc7sE,EAAEtY,KAAO,KACvBykF,YAAcnsE,EAAEtE,OAEN,GAAVsE,EAAEtY,OACFkC,EAAMkjF,UAAY,gBAAkB9sE,EAAEtY,KAAK,GAAG,EAAI,OAEtD0wD,EAAK9F,SAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACxC0nB,UAAWw1C,EAAekJ,QAC1B1gF,MAAOA,IAEf,CACJ,GACJ,IACA2kC,EAAQw+C,MAAMn4E,SAAQ,SAASxD,GAC3BA,EAAEwD,SAAQ,SAASoL,GACf,IAAKA,EAAE4sE,SAAU,CACb5sE,EAAE4sE,UAAW,EACb,IAAIhjF,EAAQ,CACRic,IAAc7F,EAAE4W,EAAI,KACpBrR,KAAcvF,EAAEuF,KAAO,KACvBtb,MAAe+V,EAAEyF,MAAQzF,EAAEuF,KAAQ,KACnCsnE,YAAc7sE,EAAEtY,KAAO,KACvBykF,YAAcnsE,EAAEtE,OAEN,GAAVsE,EAAEtY,OACFkC,EAAMkjF,UAAY,gBAAkB9sE,EAAEtY,KAAK,GAAG,EAAI,OAEtD0wD,EAAK9F,SAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACxC0nB,UAAWw1C,EAAemJ,QAC1B3gF,MAAOA,IAEf,CACJ,GACJ,IACA9D,KAAKknF,eAAen3E,EAAQuiD,EAAK9F,UAC1B8F,CACX,EAEA40B,eAAgB,SAASn3E,EAAQ48C,GAC7B,IAAI39C,EAAQhP,KAAKqP,OACb5B,EAAWuB,EAAMxB,UACrBuC,EAAO4B,SAAS7C,SAAQ,SAASlI,GAC7B,IAAI2I,EAAU3I,EAAE2I,QAEZwV,EADMne,EAAEnC,IACE0iF,MAAM,yBAChB53E,EAAQU,OACR8U,EAAIynC,SAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACvC0nB,UAAW,8BACXhiC,MAAO,CACHsjF,gBAAiB,QAAU35E,EAASi/D,SAASn9D,EAAQU,OAAS,KAC9De,QAASzB,EAAQyB,YAIzBzB,IAAYP,EAAMa,iBAClBkV,EAAItB,KAAKqiB,WAAa,gCAiTtC,SAA8B6mB,GAC1B,CAAE,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,MAAO79C,SAAQ,SAASkyB,GAC5D2rB,EAAUhsD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACpC0nB,UAAa,gCAAkC9E,EAC/C,iBAAkBA,IAE1B,GACJ,CAvTgBqmD,CAAqBtiE,EAAIynC,WAE7BG,EAAUhsD,KAAKokB,EACnB,GACJ,EAEA+gE,mBAAoB,SAASn5B,GACzB,IAKI7oD,EAJAiL,EADQ/O,KAAKqP,OACDszC,uBACZh2B,EAAY3sB,KAAKi/E,WAAWlwE,GAC5B0T,EAAa,CAAE+L,EAAK/L,WAAWkzD,cAGnC,GAAI5mE,EAAIsG,OAASqK,IAAU,CACvB,GAAI1f,KAAK89B,MAAM/lB,KAAKuvE,OAAS,EACzB,OAEJxjF,EAAQ,CACJM,OAAQpE,KAAK89B,MAAMkf,aAAe,KAClC74C,MAAOq7E,MACP//D,KAAMkN,EAAUhN,MAAQ6/D,IAAyB,KACjDz/D,IAAK,OAET0C,EAAW9hB,KAAKy4E,EAAeW,iBACnC,KAAO,CACH,GAAI/5E,KAAK89B,MAAM9lB,QAAQsvE,OAAS,EAC5B,OAEJxjF,EAAQ,CACJM,OAAQo7E,MACRr7E,MAAQnE,KAAK89B,MAAMmf,YAAc,KACjCl9B,IAAK4M,EAAU3M,OAASw/D,IAAyB,KACjD//D,KAAM,OAEVgD,EAAW9hB,KAAKy4E,EAAeY,eACnC,CAEArtB,EAAUhsD,KAAKV,EAAM6nD,IAAI1pC,QAAQ,MAAO,CACpC0nB,UAAWrjB,EAAWtf,KAAK,KAC3BW,MAAOA,IAEf,EAEA+7E,eAAgB,SAASrH,GAIrB,OAAO,IAAIv4E,EAAMsN,YAAY65C,UACzBoxB,EAAK74D,MAJS,GACE,EAIhB64D,EAAKz4D,IAJW,EADF,MAStB,EAEA0lE,oBAAqB,WACjB,IAAIz2E,EAAQhP,KAAKqP,OACbm9C,EAAW,GACX/pC,EAAa06D,EAAK16D,WAClBtF,EAASnO,EAAMmO,SA0CnB,OAbIA,GACAnd,KAAKunF,QAAQ/6B,EAAUrvC,EAAOpO,IAAK0T,EAAWm3D,aAGlD5qE,EAAMkyC,oBAAoBlhD,KAAK68C,aAAa9tC,IAAK,SAASA,GACtD,IAAIypE,EAAOx4E,KAAKi/E,WAAWlwE,GACvB+c,EAAW9rB,KAAK6/E,eAAerH,GAC/Bl7D,EAAStd,KAAKqP,OAAOu3C,aAAa73C,GAClC6hB,EA/BR,SAAsBnO,EAAYqJ,EAAUphB,GACxC,IALU88E,EAKN1jF,EAAQ,CACR2b,KAAMqM,EAASrM,KAAO,KACtBM,IAAK+L,EAAS/L,IAAM,MAEpB0nE,EAAWtqE,GAAUA,EAAOnF,QAAQ+iB,MAAK,SAASp0B,GAClD,OAAOA,EAAE+D,QAAUA,CACvB,IACIg9E,EAAUjlE,EAAWo3D,aAYzB,OAVI4N,IACAC,GAAW,IAAMjlE,EAAWq3D,sBAGnB75E,EAAM6nD,IAAI1pC,QACnB,OACA,CAAE0nB,UAAW4hD,EAAS5jF,MAAOA,GAC7B,EArBM0jF,EAqBC/kE,EAAWw3D,kBApBfh6E,EAAM6nD,IAAI1pC,QAAQ5c,EAAEvB,EAAMqiB,GAAGK,KAAK6kE,IAAW,MAwBxD,CAUiB3N,CAAap3D,EAAYqJ,EAAUxO,GAEhDkvC,EAAS7rD,KAAKiwB,EAClB,EAAE1hB,KAAKlP,OAEAC,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAC5B0nB,UAAWrjB,EAAWk3D,sBACvBntB,EAEP,EAEAg5B,sBAAuB,WACnB,IAAI/iE,EAAa+L,EAAK/L,WAClBzT,EAAQhP,KAAKqP,OACbs4E,EAAa,GAYjB,OAVA34E,EAAM+uC,mBAAmBjvC,QAAQ,SAASjB,GACtC,IAAIkB,EAAMlB,EAAMkB,IAEZA,IAAQ9O,EAAMsN,YAAY+vB,SAI9Bt9B,KAAKunF,QAAQI,EAAY54E,EAAK0T,EAAWwiE,mBAAqB,IAAMp3E,EAAMihB,WAC9E,EAAE5f,KAAKlP,OAEAC,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAAE0nB,UAAWrjB,EAAWoiE,kBAAoB8C,EAEhF,EAEArC,gBAAiB,SAAS3U,GACtB,IAAIluD,EAAa+L,EAAK/L,WAClBklE,EAAa,GACbC,EAAmB,CAACnlE,EAAW9J,WAC/B3J,EAAQhP,KAAKqP,OACb8H,EAAanI,EAAMmI,aAAalI,aAChC0J,EAAY3J,EAAMhB,SAoBtB,OAlBA45E,EAAmBA,EAAiBn0E,OAAOzT,KAAK2mF,uBAEvB,IAArBhuE,EAAU/W,QACVgmF,EAAiBjnF,KAAK,sBAGtBX,KAAKqP,OAAO6yC,iBACZ0lC,EAAiBjnF,KAAK,0BAG1BgY,EAAU7J,QAAQ,SAASC,GACnBA,IAAQ9O,EAAMsN,YAAY+vB,SAC1Bt9B,KAAKunF,QAAQI,EAAY54E,EAAK64E,EAAiBzkF,KAAK,KAE5D,EAAE+L,KAAKlP,OAEPA,KAAK6nF,0BAA0BF,EAAYxwE,EAAYw5D,GAEhD1wE,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAAE0nB,UAAWrjB,EAAWoiE,kBAAoB8C,EAChF,EAEApC,eAAgB,WACZ,IAAIuC,EAAoB,GAExB,GAAI9nF,KAAKqP,OAAO8yC,qBAAsB,CAClC,IAAIF,EAAcjiD,KAAKqP,OAAO4yC,cAC1B1e,EAAQvjC,KAAKqP,OAAO6yC,gBACpBlhB,EAAYhhC,KAAKqP,OAAO2yC,mBAI5B,GAFAhiD,KAAKunF,QAAQO,EAAmB7lC,EAAa,eAEzC1e,EACAvjC,KAAKunF,QAAQO,EAAmBvkD,EAAO,0BACpC,QAAkBz2B,IAAdk0B,EAAyB,CAChC,IAAIjyB,EAAKg5E,EAET,OAAO/mD,GACH,KAAK,EAIL,KAAK,EACDjyB,EAAMkzC,EAAY1nC,YAClBwtE,EAAW,sBACX,MACJ,KAAK,EACDh5E,EAAM,IAAI4uB,EAAQskB,EAAYpxC,QAAQ6C,IAAKuuC,EAAY1nC,YAAYlF,KACnE0yE,EAAW,sBACX,MACJ,KAAK,EACDh5E,EAAM,IAAI4uB,EAAQskB,EAAY1nC,YAAY7G,IAAKuuC,EAAYpxC,QAAQwE,KACnE0yE,EAAW,sBAInB,IAAIp7D,EAAY3sB,KAAKunF,QAAQO,EAAmB/4E,EAAKg5E,GACrD,GAAIp7D,EAAW,CACX,IAAI0W,EAAOpjC,EAAM6nD,IAAI1pC,QAAQ,OAAQ,CAAE0nB,UAAW,aAAe,CAAE7lC,EAAM6nD,IAAIllD,KAAK5C,KAAKqP,OAAO0yC,iBAC9Fp1B,EAAU6/B,SAAS7rD,KAAK0iC,EAC5B,CACJ,CACJ,CAEA,OAAOpjC,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAAE0nB,UAAWtX,EAAK/L,WAAWqiE,iBAAmBgD,EACpF,EAEAP,QAAS,SAASjN,EAAYvrE,EAAK+2B,GAC/B,IAA8B/gB,EAM9B,OANW/kB,KAAK68C,aAEP9tC,IAAIojB,WAAWpjB,KACpBgW,EAAM/kB,KAAKi/E,WAAWlwE,GAAK4L,OAAO,EAAG,GAAGwsE,MAAMrhD,GAC9Cw0C,EAAW35E,KAAKokB,IAEbA,CACX,EAEA8iE,0BAA2B,SAASvN,EAAYvrE,EAAK4hE,GACjD,IAAI9wE,EAAOG,KACPgP,EAAQnP,EAAKwP,OACb0a,EAAOlqB,EAAKg9C,aACZlnB,EAAc91B,EAAKi+B,MAAM9lB,QAAQgwE,MAAMvtE,OACvCwtE,EAAKj5E,EAAMgxE,yBAEf,GAAIiI,GAAMl+D,EAAKhb,IAAIojB,WAAWpjB,GAAM,CAChC,IAAI4d,EAAY9sB,EAAKo/E,WAAWlwE,GAChCC,EAAMF,QAAQC,EAAImtB,YAAY,SAASxoB,EAAK2B,EAAKvB,GAC7CA,EAAK2L,KAAOkN,EAAUlN,KACtB3L,EAAKiM,IAAM4M,EAAU5M,IACrBjM,EAAK3P,MAAQwoB,EAAUxoB,MACvB2P,EAAK1P,OAASuoB,EAAUvoB,OAExB,IAAI8jF,EAAW,mGACXC,EAAe9yE,GAAOsgB,EAAc,GAAK91B,EAAKuoF,wBAAwB10E,EAAK2B,EAAKs7D,GAChFwX,IACAD,GAAY,8BAEhBroF,EAAKogF,oBAAsBkI,EAC3B,IAAIE,EAAMpoF,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAC/B0nB,UAAWoiD,EACXpkF,MAAO,CACH2b,KAAU3L,EAAK2L,MAAQ0oE,GA75DvB,GA65D2Dr0E,EAAK3P,OAAU,KAC1E4b,IAASjM,EAAKiM,IAAM,KACpB3b,OAAS0P,EAAK1P,OAAS,QAG3B6jF,EAAGtlE,MACH0lE,EAAI77B,SAAS7rD,KAAKV,EAAM6nD,IAAI1pC,QAAQ5c,EAAEvB,EAAMqiB,GAAGK,KAAKslE,EAAGtlE,KAAK7f,QAAQ,QAAS,MAAM,KAEvFw3E,EAAW35E,KAAK0nF,EACpB,GACJ,CACJ,EAEA1B,oBAAqB,WACjB,IAAI2B,EACAC,EAAe,GAUnB,OARIvoF,KAAKqP,OAAO46B,iBACZq+C,EAAyBtoF,KAAKqP,OAAO0uC,mBAAmB5gC,QAAO,SAAS6H,GAAO,OAAOA,EAAI4J,QAAsB,OAAZ5J,EAAItW,IAAe,IAAG,KAGtH65E,EAAa5nF,KAAK2nF,EAAuBx5D,YAI1Cy5D,CACX,EAEA3B,kBAAmB,SAAS9yE,GACxB,IAAI00E,EAAc,GACd/lE,EAAa+L,EAAK/L,WAClBsH,EAAO/pB,KAAK68C,aAAa9tC,IAkB7B,OAhBK+E,EAAKkpB,KAAK,GAAI,GAAG7K,WAAWpI,IAC7By+D,EAAY7nF,KAAK8hB,EAAWhD,MAG3B3L,EAAKkpB,MAAM,EAAG,GAAG7K,WAAWpI,IAC7By+D,EAAY7nF,KAAK8hB,EAAW1C,KAG3BjM,EAAKkpB,KAAK,EAAG,GAAG7K,WAAWpI,IAC5By+D,EAAY7nF,KAAK8hB,EAAW9C,OAG3B7L,EAAKkpB,KAAK,EAAG,GAAG7K,WAAWpI,IAC5By+D,EAAY7nF,KAAK8hB,EAAWzC,QAGzBwoE,CACX,EAEAvJ,WAAY,SAASlwE,GACjB,OAAO/O,KAAK89B,MAAMohD,kBAAkBnwE,EAAIE,cAAc+tE,QAAQh9E,KAAK68C,aAAa4rC,gBAAiBzoF,KAAK68C,aAAa6rC,cACvH,EAEAN,wBAAyB,SAAS10E,EAAK2B,EAAKs7D,GACxC,IACIiP,EADO5/E,KACQ89B,MACf9uB,EAFOhP,KAEMqP,OACbN,EAAMC,EAAMnB,MAAM6F,EAAK2B,GAAKxG,KAC5B+oE,EAAagI,EAAQyB,iBAAiBtyE,GACtCw7C,EAAaq1B,EAAQ5nE,QAAQqnE,OAAS,EAAI1O,EAASpmB,WAEvD,GAAIqtB,EAAWj4D,MA79DC,GA69D2B4qC,GAAcl1C,EAAM,IAAMrG,EAAM6I,gBACvE,OAAO,CAEf,IAYJ5X,EAAMsN,YAAY4vE,KAAOA,EACzBl9E,EAAMsN,YAAYihB,KAAOA,EACzBvuB,EAAMsN,YAAY8sE,SAAWA,EAE7B74E,EAAEpB,QAAO,EAAM+8E,EAAM,CAAE16D,WAAY22D,IACnC53E,EAAEpB,QAAO,EAAMouB,EAAM,CAAE/L,WAAY64D,GAEtC,CAz/DD,CAy/DG75E,OAAOxB,OAEV,SAAUA,GAEN,aAIA,IAAIuB,EAAIvB,EAAMwF,OAEVkjF,EAAU,CAAC,EAEXC,EAAiB3oF,EAAMsN,YAAYq7E,eAAiB,SAAS18E,EAAMilE,GACnEwX,EAAQz8E,GAAQilE,CACpB,EAEAlxE,EAAMsN,YAAYuvC,MAAM9pC,UAAUgtE,uBAAyB,WACvD,IAAIlsE,EAAO9T,KAAKmX,aAAaub,QAE7B,GAAI1yB,KAAK6N,MAAMiG,GAAMZ,SAAU,CAC3B,IAEIi+D,EAFA1mD,EAAMzqB,KAAKghB,WAAWlN,GACtB7R,EAAMjC,KAAK6c,YAAYpa,IAAI,SAAUzC,KAAK89B,MAAMoiB,aAAapsC,IAejE,OAZW,MAAP7R,EACAkvE,EAASwX,EAAQ1mF,GAEZwoB,GAAOA,EAAIsvB,aAChB93C,EAAM,eAAiBwoB,EAAIivB,SAC3By3B,EAASwX,EAAQ1mF,IAGA,mBAAVkvE,IACPA,EAASwX,EAAQ1mF,GAAOkvE,KAGrBA,CACX,CACJ,EAEAyX,EAAe,oBAAoB,WAC/B,IAAI16D,EAAS6G,EAAUhM,EA0BvB,SAASK,IAvBA2L,IACDA,EAAWvzB,EAAE,SAASqnF,gBACtB9/D,EAAQvnB,EAAE,SAASsnF,aACnB/zD,EAAS/R,SAAS+F,GAClBgM,EAAWA,EAASg0D,mBACpBhgE,EAAQA,EAAMigE,gBAEdj0D,EAAS7lB,KAAK,UAAU,WACpB6Z,EAAMC,QACN,IAAIktB,EAAOnhB,EAAS7yB,QACfgsB,EAAQrgB,MAAMyH,UACf4Y,EAAQrgB,MAAMyH,OAAO,cAEzB4Y,EAAQtf,SAAS3O,EAAMsN,YAAYsnB,aAAaqhB,GACpD,KAEJntB,EAAMkgE,WAAW,CACb9/D,OAAQ+E,EAAQnE,KAAK3L,QAAQwkB,KAAK,gCAClCtmB,OAAQ4R,EAAQuzD,UAAY,eAAiB,cAC7C31D,SAAUoC,EAAQuzD,UAAY,YAAc,aAOhD,IAAIvrC,EAAOhoB,EAAQrgB,MAAM3L,QACrB8M,EAAQkf,EAAQrgB,MAAMmB,QACd,MAARknC,EACAnhB,EAAS7yB,MAAMjC,EAAMsN,YAAY68B,aAAa8L,IAE9CnhB,EAAS7yB,MAAM,MAEnB,IAAIuoB,EAAMyD,EAAQlN,WAClB,GAAIyJ,EAAK,CACL,IAAI/Z,EAAMzQ,EAAMqiB,GAAG4mE,SAAS3oF,GAAGD,QAAQoQ,IACnCkK,EAAM3a,EAAMqiB,GAAG4mE,SAAS3oF,GAAGD,QAAQsa,IACnCuuE,EAAiB1+D,EAAI+uB,KACrB4vC,EAAe3+D,EAAIgvB,GACnBxjB,EAAUh2B,EAAMsN,YAAYkH,KAAKuS,QAAQ0lB,QAEzC,2BAA2BzkC,KAAKwiB,EAAIkvB,gBAEhCjpC,EADDy4E,aAA0BlzD,GAAWozD,EAAkBF,EAAejnF,OAC/DjC,EAAMsN,YAAY68B,aAAap7B,EAAMnB,MAAMs7E,EAAejnF,MAAMwR,IAAKy1E,EAAejnF,MAAMmT,KAAKnT,SAE/FjC,EAAMsN,YAAY68B,aAAa++C,EAAejnF,QAGpC,WAApBuoB,EAAIkvB,eAEA/+B,EADDwuE,aAAwBnzD,GAAWozD,EAAkBD,EAAalnF,OAC3DjC,EAAMsN,YAAY68B,aAAap7B,EAAMnB,MAAMu7E,EAAalnF,MAAMwR,IAAK01E,EAAalnF,MAAMmT,KAAKnT,SAE3FjC,EAAMsN,YAAY68B,aAAa3f,EAAIgvB,GAAGv3C,QAG5B,YAApBuoB,EAAIkvB,cAAkD,qBAApBlvB,EAAIkvB,eAElC/+B,EADDuuE,aAA0BlzD,GAAWozD,EAAkBF,EAAejnF,OAC/DjC,EAAMsN,YAAY68B,aAAap7B,EAAMnB,MAAMs7E,EAAejnF,MAAMwR,IAAKy1E,EAAejnF,MAAMmT,KAAKnT,SAE/FjC,EAAMsN,YAAY68B,aAAa3f,EAAI+uB,KAAKt3C,QAGtD6yB,EAASk0D,WAAW,CAChBK,aAAc,SAASpzC,GACnB,IAAIsD,EAAMC,EAeV,OAZID,EADD2vC,GAAkBA,aAA0BlzD,GAAWozD,EAAkBF,EAAejnF,OAChF8M,EAAMnB,MAAMs7E,EAAejnF,MAAMwR,IAAKy1E,EAAejnF,MAAMmT,KAAKnT,QAEhEinF,EAAsC,EAArBA,EAAejnF,MAAU,EAIjDu3C,EADD2vC,GAAgBA,aAAwBnzD,GAAWozD,EAAkBD,EAAalnF,OAC5E8M,EAAMnB,MAAMu7E,EAAalnF,MAAMwR,IAAK01E,EAAalnF,MAAMmT,KAAKnT,QAE5DknF,EAAkC,EAAnBA,EAAalnF,MAAU,EAG/Cg0C,EAA8C,EAAvCj2C,EAAMsN,YAAYsnB,aAAaqhB,IAC9Bj2C,EAAMsN,YAAYyT,WACrBy6B,oBAAoBhxB,EAAIkvB,cAAczD,EAAMsD,EAAMC,EAC3D,EACA/oC,IAAKA,EACLkK,IAAKA,GAEb,MACIma,EAASk0D,WAAW,CAAEK,aAAc,KAAM54E,IAAK,KAAMkK,IAAK,OAE9DmO,EAAMK,MACV,CAEA,SAASigE,EAAkBnnF,GACvB,OAAQA,GAAuB,OAAdA,EAAMwR,KAA8B,OAAdxR,EAAMmT,KAAgBnT,EAAMwR,KAAO,GAAKxR,EAAMmT,KAAO,CAChG,CAEA,MAAO,CACHmsE,KAAM,SAASlhF,GACX4tB,EAAU5tB,EACV8oB,GACJ,EACAzG,KAAM,WAEd,IAEAimE,EAAe,oBAAoB,WAC/B,IAAI16D,EAAS3G,EAAMwB,EA2BnB,SAASK,IAzBA7B,IACDA,EAAO/lB,EAAE,gCAAgC+nF,gBAAgB,CACrDnhE,SAAa,WACbL,YAAa,EACbD,UAAa,IAEjBiB,EAAQvnB,EAAE,0CAA0CsnF,aACpDvhE,EAAKvE,SAAS+F,GACdA,EAAQA,EAAMigE,iBACdzhE,EAAOA,EAAKiiE,sBAEPt6E,KAAK,UAAU,WAChB6Z,EAAMC,QACN,IAAI+kC,EAAOxmC,EAAKrlB,QAAQ,GACpB6rD,GACA7/B,EAAQtf,SAASm/C,EAAK7rD,MAE9B,KAEJ6mB,EAAMkgE,WAAW,CACb9/D,OAAQ+E,EAAQnE,KAAK3L,QAAQwkB,KAAK,gCAClCtmB,OAAQ4R,EAAQuzD,UAAY,eAAiB,cAC7C31D,SAAUoC,EAAQuzD,UAAY,YAAc,aAKhD,IAAI1nB,EAAQ7rC,EAAQlN,WAAWw4B,KAAKt3C,MAChCsI,EAAO,GAAIukC,EAAM,SAASjoB,GAAKtc,EAAK7J,KAAK,CAAEuB,MAAO4kB,GAAO,EACzDizC,aAAiB95D,EAAMsN,YAAYkH,KAAKuS,QAAQsgB,OAChDyyB,EAAMvsB,KAAKuB,IAIVgrB,EAAM,IAAI9zD,MAAM,WAAW6I,QAAQigC,GAExC,IAAI7mB,EAAa,IAAIjoB,EAAMuK,KAAK4c,WAAW,CAAE5c,KAAMA,IACnD+c,EAAK43B,cAAcj3B,GACnBA,EAAWuhE,OACX1gE,EAAMK,MACV,CACA,MAAO,CACHo4D,KAAM,SAASlhF,GACX4tB,EAAU5tB,EACV8oB,GACJ,EACAzG,KAAM,iBAEd,GAEH,CAvMD,CAuMGlhB,OAAOxB,OAEV,SAAUA,GAIN,IAAI09B,EAAU19B,EAAMsN,YAAYowB,QAC5B3jB,EAAW/Z,EAAMsN,YAAYyM,SAC7BlB,EAAW7Y,EAAMsN,YAAYuL,SAE7BsuC,EAAYnnD,EAAM0B,MAAMvB,OAAO,CAC/BC,KAAM,SAAmBof,EAAMM,EAAK5b,EAAOC,GACvCpE,KAAKyf,KAAOA,EACZzf,KAAK+f,IAAMA,EACX/f,KAAKmE,MAAQA,EACbnE,KAAKoE,OAASA,EACdpE,KAAK2f,MAAQ3f,KAAKyf,KAAOzf,KAAKmE,MAC9BnE,KAAKggB,OAAShgB,KAAK+f,IAAM/f,KAAKoE,MAClC,EAEA44E,OAAQ,SAASv9D,EAAMM,GACnB,OAAO,IAAIqnC,EAAUpnD,KAAKyf,KAAOA,EAAMzf,KAAK+f,IAAMA,EAAK/f,KAAKmE,MAAOnE,KAAKoE,OAC5E,EAEAuW,OAAQ,SAASxW,EAAOC,GACpB,OAAO,IAAIgjD,EAAUpnD,KAAKyf,KAAMzf,KAAK+f,IAAK/f,KAAKmE,MAAQA,EAAOnE,KAAKoE,OAASA,EAChF,EAEA+tB,WAAY,SAAS1rB,EAAGqqB,GACpB,OAAIrqB,aAAa2gD,EACNpnD,KAAK0pF,eAAejjF,GAExBzG,KAAKyf,KAAOhZ,GAAKA,EAAIzG,KAAKyf,KAAOzf,KAAKmE,OACtCnE,KAAK+f,IAAM+Q,GAAKA,EAAI9wB,KAAK+f,IAAM/f,KAAKoE,MAC/C,EAEAslF,eAAgB,SAASxvE,GACrB,IAAI5O,EAAItL,KACR,OAAOsL,EAAEmU,MAAQvF,EAAEyF,OACZzF,EAAEuF,MAAQnU,EAAEqU,OACZrU,EAAEyU,KAAO7F,EAAE8F,QACX9F,EAAE6F,KAAOzU,EAAE0U,MACtB,EAEAmnE,MAAO,SAASrhD,GACZ,OAAO7lC,EAAM6nD,IAAI1pC,QAAQ,MAAO,CAC5B0nB,UAAWA,EACXhiC,MAAO,CACHK,MAAQnE,KAAKmE,MAAQ,KACrBC,OAAQpE,KAAKoE,OAAS,KACtB2b,IAAQ/f,KAAK+f,IAAM,KACnBN,KAAQzf,KAAKyf,KAAO,OAGhC,IAgBAi+B,EAAOz9C,EAAM0B,MAAMvB,OAAO,CAC1BC,KAAM,SAAS0X,EAAMC,EAAS0d,EAAUC,EAAaqnB,EAAcC,GAC/Dj9C,KAAK01B,SAAWA,EAChB11B,KAAK21B,YAAcA,EACnB31B,KAAK0a,SAAW1C,EAChBhY,KAAKwa,MAAQzC,EACb/X,KAAK0/E,cAAgB1iC,EACrBh9C,KAAKo/E,aAAeniC,CACxB,EAEA/mB,QAAS,SAASC,EAAUC,GACxBp2B,KAAK01B,SAAWS,EAChBn2B,KAAK21B,YAAcS,CACvB,EAEA+tB,OAAQ,SAASp1C,GAEb,IAAI8B,GADJ9B,EAAMA,EAAIE,cACQ4B,QACd0J,EAAcxL,EAAIwL,YACtB,OAAwB,IAAhB1J,EAAQ6C,KAAa6G,EAAY7G,MAAQ1T,KAAK01B,SAAW,GAAuB,IAAhB7kB,EAAQwE,KAAakF,EAAYlF,MAAQrV,KAAK21B,YAAc,CACxI,EAEAxxB,MAAO,SAAS4tB,EAAOvM,GACnB,OAAOxlB,KAAK0a,SAASoyB,IAAI/a,EAAOvM,EACpC,EAEAphB,OAAQ,SAAS2tB,EAAOvM,GACpB,OAAOxlB,KAAKwa,MAAMsyB,IAAI/a,EAAOvM,EACjC,EAEAk7D,YAAa,WACT,OAAO1gF,KAAKwa,MAAMmvE,MAAQ3pF,KAAK0/E,aACnC,EAEAiB,WAAY,WACR,OAAO3gF,KAAK0a,SAASivE,MAAQ3pF,KAAKo/E,YACtC,EAEA10E,MAAO,SAASgJ,EAAK4J,GACjB,OAAOA,EAAStd,KAAK01B,SAAWhiB,CACpC,EAEAutC,QAAS,SAASv2C,GACd,OAAO,IAAIizB,EAAQjzB,EAAQ1K,KAAK01B,SAAWhrB,EAAQ1K,KAAK01B,UAAa,EACzE,EAEA4K,OAAQ,SAAS5sB,GACb,OAAO,IAAIsG,EAAS,IAAI2jB,EAAQjqB,EAAK,GAAI,IAAIiqB,EAAQjqB,EAAK1T,KAAK21B,YAAc,GACjF,EAEA4K,OAAQ,SAASlrB,GACb,OAAO,IAAI2E,EAAS,IAAI2jB,EAAQ,EAAGtoB,GAAM,IAAIsoB,EAAQ39B,KAAK01B,SAAW,EAAGrgB,GAC5E,EAEA6qC,aAAc,SAASnxC,GACnB,OAAO/O,KAAK0K,MAAMqE,EAAI2E,IAAK3E,EAAIsG,IACnC,EAEAqlB,UAAW,SAAS3rB,GAChB,OAAIA,aAAeiL,EACR,IAAIA,EACPha,KAAK06B,UAAU3rB,EAAI8B,SACnB7Q,KAAK06B,UAAU3rB,EAAIwL,cACrBiT,SAASze,EAAIC,MAAOD,EAAIipB,YAG1BjpB,aAAe+J,EACR/J,EAAI5M,KAAI,SAAS4M,GACpB,OAAO/O,KAAK06B,UAAU3rB,EAC1B,GAAG/O,OAGH+O,aAAe4uB,KACf5uB,EAAMA,EAAIU,SACN4F,IAAM5E,KAAKmK,IAAI,EAAGnK,KAAKC,IAAI1Q,KAAK21B,YAAc,EAAG5mB,EAAIsG,MACzDtG,EAAI2E,IAAMjD,KAAKmK,IAAI,EAAGnK,KAAKC,IAAI1Q,KAAK01B,SAAW,EAAG3mB,EAAI2E,OAGnD3E,EACX,EAEA4d,UAAW,SAAS5d,GAChB,IAAI8B,EAAU7Q,KAAK06B,UAAU3rB,EAAI8B,SAC7B0J,EAAcva,KAAK06B,UAAU3rB,EAAIwL,aACrC,OAAO,IAAI6sC,EACPpnD,KAAKmE,MAAM,EAAG0M,EAAQwE,IAAM,GAC5BrV,KAAKoE,OAAO,EAAGyM,EAAQ6C,IAAM,GAC7B1T,KAAKmE,MAAM0M,EAAQwE,IAAKkF,EAAYlF,KACpCrV,KAAKoE,OAAOyM,EAAQ6C,IAAK6G,EAAY7G,KAE7C,EAEAkpC,KAAM,SAASt8C,GACX,OAAO,IAAIspF,EACP,IAAI3pF,EAAMsN,YAAYs8E,SAAS7pF,KAAKwa,MAAOla,EAAQoT,IAAKpT,EAAQo1B,SAAU11B,KAAK0/E,eAC/E,IAAIz/E,EAAMsN,YAAYs8E,SAAS7pF,KAAK0a,SAAUpa,EAAQgd,OAAQhd,EAAQq1B,YAAa31B,KAAKo/E,cACxFp/E,KAER,EAEAqjF,gBAAiB,SAASyG,GACtB,MAAO,CACH/xE,KAAM/X,KAAKwa,MAAMrT,OAAOwsB,SAASm2D,EAASj5E,QAAQ6C,IAAKo2E,EAASvvE,YAAY7G,KAC5EsE,QAAShY,KAAK0a,SAASvT,OAAOwsB,SAASm2D,EAASj5E,QAAQwE,IAAKy0E,EAASvvE,YAAYlF,KAE1F,EAEAvG,QAAS,SAASC,EAAKH,GAInB,IAHA,IAAIiC,EAAU7Q,KAAK06B,UAAU3rB,EAAI8B,SAC7B0J,EAAcva,KAAK06B,UAAU3rB,EAAIwL,aAE5BusB,EAAKj2B,EAAQwE,IAAKyxB,GAAMvsB,EAAYlF,IAAKyxB,IAC9C,IAAK,IAAID,EAAKh2B,EAAQ6C,IAAKmzB,GAAMtsB,EAAY7G,IAAKmzB,IAC9Cj4B,EAAS,IAAI+uB,EAAQkJ,EAAIC,GAGrC,EAEAsd,KAAM,SAASr1C,EAAKpB,GAMhB,IALA,IAAIkD,EAAU7Q,KAAK06B,UAAU3rB,EAAI8B,SAC7B0J,EAAcva,KAAK06B,UAAU3rB,EAAIwL,aACjCoiB,EAAiB9rB,EAAQ6C,IACzBkpB,EAAiB/rB,EAAQwE,IAEpByxB,EAAKj2B,EAAQwE,IAAKyxB,GAAMvsB,EAAYlF,IAAKyxB,IAAO,CACrD,IAAI/U,EAAQ/xB,KAAK0K,MAAMmG,EAAQ6C,IAAKozB,GAChCthB,EAAMxlB,KAAK0K,MAAM6P,EAAY7G,IAAKozB,GAClC3/B,EAASwG,EAAS8kB,KAAKF,aAAaR,EAAOvM,GAC/C,GAAGre,EAAO9F,OAAQ,CACd,IAAIyS,EAAO9T,KAAKihD,QAAQ95C,EAAOA,EAAO9F,OAAS,GAAGmkB,KAClDmX,EAAiBlsB,KAAKmK,IAAI+hB,EAAgB7oB,EAAKJ,KAC/CkpB,EAAiBkK,CACrB,CACJ,CACA,OAAO,IAAI9sB,EAASjL,EAAI8B,QAAS,IAAI8sB,EAAQltB,KAAKC,IAAIisB,EAAgB5tB,EAAIwL,YAAY7G,KAAMkpB,GAChG,IAGAgtD,EAAW3pF,EAAM0B,MAAMvB,OAAO,CAC9BC,KAAM,SAAS0X,EAAMC,EAAS6lB,GAC1B79B,KAAK+X,KAAOA,EACZ/X,KAAKgY,QAAUA,EACfhY,KAAK89B,MAAQD,EAEb79B,KAAKg9C,aAAejlC,EAAKgyE,WACzB/pF,KAAKi9C,YAAcjlC,EAAQ+xE,WAC3B/pF,KAAK0lF,aAAe1tE,EAAQgyE,UAC5BhqF,KAAK4lF,gBAAkB7tE,EAAKiyE,SAChC,EAEAhgB,QAAS,SAAS7lE,EAAOC,GACrBpE,KAAKgY,QAAQuhE,SAASp1E,GACtBnE,KAAK+X,KAAKwhE,SAASn1E,GAEnB,IAAIqC,EAAIzG,KAAKgY,QAAQiyE,cACjBn5D,EAAI9wB,KAAK+X,KAAKkyE,cAElBjqF,KAAKyf,KAAOhZ,EAAEu2E,OACdh9E,KAAK+f,IAAM+Q,EAAEksD,OACbh9E,KAAK2f,MAAQlZ,EAAEu2E,OAASv2E,EAAEpF,OAC1BrB,KAAKggB,OAAS8Q,EAAEksD,OAASlsD,EAAEzvB,OAE3BrB,KAAK8D,MAAQ,CACTic,IAAK+Q,EAAEksD,OAAU,KACjBv9D,KAAMhZ,EAAEu2E,OAAS,KACjB54E,OAAQ0sB,EAAEzvB,OAAS,KACnB8C,MAAOsC,EAAEpF,OAAS,KAE1B,EAEA0oB,KAAM,SAAStK,EAAMM,GACjB,IAAIhI,EAAO/X,KAAK+X,KAAKiS,QAAQjK,GACzB/H,EAAUhY,KAAKgY,QAAQgS,QAAQvK,GAEnC,MAAO,CACH1H,KAAMA,EACNC,QAASA,EAET6pD,UAAW9pD,EAAKilE,OAChB6I,aAAc7tE,EAAQglE,OAEtByL,eAAgBzwE,EAAQ+Z,MACxB22D,cAAe3wE,EAAKga,MAEpBhjB,IAAK,IAAIiL,EACL,IAAI2jB,EAAQ5lB,EAAK5Q,OAAO4qB,MAAO/Z,EAAQ7Q,OAAO4qB,OAC9C,IAAI4L,EAAQ5lB,EAAK5Q,OAAOqe,IAAKxN,EAAQ7Q,OAAOqe,MAGxD,EAEAqV,SAAU,SAAS9rB,GACf,OAAO/O,KAAK+X,KAAK8iB,SAAS9rB,EAAI8B,QAAQ6C,IAAK3E,EAAIwL,YAAY7G,MACvD1T,KAAKgY,QAAQ6iB,SAAS9rB,EAAI8B,QAAQwE,IAAKtG,EAAIwL,YAAYlF,IAC/D,EAEA3K,MAAO,SAASgJ,EAAK4J,GACjB,OAAOtd,KAAK89B,MAAMpzB,MAAMgJ,EAAK4J,EACjC,EAEA4hE,kBAAmB,SAASnwE,GACxB,OAAO/O,KAAK89B,MAAMnR,UAAU5d,EAChC,EAEAmxC,aAAc,SAASnxC,GACnB,OAAO/O,KAAK89B,MAAMoiB,aAAanxC,EACnC,EAEAsyE,iBAAkB,SAASvtE,GACvB,IAAIgY,EAAW9rB,KAAKk/E,kBAAkBprE,GAElC8jE,EAAa,CACb73D,IAAKtP,KAAKmK,IAAI,EAAGkR,EAAS/L,IAAM/f,KAAK+f,KAAO/f,KAAK4lF,gBAAkB,EAAI5lF,KAAKg9C,eAC5Ev9B,KAAMhP,KAAKmK,IAAI,EAAGkR,EAASrM,KAAOzf,KAAKyf,MAAQzf,KAAK0lF,aAAe,EAAI1lF,KAAKi9C,cAC5Et9B,MAAOmM,EAASnM,MAAQ3f,KAAKgY,QAAQkyE,UAAYlqF,KAAKi9C,YACtDj9B,OAAQ8L,EAAS9L,OAAShgB,KAAK+X,KAAKmyE,UAAYlqF,KAAKg9C,cAGrDmtC,EAAoBnqF,KAAKgY,QAAQoyE,aAAe,EAChDC,EAAqBrqF,KAAK+X,KAAKqyE,aAAe,EAOlD,OALAxS,EAAW1B,UAAY0B,EAAW73D,IAAMsqE,EACxCzS,EAAW0J,aAAe1J,EAAW53D,OAASqqE,EAE9CzS,EAAWrtB,WAAaqtB,EAAWn4D,KAAO0qE,EAC1CvS,EAAWP,YAAcO,EAAWj4D,MAAQwqE,EACrCvS,CACX,IAGJ33E,EAAMsN,YAAYmwC,KAAOA,EACzBz9C,EAAMsN,YAAYq8E,SAAWA,EAC7B3pF,EAAMsN,YAAY65C,UAAYA,CACjC,CA7SD,CA6SGnnD,OAEH,SAAUA,GAEN,IAAIk9C,EAAOl9C,EAAM0B,MAAMvB,OAAO,CAC1BC,KAAM,SAASggB,EAAOne,GAClBlC,KAAKiS,OAAS/P,EACdlC,KAAKya,OAAS4F,EACdrgB,KAAKmH,OAAS,IAAIlH,EAAMsN,YAAYqlB,UAAU,EAAGvS,EAAQ,EAAGne,GAC5DlC,KAAKsqF,QAAU,IAAIrqF,EAAMsN,YAAYqlB,UAAU,EAAGvS,EAAQ,EAAG,GAE7DrgB,KAAKuqF,cAAgBtqF,EAAMqb,QAAQmnE,YACnCziF,KAAKmmD,UACT,EAEAjwB,QAAS,SAAS7V,GACVA,EAAQrgB,KAAKya,QACbza,KAAKmH,OAAOjF,MAAMlC,KAAKya,OAAQ4F,EAAQ,EAAGrgB,KAAKiS,QAC/CjS,KAAKsqF,QAAQpoF,MAAMlC,KAAKya,OAAQ4F,EAAQ,EAAG,IACpCA,EAAQrgB,KAAKya,SACpBza,KAAKmH,OAAOjF,MAAMme,EAAOrgB,KAAKya,OAAS,EAAG,GAC1Cza,KAAKsqF,QAAQpoF,MAAMme,EAAOrgB,KAAKya,OAAS,EAAG,IAE/Cza,KAAKya,OAAS4F,EACdrgB,KAAKmmD,UACT,EAEAhuB,OAAQ,SAASpG,EAAO9c,GAEhBA,EAAQ,GAERjV,KAAKmH,OAAO8U,KAAK8V,EAAQ9c,EAAOjV,KAAKya,OAAS,EAAGsX,GACjD/xB,KAAKsqF,QAAQruE,KAAK8V,EAAQ9c,EAAOjV,KAAKya,OAAS,EAAGsX,KAIlD/xB,KAAKmH,OAAO8U,KAAK8V,EAAO/xB,KAAKya,OAAQsX,EAAQ9c,GAC7CjV,KAAKsqF,QAAQruE,KAAK8V,EAAO/xB,KAAKya,OAAQsX,EAAQ9c,GAC9CjV,KAAKmH,OAAOjF,MAAM6vB,EAAOA,EAAQ9c,EAAQ,EAAGjV,KAAKiS,QACjDjS,KAAKsqF,QAAQpoF,MAAM6vB,EAAOA,EAAQ9c,EAAQ,EAAG,IAEjDjV,KAAKmmD,UACT,EAEAtyB,OAAQ,SAASrH,EAAO24B,GAKpB,IAJA,IAAIh+C,EAAS,GAETwsB,EAAW3zB,KAAKmH,OAAOwsB,SAAS,EAAG3zB,KAAKya,OAAS,GAE5CywC,EAAM,EAAGA,EAAMlrD,KAAKya,OAAQywC,IAAO,CACxC,IAAIhpD,EAAQyxB,EAASK,GAAGk3B,GACpB5mB,EAAStkC,KAAKsqF,QAAQpoF,MAAMgpD,EAAKA,GAErC,GAAIhpD,IAAUlC,KAAKiS,QAAWqyB,EAA9B,CAIA,IAAIxY,EAAWq5B,EAAU+F,GAEzB,QAAiBp+C,IAAbgf,EAAwB,CACxBA,EAAW3kB,EAAO9F,OAElB,IAAI0sD,EAAO,CAAErjD,MAAOwgD,GAEpB6C,EAAKvhC,GAAStqB,EACVoiC,IACAypB,EAAKzpB,OAASA,GAGlBn9B,EAAOxG,KAAKotD,GAEZ5I,EAAU+F,GAAOp/B,CACrB,CAjBA,CAkBJ,CAEA,OAAO3kB,CACX,EAEA2sB,SAAU,SAAStH,EAAOrlB,GACtB,IAAK,IAAI+jD,EAAM,EAAGA,EAAM/jD,EAAO9F,OAAQ6pD,IAAO,CAC1C,IAAIpkC,EAAK3f,EAAO+jD,GAEZxgD,EAAQoc,EAAGpc,WACDoC,IAAVpC,IACAA,EAAQwgD,GAQZ,IAAIhpD,EAAQ4kB,EAAG0F,GAED,IAAVtqB,GACAlC,KAAKsqF,QAAQpoF,MAAMwI,EAAOA,EAAOoc,EAAGwd,QAAUtkC,KAAKiS,QACnDjS,KAAKkC,MAAMwI,EAAOA,EAAO,IAEzB1K,KAAKkC,MAAMwI,EAAOA,EAAOxI,EAEjC,CACJ,EAEAwqB,KAAM,SAAShiB,GACX,IAAK1K,KAAKskC,OAAO55B,GAAQ,CACrB,IAAIxI,EAAQlC,KAAKkC,MAAMwI,EAAOA,GAC9B1K,KAAKsqF,QAAQpoF,MAAMwI,EAAOA,EAAOxI,GACjClC,KAAKkC,MAAMwI,EAAOA,EAAO,EAC7B,CACJ,EAEA45B,OAAQ,SAAS55B,GACb,OAA4C,IAArC1K,KAAKsqF,QAAQpoF,MAAMwI,EAAOA,EACrC,EAEAi6B,eAAgB,SAAS5S,EAAOvM,GAC3B,OAAOxlB,KAAKsqF,QAAQ/3D,aAAaR,EAAOvM,GAAKnkB,OAAS,CAC3D,EAEA49B,YAAa,SAASv0B,GAElB,IADA,IAAI8a,EAAMxlB,KAAKya,OAAS,EAAGlX,EAAImH,IACtBnH,GAAKiiB,GACV,IAAKxlB,KAAKskC,OAAO/gC,GACb,OAAOA,EAGf,OAAOmH,CACX,EAEA+2B,UAAW,SAAS/2B,EAAOW,GAEvB,IADA,IAAIma,EAAMxlB,KAAKya,OAAS,EAAGlX,EAAImH,EAAO25B,GAAW,IACxC9gC,GAAKiiB,GAAK,CACf,IAAIiF,EAAMpf,EAAK9H,EAAG8gC,EAAUrkC,KAAKskC,OAAO/gC,IACxC,GAAkB,iBAAPknB,EACP,OAAOA,EACJ,GAAIA,EACP,MAEJ4Z,GAAW,CACf,CACA,OAAO9gC,EAAI,CACf,EAEA+9B,SAAU,SAAS52B,EAAO8/E,GACtB,OAAOxqF,KAAK0K,MAAM1K,KAAK8sC,IAAI,EAAGpiC,EAAQ,GAAK8/E,EAC/C,EAEAnpD,SAAU,SAAS32B,EAAO8/E,GACtB,OAAOxqF,KAAK0K,MAAM1K,KAAK8sC,IAAI,EAAGpiC,GAAS8/E,EAC3C,EAEAjpD,aAAc,WACV,IAAIkpD,EAAczqF,KAAKsqF,QAAQ53D,QAC/B,OAA0B,IAAtB+3D,EAAYvoF,MACL,EAEAuoF,EAAYjlE,IAAM,CAEjC,EAEAgc,YAAa,WACT,IAAIkpD,EAAa1qF,KAAKsqF,QAAQ33D,OAC9B,OAAyB,IAArB+3D,EAAWxoF,MACJlC,KAAKya,OAAS,EAEdiwE,EAAW34D,MAAQ,CAElC,EAEAgN,YAAa,SAASr0B,GAElB,IADA,IAAInH,EAAImH,IACCnH,GAAK,GACV,IAAKvD,KAAKskC,OAAO/gC,GACb,OAAOA,EAGf,OAAOmH,CACX,EAEAi3B,UAAW,SAASj3B,EAAOW,GAEvB,IADA,IAAI9H,EAAImH,EAAO25B,GAAW,IACjB9gC,GAAK,GAAG,CACb,IAAIknB,EAAMpf,EAAK9H,EAAG8gC,EAAUrkC,KAAKskC,OAAO/gC,IACxC,GAAkB,iBAAPknB,EACP,OAAOA,EACJ,GAAIA,EACP,MAEJ4Z,GAAW,CACf,CACA,OAAO9gC,EAAI,CACf,EAEAg8C,OAAQ,SAAS70C,GACb,GAAI1K,KAAKskC,OAAO55B,GAAQ,CACpB,IAAIxI,EAAQlC,KAAKsqF,QAAQpoF,MAAMwI,EAAOA,GACtC1K,KAAKsqF,QAAQpoF,MAAMwI,EAAOA,EAAO,GACjC1K,KAAKkC,MAAMwI,EAAOA,EAAOxI,EAC7B,CACJ,EAEAA,MAAO,SAAS6vB,EAAOvM,EAAKtjB,GACxB,QAAc4K,IAAV5K,EAIA,OAAOlC,KAAKmH,OAAOwsB,SAAS5B,EAAOvM,GAAKwO,GAAG,GAH3Ch0B,KAAKmH,OAAOjF,MAAM6vB,EAAOvM,EAAKtjB,GAC9BlC,KAAKmmD,UAIb,EAEArZ,IAAK,SAAS/a,EAAOvM,GAKjB,IAJA,IAAIre,EAASnH,KAAKmH,OAAOwsB,SAAS5B,EAAOvM,GAErCsnB,EAAM,EAEDoe,EAAMn5B,EAAOm5B,GAAO1lC,EAAK0lC,IAC9Bpe,GAAO3lC,EAAO6sB,GAAGk3B,GAGrB,OAAOpe,CACX,EAEAwyC,OAAQ,SAASvtD,EAAOvM,EAAK+nB,GAGzB,IAFA,IAAIpmC,EAASnH,KAAKmH,OAAOwsB,SAAS5B,EAAOvM,GACrCsnB,EAAM,EACDoe,EAAMn5B,EAAOm5B,GAAO1lC,EAAK0lC,IAAO,CAGrC,GADU3d,EADVT,GAAO3lC,EAAO6sB,GAAGk3B,IAGb,OAAOA,CAEf,CACA,OAAO,IACX,EAEAlhC,QAAS,SAAS+H,EAAOvM,GACrB,IAAImlE,EACAC,EACAC,GAAW,EAEXrlE,GAAOxlB,KAAK2pF,MAAQ3pF,KAAKuqF,gBACzBM,GAAW,GAGf,IAAIr4D,EAASxyB,KAAK8qF,aAAav4D,aAAaR,EAAOvM,GAKnD,GAHAmlE,EAAen4D,EAAO,GACtBo4D,EAAap4D,EAAOA,EAAOnxB,OAAS,IAE/BspF,EACD,MAAO,CAAExjF,OAAQnH,KAAKmH,OAAOwsB,SAAS,EAAG,GAAIqpD,OAAQ,GAGzD,IAAIz2D,EAAcwL,EAAQ44D,EAAa54D,MAEnCg5D,GAAexkE,EAAcokE,EAAazoF,MAAMA,OAAU,GAAKyoF,EAAazoF,MAAM6vB,MAElFirD,EAASz2D,GAAewkE,EAAaJ,EAAazoF,MAAM6vB,OAAS44D,EAAazoF,MAAMA,MAEpFskB,EAAYhB,EAAMolE,EAAW74D,MAC7Bi5D,GAAaxkE,EAAYokE,EAAW1oF,MAAMA,OAAU,GAAK0oF,EAAW1oF,MAAM6vB,MAY9E,OAVIi5D,EAAWJ,EAAW1oF,MAAMsjB,MAC5BwlE,EAAWJ,EAAW1oF,MAAMsjB,KAG5BqlE,IACA7N,GAAU4N,EAAW1oF,MAAMA,OAASskB,GAAawkE,EAAWJ,EAAW1oF,MAAM6vB,OAAS64D,EAAW1oF,MAAMA,QAG3G86E,EAASvsE,KAAKC,KAAKssE,EAAQ,GAEpB,CACH71E,OAAQnH,KAAKmH,OAAOwsB,SAASo3D,EAAYC,GACzChO,OAAQA,EAEhB,EAEAtyE,MAAO,SAASxI,GAKZ,IAJA,IAAIwI,EAAQ,EACRipB,EAAW3zB,KAAKmH,OAAOwsB,SAAS,EAAG3zB,KAAKya,OAAS,GACjDlV,EAAUouB,EAASK,GAAG,GAEnBzuB,EAAUrD,GAASwI,EAAQ1K,KAAKya,OAAS,GAC5ClV,GAAWouB,EAASK,KAAKtpB,GAG7B,OAAOA,CACX,EAEAg5C,aAAc,SAASxhD,GACnB,IAAIwI,EAAQ1K,KAAK0K,MAAMxI,GAIvB,OAHIlC,KAAKskC,OAAO55B,KACZA,EAAQ1K,KAAK++B,YAAYr0B,IAEtBA,CACX,EAEAy7C,SAAU,WACN,IAAI5gD,EAAU,EACdvF,KAAK8qF,aAAe9qF,KAAKmH,OAAOhF,KAAI,SAAS0L,GACzC,IAAIkkB,EAAQxsB,EAERigB,GADJjgB,IAAYsI,EAAM2X,IAAM3X,EAAMkkB,MAAQ,GAAKlkB,EAAM3L,OAC7B,EACpB,OAAO,IAAIjC,EAAMsN,YAAY6mB,WAAWrC,EAAOvM,EAAK3X,EACxD,IACA7N,KAAK2pF,MAAQpkF,CACjB,EAEA4I,SAAU,WACN,MAAO,CACHhH,OAAQnH,KAAKmH,OAAOgH,WACpBm2B,OAAQtkC,KAAKsqF,QAAQn8E,WACrBkS,MAAOrgB,KAAKya,OAEpB,EAEAvM,SAAU,SAASE,GACfpO,KAAKmH,OAAO+G,SAASE,EAAMjH,QAC3BnH,KAAKsqF,QAAQp8E,SAASE,EAAMk2B,QAC5B,IAAI2mD,EAAWjrF,KAAKya,OAChBwwE,EAAW78E,EAAMiS,OACjBrgB,KAAKya,OAASrM,EAAMiS,MACpBrgB,KAAKk2B,QAAQ+0D,IAEbjrF,KAAKmmD,UAEb,IAGA0jC,EAAW5pF,EAAM0B,MAAMvB,OAAO,CAC9BC,KAAM,SAASke,EAAMwT,EAAO1R,EAAO0pE,GAChC/pF,KAAKgoF,MAAQzpE,EACbve,KAAKsnF,OAASv1D,EACd/xB,KAAKya,OAAS4F,EACdrgB,KAAKgqF,UAAsB,IAAVj4D,EACjB/xB,KAAK+pF,WAAaA,EAClB/pF,KAAKoqF,aAAe7rE,EAAKtM,OACzBjS,KAAKq/E,OAASh/D,EAAQ,CACzB,EAEAk5D,SAAU,SAASA,GACfv5E,KAAKkqF,UAAY3Q,CACrB,EAEAzsC,IAAK,SAAS/a,EAAOvM,GACjB,OAAOxlB,KAAKgoF,MAAMl7C,IAAI/a,EAAOvM,EAAM,EACvC,EAEAuM,MAAO,WACH,OAAO/xB,KAAK8sC,IAAI,EAAG9sC,KAAKsnF,OAC5B,EAEA1lF,KAAM,WACF,OAAO5B,KAAK8sC,IAAI9sC,KAAKsnF,OAAQtnF,KAAKsnF,OAAStnF,KAAKya,OACpD,EAEA/P,MAAO,SAASxI,EAAO86E,GACnB,OAAOh9E,KAAKgoF,MAAMt9E,MAAMxI,GAASlC,KAAKq/E,OAAS,EAAIrC,GAAUh9E,KAAK+pF,WACtE,EAEArmC,aAAc,SAASxhD,EAAO86E,GAC1B,OAAOh9E,KAAKgoF,MAAMtkC,aAAaxhD,GAASlC,KAAKq/E,OAAS,EAAIrC,GAAUh9E,KAAK+pF,WAC7E,EAGAE,YAAa,WACT,IACI5oF,EADA27E,EAASh9E,KAAK+xB,QAkBlB,OAfK/xB,KAAKgqF,YACNhN,GAAUh9E,KAAK+pF,YAGf/pF,KAAKq/E,QACLh+E,EAASrB,KAAK4B,OACV5B,KAAKgqF,UACL3oF,GAAUrB,KAAK+pF,WAEf1oF,GAAUrB,KAAK+pF,YAGnB1oF,EAASrB,KAAKkqF,UAAYlN,EAGvB,CACHA,OAAQA,EACR37E,OAAQA,EAEhB,EAEA2oB,QAAS,SAASgzD,GACd,IACIp7E,EADAmwB,EAAQ/xB,KAAK+xB,QAGb/xB,KAAKq/E,QACLz9E,EAAO5B,KAAK4B,OACP5B,KAAKgqF,YACNpoF,GAAQ5B,KAAK+pF,cAGjBnoF,EAAO5B,KAAKkqF,UAAYn4D,EAAQ/xB,KAAK+pF,WACrCh4D,GAASirD,GAGb,IAAIj3E,EAAS/F,KAAKgoF,MAAMh+D,QAAQ+H,EAAOA,EAAQnwB,EAAO,GAatD,OAXI5B,KAAKq/E,SACLt5E,EAAOi3E,OAAS,GAGpBj3E,EAAOgsB,MAAQA,EAEX/xB,KAAKgqF,YACLjkF,EAAOi3E,QAAUh9E,KAAK+pF,WACtBhkF,EAAOgsB,OAAS/xB,KAAK+pF,YAGlBhkF,CACX,EAEA80B,SAAU,SAAS9I,EAAOvM,GACtB,OAAIxlB,KAAKq/E,SACDttD,EAAQ/xB,KAAKsnF,OAAStnF,KAAKya,WAG3B+K,EAAMxlB,KAAKsnF,QAKR9hE,GAAOxlB,KAAKsnF,MAE3B,IAGJrnF,EAAMsN,YAAY4vC,KAAOA,EACzBl9C,EAAMsN,YAAYs8E,SAAWA,CAEhC,CArbD,CAqbG5pF,OAEH,SAAUA,GAGN,IAAI+lD,EAAS/lD,EAAMsN,YAAYy4C,OAAS/lD,EAAM0B,MAAMvB,OAAO,CACvDsmD,QAAS,WACT,EACAxkD,MAAO,SAAS4R,GACZ,OAAOA,EAAK5R,KAChB,EACAykD,QAAS,WACL,MAAM,IAAIx7C,MAAM,2CACpB,EACA0oB,OAAQ,WACJ,MAAM,IAAI1oB,MAAM,0CACpB,IAwXJ,SAAS+/E,EAAQhpF,GACb,IAAI+zC,EAAQ/zC,EAAMy1C,WAAa,EAE/B,OAAI1B,GAAS,GAAKA,GAAS,EAChB,EACDA,GAAS,GAAKA,GAAS,EACtB,EACAA,GAAS,GAAKA,GAAS,EACvB,EAEA,CAEf,CAEA,SAASk1C,EAASjpF,EAAO86E,GACrB,GAAI96E,aAAiByD,KAAM,CACvB,IAAIylF,EAAQnrF,EAAMi2C,KAAKk1C,QAIvB,OAFAA,EAAMC,YAAYD,EAAM1zC,cAAgBslC,GAEjCoO,EAAM1zC,gBAAkBx1C,EAAMw1C,aACzC,CAEA,OAAO,CACX,CAEA,SAAS4zC,EAAUppF,EAAO86E,GACtB,GAAI96E,aAAiByD,KAAM,CACvB,IAAIylF,EAAQnrF,EAAMi2C,KAAKq1C,gBAAgBtrF,EAAMi2C,KAAKk1C,SAIlD,OAFAA,EAAMI,SAASJ,EAAMzzC,WAAaqlC,EAAQ,GAEnCoO,EAAMxlF,YAAc3F,EAAMi2C,KAAKq1C,gBAAgBrpF,GAAO0D,SACjE,CAEA,OAAO,CACX,CAEA,SAAS6lF,EAASngF,EAAG4O,GACjB,GAAIA,aAAavU,KAAM,CACnB,IAAI+lF,EAAYzrF,EAAMi2C,KAAKy1C,UAAU1rF,EAAMi2C,KAAK0B,QAAQtsC,GAAI,GAExDsgF,EAAa3rF,EAAMi2C,KAAKy1C,UAAU1rF,EAAMi2C,KAAK0B,QAAQ19B,GAAI,GAE7D,OAAOwxE,EAAU9lF,YAAcgmF,EAAWhmF,SAC9C,CAEA,OAAO,CACX,CAraAogD,EAAOt+C,OAAS,SAASpH,GACrB,IAAI6c,EAAS7c,EAAQ6c,OAErB,IAAKA,EACD,MAAM,IAAIhS,MAAM,8BAGpB,IAAI2nC,EAAc7yC,EAAMsN,YAAY4P,EAAOpW,OAAO,GAAGmgB,cAAgB/J,EAAOgS,UAAU,GAAK,UAE3F,IAAK2jB,EACD,MAAM,IAAI3nC,MAAM,+BAGpB,OAAO,IAAI2nC,EAAYxyC,EAC3B,EAEAL,EAAMsN,YAAYyQ,YAAcgoC,EAAO5lD,OAAO,CAC1CyrF,QAAS,GAETC,OAAQ,GAERC,SAAS,EAET1rF,KAAM,SAAqBC,QACAwM,IAAnBxM,EAAQ6G,SACRnH,KAAK6rF,QAAUvrF,EAAQ6G,aAGJ2F,IAAnBxM,EAAQk+D,SACRx+D,KAAK+rF,QAAUzrF,EAAQk+D,aAGL1xD,IAAlBxM,EAAQ0rF,QACRhsF,KAAK8rF,OAASxrF,EAAQ0rF,MAE9B,EAEA9pF,MAAO,SAAS4R,GACZ,IAAI5R,EAAQ4R,EAAK5R,MAEblC,KAAK8rF,OAAOzqF,OAAS,GAAKyS,EAAKwB,QAA2B,iBAAVpT,IAGnC,SAFFjC,EAAMsN,YAAY2H,WAAWxG,KAAKxM,EAAO4R,EAAKwB,UAGrDpT,EAAQjC,EAAMsN,YAAY68B,aAAaloC,KAI/C,OAAOA,CACX,EAEAykD,QAAS,SAASzkD,GACd,OAAIA,QACOlC,KAAK+rF,QAGZ7pF,aAAiByD,KACV3F,KAAK8rF,OAAO/wD,MAAK,SAASmb,GAC7B,QAAOA,EAAKF,OAAS9zC,EAAMw1C,oBACP5qC,IAAfopC,EAAKD,OAAuBC,EAAKD,QAAU/zC,EAAMy1C,iBACpC7qC,IAAbopC,EAAKC,KAAqBD,EAAKC,MAAQj0C,EAAM01C,gBAC9B9qC,IAAfopC,EAAKU,OAAuBV,EAAKU,QAAU10C,EAAMo1C,iBAChCxqC,IAAjBopC,EAAKW,SAAyBX,EAAKW,UAAY30C,EAAMq1C,mBACpCzqC,IAAjBopC,EAAKY,SAAyBZ,EAAKY,UAAY50C,EAAMs1C,aAC9D,IAGGx3C,KAAK6rF,QAAQt6E,QAAQrP,IAAU,CAC1C,EACA2xB,OAAQ,WACJ,MAAO,CACH1W,OAAQ,QACRqhD,OAAQx+D,KAAK+rF,QACb5kF,OAAQnH,KAAK6rF,QAAQ/qF,MAAM,GAEnC,IAGJb,EAAMsN,YAAY2Q,aAAe8nC,EAAO5lD,OAAO,CAC3C6rF,OAAQ,MACR5rF,KAAM,SAAsBC,GAKxB,QAJsBwM,IAAlBxM,EAAQg+D,QACRt+D,KAAKisF,OAAS3rF,EAAQg+D,YAGDxxD,IAArBxM,EAAQi+D,SACR,MAAM,IAAIpzD,MAAM,0BAGpBnL,KAAKksF,UAAY5rF,EAAQi+D,SAEzB,IAAI4tB,EAAalsF,EAAMuK,KAAK4hF,MAAMC,WAAW,CACzC/tB,MAAOt+D,KAAKisF,OACZxvB,QAASz8D,KAAKksF,UACdI,uBAAwBrsF,EAAM60B,UAAU5oB,OACzCigF,WAEHnsF,KAAKusF,SAAW,IAAI34C,SAAS,IAAK,UAAYu4C,EAClD,EACAxlC,QAAS,SAASzkD,GACd,OAAc,OAAVA,GAIGlC,KAAKusF,SAASrqF,EACzB,EACAA,MAAO,SAAS4R,GACZ,IAAI5R,EAAQ4R,EAAK5R,MACbsqF,EAAiBxsF,KAAKksF,UAAU,GAAGhqF,MACnCuqF,EAAgBD,aAA0B7mF,KAAO,cAAgB6mF,EACjEE,SAAmBxqF,EAiBvB,OAfI4R,EAAKwB,SACLo3E,EAAYzsF,EAAMsN,YAAY2H,WAAWxG,KAAKxM,EAAO4R,EAAKwB,SAG1Do3E,GAAaD,EACQ,UAAjBA,IACI34E,EAAKwB,SACLpT,EAAQjC,EAAMsN,YAAY2H,WAAWtS,KAAKV,EAAO4R,EAAKwB,SAE1DpT,GAAgB,IAEA,QAAbwqF,IACPxqF,EAAQjC,EAAMsN,YAAY68B,aAAaloC,IAGpCA,CACX,EACA2xB,OAAQ,WACJ,MAAO,CACH1W,OAAQ,SACRmhD,MAAOt+D,KAAKisF,OACZ1tB,SAAUv+D,KAAKksF,UAEvB,IAGJjsF,EAAMsN,YAAYuwD,UAAY9X,EAAO5lD,OAAO,CACxCC,KAAM,SAAmBC,GACrBN,KAAKyV,MAAQnV,EAAQoO,KACrB1O,KAAKiS,OAAS3R,EAAQ4B,MACtBlC,KAAK6rF,QAAU,EACnB,EAEAnlC,QAAS,SAASrvC,GACd,IAAIlQ,EAASkQ,EAAMlV,IAAInC,KAAKkC,OAC3BgB,OACAia,QAAO,SAASjb,EAAOwI,EAAOqwC,GAC3B,OAAiB,IAAVrwC,GAAexI,IAAU64C,EAAMrwC,EAAQ,EAClD,IAEmB,cAAf1K,KAAKyV,OAAuC,cAAdzV,KAAKyV,MACnCtO,EAAOjE,MAAK,SAASuD,EAAGqqB,GACpB,OAAOA,EAAIrqB,CACf,IAEAU,EAAOjE,MAAK,SAASuD,EAAGqqB,GACpB,OAAOrqB,EAAIqqB,CACf,IAGJ,IAAIzQ,EAAQrgB,KAAKiS,OAEE,eAAfjS,KAAKyV,OAAyC,kBAAfzV,KAAKyV,QACpC4K,EAASlZ,EAAO9F,OAASgf,EAAQ,KAAQ,GAG7CrgB,KAAK6rF,QAAU1kF,EAAOrG,MAAM,EAAGuf,EACnC,EACAsmC,QAAS,SAASzkD,GACd,OAAOlC,KAAK6rF,QAAQt6E,QAAQrP,IAAU,CAC1C,EACA2xB,OAAQ,WACJ,MAAO,CACH1W,OAAQ,MACRzO,KAAM1O,KAAKyV,MACXvT,MAAOlC,KAAKiS,OAEpB,IAGJhS,EAAMsN,YAAYqwD,cAAgB5X,EAAO5lD,OAAO,CAC5CC,KAAM,SAAuBC,GAKzB,GAJAN,KAAKyV,MAAQnV,EAAQoO,KAErB1O,KAAK2sF,WAAa3sF,KAAKM,EAAQoO,MAEA,mBAApB1O,KAAK2sF,WACZ,MAAM,IAAIxhF,MAAM,uBAAyB7K,EAAQoO,KAAO,oBAEhE,EACAxM,MAAO,SAAS4R,GACZ,IAAI5R,EAAQ4R,EAAK5R,MAEb4R,EAAKwB,SAGQ,SAFFrV,EAAMsN,YAAY2H,WAAWxG,KAAKxM,EAAO4R,EAAKwB,UAGrDpT,EAAQjC,EAAMsN,YAAY68B,aAAaloC,KAI/C,OAAOA,CACX,EACAwkD,QAAS,SAASrvC,GAId,IAHA,IAAIy1B,EAAM,EACNzsB,EAAQ,EAEHymB,EAAK,EAAGA,EAAKzvB,EAAMhW,OAAQylC,IAAM,CACtC,IAAI5kC,EAAQlC,KAAKkC,MAAMmV,EAAMyvB,IAER,iBAAV5kC,IACP4qC,GAAO5qC,EACPme,IAER,CAGIrgB,KAAK4sF,SADLvsE,EAAQ,EACQysB,EAAMzsB,EAEN,CAExB,EACAsmC,QAAS,SAASzkD,GACd,OAAOlC,KAAK2sF,WAAWzqF,EAC3B,EACA2qF,aAAc,SAAS3qF,GAKnB,OAJIA,aAAiByD,OACjBzD,EAAQjC,EAAMsN,YAAYsnB,aAAa3yB,IAGtB,iBAAVA,GAIJA,EAAQlC,KAAK4sF,QACxB,EACAE,aAAc,SAAS5qF,GAKnB,OAJIA,aAAiByD,OACjBzD,EAAQjC,EAAMsN,YAAYsnB,aAAa3yB,IAGtB,iBAAVA,GAIJA,EAAQlC,KAAK4sF,QACxB,EACAG,SAAU,SAAS7qF,GACf,GAAIA,aAAiByD,KAAM,CACvB,IAAIonF,EAAW9sF,EAAMi2C,KAAK82C,QAAQ/sF,EAAMi2C,KAAKk1C,QAAS,GAEtD,OAAOnrF,EAAMi2C,KAAK0B,QAAQ11C,GAAO0D,YAAcmnF,EAASnnF,SAC5D,CAEA,OAAO,CACX,EACAwlF,MAAO,SAASlpF,GACZ,OAAIA,aAAiByD,MACV1F,EAAMi2C,KAAK+2C,QAAQ/qF,EAIlC,EACAgrF,UAAW,SAAShrF,GAChB,GAAIA,aAAiByD,KAAM,CACvB,IAAIunF,EAAYjtF,EAAMi2C,KAAK82C,QAAQ/sF,EAAMi2C,KAAKk1C,SAAU,GAExD,OAAOnrF,EAAMi2C,KAAK0B,QAAQ11C,GAAO0D,YAAcsnF,EAAUtnF,SAC7D,CAEA,OAAO,CACX,EACAunF,SAAU,SAASjrF,GACf,OAAOupF,EAASxrF,EAAMi2C,KAAK82C,QAAQ/sF,EAAMi2C,KAAKk1C,QAAS,GAAIlpF,EAC/D,EACAkrF,SAAU,SAASlrF,GACf,OAAOupF,EAASxrF,EAAMi2C,KAAKk1C,QAASlpF,EACxC,EACAmrF,SAAU,SAASnrF,GACf,OAAOupF,EAASxrF,EAAMi2C,KAAK82C,QAAQ/sF,EAAMi2C,KAAKk1C,SAAU,GAAIlpF,EAChE,EACAorF,UAAW,SAASprF,GAChB,OAAOopF,EAAUppF,EAAO,EAC5B,EACAqrF,UAAW,SAASrrF,GAChB,OAAOopF,EAAUppF,EAAO,EAC5B,EACAsrF,UAAW,SAAStrF,GAChB,OAAOopF,EAAUppF,GAAQ,EAC7B,EACAurF,YAAa,SAASvrF,GAClB,GAAIA,aAAiByD,KAAM,CACvB,IAAIylF,EAAQnrF,EAAMi2C,KAAKk1C,QAEnBn5D,EAAOi5D,EAAQhpF,GAASgpF,EAAQE,GAEpC,OAAiB,IAATn5D,GAAcm5D,EAAM1zC,gBAAkBx1C,EAAMw1C,gBACnC,GAATzlB,GAAcm5D,EAAM1zC,cAAgB,IAAMx1C,EAAMw1C,aAC5D,CAEA,OAAO,CACX,EACAg2C,YAAa,SAASxrF,GAClB,GAAIA,aAAiByD,KAAM,CACvB,IAAIylF,EAAQnrF,EAAMi2C,KAAKk1C,QAIvB,OAAgB,IAFLF,EAAQhpF,GAASgpF,EAAQE,IAEfA,EAAM1zC,gBAAkBx1C,EAAMw1C,aACvD,CAEA,OAAO,CACX,EACAi2C,YAAa,SAASzrF,GAClB,GAAIA,aAAiByD,KAAM,CACvB,IAAIylF,EAAQnrF,EAAMi2C,KAAKk1C,QAEnBn5D,EAAOi5D,EAAQE,GAASF,EAAQhpF,GAEpC,OAAiB,IAAT+vB,GAAcm5D,EAAM1zC,gBAAkBx1C,EAAMw1C,gBACnC,GAATzlB,GAAcm5D,EAAM1zC,cAAgB,IAAMx1C,EAAMw1C,aAC5D,CAEA,OAAO,CACX,EACAk2C,SAAU,SAAS1rF,GACf,OAAOipF,EAASjpF,EAAO,EAC3B,EACA2rF,SAAU,SAAS3rF,GACf,OAAOipF,EAASjpF,EAAO,EAC3B,EACA4rF,SAAU,SAAS5rF,GACf,OAAOipF,EAASjpF,GAAQ,EAC5B,EACA6rF,WAAY,SAAS7rF,GACjB,GAAIA,aAAiByD,KAAM,CACvB,IAAIylF,EAAQnrF,EAAMi2C,KAAKk1C,QAEvB,OAAOlpF,EAAMw1C,gBAAkB0zC,EAAM1zC,eAAiBx1C,GAASkpF,CACnE,CAEA,OAAO,CACX,EACAv3D,OAAQ,WACJ,MAAO,CACH1W,OAAQ,UACRzO,KAAM1O,KAAKyV,MAEnB,IAGJ,CAAC,EAAG,EAAG,EAAG,GAAG3G,SAAQ,SAASkD,GAC1B/R,EAAMsN,YAAYqwD,cAAc5qD,UAAU,UAAYhB,GAAU,SAAS9P,GACtE,OAAIA,aAAiByD,MACXulF,EAAQhpF,KAAW8P,CAIhC,CACJ,IAEA/R,EAAM+tF,SAAS,SAASj5D,SAASk5D,OAAOtpB,MAAM71D,SAAQ,SAASmnC,EAAOvrC,GAClEzK,EAAMsN,YAAYqwD,cAAc5qD,UAAUijC,EAAM3vC,eAAiB,SAASpE,GACvE,OAAIA,aAAiByD,MACVzD,EAAMy1C,aAAejtC,CAInC,CACJ,GAoDH,CAxbD,CAwbGzK,OAEH,SAAUA,GAEN,IAAI29C,EAAS39C,EAAM0B,MAAMvB,OAAO,CAC5BC,KAAM,SAASw9B,EAAM9H,GACjB/1B,KAAK89B,MAAQD,EACb79B,KAAKkuF,OAASn4D,CAClB,EAEAzC,QAAS,SAASw2D,EAAUviE,EAAMhK,EAAW+V,GACzC,IAAIC,EAAWqqB,EAAOuwC,kBAMtB,OAJkB,IAAd5wE,IACAgW,EAAWqqB,EAAOwwC,oBAGf7mE,EAAK6L,cAAcpzB,KAAK89B,MAAMoiB,aAAa4pC,EAASj5E,SACvD7Q,KAAK89B,MAAMoiB,aAAa4pC,EAASvvE,aAAcgZ,EAAUD,EACjE,EAEAmzB,OAAQ,SAAS13C,EAAKuO,EAAQiK,EAAMhK,EAAW+V,GAG3C,IAFA,IAAIF,EAAgBpzB,KAAKszB,QAAQvkB,EAAI0pB,SAASnb,GAASiK,EAAMhK,EAAW+V,GAE/DwT,EAAK/3B,EAAI8B,QAAQwE,IAAKyxB,GAAM/3B,EAAIwL,YAAYlF,IAAKyxB,IAItD,IAHA,IAAI/U,EAAQ/xB,KAAK89B,MAAMpzB,MAAMqE,EAAI8B,QAAQ6C,IAAKozB,GAC1CthB,EAAMxlB,KAAK89B,MAAMpzB,MAAMqE,EAAIwL,YAAY7G,IAAKozB,GAEvCunD,EAAK,EAAGA,EAAKruF,KAAKkuF,OAAO7sF,OAAQgtF,IAClCt8D,EAAQ/xB,KAAKkuF,OAAOG,GAAIl6D,kBACxBn0B,KAAKkuF,OAAOG,GAAInrF,KAAK6uB,EAAOvM,EAAK4N,GAK7C,OAAOA,CACX,IAGJwqB,EAAOuwC,kBAAoB,SAAS7iF,EAAG4O,GACnC,GAAU,OAAN5O,GAAoB,OAAN4O,EACd,OAAO,EAGX,GAAU,OAAN5O,EACA,OAAO,EAGX,GAAU,OAAN4O,EACA,OAAQ,EAGZ,IAAIo0E,SAAehjF,EACfijF,SAAer0E,EAEnB,GAAc,WAAVo0E,EACA,MAAc,WAAVC,EACOjjF,EAAI4O,GAEJ,EAIf,GAAc,WAAVo0E,EACA,OAAQC,GACJ,IAAK,SACD,OAAO,EACX,IAAK,SACD,OAAOjjF,EAAEkjF,cAAct0E,GAC3B,QACI,OAAQ,EAIpB,GAAc,YAAVo0E,EACA,OAAQC,GACJ,IAAK,SAEL,IAAK,SACD,OAAO,EACX,IAAK,UACD,OAAOjjF,EAAI4O,EACf,QACI,OAAQ,EAIpB,GAAI5O,aAAarL,EAAMsN,YAAYkH,KAAKuS,QAAQ6wB,UAC5C,OAAI39B,aAAaja,EAAMsN,YAAYkH,KAAKuS,QAAQ6wB,UACrC,EAEA,EAIf,MAAM,IAAI1sC,MAAM,kBAAoBG,EAAI,QAAU4O,EACtD,EAEA0jC,EAAOwwC,mBAAqB,SAAS9iF,EAAG4O,GACpC,OAAU,OAAN5O,GAAoB,OAAN4O,EACP,EAGD,OAAN5O,EACO,EAGD,OAAN4O,GACQ,EAGL0jC,EAAOuwC,kBAAkBj0E,EAAG5O,EACvC,EAEArL,EAAMsN,YAAYqwC,OAASA,CAC9B,CAjHD,CAiHG39C,OAUC,IAAIwuF,GAASxuF,MAAMsB,KACfmtF,GAASzuF,MAAMsN,YAAYkH,KAC3BqzC,GAAM7nD,MAAM6nD,IAEZ6mC,GAAY,yDACZC,GAAe,mCAMnB,SAASv2E,GAAM/D,GACXA,EAAQo6E,GAAO95B,YAAYtgD,GAG3B,IAFA,IAA4Cu6E,EAAxCC,EAAW,GAAIC,GAAkB,GAE7Bz6E,EAAM+a,OAAO,CACjB,IAAI2/D,EAAMC,IACVH,EAASnuF,KAAKquF,GACVA,EAAIv7C,OACJs7C,GAAkB,EAE1B,CA4CA,OAnBKA,IACsB,GAAnBD,EAASztF,OACTytF,EAAS,GAAGr7C,KAAO,MAEK,GAAnBq7C,EAASztF,QACdytF,EAAS,GAAGr7C,KAAO,CAAE8b,GAAI,KAAMrtD,MAAO,GACtC4sF,EAAS,GAAGr7C,KAAO,CAAE8b,GAAI,IAAKrtD,MAAO,IAEhC4sF,EAASztF,QAAU,IACxBytF,EAAS,GAAGr7C,KAAO,CAAE8b,GAAI,IAAKrtD,MAAO,GACrC4sF,EAAS,GAAGr7C,KAAO,CAAE8b,GAAI,IAAKrtD,MAAO,GACrC4sF,EAAS,GAAGr7C,KAAO,CAAE8b,GAAI,IAAKrtD,MAAO,GACjC4sF,EAASztF,OAAS,IAClBytF,EAAS,GAAGr7C,KAAO,OACnBq7C,EAAWA,EAAShuF,MAAM,EAAG,MAKlCguF,EAEP,SAASI,IACL,IAAIroF,EAAIyN,EAAM1I,KAAK+iF,IACnB,GAAI9nF,EACA,OAAOA,EAAE,GAAGP,aAEpB,CAYA,SAAS6oF,IAEL,IADA,IAAiB9jE,EAAb/V,EAAS,GAASxO,EAAO,MACrBwN,EAAM+a,QAAUhE,EAAMmpC,MAEV,QAAZnpC,EAAI3c,KACA5H,GAAQ,cAAcmB,KAAKnB,EAAK4H,OAAsB,KAAb5H,EAAKsgE,MAC/B,KAAZ/7C,EAAI+7C,MAAe/7C,EAAI/V,OAAS,IAEnC+V,EAAI3c,KAAO,QAER,cAAczG,KAAKojB,EAAI3c,OAAqB,KAAZ2c,EAAI+7C,MACvCtgE,GAAqB,QAAbA,EAAK4H,MAA+B,KAAb5H,EAAKsgE,MACjCtgE,EAAKwO,OAAS,IAEjBxO,EAAK4H,KAAO,QAGd,uBAAuBzG,KAAKojB,EAAI3c,QAClC5H,EAAOukB,GAEX/V,EAAO3U,KAAK0qB,GAEhB,OAAO/V,CACX,CAEA,SAAS85E,EAAc/jE,GACnB,GAAgB,QAAZA,EAAI3c,MAA+B,KAAZ2c,EAAI+7C,MAAe/7C,EAAI/V,OAAS,EAAI,CAC3D,IAAIzO,EAAIyN,EAAM1I,KAAK,WACf/E,IACAwkB,EAAIgkE,SAAWxoF,EAAE,GAAGxF,OACJ,QAAZgqB,EAAI3c,OACJ2c,EAAI3c,KAAO,QAGvB,CACA,OAAO2c,CACX,CAEA,SAASmpC,IACL,IAAIzsD,EAAIlB,EAER,GAAKA,EAAIyN,EAAM1I,KAAK,2BAGhB,MAAO,CAAE8C,KAAM,QAASohD,KAAK,EAAMx6C,OAAQzO,EAAE,GAAKA,EAAE,GAAIyoF,QAAST,GAErE,GAAKhoF,EAAIyN,EAAM1I,KAAK,WAChB,MAAO,CAAE8C,KAAM,QAASohD,KAAK,EAAOx6C,OAAQzO,EAAE,GAAIyoF,QAAST,GAG/D,GAAKhoF,EAAIyN,EAAM1I,KAAK,eAChB,MAAO,CAAE8C,KAAM,MAAO3G,GAAIlB,EAAE,GAAIoqC,KAAMpqC,EAAE,IAG5C,GAAKA,EAAIyN,EAAM1I,KAAK,6BAEhB,OAAOwjF,EAAc,CAAE1gF,KAAM,OAAQ04D,MADrCvgE,EAAIA,EAAE,GAAGP,eACoCS,OAAO,GAAIuO,OAAQzO,EAAExF,SAGtE,GAAKwF,EAAIyN,EAAM1I,KAAK,eAEhB,OAAOwjF,EAAc,CAAE1gF,KAAM,OAAQ04D,MADrCvgE,EAAIA,EAAE,GAAGP,eACoCS,OAAO,GAAIuO,OAAQzO,EAAExF,SAGtE,GAAKwF,EAAIyN,EAAM1I,KAAK,uBAEhB,OAAOwjF,EAAc,CAAE1gF,KAAM,SAAU04D,MADvCvgE,EAAIA,EAAE,GAAGP,eACsCS,OAAO,GAAIuO,OAAQzO,EAAExF,SAExE,GAAKwF,EAAIyN,EAAM1I,KAAK,mCAEhB,MAAO,CAAE8C,KAAM,OAAQ6gF,IADvB1oF,EAAIA,EAAE,GAAGZ,MAAM,MACc,GAAIupF,GAAI3oF,EAAE,IAE3C,OAASkB,EAAKuM,EAAM29B,QAClB,IAAK,IACH,OAAO,KACT,IAAK,KAEH,MAAO,CAAEvjC,KAAM,MAAOxM,MAAOoS,EAAM29B,QACrC,IAAK,IACH,MAAO,CAAEvjC,KAAM,MAAOxM,MAAOoS,EAAM8/C,YAAYrsD,IACjD,IAAK,IACH,MAAO,CAAE2G,KAAM,QACjB,IAAK,IAEH,MAAO,CAAEA,KAAM,QAASxM,MAAOoS,EAAM29B,QACvC,IAAK,IAEH,MAAO,CAAEvjC,KAAM,OAAQxM,MAAOoS,EAAM29B,QACtC,IAAK,IACH,OAAI39B,EAAM4/C,UAAU,cAChB26B,GAAc,EACP,CAAEngF,KAAM,QAEZ,CAAEA,KAAM,MAAOxM,MAAO,KAC/B,IAAK,IACH,MAAO,CAAEwM,KAAM,WACjB,IAAK,IACH,MAAO,CAAEA,KAAM,SAInB,MAAO,CAAEA,KAAM,MAAOxM,MAAO6F,EACjC,CAEA,SAASknF,IACLJ,GAAc,EACd,IAAIj5E,EAAQs5E,IAAcz7C,EApH9B,WACI,IAAI5sC,EAAIyN,EAAM1I,KAAKgjF,IACnB,GAAI/nF,EAAG,CACH,IAAI4jB,EAAMopC,WAAWhtD,EAAE,IACvB,IAAKgG,MAAM4d,GACP,MAAO,CAAE8kC,GAAI1oD,EAAE,GAAI3E,MAAOuoB,EAAKixB,QAAQ,EAE/C,CACJ,CA4GqC+zC,GAIjC,OAHK75E,GAAS69B,IACV79B,EAAQs5E,KAEL,CACHt5E,MAAQA,EACR69B,KAAQA,EACRzuC,KAAQmqF,IAEhB,CACJ,CAqJA,SAASO,GAAkBp6E,GACvB,IAzBiBrS,EACbyH,EAwBA4J,GAzBarR,EAyBOqS,EAAOtQ,KAxB3B0F,EAAQ,EACL,CACHunC,KAAM,WACF,OAAOhvC,EAAMyH,IACjB,EACA2kB,IAAK,WACD,OAAO3kB,GAASzH,EAAM5B,MAC1B,EACAgyD,MAAO,SAASpsD,EAAGM,GACf,GAAImD,EAAQzD,GAAKhE,EAAM5B,OAAQ,CAC3B,IAAIopB,EAAMljB,EAAEM,MAAM,KAAM5E,EAAMnC,MAAM4J,EAAOA,EAAQzD,IAInD,OAHIwjB,IACA/f,GAASzD,GAENwjB,CACX,CACJ,EACAklE,QAAS,WACLjlF,EAAQ,CACZ,IAMAklF,GAAU,EACVC,GAAU,EACVC,GAAU,EACVC,EAAe,EACfhmD,EAAW,mIACXimD,EAAa,EACb7mF,EAAO,iDACP8mF,GAAkB,EAClBC,EAAS,EACTC,EAAY,GAAIC,EAAY,GAC5BC,EAAY/6E,EAAOm+B,KACnB68C,EAAW,GAEf,GAAiB,QAAbD,EACAC,EAAW,wFAEV,GAAiB,OAAbD,EACLC,EAAW,wCAEV,GAAID,EAAW,CAEhBC,EAAW,0CADc,KAAhBD,EAAU9gC,GAAY,KAAO8gC,EAAU9gC,IAErC,IAAM8gC,EAAUnuF,MAAQ,OAC9BmuF,EAAU30C,SACXvyC,GAAQ,4BAEhB,CAMA,SAASonF,EAAWjlF,EAAG4O,IACJ,SAAV5O,EAAEoD,MAA6B,SAAVwL,EAAExL,MACb,SAAVpD,EAAEoD,MAAmBpD,EAAEg5B,QAAoB,SAAVpqB,EAAExL,QAEpCwL,EAAEoqB,QAAS,EACX0rD,IAER,CAEA,IAbI16E,EAAOM,QACPzM,GAAQ,kBAAoBsrB,KAAKC,UAAUpf,EAAOM,OAAS,OAYvDtB,EAAM+a,OAAO,CACjB/a,EAAM++C,MAAM,EAAGk9B,GAEC,YADZllE,EAAM/W,EAAM29B,QACRvjC,KACJqhF,IAEiB,SAAZ1kE,EAAI3c,KACL2c,EAAIikE,SACJY,GAAU7kE,EAAI/V,OAAOjU,OACrB+uF,EAAUzvF,KAAK0qB,EAAI/V,UAEnB66E,EAAUxvF,KAAK0qB,EAAI/V,QACf+V,EAAIykC,MACJmgC,GAAkB,IAIT,QAAZ5kE,EAAI3c,KACTmhF,GAAU,EAEO,QAAZxkE,EAAI3c,KACTkhF,GAAU,EAEO,QAAZvkE,EAAI3c,OACTohF,EAAUD,GAAU,EAE5B,CAoCA,IAlCIE,EAAe,IACf5mF,GAAQ,YAAcsH,KAAKyoC,IAAI,IAAK62C,GAAgB,MAEpDC,EAAa,IACb7mF,GAAQ,YAAcsH,KAAKyoC,IAAI,IAAM82C,GAAc,MAEnDG,EAAU9uF,SACV8H,GAAQ,+CAAiDsrB,KAAKC,UAAUy7D,GAAa,KAAOD,EAAS,KAAOD,EAAkB,MAC9H9mF,GAAQ,0CAERinF,EAAU/uF,SACV8H,GAAQ,sCAAwCsrB,KAAKC,UAAU07D,GAAa,KAAOF,EAAS,QAE5FC,EAAU9uF,QAAU+uF,EAAU/uF,UAC9B8H,GAAQ,qBAERymF,IACAzmF,GAAQ,sCAER0mF,IACA1mF,GAAQ,uCAERymF,GAAWC,KACX1mF,GAAQ,oBAGR4mF,EAAe,GAAKC,EAAa,GAAKG,EAAU9uF,QAAU+uF,EAAU/uF,QAAUuuF,GAAWC,KACpFS,IACDA,EAAW,qCAInBh8E,EAAMq7E,UACNxmF,GAAQ,gCACAmL,EAAM+a,OAAO,CACjB,IAAIhE,EACY,QADZA,EAAM/W,EAAM29B,QACRvjC,KACJvF,GAAQ,wCAES,SAAZkiB,EAAI3c,MAAoB2c,EAAIiZ,OAGhB,WAAZjZ,EAAI3c,MACTvF,GAAQ,qBACRA,GAAQ,mDAES,OAAZkiB,EAAI3c,MACLq7B,EAAS9hC,KAAKojB,EAAInpB,SAClBiH,GAAQ,sBACRA,GAAQ,8DAEZA,GAAQ,aAAesrB,KAAKC,UAAUrJ,EAAInpB,OAAS,MAElC,QAAZmpB,EAAI3c,MACTvF,GAAQ,kBACRA,GAAQ,qBAES,SAAZkiB,EAAI3c,MACTvF,GAAQ,yCACRA,GAAQ,gBACRA,GAAQ,4CAA8CsrB,KAAKC,UAAUrJ,EAAInpB,OAAS,SAEjE,QAAZmpB,EAAI3c,KACTvF,GAAQ,0BAA4BsrB,KAAKC,UAAUrJ,EAAInpB,OAAS,MAE/C,SAAZmpB,EAAI3c,MACTvF,GAAQ,+FACRA,GAAQ,cAAgBkiB,EAAIikE,QAAU,UAAY,WAAa,cAE9C,QAAZjkE,EAAI3c,KACTvF,GAAQ,yCACFsrB,KAAKC,UAAUrJ,EAAI+7C,MAAQ,KAAO/7C,EAAI/V,OAAS,MAEpC,QAAZ+V,EAAI3c,KACTvF,GAAQ,gCACFsrB,KAAKC,UAAUrJ,EAAI+7C,MAAQ,KAAO/7C,EAAI/V,OAAS,KAAOw6E,EAAU,KAAOzkE,EAAIgkE,SAAW,MAE3E,UAAZhkE,EAAI3c,KACTvF,GAAQ,mCACFsrB,KAAKC,UAAUrJ,EAAI+7C,MAAQ,KAAO/7C,EAAI/V,OAAS,KAAO+V,EAAIgkE,SAAW,MAE1D,QAAZhkE,EAAI3c,OAGTvF,GAAQ,+BAAiCsrB,KAAKC,UAAUrJ,EAAIkkE,IAAM,MAAQ96D,KAAKC,UAAUrJ,EAAImkE,IAAM,MA5CnGrmF,GAAQ,iBA8ChB,CAUA,OARAA,GAAQ,yCACRA,GAAQ,uBACRA,GAAQ,kBAEJmnF,IACAnnF,EAAOmnF,EAAWnnF,EAAO,KAGtBA,CACX,CAEA,IAAIqnF,GAAOd,GAAkB,CAAEj8C,KAAM,OAAQzuC,KAAM,CAAE,CAAE0J,KAAM,WAEzDm7B,GAAU4kD,GAAOnnF,SAAQ,SAASgO,GAClC,IACInM,EADOkP,GAAM/C,GACDnT,IAAIutF,IAMpB,OALAvmF,EAAKxI,KAAK6vF,IAEVrnF,EAAO,iJADPA,EAAOA,EAAKhG,KAAK,OAGsD,sBAChE,IAAIywC,SAAS,UAAWzqC,EAAxB,CAA8BsnF,GACzC,IAKIn4C,GAAiBm2C,GAAOnnF,SAAQ,SAASgO,GAKzC,IAJA,IACIo7E,EADAj+D,EAAOpa,GAAM/C,GACJq7E,GAAQ,EAAOb,GAAU,EAG7BvsF,EAAI,EAAGA,EAAIkvB,EAAKpxB,SAAUkC,EAAG,CAClCmtF,EAAUj+D,EAAKlvB,GACf,IAAK,IAAIsH,EAAI,EAAGA,EAAI6lF,EAAQ1rF,KAAK3D,SAAUwJ,EACnC,uBAAuB5C,KAAKyoF,EAAQ1rF,KAAK6F,GAAG6D,QAC5CiiF,GAAQ,EACoB,QAAxBD,EAAQ1rF,KAAK6F,GAAG6D,OAChBohF,GAAU,IAItB,GAAIa,EACA,KAER,CACA,OAAKA,EAIED,EAAQ1rF,KAAK7C,KAWpB,SAAoBkpB,GAChB,GAAgB,SAAZA,EAAI3c,KACJ,OAAI2c,EAAIykC,IACGzkC,EAAI/V,OAAOvO,OAAO,GAAK,IAAMskB,EAAI/V,OAAOoV,OAAO,GAE/CW,EAAI/V,OAGd,GAAgB,OAAZ+V,EAAI3c,KACT,OAAO2c,EAAItjB,GAAKsjB,EAAI4lB,KAEnB,GAAgB,QAAZ5lB,EAAI3c,MAA8B,QAAZ2c,EAAI3c,KAAgB,CAC/C,IAAI04D,EAAO/7C,EAAI+7C,KAUf,MATgB,QAAZ/7C,EAAI3c,MAAkB,KAAKzG,KAAKm/D,GAChCA,EAAO,IAEU,QAAZ/7C,EAAI3c,MAAkB,KAAKzG,KAAKm/D,KAChC0oB,IAED1oB,EAAOA,EAAKlgD,gBA1B5B,SAAuB0pE,EAAKvlE,GACpBA,EAAIgkE,WACJuB,GAAOC,GAAQ,GAAIpgF,KAAKmK,IAAIyQ,EAAIgkE,SAAU,GAAI,MAElD,OAAOuB,CACX,CAwBexB,CAAcyB,GAAQ,GAAIxlE,EAAI/V,OAAQ8xD,GAAO/7C,EACxD,CACK,MAAgB,QAAZA,EAAI3c,KACF,KAEU,OAAZ2c,EAAI3c,KAKF2c,EAAInpB,MAEM,SAAZmpB,EAAI3c,KACF,IAEU,OAAZ2c,EAAI3c,KACF,IAEU,WAAZ2c,EAAI3c,KACF,IAEU,SAAZ2c,EAAI3c,KACF,IAGA,EAEf,IA5DoCvL,KAAK,IAH9B,IAgEf,IAEIstF,GAAY,CAEZ14C,WAAY22C,GAAO1nE,QAAQ+wB,WAC3BtB,WAAYi4C,GAAO1nE,QAAQyvB,WAE3BP,KAAM,SAASphB,EAASluB,EAAGwgE,EAAM/lE,GAC7B,OAAQ+lE,GACN,IAAK,IACH,OAAQ/lE,GACN,KAAK,EAAG,OAAOuF,EAAEsvC,KACjB,KAAK,EAAG,OAAO26C,GAAQjqF,EAAEsvC,KAAM,EAAG,KAClC,KAAK,EAAG,OAAOphB,EAAQg8D,UAAUC,SAASC,KAAKC,UAAUrqF,EAAEuvC,KAC3D,KAAK,EAAG,OAAOrhB,EAAQg8D,UAAUC,SAASC,KAAKrsB,MAAM/9D,EAAEuvC,KAEzD,MACF,IAAK,IACH,OAAQ90C,GACN,KAAK,EAAG,OAAOuF,EAAEqvC,MAAQ,EACzB,KAAK,EAAG,OAAO46C,GAAQjqF,EAAEqvC,MAAQ,EAAG,EAAG,KACvC,KAAK,EAAG,OAAOnhB,EAAQg8D,UAAUC,SAAS9C,OAAOgD,UAAUrqF,EAAEqvC,OAC7D,KAAK,EAAG,OAAOnhB,EAAQg8D,UAAUC,SAAS9C,OAAOtpB,MAAM/9D,EAAEqvC,OACzD,KAAK,EAAG,OAAOnhB,EAAQg8D,UAAUC,SAAS9C,OAAOtpB,MAAM/9D,EAAEqvC,OAAOlvC,OAAO,GAEzE,MACF,IAAK,IACH,OAAQ1F,GACN,KAAK,EAAG,OAAOuF,EAAEovC,KAAO,IACxB,KAAK,EAAG,OAAOpvC,EAAEovC,MAIvB,MAAO,IACX,EAEAqB,KAAM,SAAS/F,EAAG81B,EAAM/lE,EAAQ6vF,EAAMC,GAClC,IAAIr6D,EAAKu4D,EACT,OAAQjoB,GACN,IAAK,IACHtwC,EAAM+5D,GAAQK,EAAO5/C,EAAEsF,MAAQ,IAAM,GAAKtF,EAAEsF,MAAOv1C,EAAQ,KACvD8vF,IACA9B,GAAY/9C,EAAEuF,SAAWvF,EAAEwF,QAAUxF,EAAEyF,aAAe,KAAQ,IAAM,IAExE,MACF,IAAK,IACHjgB,EAAM+5D,GAAQv/C,EAAEuF,QAASx1C,EAAQ,KAC7B8vF,IACA9B,GAAY/9C,EAAEwF,QAAUxF,EAAEyF,aAAe,KAAQ,IAErD,MACF,IAAK,IACHjgB,EAAM+5D,GAAQv/C,EAAEwF,QAASz1C,EAAQ,KAC7B8vF,IACA9B,EAAW/9C,EAAEyF,aAAe,KAOpC,OAHIs4C,IACAv4D,GAAO25D,GAAUW,QAAQ/B,EAAU8B,GAASruF,QAAQ,MAAO,KAExDg0B,CACX,EAEAu6D,OAAQ,SAASnvF,EAAOklE,EAAM/lE,EAAQ8vF,GAClC,IAAIr6D,EAAKu4D,EACT,OAAQjoB,GACN,IAAK,IACHtwC,EAAc,GAAR50B,EACN,MACF,IAAK,IACH40B,EAAc,GAAR50B,EAAa,GACnB,MACF,IAAK,IACH40B,EAAc,GAAR50B,EAAa,GAAK,GAU5B,OAPIivF,IACA9B,EAAWv4D,GAAa,EAANA,IAEtBA,EAAM+5D,GAAc,EAAN/5D,EAASz1B,EAAQ,KAC3BguF,IACAv4D,GAAO25D,GAAUW,QAAQ/B,EAAU8B,GAASruF,QAAQ,MAAO,KAExDg0B,CACX,EAEAwuC,KAAM,SAASv9D,GAEX,OAAOA,CACX,EAOAupF,UAAW,SAASx8D,EAAS5yB,EAAOe,EAAOitF,EAAQpgC,GAI/C5tD,EAAQuuF,GAAUW,QAAQlvF,EAAOguF,GAAQptF,QAAQ,QAAS,IAC1D,IAAIyuF,EAAWtuF,EAAMA,EAAM5B,OAAS,GAEhC6uF,EAAS,GAAmC,KAA9BqB,EAAStuF,EAAM5B,OAAS,KAKxB,MAAVa,EAAiBA,EAAQ,GACV,OAAVA,IAAkBA,EAAQ,MAGvC,IAGamB,EAHTmuF,GAAoB,EACpBC,EAAKvvF,EAAMb,OAAS,EACpB0E,EAAS,GACT8gB,EAAM,EAEV,SAASkoB,EAAIhnC,EAAI2pF,GACT5hC,GAAOjpC,GAAOA,EAAM,GAAM,GAAK,UAAU5e,KAAKF,KAC9C1E,EAAMyxB,EAAQwV,aAAa,KAAOjnC,GAEnCquF,GAAoB,MAAP3pF,IACZypF,GAAoB,EACpBzpF,EAAK,KAET1E,EAAM0E,EAAK1E,EACXwjB,GACJ,CAEA,IAAK,IAAIhc,EAAI5H,EAAM5B,SAAUwJ,GAAK,GAAI,CAClC,IAAIyK,EAASrS,EAAM4H,GACnBxH,EAAM,GACN,IAAK,IAAIguC,EAAI/7B,EAAOjU,SAAUgwC,GAAK,GAAI,CACnC,IAAIsgD,EAAMr8E,EAAOvO,OAAOsqC,GACpBogD,EAAK,EACM,KAAPE,EACA5iD,EAAI,KACU,KAAP4iD,GACP5iD,EAAI,MAGK,KAAT7sC,GAAuB,KAAPyvF,EAChB5iD,EAAI,KACU,KAAP4iD,EACP5iD,EAAI7sC,EAAM6E,OAAO0qF,IAAK,GAEtB1iD,EAAI7sC,EAAM6E,OAAO0qF,IAErBA,IAER,CACA,GAAU,IAAN5mF,EACA,KAAO4mF,GAAM,GACT1iD,EAAI7sC,EAAM6E,OAAO0qF,MAGzB1rF,EAAOgpB,QAAQ1rB,EACnB,CAMA,OAJGmuF,IACCzrF,EAAO,GAAK,IAAMA,EAAO,IAGtBA,CACX,EAKA6rF,UAAW,SAAS1vF,EAAOe,EAAOitF,GAE9B,IAAIpqF,GADJ5D,EAAQuuF,GAAUW,QAAQlvF,EAAOguF,IACjB3+E,QAAQ,KAEpBrP,EADA4D,GAAO,EACC5D,EAAMwoB,OAAO5kB,EAAM,GAAGhD,QAAQ,MAAO,IAErC,GAMZ,IAHA,IAAI2uF,EAAK,EACL1rF,EAAS,GAEJ8E,EAAI,EAAGA,EAAI5H,EAAM5B,SAAUwJ,EAAG,CAGnC,IAFA,IAAIyK,EAASrS,EAAM4H,GACfxH,EAAM,GACDguC,EAAI,EAAGA,EAAI/7B,EAAOjU,SAAUgwC,EAAG,CACpC,IAAIsgD,EAAMr8E,EAAOvO,OAAOsqC,GACpBogD,EAAKvvF,EAAMb,OACXgC,GAAOnB,EAAM6E,OAAO0qF,KACN,KAAPE,EACPtuF,GAAO,IACO,KAAPsuF,IACPtuF,GAAO,IAEf,CACA0C,EAAOpF,KAAK0C,EAChB,CAEA,OAAO0C,CACX,EAGAqrF,QAAS,SAASlvF,EAAO2vF,GACrB,OAAO,SAAUT,EAAQlvF,EAAOywB,GAC5B,IAAKmF,SAAS51B,GACV,MAAO,QAIX,GAAIA,EAAQ,EACR,MAAO,IAAMkvF,GAASlvF,GAG1B,GAAiB,IAAb2vF,EACA,OAAOhvF,OAAO4N,KAAKsjC,MAAM7xC,IAG7B,GAAIA,IAAUuO,KAAKsjC,MAAM7xC,KAAW,KAAK+F,KAAKpF,OAAOX,IACjD,OAAOA,EAAMkvF,QAAQS,GAOzB,IAAI90D,EA8ChB,SAAmBA,GACf,IACI+0D,EAASC,EAASlrF,EADlBxD,EAAMR,OAAOk6B,GAAKz2B,cAElBR,EAAMzC,EAAIkO,QAAQ,KAClBzL,EAAM,GACNA,EAAMzC,EAAIkO,QAAQ,MACR,GACNugF,EAAUzuF,EACV0uF,EAAU,KAEVD,EAAUzuF,EAAIqnB,OAAO,EAAG5kB,GACxBisF,EAAU1uF,EAAIqnB,OAAO5kB,KAGzBgsF,EAAUzuF,EAAIqnB,OAAO,EAAG5kB,GACxBisF,EAAU1uF,EAAIqnB,OAAO5kB,EAAM,IAE/B,GAAKe,EAAI,mBAAmBoH,KAAK8jF,GAAW,CACxC,IAAInhC,EAAMhkD,SAAS/F,EAAE,GAAI,IACrB+pD,GAAO,GAEPkhC,IADAC,EA/BZ,SAAkBtnE,EAAKtmB,EAAO4D,GAC1B0iB,GAAO,GACP,KAAOA,EAAIppB,OAAS8C,GAChBsmB,GAAO1iB,EAEX,OAAO0iB,CACX,CAyBsBunE,CAASnrF,EAAE,GAAI+pD,EAAK,MACXlmC,OAAO,EAAGkmC,GAC7BmhC,EAAUA,EAAQrnE,OAAOkmC,KAGzBmhC,GADAD,EAAUjB,GAAQiB,GAAUlhC,EAAK,MACflmC,OAAOkmC,GAAO/pD,EAAE,GAClCirF,EAAUA,EAAQpnE,OAAO,EAAGonE,EAAQzwF,OAASuvD,GAErD,CACA,MAAO,CAAEkhC,QAASA,GAAW,IAAKC,QAASA,EAC/C,CA5EsBE,CAAU/vF,GAChB4vF,EAAU/0D,EAAI+0D,QACdC,EAAUh1D,EAAIg1D,QAClB,GAAIA,EAAQ1wF,QAAUwwF,EAAU,CAC5B,KAAOE,EAAQ1wF,OAASwwF,GACpBE,GAAW,IAEf,OAAOD,EAAU,IAAMC,CAC3B,CAEA,GAAIp/D,EAGA,OAAOm/D,EAAU,IAAMC,EAAQrnE,OAAO,EAAGmnE,GAK7C,IAAItqF,EAAIkJ,KAAKyoC,IAAI,GAAI24C,GACrB,OAAOT,EAAQ3gF,KAAKsjC,MAAM7xC,EAAQqF,GAAKA,GAAG,EAE7C,CA3CM,CA2CJ2oC,OAAOhuC,EAAMkvF,QAAQ,KAE5B,GAIJ,SAASP,GAAQpmE,EAAKtmB,EAAO4D,GAEzB,IADA0iB,GAAO,GACAA,EAAIppB,OAAS8C,GAChBsmB,EAAM1iB,EAAK0iB,EAEf,OAAOA,CACX,CA+CA,SAAS7nB,GAAK2E,GAGV,IAFA,IAAI+D,EAAI/D,EAAEvC,KACNpC,EAAO,GACFW,EAAI,EAAGA,EAAI+H,EAAEjK,SAAUkC,EAAG,CAC/B,IAAIujB,EAAKxb,EAAE/H,GACM,iBAANujB,EACPlkB,GAAQkkB,EACU,SAAXA,EAAGpY,OACV9L,GAAQ,IAEhB,CACA,OAAOA,CACX,CAEA3C,MAAMsN,YAAY2H,WAAa,CAC3B20B,QAAUA,GACVxxB,MAAOA,GACP/C,OAAQ,SAASpT,EAAOoT,EAAQwf,GAC5B,IAAIvtB,EAAIsiC,GAAQv0B,EAARu0B,CAAgB3nC,EAAO4yB,GAC3Bo9D,EAAOpqC,GAAI1pC,QAAQ,QACvB8zE,EAAK9W,WAAa7zE,EAAEmH,KACpB,IAAIpD,EAAI/D,EAAEvC,KACNuC,EAAEqO,QACFs8E,EAAKzuE,KAAK3f,MAAQ,CAAE8R,MAAOrO,EAAEqO,QAEjC,IAAK,IAAIrS,EAAI,EAAGA,EAAI+H,EAAEjK,SAAUkC,EAAG,CAC/B,IAAIujB,EAAKxb,EAAE/H,GACM,iBAANujB,EACPorE,EAAK1lC,SAAS7rD,KAAKmnD,GAAIllD,KAAKkkB,IACV,SAAXA,EAAGpY,MACVwjF,EAAK1lC,SAAS7rD,KAAKmnD,GAAI1pC,QAAQ,OAAQ,CACnCta,MAAO,CAAEioB,WAAY,WACtB,CAAE+7B,GAAIllD,KAAKkkB,EAAG5kB,SAEzB,CACA,OAAOgwF,CACX,EACAtvF,KAAM,SAASV,EAAOoT,EAAQwf,GAE1B,OAAOlyB,GADCinC,GAAQv0B,EAARu0B,CAAgB3nC,EAAO4yB,GAEnC,EACAq9D,aAAc,SAASjwF,EAAOoT,EAAQwf,GAClC,IAAIvtB,EAAIsiC,GAAQv0B,EAARu0B,CAAgB3nC,EAAO4yB,GAC/B,MAAO,CAAElyB,KAAMA,GAAK2E,GAAIqO,MAAOrO,EAAEqO,MAAOlH,KAAMnH,EAAEmH,KACpD,EACAA,KAAM,SAASxM,EAAOoT,GAClB,OAAOu0B,GAAQv0B,EAARu0B,CAAgB3nC,GAAOwM,IAClC,EACA6G,eAAgB,SAASD,EAAQ2c,GAC7B,IA/rB0BxrB,EA+rBtB4pD,EAAMh4C,GAAM/C,GAEhB,OAjsB0B7O,EAgsBNwrB,EAALo+B,EA/rBVvhD,SAAQ,SAASkgF,GACtB,IAAI/8D,EAAOxrB,EACX,GAAgB,QAAZuoF,EAAIv7C,KAAR,CAIA,IADA,IAAIzuC,EAAOgqF,EAAIhqF,KAAMotF,GAAW,EAAO7uF,EAAIyB,EAAK3D,OAChC,IAAT4wB,KAAgB1uB,GAAK,GAAG,CAC3B,IAAI8nB,EAAMrmB,EAAKzB,GACf,GAAgB,SAAZ8nB,EAAI3c,KAAiB,CACrB,GAAI2c,EAAIikE,QAAS,CAEb,GADA8C,GAAW,EACPngE,EAAO,EACP5G,EAAI/V,QAAUu7E,GAAQ,GAAI5+D,EAAM,UAC7B,GAAIA,EAAO,EAAG,CACjB,IAAI9kB,EAAMke,EAAI/V,OAAOjU,OACrBgqB,EAAI/V,OAAS+V,EAAI/V,OAAOoV,OAAO,EAAGvd,EAAM8kB,GACxCA,GAAQ9kB,EAAMke,EAAI/V,OAAOjU,MAC7B,CACA,GAA0B,IAAtBgqB,EAAI/V,OAAOjU,OAEX,IADA2D,EAAKwM,OAAOjO,EAAG,KACNA,GAAK,GAAG,CAEb,GAAgB,UADhB8nB,EAAMrmB,EAAKzB,IACHmL,MAAmB2c,EAAIikE,QAAS,GAClC/rF,EACF,KACJ,CACA,GAAgB,OAAZ8nB,EAAI3c,KAAe,CACnB1J,EAAKwM,OAAOjO,EAAG,GACf,KACJ,CACJ,CAER,CACA,GAAI0uB,EAAO,EACP,KAER,CACJ,EACKmgE,GAAYngE,EAAO,GAEpBjtB,EAAKwM,OACDjO,EAAI,EAAG,EAAG,CACNmL,KAAU,OACX,CACCA,KAAU,QACVohD,KAAU,EACVw/B,SAAU,EACVh6E,OAAUu7E,GAAQ,GAAI5+D,EAAM,MA3CxC,CA+CJ,IAxHJ,SAAe68D,GACX,OAAOA,EAAS3sF,KAEhB,SAAsB6sF,GAClB,IAAI/lF,EAAM,GAUV,OATI+lF,EAAIp5E,QACJ3M,GAAO,IAAM+lF,EAAIp5E,MAAQ,KAEzBo5E,EAAIv7C,MACc,QAAZu7C,EAAIv7C,MAA8B,OAAZu7C,EAAIv7C,OAC5BxqC,GAAO,IAAM+lF,EAAIv7C,KAAK8b,GAAKy/B,EAAIv7C,KAAKvxC,MAAQ,KAGpD+G,EAAO+lF,EAAIhqF,KAAK7C,IAAIkwF,GAAYlvF,KAAK,GAEzC,IAdkCA,KAAK,KAgBvC,SAASisF,EAAcwB,EAAKvlE,GAIxB,OAHIA,EAAIgkE,WACJuB,GAAO,IAAMC,GAAQ,GAAIxlE,EAAIgkE,SAAU,MAEpCuB,CACX,CAEA,SAASyB,EAAWhnE,GAChB,MAAgB,SAAZA,EAAI3c,KACA2c,EAAIykC,IACGzkC,EAAI/V,OAAOvO,OAAO,GAAK,IAAMskB,EAAI/V,OAAOoV,OAAO,GAE/CW,EAAI/V,OAGE,OAAZ+V,EAAI3c,KACF2c,EAAItjB,GAAKsjB,EAAI4lB,KAEH,QAAZ5lB,EAAI3c,MAA8B,QAAZ2c,EAAI3c,KACxB0gF,EAAcyB,GAAQ,GAAIxlE,EAAI/V,OAAQ+V,EAAI+7C,MAAO/7C,GAEvC,UAAZA,EAAI3c,KACF0gF,EAAc,IAAMyB,GAAQ,GAAIxlE,EAAI/V,OAAQ+V,EAAI+7C,MAAQ,IAAK/7C,GAEnD,QAAZA,EAAI3c,KACF2c,EAAIkkE,GAAK,IAAMlkE,EAAImkE,GAET,OAAZnkE,EAAI3c,KACF+lB,KAAKC,UAAUrJ,EAAInpB,OAET,QAAZmpB,EAAI3c,KACF,IAEU,SAAZ2c,EAAI3c,KACF,IAAM2c,EAAInpB,MAEA,QAAZmpB,EAAI3c,KACF,IAAM2c,EAAInpB,MAEA,OAAZmpB,EAAI3c,KACF,IAEU,WAAZ2c,EAAI3c,KACF,IAEU,SAAZ2c,EAAI3c,KACF,SADN,CAGT,CACJ,CAmsBe+e,CAAM4iC,EACjB,EACA/X,eAAgBA,IAWpB,IAAI/2C,GAAOtB,MAAMsB,KACb+wF,GAAgBryF,MAAMsN,YACtBglF,GAASD,GAAc79E,KACvB+9E,GAAYD,GAAOvrE,QACnByrE,GAAmBD,GAAUh6C,eAC7BC,GAAc+5C,GAAU/5C,YACxBi6C,GAAcF,GAAU36C,UACxB79B,GAAWs4E,GAAct4E,SACzB24E,GAAYL,GAAc30D,QAC1B7kB,GAAWw5E,GAAcx5E,SACzBwuB,GAASkrD,GAAUlrD,OACnB7J,GAAM60D,GAAc70D,IACpBC,GAAU40D,GAAc50D,QACxBk1D,GAAgBJ,GAAUx6C,YAC1B66C,GAAaL,GAAU16C,SACvBg7C,GAAeN,GAAUz6C,WACzBg7C,GAAeP,GAAUp6C,WACzBnjB,GAAiBu9D,GAAUv9D,eAE/B,SAAS+9D,GAAYjhE,EAAOvM,EAAKytE,GAC7B,IAAIC,EAAKJ,GAAa/gE,GAClBohE,EAAKL,GAAattE,GA+BtB,OA3BIytE,GAEe,IAAXC,EAAGh9C,OACHg9C,EAAGh9C,KAAO,IAEC,IAAXi9C,EAAGj9C,OACHi9C,EAAGj9C,KAAO,MAIE,GAAZg9C,EAAGj9C,OAA0B,GAAZk9C,EAAGl9C,OACjBi9C,EAAGh9C,MAAQ08C,GAAcM,EAAGl9C,KAAM,IAClCm9C,EAAGj9C,MAAQ08C,GAAcO,EAAGn9C,KAAM,KACrCm9C,EAAGj9C,KAAO,IAEVg9C,EAAGh9C,MAAQ08C,GAAcM,EAAGl9C,KAAMk9C,EAAGj9C,QACrCi9C,EAAGh9C,KAAO,GACK,IAAXi9C,EAAGj9C,OACHi9C,EAAGj9C,KAAO,KAGC,IAAXg9C,EAAGh9C,MAAyB,IAAXi9C,EAAGj9C,OACpBi9C,EAAGj9C,KAAO,KAKd,KAAOi9C,EAAGn9C,KAAOk9C,EAAGl9C,MAClB,IAAMm9C,EAAGl9C,MAAQi9C,EAAGj9C,QACnBk9C,EAAGj9C,KAAOg9C,EAAGh9C,KAC5B,CAEAs8C,GAAUY,UAAYJ,GAEtBR,GAAUp+C,WAAU,KAiDhB,SAASi/C,EAAMpsF,GACX,OAAQwJ,KAAKmgD,IAAI3pD,GAAKwJ,KAAKmgD,KAAK3pD,IAAM,CAC1C,CAaA,SAASqsF,EAAMrsF,GACX,OAAQwJ,KAAKmgD,IAAI3pD,GAAKwJ,KAAKmgD,KAAK3pD,IAAM,CAC1C,CA2CA,SAASssF,EAAMtsF,GACX,OAAOqsF,EAAMrsF,GAAKosF,EAAMpsF,EAC5B,CAgMA,SAASusF,EAAKloF,EAAG4O,GACb,KAAOA,GAAG,CACN,IAAI7T,EAAIiF,EAAI4O,EACZ5O,EAAI4O,EACJA,EAAI7T,CACR,CACA,OAAOiF,CACX,CAEA,SAASmoF,EAAKnoF,EAAG4O,GACb,OAAOzJ,KAAK0pB,IAAI7uB,EAAI4O,GAAKs5E,EAAKloF,EAAG4O,EACrC,CAoOA,SAASw5E,EAAO7jD,EAAMtoC,GAElB,IADA,IAAIosF,EAAS,GAAIpwF,EAAI,EAAGqwF,EAAS/jD,EAAK,GAC/BtsC,EAAIssC,EAAKxuC,QACZsyF,EAAOhzF,KAAK,CACRizF,OAAQ/jD,EAAKtsC,KACb8H,KAAMwoF,EAAchkD,EAAKtsC,QAG5B,IAAK,IAAImQ,EAAM,EAAGA,EAAMkgF,EAAOxvF,SAAUsP,EAC1Ck8C,EAAK,IAAK,IAAIv6C,EAAM,EAAGA,EAAMu+E,EAAOzvF,QAASkR,EAAK,CAC9C,IAAK9R,EAAI,EAAGA,EAAIowF,EAAOtyF,SAAUkC,EAAG,CAChC,IAAIknB,EAAMkpE,EAAOpwF,GAAGqwF,OAAOnxF,IAAIiR,EAAK2B,GACpC,IAAKs+E,EAAOpwF,GAAG8H,KAAY,MAAPof,GAAuB,KAARA,EAAa,EAAIA,GAChD,SAASmlC,CAEjB,CACAroD,EAAEmM,EAAK2B,EACX,CAER,CA9iBA,CAAE,MAAO,MAAO,MAAO,OAAQ,OAAQ,MAAO,OAAQ,MAAO,QAASvG,SAAQ,SAAS5C,GACnFumF,GAAiBvmF,EAAMuE,KAAKvE,IAAO2jC,KAAK,CACpC,CAAE,KAAM,WAEhB,IAEA4iD,GAAiB,KAAMhiF,KAAK8jC,KAAK1E,KAAK,CAClC,CAAE,KAAM,YAGZ4iD,GAAiB,OAAO,SAAS11D,EAAKzc,GAClC,OAAO7P,KAAK8jC,IAAIxX,GAAOtsB,KAAK8jC,IAAIj0B,EACpC,IAAGuvB,KAAK,CACJ,CAAE,OAAQ,YACV,CAAE,QAAS,CAAE,KAAM,WAAY,CAAE,OAAQ,MACzC,CAAE,IAAK,CAAE,SAAU,aAAc,YAGrC4iD,GAAiB,SAAS,SAAS11D,GAC/B,OAAOtsB,KAAK8jC,IAAIxX,GAAOtsB,KAAK8jC,IAAI,GACpC,IAAG1E,KAAK,CACJ,CAAE,OAAQ,cAGd4iD,GAAiB,MAAM,WACnB,OAAOhiF,KAAKqjF,EAChB,IAAGjkD,KAAK,IAER4iD,GAAiB,UAAU,SAASxrF,GAChC,OAAOwJ,KAAKygB,KAAKjqB,EAAIwJ,KAAKqjF,GAC9B,IAAGjkD,KAAK,CACJ,CAAE,OAAQ,aAGd4iD,GAAiB,WAAW,SAASsB,GACjC,OAAS,IAAMA,EAAOtjF,KAAKqjF,GAAM,GACrC,IAAGjkD,KAAK,CACJ,CAAE,WAAY,YAGlB4iD,GAAiB,WAAW,SAASuB,GACjC,OAAOvjF,KAAKqjF,GAAKE,EAAM,GAC3B,IAAGnkD,KAAK,CACJ,CAAE,WAAY,YAOlB4iD,GAAiB,OAAQY,GAAOxjD,KAAK,CACjC,CAAE,OAAQ,YAGd4iD,GAAiB,SAAS,SAASxrF,GAC/B,OAAOwJ,KAAK8jC,IAAIttC,EAAIwJ,KAAKygB,KAAKjqB,EAAI,GAAKwJ,KAAKygB,KAAKjqB,EAAI,GACzD,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,UACV,CAAE,IAAK,CAAE,SAAU,gBAOvB4iD,GAAiB,OAAQa,GAAOzjD,KAAK,CACjC,CAAE,OAAQ,YAGd4iD,GAAiB,SAAS,SAASxrF,GAC/B,OAAOwJ,KAAK8jC,IAAIttC,EAAIwJ,KAAKygB,KAAKjqB,EAAIA,EAAI,GAC1C,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,YAGd4iD,GAAiB,OAAO,SAASxrF,GAC7B,OAAO,EAAIwJ,KAAKwjF,IAAIhtF,EACxB,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,YAGd4iD,GAAiB,QAAQ,SAASxrF,GAC9B,OAAO,EAAIosF,EAAMpsF,EACrB,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,YAGd4iD,GAAiB,OAAO,SAASxrF,GAC7B,OAAO,EAAIwJ,KAAKyjF,IAAIjtF,EACxB,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,YAGd4iD,GAAiB,QAAQ,SAASxrF,GAC9B,OAAO,EAAIqsF,EAAMrsF,EACrB,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,YAGd4iD,GAAiB,SAAS,SAAShsF,EAAGqqB,GAClC,OAAOrgB,KAAK0jF,KAAKrjE,EAAIrqB,EACzB,IAAGopC,KAAK,CACJ,CAAE,KAAM,WACR,CAAE,KAAM,YAOZ4iD,GAAiB,OAAQc,GAAO1jD,KAAK,CACjC,CAAE,OAAQ,YAGd4iD,GAAiB,SAAS,SAASxrF,GAC/B,OAAOwJ,KAAK8jC,IAAI9jC,KAAKygB,KAAK,EAAIjqB,EAAEA,IAAM,EAAIA,GAC9C,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,CAAE,MAAO,SAAU,CAAE,aAAc,EAAG,OAGpD4iD,GAAiB,OAAO,SAASxrF,GAC7B,OAAO,EAAIwJ,KAAK2jF,IAAIntF,EACxB,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,aAGd4iD,GAAiB,QAAQ,SAASxrF,GAC9B,OAAO,EAAIssF,EAAMtsF,EACrB,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,aAGd4iD,GAAiB,QAAQ,SAASxrF,GAC9B,OAAOwJ,KAAKqjF,GAAK,EAAIrjF,KAAK0jF,KAAKltF,EACnC,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,YAGd4iD,GAAiB,SAAS,SAASxrF,GAC/B,OAAOwJ,KAAK8jC,KAAKttC,EAAI,IAAMA,EAAI,IAAM,CACzC,IAAG4oC,KAAK,CACJ,CAAE,OAAQ,UACV,CAAE,IAAK,CAAE,KACD,CAAE,SAAU,aACZ,CAAE,SAAU,gBAGxB4iD,GAAiB,SAAS,SAASnnF,EAAG4O,GAClC,OAAOzJ,KAAKyoC,IAAI5tC,EAAG4O,EACvB,IAAG21B,KAAK,CACJ,CAAE,KAAM,UACR,CAAE,KAAM,YAGZ4iD,GAAiB,OAAO,SAASnnF,EAAG4O,GAChC,OAAO5O,EAAI4O,CACf,IAAG21B,KAAK,CACJ,CAAE,KAAM,UACR,CAAE,KAAM,aAGZ4iD,GAAiB,YAAY,SAASnnF,EAAG4O,GACrC,OAAOzJ,KAAKgnB,MAAMnsB,EAAI4O,EAC1B,IAAG21B,KAAK,CACJ,CAAE,KAAM,UACR,CAAE,KAAM,aAGZ4iD,GAAiB,WAAW,SAAS11D,EAAK8T,GACtC,OAAOA,EAAIA,EAAIpgC,KAAK4jF,KAAKt3D,EAAM8T,GAAK,CACxC,IAAGhB,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,gBAAiB,UACnB,CAAE,IAAK,CAAE,SAAU,wCAGvB4iD,GAAiB,mBAAmB,SAAS11D,EAAK8T,GAE9C,OADAA,EAAIpgC,KAAK0pB,IAAI0W,IACFA,EAAIpgC,KAAK4jF,KAAKt3D,EAAM8T,GAAK,CACxC,IAAGhB,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,gBAAiB,CAAE,KAAM,SAAU,CAAE,OAAQ,OAGnD4I,GAAY,cAAe,mBAQ3Bg6C,GAAiB,gBAAgB,SAAS11D,EAAK8T,EAAG1Q,GAC9C,OAAK0Q,GAAM9T,GAGPA,EAAM,KAAQoD,GAAQ0Q,EAAI,GAAO1Q,GAAQ0Q,EAAI,KAC7CA,GAAKA,GAEFA,EAAIA,EAAIpgC,KAAK4jF,KAAKt3D,EAAM8T,GAAK,GALzB,CAMf,IAAGhB,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,gBAAiB,CAAE,KAAM,SAAU,CAAE,OAAQ,0BAC/C,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,OAAQ,OAG5C4iD,GAAiB,SAAS,SAAS11D,EAAK8T,GACpC,OAAOA,EAAIA,EAAIpgC,KAAKgnB,MAAMsF,EAAM8T,GAAK,CACzC,IAAGhB,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,gBAAiB,UACnB,CAAE,IAAK,CAAE,SAAU,wCAGvB4iD,GAAiB,iBAAiB,SAAS11D,EAAK8T,GAE5C,OADAA,EAAIpgC,KAAK0pB,IAAI0W,IACFA,EAAIpgC,KAAKgnB,MAAMsF,EAAM8T,GAAK,CACzC,IAAGhB,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,gBAAiB,CAAE,KAAM,SAAU,CAAE,OAAQ,OAInD4iD,GAAiB,cAAc,SAAS11D,EAAK8T,EAAG1Q,GAC5C,OAAK0Q,GAAM9T,GAGPA,EAAM,KAAQoD,GAAQ0Q,EAAI,GAAO1Q,GAAQ0Q,EAAI,KAC7CA,GAAKA,GAEFA,EAAIA,EAAIpgC,KAAKgnB,MAAMsF,EAAM8T,GAAK,GAL1B,CAMf,IAAGhB,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,gBAAiB,CAAE,KAAM,SAAU,CAAE,OAAQ,0BAC/C,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,OAAQ,OAG5C4iD,GAAiB,MAAOhiF,KAAKgnB,OAAOoY,KAAK,CACrC,CAAE,UAAW,YAGjB4iD,GAAiB,UAAU,SAAS11D,EAAKu3D,GACrC,OAAOA,EAAOA,EAAO7jF,KAAKsjC,MAAMhX,EAAMu3D,GAAQ,CAClD,IAAGzkD,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,YAAa,YAGnB4iD,GAAiB,SAAS,SAAS11D,EAAKx2B,GACpC,IAAI0qC,EAAOlU,EAAM,GAAK,EAAI,EAK1B,OAJIkU,EAAO,IAAKlU,GAAOA,GACvBx2B,EAASkK,KAAKyoC,IAAI,GAAI3yC,GACtBw2B,EAAM9H,GAAe8H,EAAMx2B,GAEpB0qC,GADPlU,EAAMtsB,KAAKsjC,MAAMhX,IACGx2B,CACxB,IAAGspC,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,UAAW,YAGjB4iD,GAAiB,WAAW,SAAS11D,EAAKx2B,GAItC,OAHAA,EAASkK,KAAKyoC,IAAI,GAAI3yC,IAEtBw2B,GADAA,EAAM9H,GAAe8H,EAAMx2B,IACf,EAAIkK,KAAKgnB,MAAMsF,GAAOtsB,KAAK4jF,KAAKt3D,IAC/Bx2B,CACjB,IAAGspC,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,UAAW,YAGjB4iD,GAAiB,aAAa,SAAS11D,EAAKx2B,GAIxC,OAHAA,EAASkK,KAAKyoC,IAAI,GAAI3yC,IAEtBw2B,GADAA,EAAM9H,GAAe8H,EAAMx2B,IACf,EAAIkK,KAAK4jF,KAAKt3D,GAAOtsB,KAAKgnB,MAAMsF,IAC/Bx2B,CACjB,IAAGspC,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,UAAW,YAGjB4iD,GAAiB,QAAQ,SAAS11D,GAC9B,IAAI91B,EAAI81B,EAAM,EAAItsB,KAAKgnB,MAAMsF,GAAOtsB,KAAK4jF,KAAKt3D,GAC9C,OAAO91B,EAAI,EAAIA,GAAKA,EAAI,GAAK,EAAI,GAAKA,CAC1C,IAAG4oC,KAAK,CACJ,CAAE,UAAW,YAGjB4iD,GAAiB,OAAO,SAAS11D,GAC7B,IAAI91B,EAAI81B,EAAM,EAAItsB,KAAKgnB,MAAMsF,GAAOtsB,KAAK4jF,KAAKt3D,GAC9C,OAAO91B,EAAI,EAAIA,EAAIA,GAAKA,EAAI,GAAK,EAAI,EACzC,IAAG4oC,KAAK,CACJ,CAAE,UAAW,YAGjB4iD,GAAiB,QAAQ,SAAS11D,GAC9B,OAAOA,EAAM,GAAK,EAAIA,EAAM,EAAI,EAAI,CACxC,IAAG8S,KAAK,CACJ,CAAE,UAAW,YAgBjB4iD,GAAiB,OAAO,SAAS5iD,GAE7B,IADA,IAAIvkC,EAAIukC,EAAK,GACJtsC,EAAI,EAAGA,EAAIssC,EAAKxuC,SAAUkC,EAC/B+H,EAAIkoF,EAAKloF,EAAGukC,EAAKtsC,IAErB,OAAO+H,CACX,IAAGukC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,aAG9B4iD,GAAiB,OAAO,SAAS5iD,GAE7B,IADA,IAAIvkC,EAAIukC,EAAK,GACJtsC,EAAI,EAAGA,EAAIssC,EAAKxuC,SAAUkC,EAC/B+H,EAAImoF,EAAKnoF,EAAGukC,EAAKtsC,IAErB,OAAO+H,CACX,IAAGukC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,aAG9B4iD,GAAiB,OAAO,SAAS8B,GAC7B,OAAOA,EAAQ19D,QAAO,SAASiW,EAAK/P,GAChC,OAAO+P,EAAM/P,CACjB,GAAG,EACP,IAAG8S,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,aAG9B4iD,GAAiB,WAAW,SAAS8B,GACjC,OAAOA,EAAQ19D,QAAO,SAAS29D,EAAMz3D,GACjC,OAAOy3D,EAAOz3D,CAClB,GAAG,EACP,IAAG8S,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,aAG9B4iD,GAAiB,cAAc,SAAS//D,EAAO/E,GAC3C,IAAImf,EAAM,EAaV,OAZApa,EAAM8a,MAAK,SAASuoB,EAAGriD,EAAK2B,GACxB,GAAgB,iBAAL0gD,EAAe,CACtB,IAAK,IAAIxyD,EAAI,EAAGA,EAAIoqB,EAAKtsB,SAAUkC,EAAG,CAClC,IAAIiD,EAAImnB,EAAKpqB,GAAGd,IAAIiR,EAAK2B,GACzB,GAAgB,iBAAL7O,EACP,OAEJuvD,GAAKvvD,CACT,CACAsmC,GAAOipB,CACX,CACJ,IACOjpB,CACX,IAAG+C,KAAK,CACJ,CAAE,KAAM,UACR,CAAE,IACF,CAAE,KAAM,CAAE,MAAO,SACL,CAAE,SAAU,0BACZ,CAAE,SAAU,iCAG5B4iD,GAAiB,SAAS,SAAS8B,GAC/B,OAAOA,EAAQ19D,QAAO,SAASiW,EAAK/P,GAChC,OAAO+P,EAAM/P,EAAMA,CACvB,GAAG,EACP,IAAG8S,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,aAG9B4iD,GAAiB,YAAY,SAASnnF,EAAG4O,GACrC,IAAI4yB,EAAM,EAOV,OANAxhC,EAAEkiC,MAAK,SAAS/mC,EAAGiN,EAAK2B,GACpB,IAAIyb,EAAI5W,EAAEzX,IAAIiR,EAAK2B,GACH,iBAAL5O,GAA6B,iBAALqqB,IAC/Bgc,GAAOrmC,EAAEA,EAAIqqB,EAAEA,EAEvB,IACOgc,CACX,IAAG+C,KAAK,CACJ,CAAE,IAAK,UACP,CAAE,IAAK,CAAE,MAAO,SACR,CAAE,SAAU,wBACZ,CAAE,SAAU,8BAGxB4iD,GAAiB,YAAY,SAASnnF,EAAG4O,GACrC,IAAI4yB,EAAM,EAOV,OANAxhC,EAAEkiC,MAAK,SAAS/mC,EAAGiN,EAAK2B,GACpB,IAAIyb,EAAI5W,EAAEzX,IAAIiR,EAAK2B,GACH,iBAAL5O,GAA6B,iBAALqqB,IAC/Bgc,GAAOrmC,EAAEA,EAAIqqB,EAAEA,EAEvB,IACOgc,CACX,IAAG+C,KAAK,CACJ,CAAE,IAAK,UACP,CAAE,IAAK,CAAE,MAAO,SACR,CAAE,SAAU,wBACZ,CAAE,SAAU,8BAGxB4iD,GAAiB,WAAW,SAASnnF,EAAG4O,GACpC,IAAI4yB,EAAM,EAOV,OANAxhC,EAAEkiC,MAAK,SAAS/mC,EAAGiN,EAAK2B,GACpB,IAAIyb,EAAI5W,EAAEzX,IAAIiR,EAAK2B,GACH,iBAAL5O,GAA6B,iBAALqqB,IAC/Bgc,IAAQrmC,EAAIqqB,IAAMrqB,EAAIqqB,GAE9B,IACOgc,CACX,IAAG+C,KAAK,CACJ,CAAE,IAAK,UACP,CAAE,IAAK,CAAE,MAAO,SACR,CAAE,SAAU,wBACZ,CAAE,SAAU,8BAGxB4iD,GAAiB,aAAa,SAAShsF,EAAGQ,EAAGJ,EAAGyE,GAC5C,IAAIwhC,EAAM,EAQV,OAPAxhC,EAAEkiC,MAAK,SAASinD,GACZ,GAAmB,iBAARA,EACP,MAAM,IAAI/B,GAAY,SAE1B5lD,GAAO2nD,EAAOhkF,KAAKyoC,IAAIzyC,EAAGQ,GAC1BA,GAAKJ,CACT,IACOimC,CACX,IAAG+C,KAAK,CACJ,CAAE,IAAK,UACP,CAAE,IAAK,UACP,CAAE,IAAK,UACP,CAAE,IAAK,YAGX4iD,GAAiB,OAAO,SAAS8B,GAC7B,OAAOA,EAAQlzF,OAASoP,KAAKC,IAAI7I,MAAM4I,KAAM8jF,GAAW,CAC5D,IAAG1kD,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,cAG9B4iD,GAAiB,OAAO,SAAS8B,GAC7B,OAAOA,EAAQlzF,OAASoP,KAAKmK,IAAI/S,MAAM4I,KAAM8jF,GAAW,CAC5D,IAAG1kD,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,cAG9B4iD,GAAiB,UAAU,SAAStrF,GAChC,OAAOA,EAAO9F,MAClB,IAAGwuC,KAAK,CACJ,CAAE,SAAU,CAAE,WAAY,eAG9B4iD,GAAiB,SAAS,SAAS8B,GAC/B,OAAOA,EAAQlzF,MACnB,IAAGwuC,KAAK,CACJ,CAAE,UAAW,CAAE,WAAY,aAG/B4iD,GAAiB,eAAe,SAAStrF,GACrC,IAAIkZ,EAAQ,EAAGq0E,EAAO,GAOtB,OANAvtF,EAAO2H,SAAQ,SAAS2b,GAChBiqE,EAAKnjF,QAAQkZ,GAAO,IACpBpK,IACAq0E,EAAK/zF,KAAK8pB,GAElB,IACOpK,CACX,IAAGwvB,KAAK,CACJ,CAAE,SAAU,CAAE,WAAY,eAG9B4iD,GAAiB,cAAc,SAASnnF,GACpC,IAAI+U,EAAQ,EACZ,SAAS0uB,EAAItkB,GACE,MAAPA,GAAuB,KAARA,GACfpK,GAER,CAYA,OAXA,SAAcwvB,GACV,IAAK,IAAItsC,EAAI,EAAGA,EAAIssC,EAAKxuC,SAAUkC,EAAG,CAClC,IAAIkD,EAAIopC,EAAKtsC,GACTkD,aAAa6gC,GACb7gC,EAAE+mC,KAAKuB,GAAK,GAEZA,EAAItoC,EAEZ,CACJ,CACAkf,CAAKra,GACE+U,CACX,IAAGwvB,KAAK,CACJ,CAAE,IAAK,CAAE,OAAQ,CAAE,KAAM,SAAU,gBAGvC4iD,GAAiB,UAAU,SAAS11D,GAChC,OAAOA,EAAM,GAAM,CACvB,IAAG8S,KAAK,CACJ,CAAE,UAAW,YAGjB4iD,GAAiB,SAAS,SAAS11D,GAC/B,OAAOA,EAAM,GAAM,CACvB,IAAG8S,KAAK,CACJ,CAAE,UAAW,YAGjB4iD,GAAiB,KAAK,SAAShoE,GAC3B,MAAkB,kBAAPA,EACAA,EAAM,EAAI,EAEH,iBAAPA,EACAA,EAEJ,CACX,IAAGolB,KAAK,CACJ,CAAE,SAAU,cAGhB4iD,GAAiB,MAAM,WACnB,OAAO,IAAIC,GAAY,MAC3B,IAAG7iD,KAAK,IA6BR,IAAI8kD,EAAgB,CAChB,CAAE,KAAM,UACR,CAAE,KAAM,YACR,CAAE,CAAE,KAAM,UACV,CAAE,KAAM,cAGZlC,GAAiB,YAAY,SAASmC,EAAIn5D,EAAI9N,GAC1C,IAAItN,EAAQ,EAGZ,OAFAsN,EAAKoB,QAAQ6lE,EAAIn5D,GACjBi4D,EAAO/lE,GAAM,WAAYtN,GAAS,IAC3BA,CACX,IAAGwvB,KAAK8kD,GAER,IAAIE,EAAc,CACd,CAAE,QAAS,WACbphF,OAAOkhF,GAETlC,GAAiB,UAAU,SAAS5kF,EAAO+mF,EAAIn5D,EAAIoU,GAI/CA,EAAK9gB,QAAQlhB,EAAOinF,EAAkBF,EAAIn5D,GAC1C,IAAIqR,EAAM,EAOV,OANA4mD,EAAO7jD,GAAM,SAASn8B,EAAK2B,GACvB,IAAIoV,EAAM5c,EAAMpL,IAAIiR,EAAK2B,GACrBoV,IACAqiB,GAAOriB,EAEf,IACOqiB,CACX,IAAG+C,KAAKglD,GAGRpC,GAAiB,cAAc,SAAS5kF,EAAO+mF,EAAIn5D,EAAIoU,GACnDA,EAAK9gB,QAAQlhB,EAAOinF,EAAkBF,EAAIn5D,GAC1C,IAAIqR,EAAM,EAAGzsB,EAAQ,EASrB,OARAqzE,EAAO7jD,GAAM,SAASn8B,EAAK2B,GACvB,IAAIoV,EAAM5c,EAAMpL,IAAIiR,EAAK2B,GACd,MAAPoV,GAAuB,KAARA,IACfA,EAAM,GAEVqiB,GAAOriB,EACPpK,GACJ,IACOA,EAAQysB,EAAMzsB,EAAQ,IAAIqyE,GAAY,QACjD,IAAG7iD,KAAKglD,GAERpC,GAAiB,WAAW,SAASmB,EAAQr1B,GACzCA,EAAWs1B,EAAct1B,GACzB,IAAIl+C,EAAQ,EAMZ,OALAuzE,EAAOpmD,MAAK,SAAS/iB,GACb8zC,EAAS9zC,IACTpK,GAER,IACOA,CACX,IAAGwvB,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,YAAa,cAGnB,IAmEUomB,EAnEN8+B,EAAa,CACb,CAAE,QAAS,UACX,CAAE,YAAa,YACf,CAAE,WAAY,CAAE,KAAM,OAAQ,UAAW,CAAE,OAAQ,aAGvD,SAASC,EAAcC,GACnB,OAAO,SAASrmF,EAAUf,EAAO0wD,EAAU22B,GACvC,IAAIr1F,EAAOG,KACX,GAAIk1F,aAAoBz3D,GAAK,CAUzB,IAAIp3B,EAAI6uF,EAASzlF,QAAQR,aACzB,GAAI5I,EAAElC,SAAW0J,EAAM1J,OAASkC,EAAEjC,UAAYyJ,EAAMzJ,OAShD,OARK0zB,SAASzxB,EAAEwK,QAAQ6C,OACpBrN,EAAEwK,QAAQ6C,IAAM,GAEfokB,SAASzxB,EAAEwK,QAAQwE,OACpBhP,EAAEwK,QAAQwE,IAAM,GAEpBhP,EAAEkU,YAAY7G,IAAMrN,EAAEwK,QAAQ6C,IAAM7F,EAAMzJ,OAAS,EACnDiC,EAAEkU,YAAYlF,IAAMhP,EAAEwK,QAAQwE,IAAMxH,EAAM1J,MAAQ,EAC3CtE,EAAK0uC,aAAa,CAAEloC,IAAK,WAC5BuI,EAASqmF,EAAapnF,EAAO0wD,EAAU1+D,EAAK8uC,SAAStoC,IACzD,GAER,CACAuI,EAASqmF,EAAapnF,EAAO0wD,EAAU1+D,EAAK8uC,SAASumD,IACzD,CACJ,CA8DA,SAASC,EAAKZ,GACV,OAAOA,EAAQ19D,QAAO,SAASiW,EAAK/P,GAChC,OAAO+P,EAAM/P,CACjB,GAAG,GAAKw3D,EAAQlzF,MACpB,CAEA,SAAS+zF,EAAQb,EAASc,EAASC,GAI/B,OAHW,MAAPA,IACAA,EAAMH,EAAKZ,IAERA,EAAQ19D,QAAO,SAASiW,EAAK/P,GAChC,OAAO+P,EAAMr8B,KAAKyoC,IAAInc,EAAMu4D,EAAK,EACrC,GAAG,GAAKD,CACZ,CAEA,SAASE,EAAUhB,EAASc,GACxB,OAAO5kF,KAAKygB,KAAKkkE,EAAQb,EAASc,GACtC,CA4MA,SAASG,EAAajB,EAAS9tF,EAAGgvF,GAC9B,IAAIC,EAAM,EAAGC,EAAM,EAAGl2E,EAAO,KAAME,EAAQ,KAAMgxE,GAAQ,EAYzD,OAXA4D,EAAQzlF,SAAQ,SAASiuB,GACjBA,EAAMt2B,GACNivF,IACAj2E,EAAe,MAARA,EAAesd,EAAMtsB,KAAKmK,IAAI6E,EAAMsd,IACpCA,EAAMt2B,GACbkvF,IACAh2E,EAAiB,MAATA,EAAgBod,EAAMtsB,KAAKC,IAAIiP,EAAOod,IAE9C4zD,GAAQ,CAEhB,IACK+E,GAAQC,EAGThF,EACI8E,GACQC,EAAM,IAAMnB,EAAQlzF,OAAS,GAElCq0F,GAAOA,EAAMC,KAEfh2E,EAAQlZ,GAAK+uF,EAAajB,EAAS90E,EAAMg2E,IACzChvF,EAAIgZ,GAAQ+1E,EAAajB,EAAS50E,EAAO81E,KAAS91E,EAAQF,GATxD,IAAIizE,GAAY,MAU/B,CAjTAD,GAAiB,QAASuC,GAAc,SAASnnF,EAAO0wD,EAAU22B,GAC9D,IAAIpoD,EAAM,EAUV,OATAyxB,EAAWs1B,EAAct1B,GACzB1wD,EAAM2/B,MAAK,SAAS/iB,EAAK/W,EAAK2B,GAC1B,GAAIkpD,EAAS9zC,GAAM,CACf,IAAIjkB,EAAI0uF,EAASzyF,IAAIiR,EAAK2B,GACtBy/E,EAAiBtuF,KACjBsmC,GAAOtmC,GAAK,EAEpB,CACJ,IACOsmC,CACX,KAAIgI,UAAUigD,GAEdtC,GAAiB,YAAauC,GAAc,SAASnnF,EAAO0wD,EAAU22B,GAClE,IAAIpoD,EAAM,EAAGzsB,EAAQ,EAWrB,OAVAk+C,EAAWs1B,EAAct1B,GACzB1wD,EAAM2/B,MAAK,SAAS/iB,EAAK/W,EAAK2B,GAC1B,GAAIkpD,EAAS9zC,GAAM,CACf,IAAIjkB,EAAI0uF,EAASzyF,IAAIiR,EAAK2B,GACtBy/E,EAAiBtuF,KACjBsmC,GAAOtmC,GAAK,EACZ6Z,IAER,CACJ,IACOA,EAAQysB,EAAMzsB,EAAQ,IAAIqyE,GAAY,QACjD,KAAI59C,UAAUigD,IAEJ9+B,EAOP,SAAS/pD,EAAM6hB,GACd0kE,GAAiBvmF,GAAM,SAAS0nF,EAAQgC,GACpC,IAAIrB,EAAU,GACV9lD,EAAQmlD,EAAOpmD,MAAK,SAAS/iB,GAC7B,GAAIA,aAAeioE,GACf,OAAOjoE,EAEO,iBAAPA,GACP8pE,EAAQ5zF,KAAK8pB,EAErB,IACA,OAAIgkB,IAGAmnD,EAAMrB,EAAQlzF,OACP,IAAIqxF,GAAY,OAEpB3kE,EAAQwmE,EAASqB,EAAM,GAClC,IAAG/lD,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,OAAQ,aAElB,GA5BQ,SAAS,SAAS0kD,EAASqB,GAC3B,OAAOrB,EAAQrxF,KAAK2yF,GAAYD,EACpC,IACA3/B,EAAI,SAAS,SAASs+B,EAASqB,GAC3B,OAAOrB,EAAQrxF,KAAKqa,GAAWq4E,EACnC,IA6CJnD,GAAiB,WAAW,SAAS8B,GACjC,OAAOgB,EAAUhB,EAASA,EAAQlzF,OAAS,EAC/C,IAAGwuC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,WAC1B,CAAE,IAAK,CAAE,SAAU,uBAAwB,UAI/C4iD,GAAiB,WAAW,SAAS8B,GACjC,OAAOgB,EAAUhB,EAASA,EAAQlzF,OACtC,IAAGwuC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,YAC1B,CAAE,IAAK,CAAE,SAAU,uBAAwB,UAG/C4iD,GAAiB,SAAS,SAAS8B,GAC/B,OAAOa,EAAQb,EAASA,EAAQlzF,OAAS,EAC7C,IAAGwuC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,WAC1B,CAAE,IAAK,CAAE,SAAU,uBAAwB,UAG/C4iD,GAAiB,SAAS,SAAS8B,GAC/B,OAAOa,EAAQb,EAASA,EAAQlzF,OACpC,IAAGwuC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,WAC1B,CAAE,IAAK,CAAE,SAAU,uBAAwB,UAG/C4iD,GAAiB,UAAU,SAAS8B,GAChC,IAAIttF,EAAIstF,EAAQlzF,OAEhB,OADAkzF,EAAQrxF,KAAKqa,GACTtW,EAAI,EAEGstF,EAAQttF,GAAK,IAGhBstF,EAAQttF,IAAM,GAAKstF,EAAQttF,EAAI,IAAM,CACjD,IAAG4oC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,WAC1B,CAAE,IAAK,CAAE,SAAU,sBAAuB,UAG9C4iD,GAAiB,aAAa,SAAS8B,GACnCA,EAAQrxF,KAAKqa,GAEb,IADA,IAAIzW,EAAO,KAAMuZ,EAAQ,EAAGzF,EAAM,EAAGulB,EAAO,KACnC58B,EAAI,EAAGA,EAAIgxF,EAAQlzF,SAAUkC,EAAG,CACrC,IAAI0D,EAAIstF,EAAQhxF,GACZ0D,GAAKH,GACLuZ,EAAQ,EACRvZ,EAAOG,GAEPoZ,IAEAA,EAAQzF,IACRA,EAAMyF,EACN8f,EAAOl5B,EAEf,CACA,OAAe,MAARk5B,EAAe,IAAIuyD,GAAY,OAASvyD,CACnD,IAAG0P,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,aAG9B4iD,GAAiB,aAAa,SAAS8B,GACnC,IAAIG,EAAOjtF,OAAOC,OAAO,MAAOkT,EAAM,EAAGk7E,EAAM,GAC/CvB,EAAQzlF,SAAQ,SAASiuB,GACrB,IAAI8T,EAAI6jD,EAAK33D,IAAQ,EACrB23D,EAAK33D,KAAS8T,EACVA,GAAKj2B,EACLk7E,EAAIn1F,KAAKo8B,GACF8T,EAAIj2B,IACXA,EAAMi2B,EACNilD,EAAM,CAAE/4D,GAEhB,IACA,IAAIl2B,EAAI,IAAIygC,GAAOtnC,MAInB,OAHA81F,EAAIhnF,SAAQ,SAASiuB,EAAKx5B,GACtBsD,EAAEytB,IAAI/wB,EAAG,EAAGw5B,EAChB,IACOl2B,CACX,IAAGgpC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,aAG9B4iD,GAAiB,WAAW,SAAS8B,GACjC,IAAIttF,EAAIstF,EAAQlzF,OACZ00D,EAAIw+B,EAAQ19D,QAAO,SAASk/B,EAAGh5B,GAC/B,GAAIA,EAAM,EACN,MAAM,IAAI21D,GAAY,OAE1B,OAAO38B,EAAIh5B,CACf,GAAG,GACH,OAAOtsB,KAAKyoC,IAAI6c,EAAG,EAAE9uD,EACzB,IAAG4oC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,WAC1B,CAAE,IAAK,CAAE,SAAU,sBAAuB,UAG9C4iD,GAAiB,WAAW,SAAS8B,GAQjC,OAPQA,EAAQlzF,OACRkzF,EAAQ19D,QAAO,SAASga,EAAG9T,GAC/B,IAAKA,EACD,MAAM,IAAI21D,GAAY,SAE1B,OAAO7hD,EAAI,EAAI9T,CACnB,GAAG,EAEP,IAAG8S,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,WAC1B,CAAE,IAAK,CAAE,SAAU,sBAAuB,UAG9C4iD,GAAiB,YAAY,SAAS8B,EAASx+B,GAC3C,IAAI9uD,EAAIstF,EAAQlzF,OAChBkzF,EAAQrxF,KAAKqa,GACb,IAAIw4E,EAAUtlF,KAAKgnB,MAAMxwB,EAAI8uD,GACzBggC,EAAU,KACRA,EAIN,IADA,IAAIjpD,EAAM,EACDvpC,EAFTwyF,GAAW,EAEWxyF,EAAI0D,EAAE8uF,IAAWxyF,EACnCupC,GAAOynD,EAAQhxF,GAEnB,OAAOupC,GAAO7lC,EAAc,EAAV8uF,EACtB,IAAGlmD,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,UAAW,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAClD,CAAE,IAAK,CAAE,SAAU,sBAAuB,UAG9C4iD,GAAiB,aAAa,SAASjoF,EAAMwrF,GAGzCxrF,EAAKtH,KAAKqa,GACVy4E,EAAK9yF,KAAKqa,GACV,IAAIzW,GAAQ4Y,IACRnc,EAAI,EACR,SAAS8c,EAAMzF,GAEX,IADA,IAAI3T,EAAI,EACD1D,EAAIiH,EAAKnJ,QAAUmJ,EAAKjH,GAAKuD,GAAQ0D,EAAKjH,IAAMqX,KACjD3T,IAAK1D,EAEX,OAAO0D,CACX,CACA,IAAIJ,EAAI,IAAIygC,GAAOtnC,MAOnB,OANAg2F,EAAKlnF,SAAQ,SAAS2b,EAAKlnB,GACvB,IAAI0D,EAAIoZ,EAAMoK,GACd3jB,EAAO2jB,EACP5jB,EAAEytB,IAAI/wB,EAAG,EAAG0D,EAChB,IACAJ,EAAEytB,IAAIztB,EAAEzC,OAAQ,EAAGoG,EAAKnJ,OAASkC,GAC1BsD,CACX,IAAGgpC,KAAK,CACJ,CAAE,OAAQ,CAAE,UAAW,SAAU,IACjC,CAAE,OAAQ,CAAE,UAAW,SAAU,MAGrC4iD,GAAiB,WAAW,SAAShoE,EAAK8pE,EAAS0B,GAC/C1B,EAAQrxF,KAAK+yF,EAAM14E,EAAYs4E,GAC/B,IAAI/vF,EAAMyuF,EAAQhjF,QAAQkZ,GAC1B,OAAO3kB,EAAM,EAAI,IAAI4sF,GAAY,OAAS5sF,EAAM,CACpD,IAAG+pC,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,QAAQ,OAG5C4I,GAAY,OAAQ,WAEpBg6C,GAAiB,YAAY,SAAShoE,EAAK8pE,EAAS0B,GAChD1B,EAAQrxF,KAAK+yF,EAAM14E,EAAYs4E,GAC/B,IAAI/vF,EAAMyuF,EAAQhjF,QAAQkZ,GAC1B,GAAI3kB,EAAM,EACN,OAAO,IAAI4sF,GAAY,OAE3B,IAAK,IAAInvF,EAAIuC,EAAKyuF,EAAQhxF,IAAMknB,IAAOlnB,GACvC,OAAQuC,EAAMvC,EAAI,GAAK,CAC3B,IAAGssC,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,UAAW,CAAE,UAAW,WAC1B,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,QAAQ,OAI5C4iD,GAAiB,QAAQ,SAAS8B,GAC9B,IAAIttF,EAAIstF,EAAQlzF,OACZi0F,EAAMH,EAAKZ,GACX2B,EAAWd,EAAQb,EAASttF,EAAE,EAAGquF,GACjCa,EAAS1lF,KAAKygB,KAAKglE,GAIvB,OAAOjvF,GAAGA,EAAE,KAAKA,EAAE,IAAIA,EAAE,IAAIA,EAAE,IAHrBstF,EAAQ19D,QAAO,SAASiW,EAAK/P,GACnC,OAAO+P,EAAMr8B,KAAKyoC,KAAKnc,EAAMu4D,GAAOa,EAAQ,EAChD,GAAG,GAEG,EAAE1lF,KAAKyoC,IAAIjyC,EAAE,EAAG,KAAKA,EAAE,IAAIA,EAAE,GACvC,IAAG4oC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,WAC1B,CAAE,IAAK,CAAE,SAAU,uBAAwB,UA6B/C,IAAIumD,EAAmB,CACnB,CAAE,QAAS,CAAE,UAAW,SAAU,IAClC,CAAE,IAAK,UACP,CAAE,eAAgB,CAAE,KAAM,CAAE,OAAQ,GAAK,cACzC,CAAE,IAAK,CAAE,SAAU,oBAAqB,SAiB5C,SAASC,EAAY5vF,EAAGqqB,EAAGukE,GAKvB,IAJA,IAAIvoD,EAAM,EACNwpD,EAAKnB,EAAK1uF,GACV8vF,EAAKpB,EAAKrkE,GACV7pB,EAAIR,EAAEpF,OACDkC,EAAI,EAAGA,EAAI0D,IAAK1D,EACrBupC,IAAQrmC,EAAElD,GAAK+yF,IAAOxlE,EAAEvtB,GAAKgzF,GAEjC,OAAOzpD,EAAMuoD,CACjB,CAvBA5C,GAAiB,mBAAmB,SAAS8B,EAAS9tF,EAAG+vF,GACrD,IAAIzgC,EAAIy/B,EAAajB,EAAS9tF,EAAG,GAEjC,OADAsvD,EAAIA,EAAEq7B,QAAQoF,EAAe,GACtB3iC,WAAWkC,EAAErrC,OAAO,EAAGqrC,EAAE10D,OAAS,GAC7C,IAAGwuC,KAAKumD,GAER3D,GAAiB,mBAAmB,SAAS8B,EAAS9tF,EAAG+vF,GACrD,IAAIzgC,EAAIy/B,EAAajB,EAAS9tF,EAAG,GAEjC,OADAsvD,EAAIA,EAAEq7B,QAAQoF,EAAe,GACtB3iC,WAAWkC,EAAErrC,OAAO,EAAGqrC,EAAE10D,OAAS,GAC7C,IAAGwuC,KAAKumD,GAER39C,GAAY,cAAe,mBAa3Bg6C,GAAiB,gBAAgB,SAAShsF,EAAGqqB,GACzC,OAAOulE,EAAY5vF,EAAGqqB,EAAGrqB,EAAEpF,OAC/B,IAAGwuC,KAAK,CACJ,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,IAAK,CAAE,SAAU,mCAAoC,QACvD,CAAE,IAAK,CAAE,SAAU,qBAAsB,YAG7C4iD,GAAiB,gBAAgB,SAAShsF,EAAGqqB,GACzC,OAAOulE,EAAY5vF,EAAGqqB,EAAGrqB,EAAEpF,OAAS,EACxC,IAAGwuC,KAAK,CACJ,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,IAAK,CAAE,SAAU,mCAAoC,QACvD,CAAE,IAAK,CAAE,SAAU,qBAAsB,YAG7C4I,GAAY,QAAS,gBAIrB,IAAIg+C,EAAQl1F,GAAK+F,SAAQ,SAASL,GAC9B,IAAK,IAAI1D,EAAI,EAAGmzF,EAAO,EAAGnzF,GAAK0D,IAAK1D,EAChCmzF,GAAQnzF,EAEZ,OAAOmzF,CACX,IAEAjE,GAAiB,OAAQgE,GAAO5mD,KAAK,CACjC,CAAE,KAAM,cAGZ4iD,GAAiB,cAAc,SAASxrF,GACpC,IAAK,IAAI1D,EAAI,GAAO,EAAF0D,GAAMyvF,EAAO,EAAGnzF,GAAK0D,EAAG1D,GAAK,EAC3CmzF,GAAQnzF,EAEZ,OAAOmzF,CACX,IAAG7mD,KAAK,CACJ,CAAE,KAAM,cAGZ4iD,GAAiB,eAAe,SAAS8B,GACrC,IAAIxvE,EAAM,EAAG+nB,EAAM,EAQnB,OAPAynD,EAAQzlF,SAAQ,SAAS7H,GACrB,GAAIA,EAAI,EACJ,MAAM,IAAIyrF,GAAY,OAE1B5lD,GAAO7lC,EACP8d,GAAO0xE,EAAMxvF,EACjB,IACOwvF,EAAM3pD,GAAO/nB,CACxB,IAAG8qB,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,aAG9B,IAAI8mD,EAAgBp1F,GAAK+F,SAAQ,SAAUL,EAAGoqC,GAC1C,IAAK,IAAIulD,EAAKvlD,EAAI,EAAGwlD,EAAK,EAAGC,EAAK,EAAGC,EAAK,EAAGF,GAAM5vF,EAAIoqC,IAAKulD,IAAMC,EAC9DC,GAAMF,EACNG,GAAMF,EAEV,OAAOC,EAAGC,CACd,IAyCA,SAASC,EAAYzC,EAAS0C,GAC1B1C,EAAQrxF,KAAKqa,GACb,IAAItW,EAAIstF,EAAQlzF,OACZgwC,EAAW,EAAP4lD,EAAUrwF,EAAIqwF,EAAO5lD,EAC7B,OAAU,IAANA,EACOkjD,EAAQ,GAEfljD,GAAKpqC,EACEstF,EAAQttF,EAAI,GAGhBstF,IADLljD,GACkBzqC,GAAK2tF,EAAQljD,EAAI,GAAKkjD,EAAQljD,GACtD,CAEA,SAAS6lD,EAAgB3C,EAASx+B,GAG9B,OAAOihC,EAAYzC,EADRx+B,GAAKw+B,EAAQlzF,OAAS,GAAK,EAE1C,CAEA,SAAS81F,EAAgB5C,EAASx+B,GAG9B,OAAOihC,EAAYzC,EADRx+B,GAAKw+B,EAAQlzF,OAAS,GAErC,CA/DAoxF,GAAiB,SAAUkE,GAAe9mD,KAAK,CAC3C,CAAE,KAAM,aACR,CAAE,KAAM,CAAE,MAAO,UAAW,CAAE,YAAa,EAAG,UAGlD4iD,GAAiB,WAAW,SAASxrF,EAAGoqC,GACpC,OAAOslD,EAAc1vF,EAAIoqC,EAAI,EAAGpqC,EAAI,EACxC,IAAG4oC,KAAK,CACJ,CAAE,KAAM,aACR,CAAE,KAAM,CAAE,MAAO,UAAW,CAAE,YAAa,EAAG,UAKlD4iD,GAAiB,WAAW,SAAS8B,GAIjC,OAHUA,EAAQ19D,QAAO,SAASiW,EAAK/P,GACnC,OAAO+P,EAAM/P,CACjB,GAAG,GACUw3D,EAAQlzF,MACzB,IAAGwuC,KAAK,CAGJ,CAAE,UAAW,CAAE,UAAW,YAC1B,CAAE,IAAK,CAAE,SAAU,sBAAuB,YAG9C4iD,GAAiB,YAAY,SAAStrF,GAClC,IAAI2lC,EAAM,EAAGzsB,EAAQ,EAOrB,OANAlZ,EAAO2H,SAAQ,SAASiuB,GACF,iBAAPA,IACP+P,GAAO/P,KAET1c,CACN,IACOA,EAAQysB,EAAMzsB,EAAQ,IAAIqyE,GAAY,QACjD,IAAG7iD,KAAK,CACJ,CAAE,SAAU,CAAE,UAAW,eA6B7B4iD,GAAiB,iBAAkByE,GAAiBrnD,KAAK,CACrD,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,OAGhD4iD,GAAiB,iBAAkB0E,GAAiBtnD,KAAK,CACrD,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,OAGhD4iD,GAAiB,gBAAgB,SAAS8B,EAASrJ,GAC/C,OAAOgM,EAAgB3C,EAASrJ,EAAU,EAC9C,IAAGr7C,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MAGzC4iD,GAAiB,gBAAgB,SAAS8B,EAASrJ,GAC/C,OAAOiM,EAAgB5C,EAASrJ,EAAU,EAC9C,IAAGr7C,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MAGzC4I,GAAY,WAAY,gBACxBA,GAAY,aAAc,kBAE1B,IAAI2+C,EAAkB,CAClB,UAAW,QAAS,SAAU,MAAO,MAAO,UAC5C,UAAW,UAAW,MAAO,QAAS,QAAS,SAC/C,YAAa,QAAS,QAAS,iBAC/B,eAAgB,iBAAkB,gBAGtC,SAASC,EAAwBx3F,EAAMgwC,EAAMvvC,GACzC,IAAI6G,EAAS,GAwCb,OApCA,SAAUmwF,EAAYznD,GAClB,GAAIA,aAAgBpS,GAChB59B,EAAKmvC,YAAYa,GAAM,GAAM/gC,SAAQ,SAASgF,GAC1C,IAAI5R,EAAQ4R,EAAK5R,MACjB,KAPiB,EAOZ5B,GAAqCwT,EAAKwwB,QAA/C,CAGA,GAAIxwB,EAAKmiB,QAAS,CAGd,IAAI5yB,EAAMyQ,EAAKmiB,QAAQxI,MAAM3Z,EAAKJ,IAAKI,EAAKuB,KAC5C,GAAI,mCAAmCpN,KAAK5E,MAZnC,EAaC/C,GACF,MAGZ,CAlBY,EAmBPA,GAAgC4B,aAAiBwwF,KAGlC,iBAATxwF,GAAqBA,aAAiBwwF,KAC7CvrF,EAAOxG,KAAKuB,EAfhB,CAiBJ,SACG,GAAI44B,MAAM4T,QAAQmB,GACrB,IAAK,IAAItsC,EAAI,EAAGA,EAAIssC,EAAKxuC,SAAUkC,EAC/B+zF,EAAYznD,EAAKtsC,SAEdssC,aAAgBvI,GACvBuI,EAAKrC,KAAK8pD,IACY,iBAARznD,GAEPA,aAAgB6iD,MAlCP,EAkCwBpyF,KADxC6G,EAAOxG,KAAKkvC,EAInB,CAnCD,CAmCGA,GACI1oC,CACX,CAsEA,SAASowF,EAAY9wF,EAAGQ,EAAG8uD,EAAGyhC,GAC1B,GAAKA,EAEE,CAEH,IADA,IAAI1qD,EAAM,EACDjiC,EAAI,EAAGA,GAAKpE,IAAKoE,EACtBiiC,GAAO6pD,EAAc1vF,EAAG4D,GAAK4F,KAAKyoC,IAAI6c,EAAGlrD,GAAK4F,KAAKyoC,IAAI,EAAE6c,EAAG9uD,EAAE4D,GAElE,OAAOiiC,CACX,CAPI,OAAO6pD,EAAc1vF,EAAGR,GAAKgK,KAAKyoC,IAAI6c,EAAGtvD,GAAKgK,KAAKyoC,IAAI,EAAE6c,EAAG9uD,EAAER,EAQtE,CA2bA,SAASgxF,EAAYzhD,GACjB,IAAIpvC,EAAIksF,GAAaD,GAAW78C,EAAM,EAAG,IACzC,OAAc,GAATpvC,EAAEuvC,KAAuB,GAATvvC,EAAEuvC,KAAYq8C,GAAUr6C,WAAWnC,GAE7C,GAEJ,EACX,CA1gBAy8C,GAAiB,aAAa,SAAS7jF,EAAU8oF,EAAQp3F,EAASuvC,GAE9D,IAAIhwC,EAAOG,KACXH,EAAK0uC,aAAasB,GAAM,WACpB,IAAI1oC,EACJ,GAAIuwF,EAAS,GAAI,CAEbvwF,EAASkwF,EAAwBx3F,EAAMgwC,EAAK,GAAIvvC,GAChD,IAAI+wC,EAAIxB,EAAK,GAIb,GAHIwB,aAAashD,KACbthD,EAAIxxC,EAAKuvC,WAAWiC,IAER,iBAALA,EACP,OAAOziC,EAAS,IAAI8jF,GAAY,SAExC,MACIvrF,EAASkwF,EAAwBx3F,EAAMgwC,EAAMvvC,GAEjDT,EAAK8vC,KAAKynD,EAAgBM,EAAS,GAAI9oF,EAAUzH,EACrD,GACJ,IAAG2tC,UAAU,CACT,CAAE,SAAU,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvC,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,KAC5C,CAAE,UAAW,CAAE,KACH,CAAE,OAAQ,GACV,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,KAC7C,CAAE,OAAQ,UAGd29C,GAAiB,YAAY,SAAS7jF,EAAU8oF,GAC5C,IAAI73F,EAAOG,KACP23F,EAAeD,EAAS,IACxBC,IACAD,GAAU,KAGd,IADA,IAAI7nD,EAAO,GACFtsC,EAAI,EAAGA,EAAIqE,UAAUvG,SAAUkC,EACpCssC,EAAKlvC,KAAKiH,UAAUrE,IAExB1D,EAAK0uC,aAAasB,GAAM,WACpB,IAAI1oC,EAASkwF,EAAwBx3F,EAAMgwC,EAAM8nD,EAAe,EAAI,GACpE93F,EAAK8vC,KAAKynD,EAAgBM,EAAS,GAAI9oF,EAAUzH,EACrD,GACJ,IAAG2tC,UAAU,CACT,CAAE,SAAU,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAC3C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,MAC9D,CAAE,IAAK,CAAE,MAAO,CAAE,KAAM,MAAO,eAInC29C,GAAiB,UAAU,SAAS8B,GAChC,IAAIe,EAAMf,EAAQ19D,QAAO,SAASiW,EAAK/P,GACnC,OAAO+P,EAAM/P,CACjB,GAAG,GAAKw3D,EAAQlzF,OAChB,OAAOkzF,EAAQ19D,QAAO,SAASiW,EAAK/P,GAChC,OAAO+P,EAAMr8B,KAAK0pB,IAAI4C,EAAMu4D,EAChC,GAAG,GAAKf,EAAQlzF,MACpB,IAAGwuC,KAAK,CACJ,CAAE,UAAW,CAAE,UAAW,WAC1B,CAAE,IAAK,CAAE,SAAU,uBAAwB,UAe/C4iD,GAAiB,aAAc8E,GAAa1nD,KAAK,CAC7C,CAAE,YAAa,YACf,CAAE,SAAU,CAAE,MAAO,UAAW,CAAE,SAAU,2BAC5C,CAAE,cAAe,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KACtD,CAAE,aAAc,aAGpB4I,GAAY,YAAa,cAEzBg6C,GAAiB,aAAa,SAASxrF,EAAG8uD,EAAG6hC,GAEzC,IAAK,IAAInxF,EAAI,EAAGA,GAAKQ,IAAKR,EACtB,GAAI8wF,EAAY9wF,EAAGQ,EAAG8uD,GAAG,IAAS6hC,EAC9B,OAAOnxF,EAGf,OAAO,IAAIisF,GAAY,MAC3B,IAAG7iD,KAAK,CACJ,CAAE,SAAU,YACZ,CAAE,cAAe,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KACtD,CAAE,QAAS,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,OAGpD4I,GAAY,YAAa,aAEzBg6C,GAAiB,oBAAoB,SAASxrF,EAAG8uD,EAAGllB,EAAGgnD,GAEnD,IADA,IAAI/qD,EAAM,EACDuE,EAAIR,EAAGQ,GAAKwmD,IAAMxmD,EACvBvE,GAAO6pD,EAAc1vF,EAAGoqC,GAAK5gC,KAAKyoC,IAAI6c,EAAG1kB,GAAK5gC,KAAKyoC,IAAI,EAAE6c,EAAG9uD,EAAEoqC,GAElE,OAAOvE,CACX,IAAG+C,KAAK,CACJ,CAAE,SAAU,YACZ,CAAE,cAAe,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KACtD,CAAE,gBAAiB,CAAE,MAAO,UAAW,CAAE,YAAa,EAAG,aACzD,CAAE,gBAAiB,CAAE,KACD,CAAE,MAAO,UACT,CAAE,YAAa,iBAAkB,YACjC,CAAE,OAAQ,sBAGlC4iD,GAAiB,iBAAiB,SAAShsF,EAAG4qC,EAAG0kB,EAAGyhC,GAChD,GAAIA,EAAY,CAEZ,IADA,IAAI1qD,EAAM,EACHrmC,GAAK,GACRqmC,GAAO6pD,EAAclwF,EAAE4qC,EAAE,EAAG5qC,GAAKgK,KAAKyoC,IAAI6c,EAAG1kB,GAAK5gC,KAAKyoC,IAAI,EAAE6c,EAAGtvD,GAChEA,IAEJ,OAAOqmC,CACX,CACA,OAAO6pD,EAAclwF,EAAE4qC,EAAE,EAAG5qC,GAAKgK,KAAKyoC,IAAI6c,EAAG1kB,GAAK5gC,KAAKyoC,IAAI,EAAE6c,EAAGtvD,EACpE,IAAGopC,KAAK,CACJ,CAAE,WAAY,YACd,CAAE,WAAY,YACd,CAAE,gBAAiB,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KACxD,CAAE,aAAc,aAGpB4I,GAAY,eAAgB,iBAI5Bg6C,GAAiB,WAAW,SAAS/+E,EAAK2B,EAAK8kB,EAAK29D,EAAI9oF,GAGpD,IAAI8E,EAAO,IAAI6+E,GAAUj/E,EAAM,EAAG2B,EAAM,EAAG8kB,EAAM,GAIjD,OAHInrB,GACA8E,EAAK0Z,SAASxe,GAAO,GAElB8oF,EAAKhkF,EAAK2Z,MAAM,EAAG,GAAK3Z,EAAK2Z,OACxC,IAAGoiB,KAAK,CACJ,CAAE,MAAO,aACT,CAAE,MAAO,aACT,CAAE,MAAO,CAAE,KAAM,CAAE,OAAQ,GAAK,CAAE,SAAU,EAAG,EAAG,EAAG,KACrD,CAAE,KAAM,CAAE,KAAM,CAAE,QAAQ,GAAQ,YAClC,CAAE,QAAS,CAAE,KAAM,OAAQ,aAG/B4iD,GAAiB,SAAS,SAAS1jF,GAC/B,IAAIsR,EAAQ,EASZ,OARA,SAAUsF,EAAKlf,GACPA,aAAaksF,IAAalsF,aAAauT,GACvCqG,IACO5Z,aAAaqS,IACpBrS,EAAE+M,KAAK1E,QAAQ6W,EAGtB,CAPD,CAOG5W,GACIsR,CACX,IAAGwvB,KAAK,CACJ,CAAE,MAAO,SAGb4iD,GAAiB,UAAU,SAAS/nF,EAAOmlC,GACvC,OAAInlC,EAAQmlC,EAAKxuC,OACN,IAAIqxF,GAAY,OAEhB7iD,EAAKnlC,EAAQ,EAE5B,IAAGmlC,KAAK,CACJ,CAAE,SAAU,WACZ,CAAE,IAAK,CAAE,QAAS,eAGtB4iD,GAAiB,UAAU,SAAS1jF,GAChC,OAAKA,EAGDA,aAAe4jF,GACR5jF,EAAIsG,IAAM,EAEdrV,KAAK2uC,SAAS5/B,GAAK0hC,QAAO,SAASp7B,GACtC,OAAOA,EAAMtG,EAAI8B,QAAQwE,IAAM,CACnC,IAPWrV,KAAKi2B,QAAQ5gB,IAAM,CAQlC,IAAGw6B,KAAK,CACJ,CAAE,MAAO,CAAE,KAAM,OAAQ,WAG7B4iD,GAAiB,WAAW,SAAS5rF,GACjC,OAAOA,aAAa42B,GAAM52B,EAAE1C,QAAU0C,EAAE1C,KAC5C,IAAG0rC,KAAK,CACJ,CAAE,MAAO,CAAE,KAAM,OAAQ,cAG7B4iD,GAAiB,eAAe,SAAS1jF,GACrC,IAAI+E,EAAO9T,KAAKgvC,YAAYjgC,GAAK,GACjC,OAAK+E,EAAKmiB,QAGHniB,EAAKmiB,QAAQxI,MAAM3Z,EAAKJ,IAAKI,EAAKuB,KAF9B,IAAIq9E,GAAY,MAG/B,IAAG7iD,KAAK,CACJ,CAAE,MAAO,SAGb4iD,GAAiB,WAAW,SAASvwF,EAAO2E,EAAG6M,EAAKqkF,GAChD,IAAIC,EAAY,KAahB,OAZAnxF,EAAE0pC,SAAQ,SAASl7B,GACf,IAAI7K,EAAO3D,EAAEpE,IAAI,EAAG4S,GACpB,GAAI0iF,EAAQ,CACR,GAAIvtF,EAAOtI,EACP,OAAO,EAEX81F,EAAY3iF,CAChB,MAAO,GAAI7K,IAAStI,EAEhB,OADA81F,EAAY3iF,GACL,CAEf,IACiB,MAAb2iF,EACO,IAAItF,GAAY,OAEpB7rF,EAAEpE,IAAIiR,EAAM,EAAGskF,EAC1B,IAAGnoD,KAAK,CACJ,CAAE,QAAS,YACX,CAAE,QAAS,UACX,CAAE,MAAO,aACT,CAAE,SAAU,CAAE,KAAM,UAAW,CAAE,QAAQ,OAG7C4iD,GAAiB,SAAS,SAAS7jF,EAAUG,EAAK2E,EAAK2B,EAAK4iF,GACxD,IAAIp4F,EAAOG,KAIX,GAHI+O,aAAe+J,KACf/J,EAAMA,EAAIyE,KAAKykF,EAAU,KAEvBvkF,IAAQ2B,IAAStG,EACnB,OAAOH,EAAS,IAAI8jF,GAAY,QAKpC,GAHI3jF,aAAe4jF,KACf5jF,EAAMA,EAAIE,cAEVF,aAAeiL,GAAU,CACzB,GAAItG,GAAO2B,EAAK,CACZ,GAAIA,EAAMtG,EAAI5K,SAAWuP,EAAM3E,EAAI3K,SAC/B,OAAOwK,EAAS,IAAI8jF,GAAY,QAGpC,IAAI5+E,EAAO/E,EAAIotB,OAAOzoB,EAAM,EAAG2B,EAAM,GAIrC,YAHAxV,EAAK0uC,aAAa,CAAEz6B,IAAQ,WACxBlF,EAAS/O,EAAKuvC,WAAWt7B,GAC7B,GAEJ,CACA,IAAKJ,EAAK,CAEN,IAAIwkF,EAAWnpF,EAAI0pB,SAASpjB,EAAM,GAIlC,YAHAxV,EAAK0uC,aAAa,CAAE2pD,IAAY,WAC5BtpF,EAAS/O,EAAK8uC,SAASupD,GAC3B,GAEJ,CACA,IAAK7iF,EAAK,CAEN,IAAIqqB,EAAW3wB,EAAIypB,MAAM9kB,EAAM,GAI/B,YAHA7T,EAAK0uC,aAAa,CAAE7O,IAAY,WAC5B9wB,EAAS/O,EAAK8uC,SAASjP,GAC3B,GAEJ,CACJ,MACK,GAAI3wB,aAAeu4B,GAAQ,CAC5B,GAAIv4B,EAAI5K,MAAQ,GAAK4K,EAAI3K,OAAS,EAAG,CACjC,GAAIsP,GAAO2B,EACP,OAAOzG,EAASG,EAAItM,IAAIiR,EAAM,EAAG2B,EAAM,IAE3C,IAAK3B,EACD,OAAO9E,EAASG,EAAIyhC,QAAO,SAAS98B,GAChC,OAAO3E,EAAItM,IAAIiR,EAAK2B,EAAM,EAC9B,KAEJ,IAAKA,EACD,OAAOzG,EAASG,EAAI0hC,QAAO,SAASp7B,GAChC,OAAOtG,EAAItM,IAAIiR,EAAM,EAAG2B,EAC5B,IAER,CACA,GAAiB,GAAbtG,EAAI5K,MACJ,OAAOyK,EAASG,EAAItM,KAAKiR,GAAO,GAAK,EAAG,IAE5C,GAAkB,GAAd3E,EAAI3K,OACJ,OAAOwK,EAASG,EAAItM,IAAI,GAAI4S,GAAO,GAAK,GAEhD,MAEIzG,EAAS,IAAI8jF,GAAY,OAEjC,IAAG59C,UAAU,CACT,CAAE,QAAS,CAAE,KAAM,MAAO,WAC1B,CAAE,MAAO,CAAE,KAAM,WAAY,SAC7B,CAAE,MAAO,CAAE,KAAM,WAAY,SAC7B,CAAE,UAAW,CAAE,KAAM,YAAa,CAAE,OAAQ,OAGhD29C,GAAiB,YAAY,SAASzlF,GAClC,IAGI,IAAIzF,EAAIvH,KAAKi2B,QAETlnB,EADMwjF,GAAO/2C,aAAaj0C,EAAEyH,MAAOzH,EAAEmM,IAAKnM,EAAE8N,IAAKrI,GACvCqjD,IAId,GAHIthD,aAAe2uB,KACf3uB,EAAM/O,KAAKouC,GAAGmB,UAAUxgC,EAAKxH,EAAEyH,MAAOzH,EAAEmM,IAAKnM,EAAE8N,QAE7CtG,aAAe0uB,IACjB,MAAM,EAEV,OAAO1uB,EAAImpB,SAAS3wB,EAAEmM,IAAKnM,EAAE8N,IACjC,CAAE,MAAMhN,GACJ,OAAO,IAAIqqF,GAAY,MAC3B,CACJ,IAAG7iD,KAAK,CACJ,CAAE,QAAS,YAMf4iD,GAAiB,SAAS,SAAShoE,EAAK5jB,EAAG6H,GACvC,IAAeypF,EAAXztF,EAAQ,EAQZ,OAPa,IAATgE,EACAypF,EAAMtE,EAAcppE,IACH,IAAV/b,EACPypF,EAAMtE,EAAc,KAAOppE,GACX,IAAT/b,IACPypF,EAAMtE,EAAc,KAAOppE,IAE3B5jB,EAAE2mC,MAAK,SAAS1mB,GAChB,GAAU,MAANA,GAAcqxE,EAAIrxE,GAIlB,OAHa,IAATpY,GAAc+b,GAAO3D,KACnBpc,GAEC,EAEXA,GACJ,IAAG,IAASA,EAAQ,EACTA,EAEA,IAAIgoF,GAAY,MAE/B,IAAG7iD,KAAK,CACJ,CAAE,QAAS,YACX,CAAE,QAAS,UACX,CAAE,OAAQ,CAAE,KACA,CAAE,UAAW,EAAG,EAAG,GACnB,CAAE,OAAQ,OAG1B4iD,GAAiB,UAAU,SAAS1jF,EAAKgJ,EAAMkC,EAAM7V,EAAQD,GACzD,IAAI0M,GAAW9B,aAAe4jF,GAAY5jF,EAAMA,EAAI8B,SAASpB,QAG7D,OAFAoB,EAAQ6C,KAAOqE,EACflH,EAAQwE,KAAO4E,EACXpJ,EAAQ6C,IAAM,GAAK7C,EAAQwE,IAAM,EAC1B,IAAIq9E,GAAY,SAEvBtuF,EAAS,GAAKD,EAAQ,EACf,IAAI6V,GAASnJ,EAAS,IAAI8hF,GAAU9hF,EAAQ6C,IAAMtP,EAAS,EAC1ByM,EAAQwE,IAAMlR,EAAQ,IACzDqpB,SAASze,EAAIC,MAAOD,EAAIipB,YAE1BnnB,CACX,IAAGg/B,KAAK,CACJ,CAAE,MAAO,QACT,CAAE,QAAS,WACX,CAAE,QAAS,WACX,CAAE,UAAW,CAAE,KAAM,YAAa,CAAE,OAAQ,mBAC5C,CAAE,SAAU,CAAE,KAAM,YAAa,CAAE,OAAQ,oBAG/C4iD,GAAiB,OAAO,SAAS1jF,GAC7B,OAAKA,EAGDA,aAAe4jF,GACR5jF,EAAI2E,IAAM,EAEd1T,KAAK2uC,SAAS5/B,GAAKyhC,QAAO,SAAS98B,GACtC,OAAOA,EAAM3E,EAAI8B,QAAQ6C,IAAM,CACnC,IAPW1T,KAAKi2B,QAAQviB,IAAM,CAQlC,IAAGm8B,KAAK,CACJ,CAAE,MAAO,CAAE,KAAM,OAAQ,WAG7B4iD,GAAiB,QAAQ,SAAS5rF,GAC9B,OAAOA,aAAa42B,GAAM52B,EAAEzC,SAAWyC,EAAEzC,MAC7C,IAAGyrC,KAAK,CACJ,CAAE,MAAO,CAAE,KAAM,OAAQ,cAG7B4iD,GAAiB,WAAW,SAASvwF,EAAO2E,EAAGwO,EAAK0iF,GAChD,IAAIK,EAAY,KAwBhB,MAvBoB,iBAATl2F,IACP61F,GAAS,GAEO,iBAAT71F,IACPA,EAAQA,EAAMoE,eAElBO,EAAEypC,SAAQ,SAAS58B,GACf,IAAIlJ,EAAO3D,EAAEpE,IAAIiR,EAAK,GACtB,GAAIqkF,EAAQ,CACR,GAAIvtF,EAAOtI,EACP,OAAO,EAEXk2F,EAAY1kF,CAChB,MAII,GAHmB,iBAARlJ,IACPA,EAAOA,EAAKlE,eAEZkE,IAAStI,EAET,OADAk2F,EAAY1kF,GACL,CAGnB,IACiB,MAAb0kF,EACO,IAAI1F,GAAY,OAEpB7rF,EAAEpE,IAAI21F,EAAW/iF,EAAM,EAClC,IAAGw6B,KAAK,CACJ,CAAE,QAAS,YACX,CAAE,QAAS,UACX,CAAE,MAAO,aACT,CAAE,SAAU,CAAE,KAAM,UAAW,CAAE,QAAQ,OAK7C4iD,GAAiB,QAAQ,SAASz8C,EAAMC,EAAOC,GAC3C,OAAO28C,GAAW78C,EAAMC,EAAM,EAAGC,EACrC,IAAGrG,KAAK,CACJ,CAAE,QAAS,WACX,CAAE,SAAU,WACZ,CAAE,QAAS,aAGf4iD,GAAiB,OAAO,SAASv8C,GAC7B,OAAO48C,GAAa58C,GAAMA,IAC9B,IAAGrG,KAAK,CACJ,CAAE,QAAS,UAGf4iD,GAAiB,SAAS,SAASv8C,GAC/B,OAAO48C,GAAa58C,GAAMD,MAAQ,CACtC,IAAGpG,KAAK,CACJ,CAAE,QAAS,UAGf4iD,GAAiB,QAAQ,SAASv8C,GAC9B,OAAO48C,GAAa58C,GAAMF,IAC9B,IAAGnG,KAAK,CACJ,CAAE,QAAS,UAGf4iD,GAAiB,WAAW,SAASv8C,GAEjC,OAAO48C,GAAa58C,GAAMC,IAAM,CACpC,IAAGtG,KAAK,CACJ,CAAE,QAAS,UAKf4iD,GAAiB,WAAW,SAASv8C,EAAMxnC,GACvC,IAEIujB,EAFAomE,EAAKxF,GAAWC,GAAa58C,GAAMF,KAAM,EAAG,GAC5CsiD,EAAKxF,GAAauF,GAgCtB,OA9BY,IAAR3pF,IAGAujB,EAAO,GAAKqmE,EAAGniD,IAAM,GAAK,GACf,IACPlkB,GAAQ,GAEZomE,GAAMpmE,EACNqmE,EAAGpiD,MAAQjkB,EACXqmE,EAAGniD,IAAM,EACTznC,EAAO,GAGHA,EADQ,GAARA,EACO,EACQ,GAARA,EACA,GAECA,EAAO,IAAM,GAQ7BujB,EAAOqmE,EAAGniD,IAAMznC,GACL,IACPujB,GAAQ,GAEZomE,GAAMpmE,EACCxhB,KAAK4jF,MAAMn+C,EAAO,EAAImiD,GAAM,EACvC,IAAGxoD,KAAK,CACJ,CAAE,QAAS,QACX,CAAE,QAAS,CAAE,KAAM,CAAE,OAAQ,GACjB,CAAE,SAAU,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,QAY9D4iD,GAAiB,cAAc,SAAoBv8C,GAE/C,IAAItvC,EAAIksF,GAAa58C,GACjBqiD,EAAM3xF,EAAEuvC,KAAO,EACfqiD,EAAK/nF,KAAKgnB,OAAO7wB,EAAEwvC,IAAMmiD,EAAM,IAAM,GACzC,OAAIC,EAAK,EACEf,EAAY7wF,EAAEovC,KAAO,GACf,IAANwiD,GAAYA,EAAKf,EAAY7wF,EAAEovC,MAC/B,EAEJwiD,CACX,IAAG3oD,KAAK,CACJ,CAAE,QAAS,UAGf4iD,GAAiB,OAAO,WACpB,OAAOD,GAAUp7C,aAAa,IAAIzxC,KACtC,IAAGkqC,KAAK,IAER4iD,GAAiB,SAAS,WACtB,OAA4C,EAArCD,GAAUp7C,aAAa,IAAIzxC,KACtC,IAAGkqC,KAAK,IAER4iD,GAAiB,QAAQ,SAASv7C,EAAIC,EAAI/I,GACtC,OAAOokD,GAAUv7C,SAASC,EAAIC,EAAI/I,EAAI,EAC1C,IAAGyB,KAAK,CACJ,CAAE,SAAU,WACZ,CAAE,WAAY,WACd,CAAE,WAAY,aAGlB4iD,GAAiB,QAAQ,SAASp7C,GAC9B,OAAOm7C,GAAU/7C,WAAWY,GAAMT,KACtC,IAAG/G,KAAK,CACJ,CAAE,QAAS,cAGf4iD,GAAiB,UAAU,SAASp7C,GAChC,OAAOm7C,GAAU/7C,WAAWY,GAAMR,OACtC,IAAGhH,KAAK,CACJ,CAAE,QAAS,cAGf4iD,GAAiB,UAAU,SAASp7C,GAChC,OAAOm7C,GAAU/7C,WAAWY,GAAMP,OACtC,IAAGjH,KAAK,CACJ,CAAE,QAAS,cAGf4iD,GAAiB,SAAS,SAASnyE,EAAM2tE,GACrC,IAAIrnF,EAAIksF,GAAaxyE,GACjBzZ,EAAID,EAAEqvC,MAAQg4C,EACdn9D,EAAIlqB,EAAEovC,KAAOvlC,KAAKgnB,MAAM5wB,EAAE,IAM9B,OALAA,GAAK,IACG,IACJA,GAAK,IAETD,EAAI6J,KAAKC,IAAI9J,EAAEsvC,KAAM08C,GAAc9hE,EAAGjqB,IAC/BgsF,GAAW/hE,EAAGjqB,EAAGD,EAC5B,IAAGipC,KAAK,CACJ,CAAE,cAAe,QACjB,CAAE,UAAW,aAGjB4iD,GAAiB,WAAW,SAASnyE,EAAM2tE,GACvC,IAAIrnF,EAAIksF,GAAaxyE,GACjBzZ,EAAID,EAAEqvC,MAAQg4C,EACdn9D,EAAIlqB,EAAEovC,KAAOvlC,KAAKgnB,MAAM5wB,EAAE,IAM9B,OALAA,GAAK,IACG,IACJA,GAAK,IAETD,EAAIgsF,GAAc9hE,EAAGjqB,GACdgsF,GAAW/hE,EAAGjqB,EAAGD,EAC5B,IAAGipC,KAAK,CACJ,CAAE,cAAe,QACjB,CAAE,UAAW,aAGjB4iD,GAAiB,WAAW,SAASv8C,EAAMjvC,EAAGwxF,GAE1C,IAAIC,EAAMzxF,EAAI,EAAI,GAAK,EACvBA,EAAIwJ,KAAK0pB,IAAIlzB,GAEb,IADA,IAAIsxF,EAAMzF,GAAa58C,GAAMC,IACtBlvC,EAAI,GACPivC,GAAQwiD,GACRH,GAAOA,EAAMG,GAAO,GACV,GAAKH,EAAM,GAAKE,EAASlnF,QAAQ2kC,GAAQ,KAC7CjvC,EAGV,OAAOivC,CACX,IAAGrG,KAAK,CACJ,CAAE,aAAc,QAChB,CAAE,OAAQ,WACV,CAAE,WAAY,CAAE,UAAW,WAG/B4iD,GAAiB,eAAe,SAASv8C,EAAM1wB,EAAKizE,GAEhD,GAAIviD,EAAO1wB,EAAK,CACZ,IAAIrY,EAAM+oC,EACVA,EAAO1wB,EACPA,EAAMrY,CACV,CAGA,IAFA,IAAIkT,EAAQ,EACRk4E,EAAMzF,GAAa58C,GAAMC,IACtBD,GAAQ1wB,GACP+yE,EAAM,GAAKA,EAAM,GAAKE,EAASlnF,QAAQ2kC,GAAQ,GAC/C71B,IAEJ61B,IACAqiD,GAAOA,EAAM,GAAK,EAEtB,OAAOl4E,CACX,IAAGwvB,KAAK,CACJ,CAAE,aAAc,QAChB,CAAE,WAAY,QACd,CAAE,WAAY,CAAE,UAAW,WAG/B4iD,GAAiB,QAAQ,SAASjtE,EAAKuM,GACnC,OAAOvM,EAAMuM,CACjB,IAAG8d,KAAK,CACJ,CAAE,cAAe,QACjB,CAAE,YAAa,UAGnB4iD,GAAiB,UAAWO,IAAanjD,KAAK,CAC1C,CAAE,cAAe,QACjB,CAAE,YAAa,QACf,CAAE,UAAW,CAAE,KAAM,UAAW,CAAE,QAAQ,OAG9C4iD,GAAiB,YAAY,SAAS1gE,EAAOvM,EAAKytE,GAC9C,OAAQA,GACR,KAAK,EACD,OAAOD,GAAYjhE,EAAOvM,GAAK,GAAS,IAC5C,KAAK,EACD,OAAQA,EAAMuM,GAASghE,GAAaD,GAAa/gE,GAAOikB,MAC5D,KAAK,EACD,OAAQxwB,EAAMuM,GAAS,IAC3B,KAAK,EACD,OAAQvM,EAAMuM,GAAS,IAC3B,KAAK,EACD,OAAOihE,GAAYjhE,EAAOvM,GAAK,GAAQ,IAE/C,IAAGqqB,KAAK,CACJ,CAAE,cAAe,QACjB,CAAE,YAAa,QACf,CAAE,UAAW,CAAE,KAAM,CAAE,OAAQ,GAAK,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,OAGhE4iD,GAAiB,aAAa,SAAS7vF,GACnC,IAAIszC,EAAOs8C,GAAUn6C,UAAUz1C,GAC/B,OAAIszC,EACOs8C,GAAUp7C,aAAalB,GAE3B,IAAIw8C,GAAY,QAC3B,IAAG7iD,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,aAAa,SAAS7vF,GACnC,IAAIiE,EAAIjE,EAAK0D,cAAc4a,MAAM,+CACjC,GAAIra,EAAG,CACH,IAAIqwC,EAAK2c,WAAWhtD,EAAE,IAClBswC,EAAK0c,WAAWhtD,EAAE,IAClBunC,EAAKvnC,EAAE,GAAKgtD,WAAWhtD,EAAE,IAAM,EAE/BqqF,EAAOrqF,EAAE,GACb,OAAIqqF,IAASh6C,EAAK,IAAMA,EAAK,GAClB,IAAIw7C,GAAY,UAEvB,KAAKzqF,KAAKipF,KACVh6C,GAAM,IAEHs7C,GAAUv7C,SAASC,EAAIC,EAAI/I,EAAI,GAC1C,CACA,OAAO,IAAIskD,GAAY,QAC3B,IAAG7iD,KAAK,CACJ,CAAE,QAAS,YAKf4iD,GAAiB,WAAW,SAAS5rF,GAMjC,OALYA,EAAE2mC,MAAK,SAAS/iB,GACxB,GAAkB,iBAAPA,EACP,OAAO,IAAIioE,GAAY,QAE/B,IAAG,IACa7rF,EAAEqqC,aACtB,IAAGrB,KAAK,CACJ,CAAE,IAAK,CAAE,MAAO,SACR,CAAE,SAAU,6BAGxB4iD,GAAiB,aAAa,SAAS5rF,GACnC,OAAOA,EAAE6pC,WACb,IAAGb,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,SAAS,SAASnnF,EAAG4O,GAClC,OAAO5O,EAAEslC,SAAS12B,EACtB,IAAG21B,KAAK,CACJ,CAAE,IAAK,UACP,CAAE,IAAK,CAAE,MAAO,SACR,CAAE,SAAU,6BAGxB4iD,GAAiB,SAAS,SAASxrF,GAC/B,OAAO,IAAIqgC,GAAOtnC,MAAM2wC,KAAK1pC,EACjC,IAAG4oC,KAAK,CACJ,CAAE,IAAK,cAGX4iD,GAAiB,YAAY,SAAS5rF,GAMlC,OALYA,EAAE2mC,MAAK,SAAS/iB,GACxB,GAAkB,iBAAPA,EACP,OAAO,IAAIioE,GAAY,QAE/B,IAAG,IACa7rF,EAAE0qC,WAAa,IAAImhD,GAAY,QACnD,IAAG7iD,KAAK,CACJ,CAAE,IAAK,CAAE,MAAO,SACR,CAAE,SAAU,6BAKxB4iD,GAAiB,QAAQ,WACrB,OAAOhiF,KAAKkoF,QAChB,IAAG9oD,KAAK,IAER4iD,GAAiB,eAAe,SAAS/hF,EAAKkK,GAC1C,OAAOlK,EAAMD,KAAKgnB,OAAO7c,EAAMlK,EAAM,GAAKD,KAAKkoF,SACnD,IAAG9oD,KAAK,CACJ,CAAE,MAAO,WACT,CAAE,MAAO,CAAE,MAAO,UAAW,CAAE,SAAU,oBAG7C4iD,GAAiB,QAAQ,WACrB,OAAO,CACX,IAAG5iD,KAAK,IAER4iD,GAAiB,SAAS,WACtB,OAAO,CACX,IAAG5iD,KAAK,IAER4iD,GAAiB,SAAS,SAAS11D,GAC/B,OAAOx7B,GAAKyF,cAAc+1B,GAAK7V,aACnC,IAAG2oB,KAAK,CACJ,CAAE,UAAW,aAGjB4iD,GAAiB,UAAU,SAASmG,GAChC,IAAI77D,EAAMx7B,GAAK6E,cAAcwyF,GAC7B,OAAc,MAAP77D,EAAc,IAAI21D,GAAY,SAAW31D,CACpD,IAAG8S,KAAK,CACJ,CAAE,SAAU,YAGhB4iD,GAAiB,QAAQ,SAAS7+B,EAAQilC,EAAOC,GAE7C,IADA,IAAIz1F,EAAMuwD,EAAOx7B,SAASygE,GAAO3xE,cAC1B7jB,EAAIhC,OAASy3F,GAChBz1F,EAAM,IAAMA,EAEhB,OAAOA,CACX,IAAGwsC,KAAK,CACJ,CAAE,UAAW,WACb,CAAE,SAAU,CAAE,MAAO,UAAW,CAAE,YAAa,EAAG,MAClD,CAAE,UAAW,CAAE,KAAM,WAAY,CAAE,OAAQ,OAG/C4iD,GAAiB,WAAW,SAAS7vF,EAAMi2F,GACvCj2F,EAAOA,EAAKskB,cAEZ,IADA,IAAIuD,EAAM,EACDlnB,EAAI,EAAGA,EAAIX,EAAKvB,SAAUkC,EAAG,CAClC,IAAIqD,EAAIhE,EAAKY,WAAWD,GACxB,GAAIqD,GAAK,IAAMA,GAAK,GAChBA,GAAK,OACF,MAAIA,GAAK,IAAMA,EAAK,GAAKiyF,GAG5B,OAAO,IAAInG,GAAY,SAFvB9rF,GAAK,EAGT,CACA6jB,EAAMA,EAAMouE,EAAQjyF,CACxB,CACA,OAAO6jB,CACX,IAAGolB,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,SAAU,CAAE,MAAO,UAAW,CAAE,YAAa,EAAG,QAKtD4iD,GAAiB,QAAQ,SAAStpF,GAC9B,OAAOtG,OAAO2F,aAAaW,EAC/B,IAAG0mC,KAAK,CACJ,CAAE,QAAS,cAIf,IAAIkpD,EAAmB,qtHA2OvB,SAASC,EAAUxmF,EAAM5P,GACrB5C,KAAKwS,KAAOA,EACZxS,KAAK4C,KAAOA,CAChB,CA5OA6vF,GAAiB,SAAS,SAAS7vF,GAC/B,OAAOA,EAAKE,QAAQi2F,EAAkB,GAC1C,IAAGlpD,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,QAAQ,SAAS7vF,GAC9B,OAAOA,EAAKmE,OAAO,EACvB,IAAG8oC,KAAK,CACJ,CAAE,QAAS,YAGf4I,GAAY,UAAW,QACvBA,GAAY,UAAW,QAEvBg6C,GAAiB,eAAe,SAAS5iD,GAErC,IADA,IAAI5mC,EAAM,GACD1F,EAAI,EAAGA,EAAIssC,EAAKxuC,SAAUkC,EAC/B0F,GAAO4mC,EAAKtsC,GAEhB,OAAO0F,CACX,IAAG4mC,KAAK,CACJ,CAAE,IACF,CAAE,QAAS,aAGf4iD,GAAiB,UAAU,SAAS7+B,EAAQi+B,GAKxC,IAJA,IAAIv8E,EAAS,kCACT2jF,EAAM,GACNC,EAAc,EAEXrH,KAAa,GACpBoH,GAAO,IAGP,OAASpH,EAAW,GACpBqH,GAAe,GAWf,MARY,KAARD,EACJA,EAAM,IAAMA,EACe,IAAhBC,IACPtlC,EAASnjD,KAAKsjC,MAAM6f,EAASslC,GAAeA,GAGhD5jF,EAASA,EAAOxS,QAAQ,YAAam2F,GAE9B3G,GAAcp9E,WAAWtS,KAAKgxD,EAAQt+C,EACjD,IAAGu6B,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,YAAa,CAAE,KAAM,UAAW,CAAE,OAAQ,OAGhD4iD,GAAiB,SAAS,SAASnnF,EAAG4O,GAClC,OAAO5O,IAAM4O,CACjB,IAAG21B,KAAK,CACJ,CAAE,SAAU,UACZ,CAAE,SAAU,YAGhB4iD,GAAiB,QAAQ,SAAStjE,EAAWgqE,EAAQpnE,GACjD,IAAIjsB,EAAMqzF,EAAO5nF,QAAQ4d,EAAW4C,EAAQ,GAC5C,OAAOjsB,EAAM,EAAI,IAAI4sF,GAAY,SAAW5sF,EAAM,CACtD,IAAG+pC,KAAK,CACJ,CAAE,aAAc,UAChB,CAAE,UAAW,UACb,CAAE,SAAU,CAAE,KAAM,YAAa,CAAE,OAAQ,OAG/C4iD,GAAiB,SAAS,SAAS7+B,EAAQi+B,EAAUuH,GACjD,IAAIv1E,EAAQpT,KAAKyoC,IAAI,GAAI24C,GACzBj+B,EAASnjD,KAAKsjC,MAAM6f,EAAS/vC,GAASA,EACtC,IAAIvO,EAAS8jF,EAAW,IAAM,QAC9B,GAAIvH,EAAW,EAEX,IADAv8E,GAAU,IACHu8E,KAAa,GAAKv8E,GAAU,IAEvC,OAAOg9E,GAAcp9E,WAAWtS,KAAKgxD,EAAQt+C,EACjD,IAAGu6B,KAAK,CACJ,CAAE,UAAW,UACb,CAAE,YAAa,CAAE,KAAM,UAAW,CAAE,OAAQ,KAC5C,CAAE,YAAa,CAAE,KAAM,UAAW,CAAE,QAAQ,OAGhD4iD,GAAiB,QAAQ,SAAS7vF,EAAMvB,GACpC,OAAOuB,EAAK8nB,OAAO,EAAGrpB,EAC1B,IAAGwuC,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,UAAW,CAAE,KAAM,WAAY,CAAE,OAAQ,OAG/C4iD,GAAiB,SAAS,SAAS7vF,EAAMvB,GACrC,OAAOuB,EAAK8nB,QAAQrpB,EACxB,IAAGwuC,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,UAAW,CAAE,KAAM,WAAY,CAAE,OAAQ,OAG/C4iD,GAAiB,OAAO,SAAS7vF,GAC7B,OAAOA,EAAKvB,MAChB,IAAGwuC,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,SAAS,SAAS7vF,GAC/B,OAAOA,EAAK0D,aAChB,IAAGupC,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,SAAS,SAAS7vF,GAC/B,OAAOA,EAAKskB,aAChB,IAAG2oB,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,SAAS,SAAS7vF,GAC/B,OAAOA,EAAKE,QAAQ,OAAQ,GAChC,IAAG+sC,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,SAAS,SAAS7vF,GAC/B,OAAOA,EAAKE,QAAQ,OAAQ,GAChC,IAAG+sC,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,QAAQ,SAAS7vF,GAC9B,OAAOA,EAAKE,QAAQ,YAAa,GACrC,IAAG+sC,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,OAAO,SAAS7vF,EAAMmvB,EAAO1wB,GAC1C,OAAOuB,EAAK8nB,OAAOqH,EAAQ,EAAG1wB,EAClC,IAAGwuC,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,SAAU,aACZ,CAAE,UAAW,cAGjB4iD,GAAiB,UAAU,SAAS7vF,GAChC,OAAOA,EAAK0D,cAAcxD,QAAQ,QAAQ,SAAS+tC,GAC/C,OAAOA,EAAE3pB,aACb,GACJ,IAAG2oB,KAAK,CACJ,CAAE,QAAS,YAGf4iD,GAAiB,WAAW,SAAS7vF,EAAMmvB,EAAO1wB,EAAQg4F,GACtD,OAAOz2F,EAAK8nB,OAAO,IAAKqH,GAASsnE,EAAUz2F,EAAK8nB,OAAOqH,EAAQ1wB,EACnE,IAAGwuC,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,SAAU,aACZ,CAAE,UAAW,YACb,CAAE,WAAY,YAGlB4iD,GAAiB,QAAQ,SAAS7vF,EAAMgxD,GAEpC,IADA,IAAI3qD,EAAM,GACH2qD,KAAW,GAAK3qD,GAAOrG,EAC9B,OAAOqG,CACX,IAAG4mC,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,UAAW,cAGjB4iD,GAAiB,UAAU,SAAStjE,EAAWgqE,EAAQpnE,GACnD,IAAIjsB,EAAMqzF,EAAO7yF,cAAciL,QAAQ4d,EAAU7oB,cAAeyrB,EAAQ,GACxE,OAAOjsB,EAAM,EAAI,IAAI4sF,GAAY,SAAW5sF,EAAM,CACtD,IAAG+pC,KAAK,CACJ,CAAE,aAAc,UAChB,CAAE,UAAW,UACb,CAAE,SAAU,CAAE,KAAM,YAAa,CAAE,OAAQ,OAG/C4iD,GAAiB,cAAc,SAAS7vF,EAAM02F,EAASD,EAASzD,GAC5D,GAAI0D,IAAYD,EACZ,OAAOz2F,EAEX,IAAI0I,EAAI1I,EAAKqD,MAAMqzF,GACnB,GAAW,MAAP1D,EACA,OAAOtqF,EAAEnI,KAAKk2F,GAElBz2F,EAAO,GACPgzF,IACA,IAAK,IAAIryF,EAAI,EAAGA,EAAI+H,EAAEjK,SAAUkC,EAC5BX,GAAQ0I,EAAE/H,GACNA,EAAI+H,EAAEjK,OAAS,IAEXuB,GADAW,IAAMqyF,EACEyD,EAEAC,GAIpB,OAAO12F,CACX,IAAGitC,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,WAAY,UACd,CAAE,WAAY,UACd,CAAE,OAAQ,CAAE,KAAM,YAAa,WAGnC4iD,GAAiB,KAAK,SAASvwF,GAC3B,MAAuB,iBAATA,EAAoBA,EAAQ,EAC9C,IAAG2tC,KAAK,CACJ,CAAE,SAAU,cAGhB4iD,GAAiB,QAAQ,SAASvwF,EAAOoT,GACrC,OAAOg9E,GAAcp9E,WAAWtS,KAAKV,EAAOoT,EAChD,IAAGu6B,KAAK,CACJ,CAAE,SAAU,YACZ,CAAE,UAAW,YAGjB4iD,GAAiB,SAAS,SAASvwF,GAC/B,MAAoB,iBAATA,EACAA,EAES,kBAATA,GACCA,GAGZA,GAASA,EAAM,IAAIY,QAAQ,SAAU,IACrCZ,EAAQ2xD,WAAW3xD,GACZ2K,MAAM3K,GAAS,IAAIwwF,GAAY,SAAWxwF,EACrD,IAAG2tC,KAAK,CACJ,CAAE,SAAU,cAOhBmpD,EAAUhmF,UAAUolB,SAAW,WAC3B,OAAOp4B,KAAK4C,IAChB,EAEA6vF,GAAiB,aAAa,SAASjgF,EAAM5P,GACzC,OAAO,IAAIo2F,EAAUxmF,EAAM5P,EAC/B,IAAGitC,KAAK,CACJ,CAAE,QAAS,UACX,CAAE,QAAS,CAAE,KAAM,SAAU,CAAE,OAAQ,aAK3C4iD,GAAiB,WAAW,SAASvwF,EAAOq3F,GACxC,OAAOr3F,aAAiBwwF,GAAc6G,EAAer3F,CACzD,IAAG2tC,KAAK,CACJ,CAAE,SAAU,WACZ,CAAE,kBAAmB,eAKzB,IAAIgkD,EAAgB,WAChB,IAAI2F,EAAU/xF,OAAOC,OAAO,MAE5B,SAAS+xF,EAAetB,EAAK1xF,GACzB,GAAgB,iBAALA,EAAe,CACtB,IAAIs2B,EAAM82B,WAAWptD,GAChBoG,MAAMkwB,IAAQA,GAAOt2B,IACtBA,EAAIs2B,EAEZ,CACA,OAAO,SAASzxB,GACZ,IAAI4O,EAAIzT,EAKR,MAJgB,iBAAL6E,GAA6B,iBAAL4O,IAC/B5O,EAAIA,EAAEhF,cACN4T,EAAIA,EAAE5T,eAEH6xF,EAAI7sF,EAAG4O,EAClB,CACJ,CAEA,SAASw/E,EAAGpuF,GACR,IAAIyxB,EAAK15B,EAgBT,MAfgB,iBAALiI,IACPA,EAAIA,EAAEhF,eAEN,aAAa2B,KAAKqD,IAClBjI,EAAMiI,EAAEof,OAAO,EAAGpf,EAAEjK,OAAS,GAC7B07B,EAAM82B,WAAWxwD,GACZwJ,MAAMkwB,IAAQA,GAAO15B,IACtBiI,EAAIyxB,EAAM,MAEP,YAAY90B,KAAKqD,KACxByxB,EAAM82B,WAAWvoD,GACZuB,MAAMkwB,IAAQA,GAAOzxB,IACtBA,EAAIyxB,IAGLzxB,CACX,CAEA,SAASquF,EAAOruF,EAAG4O,GAAK,OAAOw/E,EAAGpuF,GAAKouF,EAAGx/E,EAAI,CAC9C,SAAS0/E,EAAQtuF,EAAG4O,GAAK,OAAOw/E,EAAGpuF,IAAMouF,EAAGx/E,EAAI,CAChD,SAAS2/E,EAAOvuF,EAAG4O,GAAK,OAAOw/E,EAAGpuF,GAAKouF,EAAGx/E,EAAI,CAC9C,SAAS4/E,EAAQxuF,EAAG4O,GAAK,OAAOw/E,EAAGpuF,IAAMouF,EAAGx/E,EAAI,CAChD,SAAS6/E,EAAOzuF,EAAG4O,GAAK,OAAQ8/E,EAAO1uF,EAAG4O,EAAI,CAC9C,SAAS8/E,EAAO1uF,EAAG4O,GACf,OAAIA,aAAa5R,OACN4R,EAAEjS,KAAKqD,IAEF,iBAALA,GAA6B,iBAAL4O,IAE/B5O,EAAIzI,OAAOyI,GACX4O,EAAIrX,OAAOqX,IAERw/E,EAAGpuF,IAAMouF,EAAGx/E,GACvB,CAEA,OAAO,SAASi+E,GACZ,GAAkB,mBAAPA,EACP,OAAOA,EAEX,IAAItxF,EACJ,GAAKA,EAAI,UAAUoH,KAAKkqF,GACpB,OAAOsB,EAAeO,EAAQnzF,EAAE,IAEpC,GAAKA,EAAI,WAAWoH,KAAKkqF,GACrB,OAAOsB,EAAeM,EAAQlzF,EAAE,IAEpC,GAAKA,EAAI,WAAWoH,KAAKkqF,GACrB,OAAOsB,EAAeG,EAAS/yF,EAAE,IAErC,GAAKA,EAAI,UAAUoH,KAAKkqF,GACpB,OAAOsB,EAAeE,EAAQ9yF,EAAE,IAEpC,GAAKA,EAAI,WAAWoH,KAAKkqF,GACrB,OAAOsB,EAAeK,EAASjzF,EAAE,IAErC,GAAKA,EAAI,UAAUoH,KAAKkqF,GACpB,OAAOsB,EAAeI,EAAQhzF,EAAE,IAEpC,GAAI,OAAOoH,KAAKkqF,GAAM,CAElB,IAAIxiC,EAAK6jC,EAAQrB,GAajB,OAZKxiC,IACDA,EAAKwiC,EAAIr1F,QAAQ,0CAA0C,SAAS+tC,GAChE,OAAQA,GACR,IAAK,KAAO,MAAO,MACnB,IAAK,KAAO,MAAO,MACnB,IAAK,IAAO,MAAO,IACnB,IAAK,IAAO,MAAO,KACnB,QAAY,MAAO,KAAOA,EAE9B,IACA8kB,EAAK6jC,EAAQrB,GAAO,IAAI7vF,OAAO,IAAMqtD,EAAK,IAAK,MAE5C8jC,EAAeO,EAAQrkC,EAClC,CACA,OAAO8jC,EAAeO,EAAQ7B,EAClC,CACH,CAnGmB,GAqGpB,SAASrD,EAAiBrqE,GACtB,MAAqB,iBAAPA,GACO,kBAAPA,GACA,MAAPA,GACQ,KAARA,CACX,CAEA,SAASlN,EAAUjS,EAAG4O,GAClB,OAAO5O,IAAM4O,EAAI,EAAI5O,EAAI4O,GAAK,EAAI,CACtC,CAEA,SAAS27E,EAAWvqF,EAAG4O,GACnB,OAAO5O,IAAM4O,EAAI,EAAI5O,EAAI4O,EAAI,GAAK,CACtC,KAmBJ,IAEI+/E,GAFgBh6F,MAAMsN,YACDkH,KACJuS,QACjBwxB,GAAiByhD,GAAUzhD,eAC3BX,GAAYoiD,GAAUpiD,UACtBC,GAAWmiD,GAAUniD,SACrBC,GAAakiD,GAAUliD,WACvBI,GAAa8hD,GAAU9hD,WACvBH,GAAciiD,GAAUjiD,YACxBo7C,GAAY6G,GAAU7G,UAE1B6G,GAAU7lD,WAAU,KAEhBoE,GAAe,OAAO,SAAS0hD,EAAI7vC,GAC/B,OAAU,MAANA,EACO8vC,GAAID,GAERC,GAAI9vC,GAAM8vC,GAAID,EACzB,IAAGrqD,KAAK,CACJ,CAAE,cAAe,UACjB,CAAE,cAAe,CAAE,KAAM,SAAU,WAGvC2I,GAAe,OAAQ4hD,IAAMvqD,KAAK,CAC9B,CAAE,IAAK,YAGX2I,GAAe,UAAW6hD,IAASxqD,KAAK,CACpC,CAAE,IAAK,cAGX2I,GAAe,QAAS8hD,IAAOzqD,KAAK,CAChC,CAAE,IAAK,YAGX2I,GAAe,aAAc+hD,IAAY1qD,KAAK,CAC1C,CAAE,IAAK,WACP,CAAE,QAAS,YACX,CAAE,OAAQ,YACV,CAAE,aAAc,aAGpB2I,GAAe,YAAagiD,IAAW3qD,KAAK,CACxC,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAC5C,CAAE,QAAS,YACX,CAAE,OAAQ,cAGd2I,GAAe,cAAeiiD,IAAa5qD,KAAK,CAC5C,CAAE,IAAK,UACP,CAAE,aAAc,aAGpB2I,GAAe,aAAckiD,IAAY7qD,KAAK,CAC1C,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,OAGhD2I,GAAe,YAAamiD,IAAW9qD,KAAK,CACxC,CAAE,IAAK,UACP,CAAE,OAAQ,UACV,CAAE,SAAU,YACZ,CAAE,aAAc,aAGpB2I,GAAe,WAAYoiD,IAAU/qD,KAAK,CACtC,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAC5C,CAAE,OAAQ,UACV,CAAE,SAAU,cAGhB2I,GAAe,WAAYqiD,IAAUhrD,KAAK,CACtC,CAAE,IAAK,UACP,CAAE,QAAS,YACX,CAAE,OAAQ,YACV,CAAE,IAAK,CAAE,KAAM,SAAU,CAAE,OAAQ,KACnC,CAAE,IAAK,CAAE,KAAM,SAAU,CAAE,OAAQ,KACnC,CAAE,IAAK,CAAE,SAAU,WAAY,QAC/B,CAAE,IAAK,CAAE,SAAU,WAAY,QAC/B,CAAE,IAAK,CAAE,SAAU,UAAW,UAGlC2I,GAAe,YAAasiD,IAAWjrD,KAAK,CACxC,CAAE,IAAK,UACP,CAAE,QAAS,YACX,CAAE,OAAQ,YACV,CAAE,aAAc,WAChB,CAAE,IAAK,CAAE,KAAM,SAAU,CAAE,OAAQ,KACnC,CAAE,IAAK,CAAE,KAAM,SAAU,CAAE,OAAQ,KACnC,CAAE,IAAK,CAAE,SAAU,WAAY,QAC/B,CAAE,IAAK,CAAE,SAAU,WAAY,QAC/B,CAAE,IAAK,CAAE,SAAU,UAAW,UAGlC2I,GAAe,WAAYuiD,IAAUlrD,KAAK,CACtC,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAC5C,CAAE,QAAS,YACX,CAAE,OAAQ,YACV,CAAE,IAAK,CAAE,KAAM,SAAU,CAAE,OAAQ,KACnC,CAAE,IAAK,CAAE,KAAM,SAAU,CAAE,OAAQ,OAGvC2I,GAAe,aAAcwiD,IAAYnrD,KAAK,CAC1C,CAAE,IAAK,WACP,CAAE,cAAe,aACjB,CAAE,aAAc,aAGpB2I,GAAe,gBAAiByiD,IAAaprD,KAAK,CAC9C,CAAE,IAAK,WACP,CAAE,cAAe,eAGrB2I,GAAe,YAAa0iD,IAAgBrrD,KAAK,CAC7C,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAC5C,CAAE,cAAe,eAGrB2I,GAAe,eAAgB2iD,IAAiBtrD,KAAK,CACjD,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAC5C,CAAE,cAAe,eAGrB2I,GAAe,cAAc,SAAS4iD,EAAI/yF,GACtC,OA+wBR,SAAoBgzF,EAAMC,GACtB,IACW/3F,EAAGsH,EADVkN,EAAOsjF,EAAKh6F,OAAQ4Y,EAAOohF,EAAK,GAAGh6F,OACnCoF,EAAI,EACR,IAAKlD,EAAI,EAAGA,EAAIwU,EAAMxU,IAClB,IAAKsH,EAAI,EAAGA,EAAIoP,EAAMpP,IAAK,CACvB,IAAI0wF,EAAMD,EAAO/3F,GAAGsH,GAChBoK,EAAQomF,EAAK93F,GAAGsH,GAAK0wF,EAEzB90F,IADAwO,GAASA,GACEsmF,CACf,CAGJ,OAAON,GAAYx0F,GADVsR,EAAO,IAAIkC,EAAO,GAE/B,CA5xBeuhF,CAAWJ,EAAG5wF,KAAMnC,EAAGmC,KAClC,IAAGqlC,KAAK,CACJ,CAAE,eAAgB,UAClB,CAAE,iBAAkB,UACpB,CAAE,IAAK,CAAE,SAAU,iDACnB,CAAE,IAAK,CAAE,SAAU,qDAGvB2I,GAAe,aAAcijD,IAAO5rD,KAAK,CACrC,CAAE,IAAK,WACP,CAAE,SAAU,YACZ,CAAE,aAAc,aAGpB2I,GAAe,eAAgBkjD,IAAS7rD,KAAK,CACzC,CAAE,IAAK,YACP,CAAE,OAAQ,WACV,CAAE,aAAc,aAGpB2I,GAAe,SAAUmjD,IAAO9rD,KAAK,CACjC,CAAE,IAAK,WACP,CAAE,eAAgB,aAClB,CAAE,eAAgB,aAClB,CAAE,aAAc,aAGpB2I,GAAe,YAAaojD,IAAa/rD,KAAK,CAC1C,CAAE,IAAK,WACP,CAAE,eAAgB,aAClB,CAAE,eAAgB,eAGtB2I,GAAe,QAASqjD,IAAMhsD,KAAK,CAC/B,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAC5C,CAAE,eAAgB,aAClB,CAAE,eAAgB,eAGtB2I,GAAe,WAAYsjD,IAAYjsD,KAAK,CACxC,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAC5C,CAAE,eAAgB,aAClB,CAAE,eAAgB,eAGtB2I,GAAe,SAAUujD,IAAOlsD,KAAK,CACjC,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,IAAK,CAAE,SAAU,sBAAuB,UAC1C,CAAE,IAAK,CAAE,SAAU,sBAAuB,YAG9C2I,GAAe,SAAUwjD,IAAQnsD,KAAK,CAClC,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,aAAc,EAAG,OAGjD2I,GAAe,YAAayjD,IAAWpsD,KAAK,CACxC,CAAE,IAAK,YAGX2I,GAAe,SAAU0jD,IAAOrsD,KAAK,CACjC,CAAE,IAAK,UACP,CAAE,cAAe,aACjB,CAAE,aAAc,aAGpB2I,GAAe,YAAa2jD,IAAatsD,KAAK,CAC1C,CAAE,IAAK,UACP,CAAE,cAAe,eAGrB2I,GAAe,YAAa4jD,IAAavsD,KAAK,CAC1C,CAAE,IAAK,WACP,CAAE,cAAe,eAGrB2I,GAAe,QAAS6jD,IAAWxsD,KAAK,CACpC,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAC5C,CAAE,cAAe,eAGrB2I,GAAe,WAAY8jD,IAAiBzsD,KAAK,CAC7C,CAAE,IAAK,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAC5C,CAAE,cAAe,eAGrB2I,GAAe,SAAU+jD,IAAY1sD,KAAK,CACtC,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,QAAS,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,KAC9C,CAAE,OAAQ,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,KAChD,CAAE,IAAK,CAAE,SAAU,iDAAkD,QACrE,CAAE,IAAK,CAAE,SAAU,sBAAuB,UAC1C,CAAE,IAAK,CAAE,SAAU,sBAAuB,YAG9C2I,GAAe,eAAgBgkD,IAAc3sD,KAAK,CAC9C,CAAE,QAAS,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAChD,CAAE,eAAgB,YAClB,CAAE,OAAQ,CAAE,MAAO,YACP,CAAE,SAAU,aAAc,aAG1C2I,GAAe,kBAAmBikD,IAAiB5sD,KAAK,CACpD,CAAE,QAAS,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KAChD,CAAE,eAAgB,YAClB,CAAE,OAAQ,CAAE,MAAO,gBAGvB2I,GAAe,QAASkkD,IAAO7sD,KAAK,CAChC,CAAE,IAAK,YAGX2I,GAAe,MAAOmkD,IAAK9sD,KAAK,CAC5B,CAAE,IAAK,YAGX2I,GAAe,eAAgBokD,IAAc/sD,KAAK,CAC9C,CAAE,IAAK,YACP,CAAE,OAAQ,UACV,CAAE,eAAgB,YAClB,CAAE,aAAc,aAGpB2I,GAAe,cAAeqkD,IAAahtD,KAAK,CAC5C,CAAE,cAAe,CAAE,MAAO,SAAU,CAAE,YAAa,EAAG,KACtD,CAAE,OAAQ,UACV,CAAE,eAAgB,cAGtB2I,GAAe,OAAQskD,IAAMjtD,KAAK,CAC9B,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,aAAc,CAAE,UAAW,SAAU,IACvC,CAAE,cAAe,UACjB,CAAE,cAAe,CAAE,KAAM,SAAU,CAAE,OAAQ,kBAC7C,CAAE,IAAK,CAAE,SAAU,wCAAyC,UAGhE2I,GAAe,QAASukD,IAAOltD,KAAK,CAChC,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,IAAK,CAAE,SAAU,qCAAsC,QACzD,CAAE,IAAK,CAAE,SAAU,6CAA8C,UAGrE2I,GAAe,YAAawkD,IAAWntD,KAAK,CACxC,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,IAAK,CAAE,SAAU,qCAAsC,QACzD,CAAE,IAAK,CAAE,SAAU,6CAA8C,UAGrE2I,GAAe,UAAWykD,IAASptD,KAAK,CACpC,CAAE,SAAU,CAAE,WAAY,WAAY,IACtC,CAAE,SAAU,CAAE,WAAY,WAAY,IACtC,CAAE,IAAK,CAAE,SAAU,mCAAoC,QACvD,CAAE,IAAK,CAAE,SAAU,2CAA4C,UAGnE2I,GAAe,MAAO0kD,IAAKrtD,KAAK,CAC5B,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,IAAK,CAAE,SAAU,qCAAsC,QACzD,CAAE,IAAK,CAAE,SAAU,6CAA8C,QACjE,CAAE,IAAK,CAAE,SAAU,+CAAgD,UAGvE2I,GAAe,QAAS2kD,IAAOttD,KAAK,CAChC,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,IAAK,CAAE,SAAU,qCAAsC,QACzD,CAAE,IAAK,CAAE,SAAU,+CAAgD,YAGvE2I,GAAe,WAAY4kD,IAAUvtD,KAAK,CACtC,CAAE,IAAK,UACP,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,UAAW,CAAE,UAAW,SAAU,IACpC,CAAE,IAAK,CAAE,SAAU,qCAAsC,QACzD,CAAE,IAAK,CAAE,SAAU,6CAA8C,UAGrE2I,GAAe,SAAU6kD,IAAQxtD,KAAK,CAClC,CAAE,UAAW,UACb,CAAE,UAAW,CAAE,KAAM,SAAU,SAC/B,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,QAAQ,KACxC,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,QAAQ,OAG5C2I,GAAe,SAAU8kD,IAAQztD,KAAK,CAClC,CAAE,UAAW,UACb,CAAE,UAAW,CAAE,KAAM,SAAU,SAC/B,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,QAAQ,KACxC,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,QAAQ,OAG5C2I,GAAe,QAAS+kD,IAAO1tD,KAAK,CAChC,CAAE,UAAW,UACb,CAAE,UAAW,CAAE,KAAM,SAAU,SAC/B,CAAE,QAAS,CAAE,KAAM,SAAU,SAC7B,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,QAAQ,OAG5C2I,GAAe,SAAUglD,IAAQ3tD,KAAK,CAClC,CAAE,UAAW,UACb,CAAE,UAAW,CAAE,KAAM,SAAU,SAC/B,CAAE,QAAS,CAAE,KAAM,SAAU,SAC7B,CAAE,QAAS,CAAE,KAAM,UAAW,CAAE,QAAQ,OAG5C2I,GAAe,KAAMilD,IAAI5tD,KAAK,CAC1B,CAAE,OAAQ,UACV,CAAE,OAAQ,UACV,CAAE,MAAO,CAAE,KAAM,SAAU,CAAE,OAAQ,KACrC,CAAE,KAAM,CAAE,KAAM,SAAU,CAAE,OAAQ,KACpC,CAAE,OAAQ,CAAE,KAAM,CAAE,SAAU,EAAG,GAAK,CAAE,OAAQ,KAChD,CAAE,IAAK,CAAE,SAAU,kBAGvB2I,GAAe,KAAMklD,IAAI7tD,KAAK,CAC1B,CAAE,OAAQ,UACV,CAAE,OAAQ,UACV,CAAE,MAAO,CAAE,KAAM,SAAU,CAAE,OAAQ,KACrC,CAAE,KAAM,CAAE,KAAM,SAAU,CAAE,OAAQ,KACpC,CAAE,OAAQ,CAAE,KAAM,CAAE,SAAU,EAAG,GAAK,CAAE,OAAQ,OAGpD2I,GAAe,MAAOmlD,IAAK9tD,KAAK,CAC5B,CAAE,OAAQ,UACV,CAAE,OAAQ,UACV,CAAE,MAAO,UACT,CAAE,KAAM,CAAE,KAAM,SAAU,CAAE,OAAQ,KACpC,CAAE,OAAQ,CAAE,KAAM,CAAE,SAAU,EAAG,GAAK,CAAE,OAAQ,OAGpD2I,GAAe,OAAQolD,IAAM/tD,KAAK,CAC9B,CAAE,OAAQ,UACV,CAAE,MAAO,UACT,CAAE,KAAM,UACR,CAAE,KAAM,CAAE,KAAM,SAAU,CAAE,OAAQ,KACpC,CAAE,OAAQ,CAAE,KAAM,CAAE,SAAU,EAAG,GAAK,CAAE,OAAQ,OAGpD2I,GAAe,OAAQqlD,IAAMhuD,KAAK,CAC9B,CAAE,OAAQ,UACV,CAAE,MAAO,CAAE,KAAM,SAAU,CAAE,OAAQ,KACrC,CAAE,KAAM,UACR,CAAE,KAAM,CAAE,KAAM,SAAU,CAAE,OAAQ,KACpC,CAAE,OAAQ,CAAE,KAAM,CAAE,SAAU,EAAG,GAAK,CAAE,OAAQ,KAChD,CAAE,QAAS,CAAE,KAAM,WAAY,CAAE,OAAQ,OACzC,CAAE,IAAK,CAAE,SAAU,kBAGvB2I,GAAe,OAAQslD,IAAMjuD,KAAK,CAC9B,CAAE,OAAQ,UACV,CAAE,MAAO,YACT,CAAE,OAAQ,YACV,CAAE,KAAM,UACR,CAAE,KAAM,CAAE,KAAM,SAAU,CAAE,OAAQ,KACpC,CAAE,OAAQ,CAAE,KAAM,CAAE,SAAU,EAAG,GAAK,CAAE,OAAQ,KAChD,CAAE,IAAK,CAAE,SAAU,iCAGvB2I,GAAe,OAAQulD,IAAMluD,KAAK,CAC9B,CAAE,OAAQ,UACV,CAAE,MAAO,YACT,CAAE,OAAQ,YACV,CAAE,KAAM,UACR,CAAE,KAAM,CAAE,KAAM,SAAU,CAAE,OAAQ,KACpC,CAAE,OAAQ,CAAE,KAAM,CAAE,SAAU,EAAG,GAAK,CAAE,OAAQ,KAChD,CAAE,IAAK,CAAE,SAAU,iCAGvB2I,GAAe,WAAYwlD,IAAUnuD,KAAK,CACtC,CAAE,OAAQ,YACV,CAAE,OAAQ,YACV,CAAE,KAAM,YACR,CAAE,eAAgB,YAClB,CAAE,aAAc,YAChB,CAAE,OAAQ,CAAE,KAAM,CAAE,SAAU,EAAG,GAAK,CAAE,OAAQ,KAChD,CAAE,IAAK,CAAE,SAAU,+BAAgC,UAGvD2I,GAAe,UAAWylD,IAASpuD,KAAK,CACpC,CAAE,OAAQ,YACV,CAAE,OAAQ,YACV,CAAE,KAAM,YACR,CAAE,eAAgB,YAClB,CAAE,aAAc,YAChB,CAAE,OAAQ,CAAE,KAAM,CAAE,SAAU,EAAG,GAAK,CAAE,OAAQ,KAChD,CAAE,IAAK,CAAE,SAAU,+BAAgC,UAGvD2I,GAAe,MAAO0lD,IAAKruD,KAAK,CAC5B,CAAE,OAAQ,UACV,CAAE,SAAU,CAAE,UAAW,WACzB,CAAE,IAAK,CAAE,SAAU,qBAAsB,UAG7C2I,GAAe,MAAO2lD,IAAKtuD,KAAK,CAC5B,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,QAAS,CAAE,KAAM,SAAU,CAAE,OAAQ,QAG3C2I,GAAe,SAAU4lD,IAAQvuD,KAAK,CAClC,CAAE,eAAgB,YAClB,CAAE,QAAS,eAGf2I,GAAe,UAAW6lD,IAASxuD,KAAK,CACpC,CAAE,cAAe,YACjB,CAAE,QAAS,eAGf2I,GAAe,OAAQ8lD,IAAMzuD,KAAK,CAC9B,CAAE,OAAQ,UACV,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,QAAS,CAAE,UAAW,OAAQ,IAChC,CAAE,IAAK,CAAE,SAAU,kCAAmC,UAG1D2I,GAAe,OAAQ+lD,IAAM1uD,KAAK,CAC9B,CAAE,SAAU,CAAE,UAAW,SAAU,IACnC,CAAE,QAAS,CAAE,UAAW,OAAQ,IAChC,CAAE,QAAS,CAAE,KAAM,SAAU,CAAE,OAAQ,MACvC,CAAE,IAAK,CAAE,SAAU,kCAAmC,UAG1D2I,GAAe,QAASgmD,IAAO3uD,KAAK,CAChC,CAAE,OAAQ,UACV,CAAE,MAAO,YACT,CAAE,OAAQ,YACV,CAAE,KAAM,UACR,CAAE,IAAK,CAAE,SAAU,iCAGvB2I,GAAe,KAAMimD,IAAI5uD,KAAK,CAC1B,CAAE,OAAQ,UACV,CAAE,UAAW,UACb,CAAE,OAAQ,YACV,CAAE,SAAU,YACZ,CAAE,QAAS,CAAE,KAAM,SAAU,CAAE,OAAQ,QAG3C2I,GAAe,MAAOkmD,IAAK7uD,KAAK,CAC5B,CAAE,OAAQ,UACV,CAAE,UAAW,UACb,CAAE,OAAQ,YACV,CAAE,SAAU,YACZ,CAAE,SAAU,CAAE,KAAM,SAAU,CAAE,OAAQ,OAG5C2I,GAAe,MAAOmmD,IAAK9uD,KAAK,CAC5B,CAAE,OAAQ,UACV,CAAE,UAAW,UACb,CAAE,OAAQ,cAGd2I,GAAe,MAAOomD,IAAK/uD,KAAK,CAC5B,CAAE,OAAQ,UACV,CAAE,UAAW,UACb,CAAE,OAAQ,YACV,CAAE,MAAO,cAGb2I,GAAe,MAAOqmD,IAAKhvD,KAAK,CAC5B,CAAE,OAAQ,WACV,CAAE,UAAW,WACb,CAAE,OAAQ,YACV,CAAE,eAAgB,WAClB,CAAE,aAAc,WAChB,CAAE,SAAU,CAAE,KAAM,UAAW,CAAE,OAAQ,KACzC,CAAE,YAAa,CAAE,KAAM,UAAW,CAAE,QAAQ,KAC5C,CAAE,IAAK,CAAE,SAAU,+BAAgC,UAGvD,IAAIivD,EAAa,CACb,CAAE,aAAc,QAChB,CAAE,WAAY,QACd,CAAE,YAAa,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,KACrD,CAAE,QAAS,CAAE,KAAM,CAAE,OAAQ,GACjB,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MACxD,CAAE,IAAK,CAAE,SAAU,0BAA2B,SAGlDtmD,GAAe,YAAaumD,IAAWlvD,KAAKivD,GAE5CtmD,GAAe,WAAYwmD,IAAUnvD,KAAKivD,GAE1CtmD,GAAe,aAAcymD,IAAYpvD,KAAKivD,GAE9CtmD,GAAe,UAAW0mD,IAASrvD,KAAKivD,GAExCtmD,GAAe,UAAW2mD,IAAStvD,KAAKivD,GAExCtmD,GAAe,UAAW4mD,IAASvvD,KAAKivD,GAExCtmD,GAAe,WAAY6mD,IAAUxvD,KAAK,CACtC,CAAE,QAAS,QACX,CAAE,aAAc,QAChB,CAAE,OAAQ,YACV,CAAE,MAAO,CAAE,KAAM,CAAE,OAAQ,KAAQ,aACnC,CAAE,QAAS,CAAE,KAAM,CAAE,OAAQ,GACjB,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MACxD,CAAE,IAAK,CAAE,SAAU,uBAAwB,UAG/C2I,GAAe,UAAW8mD,IAASzvD,KAAK,CACpC,CAAE,QAAS,QACX,CAAE,iBAAkB,QACpB,CAAE,aAAc,QAChB,CAAE,OAAQ,YACV,CAAE,MAAO,CAAE,KAAM,CAAE,OAAQ,KAAQ,aACnC,CAAE,YAAa,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,KACrD,CAAE,QAAS,CAAE,KAAM,CAAE,OAAQ,GACjB,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MACxD,CAAE,cAAe,CAAE,KAAM,UAAW,CAAE,QAAQ,KAC9C,CAAE,IAAK,CAAE,SAAU,uBAAwB,UAG/C2I,GAAe,OAAQ+mD,IAAM1vD,KAAK,CAC9B,CAAE,aAAc,QAChB,CAAE,WAAY,QACd,CAAE,KAAM,YACR,CAAE,aAAc,YAChB,CAAE,QAAS,CAAE,KAAM,CAAE,OAAQ,GACjB,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MACxD,CAAE,IAAK,CAAE,SAAU,0BAA2B,UAGlD2I,GAAe,UAAWgnD,IAAS3vD,KAAK,CACpC,CAAE,aAAc,QAChB,CAAE,WAAY,QACd,CAAE,aAAc,YAChB,CAAE,aAAc,YAChB,CAAE,QAAS,CAAE,KAAM,CAAE,OAAQ,GACjB,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MACxD,CAAE,IAAK,CAAE,SAAU,0BAA2B,UAGlD2I,GAAe,WAAYinD,IAAU5vD,KAAK,CACtC,CAAE,aAAc,QAChB,CAAE,WAAY,QACd,CAAE,aAAc,YAChB,CAAE,WAAY,YACd,CAAE,QAAS,CAAE,KAAM,CAAE,OAAQ,GACjB,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MACxD,CAAE,IAAK,CAAE,SAAU,0BAA2B,UAGlD2I,GAAe,QAASknD,IAAO7vD,KAAK,CAChC,CAAE,aAAc,QAChB,CAAE,WAAY,QACd,CAAE,OAAQ,YACV,CAAE,MAAO,YACT,CAAE,aAAc,YAChB,CAAE,YAAa,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,KACrD,CAAE,QAAS,CAAE,KAAM,CAAE,OAAQ,GACjB,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MACxD,CAAE,IAAK,CAAE,SAAU,0BAA2B,UAGlD2I,GAAe,YAAamnD,IAAW9vD,KAAK,CACxC,CAAE,aAAc,QAChB,CAAE,WAAY,QACd,CAAE,WAAY,YACd,CAAE,aAAc,YAChB,CAAE,QAAS,CAAE,KAAM,CAAE,OAAQ,GACjB,CAAE,MAAO,UAAW,CAAE,SAAU,EAAG,EAAG,EAAG,EAAG,MACxD,CAAE,IAAK,CAAE,SAAU,0BAA2B,SAChD,IAaN,IAAI+vD,GAAS,IACTC,GAAM,UACNC,GAAS,MACTC,GAAQtvF,KAAK0pB,IAEjB,SAASggE,GAAI1zF,GACT,GAAIs5F,GAAMt5F,IAAM,IACZ,OAAO,EAAI2zF,GAAK3zF,GAEpB,IAAIu5F,EAAIv5F,EAAI,EAAI,GAAK,GACX,GAANu5F,IACAv5F,GAAKA,GAGT,IADA,IAAII,EAAI,EAAGo5F,EAAK,EACPh5F,EAAI,EAAGA,EAAI,IAAKA,IACrBJ,GAAKo5F,EACLA,GAAM,EAAEx5F,EAAEA,GAAG,EAAEQ,EAAE,GAErB,OAAS,EAAF+4F,EAAIvvF,KAAKygB,KAAKzgB,KAAKqjF,IAAIrtF,EAAEgK,KAAKmgD,KAAKnqD,EAAEA,GAAGI,CACnD,CAEA,SAASuzF,GAAK3zF,GACV,GAAIs5F,GAAMt5F,GAAK,IACX,OAAO,EAAI0zF,GAAI1zF,GAEnB,IAAIoqC,EAAI,EACJpqC,EAAI,IACJoqC,GAAK,EACLpqC,GAAKA,GAGT,IADA,IAAIiwC,EAAOjwC,EACFQ,EAAI,EAAGA,GAAK,EAAGA,GAAK,GACzByvC,EAAOjwC,EAAIQ,EAAEyvC,EAGjB,OADAA,EAAO,GAAKjwC,EAAIiwC,GACJ,GAAL7F,EACDpgC,KAAKmgD,KAAKnqD,EAAEA,GAAGgK,KAAKygB,KAAKzgB,KAAKqjF,IAAIp9C,EAClC,EAAIjmC,KAAKmgD,KAAKnqD,EAAEA,GAAGgK,KAAKygB,KAAKzgB,KAAKqjF,IAAIp9C,CAChD,CAEA,SAAS2jD,GAAQ5zF,GACb,IAAIy5F,EAAM,CACN,kBAAmB,mBAAoB,kBACvC,mBAAoB,kBAAmB,qBAAwB,mBAE/DpvE,EAAIrqB,EAAG0G,EAAM1G,EAAI,IAAK05F,EAAMD,EAAI,GACpC/yF,IAAQ1G,EAAI,IAAOgK,KAAK8jC,IAAIpnC,GAC5B,IAAK,IAAItC,EAAI,EAAGA,GAAK,EAAGA,IAEpBs1F,GAAOD,EAAIr1F,IADXimB,GAAK,GAGT,OAAQ3jB,EAAMsD,KAAK8jC,IAAI9jC,KAAKygB,KAAK,EAAEzgB,KAAKqjF,IAAMqM,EAAM15F,EACxD,CAEA,SAAS6zF,GAAM7zF,GACX,GAAIA,EAAI,EACJ,OAAOgK,KAAKmgD,IAAIypC,GAAQ5zF,IAE5B,IAAI25F,EAAK3vF,KAAKqjF,GAAIhjE,GAAKrqB,EACvB,OAAQ25F,GAAMtvE,EAAEwpE,GAAMxpE,GAAGrgB,KAAKyjF,IAAIkM,EAAGtvE,GACzC,CAEA,SAASuvE,GAAO/0F,EAAG4O,GACf,OAAOmgF,GAAQ/uF,GAAK+uF,GAAQngF,GAAKmgF,GAAQ/uF,EAAE4O,EAC/C,CAEA,SAASomF,GAAKh1F,EAAG4O,GACb,OAAOzJ,KAAKmgD,IAAIyvC,GAAO/0F,EAAG4O,GAC9B,CAEA,SAASqmF,GAAUj1F,EAAG7E,GAClB,OAAOA,EAAI6E,EAAE,EAGjB,SAAkBA,EAAG7E,GACjB,IAGsBQ,EAHlB6lC,EAAM,EAAExhC,EACRorC,EAAO5J,EACP0zD,EAAKl1F,EACLm1F,EAAMpG,GAAQ/uF,GAClB,IAAKrE,EAAI,EAAGA,GAAK24F,KAGb9yD,GADA4J,GAAQjwC,IADR+5F,IAGIT,GAAMrpD,GAAQqpD,GAAMjzD,GAAK+yD,KAJR54F,KAQzB,OAAO6lC,EAAMr8B,KAAKmgD,KAAKnqD,EAAI6E,EAAEmF,KAAK8jC,IAAI9tC,GAAKg6F,EAC/C,CAjBuBC,CAASp1F,EAAG7E,GAAK,EAmBxC,SAAoB6E,EAAG7E,GAGnB,IAFA,IAAIc,EAAIu4F,GAAQn5F,EAAIY,EAAGX,EAAI,EAAG+5F,EAAK,EAAGC,EAAKn6F,EAAI,EAAI6E,EAC/Cm1F,EAAMpG,GAAQ/uF,GACT/H,EAAI,EAAGA,GAAKq8F,GAAQr8F,IAAK,CAEjCw8F,GADGn5F,EAAIg6F,EAAKD,EAAK/5F,GACNk5F,KACJl5F,EAAIk5F,IAGXC,GADJp5F,EAAIi6F,EAAKD,EAAKh6F,GACCm5F,KACJn5F,EAAIm5F,IAGf,IAAI7qF,EAAQtO,GADZC,EAAI,EAAIA,GAGJ,GADJW,GAAK0N,EACG8qF,GAAM9qF,EAAQ,GAAK4qF,GAChB,MAEXe,GAAM,EACND,GAAMp9F,GAAKA,EAAI+H,EACnB,CACA,OAAO/D,EAAIkJ,KAAKmgD,KAAKnqD,EAAIg6F,EAAMn1F,EAAImF,KAAK8jC,IAAI9tC,GACzC,CAzC4Co6F,CAAWv1F,EAAG7E,EAC1D,CA0CA,SAAS8zF,GAAW9zF,EAAG6E,EAAG4O,EAAGs9E,GACzB,OAAKA,EAGE+I,GAAUj1F,EAAG7E,EAAEyT,GAFXzJ,KAAKyoC,IAAIzyC,EAAEyT,EAAG5O,EAAE,GAAGmF,KAAKmgD,KAAKnqD,EAAEyT,IAAIA,EAAEogF,GAAMhvF,GAG1D,CAEA,SAASkvF,GAAUzkC,EAAGzqD,EAAG4O,GAC5B,GAAU,IAAN67C,EACO,OAAO,EAElB,GAAS,GAALA,EACO,OAAOr2C,IAElB,IAAI7Y,EAAI,EAAGi6F,EAAI,GAAIr6F,EAAI,EAAGs6F,EAAKz1F,EAAE4O,EAC7B6mF,EAAK,IACED,GAAKC,GAEhB,IAAK,IAAIx9F,EAAI,EAAGA,EAAIq8F,GAAQr8F,IAAK,CAE7B,IAAIy9F,EAAIzG,GADR9zF,EAAI,IAAKI,EAAIi6F,GACSx1F,EAAG4O,GAAG,GAC5B,GAAI6lF,GAAMhqC,EAAIirC,GAAK,MACR,MAEPA,EAAIjrC,EACG+qC,EAAIr6F,EAEJI,EAAIJ,CAEnB,CACA,OAAOA,CACJ,CAEA,SAASg0F,GAAYh0F,EAAG+wF,GACpB,OAAKA,EAGE,GAAM,GAAI2C,GAAI1zF,EAAEgK,KAAKygB,KAAK,IAFtBzgB,KAAKmgD,KAAKnqD,EAAEA,EAAE,GAAGgK,KAAKygB,KAAK,EAAEzgB,KAAKqjF,GAGjD,CAEA,SAAS4G,GAAW3kC,GAEhB,IAcIirC,EAAG36F,EAdHiF,EAAI,EAAE,kBAAwB,mBACxB,kBAAwB,kBACxB,kBAAwB,mBAC9B4O,EAAI,EAAE,kBAAwB,mBACxB,kBAAwB,mBACxB,mBACNvT,EAAI,EAAE,qBAAwB,mBACxB,mBAAwB,kBACzB,kBAAwB,mBAC7BC,EAAI,CAAE,oBAAwB,kBACxB,kBAAwB,mBAE9Bq6F,EAAQ,OAIZ,OAAIlrC,EAAIkrC,GACJD,EAAIvwF,KAAKygB,MAAM,EAAEzgB,KAAK8jC,IAAIwhB,SACdpvD,EAAE,GAAGq6F,EAAEr6F,EAAE,IAAIq6F,EAAEr6F,EAAE,IAAIq6F,EAAEr6F,EAAE,IAAIq6F,EAAEr6F,EAAE,IAAIq6F,EAAEr6F,EAAE,QAAUC,EAAE,GAAGo6F,EAAEp6F,EAAE,IAAIo6F,EAAEp6F,EAAE,IAAIo6F,EAAEp6F,EAAE,IAAIo6F,EAAE,IALtF,OAQAjrC,GACRirC,EAAIvwF,KAAKygB,MAAM,EAAEzgB,KAAK8jC,IAAI,EAAEwhB,UACfpvD,EAAE,GAAGq6F,EAAEr6F,EAAE,IAAIq6F,EAAEr6F,EAAE,IAAIq6F,EAAEr6F,EAAE,IAAIq6F,EAAEr6F,EAAE,IAAIq6F,EAAEr6F,EAAE,QAAUC,EAAE,GAAGo6F,EAAEp6F,EAAE,IAAIo6F,EAAEp6F,EAAE,IAAIo6F,EAAEp6F,EAAE,IAAIo6F,EAAE,SAKvF11F,EAAE,IADdjF,GADA26F,EAAIjrC,EAAI,IACFirC,GACa11F,EAAE,IAAIjF,EAAEiF,EAAE,IAAIjF,EAAEiF,EAAE,IAAIjF,EAAEiF,EAAE,IAAIjF,EAAEiF,EAAE,IAAI01F,OAAS9mF,EAAE,GAAG7T,EAAE6T,EAAE,IAAI7T,EAAE6T,EAAE,IAAI7T,EAAE6T,EAAE,IAAI7T,EAAE6T,EAAE,IAAI7T,EAAE,EAC7G,CAEA,SAASs0F,GAAUl0F,EAAGI,EAAGgqC,EAAG2mD,GACxB,OAAKA,EAGEiD,IAAah0F,EAAEI,GAAGgqC,GAAG,GAFjBpgC,KAAKmgD,MAAMnqD,EAAEI,IAAIJ,EAAEI,IAAI,EAAEgqC,EAAEA,KAAKA,EAAEpgC,KAAKygB,KAAK,EAAEzgB,KAAKqjF,IAGlE,CAEA,SAAS8G,GAAS7kC,EAAGlvD,EAAGgqC,GACpB,OAAOhqC,EAAIgqC,EAAE6pD,GAAW3kC,EAC5B,CAMA,SAASmrC,GAAYz6F,EAAG6E,EAAG4O,GACvB,IAAIm3B,EAAI5gC,KAAKmgD,IAAItlD,EAAEmF,KAAK8jC,IAAI9tC,GAAKyT,EAAEzJ,KAAK8jC,IAAI,EAAE9tC,GAAK45F,GAAO/0F,EAAG4O,IAC7D,OAAOzT,GAAK6E,EAAE,IAAIA,EAAE4O,EAAE,GAAKm3B,EAAE8vD,GAAW71F,EAAG4O,EAAGzT,GAAG6E,EAAI,EAAI+lC,EAAE8vD,GAAWjnF,EAAG5O,EAAG,EAAE7E,GAAGyT,CACrF,CAEA,SAASinF,GAAW71F,EAAG4O,EAAGzT,GACtB,IAAII,EAAGu6F,EACHvpE,EAAIlxB,EAAGC,EAAGy6F,EAAKrxD,EAAGsxD,EAAKC,EAAKC,EAWhC,IARAD,EAAMj2F,EAAI,EACV3E,EAAI,EAEAo5F,GADJn5F,EAAI,GAJJ06F,EAAMh2F,EAAI4O,GAIIzT,GAHd+6F,EAAMl2F,EAAI,IAIKw0F,KACXl5F,EAAIk5F,IAGR9vD,EADAppC,EAAI,EAAEA,EAEDC,EAAI,EAAGA,GAAK+4F,KAITG,GADJn5F,EAAI,GADJixB,EAAKhxB,GAAGqT,EAAIrT,GAAGJ,IAAM86F,GADrBH,EAAK,EAAEv6F,KACyByE,EAAI81F,KACzBx6F,GACIk5F,KACXl5F,EAAIk5F,IAGJC,GADJp5F,EAAI,EAAIkxB,EAAGlxB,GACIm5F,KACXn5F,EAAIm5F,IAGR9vD,IADAppC,EAAI,EAAEA,GACCD,EAGHo5F,GADJn5F,EAAI,GADJixB,IAAOvsB,EAAIzE,IAAIy6F,EAAMz6F,GAAGJ,IAAM6E,EAAI81F,IAAKI,EAAMJ,KAClCx6F,GACIk5F,KACXl5F,EAAIk5F,IAGJC,GADJp5F,EAAI,EAAIkxB,EAAGlxB,GACIm5F,KACXn5F,EAAIm5F,IAIR9vD,GADAqxD,GADAz6F,EAAI,EAAEA,GACED,IAEJo5F,GAAMsB,EAAM,GAAKxB,KAzBAh5F,KA6BzB,OAAOmpC,CACX,CAEA,SAASyxD,GAAY1rC,EAAGzqD,EAAG4O,GAE9B,IADA,IAAIrT,EAAI,EAAGi6F,EAAI,EAAGr6F,EAAI,EACblD,EAAI,EAAGA,EAAIq8F,GAAQr8F,IAAK,CAE7B,IAAIy9F,EAAIE,GADRz6F,EAAI,IAAKI,EAAIi6F,GACUx1F,EAAG4O,GAC1B,GAAI6lF,GAAMhqC,EAAIirC,GAAKnB,GACR,MAEPmB,EAAIjrC,EACG+qC,EAAIr6F,EAEJI,EAAIJ,CAEnB,CACA,OAAOA,CACJ,CAEA,SAASo0F,GAASp0F,EAAG6E,EAAG4O,EAAGrT,EAAGi6F,GAC1B,OAAOI,IAAaz6F,EAAEI,IAAIi6F,EAAEj6F,GAAIyE,EAAG4O,EACvC,CAEA,SAAS4gF,GAAUr0F,EAAG6E,EAAG4O,EAAGwnF,EAAK76F,EAAGi6F,GAChC,OAAIY,EACOR,IAAaz6F,EAAEI,IAAIi6F,EAAEj6F,GAAIyE,EAAG4O,GA7E3C,SAAqBzT,EAAG6E,EAAG4O,GACvB,OAAOzJ,KAAKmgD,KAAKtlD,EAAE,GAAGmF,KAAK8jC,IAAI9tC,IAAMyT,EAAE,GAAGzJ,KAAK8jC,IAAI,EAAE9tC,GAAK45F,GAAO/0F,EAAG4O,GACxE,CA6EWynF,EAAal7F,EAAEI,IAAIi6F,EAAEj6F,GAAIyE,EAAG4O,IAAM4mF,EAAEj6F,EAC/C,CAEA,SAASk0F,GAAShlC,EAAGzqD,EAAG4O,EAAGrT,EAAGi6F,GAC1B,OAAOj6F,GAAKi6F,EAAEj6F,GAAG46F,GAAY1rC,EAAGzqD,EAAG4O,EACvC,CAEA,SAAS8gF,GAAWv0F,EAAGQ,EAAG26F,GACtB,OAAOrH,GAAW9zF,EAAGQ,EAAE,EAAG,EAAG26F,EACjC,CAEA,SAAS3G,GAAYx0F,EAAGQ,GACpB,OAAO,EAAI+zF,GAAWv0F,EAAGQ,GAAG,EAChC,CAEA,SAASi0F,GAAenlC,EAAG9uD,GACvB,OAAOuzF,GAAUzkC,EAAG9uD,EAAE,EAAG,EAC7B,CAEA,SAASk0F,GAAgBplC,EAAG9uD,GACxB,OAAOi0F,GAAe,EAAEnlC,EAAG9uD,EAC/B,CAiBA,SAASw0F,GAAMh1F,EAAGJ,EAAGq7F,GACjB,OAAIA,EACO,EAAIjxF,KAAKmgD,KAAKvqD,EAAEI,GAEpBJ,EAAIoK,KAAKmgD,KAAKvqD,EAAEI,EAC3B,CAEA,SAASi1F,GAAQrqD,EAAGxqC,EAAG66F,GACnB,GAAIA,EACA,OAAO,EAAI1G,GAAW,EAAEn0F,EAAG,GAAGwqC,EAAE,IAAI,GAIxC,IADA,IAAIwwD,EAAM,EACDt+F,EAAI,EAAGA,GAAK8tC,EAAG9tC,IACpBs+F,GAAOpxF,KAAK8jC,IAAIhxC,GAEpB,OAAOkN,KAAKmgD,IAAIvf,EAAE5gC,KAAK8jC,IAAI1tC,GAAKA,EAAIg7F,EACxC,CAEA,SAASlG,GAAMl1F,EAAGQ,EAAGL,EAAG86F,GACpB,GAAIA,EACA,OAAOR,GAAYj6F,EAAER,GAAGG,EAAEK,EAAER,GAAIQ,EAAE,EAAGL,EAAE,GAE3C,IAAIs2B,EAAIj2B,EAAEL,EAEV,OAAOs2B,EAAEojE,GADTr5F,GAAK,EAAGL,GAAK,GACS6J,KAAKyoC,IAAIhc,EAAEz2B,EAAGQ,EAAE,GAAKwJ,KAAKyoC,IAAI,EAAEhc,EAAEz2B,EAAGQ,EAAEL,EACjE,CAEA,SAASg1F,GAAYn1F,EAAGQ,EAAGL,GACvB,OAAO,EAAI+0F,GAAMl1F,EAAGQ,EAAGL,GAAG,EAC9B,CAEA,SAASk1F,GAAW/lC,EAAG9uD,EAAGL,GACtB,OAAOA,EAAEK,GAAG,EAAE8zF,GAAShlC,EAAGnvD,EAAE,EAAGK,EAAE,EAAG,EAAG,GAAK,EAChD,CAEA,SAAS40F,GAAK9lC,EAAG9uD,EAAGL,GAChB,OAAOA,EAAEK,GAAG,EAAE8zF,GAAS,EAAEhlC,EAAGnvD,EAAE,EAAGK,EAAE,EAAG,EAAG,GAAK,EAClD,CAEA,SAAS66F,GAAM36B,GAEX,IADA,IAAI46B,EAAK,EAAG96F,EAAIkgE,EAAI9lE,OACXkC,EAAI,EAAGA,EAAI0D,EAAG1D,IACnBw+F,GAAM56B,EAAI5jE,GAEd,OAAOw+F,EAAK96F,CAChB,CAEA,SAAS+6F,GAAQ76B,EAAKtgE,GAElB,IADA,IAAIL,EAAI,EAAGS,EAAIkgE,EAAI9lE,OACVkC,EAAI,EAAGA,EAAI0D,EAAG1D,IAAK,CACxB,IAAI0R,EAAQkyD,EAAI5jE,GAAKsD,EACrBL,GAAKyO,EAAMA,CACf,CACA,OAAOzO,GAAKS,EAAE,EAClB,CAEA,SAAS80F,GAAMkG,EAAMC,GACjB,IAAIC,EAAKF,EAAK5gG,OAAS,EAAG+gG,EAAKF,EAAK7gG,OAAS,EACzCghG,EAAML,GAAQC,EAAMH,GAAMG,IAC1BK,EAAMN,GAAQE,EAAMJ,GAAMI,IAC9B,IAAKG,IAAQC,EACT,MAAM,IAAIzqD,GAAU,SAExB,OAAO,EAAE8jD,GAAM0G,EAAMC,EAAKH,EAAIC,GAAI,EACtC,CAEA,SAASpG,GAAOv1F,GACZ,MAAO,GAAIgK,KAAK8jC,KAAK,EAAE9tC,IAAI,EAAEA,GACjC,CAEA,SAASw1F,GAAUx1F,GACf,IAAI87F,EAAK9xF,KAAKmgD,IAAI,EAAEnqD,GACpB,OAAQ87F,EAAK,IAAIA,EAAK,EAC1B,CAEA,SAASrG,GAAMz1F,EAAGQ,EAAGy6F,GACjB,OAAIA,EACO,EAAI,GAAIR,GAAYj6F,GAAGR,EAAEA,EAAEQ,GAAIA,EAAE,EAAG,IAExC,GAAGwJ,KAAKygB,KAAKjqB,GAAGq5F,GAAK,GAAKr5F,EAAE,IAAMwJ,KAAKyoC,IAAI,EAAIzyC,EAAEA,EAAEQ,IAAKA,EAAE,GAAG,EACxE,CAEA,SAASk1F,GAAY11F,EAAGQ,GACpB,OAAO,EAAIi1F,GAAMz1F,EAAGQ,GAAG,EAC3B,CAEA,SAASm1F,GAAY31F,EAAGQ,GAIpB,OAHIR,EAAI,IACJA,GAAKA,GAEF,EAAE01F,GAAY11F,EAAGQ,EAC5B,CAEA,SAASo1F,GAAUtmC,EAAG9uD,GAClB,IAAIR,EAAIg7F,GAAY,EAAEhxF,KAAKC,IAAIqlD,EAAG,EAAEA,GAAI9uD,EAAE,EAAG,IAE7C,OADAR,EAAIgK,KAAKygB,KAAKjqB,GAAK,EAAIR,GAAKA,GACpBsvD,EAAI,GAAOtvD,GAAKA,CAC5B,CAEA,SAAS61F,GAAgBvmC,EAAG9uD,GAExB,OAAOo1F,GAAU,EAAEtmC,EAAE,EAAG9uD,EAC5B,CAEA,SAASs1F,GAAWiG,EAAKC,EAAKC,EAAMh0F,GAChC,IACIi0F,EAAMC,EADNT,EAAKK,EAAInhG,OAAQ+gG,EAAKK,EAAIphG,OAE9B,GAAY,GAARqN,EAAW,CAEX,IADA,IAAI9H,EAAI,EAAGusF,EAAK,EACP5vF,EAAI,EAAGA,EAAI4+F,EAAI5+F,IAAK,CACzB,IAAI0R,EAAQutF,EAAIj/F,GAAKk/F,EAAIl/F,GACzBqD,GAAKqO,EACLk+E,GAAMl+E,EAAMA,CAChB,CACA,IAAI4tF,EAAKj8F,EAAEu7F,EAEX,OADAQ,EAAOE,EAAKpyF,KAAKygB,MAAMiiE,EAAKvsF,EAAEi8F,IAAKV,GAAIA,EAAG,KAC3B,GAARO,EAAYvG,GAAYwG,EAAMR,EAAG,GAAK/F,GAAYuG,EAAMR,EAAG,EACtE,CAEA,IAAIvN,EAAKkN,GAAMU,GAAMpB,EAAKU,GAAMW,GAC5BK,EAAKd,GAAQQ,EAAK5N,GAAKmO,EAAKf,GAAQS,EAAKrB,GAC7C,GAAY,GAAR1yF,EAAW,CACX,IAAIs0F,EAAKF,EAAGX,EAAIc,EAAKF,EAAGX,EAAIllE,EAAI8lE,EAAKC,EACjCC,EAAKF,EAAG9lE,EAAGimE,EAAKF,EAAG/lE,EAGvB,OAFA0lE,EAAK,GAAGM,EAAGA,GAAIf,EAAG,GAAKgB,EAAGA,GAAIf,EAAG,IACjCO,EAAQ5C,GAAMnL,EAAGwM,GAAI3wF,KAAKygB,KAAKgM,GAChB,GAARwlE,EAAYvG,GAAYwG,EAAMC,GAAMxG,GAAYuG,EAAMC,EACjE,CAII,OAFAA,EAAKT,EAAKC,EAAK,EACfO,EAAO5C,GAAMnL,EAAGwM,GAAI3wF,KAAKygB,KAAK0xE,EAAGT,EAAGC,IAAKD,EAAGC,KAAMD,EAAG,GAAGW,GAAIV,EAAG,GAAGW,KACnD,GAARL,EAAYvG,GAAYwG,EAAMC,GAAMxG,GAAYuG,EAAMC,EAErE,CAEA,SAASpG,GAAa5E,EAAOzB,EAAQv0F,GACjC,OAAQy6F,GAAUzE,EAAM,EAAGh2F,EAAK,GAAGu0F,EAAO1lF,KAAKygB,KAAKtvB,EACxD,CAEA,SAAS66F,GAAgB7E,EAAOzB,EAAQv0F,GACpC,OAAQ84F,GAAW9C,EAAM,GAAGzB,EAAO1lF,KAAKygB,KAAKtvB,EACjD,CAEA,SAAS86F,GAAM0G,GACX,OAAO3I,GAAY2I,GAAG,GAAQ,EAClC,CAEA,SAASzG,GAAIl2F,GACT,OAAOg0F,GAAYh0F,EACvB,CAEA,SAASm2F,GAAan2F,EAAGI,EAAGgqC,EAAG2mD,GAC3B,GAAIA,EACA,MAAO,GAAM,GAAI2C,IAAK1pF,KAAK8jC,IAAI9tC,GAAGI,IAAIgqC,EAAEpgC,KAAKygB,KAAK,KAEtD,IAAIogB,EAAI7gC,KAAK8jC,IAAI9tC,GAAGI,EACpB,OAAO4J,KAAKmgD,KAAKtf,EAAEA,GAAG,EAAET,EAAEA,KAAKpqC,EAAEoqC,EAAEpgC,KAAKygB,KAAK,EAAEzgB,KAAKqjF,IACxD,CAEA,SAAS+I,GAAY9mC,EAAGlvD,EAAGgqC,GACvB,OAAOpgC,KAAKmgD,IAAIgqC,GAAS7kC,EAAGlvD,EAAGgqC,GACnC,CAEA,SAASisD,GAAKuG,EAAIC,EAAIC,EAAI3jC,GACtB,IACWr8D,EADP0D,EAAIo8F,EAAGhiG,OACPwvC,EAAI,EACR,IAAKttC,EAAI,EAAGA,EAAI0D,EAAG1D,IAAK,CACpB,GAAI+/F,EAAG//F,IAAM,GAAK+/F,EAAG//F,GAAK,EACtB,MAAM,IAAIs0C,GAAU,OAExBhH,GAAKyyD,EAAG//F,EACZ,CACA,GAAS,GAALstC,EACA,MAAM,IAAIgH,GAAU,OAExB,IAAIi+C,EAAM,EACV,IAAKvyF,EAAI,EAAGA,EAAI0D,EAAG1D,IAAK,CACpB,IAAIkD,EAAI48F,EAAG9/F,GACPkD,GAAK88F,GAAM98F,GAAKm5D,IAChBk2B,GAAOwN,EAAG//F,GAElB,CACA,OAAOuyF,CACX,CAEA,SAASiH,GAAMyG,EAAIH,GAEf,IADA,IAAII,EAAK3B,GAAMuB,GAAKK,EAAK5B,GAAM0B,GAAKG,EAAK,EAAGC,EAAK,EACxCrgG,EAAI,EAAG0D,EAAIu8F,EAAGniG,OAAQkC,EAAI0D,EAAG1D,IAAK,CACvC,IAAI+tC,EAAI+xD,EAAG9/F,GAAKkgG,EAChBE,GAAMryD,GAAGkyD,EAAGjgG,GAAKmgG,GACjBE,GAAMtyD,EAAEA,CACZ,CACA,OAAOqyD,EAAGC,CACd,CAEA,SAAS5G,GAAUwG,EAAIH,GAInB,IAHA,IAAII,EAAK3B,GAAMuB,GAAKK,EAAK5B,GAAM0B,GAE3BG,EAAK,EAAGC,EAAK,EACRrgG,EAAI,EAAG0D,EAAIu8F,EAAGniG,OAAQkC,EAAI0D,EAAG1D,IAAK,CACvC,IAAI+tC,EAAI+xD,EAAG9/F,GAAKkgG,EAChBE,GAAMryD,GAAGkyD,EAAGjgG,GAAKmgG,GACjBE,GAAMtyD,EAAEA,CACZ,CACA,OAAOoyD,EAAKC,EAAGF,EAAGG,CACtB,CAEA,SAAS3G,GAAQoG,EAAIG,IAisBrB,SAA0Bl4F,EAAG4O,GACzB,IAAK,IAAI3W,EAAI+H,EAAEjK,SAAUkC,GAAK,GACP,iBAAR+H,EAAE/H,IAAiC,iBAAR2W,EAAE3W,KACpC+H,EAAEkG,OAAOjO,EAAG,GACZ2W,EAAE1I,OAAOjO,EAAG,GAGxB,CAvsBIsgG,CAAiBR,EAAIG,GAGrB,IAFA,IAAIC,EAAK3B,GAAMuB,GAAKK,EAAK5B,GAAM0B,GAC3BM,EAAK,EAAGjM,EAAK,EAAGkM,EAAK,EACjBxgG,EAAI,EAAG0D,EAAIo8F,EAAGhiG,OAAQkC,EAAI0D,EAAG1D,IAAK,CACtC,IAAI4mC,EAAKk5D,EAAG9/F,GAAKkgG,EAAIO,EAAKR,EAAGjgG,GAAKmgG,EAClCI,GAAM35D,EAAG65D,EACTnM,GAAM1tD,EAAGA,EACT45D,GAAMC,EAAGA,CACb,CACA,OAAOF,EAAGrzF,KAAKygB,KAAK2mE,EAAGkM,EAC3B,CAEA,SAAS7G,GAAImG,EAAIG,GACb,IAAIn9F,EAAI42F,GAAQoG,EAAIG,GACpB,OAAOn9F,EAAEA,CACb,CAEA,SAAS82F,GAAMqG,EAAIH,GAIf,IAHA,IAAIp8F,EAAIo8F,EAAGhiG,OACPoiG,EAAK3B,GAAMuB,GAAKK,EAAK5B,GAAM0B,GAC3BM,EAAK,EAAGjM,EAAK,EAAGkM,EAAK,EAChBxgG,EAAI,EAAGA,EAAI0D,EAAG1D,IAAK,CACxB,IAAI4mC,EAAKk5D,EAAG9/F,GAAKkgG,EAAIO,EAAKR,EAAGjgG,GAAKmgG,EAClCI,GAAME,EAAGA,EACTnM,GAAM1tD,EAAG65D,EACTD,GAAM55D,EAAGA,CACb,CACA,OAAO15B,KAAKygB,MAAM4yE,EAAKjM,EAAGA,EAAGkM,IAAK98F,EAAE,GACxC,CAEA,SAASm2F,GAAS32F,EAAG+8F,EAAIH,GAGrB,IAFA,IAAII,EAAK3B,GAAMuB,GAAKK,EAAK5B,GAAM0B,GAC3BM,EAAK,EAAGjM,EAAK,EACRt0F,EAAI,EAAG0D,EAAIo8F,EAAGhiG,OAAQkC,EAAI0D,EAAG1D,IAAK,CACvC,IAAI4mC,EAAKk5D,EAAG9/F,GAAKkgG,EACjBK,GAAM35D,GADoBq5D,EAAGjgG,GAAKmgG,GAElC7L,GAAM1tD,EAAGA,CACb,CACA,GAAW,IAAP0tD,EACA,MAAM,IAAIhgD,GAAU,OAExB,IAAI39B,EAAI4pF,EAAGjM,EACX,OADmB6L,EAAKxpF,EAAEupF,EACfvpF,EAAEzT,CACjB,CAEA,SAASw9F,GAAUC,GAEf,IADA,IAAIj9F,EAAIi9F,EAAI9/F,OAAQ0oC,EAAM,EACjBvpC,EAAE,EAAGA,EAAI0D,EAAG1D,IACjBupC,GAAOo3D,EAAI15F,KAAKjH,GAAG,GAEvB,OAAOupC,EAAI7lC,CACf,CAEA,SAASk9F,GAAWD,EAAKE,GAErB,IADA,IAAIn9F,EAAIi9F,EAAI9/F,OAAQigG,EAAK,EAChB9gG,EAAE,EAAGA,EAAI0D,EAAG1D,IAAK,CACtB,IAAIkD,EAAIy9F,EAAI15F,KAAKjH,GAAG,GAAK6gG,EACzBC,GAAM59F,EAAEA,CACZ,CACA,OAAO49F,CACX,CAEA,SAAShH,GAAOiH,EAAGC,EAAGC,EAAOC,GACzB,IAAIlhG,EAAI,EAEHghG,IAEDA,EAAID,EAAEniG,KAAI,WAAY,QAASoB,CAAG,KAGlCihG,KACAD,EAAIA,EAAE90F,SACJ6gC,SAAQ,SAAS58B,GACf6wF,EAAE/5F,KAAKkJ,GAAKqb,QAAQ,EACxB,MACEw1E,EAAEpgG,OAGR,IAAIugG,EAAKH,EAAE7zD,YACPi0D,EAAID,EAAG9zD,SAAS2zD,GAAGhzD,UAAUX,SAAS8zD,GAAI9zD,SAAS0zD,GACnDM,EAAS,GACb,IAAKrhG,EAAIohG,EAAEvgG,OAAO,EAAGb,GAAK,EAAGA,IACzBqhG,EAAOjkG,KAAKgkG,EAAEn6F,KAAKjH,GAAG,IAK1B,GAHKihG,GACDI,EAAOjkG,KAAK,IAEX8jG,EACD,OAAOzkG,KAAK2uC,SAAS,CAAEi2D,IAG3B,IAAIC,EAAKN,EAAE3zD,SAAS+zD,GAChBG,EAAOR,EAAEtzD,KAAK6zD,GAAI,GAElBE,EAAQZ,GAAWU,EADbL,EAAWP,GAAUY,GAAd,GAGbG,EAAUb,GAAWW,EADfN,EAAWP,GAAUa,GAAd,GAEbG,EAAS,GACbA,EAAOtkG,KAAKokG,EAAOC,GACnB,IAAIE,EAAKH,GAASA,EAAQC,GACtBG,EAASb,EAAElgG,OAASmgG,EAAEpgG,MACtBihG,EAAU30F,KAAKygB,KAAK8zE,EAAUG,GAC9BE,EAAS,GACbA,EAAO1kG,KAAKukG,EAAIE,GAChB,IAAIE,EAASd,EAA0CO,GAAOR,EAAEpgG,MAAM,IAAK6gG,EAAQG,GAA7DD,EAAGX,EAAEpgG,QAAS,EAAE+gG,GAAI,GACtCK,EAAS,GACbA,EAAO5kG,KAAK2kG,EAAOH,GACnB,IAAIK,EAAMd,EAAG9zD,SAAS2zD,GAAGhzD,UACrBk0D,EAAS,GACb,IAAKliG,EAAEiiG,EAAIphG,OAAO,EAAGb,GAAK,EAAGA,IACzBkiG,EAAO9kG,KAAK8P,KAAKygB,KAAKs0E,EAAIh7F,KAAKjH,GAAGA,GAAGyhG,EAAQG,IAEjD,OAAOnlG,KAAK2uC,SAAS,CAACi2D,EAAQa,EAAQJ,EAAQE,EAAQN,GAC1D,CAEA,SAAS3H,GAAOgH,EAAGC,EAAGC,EAAOC,GACzB,OAAOpH,GAAO78F,KAAKR,KAAMskG,EAAEniG,IAAIsO,KAAK8jC,KAAMgwD,EAAGC,EAAOC,GAAOtiG,IAAIsO,KAAKmgD,IACxE,CAEA,SAAS2sC,GAAM+G,EAAGC,EAAGmB,EAAGlB,GACpB,IAAIjhG,EAAI,EAEHghG,IAEDA,EAAID,EAAEniG,KAAI,WAAY,QAASoB,CAAG,KAGlCihG,KACAD,EAAIA,EAAE90F,SACJ6gC,SAAQ,SAAS58B,GACf6wF,EAAE/5F,KAAKkJ,GAAKqb,QAAQ,EACxB,MACEw1E,EAAEpgG,OAGR,IAAIugG,EAAKH,EAAE7zD,YACPi0D,EAAID,EAAG9zD,SAAS2zD,GAAGhzD,UAAUX,SAAS8zD,GAAI9zD,SAAS0zD,GAavD,OAXKoB,EAGGlB,KACAkB,EAAIA,EAAEj2F,SACJ6gC,SAAQ,SAAS58B,GACfgyF,EAAEl7F,KAAKkJ,GAAKqb,QAAQ,EACxB,MACE22E,EAAEvhG,OAPRuhG,EAAInB,EAUDmB,EAAE90D,SAAS+zD,EACtB,CAEA,SAASnH,GAAO8G,EAAGC,EAAGoB,EAAOnB,GAEzB,OAAOjH,GAAM/8F,KAAKR,KAAMskG,EAAEniG,IAAIsO,KAAK8jC,KAAMgwD,EAAGoB,EAAOnB,GAAOriG,IAAIsO,KAAKmgD,IACvE,CAcA,SAASg1C,GAAYj2D,EAAMk2D,EAAOC,EAAQC,GAItC,IAHA,IAAInG,EAASkG,GAAU,GACnBjG,EAAMkG,GAAO,KACb1zE,EAAOwzE,EACFh7F,EAAI,EAAGA,GAAK+0F,EAAQ/0F,IAAK,CAC9B,IAAIm7F,EAAMr2D,EAAKtd,GAGXrB,EAFIg1E,EAAI,GACHA,EAAI,GAGb,GADA3zE,GAAQrB,EACJvgB,KAAK0pB,IAAInJ,GAAM6uE,EACf,OAAOxtE,CAEf,CACA,OAAO,IAAIwlB,GAAU,MACzB,CAgBA,SAAS4lD,GAAGwI,EAAMC,EAAMC,EAAKC,EAAI13F,GAC7B,IAAI23F,EAAK51F,KAAKyoC,IAAI,EAAE+sD,EAAMC,GAE1B,QAASE,EAAKC,EAAKF,GADVF,GAAQI,EAAK,GAAGJ,EAAOC,IACD,EAAID,EAAKv3F,GAC5C,CAMA,SAASgvF,GAAGuI,EAAMC,EAAMC,EAAKG,EAAI53F,GAC7B,IAAKu3F,EACD,OAAQK,EAAKH,EAAID,EAErB,IAAIG,EAAK51F,KAAKyoC,IAAI,EAAE+sD,EAAMC,GAC1B,QAASI,EAAKH,GAAOE,EAAK,GAAGJ,GAAQ,EAAIA,EAAKv3F,IAAS23F,CAC3D,CAKA,SAAS1I,GAAIsI,EAAMC,EAAME,EAAIE,EAAI53F,GAC7B,IAAKu3F,EACD,QAASK,EAAKF,GAAIF,EAEtB,IAAIG,EAAK51F,KAAKyoC,IAAI,EAAE+sD,EAAMC,GAC1B,OAAQD,GAAMK,EAAKF,EAAGC,KAAM,EAAIJ,EAAKv3F,IAAO23F,EAAK,GACrD,CAKA,SAASzI,GAAKqI,EAAME,EAAKC,EAAIE,EAAI53F,GAC7B,IAAKu3F,EACD,QAASK,EAAKF,GAAMD,EAExB,IAAIE,EAAKF,GAAK,EAAIF,EAAKv3F,GACvB,OAAO+B,KAAK8jC,KAAK8xD,EAAKC,EAAGL,IAAOI,EAAKD,EAAGH,IAASx1F,KAAK8jC,IAAI,EAAI0xD,EAClE,CAMA,SAASpI,GAAMqI,EAAMC,EAAKC,EAAIE,EAAI53F,EAAMm3F,GAMpC,OAAOD,IALP,SAAan/F,GACT,IAAI8/F,EAAK91F,KAAKyoC,IAAI,EAAEzyC,EAAGy/F,EAAK,GAAIG,EAAKE,GAAI,EAAE9/F,GAC3C,MAAO,CAAE2/F,EAAGC,EAAKF,GAAK,EAAE1/F,EAAIiI,IAAO23F,EAAK,GAAKC,EACpCJ,EAAKE,EAAGG,EAAKJ,KAAOE,EAAK,IAAI5/F,EAAEA,IAAM,EAAEA,EAAIiI,GAAMw3F,EAAKK,GACnE,GACwBV,EAC5B,CAKA,SAAS/H,GAAKmI,EAAMO,EAAKN,EAAME,EAAIE,EAAI53F,GACnC,GAAS,GAANA,GAAgB,GAAL83F,EACV,OAAO,EAEX,IACIC,EAAOhJ,GAAGwI,EAAMO,EAAM,EADhB7I,GAAIsI,EAAMC,EAAME,EAAIE,EAAI53F,GACA03F,EAAI13F,GAAQu3F,EAC9C,OAAOv3F,EAAO+3F,GAAM,EAAIR,GAAQQ,CACpC,CAEA,SAAS1I,GAAKkI,EAAMO,EAAKN,EAAME,EAAIE,EAAI53F,GAEnC,OADUivF,GAAIsI,EAAMC,EAAME,EAAIE,EAAI53F,GACrBovF,GAAKmI,EAAMO,EAAKN,EAAME,EAAIE,EAAI53F,EAC/C,CAMA,SAASsvF,GAASiI,EAAMC,EAAME,EAAIr0E,EAAOvM,EAAK9W,GAC/B,GAARA,IACCqjB,IACAvM,KAEJ,IAAIkhF,EAAKj2F,KAAKyoC,IAAI,EAAI+sD,EAAMC,GACxBS,EAAKl2F,KAAKyoC,IAAI,EAAI+sD,EAAMl0E,EAAM,GAC9B60E,EAAKn2F,KAAKyoC,IAAI,EAAI+sD,EAAMzgF,GACxBqhF,EAAiBZ,EAAOG,EAAKM,GAAMA,EAAK,GAG5C,OAD4BE,EAAKR,GAAOQ,EAAK,GAAKX,EAAQY,GAD5BF,EAAKP,GAAOO,EAAK,GAAKV,EAAQY,EAGhE,CAGA,SAAS5I,GAAQgI,EAAMC,EAAME,EAAIr0E,EAAOvM,EAAK9W,GAEzC,IADA,IAAIo4F,EAAM,EACFvjG,EAAEwuB,EAAOxuB,GAAGiiB,EAAKjiB,IACrBujG,GAAOhJ,GAAKmI,EAAM1iG,EAAG2iG,EAAME,EAAI,EAAG13F,GAEtC,OAAOo4F,CACX,CAGA,SAAS5I,GAAI+H,EAAMc,GAEf,IADA,IAAIC,EAAM,EACFzjG,EAAE,EAAG0D,EAAE8/F,EAAM1lG,OAAQkC,EAAI0D,EAAG1D,IAChCyjG,GAAOD,EAAMxjG,GAAGkN,KAAKyoC,IAAI,EAAI+sD,GAAO1iG,EAAE,GAE1C,OAAOyjG,CACX,CAGA,SAAS7I,GAAI4I,EAAOlB,GAShB,OAAOD,IARP,SAAan/F,GAET,IADA,IAAIugG,EAAM,EAAGC,EAAO,EACZp8F,EAAE,EAAG5D,EAAE8/F,EAAM1lG,OAAQwJ,EAAI5D,EAAG4D,IAChCm8F,GAAOD,EAAMl8F,GAAG4F,KAAKyoC,IAAI,EAAIzyC,GAAIoE,EAAE,GACnCo8F,IAASp8F,EAAEk8F,EAAMl8F,GAAG4F,KAAKyoC,IAAI,EAAEzyC,GAAIoE,EAAE,GAEzC,MAAO,CAACm8F,EAAKC,EACjB,GACwBpB,EAC5B,CAMA,SAASzH,GAAO8I,EAAcC,GAC1B,OAAO12F,KAAKyoC,IAAI,EAAIguD,EAAaC,EAAOA,GAAS,CACrD,CAGA,SAAS9I,GAAQ+I,EAAaD,GAC1B,OAAOA,GAAO12F,KAAKyoC,IAAIkuD,EAAc,EAAG,EAAED,GAAS,EACvD,CAGA,SAAS7I,GAAK2H,EAAM9+F,EAAQ6kF,GAExB,IADA,IAAIgb,EAAM,EACFzjG,EAAE,EAAG0D,EAAEE,EAAO9F,OAAQkC,EAAI0D,EAAG1D,IACjCyjG,GAAO7/F,EAAO5D,GAAGkN,KAAKyoC,IAAI,EAAI+sD,GAAOja,EAAM,GAAGA,EAAMzoF,IAAI,KAE5D,OAAOyjG,CACX,CAGA,SAASzI,GAAKp3F,EAAQ6kF,EAAO6Z,GAUzB,OAAOD,IATP,SAAan/F,GAET,IADA,IAAIugG,EAAM7/F,EAAO,GAAI8/F,EAAO,EACpBp8F,EAAE,EAAG5D,EAAEE,EAAO9F,OAAQwJ,EAAI5D,EAAG4D,IAAK,CACtC,IAAIoK,GAAS+2E,EAAM,GAAKA,EAAMnhF,IAAM,IACpCm8F,GAAO7/F,EAAO0D,GAAG4F,KAAKyoC,IAAI,EAAIzyC,EAAGwO,GACjCgyF,GAAQhyF,EAAM9N,EAAO0D,GAAG4F,KAAKyoC,IAAI,EAAEzyC,EAAGwO,EAAQ,EAClD,CACA,MAAO,CAAC+xF,EAAKC,EACjB,GACwBpB,EAC5B,CAGA,SAASrH,GAAMyH,EAAMO,EAAKN,EAAME,GAE5B,OADWA,EAAGH,GACF,EAAIO,EAAIN,EACxB,CAGA,SAASzH,GAAG4I,EAAMC,EAASC,EAAMC,EAAQvxD,GACrC,IAAIgwD,EAAO,EAAIx1F,KAAKyoC,IAAIouD,EAAQD,EAAM,EAAEE,GAEpCE,EAAKJ,GADTpB,EAAOx1F,KAAKgnB,MAAW,IAALwuE,EAAY,IAAO,KACdhwD,EAAQ,GAC/B,GAAa,GAAVuxD,EACC,OAAOC,EAEX,IAAI,IAAIlkG,EAAE,EAAGA,EAAIgkG,EAAMhkG,IAAK,CACxB,GAAGA,GAAKikG,EAAS,EACb,OAAQH,EAAOI,GAAMxB,EAEzBwB,IAAOJ,EAAOI,GAAMxB,CACxB,CACA,OAAQoB,EAAOI,GAAMxB,GAAQ,GAAKhwD,GAAS,EAC/C,CAGA,SAASyoD,GAAI2I,EAAMC,EAASC,EAAMC,EAAQE,GACtC,IAAIngG,EAAImgG,EAASH,EACbI,GAASN,GAAQ52F,KAAKyoC,IAAI,EAAE3xC,EAAGigG,EAAO,GAAK,GAC3CI,GAAOP,EAAOM,GAASpgG,EAG3B,OADAqgG,EAAMn3F,KAAKC,IAAIk3F,EAAKn3F,KAAKmK,IAAI,EAAGysF,EAAOM,EAAQL,GAEnD,CAGA,SAAS3I,GAAI0I,EAAMC,EAASC,GACxB,OAAQF,EAAOC,GAAWC,CAC9B,CAGA,SAAS3I,GAAIyI,EAAMC,EAASC,EAAMf,GAC9B,OAAQa,EAAOC,IAAYC,EAAOf,EAAM,GAAK,GAAKe,GAAQA,EAAO,GACrE,CAOA,SAAS1I,GAAKwI,EAAMC,EAASC,EAAMx1E,EAAOvM,EAAKkiF,EAAQG,GACnD,IAAIC,EAAWJ,GAAUH,EAAO,EAAIG,EAASH,EAE7C,SAASQ,EAAQ7lG,EAAOslG,GACpB,IAAIQ,EAAKC,EAAUv6E,EAQnB,OANIu6E,EADY,GAAZH,EACqB,GAAVN,EAActlG,EAAQ,EAEtBA,EAAQuO,KAAKyoC,IAAI,EAAI4uD,EAAUN,EAAS,IAGvDQ,GADAt6E,EAAWxrB,EAAQuO,KAAKyoC,IAAI,EAAI4uD,EAAUN,IACzBF,EAAUW,EAAWX,EAAUW,EAAWv6E,GAC9C,EAAI,EAAIs6E,CACzB,CAEA,SAASE,EAAUb,EAAMc,EAAOX,GAI5B,IAHA,IAEIY,EAFAC,EAAWhB,EAAOC,EAClBgB,EAAS73F,KAAK4jF,KAAKmT,GACbe,EAAM,EAAGC,EAAM,EAAGC,GAAS,EAC5BllG,EAAI,EAAGA,GAAK+kG,EAAQ/kG,IAAK,CAC9B,GAAKklG,EAWDL,EAAOG,MAXE,CACT,IAAIP,EAAMD,EAAQV,EAAM9jG,IACxBglG,EAAMF,GAAYF,EAAQ5kG,EAAI,IACpBykG,GACNI,EAAOG,EACPE,GAAS,IAETL,EAAOJ,EACPK,GAAYL,EAEpB,CAGIzkG,GAAK+kG,IACLF,GAAQZ,EAAS,EAAIc,GAEzBE,GAAOJ,CACX,CACA,OAAOI,CACX,CAEA,IAAIE,EAAWj4F,KAAKgnB,MAAM1F,GAAQu2E,EAAS73F,KAAK4jF,KAAK7uE,GACjDgjF,EAAM,EACV,GAAIX,EACA,IAAK,IAAItkG,EAAImlG,EAAW,EAAGnlG,GAAK+kG,EAAQ/kG,IAAK,CACzC,IAAI6kG,EAAOL,EAAQV,EAAM9jG,GACrBA,GAAKmlG,EAAW,EAChBN,GAAQ33F,KAAKC,IAAI8U,EAAKkjF,EAAW,GAAK32E,EAElCxuB,GAAK+kG,IACLF,GAAQ5iF,EAAM,EAAI8iF,GAG1BE,GAAOJ,CACX,KACG,CACH,IAAID,EAAQZ,EACZ,GAAIx1E,GAASthB,KAAKgnB,MAAM1F,IAChB21E,EAAS,GACL31E,GAASw1E,EAAO,EAAG,CACnB,IAAIngC,EAAOr1C,EAAQw1E,EAAO,EAC1Bx1E,EAAQw1E,EAAO,EACf/hF,GAAO4hD,EACP+gC,GAAS,CACb,CAGRd,GAAQa,EAAUb,EAAMc,EAAOp2E,GAC/By2E,EAAMN,EAAUb,EAAME,EAAOx1E,EAAOvM,EAAMuM,EAC9C,CACA,OAAOy2E,CACX,CAkBA,SAASG,GAAOroF,EAAM2tE,GAClB,IAAIrnF,EAAImxC,GAAWz3B,GACfzZ,EAAID,EAAEqvC,MAAQg4C,EACdn9D,EAAIlqB,EAAEovC,KAAOvlC,KAAKgnB,MAAM5wB,EAAE,IAM9B,OALAA,GAAK,IACG,IACJA,GAAK,IAETD,EAAI6J,KAAKC,IAAI9J,EAAEsvC,KAAM8B,GAAYlnB,EAAGjqB,IAC7BixC,GAAShnB,EAAGjqB,EAAGD,EAC1B,CAEA,SAASgiG,GAAapvD,EAAMC,EAAIovD,GAC5B,OAAa,GAATA,GAAuB,GAATA,GAAuB,GAATA,EACrBpvD,EAAKD,EAET45C,GAAU55C,EAAMC,EAAIovD,EAC/B,CAIA,SAASC,GAAeC,EAAYC,EAAUC,GAC1C,IAAIC,EAAOnxD,GAAWgxD,GAClBI,EADsCpxD,GAAWixD,GAClChzD,KAAOkzD,EAAKlzD,KAC3BmzD,EAAU,IACVA,GAAWA,EAAU,GAAKF,GAE9B,IAAIniG,EAAYmnF,EAAS,GAAGgb,EAC5B,GAEIniG,EAAO6hG,GAAOK,KADdG,EACkClb,SAC7B8a,EAAajiG,GAGtB,MAAO,CAAEA,EADF6hG,GAAOK,MADdG,EACkClb,GAEtC,CAqBA,SAAS8Q,GAAUgK,EAAYC,EAAUI,EAAWP,GAEhD,OAAOD,GADIE,GAAeC,EAAYC,EAAUI,GAAW,GACjCL,EAAYF,EAC1C,CAIA,SAAS7J,GAASqK,EAAOC,EAAOL,EAAMJ,GAClC,GAAa,GAATA,EAAY,CACZ,IAAIpgE,EAAUqgE,GAAeO,EAAOC,EAAOL,GAC3C,OAAOL,GAAangE,EAAQ,GAAIA,EAAQ,GAAI,EAChD,CACA,OAAa,GAATogE,EACO,IAAII,EAER,IAAIA,CACf,CAIA,SAAShK,GAAWoK,EAAOC,EAAOL,EAAMJ,GAEpC,OAAOD,GAAaS,EADTP,GAAeO,EAAOC,EAAOL,GAAM,GACbJ,EACrC,CAIA,SAAS3J,GAAQmK,EAAOC,EAAOL,GAE3B,OAAOH,GAAeO,EAAOC,EAAOL,GAAM,EAC9C,CAIA,SAAS9J,GAAQkK,EAAOC,EAAOL,GAE3B,OAAOH,GAAeO,EAAOC,EAAOL,GAAM,EAC9C,CAEA,SAAS7J,GAAQiK,EAAOC,EAAOL,GAC3B,IAAIC,EAAOnxD,GAAWsxD,GAClBE,EAAMxxD,GAAWuxD,GAQrB,OAAO,IAPM,IAAIC,EAAIvzD,KAAOkzD,EAAKlzD,MAAQuzD,EAAItzD,MAAQizD,EAAKjzD,OAOrCgzD,EAAO,GAAK,EACrC,CAEA,SAAS7wD,GAAW1C,EAAImzD,GACpB,OAAa,GAATA,EAAqB,IACZ,GAATA,EAAqB1wD,GAAWzC,GAAM,IAAM,IACzC,GACX,CAGA,SAAS2pD,GAASmK,EAAOR,EAAU/C,EAAMwD,EAAKZ,GAC1C,IAAIa,EAAYtxD,GAAWL,GAAWixD,GAAUhzD,KAAM6yD,GACtD,OAAO5C,EAAKwD,EAAMb,GAAaY,EAAOR,EAAUH,GAASa,CAC7D,CAEA,SAASpK,GAAQkK,EAAO92E,EAAO22E,EAAOpD,EAAMwD,EAAKR,EAAMJ,EAAOp0F,GAC1D,IACIk1F,EAAO7iG,EAAMmrC,EAAM23D,EAAOC,EAAOC,EADjCC,EAAO,EAAG1C,EAAOoC,EAAMxD,EAAOgD,EAG9Be,EAASnB,EAAQ,GAAM,EAAI,IAAM,IACrC,SAASoB,EAAYzwD,EAAMC,GACvB,OAAQA,EAAKD,GAAMyvD,EAAKe,EAAS,CACrC,CAEA,OAAIX,GAAS32E,GAET5rB,GADA6iG,EAAQb,GAAeO,EAAO32E,EAAOu2E,IACxB,GACbh3D,EAAO03D,EAAM,GACT7iG,GAAQ0iG,EACDnC,EAAOuB,GAAaY,EAAOH,EAAOR,GAASD,GAAa9hG,EAAMmrC,EAAM42D,IAG/Ee,GADAD,EAAQb,GAAeU,EAAO1iG,EAAMmiG,IACtB,GAGP5B,IADPyC,EAAMG,EADNJ,EAAQF,EAAM,GACWN,IAGpBT,GAAaY,EAAOK,EAAOhB,GAASD,GAAagB,EAAOC,EAAOhB,IAC9DQ,EAAQp3D,EAAM22D,GAAa9hG,EAAMuiG,EAAOR,GAASD,GAAa9hG,EAAMmrC,EAAM42D,GAAS,OAEzFc,EA1GR,SAA2Bj3E,EAAOq2E,EAAYE,GAC1C,IAAIC,EAAOnxD,GAAWgxD,GAAazoF,EAAOy3B,GAAWrlB,GACjDy2E,EAAUD,EAAKlzD,KAAO11B,EAAK01B,KAC3BmzD,EAAU,IACVA,GAAWA,EAAU,GAAKF,GAG9B,IADA,IAAkBh3D,EAAdnrC,EAAO4rB,EAAau7D,EAAS,GAAGgb,EAC7BF,EAAajiG,GAChBmrC,EAAOnrC,EAEPA,EAAO6hG,GAAOj2E,IADdy2E,EAC6Blb,GAEjC,MAAO,CAAEh8C,EAAMnrC,EACnB,CA6FgBojG,CAAkBx3E,EAAO22E,EAAOJ,GACxCniG,EAAO6iG,EAAM,GACb13D,EAAO03D,EAAM,GACbG,EAAMG,EAAYv3E,EAAO22E,GAErBU,EADA93D,GAAQo3D,EACDhC,EAAOyC,EAEPzC,GAAQyC,EAAMlB,GAAa9hG,EAAMuiG,EAAOR,GAASD,GAAa9hG,EAAMmrC,EAAM42D,IAEhFp0F,GAEL3N,GADA6iG,EAAQb,GAAeU,EAAO92E,EAAOu2E,IACxB,GACbh3D,EAAO03D,EAAM,GAEbI,GAAQ1C,IADRyC,EAAMG,EAAYT,EAAO92E,IACHk2E,GAAaY,EAAOv3D,EAAM42D,GAASD,GAAa9hG,EAAMmrC,EAAM42D,KAL9DkB,EAQ5B,CAGA,SAASxK,GAAK8J,EAAOC,EAAOa,EAAIC,EAAYvB,GAExC,OAAQuB,EAAaD,GAAIC,GADZvB,EAAQ,GAAM,EAAI,IAAO1wD,GAAWJ,GAAWsxD,GAAOrzD,MAAQ,IAAM,KACtC4yD,GAAaS,EAAOC,EAAOT,EAC1E,CAGA,SAASrJ,GAAQ6J,EAAOC,EAAOe,EAAYD,EAAYvB,GAEnD,OAAQuB,EAAaC,GAAYA,GADpBxB,EAAQ,GAAM,EAAI,IAAO1wD,GAAWJ,GAAWsxD,GAAOrzD,MAAQ,IAAM,KAC9B4yD,GAAaS,EAAOC,EAAOT,EAClF,CAGA,SAASpJ,GAAS4J,EAAOC,EAAOe,EAAYC,EAAUzB,GAClD,IAAImB,EAASnB,EAAQ,GAAM,EAAI,IAAO1wD,GAAWJ,GAAWsxD,GAAOrzD,MAAQ,IAAM,IACjF,OAAOq0D,GAAY,EAAIC,EAAS1B,GAAaS,EAAOC,EAAOT,GAAOmB,EACtE,CAGA,SAAStK,GAAM2J,EAAOC,EAAOrD,EAAMsE,EAAKH,EAAYnB,EAAMJ,GACtD,IAAI2B,EAAI,IAAMlB,EAAQD,GAAOJ,GAAMJ,EAAQ,GAAM,EAAI,IAAM,KAAO,GAC9Dc,EAAQb,GAAeO,EAAOC,EAAOL,GACrCniG,EAAO6iG,EAAM,GAAI13D,EAAO03D,EAAM,GAC9Bc,EAAY7B,GAAa9hG,EAAMuiG,EAAOR,GACtC6B,EAAY9B,GAAaS,EAAOp3D,EAAM42D,GACtC8B,EAAU/B,GAAa9hG,EAAMmrC,EAAM42D,GACnC+B,EAAM,IAAI3E,EAAKgD,EACf4B,EAAKN,EAAItB,EACTvyD,EAAOg0D,EAAYC,EACvB,OAAS,GAALH,GACQJ,EAAaQ,IAAM,EAAIl0D,EAAKm0D,GAAMJ,EAAYE,EAAUC,EAE7DR,EAAa35F,KAAKyoC,IAAI,EAAI2xD,EAAIL,EAAE,EAAE9zD,GACnCk0D,EAAMn6F,KAAKyoC,IAAI,EAAI2xD,EAAI,EAAEL,EAAE9zD,IAASjmC,KAAKyoC,IAAI,EAAE2xD,EAAIL,GAAK,GAAKK,EAC7DJ,EAAYE,EAAUC,CAChC,CAGA,SAASjL,GAAU0J,EAAOC,EAAOgB,EAAUF,EAAYvB,GAGnD,OAAOuB,EAAaE,EAASF,EAFnBxB,GAAaS,EAAOC,EAAOT,GAC5BzwD,GAAWL,GAAWuxD,GAAOtzD,KAAM6yD,EAEhD,EAeJ,SAAU5oG,GAEF,IAAIuB,EAAIvB,EAAMwF,OACVqlG,EAAe,CACf,aACA,gBACA,0BACA,wBACA,iBACA,aACA,YACA,cACA,eACA,aAEAC,EAAqB,CACtB90F,WAAY,aACZF,cAAe,gBACfe,wBAAyB,0BACzBC,sBAAuB,wBACvBf,eAAgB,iBAChBE,WAAY,aACZM,UAAW,YACXH,YAAa,cACbM,aAAc,eACdb,UAAW,eAGVk1F,EAA0B/qG,EAAMsN,YAAY0V,SAASgoF,cAAgB,CACrEh1F,WAAY,cACZF,cAAe,iBACfe,wBAAyB,4BACzBC,sBAAuB,0BACvBf,eAAgB,kBAChBE,WAAY,cACZM,UAAW,aACXH,YAAa,eACbM,aAAc,gBACdb,UAAW,aAGXo1F,EAAqB,CACrB,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAGnGC,EAAgBlrG,EAAMqiB,GAAGC,OAAOniB,OAAO,CACvCC,KAAM,SAAS+d,EAAS9d,GACpBL,EAAMqiB,GAAGC,OAAO/hB,KAAKR,KAAMoe,EAAS9d,GAEpCN,KAAKoe,QAAUA,EACfpe,KAAK4V,MAAQ,OAEb5V,KAAKoe,QAAQoE,SAAS,uBAEtBxiB,KAAKorG,qBACLprG,KAAKqrG,qBACT,EAEA/qG,QAAS,CACL4L,KAAM,iBAGVxL,OAAQ,CACJ,UAGJwiB,QAAS,WACLljB,KAAKsrG,aAAapoF,UAClBjjB,EAAMijB,QAAQljB,KAAKoe,QAAQwkB,KAAK,sCACpC,EAEA1gC,MAAO,WACH,MAAO,CAAEwM,KAAM1O,KAAK0O,KAAMkH,MAAO5V,KAAK4V,MAC1C,EAEAw1F,mBAAoB,WAChB,IAAItxF,EAAO9Z,KACPijB,EAAW+nF,EAEX5sF,EAAU5c,EAAE,UAAW,CACvB+pG,MAAS,sCAGb/pG,EAAE,oHAAoHwhB,SAAShjB,KAAKoe,SAEpIA,EAAQ4E,SAAShjB,KAAKoe,SAEtB0sF,EAAa3oG,KAAI,SAASuM,GACtBlN,EAAE,kBAAoByhB,EAASvU,GAAQ,iBAAmBuU,EAASvU,GAAQ,uBAAyBA,EAAO,MACtGsU,SAAS5E,GACTotF,kBAAkB,CACf7oF,KAAM1iB,EAAM+F,UAAU+kG,EAAmBr8F,IACzC4d,OAAQxS,EAAK2xF,QAAQv8F,KAAK4K,IAEtC,GACJ,EAEAuxF,oBAAqB,WACjB,IAAIjtF,EAAU5c,EAAE,UAAW,CACvB+pG,MAAS,uCAGb/pG,EAAE,qHAAqHwhB,SAAShjB,KAAKoe,SACrIA,EAAQ4E,SAAShjB,KAAKoe,SAEtBpe,KAAKsrG,aAAe,IAAIrrG,EAAMqiB,GAAGopF,gBAAgBttF,EAAS,CACtDutF,SAAU3rG,KAAKM,QAAQ0nB,OACvBpS,MAAO5V,KAAK4V,MACZmU,KAAM,UACN6hF,QAASV,EACT52F,OAAO,EACP0T,OAAQhoB,KAAK6rG,QAAQ38F,KAAKlP,QAG9BA,KAAKsrG,aAAa5oF,QAAQkgB,KAAK,wBAAwBhf,GAAG,QAAS5jB,KAAK8rG,OAAO58F,KAAKlP,OACpFA,KAAKsrG,aAAa5oF,QAAQkgB,KAAK,yBAAyBhf,GAAG,QAAS5jB,KAAK+rG,QAAQ78F,KAAKlP,MAC1F,EAEA6rG,QAAS,WACL7rG,KAAK4V,MAAQ5V,KAAKsrG,aAAappG,OACnC,EAEAupG,QAAS,SAASpjF,GACd,IAAI3Z,EAAO2Z,EAAErW,OAAOxH,KAAK,cACrBmF,EAAW0Y,EAAErW,OAAOg6F,SAAS,eAAexhG,KAAK,sBAEnC,IAAd6d,EAAE4jF,SACEt8F,GACAA,EAAS2c,QAAO,GAGpBtsB,KAAK0O,KAAOA,GAEZ1O,KAAK0O,KAAO,IAEpB,EAEAo9F,OAAQ,WACJ9rG,KAAKkB,QAAQ,SAAU,CAAEwN,KAAM1O,KAAK0O,KAAMkH,MAAO5V,KAAK4V,OAC1D,EAEAm2F,QAAS,WACL/rG,KAAKkB,QAAQ,SAAU,CAAEwN,KAAM,KAAMkH,MAAO,MAChD,IAGJ3V,EAAMsN,YAAY49F,cAAgBA,CAErC,CAzJL,CAyJO1pG,OAAOxB,OAEd,SAAUA,GACN,IAAIuB,EAAIvB,EAAMwF,OAEd,SAASymG,EAAsBC,GAC3B,MAAO,yBAAyBlsG,EAAMqiB,GAAGK,KAAK,CAAEA,KAAMwpF,EAAe7/C,UAAW,gDAAiDrsD,EAAMqiB,GAAGK,KAAK,mCACnJ,CAEA,IAAIypF,EAAUnsG,EAAMqiB,GAAG8pF,QAEnBC,EAAWpsG,EAAMsN,YAAY0V,SAASu7D,QAAU,CAChDh+D,cAAe,kBACfC,eAAgB,mBAChBG,YAAa,gBACbC,YAAa,gBACbyrF,UAAW,YACXC,iBAAkB,CACdC,YAAa,aACbC,cAAe,SACfC,aAAc,cACdC,YAAa,UACbC,SAAU,YACVC,YAAa,eACbC,YAAa,gBAEjBtpB,gBAAiB,aACjBv6C,KAAM,OACNR,QAAS,UACTxsB,KAAM,OACND,IAAK,MACL0E,aAAc,gBACdI,UAAW,aACX3D,OAAQ,SACR8vB,WAAY,OACZtE,SAAU,YACVrzB,OAAQ,mBACRy3F,YAAa,CACTC,UAAW,YACXpqG,KAAM,OACNgxD,OAAQ,SACRgJ,QAAS,UACTqwC,UAAW,YACXljE,SAAU,WACVmM,KAAM,OACNmB,KAAM,OACN61D,SAAU,YACVC,SAAU,WACVC,YAAa,mBAEjBC,sBAAuB,mBACvBC,sBAAuB,mBACvBC,OAAQ,eACRC,cAAe,CACXC,YAAa,eACbC,WAAY,cACZC,cAAe,iBACf11F,SAAU,kBAEd21F,cAAe,iBACfC,YAAa,eACb7kE,OAAQ,SACR1xB,MAAO,cACPw2F,aAAc,CACVC,WAAY,YACZC,kBAAmB,qBACnBC,gBAAiB,mBACjB72F,QAAS,WAEbgS,KAAM,UACN7N,MAAO,QACP2yF,YAAa,CACT/sG,KAAM,OACNH,KAAM,QAEVmtG,SAAU,YACVC,gBAAiB,mBACjBlrG,KAAM,OACNmrG,YAAa,CAGTC,aAAc,oBACdC,cAAe,qBAEnBC,UAAW,aACXC,SAAU,YACV97F,UAAW,YACXqO,WAAY,qBACZ0tF,UAAW,QAiDXC,EAAiB1uG,EAAMsN,YAAYqnB,QAAU,CAC7Co4E,UAAW,KACXpqG,KAAM,IACNgxD,OAAQ,SACRgJ,QAAS,QACTqwC,UAAW,2DACXljE,SAAU,2BACVmM,KAAM,WACNmB,KAAM,gBACN61D,SAAU,gBACVC,SAAU,aAGVjC,EAAqB,CACrB,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAGnG0D,EAAwB3uG,EAAMsN,YAAY0V,SAAS4rF,YAAc,CACjEj/F,MAAO,cACPk/F,YAAa,kBACbjnG,MAAO,QACPknG,OAAQ,UAGRC,EAAe,CACfC,UAAW,CAAEvgG,KAAM,aAEnB0a,KAAM,CACF1a,KAAM,OACNxC,KAAM,OACNyW,KAAM,cACNusF,WAAY,QACZtuG,QAAS,eAEbutG,SAAU,CACNz/F,KAAM,SACNxC,KAAM,WACNw1E,OAAQ,WACRytB,SAAU,QACVxsF,KAAM,YAEVsmB,KAAM,CACFv6B,KAAM,SACN9N,QAAS,wBACT+M,SAAU,OACVzL,OAAO,EACPygB,KAAM,OACNysF,WAAW,GAEfpmE,OAAQ,CACJt6B,KAAM,SACN9N,QAAS,wBACT+M,SAAU,SACVzL,OAAO,EACPygB,KAAM,SACNysF,WAAW,GAEfz8F,UAAW,CACPjE,KAAM,SACN9N,QAAS,wBACT+M,SAAU,YACVzL,OAAO,EACPygB,KAAM,YACNysF,WAAW,GAEf/B,sBAAuB,CACnB3+F,KAAM,SACNxC,KAAM,wBACNtL,QAAS,wBACTsB,OAAQ,EACRygB,KAAM,oBAEV2qF,sBAAuB,CACnB5+F,KAAM,SACNxC,KAAM,wBACNtL,QAAS,wBACTsB,MAAO,EACPygB,KAAM,oBAEV8rF,SAAU,CACN//F,KAAM,SACNxC,KAAM,WACNtL,QAAS,kBACT+M,SAAU,OACVzL,OAAO,EACPygB,KAAM,YACNysF,WAAW,GAEfpzF,IAAK,CACDtN,KAAM,SACNxC,KAAM,MACNtL,QAAS,oBACT+hB,KAAM,OAEV1G,KAAM,CACFvN,KAAM,SACNxC,KAAM,OACNtL,QAAS,qBACT+hB,KAAM,QAEVpH,MAAO,CACH7M,KAAM,SACNxC,KAAM,QACNtL,QAAS,sBACT+hB,KAAM,aAEV2pF,UAAW,CACP59F,KAAM,YACNxC,KAAM,YACNyB,SAAU,YACV0hG,UAAW,iBACXjxF,QAAS8tF,EAAsB,cAC/BoD,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,YACR/+D,KAAM,cAEV4sF,iBAAkB,CACdx1C,MAAO,CACH,CAAEy1C,WAAY,CAAE,aAAc,OAAQ,gBAAiB,YAAa,eAAgB,yBAA2B7sF,KAAM,aAAc/f,KAAMypG,EAASE,iBAAiBC,aACnK,CAAEgD,WAAY,CAAE,aAAc,SAAU,gBAAiB,YAAa,eAAgB,yBAA2B7sF,KAAM,eAAgB/f,KAAMypG,EAASE,iBAAiBE,eACvK,CAAE+C,WAAY,CAAE,aAAc,QAAS,gBAAiB,YAAa,eAAgB,yBAA2B7sF,KAAM,cAAe/f,KAAMypG,EAASE,iBAAiBG,cACrK,CAAE8C,WAAY,CAAE,aAAc,UAAW,gBAAiB,YAAa,eAAgB,yBAA2B7sF,KAAM,gBAAiB/f,KAAMypG,EAASE,iBAAiBI,aACzK,CAAE6C,WAAY,CAAEjE,MAAO,gBACvB,CAAEiE,WAAY,CAAE,aAAc,MAAO,gBAAiB,gBAAiB,eAAgB,yBAA2B7sF,KAAM,YAAa/f,KAAMypG,EAASE,iBAAiBK,UACrK,CAAE4C,WAAY,CAAE,aAAc,SAAU,gBAAiB,gBAAiB,eAAgB,yBAA2B7sF,KAAM,eAAgB/f,KAAMypG,EAASE,iBAAiBM,aAC3K,CAAE2C,WAAY,CAAE,aAAc,SAAU,gBAAiB,gBAAiB,eAAgB,yBAA2B7sF,KAAM,eAAgB/f,KAAMypG,EAASE,iBAAiBO,cAE/K2C,UAAW,UAGnBjsB,gBAAiB,CACb90E,KAAM,YACNxC,KAAM,kBACNujG,UAAW,SACX7uG,QAAS,wBACT+M,SAAU,aACV0hG,UAAW,cACXE,iBAAkB,CACdxlF,KAAM,UACN2lF,SAAU,UACV9D,QAASV,EACTyE,aAAa,EACb1sF,SAAU2rF,EACVt6F,OAAO,EACPm7F,UAAW,UAEfH,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,cACR/+D,KAAM,YAGd6rF,UAAW,CACP9/F,KAAM,YACNxC,KAAM,YACNujG,UAAW,SACX7uG,QAAS,wBACT+M,SAAU,QACV0hG,UAAW,cACXE,iBAAkB,CACdxlF,KAAM,UACN2lF,SAAU,mBACV9D,QAASV,EACTyE,aAAa,EACb1sF,SAAU2rF,EACVt6F,OAAO,EACPm7F,UAAW,UAEfH,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,cACR/+D,KAAM,qBAGdsqB,WAAY,CACRv+B,KAAM,YACNxC,KAAM,aACNtL,QAAS,wBACT+M,SAAU,aACV0hG,UAAW,eACXC,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,aACR/+D,KAAM,eAEV4sF,iBAAkB,CACdrnF,WAAY,CAAC,QAAS,cAAe,UAAW,kBAAmB,eAAgB,WACnFhmB,MAAO,QACPutG,UAAW,WAGnB9mE,SAAU,CACNj6B,KAAM,YACNxC,KAAM,WACNtL,QAAS,wBACT+M,SAAU,WACV0hG,UAAW,WACXC,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,WACR/+D,KAAM,aAEV4sF,iBAAkB,CACdrnF,WAAY,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,IAC3EhmB,MAAO,GACPutG,UAAW,WAGnBn6F,OAAQ,CACJ5G,KAAM,YACNxC,KAAM,SACNmjG,UAAW,iBACXjxF,QAAS8tF,EAAsB,iBAC/BoD,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,cACR/+D,KAAM,iBAEV4sF,iBAAkB,CACdx1C,MAAO,CACH,CAAEy1C,WAAY,CAAE,aAAcb,EAAe3B,UAAW,eAAgB,wBAAyB,gBAAiB,UAAYpqG,KAAMypG,EAASU,YAAYC,WACzJ,CAAEwC,WAAY,CAAE,aAAcb,EAAe/rG,KAAM,eAAgB,wBAAyB,gBAAiB,UAAYA,KAAMypG,EAASU,YAAYnqG,MACpJ,CAAE4sG,WAAY,CAAE,aAAcb,EAAe/6C,OAAQ,eAAgB,wBAAyB,gBAAiB,UAAYhxD,KAAMypG,EAASU,YAAYn5C,OAAQg8C,OAAQ,YACtK,CAAEJ,WAAY,CAAE,aAAcb,EAAe/xC,QAAS,eAAgB,wBAAyB,gBAAiB,UAAYh6D,KAAMypG,EAASU,YAAYnwC,QAASgzC,OAAQ,UACxK,CAAEJ,WAAY,CAAE,aAAcb,EAAe1B,UAAW,eAAgB,wBAAyB,gBAAiB,UAAYrqG,KAAMypG,EAASU,YAAYE,UAAW2C,OAAQ,cAC5K,CAAEJ,WAAY,CAAE,aAAcb,EAAe5kE,SAAU,eAAgB,wBAAyB,gBAAiB,UAAYnnC,KAAMypG,EAASU,YAAYhjE,SAAU6lE,OAAQ,aAC1K,CAAEJ,WAAY,CAAE,aAAcb,EAAez4D,KAAM,eAAgB,wBAAyB,gBAAiB,UAAYtzC,KAAMypG,EAASU,YAAY72D,KAAM05D,OAAQ,aAClK,CAAEJ,WAAY,CAAE,aAAcb,EAAet3D,KAAM,eAAgB,wBAAyB,gBAAiB,UAAYz0C,KAAMypG,EAASU,YAAY11D,KAAMu4D,OAAQ,cAClK,CAAEJ,WAAY,CAAE,aAAcb,EAAezB,SAAU,eAAgB,wBAAyB,gBAAiB,UAAYtqG,KAAMypG,EAASU,YAAYG,SAAU0C,OAAQ,qBAC1K,CAAEJ,WAAY,CAAE,aAAcb,EAAexB,SAAU,eAAgB,wBAAyB,gBAAiB,UAAYvqG,KAAMypG,EAASU,YAAYI,SAAUyC,OAAQ,aAC1K,CAAEJ,WAAY,CAAE,aAAc,QAAS,aAAc,eAAiB5sG,KAAMypG,EAASU,YAAYK,cAErGyC,aACI,sLAMJJ,UAAW,UAGnBtyF,OAAQ,CACJzO,KAAM,SACNxC,KAAM,SACNyB,SAAU,YACVgV,KAAM,SACN/hB,QAAS,gBACTwuG,WAAW,EACXl8F,QAAQ,GAEZoE,MAAO,CACH5I,KAAM,YACNxC,KAAM,QACNmjG,UAAW,iBACXjxF,QAAS8tF,EAAsB,eAC/BoD,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,QACR/+D,KAAM,eAEV4sF,iBAAkB,CACdx1C,MAAO,CACH,CAAEy1C,WAAY,CAAE,aAAc,QAAS,eAAgB,oBAAsB7sF,KAAM,cAAe/f,KAAMypG,EAASyB,aAAaC,YAC9H,CAAEyB,WAAY,CAAE,aAAc,eAAgB,eAAgB,oBAAsB7sF,KAAM,2BAA4B/f,KAAMypG,EAASyB,aAAaE,mBAClJ,CAAEwB,WAAY,CAAE,aAAc,aAAc,eAAgB,oBAAsB7sF,KAAM,yBAA0B/f,KAAMypG,EAASyB,aAAaG,iBAC9I,CAAEuB,WAAY,CAAE,aAAc,UAAW,eAAgB,oBAAsB7sF,KAAM,gBAAiB/f,KAAMypG,EAASyB,aAAa12F,UAEtIq4F,UAAW,UAGnBlC,OAAQ,CACJ7+F,KAAM,YACNxC,KAAM,SACNmjG,UAAW,iBACXjxF,QAAS8tF,EAAsB,eAC/BoD,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,SACR/+D,KAAM,eAEV4sF,iBAAkB,CACdx1C,MAAO,CACH,CAAEy1C,WAAY,CAAE,aAAc,QAAS,eAAgB,sBAAwB7sF,KAAM,cAAe/f,KAAMypG,EAASmB,cAAcC,aACjI,CAAE+B,WAAY,CAAE,aAAc,OAAQ,eAAgB,sBAAwB7sF,KAAM,aAAc/f,KAAMypG,EAASmB,cAAcE,YAC/H,CAAE8B,WAAY,CAAE,aAAc,UAAW,eAAgB,sBAAwB7sF,KAAM,gBAAiB/f,KAAMypG,EAASmB,cAAcG,eACrI,CAAE6B,WAAY,CAAE,aAAc,WAAY,eAAgB,sBAAwB7sF,KAAM,gBAAiB/f,KAAMypG,EAASmB,cAAcv1F,WAE1Iw3F,UAAW,UAGnBhnE,QAAS,CACL/5B,KAAM,cACNxC,KAAM,UACNyW,KAAM,cACNmtF,eAAgB7vG,EAAMsN,YAAY49F,cAClCsE,UAAW,SACX7uG,QAAS,sBACT0uG,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,YAGhBquB,YAAa,CACTrhG,KAAM,SACNgzE,OAAQ,cACRytB,SAAU,SAEdT,UAAW,CACPhgG,KAAM,SACNxC,KAAM,YACNw1E,OAAQ,YACR/+D,KAAM,QAEVyrF,gBAAiB,CACb1/F,KAAM,SACNxC,KAAM,kBACNtL,QAAS,yBACT+M,SAAU,YACVzL,OAAO,EACPygB,KAAM,eACNysF,WAAW,EACXY,UAAU,GAEdpC,cAAe,CACXl/F,KAAM,SACNxC,KAAM,gBACNw1E,OAAQ,gBACR/zE,SAAU,UACVyhG,WAAW,EACXzsF,KAAM,WAEVkrF,YAAa,CACTn/F,KAAM,SACNxC,KAAM,cACNw1E,OAAQ,cACR/+D,KAAM,SAIVnC,cAAe,CACX9R,KAAM,SACNxC,KAAM,gBACNtL,QAAS,mBACTsB,MAAO,OACPygB,KAAM,4BAEVlC,eAAgB,CACZ/R,KAAM,SACNxC,KAAM,iBACNtL,QAAS,mBACTsB,MAAO,QACPygB,KAAM,6BAEV9B,YAAa,CACTnS,KAAM,SACNxC,KAAM,cACNtL,QAAS,gBACTsB,MAAO,QACPygB,KAAM,0BAEV/B,YAAa,CACTlS,KAAM,SACNxC,KAAM,cACNtL,QAAS,gBACTsB,MAAO,QACPygB,KAAM,0BAEVjC,aAAc,CACVhS,KAAM,SACNxC,KAAM,eACNtL,QAAS,sBACT+hB,KAAM,uBAEV7B,UAAW,CACPpS,KAAM,SACNxC,KAAM,YACNtL,QAAS,mBACT+hB,KAAM,oBAIVzf,KAAM,CACFwL,KAAM,YACNxC,KAAM,OACNmjG,UAAW,iBACXjxF,QAAS8tF,EAAsB,aAC/BoD,kBAAmB,CACf5gG,KAAM,SACNgzE,OAAQ,OACR/+D,KAAM,aAEV4sF,iBAAkB,CACdx1C,MAAO,CACH,CAAEy1C,WAAY,CAAE,aAAc,MAAO,eAAgB,eAAiBxgG,OAAO,EAAOpM,KAAMypG,EAASgC,YAAYC,aAAc3rF,KAAM,YACnI,CAAE6sF,WAAY,CAAE,aAAc,OAAQ,eAAgB,eAAiBxgG,OAAO,EAAOpM,KAAMypG,EAASgC,YAAYE,cAAe5rF,KAAM,cAEzI8sF,UAAW,UAGnBzuF,WAAY,CACRtS,KAAM,SACNxC,KAAM,aACNw1E,OAAQ,aACR/+D,KAAM,uBAIVstF,EAAqB7D,EAAQhsG,OAAO,CACpCC,KAAM,SAAS+d,EAAS9d,GACpBmH,OAAO2b,KAAK4rF,GAAclgG,SAASwiC,IACrB,eAANA,IACA09D,EAAa19D,GAAG4+D,SAAW,WAC/B,IAGJ5vG,EAAQ6vG,MAAQ7vG,EAAQ6vG,OAASF,EAAmBj9F,UAAU1S,QAAQ6vG,MAAM7vG,EAAQ8vG,aACpF9vG,EAAQ+vG,eAAiBhE,EACzB/rG,EAAQgwG,aAAetB,EAEvB5C,EAAQ7rG,GAAGF,KAAKG,KAAKR,KAAMoe,EAAS9d,GACpC,IAAIiwG,EAAcvwG,KAAKwwG,OAAOthG,KAAKlP,MAEnCA,KAAKoe,QAAQoE,SAAS,sCAEtBxiB,KAAKkP,KAAK,CACNuhG,MAAOF,EACPjkF,OAAQikF,EACRvoF,OAAQuoF,GAEhB,EACAC,OAAQ,SAASnoF,GACb,IAAIrW,EAASqW,EAAErW,OACXrE,EAAWqE,EAAOxH,KAAK,YACvBtI,EAAQmmB,EAAEnmB,OAAS8P,EAAOxH,KAAK,UAAY6d,EAAErW,OAAOyY,MACpDimF,EAAc1+F,EAAOxH,KAAK,WAC1Bk3E,EAAS1vE,EAAOxH,KAAK,UACrBlK,EAAU0R,EAAOxH,KAAK,YAAc,CAAC,EAUzC,GARc,UAAVtI,IAEAw/E,EAAS1vE,EAAOxH,KAAK,UAGzBlK,EAAQqN,SAAWA,GAAY,KAC/BrN,EAAQ4B,MAAQA,GAAS,KAErBw/E,EACA1hF,KAAK0hF,OAAO,CACRx1E,KAAMw1E,EACNphF,QAASA,SAKjB,GAAKowG,EAAL,CAIA,IAAI7gE,EAAO,CACPjvC,QAAS8vG,EACTpwG,QAASA,GAGqB,kBAAvBuvC,EAAKvvC,QAAQ4B,QACpB2tC,EAAKvvC,QAAQ4B,QAAQmmB,EAAE4jF,SAAiB,MAG5CjsG,KAAK8gC,OAAO+O,EAXZ,CAYJ,EACAnvC,OAAQ,CACJ,SACA,UAEJJ,QAAS,CACL4L,KAAM,qBACNykG,WAAW,EACXR,MAjhBW,CACfppF,KAAM,CACF,OACA,WACA,YACA,CAAE,MAAO,OAAQ,SACjB,YACA,aACA,WACA,CAAE,OAAQ,SAAU,aACpB,YACA,YACA,YACA,kBACA,UACA,YACA,YACA,WACA,YACA,CAAE,wBAAyB,yBAC3B,YACA,SACA,SACA,YACA,YACA,cACA,gBACA,YACA,SACA,QACA,mBAEJ+K,OAAQ,CACJ,CAAE,gBAAiB,iBAAkB,cAAe,eACpD,YACA,CAAE,eAAgB,cAEtBtnB,KAAM,CACF,OACA,YACA,SACA,YACA,gBAyeJs2B,OAAQ,SAAS+O,GACb7vC,KAAKkB,QAAQ,SAAU2uC,EAC3B,EACA6xC,OAAQ,SAAS7xC,GACb7vC,KAAKkB,QAAQ,SAAU2uC,EAC3B,EACAm6B,QAAS,SAAS7yD,GAId,IAHA,IAAItJ,EAAQsJ,EACRg5F,EAAQnwG,KAAK4wG,SAERrtG,EAAI,EAAGA,EAAI4sG,EAAM9uG,OAAQkC,IAAK,CACnC,IAAIoK,EAAWwiG,EAAM5sG,GAAGoK,SACpBkjG,EAAOV,EAAM5sG,GAAGstG,KAChB3uG,EAAQjC,EAAM6wG,WAAWjjG,EAAMF,IAAaE,EAAMF,KAAcE,EAEpD,aAAZF,IAEAzL,EAAQ2L,EAAMmB,QAAQ8D,iBAG1B9S,KAAK+wG,YAAYF,EAAM3uG,EAAOyL,EAAUE,EAC5C,CAEA7N,KAAK2a,QAAO,EAChB,EACAi2F,OAAQ,WACJ,OAAO5wG,KAAKoe,QAAQwkB,KAAK,mBAAmBouE,UAAU7uG,IAAI,SAASic,GAE/D,MAAO,CACHzQ,UAFJyQ,EAAU5c,EAAE4c,IAEUqF,KAAK,iBACvBotF,KAAM7wG,KAAKixG,SAAS7yF,GAE5B,EAAElP,KAAKlP,MACX,EACA+wG,YAAa,SAASF,EAAM3uG,EAAOyL,EAAUE,GACzC,IAKIg5D,EAAUjkE,EAAMyyE,EAAM18D,EAAWu4F,EAASC,EAL1C9B,EAAYwB,EAAKxB,UACjB+B,EAAYP,EAAKO,UACjBC,EAASpxG,EAAMw0E,eAAe28B,EAAUxuE,KAAK,gBAC7C0uE,EAAWT,EAAKS,SAChBhlF,GAAS,EAGI,cAAb3e,GACAgL,EAAY9K,EAAMmB,QAAQ2J,cAETA,EAAU9J,MAAQ8J,EAAU9J,KAAKzK,SAC9C8sG,EAAUhvG,GAASyW,EAAU9J,KAAKzK,SAAW,EAE7CpE,KAAKkT,OAAOk+F,EAAWF,IAEP,cAAbvjG,GACPk5D,EAAW3kE,EAAM4mC,gBACjBlmC,EAAOV,EAAM2mC,aACbwsC,EAAOg6B,EAAUh6B,KAAKj3D,SAEjBwkB,KAAK,mBAAmB2uE,YAAY,cACzCl8B,EAAKzyC,KAAK,+CAAiDhgC,EAAO,aAAa4f,SAAS,cACxF6yD,EAAKzyC,KAAK,mDAAqDikC,EAAW,aAAarkD,SAAS,eAC5E,eAAb7U,GAA0C,UAAbA,EACpC0jG,EAAOnvG,MAAMA,GACO,eAAbyL,GAA0C,aAAbA,IACpCwjG,EAAQG,EAAS1uE,KAAK,qBAAqBhgC,OAAOqD,MAAM,KAAK,GAAGm+C,OAChEktD,EAAS1uE,KAAK,qBAAqBhgC,KAAKuuG,EAAQ,KAAOjvG,EAAQ,SAC/DmvG,EAAOnvG,MAAMA,IAGbmtG,GAAaA,EAAU/iF,SACF,kBAAVpqB,EACPoqB,IAAWpqB,EACa,iBAAVA,IAEVoqB,EADA8kF,EAAU5mG,KAAK,SACN4mG,EAAU5mG,KAAK,WAAatI,EAInB,MAATA,GAIjBlC,KAAKssB,OAAO8kF,EAAW9kF,GAE/B,IAGJrsB,EAAMsN,YAAY6+F,QAAU6D,EAE5BhwG,EAAMsN,YAAYoxE,SAAW1+E,EAAMqiB,GAAGq8D,SAASv+E,OAAO,CAClDC,KAAM,SAAS+d,EAAS9d,GACpBL,EAAMqiB,GAAGq8D,SAASp+E,GAAGF,KAAKG,KAAKR,KAAMoe,EAAS9d,GAC9C8d,EAAQoE,SAAS,0BACjBxiB,KAAKwxG,sBAELxxG,KAAKyxG,SAAW,CAAC,EAEjB,IAAIp1B,EAAO/7E,EAAQ4nB,WAEnBloB,KAAK0xG,gBAAgBlkE,KAAK,SAAS0d,EAAK9sC,GACpCpe,KAAK2xG,SAASnwG,EAAE4c,GAAUi+D,EAAKnxB,GAAKvjD,GAAIrH,EAAQw+E,eAAezC,EAAKnxB,GAAKvjD,IAC7E,EAAEuH,KAAKlP,OAEPA,KAAKkP,KAAK,YAAY,SAASmZ,GACb7mB,EAAE6mB,EAAEupF,gBAAgBhvE,KAAK,cAAcp4B,KAAK,2BAElDqnG,YACR7xG,KAAK0iB,QAAQkC,WAAW,YACxB5kB,KAAK0iB,QAAQkgB,KAAK,uBAAuBhe,WAAW,WACxD,GACJ,EAEAlkB,OAAQT,EAAMqiB,GAAGq8D,SAASp+E,GAAGG,OAAO+S,OAAO,CAAE,SAAU,WAEvDyP,QAAS,WAGL,IAAK,IAAIhX,KAFTlM,KAAK8xG,mBAAmB9jF,IAAI,SAC5B/tB,EAAMqiB,GAAGq8D,SAASp+E,GAAG2iB,QAAQ1iB,KAAKR,MACjBA,KAAKyxG,SAClBzxG,KAAKyxG,SAASvlG,GAAMgX,SAE5B,EAEA4d,OAAQ,SAAS+O,GACb7vC,KAAKkB,QAAQ,SAAU2uC,EAC3B,EAEA6xC,OAAQ,SAAS7xC,GACb7vC,KAAKkB,QAAQ,SAAU2uC,EAC3B,EAEA4wC,aAAc,SAAS5yE,EAAOY,GAC1B,IAAIgjG,EAAWzxG,KAAKyxG,SAEpB,IAAKhjG,EAAO00C,cAAgB10C,EAAOq0C,QAC/B,IAAK,IAAI52C,KAAQulG,EACTA,EAASM,eAAe7lG,IACxBulG,EAASvlG,GAAM89D,QAAQn8D,EAIvC,EAEA2jG,oBAAqB,WACjB,IAAI7F,EAAU,CACV,CAAEp9F,MAAO89F,EAAS6B,YAAYltG,KAAM2hB,KAAM,OAAQme,OAAQ,QAC1D,CAAEvyB,MAAO89F,EAAS6B,YAAY/sG,KAAMwhB,KAAM,OAAQme,OAAQ,SAE1DkxE,EAAiB/xG,EAAMmoB,SAAS,wNAEpCpoB,KAAK8xG,mBAAqBtwG,EAAE,UAAW,CACnC+pG,MAAS,qCACTp9E,KAAQluB,EAAM+nD,OAAOgqD,EAAgBrG,KACtCsG,aAAajyG,KAAK0iB,SAErB1iB,KAAK8xG,mBAAmBluF,GAAG,QAAS,YAAa,SAASyE,GACtDA,EAAEjP,iBAEF,IAAI0nB,EAASt/B,EAAE6mB,EAAE6pF,eAAezuF,KAAK,eACrCzjB,KAAK8gC,OAAO,CAAEA,OAAQA,GAC1B,EAAE5xB,KAAKlP,OAEPA,KAAKs+E,mBACT,EAEAA,kBAAmB,WACft+E,KAAKmyG,SAASzuF,IAAI,eAAgBzjB,EAAMsnD,YAAYvnD,KAAK8xG,oBAC7D,EAEAH,SAAU,SAAShlD,EAAWzgD,EAAMikG,GAChC,IAAI/xF,EACA9d,EAEAN,KAAKyxG,SAASvlG,KACdlM,KAAKyxG,SAASvlG,GAAMgX,UACpBypC,EAAUH,SAAS,cAAcx6B,UAGjCm+E,KACA/xF,EAAUuuC,EAAUx+B,KAAK,eAAeq+B,SAAS,QAEzC/oC,KAAK,aAAcvX,GAE3B5L,EAAU,CACN6vG,MAAwB,kBAAVA,OAAsBrjG,EAAYqjG,EAChDC,YAAalkG,EACb40B,OAAQ9gC,KAAK8gC,OAAO5xB,KAAKlP,MACzB0hF,OAAQ1hF,KAAK0hF,OAAOxyE,KAAKlP,OAG7BA,KAAKyxG,SAASvlG,GAAQ,IAAIjM,EAAMsN,YAAY6+F,QAAQhuF,EAAS9d,GAErE,GAIP,CA5yBD,CA4yBGmB,OAAOxB,OAEV,SAAUA,GAMN,IAAIuB,EAAIvB,EAAMwF,OACV2sG,EAAmBnyG,EAAMuK,KAAK4nG,iBAE9B/F,EAAWpsG,EAAMsN,YAAY0V,SAAS0+D,QAAU,CAChD95E,MAAO,QACP8D,KAAM,OACNojG,OAAQ,SACR/8E,OAAQ,SACRqgF,MAAO,QACPC,OAAQ,SACRC,OAAQ,KACRC,kBAAmB,CACfjkG,MAAO,SACPkkG,WAAY,CACR7+C,OAAQ,SACR7pB,SAAU,WACVmM,KAAM,SAGdw8D,iBAAkB,CACdnkG,MAAO,QAEXokG,eAAgB,CACZpkG,MAAO,aAEXqkG,cAAe,CACXrkG,MAAO,WAEXskG,gBAAiB,CACbtkG,MAAO,YACPo9F,QAAS,CACLa,YAAa,aACbC,cAAe,SACfC,aAAc,cACdC,YAAa,UACbC,SAAU,YACVC,YAAa,eACbC,YAAa,iBAGrBgG,YAAa,CACTvkG,MAAO,cACPo9F,QAAS,CACLoC,WAAY,YACZC,kBAAmB,qBACnBC,gBAAiB,mBACjB72F,QAAS,YAGjB27F,aAAc,CACVxkG,MAAO,eACPo9F,QAAS,CACL8B,YAAa,eACbC,WAAY,cACZC,cAAe,iBACf11F,SAAU,mBAGlB+6F,mBAAoB,CAChBpwG,KAAM,8CACN2L,MAAO,gBAEX0kG,iBAAkB,CACd1kG,MAAO,kBACP2kG,YAAa,sCACbC,UAAW,iBACX50C,SAAU,CACN60C,IAAK,YACLx/C,OAAQ,SACRhxD,KAAM,OACNszC,KAAM,OACNwF,OAAQ,iBACRn0B,KAAM,QAEV8rF,UAAW,CACPx3D,YAAa,eACbC,SAAU,YACVC,QAAS,UACTK,WAAY,cACZJ,QAAS,WACTC,WAAY,eACZC,qBAAsB,2BACtBC,kBAAmB,yBAEvBm3D,iBAAkB,CACdz3D,YAAa,mBACbC,SAAU,gBACVC,QAAS,sBACTK,WAAY,0BACZJ,QAAS,eACTC,WAAY,mBACZC,qBAAsB,+BACtBC,kBAAmB,4BACnBT,OAAQ,mCAEZ63D,OAAQ,CACJh1C,SAAU,WACVhrC,SAAU,WACV7iB,IAAK,MACLkK,IAAK,MACL1Y,MAAO,QACP6vB,MAAO,QACPvM,IAAK,MACLguF,cAAe,kBACfC,YAAa,eACbC,YAAa,eACbC,SAAU,YACVR,UAAW,aACXD,YAAa,eACbU,YAAa,eACbC,eAAgB,8BAChBC,mBAAoB,mCAExBC,aAAc,CACVC,UAAW,aACXC,YAAa,iBAGrBC,eAAgB,CACZ3lG,MAAO,YACP4lG,gBAAiB,WACjBC,KAAM,CACFC,YAAa,0BAEjBxyF,IAAK,CACDwyF,YAAa,kCACbhnC,KAAM,CACF5/D,SAAU,kBACVuB,MAAO,eACP2J,UAAW,aAEf27F,MAAO,CACHC,GAAY,uBACZC,GAAY,uBACZC,GAAY,uBACZC,GAAY,uBACZC,GAAY,uBACZC,GAAY,uBACZC,GAAY,uBACZC,MAAY,qBACZC,MAAY,qBACZv9E,OAAY,sBACZw9E,QAAY,sBACZC,UAAY,6BAEhBC,OAAQ,CACJC,OAAQ,SACRC,OAAQ,SACRC,KAAM,SAGd9B,OAAQ,CACJ1vF,MAAO,QACPyxF,IAAK,cACL7zF,SAAU,YACV8zF,WAAY,eACZC,WAAY,SACZC,UAAW,aACXC,QAAS,UACTC,YAAa,cACbloF,MAAO,QACPmoF,WAAY,aACZC,OAAQ,SACRt+F,aAAc,eACdC,WAAY,eAGpBs+F,mBAAoB,CAChBC,aAAc,wCAElBC,oBAAqB,CACjBD,aAAc,8CAElBE,sBAAuB,CACnBF,aAAc,qCAElBG,yBAA0B,CACtBH,aAAc,uBAElBI,sBAAuB,CACnBJ,aAAc,mCAElBK,yBAA0B,CACtBL,aAAc,wBAElBM,eAAgB,CACZN,aAAc,2FAElBO,kBAAmB,CACf/nG,MAAO,sBACPwnG,aAAc,+FACdxC,OAAQ,CACJgD,QAAS,WACTC,OAAQ,UACRC,SAAU,cAGlBC,2BAA4B,CACxBX,aAAc,0DAElBY,WAAY,CACRpoG,MAAO,YACPglG,OAAQ,CACJ3wG,KAAM,OACNqoE,IAAK,UACL2rC,WAAY,gBAGpBC,oBAAqB,CACjBtoG,MAAO,iBACPglG,OAAQ,CACJzwD,QAAS,UACTg0D,cAAe,mBAGvBC,kBAAmB,CACfxoG,MAAO,eACPyoG,KAAM,yCACNC,UAAW,2CAIfC,EAAW,CAAC,EAChBj3G,EAAMsN,YAAYo0E,QAAU,CACxBw1B,SAAU,SAASjrG,EAAMkrG,GACrBF,EAAShrG,GAAQkrG,CACrB,EACA/0B,WAAY,SAASn2E,GACjB,QAASgrG,EAAShrG,EACtB,EACAxE,OAAQ,SAASwE,EAAM5L,GACnB,IAAI82G,EAAcF,EAAShrG,GAE3B,GAAIkrG,EACA,OAAO,IAAIA,EAAY92G,EAE/B,GAGJ,IAAI+2G,EAAoBp3G,EAAMsN,YAAY8pG,kBAAoBp3G,EAAME,WAAWC,OAAO,CAClFC,KAAM,SAASC,GACXL,EAAME,WAAWI,GAAGF,KAAKG,KAAKR,KAAMM,GAEpCN,KAAKM,QAAUg3G,EAAU91G,EAAEpB,QAAO,EAAM,CAAC,EAAGJ,KAAKM,QAASA,IAE1DN,KAAKkP,KAAKlP,KAAKU,OAAQJ,EAC3B,EACAI,OAAQ,CACJ,QACA,YAEJJ,QAAS,CACLi3G,WAAW,GAEf71B,OAAQ,WACJ,IAAK1hF,KAAKw3G,QAAS,CACf,IAAIl3G,EAAU,CACVi3G,WAAW,EACXxuD,YAAY,EACZ4nD,WAAW,EACXj8B,OAAO,EACP1qD,SAAS,EACT7lB,MAAOnE,KAAKM,QAAQ6D,OAAS,IAC7BoK,MAAOvO,KAAKM,QAAQiO,MACpB6a,KAAM,WACFppB,KAAK61G,QACT,EACA7sF,MAAOhpB,KAAKy3G,eAAevoG,KAAKlP,MAChCkX,SAAUlX,KAAK03G,kBAAkBxoG,KAAKlP,MACtC2yE,WAAY3yE,KAAK23G,oBAAoBzoG,KAAKlP,OAE9CA,KAAKw3G,QAAUh2G,EAAE,0EACZghB,SAASxiB,KAAKM,QAAQwlC,WAAa,IACnCw3C,OAAOr9E,EAAMmoB,SAASpoB,KAAKM,QAAQ8nB,SAA5BnoB,CAAsC,CAC1CgjB,SAAUhjB,EAAMsN,YAAY0V,SAAS0+D,SAAW0qB,EAChDlpF,GAAIljB,EAAMkjB,GAKV9B,OAAQrhB,KAAKM,QAAQ+gB,UAExBu2F,YAAYt3G,GACZkK,KAAK,cACd,CAEA,OAAOxK,KAAKw3G,OAChB,EACAC,eAAgB,WACZz3G,KAAKkB,QAAQ,QAAS,CAClB4/B,OAAQ9gC,KAAK63G,SAErB,EACAH,kBAAmB,WACf13G,KAAKkB,QAAQ,WACjB,EACAy2G,oBAAqB,WACjB33G,KAAKkB,QAAQ,cACblB,KAAKkjB,SACT,EACAA,QAAS,WACDljB,KAAKw3G,UACLx3G,KAAKw3G,QAAQt0F,UACbljB,KAAKw3G,QAAU,KAEvB,EACApuF,KAAM,WACFppB,KAAK0hF,SAASt4D,OACdppB,KAAK0hF,SAAStjE,QAAQwkB,KAAK,2BAA2B1hC,QAAQ,QAClE,EACA2G,MAAO,WACH7H,KAAKgpB,OACT,EACAA,MAAO,WACHhpB,KAAK63G,QAAU,QAEf73G,KAAK0hF,SAAS14D,OAClB,IAGJ,SAAS8uF,EAAe51G,EAAOoT,GAC3B,OAAOrV,EAAMsN,YAAY2H,WAAWtS,KAAKV,EAAOoT,EACpD,CAEA,IAAIyiG,EAAuB93G,EAAMsN,YAAYwqG,qBAAuB3F,EAAiBhyG,OAAO,CACxFC,KAAM,SAASC,GACX8xG,EAAiB7xG,GAAGF,KAAKG,KAAKR,KAAMM,GAEpCN,KAAKg4G,YAAYh4G,KAAKi4G,SAC1B,EACAD,YAAa,SAASC,GAClB,IAAIvpG,EAAOupG,GAAYA,EAASvpG,MAAQ,SACpCwpG,EAAyB,YAARxpG,EAErB1O,KAAKi4G,SAAWA,EAEhBj4G,KAAKs0B,IAAI,qBAAsB4jF,GAAkBl4G,KAAKm4G,WAAW92G,OAAS,GAErE62G,EAGDl4G,KAAK+pC,SAAS/pC,KAAKm4G,WAAW,IAF9Bn4G,KAAKs0B,IAAI,UAAWt0B,KAAKo4G,WAAW1pG,EAAO,YAK/C1O,KAAKq4G,gBACT,EACAA,eAAgB,WACRr4G,KAAK40B,QAAQvzB,QACbrB,KAAKs0B,IAAI,SAAUt0B,KAAK40B,QAAQ,GAAG1yB,MAE3C,EACA6nC,SAAU,SAASA,GACf,QAAiBj9B,IAAbi9B,EAAwB,CACxB/pC,KAAKs4G,UAAYvuE,EAEjB,IAAIitE,EAAOjtE,EAAS7nC,MAChB0yB,EAAU,CACV,CAAEmV,SAAUitE,EAAMnlB,UAAU,GAC5B,CAAE9nD,SAAUitE,EAAMnlB,UAAU,EAAM0mB,KAAK,GACvC,CAAExuE,SAAUitE,EAAMnlB,UAAU,IAGhCj9D,EAAUA,EAAQzyB,KAAI,SAASmT,GAG3B,MAAO,CAAEpT,MAFToT,EAASyiG,EAAqBS,QAAQzuE,SAASz0B,GAEvBpJ,KAAM4rG,EAAe,IAAMxiG,GACvD,IAEAtV,KAAKs0B,IAAI,UAAWM,GAEpB50B,KAAKq4G,gBACT,CAEA,OAAOr4G,KAAKs4G,WAAat4G,KAAKm4G,WAAW,EAC7C,EACAM,eAAgB,SAASR,GAKrB,YAJiBnrG,IAAbmrG,GACAj4G,KAAKg4G,YAAYC,GAGdj4G,KAAKi4G,QAChB,EACAz0E,QAAS,WACL,IAAIluB,EAAStV,KAAKyC,IAAI,UAClBP,EAAQlC,KAAKkC,OAAS,EAE1B,OAAIoT,GAAUA,EAAOjU,OACVy2G,EAAe51G,EAAOoT,GAEtBpT,CAEf,IAoCJ,SAASw2G,EAASlsF,EAAOuuB,GAIrB,IAHA,IAAIh1C,EAAS,GACToB,EAAS,GAEJ5D,EAAI,EAAGA,EAAIw3C,EAAM15C,OAAQkC,KACa,GAAvC/B,EAAEm3G,QAAQ59D,EAAMx3C,GAAGipB,GAAQrlB,KAC3BpB,EAAOpF,KAAKo6C,EAAMx3C,IAClB4D,EAAOxG,KAAKo6C,EAAMx3C,GAAGipB,KAI7B,OAAOzmB,CACX,CA7CAgyG,EAAqBS,QAAU,CAC3BzuE,SAAU,SAASzpC,GAMf,IALgBooB,EAAOzhB,EAKnB+vG,EAAO12G,EAAQypC,SACfz0B,EAAS0hG,EAAK4B,QAAQ,GAc1B,OAZIt4G,EAAQuxF,WACRv8E,EAASA,EAAOxS,QAAQ,KAAM,IAAMk0G,EAAK,MAT7BtuF,EAS2C,IATpCzhB,EASyC+vG,EAAKnlB,SAR1D,IAAI/2D,MAAM7zB,EAAE,GAAG9D,KAAKulB,MAiB/BpT,GALIA,EADAhV,EAAQi4G,IACC,IAAMvB,EAAK6B,KAAO,KAAOvjG,EAAOxS,QAAQ,YAAa,IAErDwS,EAAOxS,QAAQ,MAAO2xB,KAAKC,UAAUsiF,EAAKljD,UAGvChxD,QAAQ,KAAM,IAGlC,EACAozC,KAAM,SAAS5gC,GACX,MAAI,MAAQrN,KAAKqN,GACN,GAGJA,EAAOhP,cAAcxD,QAAQ,MAAO,SAASA,QAAQ,KAAM,IACtE,GAiBJ,IAAIg2G,EAAoBzB,EAAkBj3G,OAAO,CAC7CC,KAAM,SAASC,GACX,IAAI2iB,EAAWhjB,EAAMsN,YAAY0V,SAAS0+D,QAAQ6wB,mBAAqBnG,EACnE0M,EAAiB,CACjBxqG,MAAO0U,EAAS1U,MAChBkkG,WAAY,CACR,CAAE/jG,KAAM,SAAUxC,KAAM+W,EAASwvF,WAAW7+C,QAC5C,CAAEllD,KAAM,WAAYxC,KAAM+W,EAASwvF,WAAW1oE,UAC9C,CAAEr7B,KAAM,OAAQxC,KAAM+W,EAASwvF,WAAWv8D,QAIlDmhE,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMwB,EAAEpB,OAAO24G,EAAgBz4G,IAE9DN,KAAKg5G,kBACT,EACA14G,QAAS,CACLwlC,UAAW,6BACX1d,SACI,8uCAkCR4wF,iBAAkB,WACd,IAAI14G,EAAUN,KAAKM,QAenB,GAbKA,EAAQ63G,aACT73G,EAAQ63G,WAAaW,EAAkBG,eAAeh5G,EAAM+tF,WAG3D1tF,EAAQ44G,gBACT54G,EAAQ44G,cAAgB,CACpB,CAAEh3G,MAAO,QAASgK,KAAM,WACxB,CAAEhK,MAAO,KAAMgK,KAAM,QACrB,CAAEhK,MAAO,OAAQgK,KAAM,WACvB,CAAEhK,MAAO,WAAYgK,KAAM,eAI9B5L,EAAQ64G,YAAa,CACtB,IAAIC,EAAmBn5G,EAAM+tF,SAASzoF,QAAQurF,UAAUC,SAAS/7D,SAEjE10B,EAAQ64G,YAAcT,EAAS,QAASl3G,EAAEW,IAAIi3G,GAAkB,SAAS9jG,GAGrE,GAFAA,EAASyiG,EAAqBS,QAAQtiE,KAAK5gC,GAM3C,MAAO,CAAEpT,MAAOoT,EAAQpJ,KAAM4rG,EAAe,WAAYxiG,GAC7D,IACJ,CACJ,EACA8T,KAAM,SAASvb,GACX,IAGIuQ,EAHA9d,EAAUN,KAAKM,QACf4B,EAAQ2L,EAAM3L,QACduwG,EAAanyG,EAAQmyG,WAAW3xG,MAAM,GAG1Cd,KAAKq5G,UAAY,IAAItB,EAAqB,CACtCI,WAAY73G,EAAQ63G,WAAWr3G,MAAM,GACrCs3G,WAAY,CACRc,cAAe54G,EAAQ44G,cAAcp4G,MAAM,GAC3Cq4G,YAAa74G,EAAQ64G,YAAYr4G,MAAM,IAE3C2xG,WAAYA,EACZn9F,OAAQzH,EAAMyH,SACd2iG,SAAU/1G,aAAiByD,KAAO8sG,EAAW,GAAKA,EAAW,GAC7D5qG,MAAO7H,KAAK6H,MAAMqH,KAAKlP,MACvBgpB,MAAOhpB,KAAKgpB,MAAM9Z,KAAKlP,MACvBkC,MAAOA,IAGXm1G,EAAkB92G,GAAG6oB,KAAK5oB,KAAKR,MAE/Boe,EAAUpe,KAAK0hF,SAAStjE,QAExBne,EAAMiP,KAAKkP,EAASpe,KAAKq5G,WAEzB,IAAIC,EAAiBl7F,EAAQwkB,KAAK,0BAA0Bp4B,KAAK,qBAE7DlK,EAAQ63G,WAAW92G,OAAS,IAC5Bi4G,EAAerwB,WAAW,CAAE9rE,OAAQ,aAGxCiB,EAAQwkB,KAAK3iC,EAAMs5G,aAAa,eAAelrE,SAAS7rB,SAAS,kBAEjEpE,EAAQwkB,KAAK,oBAAoBnf,KAAK,gBAAiB,eAC3D,EACA5b,MAAO,WACH,IAAIyN,EAAStV,KAAKq5G,UAAU/jG,OAE5B+hG,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhCA,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,wBACTN,QAAS,CACLqN,SAAU,SACVzL,MAAOoT,IAGnB,IAGJwjG,EAAkBG,eAAiB,SAAUjrB,GACzC,OAAO0qB,EAAS,cAAel3G,EAAEW,IAAI6rF,GAAU,SAASl5D,EAAS5oB,GAC7D,GAAK,IAAMjE,KAAKiE,GAAhB,CAIA,IAAI69B,EAAWjV,EAAQwV,aAAaP,SAQpC,MAAO,CAAEsqE,YAPSp0G,EAAMqV,OACpB,iBACAy0B,EAAS79B,KACT69B,EAAS8uE,KACT9uE,EAAS+pB,QAGsB5xD,MAAO6nC,EAV1C,CAWJ,IACJ,EAEA9pC,EAAMsN,YAAYo0E,QAAQw1B,SAAS,cAAe2B,GAElD74G,EAAMsN,YAAYo0E,QAAQm3B,kBAAoBA,EAE9C,IAAIU,EAAgBnC,EAAkBj3G,OAAO,CACzCE,QAAS,CACLwlC,UAAW,wBACXv3B,MAAO,GACPkrG,UAAW,GACX72G,KAAM,GACNwlB,SACI,oSAORgB,KAAM,WACFiuF,EAAkB92G,GAAG6oB,KAAK5oB,KAAKR,MAE/B,IAAIM,EAAUN,KAAKM,QACfsC,EAAOtC,EAAQsC,KAEftC,EAAQm5G,YACR72G,EAAO3C,EAAMy5G,OAAOp5G,EAAQm5G,WAAW,EAAhCx5G,CAAsCA,EAAMsN,YAAY0V,SAAS0+D,UAG5E1hF,EAAMiP,KAAKlP,KAAK0hF,SAAStjE,QAAS,CAC9Bxb,KAAMA,EACNomB,MAAOhpB,KAAKgpB,MAAM9Z,KAAKlP,OAE/B,IAGJC,EAAMsN,YAAYo0E,QAAQw1B,SAAS,UAAWqC,GAE9C,IAAIG,EAAqBtC,EAAkBj3G,OAAO,CAC9CC,KAAM,SAASC,GACX,IAAI2iB,EAAWhjB,EAAMsN,YAAY0V,SAAS0+D,QAAQqxB,oBAAsB3G,EACpE0M,EAAiB,CACjBxqG,MAAO0U,EAAS1U,MAChB3L,KAAMqgB,EAASrgB,MAGnBy0G,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMwB,EAAEpB,OAAO24G,EAAgBz4G,GAClE,EACAA,QAAS,CACLwlC,UAAW,wBACX2zE,UAAW,GACXrxF,SACI,0dAURgB,KAAM,WACFiuF,EAAkB92G,GAAG6oB,KAAK5oB,KAAKR,MAE/B,IAAIM,EAAUN,KAAKM,QACfsC,EAAOtC,EAAQsC,KAEftC,EAAQm5G,YACR72G,EAAO3C,EAAMy5G,OAAOp5G,EAAQm5G,WAAW,EAAhCx5G,CAAsCA,EAAMsN,YAAY0V,SAAS0+D,UAG5E1hF,EAAMiP,KAAKlP,KAAK0hF,SAAStjE,QAAS,CAC9Bxb,KAAMA,EACNg3G,QAAS55G,KAAK45G,QAAQ1qG,KAAKlP,MAC3B+uG,OAAQ/uG,KAAKgpB,MAAM9Z,KAAKlP,OAEhC,EACAutD,YAAa,WACT,OAAOvtD,KAAK65G,UAChB,EACAD,QAAS,WACL55G,KAAK65G,YAAa,EAClB75G,KAAKgpB,OACT,IAGJ/oB,EAAMsN,YAAYo0E,QAAQw1B,SAAS,eAAgBwC,GAEnD,IAAIG,EAAwBzC,EAAkBj3G,OAAO,CACjDE,QAAS,CACLwlC,UAAW,wBACXv3B,MAAO,GACPkrG,UAAW,GACX72G,KAAM,GACNwlB,SACA,udAUJgB,KAAM,WACFiuF,EAAkB92G,GAAG6oB,KAAK5oB,KAAKR,MAE/B,IAAIM,EAAUN,KAAKM,QACfsC,EAAOtC,EAAQsC,KAEftC,EAAQm5G,YACR72G,EAAO3C,EAAMy5G,OAAOp5G,EAAQm5G,WAAW,EAAhCx5G,CAAsCA,EAAMsN,YAAY0V,SAAS0+D,UAG5E1hF,EAAMiP,KAAKlP,KAAK0hF,SAAStjE,QAAS,CAC9Bxb,KAAMA,EACNyvG,MAAOryG,KAAKqyG,MAAMnjG,KAAKlP,MACvB+uG,OAAQ/uG,KAAKgpB,MAAM9Z,KAAKlP,OAEhC,EACAqyG,MAAO,WACHryG,KAAKoiF,QAAS,EACdpiF,KAAKgpB,OACT,IAGJ/oB,EAAMsN,YAAYo0E,QAAQw1B,SAAS,kBAAmB2C,GAEtD,IAAIC,EAAmB1C,EAAkBj3G,OAAO,CAC5CC,KAAM,SAASC,GACX,IAAI2iB,EAAWhjB,EAAMsN,YAAY0V,SAAS0+D,QAAQ+wB,kBAAoBrG,EAEtEgL,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMwB,EAAEpB,OAAO,CAAEmO,MAAO0U,EAAS1U,OAASjO,IAEzEN,KAAKg6G,OACT,EACA15G,QAAS,CACL8nB,SAAU,oCAEd4xF,MAAO,WACH,IAAI3vD,EAAKrqD,KAAK0hF,SAAStjE,QAAQwkB,KAAK,MAChCo8B,EAAQh/D,KAAKM,QAAQA,QACrB25G,EAAcj6G,KAAKM,QAAQ45G,QAE/Bl6G,KAAKunB,KAAO,IAAItnB,EAAMqiB,GAAGkF,WAAW6iC,EAAI,CACpCniC,WAAY,IAAIjoB,EAAMuK,KAAK4c,WAAW,CAAE5c,KAAMw0D,IAC9C52C,SAAU,YACVlmB,MAAO+3G,EACPjyF,OAAQhoB,KAAK6H,MAAMqH,KAAKlP,QAG5BA,KAAKunB,KAAKW,WAAWiyF,OACzB,EACAtyG,MAAO,SAASwgB,GACZgvF,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhCA,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,wBACTN,QAAS,CACLqN,SAAU,aACVzL,MAAOmmB,EAAEilC,OAAOprD,QAAQ,KAGpC,IAGJjC,EAAMsN,YAAYo0E,QAAQw1B,SAAS,aAAc4C,GAEjD,IAAIK,EAAiB/C,EAAkBj3G,OAAO,CAC1CC,KAAM,SAASC,GACX,IAAI2iB,EAAWhjB,EAAMsN,YAAY0V,SAAS0+D,QAAQgxB,gBAAkBtG,EAEpEgL,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMwB,EAAEpB,OAAO,CAAEmO,MAAO0U,EAAS1U,OAASjO,IAEzEN,KAAKg6G,OACT,EACA15G,QAAS,CACL8nB,SAAU,oCAEd4xF,MAAO,WACH,IAAI3vD,EAAKrqD,KAAK0hF,SAAStjE,QAAQwkB,KAAK,MAChCy3E,EAAQr6G,KAAKM,QAAQA,QACrBg6G,EAAct6G,KAAKM,QAAQ45G,QAE/Bl6G,KAAKunB,KAAO,IAAItnB,EAAMqiB,GAAGkF,WAAW6iC,EAAI,CACpCniC,WAAY,IAAIjoB,EAAMuK,KAAK4c,WAAW,CAAE5c,KAAM6vG,IAC9CjyF,SAAU,YACVlmB,MAAOo4G,EACPtyF,OAAQhoB,KAAK6H,MAAMqH,KAAKlP,QAG5BA,KAAKunB,KAAKW,WAAWiyF,OACzB,EACAtyG,MAAO,SAASwgB,GACZgvF,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhCA,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,wBACTN,QAAS,CACLqN,SAAU,WACVzL,MAAOjC,EAAM2M,SAASyb,EAAEilC,OAAOprD,QAAQ,MAGnD,IAGJjC,EAAMsN,YAAYo0E,QAAQw1B,SAAS,WAAYiD,GAE/C,IAAIG,EAAgBlD,EAAkBj3G,OAAO,CACzCC,KAAM,SAASC,GACX,IAAI2iB,EAAWhjB,EAAMsN,YAAY0V,SAAS0+D,QAAQixB,eAAiBvG,EAEnEgL,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMwB,EAAEpB,OAAO,CAAEmO,MAAO0U,EAAS1U,OAASjO,IAEzEN,KAAKoe,QAAUpe,KAAK0hF,SAAStjE,QAC7Bpe,KAAKw6G,iBAELx6G,KAAKq5G,UAAYp5G,EAAMw6G,WAAW,CAC9B5yG,MAAO7H,KAAK6H,MAAMqH,KAAKlP,MACvBgpB,MAAOhpB,KAAKgpB,MAAM9Z,KAAKlP,QAG3BC,EAAMiP,KAAKlP,KAAKoe,QAAQwkB,KAAK,cAAe5iC,KAAKq5G,UACrD,EACA/4G,QAAS,CACL8nB,SAAY,oZAMhBvgB,MAAO,WACHwvG,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhC,IAAIoO,EAAQpO,KAAKirG,cAAc/oG,QAE3BkM,EAAMwH,OAASxH,EAAMM,MACrB1O,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,sBACTN,QAAS,CACLoV,OAAQtH,EAAMM,KACd5K,MAAO,CAAElC,KAAM,EAAGgU,MAAOxH,EAAMwH,SAI/C,EACA4kG,eAAgB,WACZ,IAAIp8F,EAAUpe,KAAK0hF,SAAStjE,QAAQwkB,KAAK,OAAOlQ,QAEhD1yB,KAAKirG,cAAgB,IAAIhrG,EAAMsN,YAAY49F,cAAc/sF,EAAS,CAC9D4J,OAAQhoB,KAAKkC,MAAMgN,KAAKlP,OAEhC,EACAkC,MAAO,SAASkM,GACZ,QAActB,IAAVsB,EACA,OAAOpO,KAAK4N,OAEZ5N,KAAK4N,OAASQ,CAEtB,IAGJnO,EAAMsN,YAAYo0E,QAAQw1B,SAAS,UAAWoD,GAE9C,IAAIG,EAAerD,EAAkBj3G,OAAO,CACxCC,KAAM,SAASC,GACX+2G,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMM,GAErCN,KAAKoe,QAAUpe,KAAK0hF,SAAStjE,QAC7Bpe,KAAK2N,SAAWrN,EAAQqN,SACxB3N,KAAKM,QAAQiO,MAAQjO,EAAQiO,MAE7BvO,KAAKq5G,UAAYp5G,EAAMw6G,WAAW,CAC9B5yG,MAAO7H,KAAK6H,MAAMqH,KAAKlP,MACvBgpB,MAAOhpB,KAAKgpB,MAAM9Z,KAAKlP,QAG3BC,EAAMiP,KAAKlP,KAAKoe,QAAQwkB,KAAK,cAAe5iC,KAAKq5G,UACrD,EACA/4G,QAAS,CACL8nB,SAAY,oZAMhBvgB,MAAO,WACHwvG,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhCA,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,wBACTN,QAAS,CACLqN,SAAU3N,KAAK2N,SACfzL,MAAOlC,KAAKkC,UAGxB,EACAA,MAAO,SAASmmB,GACZ,QAAUvb,IAANub,EACA,OAAOroB,KAAKiS,OAEZjS,KAAKiS,OAASoW,EAAEnmB,KAExB,IAGAy4G,EAAoBD,EAAat6G,OAAO,CACxCC,KAAM,SAASC,GACXA,EAAQ6D,MAAQ,IAChBu2G,EAAan6G,GAAGF,KAAKG,KAAKR,KAAMM,GAChCN,KAAK46G,eACT,EACAA,cAAe,WACX,IAAIx8F,EAAUpe,KAAK0hF,SAAStjE,QAAQwkB,KAAK,OAAOlQ,QAChD1yB,KAAK66G,aAAez8F,EAAQ08F,kBAAkB,CAC1ClP,QAAS,CACL,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACnG,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAEvG5jF,OAAQhoB,KAAKkC,MAAMgN,KAAKlP,QACzBwK,KAAK,oBACZ,IAGJvK,EAAMsN,YAAYo0E,QAAQw1B,SAAS,cAAewD,GAElD,IAAII,EAAoBL,EAAat6G,OAAO,CACxCC,KAAM,SAASC,GACXA,EAAQ6D,MAAQ,IAChBu2G,EAAan6G,GAAGF,KAAKG,KAAKR,KAAMM,GAChCN,KAAK0hF,SAASuH,WAAW,CAAEr8B,WAAW,IACtC5sD,KAAK0hF,SAASs5B,IAAI,WAAYh7G,KAAKi7G,aAAa/rG,KAAKlP,MACzD,EACAi7G,aAAc,WACV,IAAI78F,EAAUpe,KAAK0hF,SAAStjE,QAAQwkB,KAAK,OAAOlQ,QAChD1yB,KAAK6uG,YAAczwF,EAAQ88F,qBAAqB,CAC5ClzF,OAAQhoB,KAAKkC,MAAMgN,KAAKlP,QACzBwK,KAAK,uBACZ,IAGJvK,EAAMsN,YAAYo0E,QAAQw1B,SAAS,cAAe4D,GAElD,IAAII,EAAkB9D,EAAkBj3G,OAAO,CAC3CC,KAAM,SAASC,GACX,IAAI2iB,EAAWhjB,EAAMsN,YAAY0V,SAAS0+D,QAAQkxB,iBAAmBxG,EACjE0M,EAAiB,CACjBxqG,MAAO0U,EAAS1U,MAChBo9F,QAAS,CACL,CAAEh+F,SAAU,YAAiBzL,MAAO,OAAWoqD,UAAW,aAAgB1pD,KAAMqgB,EAAS0oF,QAAQa,aACjG,CAAE7+F,SAAU,YAAiBzL,MAAO,SAAWoqD,UAAW,eAAgB1pD,KAAMqgB,EAAS0oF,QAAQc,eACjG,CAAE9+F,SAAU,YAAiBzL,MAAO,QAAWoqD,UAAW,cAAgB1pD,KAAMqgB,EAAS0oF,QAAQe,cACjG,CAAE/+F,SAAU,YAAiBzL,MAAO,UAAWoqD,UAAW,gBAAmB1pD,KAAMqgB,EAAS0oF,QAAQgB,aACpG,CAAEh/F,SAAU,gBAAiBzL,MAAO,MAAWoqD,UAAW,YAAkB1pD,KAAMqgB,EAAS0oF,QAAQiB,UACnG,CAAEj/F,SAAU,gBAAiBzL,MAAO,SAAWoqD,UAAW,eAAkB1pD,KAAMqgB,EAAS0oF,QAAQkB,aACnG,CAAEl/F,SAAU,gBAAiBzL,MAAO,SAAWoqD,UAAW,eAAkB1pD,KAAMqgB,EAAS0oF,QAAQmB,eAI3GuK,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMwB,EAAEpB,OAAO24G,EAAgBz4G,IAE9DN,KAAKg6G,OACT,EACA15G,QAAS,CACL8nB,SAAU,oCAEd4xF,MAAO,WACH,IAAI3vD,EAAKrqD,KAAK0hF,SAAStjE,QAAQwkB,KAAK,MAEpC5iC,KAAKunB,KAAO,IAAItnB,EAAMqiB,GAAGkF,WAAW6iC,EAAI,CACpCniC,WAAY,IAAIjoB,EAAMuK,KAAK4c,WAAW,CAAE5c,KAAMxK,KAAKM,QAAQqrG,UAC3DvjF,SAAU,8HAIVJ,OAAQhoB,KAAK6H,MAAMqH,KAAKlP,QAG5BA,KAAKunB,KAAKW,WAAWiyF,OACzB,EACAtyG,MAAO,SAASwgB,GACZ,IAAI+yF,EAAW/yF,EAAEilC,OAAOprD,QAAQ,GAChCm1G,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhCA,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,wBACTN,QAAS,CACLqN,SAAUytG,EAASztG,SACnBzL,MAAOk5G,EAASl5G,QAG5B,IAGJjC,EAAMsN,YAAYo0E,QAAQw1B,SAAS,YAAagE,GAEhD,IAAIE,EAAchE,EAAkBj3G,OAAO,CACvCC,KAAM,SAASC,GACX,IAAI2iB,EAAWhjB,EAAMsN,YAAY0V,SAAS0+D,QAAQmxB,aAAezG,EAC7D0M,EAAiB,CACjBxqG,MAAO0U,EAAS1U,MAChBo9F,QAAS,CACL,CAAEzpG,MAAO,QAAgBoqD,UAAW,cAAsB1pD,KAAMqgB,EAAS0oF,QAAQoC,YACjF,CAAE7rG,MAAO,eAAgBoqD,UAAW,2BAA4B1pD,KAAMqgB,EAAS0oF,QAAQqC,mBACvF,CAAE9rG,MAAO,aAAgBoqD,UAAW,yBAA4B1pD,KAAMqgB,EAAS0oF,QAAQsC,iBACvF,CAAE/rG,MAAO,UAAgBoqD,UAAW,gBAAsB1pD,KAAMqgB,EAAS0oF,QAAQv0F,WAIzFigG,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMwB,EAAEpB,OAAO24G,EAAgBz4G,IAE9DN,KAAKg6G,OACT,EACA15G,QAAS,CACL8nB,SAAU,oCAEd4xF,MAAO,WACH,IAAI3vD,EAAKrqD,KAAK0hF,SAAStjE,QAAQwkB,KAAK,MAEpC5iC,KAAKunB,KAAO,IAAItnB,EAAMqiB,GAAGkF,WAAW6iC,EAAI,CACpCniC,WAAY,IAAIjoB,EAAMuK,KAAK4c,WAAW,CAAE5c,KAAMxK,KAAKM,QAAQqrG,UAC3DvjF,SAAU,kGAGVJ,OAAQhoB,KAAK6H,MAAMqH,KAAKlP,QAG5BA,KAAKunB,KAAKW,WAAWiyF,OACzB,EACAtyG,MAAO,SAASwgB,GACZ,IAAI+yF,EAAW/yF,EAAEilC,OAAOprD,QAAQ,GAChCm1G,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhCA,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,mBACTN,QAAS,CACL4B,MAAOk5G,EAASl5G,QAG5B,IAGJjC,EAAMsN,YAAYo0E,QAAQw1B,SAAS,QAASkE,GAE5C,IAAIC,EAAejE,EAAkBj3G,OAAO,CACxCC,KAAM,SAASC,GACX,IAAI2iB,EAAWhjB,EAAMsN,YAAY0V,SAAS0+D,QAAQoxB,cAAgB1G,EAC9D0M,EAAiB,CACjBxqG,MAAO0U,EAAS1U,MAChBo9F,QAAS,CACL,CAAEzpG,MAAO,QAAYoqD,UAAW,cAAgB1pD,KAAMqgB,EAAS0oF,QAAQ8B,aACvE,CAAEvrG,MAAO,OAAYoqD,UAAW,aAAiB1pD,KAAMqgB,EAAS0oF,QAAQ+B,YACxE,CAAExrG,MAAO,UAAYoqD,UAAW,gBAAoB1pD,KAAMqgB,EAAS0oF,QAAQgC,eAC3E,CAAEzrG,MAAO,WAAYoqD,UAAW,gBAAiB1pD,KAAMqgB,EAAS0oF,QAAQ1zF,YAIhFo/F,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMwB,EAAEpB,OAAO24G,EAAgBz4G,IAE9DN,KAAKg6G,OACT,EACA15G,QAAS,CACL8nB,SAAU,oCAEd4xF,MAAO,WACH,IAAI3vD,EAAKrqD,KAAK0hF,SAAStjE,QAAQwkB,KAAK,MAEpC5iC,KAAKunB,KAAO,IAAItnB,EAAMqiB,GAAGkF,WAAW6iC,EAAI,CACpCniC,WAAY,IAAIjoB,EAAMuK,KAAK4c,WAAW,CAAE5c,KAAMxK,KAAKM,QAAQqrG,UAC3DvjF,SAAU,kGAGVJ,OAAQhoB,KAAK6H,MAAMqH,KAAKlP,QAG5BA,KAAKunB,KAAKW,WAAWiyF,OACzB,EACAtyG,MAAO,SAASwgB,GACZ,IAAI+yF,EAAW/yF,EAAEilC,OAAOprD,QAAQ,GAChCm1G,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhCA,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,qBACTN,QAAS,CACL4B,MAAOk5G,EAASl5G,QAG5B,IAGJjC,EAAMsN,YAAYo0E,QAAQw1B,SAAS,SAAUmE,GAE7C,IAAIC,EAAsBt7G,EAAMsN,YAAYiuG,yBAA2BpJ,EAAiBhyG,OAAO,CAC3FC,KAAM,SAASC,GACX8xG,EAAiB7xG,GAAGF,KAAKG,KAAKR,KAAMM,GAEpCN,KAAKkP,KAAK,SAAU,SAAUmZ,GAEV,cAAZA,EAAEmE,QACFxsB,KAAK4P,QAEkB,WAAnB5P,KAAKy7G,WAA6C,SAAnBz7G,KAAKy7G,WACpCz7G,KAAK07G,0BAIG,aAAZrzF,EAAEmE,OACFxsB,KAAK07G,yBAGO,eAAXrzF,EAAEmE,OAAqC,aAAXnE,EAAEmE,OAA0BxsB,KAAKwoB,QAC9DxoB,KAAK27G,aAAc,GAGP,QAAXtzF,EAAEmE,OAA8B,MAAXnE,EAAEmE,OAA4B,uBAAXnE,EAAEmE,OAA6C,QAAXnE,EAAEmE,QAAoBxsB,KAAK27G,aACxG37G,KAAK47G,eAEZ,EAAE1sG,KAAKlP,OAERA,KAAK4P,OACT,EACAgsG,cAAe,WACX57G,KAAKwoB,OAAQ,EACbxoB,KAAKs0B,IAAI,YAAat0B,KAAK67G,kBAAoB57G,EAAMqV,OAAOtV,KAAK67G,kBAAmB77G,KAAK0O,MAAQ,IACjG1O,KAAKs0B,IAAI,cAAet0B,KAAK87G,oBAAsB77G,EAAMqV,OAAOtV,KAAK87G,oBAAqB97G,KAAKw5C,KAAMx5C,KAAKy5C,IAAM,IAChHz5C,KAAKwoB,OAAQ,CACjB,EACA5Y,MAAO,WACH5P,KAAK+7G,eACL/7G,KAAKs0B,IAAI,WAAYt0B,KAAKqzG,UAAU,GAAG3kG,MACvC1O,KAAKs0B,IAAI,OAAQ,MACjBt0B,KAAKs0B,IAAI,KAAM,MAEft0B,KAAKs0B,IAAI,qBAAqB,GAE9Bt0B,KAAK27G,aAAc,EAEnB37G,KAAK67G,kBAAoB77G,KAAKg8G,iBAC9Bh8G,KAAK47G,eACT,EAEAG,aAAc,WACV,IAAIh3D,EAAM/kD,KAAKi8G,iBACX5I,EAAY,GAEhB,GAAuB,SAAnBrzG,KAAKy7G,UAEL,IADA,IAAIS,EAAiB,CAAC,UAAW,cACxBhxD,EAAM,EAAGA,EAAMnG,EAAI1jD,OAAQ6pD,IAC5BgxD,EAAe,IAAMn3D,EAAImG,GAAKx8C,OAC9B2kG,EAAU1yG,KAAKokD,EAAImG,IACnBgxD,EAAe70G,cAIvBgsG,EAAYtuD,EAAIjkD,QAGpBd,KAAKs0B,IAAI,YAAa++E,EAC1B,EACAqI,uBAAwB,WACE,WAAnB17G,KAAKy7G,WAA6C,SAAnBz7G,KAAKy7G,UACpCz7G,KAAKs0B,IAAI,sBAAuBr0B,EAAMqV,OAAOtV,KAAKm8G,mBAAoBn8G,KAAKy7G,UAAWz7G,KAAKszG,iBAAiBtzG,KAAKuzB,aAEjHvzB,KAAKs0B,IAAI,sBAAuB,IAChCt0B,KAAKs0B,IAAI,cAAe,IAE/B,EACA8nF,MAAO,WACH,MAAiC,QAA1Bp8G,KAAKyC,IAAI,YACpB,EACA45G,SAAU,WACN,MAAiC,WAA1Br8G,KAAKyC,IAAI,YACpB,EACA65G,gBAAiB,WACb,OAAOt8G,KAAKu8G,UAAYv8G,KAAKq8G,UACjC,EACAG,cAAe,WACX,OAAOx8G,KAAKu8G,UAAYv8G,KAAKy8G,QACjC,EACAC,OAAQ,WACJ,MAAiC,SAA1B18G,KAAKyC,IAAI,YACpB,EACAg6G,OAAQ,WACJ,MAAiC,SAA1Bz8G,KAAKyC,IAAI,YACpB,EACAk6G,OAAQ,WACJ,MAAiC,SAA1B38G,KAAKyC,IAAI,YACpB,EACAm6G,SAAU,WACN,MAAiC,WAA1B58G,KAAKyC,IAAI,YACpB,EACAo6G,WAAY,WACR,OAAO78G,KAAKyC,IAAI,gBACpB,EACA85G,OAAQ,WACJ,MAA+B,WAAxBv8G,KAAKyC,IAAI,aAAoD,cAAxBzC,KAAKyC,IAAI,WACzD,EACAq6G,OAAQ,SAAS97F,GACbhhB,KAAKs0B,IAAI,kBAAmBtT,GAExBA,GACAhhB,KAAK+8G,qBAAqB/7F,EAElC,EACA+7F,qBAAsB,SAAS/7F,GAC3BhhB,KAAKs0B,IAAI,YAAatT,EAAW04B,UACjC15C,KAAKs0B,IAAI,WAAYtT,EAAW24B,cAChC35C,KAAKs0B,IAAI,OAAQtT,EAAWw4B,MAC5Bx5C,KAAKs0B,IAAI,KAAMtT,EAAWy4B,IAC1Bz5C,KAAKs0B,IAAI,OAAQtT,EAAWtS,MAC5B1O,KAAKs0B,IAAI,cAAetT,EAAW44B,YACnC55C,KAAKs0B,IAAI,aAActT,EAAW+4B,YAE9B/4B,EAAWm5B,iBAAmBn5B,EAAWo5B,eACzCp6C,KAAK87G,oBAAsB96F,EAAWm5B,gBACtCn6C,KAAKkzG,YAAclyF,EAAWm5B,gBAC9Bn6C,KAAK67G,kBAAoB76F,EAAWo5B,cACpCp6C,KAAKmzG,UAAYnyF,EAAWo5B,cAC5Bp6C,KAAKg9G,mBAAoB,EACzBh9G,KAAK47G,iBAEL57G,KAAKg9G,mBAAoB,CAEjC,EACAC,mBAAoB,WAChB,GAAuB,QAAnBj9G,KAAKy7G,UACL,OAAO,KAGX,IAAIn7G,EAAU,CACVoO,KAAM1O,KAAK0O,KACXgrC,SAAU15C,KAAKy7G,UACf9hE,aAAc35C,KAAKuzB,SACnBimB,KAAMx5C,KAAKw5C,KACXC,GAAIz5C,KAAKy5C,GACTG,WAAY55C,KAAK4zG,YACjB75D,WAAY/5C,KAAK+5C,YAQrB,OALI/5C,KAAKg9G,oBACL18G,EAAQ65C,gBAAkBn6C,KAAK27G,YAAc37G,KAAK87G,oBAAsB97G,KAAKkzG,YAC7E5yG,EAAQ85C,cAAgBp6C,KAAKmzG,WAG1B7yG,CACX,IAGA48G,EAAmB7F,EAAkBj3G,OAAO,CAC5CC,KAAM,SAASC,GACX,IAAI2iB,EAAWhjB,EAAMsN,YAAY0V,SAAS0+D,QAAQsxB,kBAAoB5G,EAClE0M,EAAiB,CACjBxqG,MAAO0U,EAAS1U,MAChB2kG,YAAajwF,EAASiwF,YACtBC,UAAWlwF,EAASkwF,UACpB50C,SAAU,CACN,CAAE7vD,KAAM,MAAOxC,KAAM+W,EAASs7C,SAAS60C,KACvC,CAAE1kG,KAAM,SAAUxC,KAAM+W,EAASs7C,SAAS3K,QAC1C,CAAEllD,KAAM,OAAQxC,KAAM+W,EAASs7C,SAAS37D,MACxC,CAAE8L,KAAM,OAAQxC,KAAM+W,EAASs7C,SAASroB,MACxC,CAAExnC,KAAM,SAAUxC,KAAM+W,EAASs7C,SAAS7iB,QAC1C,CAAEhtC,KAAM,OAAQxC,KAAM+W,EAASs7C,SAASh3C,OAE5C8rF,UAAW,CACP,CAAE3kG,KAAM,cAAexC,KAAM+W,EAASowF,UAAUx3D,aAChD,CAAEntC,KAAM,WAAexC,KAAM+W,EAASowF,UAAUv3D,UAChD,CAAEptC,KAAM,UAAexC,KAAM+W,EAASowF,UAAUt3D,SAChD,CAAErtC,KAAM,aAAexC,KAAM+W,EAASowF,UAAUj3D,YAChD,CAAE1tC,KAAM,UAAexC,KAAM+W,EAASowF,UAAUr3D,SAChD,CAAEttC,KAAM,aAAexC,KAAM+W,EAASowF,UAAUp3D,YAChD,CAAEvtC,KAAM,uBAAwBxC,KAAM+W,EAASowF,UAAUn3D,sBACzD,CAAExtC,KAAM,oBAAwBxC,KAAM+W,EAASowF,UAAUl3D,oBAE7Dm3D,iBAAkBrwF,EAASqwF,kBAG/B+D,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMwB,EAAEpB,OAAO24G,EAAgBz4G,GAClE,EACAA,QAAS,CACL6D,MAAO,IACPs3G,UAAW,MACX/sG,KAAM,SACNklG,aAAa,EACb75D,YAAY,EACZijE,mBAAmB,EACnBG,cACI,8DACIl9G,EAAMqiB,GAAGK,KAAK,CAAEA,KAAM,qBAAsB2pC,UAAW,mBAD3D,uGAKJlkC,SACI,uqRAqJRgB,KAAM,SAASvb,GACX,IACIuQ,EADA9d,EAAUN,KAAKM,QAGnBN,KAAKq5G,UAAY,IAAIkC,EAAoB,CACrC7sG,KAAMpO,EAAQoO,KACdytG,mBAAoB77G,EAAQ4yG,YAC5B8I,iBAAkB17G,EAAQ6yG,UAC1B8I,iBAAkB37G,EAAQ+yG,UAAUvyG,MAAM,GAC1CwyG,iBAAkBhzG,EAAQgzG,iBAC1B/0C,SAAUj+D,EAAQi+D,SAASz9D,MAAM,GACjC26G,UAAWn7G,EAAQm7G,UACnB7H,YAAatzG,EAAQszG,YACrB75D,WAAYz5C,EAAQy5C,WACpBlyC,MAAO7H,KAAK6H,MAAMqH,KAAKlP,MACvBgpB,MAAOhpB,KAAKgpB,MAAM9Z,KAAKlP,MACvBgyB,OAAQhyB,KAAKgyB,OAAO9iB,KAAKlP,QAG7BA,KAAKq5G,UAAUyD,OAAOjvG,EAAMmT,cAE5Bq2F,EAAkB92G,GAAG6oB,KAAK5oB,KAAKR,MAE/Boe,EAAUpe,KAAK0hF,SAAStjE,QAEpBpe,KAAKo9G,aACLp9G,KAAKo9G,YAAYl6F,UAGrBjjB,EAAMiP,KAAKkP,EAASpe,KAAKq5G,WAEzBr5G,KAAKo9G,YAAc,IAAIn9G,EAAMqiB,GAAG+6F,UAAUj/F,EAAQwkB,KAAK,0BAA2B,CAC9E06E,gBAAgB,EAChBH,cAAen9G,KAAKM,QAAQ68G,oBAAiBrwG,GAErD,EACAjF,MAAO,WAEC7H,KAAKo9G,YAAYG,aACjBlG,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhCA,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,wBACTN,QAAS,CACL4B,MAAOlC,KAAKq5G,UAAU4D,wBAItC,EACAjrF,OAAQ,WACJhyB,KAAKq5G,UAAU/kF,IAAI,YAAa,OAChCt0B,KAAK6H,OACT,IAGJ5H,EAAMsN,YAAYo0E,QAAQw1B,SAAS,aAAc+F,GACjDj9G,EAAMsN,YAAYo0E,QAAQu7B,iBAAmBA,EAS7C,IAAIM,EAAiBnG,EAAkBj3G,OAAO,CAC1CC,KAAM,SAASC,GACX+2G,EAAkB92G,GAAGF,KAAKG,KAAKR,KAAMM,GACrCA,EAAUN,KAAKM,QAEfN,KAAKq5G,UAAYp5G,EAAMw6G,WAAW,CAC9BlsG,MAAOjO,EAAQiO,MACfrC,KAAM5L,EAAQ4L,KACdwV,UAAWphB,EAAQohB,UACnB+7F,YAAYn9G,EAAQm9G,YACpBjyC,MAAOlrE,EAAQ64E,YACft3D,IAAK,CACDqqD,SAAU5rE,EAAQ44E,UAAUhN,SAC5BC,WAAY7rE,EAAQ44E,UAAU/M,WAC9B59D,MAAOjO,EAAQ44E,UAAU3qE,MACzB4xD,OAAQ7/D,EAAQ44E,UAAU/Y,OAC1Bu9C,UAAWp9G,EAAQ44E,UAAUwkC,UAC7BC,QAASr9G,EAAQ44E,UAAUykC,QAC3BC,SAAUt9G,EAAQ44E,UAAU0kC,SAC5BC,QAASv9G,EAAQ44E,UAAU2kC,QAC3B3nE,KAAM51C,EAAQ44E,UAAUhjC,KAExB4nE,SAAUx9G,EAAQuhB,IAAIi8F,SACtBzwC,KAAM/sE,EAAQuhB,IAAIwrD,KAClB0wC,MAAOz9G,EAAQuhB,IAAIk8F,MACnBtI,UAAWn1G,EAAQuhB,IAAI4zF,UACvBuI,WAAY19G,EAAQuhB,IAAIm8F,WACxB9I,OAAQ50G,EAAQuhB,IAAIqzF,OACpBQ,QAASp1G,EAAQuhB,IAAI6zF,QACrBuI,UAAW39G,EAAQuhB,IAAIo8F,UACvBrI,WAAYt1G,EAAQuhB,IAAI+zF,WACxBsI,QAAS59G,EAAQuhB,IAAIq8F,QACrBC,QAAS79G,EAAQuhB,IAAIs8F,SAEzBt2G,MAAO7H,KAAK6H,MAAMqH,KAAKlP,MACvBgpB,MAAOhpB,KAAKgpB,MAAM9Z,KAAKlP,QAG3B,IAAI0hF,EAAS1hF,KAAK0hF,SAClB1hF,KAAKq5G,UAAUnqG,KAAK,UAAU,SAASmZ,GACnB,cAAZA,EAAEmE,QACFxsB,KAAKs0B,IAAI,iBAAqC,SAAnBt0B,KAAK0hB,WAChCggE,EAAOm0B,SAEf,IAEA51G,EAAMiP,KAAKwyE,EAAOtjE,QAASpe,KAAKq5G,UACpC,EACA/4G,QAAS,CACLiO,MAAOiiF,EAAK,uBAAwB,aACpCtkF,KAAMskF,EAAK,iCAAkC,YAC7C9uE,UAAW,QACX+7F,YAAa,CAAC,CACVpJ,YAAa7jB,EAAK,kCAAmC,0BACrD9uE,UAAW,SACZ,CACC2yF,YAAa7jB,EAAK,iCAAkC,mCACpD9uE,UAAW,SAEfG,IAAK,CACDi8F,UAAU,EACVzwC,KAAM,WACN0wC,MAAO,CAAC,CACJ1wC,KAAM,WACNzqE,KAAM4tF,EAAK,mCAAoC,oBACjD,CACEnjB,KAAM,QACNzqE,KAAM4tF,EAAK,gCAAiC,iBAC9C,CACEnjB,KAAM,YACNzqE,KAAM4tF,EAAK,oCAAqC,eAEpDilB,UAAW,KACXuI,WAAY,CACR,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,QAAS,QAAS,SAAU,UAAW,aACnF77G,KAlFd,SAAwBP,GACpB,MAAO,CACHM,MAAON,EACPgB,KAAM4tF,EAAK,4BAA8B5uF,GAEjD,IA8EYszG,OAAQ,CAACl1F,OAAQ,SAAUP,KAAM,QAASE,MAAO,QAASI,IAAK,UAC/D21F,QAAS,CACL,CAAExzG,MAAO,CAAE8d,OAAQ,SAAUP,KAAM,QAASE,MAAO,QAASI,IAAK,UAC/Dnd,KAAM4tF,EAAK,mCAAoC,WAEjD,CAAEtuF,MAAO,CAAE8d,OAAQ,SAAUP,KAAM,SAAUE,MAAO,SAAUI,IAAK,UACjEnd,KAAM4tF,EAAK,mCAAoC,WAEjD,CAAEtuF,MAAO,CAAE8d,OAAQ,MAAOP,KAAM,MAAOE,MAAO,MAAOI,IAAK,OACxDnd,KAAM4tF,EAAK,iCAAkC,UAGnDytB,WAAW,EACXrI,YAAY,EACZsI,SAAS,EACTC,SAAS,GAEbh6G,MAAO,IACPikB,SA0CgB,m2EAAqKnoB,EAAMqiB,GAAGK,KAAK,CAAEA,KAAM,OAAQ2pC,UAAW,oXAE1CrsD,EAAMqiB,GAAGK,KAAK,CAAEA,KAAM,kBAAmB2pC,UAAW,8yCAiB5NrsD,EAAMqiB,GAAGK,KAAKnhB,EAAE,2DAA4D,CAAEmhB,KAAM,SACpF1iB,EAAMqiB,GAAGK,KAAKnhB,EAAE,yDAA0D,CAAEmhB,KAAM,oBA7D1F,oZAqER9a,MAAO,WACHwvG,EAAkB92G,GAAGsH,MAAMrH,KAAKR,MAEhCA,KAAKkB,QAAQ,SAAU,CACnBN,QAAS,gBACTN,QAASN,KAAKq5G,WAEtB,IAIJ,SAAS+E,EAAiBz2G,EAAIuD,GAC1BjL,EAAMsN,YAAYo0E,QAAQw1B,SACtBxvG,EACA6xG,EAAcp5G,OAAO,CACjBE,QAAS,CAAEm5G,UAAWvuG,KAGlC,CATAjL,EAAMsN,YAAYo0E,QAAQw1B,SAAS,WAAYqG,GAW/CY,EAAiB,eAAgB,mCACjCA,EAAiB,gBAAiB,oCAClCA,EAAiB,kBAAmB,sCACpCA,EAAiB,WAAY,+BAC7BA,EAAiB,uBAAwB,2CACzCA,EAAiB,qBAAsB,yCACvCA,EAAiB,kBAAmB,sCACpCA,EAAiB,qBAAsB,yCAEvC,IAAIC,EAAoB7E,EAAcp5G,OAAO,CACzCE,QAAS,CACL6D,MAAO,IACPoK,MAAO,mBACP6Z,SACI,2sBAsBZnoB,EAAMsN,YAAYo0E,QAAQw1B,SAAS,cAAekH,GAElD,IAAIC,EAAoB9E,EAAcp5G,OAAO,CACzCE,QAAS,CACLiO,MAAOiiF,EAAK,0BAA2B,uBACvCpoE,SACI,ucAYZnoB,EAAMsN,YAAYo0E,QAAQw1B,SAAS,cAAemH,GAElD,IAAIC,EAAkBlH,EAAkBj3G,OAAO,CAC3CE,QAAS,CACLiO,MAAOiiF,EAAK,mBAAoB,aAChCpoE,SACA,46BAQAmvF,WAAW,GAEfnuF,KAAM,SAASvb,GACX,IAAIhO,EAAOG,KACXq3G,EAAkB92G,GAAG6oB,KAAKvhB,MAAMhI,EAAM+H,WACtC,IAAIwW,EAAUve,EAAK6hF,SAAStjE,QACxBogG,EAAQv+G,EAAMw6G,WAAW,CACzBxvC,IAAKp9D,EAAM2E,OACX3K,MAAO,WACE,KAAKI,KAAKu2G,EAAMvzC,OACjBuzC,EAAMvzC,IAAM,MAEhBprE,EAAKqB,QAAQ,SAAU,CACnBN,QAAS,mBACTN,QAAS,CACLkS,KAAMgsG,EAAMvzC,OAGpBprE,EAAKmpB,OACT,EACAgJ,OAAQ,WACJwsF,EAAMvzC,IAAM,KACZuzC,EAAM32G,OACV,EACAknG,OAAQlvG,EAAKmpB,MAAM9Z,KAAKrP,KAE5BI,EAAMiP,KAAKkP,EAASogG,GAKpBpgG,EAAQwkB,KAAK,SACR1hC,QAAQ,SACR0iB,GAAG,WAAW,SAASyF,GACF,IAAdA,EAAGI,SACH+0F,EAAMvzC,IAAMzpE,EAAExB,MAAMyqB,MACpBpB,EAAGyhC,kBACHzhC,EAAGjQ,iBACHolG,EAAM32G,SACe,IAAdwhB,EAAGI,UACVJ,EAAGyhC,kBACHzhC,EAAGjQ,iBACHolG,EAAMzP,SAEd,GACR,IAGJ9uG,EAAMsN,YAAYo0E,QAAQw1B,SAAS,YAAaoH,GAEhD,IAAIE,EAAsBpH,EAAkBj3G,OAAO,CAC/CE,QAAS,CACLwlC,UAAW,+BACX1d,SAAU,k8BASV7Z,MAAOiiF,EAAK,4BAA6B,kBACzC+mB,WAAW,EACXpzG,MAAO,KAEXilB,KAAM,SAASvb,GACX,IAAIhO,EAAOG,KACXq3G,EAAkB92G,GAAG6oB,KAAKvhB,MAAMhI,EAAM+H,WACtC,IAAIwW,EAAUve,EAAK6hF,SAAStjE,QACxBogG,EAAQv+G,EAAMw6G,WAAW,CACzB33D,QAASj1C,EAAMi1C,UACfj7C,MAAO,WACE,KAAKI,KAAKu2G,EAAM17D,WACjB07D,EAAM17D,QAAU,MAEpBjjD,EAAKqB,QAAQ,SAAU,CACnBN,QAAS,uBACTN,QAAS,CACL4B,MAAOs8G,EAAM17D,WAGrBjjD,EAAKmpB,OACT,EACAgJ,OAAQ,WACJwsF,EAAM17D,QAAU,KAChB07D,EAAM32G,OACV,EACAknG,OAAQlvG,EAAKmpB,MAAM9Z,KAAKrP,KAE5BI,EAAMiP,KAAKkP,EAASogG,GAEpBpgG,EAAQwkB,KAAK,YAAY1hC,QAAQ,QACrC,IAGJjB,EAAMsN,YAAYo0E,QAAQw1B,SAAS,gBAAiBsH,GAEpD,IAAIC,EAAoBrH,EAAkBj3G,OAAO,CAC7CE,QAAS,CACL8nB,SAAU,o4BAcV7Z,MAAOiiF,EAAK,0BAA2B,gBACvCrsF,MAAO,QAEXilB,KAAM,WACF,IAAIvpB,EAAOG,KACXq3G,EAAkB92G,GAAG6oB,KAAKvhB,MAAMhI,EAAM+H,WACtC,IAAIwW,EAAUve,EAAK6hF,SAAStjE,QACxBogG,EAAQv+G,EAAMw6G,WAAW,CACzBkE,WAAW,EACX3H,KAAM/2G,EAAMsN,YAAY0V,SAAS0+D,QAAQo1B,kBAAkBC,KAC3DtqC,SAAU,GACVkyC,UAAU,EACVC,WAAW,EACXC,KAAM,KACNC,OAAQ,KACRl3G,MAAO,WACHpG,OAAOkrE,IAAIE,gBAAgB2xC,EAAMM,MACjCj/G,EAAKqB,QAAQ,SAAU,CACnBN,QAAS,qBACTN,QAAS,CACL+P,KAASmuG,EAAMO,OACf56G,MAASq6G,EAAMluG,OACflM,OAASo6G,EAAMjuG,WAGvB1Q,EAAKmpB,OACT,EACA+lF,OAAQlvG,EAAKmpB,MAAM9Z,KAAKrP,GACxBm/G,UAAW,SAAS31F,GAChBA,EAAGyhC,kBACHzhC,EAAGjQ,gBACP,EACA6lG,KAAM,SAAS51F,GACXm1F,EAAMQ,UAAU31F,GAChBm1F,EAAMU,WAAW71F,EAAGmB,cAAc20F,aAAatoC,OAC/C2nC,EAAMlqF,IAAI,aAAa,EAC3B,EACA8qF,UAAW,SAAS/1F,GAChBm1F,EAAMQ,UAAU31F,GAChBm1F,EAAMlqF,IAAI,aAAa,EAC3B,EACA+qF,UAAW,SAASh2F,GAChBm1F,EAAMQ,UAAU31F,GAChBm1F,EAAMlqF,IAAI,aAAa,EAC3B,EACAtM,OAAQ,SAASqB,GACbm1F,EAAMU,WAAW71F,EAAGrX,OAAO6kE,MAC/B,EACAqoC,WAAY,SAASroC,GAEjB,IADA,IAAI5mE,EACK1M,EAAI,EAAGA,EAAIszE,EAAMx1E,SAAUkC,EAChC,GAAI,YAAY0E,KAAK4uE,EAAMtzE,GAAGmL,MAAO,CACjCuB,EAAQ4mE,EAAMtzE,GACd,KACJ,CAKJ,GAHIi7G,EAAMM,MACNr9G,OAAOkrE,IAAIE,gBAAgB2xC,EAAMM,MAEjC7uG,EAAO,CACPuuG,EAAMO,OAAS9uG,EACfuuG,EAAMM,KAAOr9G,OAAOkrE,IAAIC,gBAAgB38D,GACxC,IAAID,EAAM,IAAI2mE,MACd3mE,EAAIu1C,IAAMi5D,EAAMM,KAChB9uG,EAAIw3D,OAAS,WACTg3C,EAAMluG,OAASN,EAAI7L,MACnBq6G,EAAMjuG,QAAUP,EAAI5L,OACpBo6G,EAAMlqF,IAAI,OAAQr0B,EAAMsN,YAAY0V,SAAS0+D,QAAQo1B,kBAAkBC,MACvEwH,EAAMlqF,IAAI,aAAa,GACvBkqF,EAAMlqF,IAAI,WAAY,QAAUkqF,EAAMM,KAAO,MAC7CN,EAAMlqF,IAAI,YAAY,EAC1B,CACJ,MACIkqF,EAAMO,OAAS,KACfP,EAAMlqF,IAAI,OAAQr0B,EAAMsN,YAAY0V,SAAS0+D,QAAQo1B,kBAAkBE,WACvEuH,EAAMlqF,IAAI,aAAa,GACvBkqF,EAAMlqF,IAAI,WAAY,IACtBkqF,EAAMlqF,IAAI,YAAY,EAE9B,IAEJr0B,EAAMiP,KAAKkP,EAASogG,EACxB,IAKJ,SAASc,EAAYC,EAAMtpD,GACvBj2D,KAAKu/G,KAAOA,EAAKt5G,MAAM,KACvBjG,KAAKi2D,IAAMA,CACf,CAaA,SAASu6B,EAAK+uB,EAAMtpD,GAChB,OAAO,IAAIqpD,EAAYC,EAAMtpD,EACjC,CAEA,SAASqhD,EAAUtqG,GACf,OAAIA,aAAiBsyG,EACVtyG,EAAMwyG,QAER1kF,MAAM4T,QAAQ1hC,GACZA,EAAM7K,IAAIm1G,GAEH,MAATtqG,GAAiC,iBAATA,EACtBvF,OAAO2b,KAAKpW,GAAO6pB,QAAO,SAASC,EAAK70B,GAE3C,OADA60B,EAAI70B,GAAOq1G,EAAUtqG,EAAM/K,IACpB60B,CACX,GAAG,CAAC,GAED9pB,CACX,CApCA/M,EAAMsN,YAAYo0E,QAAQw1B,SAAS,cAAeuH,GAOlDY,EAAYtsG,UAAUwsG,MAAQ,WAE1B,IADA,IAAIt0G,EAAMjL,EAAMsN,YAAY0V,SAAS0+D,QAC5Bp+E,EAAI,EAAGA,EAAIvD,KAAKu/G,KAAKl+G,SAAUkC,EAEpC,KADA2H,EAAMA,EAAIlL,KAAKu/G,KAAKh8G,KAEhB,OAAOvD,KAAKi2D,IAGpB,OAAO/qD,CACX,CAsBH,CA/8DD,CA+8DGzJ,OAAOxB,OAEV,SAAUA,GAIN,IAAImzD,EAAW,SAASqsD,GAAK,OAAOA,CAAG,EAEnCpgE,EAAwBp/C,EAAM0B,MAAMvB,OAAO,CAC3CC,KAAM,SAASC,GAEXN,KAAKM,QAAUL,EAAMwF,OAAOrF,OAAO,CAAC,EAAGJ,KAAKM,QAASA,GAErDN,KAAKgY,QAAUhY,KAAK0/G,kBAAkB1/G,KAAKM,QAAQ0X,SAEnDhY,KAAKqP,SACLrP,KAAK2/G,cAEL3/G,KAAK4/G,UAEL5/G,KAAK6/G,gBAAkB,EAEvB7/G,KAAKkoB,WAAWiyF,OACpB,EAEA9qG,OAAQ,WACJrP,KAAKgP,MAAQhP,KAAKM,QAAQ0O,MAE1BhP,KAAK8/G,oBAAsB9/G,KAAK8oE,aAAa55D,KAAKlP,MAClDA,KAAK+/G,uBAAyB//G,KAAKipE,gBAAgB/5D,KAAKlP,MACxDA,KAAKggH,uBAAyBhgH,KAAK+oE,gBAAgB75D,KAAKlP,MAExDA,KAAKgP,MAAME,KAAK,SAAUlP,KAAK8/G,qBAC1B5wG,KAAK,iBAAkBlP,KAAK+/G,wBAC5B7wG,KAAK,iBAAkBlP,KAAKggH,uBACrC,EAEAj3C,gBAAiB,SAAS1gD,QACNvb,IAAZub,EAAE3d,OACF1K,KAAKkoB,WAAW4J,OAAOrhB,KAAKmK,IAAIyN,EAAE3d,MAAQ,EAAG,GAAI,CAAC,EAE1D,EAEAu+D,gBAAiB,SAAS5gD,GACtB,QAAgBvb,IAAZub,EAAE3d,MAAqB,CACvB,IAAIwd,EAAaloB,KAAKkoB,WAClBs2F,EAAQt2F,EAAW6B,OAAO1B,EAAE3d,MAAQ,GAEpC8zG,GACAt2F,EAAW8J,OAAOwsF,EAE1B,CACJ,EAEAoB,QAAS,WACL5/G,KAAKgP,MAAMmG,MAAM,WACbnV,KAAKgY,QAAQlJ,QAAQ,SAASwO,EAAQ5S,GAClC1K,KAAKgP,MAAMnB,MAAM,EAAEnD,GAAOxI,MAAMob,EAAO/O,MAC3C,EAAEW,KAAKlP,MACX,EAAEkP,KAAKlP,MACX,EAEA8oE,aAAc,SAASzgD,GACnB,IAAIA,EAAExI,YAAawI,EAAEvH,WAKjBuH,EAAEpR,QAAUoR,EAAEtZ,KAAOsZ,EAAE9I,QAAS,CAChC,IAMI0gG,EAAQC,EAASC,EAAe58G,EAAa68G,EAN7CtnG,EAAW7Y,EAAMsN,YAAYuL,SAC7BoP,EAAaloB,KAAKkoB,WAClB1d,EAAO0d,EAAW6B,OAClB/R,EAAUhY,KAAKgY,QACf7Q,EAAS,GACT6H,EAAQhP,KAAKgP,MAEbqxG,EAAY,SAAStxG,GAIrB,IAFA,IAAIuxG,EACAC,EAAa,EACR15E,GAHT93B,EAAMA,EAAIE,cAGQ4B,QAAQ6C,IAAKmzB,GAAM93B,EAAIwL,YAAY7G,IAAKmzB,IAAM,EAC5Dy5E,EAAS91G,EAAKq8B,EAAK,MAGfy5E,EAASp4F,EAAW4J,OAAO+U,EAAK,EAAG,CAAC,GACpCr8B,EAAO0d,EAAW6B,QAItB,IADA,IAAIy2F,EAAgB,EACX15E,EAAK/3B,EAAI8B,QAAQwE,IAAKyxB,GAAM/3B,EAAIwL,YAAYlF,KAAOyxB,EAAK9uB,EAAQ3W,OAAQylC,IAAM,CACnF,IAAI25E,EAAet5G,EAAO5D,GAAGg9G,GAAYC,KACzCF,EAAOhsF,IAAItc,EAAQ8uB,GAAIta,MAAO0zF,EAAQp5E,GAAI25E,GAC9C,CACAF,GACJ,CACJ,EA+BA,IA7BIr4F,EAAWo/C,OAAOk3C,QAClByB,EAAS/3F,EAAWo/C,OAAOk3C,MAAMyB,SAGhCjoG,EAAQ3W,QAAUmJ,EAAKnJ,SACxB2W,EAAUvQ,OAAO2b,KAAK5Y,EAAK,GAAGqpB,WAGlCqsF,EAAUloG,EAAQ7V,KAAI,SAASmb,GAC3B,IAAIkP,EAAQlP,EAAOkP,MACnB,OAAIA,GAASyzF,GAAUA,EAAOzzF,IAAgC,QAAtByzF,EAAOzzF,GAAO9d,KAC3C07B,EAEJgpB,CACX,IAEApzD,KAAK0gH,aAAc,GACnBP,EAAgBnxG,EAAM8uB,MAAMpD,UAAUrS,EAAEtZ,gBAEV+J,IAC1BqnG,EAAgB,IAAIrnG,EAAS,CAACqnG,MAGlCC,EAAiBD,EAAc3sG,MAEhB1E,SAAQ,SAASC,GAC5B5H,EAAOxG,KAAKqO,EAAMnB,MAAMkB,GAAK5H,SACjC,IAEI5D,EAAI,EAAGA,EAAI68G,EAAe/+G,OAAQkC,IACvB68G,EAAe78G,GACjBuL,QAAQuxG,GAGrBrgH,KAAK6/G,gBAAkB33F,EAAW6B,OAAO1oB,OAEzCrB,KAAK0gH,aAAc,CACvB,CACJ,EAEAhB,kBAAmB,SAAS1nG,GACxB,OAAOA,EAAQ7V,KAAI,SAASmb,GACxB,IAAIkP,EAAQlP,EAAOkP,OAASlP,EAC5B,MAAO,CACHkP,MAAOA,EACPje,MAAO+O,EAAO/O,OAASie,EAE/B,GACJ,EAEAmzF,YAAa,WACT,IACIz3F,EADUloB,KAAKM,QACM4nB,WAEzBA,EAAa4S,MAAM4T,QAAQxmB,GAAc,CAAE1d,KAAM0d,GAAeA,EAE5DloB,KAAKkoB,YAAcloB,KAAK2gH,eACxB3gH,KAAKkoB,WAAW0gD,OAAO,SAAU5oE,KAAK2gH,gBACjC/3C,OAAO,WAAY5oE,KAAK4gH,kBACxBh4C,OAAO,QAAS5oE,KAAK6gH,gBAE1B7gH,KAAK2gH,eAAiB3gH,KAAK6rG,QAAQ38F,KAAKlP,MACxCA,KAAK4gH,iBAAmB5gH,KAAK8gH,cAAc5xG,KAAKlP,MAChDA,KAAK6gH,cAAgB7gH,KAAK+gH,OAAO7xG,KAAKlP,OAG1CA,KAAKkoB,WAAajoB,EAAMuK,KAAK4c,WAAW1f,OAAOwgB,GAC1ChZ,KAAK,SAAUlP,KAAK2gH,gBACpBzxG,KAAK,WAAYlP,KAAK4gH,kBACtB1xG,KAAK,QAASlP,KAAK6gH,cAC5B,EAEAE,OAAQ,WACJ/gH,KAAKghH,WAAU,EACnB,EAEAF,cAAe,WACX9gH,KAAKghH,WAAU,EACnB,EAEAA,UAAW,SAAS10F,GAChBtsB,KAAKgP,MAAM9N,QAAQ,WAAY,CAC3BorB,OAAQA,GAEhB,EAEAu/E,QAAS,WACL,IAAI7rG,KAAK0gH,cAIL1gH,KAAKgP,MAAM9N,QAAQ,eAAvB,CAIA,IAAIsJ,EAAOxK,KAAKkoB,WAAW6B,OACvB/R,EAAUhY,KAAKgY,SAEdA,EAAQ3W,QAAUmJ,EAAKnJ,SACxBrB,KAAKgY,QAAUA,EAAUhY,KAAK0/G,kBAAkBj4G,OAAO2b,KAAK5Y,EAAK,GAAGqpB,WACpE7zB,KAAK4/G,WAGT,IAAIM,EAAUloG,EAAQ7V,KAAI,SAASmb,GAC/B,OAAOrd,EAAMy5G,OAAOp8F,EAAOkP,MAC/B,IAEAxsB,KAAKgP,MAAMmG,MAAM,WAGb,IAFA,IAAI9T,EAASoP,KAAKmK,IAAIpQ,EAAKnJ,OAAQrB,KAAK6/G,gBAAiB7/G,KAAKgP,MAAM8uB,MAAMpI,SAAW,GAE5Ew1B,EAAM,EAAGA,EAAM7pD,EAAQ6pD,IAC5B,IAAK,IAAI+1D,EAAY,EAAGA,EAAYf,EAAQ7+G,OAAQ4/G,IAAa,CAC7D,IAAI/+G,EAAQsI,EAAK0gD,GAAOg1D,EAAQe,GAAWz2G,EAAK0gD,IAAQ,KAGxDlrD,KAAKgP,MAAMnB,MAAMq9C,EAAM,EAAG+1D,GAAW/+G,MAAMA,EAC/C,CAER,EAAEgN,KAAKlP,OAEPA,KAAK6/G,gBAAkBr1G,EAAKnJ,OAE5BrB,KAAKghH,WAAU,GACfhhH,KAAKgP,MAAM9N,QAAQ,YA9BnB,CA+BJ,EAEAgiB,QAAS,WACLljB,KAAKkoB,WAAW0gD,OAAO,SAAU5oE,KAAK2gH,gBACjC/3C,OAAO,WAAY5oE,KAAK4gH,kBACxBh4C,OAAO,QAAS5oE,KAAK6gH,eAE1B7gH,KAAKgP,MAAM45D,OAAO,SAAU5oE,KAAK8/G,qBAC5Bl3C,OAAO,YAAa5oE,KAAK+/G,wBACzBn3C,OAAO,YAAa5oE,KAAKggH,uBAClC,EAEA1/G,QAAS,CACL0X,QAAS,MAIjB,SAASoyB,EAAa3f,GAClB,OAAc,MAAPA,EAAc,KAAOxqB,EAAMsN,YAAY68B,aAAa3f,EAC/D,CAEAxqB,EAAMsN,YAAY8xC,sBAAwBA,CAC7C,CAjPD,CAiPGp/C,OAEH,SAAUA,GAEF,IAAIuB,EAAIvB,EAAMwF,OACV8c,EAAStiB,EAAMqiB,GAAGC,OAClBE,EAAa,CACby+F,QAAS,YACTtwF,OAAQ,WACRuwF,eAAgB,oBAChBC,eAAgB,oBAChBz+F,KAAM,SACN0+F,iBAAkB,WAClBC,eAAgB,kBAChBC,eAAgB,SAChBC,QAAS,YACT9+F,QAAS,4BACT++F,kBAAmB,iCACnBC,cAAe,6BACfC,sBAAuB,uCACvBC,cAAe,aAGnB3hH,EAAMsN,YAAY0V,SAASi1D,WAAa,CACpCnzB,IAAK,MACL88D,cAAe,oBACfC,eAAgB,oBAChBJ,cAAe,kBACfD,kBAAmB,sBACnB55G,MAAO,QACPk6G,OAAQ,SACRC,aAAc,2BACdvhH,MAAO,QACP+9D,OAAQ,WACRyjD,aAAc,OACd3kD,IAAK,MACLwP,GAAI,KACJo1C,UAAW,CACP/oB,OAAQ,CACJt+D,SAAU,gBACVsnF,eAAgB,wBAChBC,WAAY,mBACZC,SAAU,iBACV17D,QAAS,eACT27D,aAAc,uBAElBpsE,KAAM,CACF/3B,GAAK,UACLokG,IAAK,cACL55G,GAAK,iBACLC,GAAK,iBAETgrD,OAAQ,CACJz1C,GAAI,cACJokG,IAAK,kBACLC,IAAK,8BACL55G,GAAI,kBACJ65G,IAAK,2BACL95G,GAAI,kBAKhB,IAAI+5G,EAAUngG,EAAOniB,OAAO,CACxBC,KAAM,SAAS+d,EAAS9d,GACpBiiB,EAAOhiB,GAAGF,KAAKG,KAAKR,KAAMoe,EAAS9d,GAEnCN,KAAKoe,QAAQoE,SAASs+D,EAAWr+D,WAAWy+F,SAE5ClhH,KAAK2iH,SAAW3iH,KAAKoe,QAAQwkB,KAAK,IAAMk+C,EAAWr+D,WAAW0+F,gBACzDv9F,GAAG,QAAS5jB,KAAKyrG,QAAQv8F,KAAKlP,OAEnC,IAAIwnF,EAAWlnF,EAAQm8C,SAAWqkC,EAAWr+D,WAAW4+F,iBAAmBvgC,EAAWr+D,WAAW6+F,eACjGthH,KAAK4iH,MAAQphH,EAAEvB,EAAMqiB,GAAGK,KAAK6kE,IACxB5kE,UAAU5iB,KAAK2iH,UAEpB3iH,KAAK6iH,WAAa5iH,EAAMsU,KAAKvU,KAAK2iH,SAAS1wE,QAAQ,GAE9C3xC,EAAQm8C,UACTz8C,KAAK6iH,WAAWn2F,MAExB,EACApsB,QAAS,CACL4L,KAAM,WAEVxL,OAAQ,CAAE,UACVspB,QAAS,WACL,OAAOhqB,KAAKM,QAAQm8C,QACxB,EACAnwB,OAAQ,SAASD,GACGpsB,EAAM6iH,GAAG9iH,KAAK6iH,YAAYE,OAAO,YAEvChmD,OAAO1wC,EAAO,UAAY,UACpCpsB,EAAMqiB,GAAGK,KAAK3iB,KAAK4iH,MAAO,CAAEjgG,KAAM0J,EAAOy0D,EAAWr+D,WAAW6+F,eAAiBxgC,EAAWr+D,WAAW4+F,mBAEtGrhH,KAAKM,QAAQm8C,UAAYpwB,CAC7B,EACAo/E,QAAS,WACL,IAAIp/E,EAAOrsB,KAAKgqB,UAChBhqB,KAAKssB,OAAOD,GACZrsB,KAAKkB,QAAQ,SAAU,CAAEmrB,KAAMA,GACnC,IAGJpsB,EAAMuK,KAAKw4G,QAAQC,uBAAyBhjH,EAAMuK,KAAK04G,OAAO9iH,OAAO,CACjEC,KAAM,SAAS+d,EAAS+kG,EAAU7iH,GAC9BL,EAAMuK,KAAK04G,OAAO3iH,GAAGF,KAAKG,KAAKR,KAAMoe,EAAS+kG,EAAU7iH,GAExDN,KAAK6rG,QAAU7rG,KAAKgoB,OAAO9Y,KAAKlP,MAChCwB,EAAExB,KAAKoe,SAASwF,GAAG,SAAU5jB,KAAK6rG,QACtC,EACA7hC,QAAS,WACL,IACI9nE,EADOlC,KACMmjH,SAASF,uBAAuBxgH,MAEjDjB,EAHWxB,KAGJoe,SAASqM,IAAIvoB,aAAiByD,KAAO,GAAKzD,EACrD,EACA8lB,OAAQ,WACJ,IAAI9lB,EAAQlC,KAAKoe,QAAQlc,MACzBlC,KAAKmjH,SAASF,uBAAuB3uF,IAAIpyB,EAC7C,IAGJjC,EAAMuK,KAAKw4G,QAAQ3R,OAAO4R,uBAAyBhjH,EAAMuK,KAAK04G,OAAO9iH,OAAO,CACxEC,KAAM,SAASgxG,EAAQ8R,EAAU7iH,GAC7BL,EAAMuK,KAAK04G,OAAO3iH,GAAGF,KAAKG,KAAKR,KAAMqxG,EAAOjzF,QAAQ,GAAI+kG,EAAU7iH,GAElEN,KAAKqxG,OAASA,EACdrxG,KAAK6rG,QAAU7rG,KAAKgoB,OAAO9Y,KAAKlP,MAChCA,KAAKqxG,OAAO3+E,MAAM,SAAU1yB,KAAK6rG,QACrC,EACA7hC,QAAS,WACL,IACI9nE,EADUlC,KAAKmjH,SAASF,uBACRxgH,MAChBiM,EAAOlN,EAAExB,KAAKqxG,OAAOjzF,SAAS5T,KAAK,cAEzB,SAATkE,GAAmBxM,aAAiByD,MAAmB,WAAT+I,IAAsB7B,MAAM3K,GAC3ElC,KAAKqxG,OAAOnvG,MAAMA,GAElBlC,KAAKqxG,OAAOnvG,MAAM,KAE1B,EACA8lB,OAAQ,WACJ,IAAI9lB,EAAQlC,KAAKqxG,OAAOnvG,QACVlC,KAAKmjH,SAASF,uBAEpB3uF,IAAIpyB,EAChB,IAGJ,IAAIkhH,EAAY,CACZ1B,cACI,eAAiBj/F,EAAW0+F,eAA5B,kDACiB1+F,EAAW2+F,eAD5B,4EAGQnhH,EAAMqiB,GAAGK,KAAK,CAAEA,KAAM,SAAU2pC,UAAW,iBAHnD,8ZAOqB7pC,EAAWk/F,sBAPhC,sMAcJF,kBACI,eAAiBh/F,EAAW0+F,eAA5B,sDACiB1+F,EAAW2+F,eAD5B,88BA2BJ9P,SACI,4FAGJsQ,cACI,uWAoBR,SAASzkG,EAAO+K,EAAYm7F,GAKxB,IAJA,IAAIC,GAAqB,EACrB94G,EAAO0d,aAAsBjoB,EAAMuK,KAAK+4G,wBAA0Br7F,EAAW1d,OAE7ErD,EAASnH,KAAKmH,OACT5D,EAAI,EAAGA,EAAIiH,EAAKnJ,OAAQkC,IAAK,CAClC,IAAIwqD,EAAOvjD,EAAKjH,GACZX,EAAOmrD,EAAKnrD,KAAKw1B,WAAWorF,kBAAkBvjH,EAAM60B,UAAU5oB,MAC9Du3G,GAAwB,IAAVJ,GAA4B,KAAVA,GAAgBzgH,EAAK2O,QAAQ8xG,IAAU,EAEvEK,EADevmG,EAAOjO,KANXlP,KAOU2jH,CAAa51D,EAAKvB,SAAU62D,GAErDC,EAAqBA,GAAsBI,GAAsBD,EACjE11D,EAAKzpB,QAAUm/E,IAAgBC,EAE3BL,EAAMhiH,QAAW8F,IAAWA,EAAO9F,OACnC0sD,EAAKk+C,SAAWl+C,EAAKzpB,OACdn9B,IAAwC,GAA9BA,EAAOoK,QAAQw8C,EAAKnrD,QACrCmrD,EAAKk+C,SAAU,EAEvB,CAOA,OALIzhG,GAEA0d,EAAW/K,OAAO,CAAEqP,MAAO,SAAUC,SAAU,MAAOvqB,OAAO,IAG1DohH,CACX,CAEA,SAASM,EAAW17F,GAGhB,IAFA,IAAI1d,EAAO0d,aAAsBjoB,EAAMuK,KAAK+4G,wBAA0Br7F,EAAW1d,OAExEjH,EAAI,EAAGA,EAAIiH,EAAKnJ,OAAQkC,IAAK,CAClC,IAAIwqD,EAAOvjD,EAAKjH,GAChBwqD,EAAKk+C,SAAU,EAEXl+C,EAAK81D,aACLD,EAAW71D,EAAKvB,SAExB,CACJ,CAEA,IAAIs3D,EAAsB7jH,EAAMsN,YAAYu2G,oBAAsB7jH,EAAMuK,KAAK4nG,iBAAiBhyG,OAAO,CACjG2jH,aAAc,SAAS17F,GACnB,IAWIlhB,GAXakhB,EAAIA,EAAEilC,OAAOplC,WAAaloB,KAAKgkH,kBAU1Bx5G,OACJqpB,SAAS,GAAGkmC,MAC1ByE,EAASr3D,EAAOgW,QAAO,SAAS4wC,GAChC,MAAyB,UAAlBA,EAAKrU,QAChB,IAEA8kB,IAASA,EAAOn9D,QAASm9D,EAAO,GAAGytC,QACnC9kG,EAASA,EAAOgW,QAhBF,SAAS4wC,GACnB,OAAOA,EAAKk+C,OAChB,IAcgC9pG,KAbpB,SAAS4rD,GACjB,MAAyB,SAAlBA,EAAKrU,SAAsBz5C,EAAMsN,YAAYsnB,aAAak5B,EAAK7rD,OAAS6rD,EAAK7rD,KACxF,IAaIlC,KAAKikH,gBAAkBjkH,KAAK+d,aAAe/d,KAAK+d,YAAY5W,OAAO9F,SACnE8F,EAASA,EAAOsM,OAAOzT,KAAK+d,YAAY5W,OAAO0sB,UAAU3wB,OAAOia,QAbvD,SAASjb,EAAOwI,EAAOqwC,GAChC,OAAOA,EAAMmpE,YAAYhiH,KAAWwI,CACxC,KAcA1K,KAAKs0B,IAAI,cAAe,CACpBntB,OAAQA,EACRq3D,OAAQA,GAEhB,EACA2lD,YAAa,SAAS97F,GAClBA,EAAEjP,iBAEF,IAAIwM,EAAOyC,EAAEilC,OAAO8tD,SAAS/yF,EAAEzC,MAC/BA,EAAK0O,IAAI,WAAY1O,EAAKqmF,QAC9B,EACAmY,iBAAiB,EACjBH,gBAAgB,EAChBI,aAAc,SAASh8F,GACnB,IAAIg7F,EAAoB,iBAALh7F,EAAgBA,EAAI7mB,EAAE6mB,EAAErW,QAAQyY,MAAM+4F,kBAAkBvjH,EAAM60B,UAAU5oB,MACvFgc,EAAaloB,KAAKgkH,iBAEtBhkH,KAAKs0B,IAAI,oBAAqB+uF,GAE9B,IAAIM,EAAexmG,EAAOjO,KAAKlP,KAAK+d,aACpC6lG,EAAW17F,GACXy7F,EAAaz7F,EAAYm7F,EAC7B,EACAzzG,MAAO,WACH5P,KAAKs0B,IAAI,eAAgB,CAAEgqC,MAAO,MAAOC,SAAU,CAAE,CAAE9xC,SAAU,KAAMvqB,MAAO,SAC9ElC,KAAKs0B,IAAI,cAAe,CAAEntB,OAAQ,IACtC,EACAm9G,eAAgB,SAASj8F,GACrB,IAAI+yF,EAAW/yF,EAAEilC,OAAO8tD,WACxBp7G,KAAKs0B,IAAI,eAAgB8mF,EAAS1sG,MAI7B1O,KAAKyC,IAAI,iBACVzC,KAAK4P,QAGT5P,KAAKs0B,IAAI,oCAAqC8mF,EAASl5G,MAC3D,EACAqiH,OAAQ,WACJ,YAAoCz3G,IAA7B9M,KAAKyC,IAAI,eACpB,EACA+hH,SAAU,WACN,MAAoC,WAA7BxkH,KAAKyC,IAAI,eACpB,EACA45G,SAAU,WACN,MAAoC,WAA7Br8G,KAAKyC,IAAI,eACpB,EACAg6G,OAAQ,WACJ,MAAoC,SAA7Bz8G,KAAKyC,IAAI,eACpB,IAGJ,SAASgiH,EAAiBvC,GACtB,IAAIj/F,EAAWhjB,EAAMsN,YAAY0V,SAASi1D,WAAWgqC,UACjDn8G,EAAS,GACb,IAAK,IAAI2I,KAAQwzG,EACb,GAAKA,EAAUnQ,eAAerjG,GAI9B,IAAK,IAAI+d,KAAYy1F,EAAUxzG,GACtBwzG,EAAUxzG,GAAMqjG,eAAetlF,IAIpC1mB,EAAOpF,KAAK,CACRiC,KAAMqgB,EAASvU,GAAM+d,GACrBvqB,MAAOuqB,EACPsH,OAAQrlB,EAAO,IAAM+d,EACrB/d,KAAMA,IAIlB,OAAO3I,CACX,CAEA,IAAI2+G,EAAuBzkH,EAAMsN,YAAYm3G,qBAAuB,CAChEC,WAAY,SAAS92G,EAAOyP,GACxB,MAAO,CAAC,CACJ1a,KAAM3C,EAAMsN,YAAY0V,SAASi1D,WAAWnzB,IAC5CtI,UAAU,EACVwvD,SAAS,EACTlyC,MAAO/5D,KAAKmH,OAAO0G,EAAM8M,OAAO,CAAEoF,IAAK,IAAMzC,IAErD,EACAnW,OAAQ,SAAS0G,EAAOyP,GACpB,IAAInW,EAAS,GACT8b,EAAWhjB,EAAMsN,YAAY0V,SAASi1D,WACtC14C,EAAc3xB,EAAMyP,OAAOA,GAC3BtO,EAAQnB,EAAMmB,QAgElB,OA9DAwwB,EAAYpqB,aAAY,SAAS1B,EAAK2B,EAAKvB,GACvC,IAAIm4F,GAAU,EACVj9F,EAAMi0B,YAAYvvB,KAClBu4F,GAAU,GAGd,IAAI/pG,EAAQ4R,EAAK5R,MACbw3C,EAAW5lC,EAAK4lC,SAChB92C,EAAOkR,EAAKlR,KAGZ82C,OADU5sC,IAAV5K,EACW,QACJ4R,EAAKwB,OACDrV,EAAMsN,YAAY2H,WAAWxG,KAAKxM,EAAO4R,EAAKwB,eAEvCpT,EAIlBU,EADU,OAAVV,GAAkB4R,EAAKwB,OAChBrV,EAAMsN,YAAY2H,WAAWtS,KAAKV,EAAO4R,EAAKwB,QAElC,SAAZokC,EAAsBz2B,EAASu7C,OAASt8D,EAGlC,YAAbw3C,GAAuC,aAAbA,IAC1BA,EAAW,UAGE,SAAbA,IACAx3C,EAAQjC,EAAMsN,YAAY68B,aAAaloC,IAG3CiF,EAAOxG,KAAK,CACR+4C,SAAUA,EACVx3C,MAAOA,EACPU,KAAMA,EACNqpG,QAASA,GAEjB,KAEA9kG,EAxNR,SAAwBA,GAIpB,IAHA,IAAI7D,EAAO,CAAC,EACRyC,EAAS,GAEJxC,EAAI,EAAGA,EAAI4D,EAAO9F,OAAQkC,IAC1BD,EAAK6D,EAAO5D,GAAGrB,QAGRoB,EAAK6D,EAAO5D,GAAGrB,OAAO+pG,SAAW9kG,EAAO5D,GAAG0oG,UACnD3oG,EAAK6D,EAAO5D,GAAGrB,OAAO+pG,SAAU,IAHhC3oG,EAAK6D,EAAO5D,GAAGrB,OAASiF,EAAO5D,GAC/BwC,EAAOpF,KAAKwG,EAAO5D,KAM3B,OAAOwC,CACX,CA0MiB6+G,CAAez9G,IAEjBjE,MAAK,SAASoI,EAAG4O,GACpB,OAAI5O,EAAEouC,WAAax/B,EAAEw/B,SACV,EAGQ,UAAfpuC,EAAEouC,UAAuC,UAAfx/B,EAAEw/B,SACN,UAAfpuC,EAAEouC,UAAwB,EAAI,EAGtB,WAAfpuC,EAAEouC,UAAwC,WAAfx/B,EAAEw/B,SACP,WAAfpuC,EAAEouC,UAAyB,EAAI,EAGvB,SAAfpuC,EAAEouC,UAAsC,SAAfx/B,EAAEw/B,SACL,SAAfpuC,EAAEouC,UAAuB,EAAI,EAGjC,CACX,IAEOvyC,CACX,EAEA09G,WAAY,SAASh3G,EAAOyP,GAExB,IAEI5O,EAFAM,EAAQnB,EAAMmB,QACdmO,EAASnd,KAAK8kH,gBAAgBxnG,EAAQtO,GAK1C,IAFAmO,EAASA,GAAUA,EAAOA,OAAO0W,WAEF,UAAjB1W,EAAOA,OAAoB,CACrC,IAAIjb,EAAQib,EAAOohD,SAAS,GAAGr8D,MAE3BA,aAAiByD,KACjB+I,EAAO,OACgB,iBAATxM,EACdwM,EAAO,SACgB,iBAATxM,IACdwM,EAAO,SAEf,CAEA,IAAKA,EAAM,CAEP,IAAIq2G,EAAW/kH,KAAKmH,OAAO0G,EAAM6F,IAAI,GAAI4J,GAAQ,GAGrC,UAFZ5O,EAAOq2G,GAAYA,EAASrrE,YAGxBhrC,EAAO,KAEf,CAEA,OAAOA,CACX,EAEAo2G,gBAAiB,SAASxnG,EAAQtO,GAC9B,IACIytD,EADAuoD,EAAah2G,EAAMmO,SASvB,OANI6nG,IACAvoD,EAAWuoD,EAAWhtG,QAAQmF,QAAO,SAAS4wC,GAC1C,OAAOA,EAAKrjD,QAAU4S,CAC1B,IAAG,IAGAm/C,CACX,EAEAt/C,OAAQ,SAASG,EAAQtO,GACrB,IAAIi2G,EAAgBjlH,KAAK8kH,gBAAgBxnG,EAAQtO,GAEjD,GAAKi2G,EAAL,CAIA,IAAI3kH,EAAU2kH,EAAc9nG,OAAO0W,SAC/BnlB,EAAOpO,EAAQ6c,cAEZ7c,EAAQ6c,OAEf,IAAIpX,EAAS,CACT2I,KAAMA,EACNpO,QAASA,GAGTi+D,EAAWj+D,EAAQi+D,SAKvB,OAJIA,GAAYA,EAASl9D,SACrB0E,EAAO0mB,SAAW8xC,EAAS,GAAG9xC,UAG3B1mB,CAjBP,CAkBJ,GAGA+6E,EAAav+D,EAAOniB,OAAO,CAC3BC,KAAM,SAAS+d,EAAS9d,GACpBiiB,EAAO/hB,KAAKR,KAAMoe,EAAS9d,GAE3BN,KAAKoe,QAAQoE,SAASs+D,EAAWr+D,WAAWC,SAE5C1iB,KAAKq5G,UAAY,IAAIyK,EAAoB,CACrCl1F,OAAQ,QACRnC,SAAU,KACVy1F,UAAWuC,EAAiBzkH,KAAKM,QAAQ4hH,WACzCzhH,MAAOT,KAAKS,MAAMyO,KAAKlP,MACvB6H,MAAO7H,KAAK6H,MAAMqH,KAAKlP,QAG3BA,KAAKklH,cACLllH,KAAKikB,SACLjkB,KAAK2lD,QACL3lD,KAAKmlH,qBACLnlH,KAAKolH,iBACLplH,KAAKqlH,gBACT,EAEA/kH,QAAS,CACL4L,KAAM,aACNoR,OAAQ,EACRzP,MAAO,KACPq0G,UAAW,CACP/oB,OAAQ,CACJt+D,SAAU,gBACVsnF,eAAgB,wBAChBC,WAAY,mBACZC,SAAU,iBACV17D,QAAS,eACT27D,aAAc,uBAElBpsE,KAAM,CACF/3B,GAAK,UACLokG,IAAK,cACL55G,GAAK,iBACLC,GAAK,iBAETgrD,OAAQ,CACJz1C,GAAI,cACJokG,IAAK,kBACLC,IAAK,8BACL55G,GAAI,kBACJ65G,IAAK,2BACL95G,GAAI,kBAKhBjI,OAAQ,CACJ,UAGJwiB,QAAS,WACLX,EAAOhiB,GAAG2iB,QAAQ1iB,KAAKR,MAEvBA,KAAKq1E,KAAKnyD,UACVljB,KAAKslH,eAAepiG,UACpBljB,KAAK+oB,MAAM7F,SACf,EAEAk1D,QAAS,SAASjvD,EAAQ5Q,GAClB/W,EAAE2nB,GAAQo8F,SAAS,2BAInBvlH,KAAK+oB,MAAMK,KAAK7Q,EAAMsY,MAAOtY,EAAMwY,QAEnC/wB,KAAK+oB,MAAMkgE,WAAW,CAAE9/D,OAAQA,IAChCnpB,KAAK+oB,MAAMK,OAEnB,EAEAJ,MAAO,WACHhpB,KAAK+oB,MAAMC,OACf,EAEAvoB,MAAO,WACHT,KAAK8gC,OAAO,CACRlgC,QAAS,qBACTN,QAAS,CACLgd,OAAQtd,KAAKM,QAAQgd,UAG7Btd,KAAKq5G,UAAUzpG,QACf5P,KAAKgpB,OACT,EAEAnhB,MAAO,WACH7H,KAAKwlH,UAEL,IAKIznG,EACAE,EANA3d,EAAU,CACVyjD,eAAgB/jD,KAAKM,QAAQuN,MAC7ByP,OAAQtd,KAAKM,QAAQgd,QAMK,UAA1Btd,KAAKq5G,UAAUzqF,QACf5uB,KAAKq5G,UAAU0K,aAAa,CAAEz2D,OAAQttD,KAAKslH,mBAC3CvnG,EAAc/d,KAAKq5G,UAAUt7F,YAAY8V,UAEzB2qC,QAAWzgD,EAAY5W,QAAU4W,EAAY5W,OAAO9F,UAChEf,EAAQyd,YAAcA,IAEO,WAA1B/d,KAAKq5G,UAAUzqF,SACtB3Q,EAAeje,KAAKq5G,UAAUp7F,aAAa4V,UAE1B0qC,SAASl9D,QAA6C,OAAnC4c,EAAasgD,SAAS,GAAGr8D,QACzD5B,EAAQ2d,aAAeA,IAI3B3d,EAAQyd,aAAezd,EAAQ2d,eAC/Bje,KAAK8gC,OAAO,CAAElgC,QAAS,qBAAsBN,QAASA,GAE9D,EAEAwgC,OAAQ,SAASxgC,GACbN,KAAKkB,QAAQ,SAAUM,EAAEpB,OAAO,CAAE,EAAGE,GACzC,EAEA4kH,YAAa,WACT,IAAI5nG,EAAStd,KAAKM,QAAQgd,OACtBzP,EAAQ7N,KAAKM,QAAQuN,MACrBmB,EAAQnB,EAAMmB,QACdy2G,EAAef,EAAqBvnG,OAAOG,EAAQtO,GAEvD,GAAIy2G,EAAc,CACd,IAAIZ,EAAaH,EAAqBG,WAAWh3G,EAAOyP,GAExDtd,KAAKq5G,UAAU/kF,IAAI,SAAUmxF,EAAa/2G,MAC1C1O,KAAKq5G,UAAU/kF,IAAImxF,EAAa/2G,KAAO,SAAU+2G,EAAanlH,SAErC,UAArBmlH,EAAa/2G,OACb1O,KAAKq5G,UAAU/kF,IAAI,WAAYuwF,EAAa,IAAMY,EAAah5F,UAC/DzsB,KAAKq5G,UAAU/kF,IAAI,eAAgBuwF,GAE3C,MACI7kH,KAAKq5G,UAAUzpG,OAEvB,EAEAqU,OAAQ,WACJjkB,KAAK+oB,MAAQ/oB,KAAKoe,QAAQ0qE,WAAW,CACjC48B,kBAAkB,IACnBl7G,KAAK,aACZ,EAEAm7C,MAAO,WACH,IAAIv9B,EAAWnoB,EAAMmoB,SAAS04D,EAAWsiC,UAAU9R,UAC/CruF,EAAWhjB,EAAMsN,YAAY0V,SAASi1D,WACtCne,EAAQ,CACR,CAAEn5D,QAAS,OAAQ+kH,IAAK,MAAO/iH,KAAMqgB,EAAS4+F,cAAev1D,UAAW,YACxE,CAAE1rD,QAAS,OAAQ+kH,IAAK,OAAQ/iH,KAAMqgB,EAAS6+F,eAAgBx1D,UAAW,cAG1EjC,EAAK7oD,EAAE,YAAa,CACpB2sB,KAAQluB,EAAM+nD,OAAO5/B,EAAU2xC,KAChC/2C,SAAShjB,KAAKoe,SAEjBpe,KAAKq1E,KAAOhrB,EAAGu7D,UAAU,CACrBjQ,YAAa,WACb3nG,OAAQ,SAASqa,GACb,IAEI/nB,EAAU,CACV4B,MAHMV,EAAE6mB,EAAE0lC,MAAMvjD,KAAK,OAIrBwE,OAAO,EACP+0C,eAJQ/jD,KAAKM,QAAQuN,MAAM8M,OAAO,CAAEoF,IAAK,IAKzCzC,OAAQtd,KAAKM,QAAQgd,QAGzBtd,KAAK8gC,OAAO,CAAElgC,QAAS,cAAeN,QAASA,GACnD,EAAE4O,KAAKlP,QACRwK,KAAK,YACZ,EAEAq7G,gBAAiB,SAASz9F,EAAU0d,EAAWo7E,EAASzkE,GACpD,IAAIqpE,EAAmB7lH,EAAMmoB,SAASA,GAClC1F,EAAUlhB,EAAE,eAAiBskC,EAAY,OAAO3X,KAAK23F,EAAiB,CACtE7iG,SAAUhjB,EAAMsN,YAAY0V,SAASi1D,WACrC5wD,KAAMrnB,EAAMqnB,OACZnE,GAAIljB,EAAMkjB,MAWd,OARAnjB,KAAKoe,QAAQk/D,OAAO56D,GAEhBw+F,IACAA,EAAU,IAAIwB,EAAQhgG,EAAS,CAAE+5B,SAAUA,EAAUnwB,OAAQtsB,KAAK+lH,cAAc72G,KAAKlP,SAGzFC,EAAMiP,KAAKwT,EAAS1iB,KAAKq5G,WAElB32F,CACX,EAEAqjG,cAAe,SAAS19F,GACpBroB,KAAKoe,QACAwkB,KAAK,IAAM3iC,EAAMwjB,KAAK,QAAU,aAChCuiG,IAAI39F,EAAEilC,OAAOlvC,SACb5T,KAAK,gBACL8hB,QAAQjE,EAAEgE,KACnB,EAEA84F,mBAAoB,WAChB,IAAIc,EAAuC,WAA1BjmH,KAAKq5G,UAAUzqF,OAChC5uB,KAAK6lH,gBAAgB/kC,EAAWsiC,UAAU3B,kBAAmB3gC,EAAWr+D,WAAWg/F,mBAAmB,EAAMwE,EAChH,EAEAb,eAAgB,WACZ,IAAIa,EAAuC,UAA1BjmH,KAAKq5G,UAAUzqF,OAC5BlM,EAAU1iB,KAAK6lH,gBAAgB/kC,EAAWsiC,UAAU1B,cAAe5gC,EAAWr+D,WAAWi/F,eAAe,EAAMuE,GAElHjmH,KAAKslH,eAAiB5iG,EAAQkgB,KAAK,IAAM3iC,EAAMwjB,KAAK,QAAU,cAAcjZ,KAAK,iBAEjF,IAAIrD,EAASu9G,EAAqBC,WAAW3kH,KAAKM,QAAQuN,MAAO7N,KAAKM,QAAQgd,QAE9Etd,KAAKq5G,UAAU/kF,IAAI,mBAAoB,IAAIr0B,EAAMuK,KAAK+4G,uBAAuB,CAAE/4G,KAAMrD,EAAQmlF,uBAAwBrsF,EAAM60B,UAAU5oB,OACzI,EAEAm5G,eAAgB,WACZrlH,KAAK6lH,gBAAgB/kC,EAAWsiC,UAAUxB,cAAe9gC,EAAWr+D,WAAWm/F,eAAe,EAClG,EAEA4D,QAAS,WACL,IAAIU,EAAkBlmH,KAAKoe,QAAQwkB,KAAK,IAAM3iC,EAAMwjB,KAAK,QAAU,aAAatG,QAAO,SAASzS,EAAO0T,GACnG,OAAO5c,EAAE4c,GAAS5T,KAAK,gBAAgBwf,SAC3C,IAEIk8F,EAAgBX,SAASzkC,EAAWr+D,WAAWi/F,eAC/C1hH,KAAKq5G,UAAU/kF,IAAI,SAAU,SACtB4xF,EAAgBX,SAASzkC,EAAWr+D,WAAWg/F,oBACtDzhH,KAAKq5G,UAAU/kF,IAAI,SAAU,SAErC,IAGJr0B,EAAMsN,YAAYuzE,WAAaA,EAC/Bt/E,EAAEpB,QAAO,EAAM0gF,EAAY,CAAEr+D,WAAYA,EAAY2gG,UAAWA,GAEnE,CAvvBL,CAuvBO3hH,OAAOxB,OAEd,SAAUA,GAEN,IAAIw9E,EAAcx9E,EAAME,WAAWC,OAAO,CACtCC,KAAM,SAAS0pB,GACX9pB,EAAME,WAAWI,GAAGF,KAAKG,KAAKR,MAE9BA,KAAK+pB,KAAOA,EACZ/pB,KAAKg+E,WAAaj0D,EAAKi0D,WACvBh+E,KAAKwlH,SAAU,EAEfxlH,KAAKmmH,SAAWp8F,EAAKi0D,WAAWl7D,aAChC9iB,KAAKomH,UAAYr8F,EAAKjH,aAEtB9iB,KAAKmmH,SAASv4F,SAAS5tB,KAAKomH,WAC5BpmH,KAAKomH,UAAUx4F,SAAS5tB,KAAKmmH,UAE7BnmH,KAAKmmH,SAASj3G,KAAK,QAASlP,KAAKqmH,eAAen3G,KAAKlP,OACrDA,KAAKomH,UAAUl3G,KAAK,QAASlP,KAAKqmH,eAAen3G,KAAKlP,OAEtDA,KAAKmmH,SAASj3G,KAAK,OAAQlP,KAAKqkB,MAAMnV,KAAKlP,OAC3CA,KAAKomH,UAAUl3G,KAAK,OAAQlP,KAAKqkB,MAAMnV,KAAKlP,MAChD,EAEAU,OAAQ,CACJ,WACA,aACA,SACA,UAGJ2jB,MAAO,WACHrkB,KAAK2yE,YACT,EAEA0zC,eAAgB,WACZrmH,KAAKkB,QAAQ,SAAU,CAAEgB,MAAOlC,KAAKkC,SACzC,EAEAo0E,aAAc,WACV,IAAInF,EAAS,KACTm1C,EAAgBrmH,EAAMssB,iBAQ1B,OANIvsB,KAAKqyE,aAAa,KAAOi0C,EACzBn1C,EAASnxE,KAAKmmH,SACPnmH,KAAKuyE,cAAc,KAAO+zC,IACjCn1C,EAASnxE,KAAKomH,WAGXj1C,CACX,EAEAj6D,SAAU,SAAS5W,GACf,IACIimH,EAAWC,EAAiBC,EAD5BC,EAAc1mH,KAAK+pB,KAAK3L,QAuB5B,OApBApe,KAAKwlH,SAAU,EACfxlH,KAAK2mH,MAAQrmH,EAAQk4E,KACrBx4E,KAAK+N,OAASzN,EAAQuN,MAEtB7N,KAAKomH,UAAUt6F,SAASxrB,EAAQk4E,MAChCx4E,KAAKomH,UAAUzrG,OAAOra,EAAQk4E,MAC9Bx4E,KAAKomH,UAAUj6F,QAAQ7rB,EAAQ6rB,SAC/BnsB,KAAKomH,UAAUjvG,WAAanX,KAAKmmH,SAAShvG,WAAanX,KAAK+N,OAAO8C,UACnE7Q,KAAKomH,UAAU1tG,YAAc1Y,KAAKmmH,SAASztG,YAAc1Y,KAAK+N,OAAOsB,OAElEq3G,IACCH,EAAYG,EAAYviH,QAExBsiH,GADAD,EAAkBE,EAAY9jF,KAAK,2BAA2B,IAC7B39B,YAAcuhH,EAAgBnmC,YAE/DrgF,KAAKomH,UAAUhoG,QAAQsF,IAAI,YAAa6iG,EAAYE,EAAiBzmH,KAAKomH,UAAUhoG,QAAQ0N,WAAWrM,KAAO,OAGlHzf,KAAKkB,QAAQ,YAENlB,IACX,EAEA2yE,WAAY,SAASi0C,GACjB,IAAIR,EAAYpmH,KAAKomH,UAEhBpmH,KAAKwlH,UAIVxlH,KAAKwlH,SAAU,EAEVoB,GAAYR,EAAUlkH,SAAWlC,KAAKiS,QACvCjS,KAAKkB,QAAQ,SAAU,CACnBgB,MAAOkkH,EAAUlkH,QACjB2L,MAAO7N,KAAK+N,SAIpB/N,KAAK2mH,MAAQ,KACbP,EAAU15F,OACV1sB,KAAKkB,QAAQ,cACjB,EAEAgS,OAAQ,SAASA,GACblT,KAAKmmH,SAASjzG,OAAOA,GACrBlT,KAAKomH,UAAUlzG,OAAOA,EAC1B,EAEAm/D,WAAY,WACR,OAAOryE,KAAKmmH,SAAS/nG,OACzB,EAEAm0D,YAAa,WACT,OAAOvyE,KAAKomH,UAAUhoG,OAC1B,EAEA3C,MAAO,SAASorG,GAGM,UAFlBA,EAAYA,GAAa,SAGrB7mH,KAAKomH,UAAUhoG,QAAQld,QAAQ,SAC/BlB,KAAKomH,UAAU5gG,OAEfxlB,KAAKmmH,SAAS/nG,QAAQld,QAAQ,QAEtC,EAEAwqB,SAAU,WACN,OAAO1rB,KAAKwlH,OAChB,EAEA5sC,WAAY,WACR,OAAO54E,KAAKmmH,SAASp9F,MAAMiB,WAAahqB,KAAKomH,UAAUr9F,MAAMiB,SACjE,EAEA4C,aAAc,SAASC,GACnB,IAAIskD,EAASnxE,KAAKs2E,eAClB,OAAOnF,GAAUA,EAAOvkD,aAAaC,EACzC,EAEAyB,gBAAiB,WACb,IAAI6iD,EAASnxE,KAAKs2E,eACd9iE,EAAO,GAMX,OAJI29D,IACA39D,EAAO29D,EAAO7iD,mBAGX9a,CACX,EAEAqQ,MAAO,WACH7jB,KAAKomH,UAAUviG,OACnB,EAEAuI,cAAe,SAASosD,GA+B5B,IAAkBsuC,EAASC,EA9BnB/mH,KAAKomH,UAAUh6F,eA8BL06F,EA9B4B9mH,KAAK2mH,MA8BxBI,EA9B+BvuC,EA+B/CsuC,IAAYA,EAAQ/mG,MAAQgnG,EAAQhnG,KAAO+mG,EAAQrnG,OAASsnG,EAAQtnG,OA9B3E,EAEAvd,MAAO,SAASA,EAAO45D,GACnB,QAAchvD,IAAV5K,EACA,OAAOlC,KAAKmmH,SAASjkH,QAGX,OAAVA,IACAA,EAAQ,IAGZlC,KAAKiS,OAAS/P,EAEdlC,KAAKmmH,SAASjkH,MAAMA,GACpBlC,KAAKomH,UAAUlkH,MAAMA,GAErBlC,KAAKmmH,SAAS/nG,QAAQyG,YAAY,gCAAiCi3C,EACvE,EAEA1sC,cAAe,WACXpvB,KAAKs2E,eAAelnD,gBACpBpvB,KAAK6jB,OACT,EAEA7V,OAAQ,WACJhO,KAAKs2E,eAAetoE,QACxB,IAOJ/N,EAAMsN,YAAYkwE,YAAcA,CACnC,CA3LD,CA2LGx9E,OAKC,IAAI+mH,GAAgB/mH,MAAMsN,YACtBuP,GAAQkqG,GAAclqG,MAEtB4vB,GADUs6E,GAAcvyG,KAAKuS,QACX0lB,QAElBu6E,GAAmB,qBAGnBlqG,GAAYD,GAAMC,UAAY,SAAS7R,GACvClL,KAAKmJ,KAAO+B,CAChB,EAoGA,SAASg8G,GAAiB18G,GAMtB,IALA,IAAIggG,EAAIhgG,EAAKnJ,OACToiG,GAAM+G,EAAI,GAAK,EAAG9G,EAAKl5F,EAAKqsB,QAAO,SAASvrB,EAAG4O,GAC/C,OAAO5O,EAAI4O,CACf,GAAG,GAAKswF,EACJ1G,EAAK,EAAGjM,EAAK,EACRt0F,EAAI,EAAGA,EAAIinG,EAAGjnG,IAAK,CACxB,IAAI4mC,EAAM5mC,EAAI,EAAKkgG,EACnBK,GAAM35D,GADsB3/B,EAAKjH,GAAKmgG,GAEtC7L,GAAM1tD,EAAKA,CACf,CACA,IAAK0tD,EACD,OAAO,SAAS2S,GACZ,OAAOhgG,EAAKggG,EAAIhgG,EAAKnJ,OACzB,EAEJ,IAAI6Y,EAAI4pF,EAAKjM,EAAIvsF,EAAIo4F,EAAKxpF,EAAIupF,EAC9B,OAAO,SAAS+G,GACZ,OAAOl/F,EAAI4O,GAAKswF,EAAI,EACxB,CACJ,CAEA,SAAS2c,GAAWrxF,GAUhB,SAASvL,EAAQjf,GACb,OAAOA,EAAEnJ,KAAI,SAASqE,GAClB,OAAOA,EAAEotD,MACb,GACJ,CACA,IAAInlC,EAAS,GACTjkB,EAAOsrB,EAAW3zB,KAAI,SAASsE,GAC/B,OAAOA,EAAEwvB,SAAWxvB,EAAEvE,KAC1B,IA0DA,OA+BJ,SAAuBsI,EAAMjD,GAEzB,IADA,IAAoCmH,EAAhC5H,EAAO,KAAMirB,EAAQ,EAAGzmB,EAAI,GACvB/H,EAAI,EAAGA,EAAIiH,EAAKnJ,SAAUkC,EAC/BmL,EAAO04G,GAAQ58G,EAAKjH,IACpB+H,EAAE3K,KAAK+N,GACK,MAAR5H,GAAgB4H,EAAKA,OAAS5H,EAAK4H,OACnCnH,EAAEwqB,EAAOxuB,EAAGuD,EAAK4H,KAAMpD,EAAExK,MAAMixB,EAAOxuB,IACtCwuB,EAAQxuB,GAEZuD,EAAO4H,EAEXnH,EAAEwqB,EAAOxuB,EAAGuD,EAAK4H,KAAMpD,EAAExK,MAAMixB,EAAOxuB,GAC1C,CApGI8jH,CAAc78G,GAAM,SAAS+a,EAAOC,EAAK9W,EAAMpD,GAC3C,IAAI/D,EAAGJ,EACP,GAAY,UAARuH,EAYAnH,EAAI2/G,GAXJ//G,EAASojB,EAAQjf,SAYd,GAAY,UAARoD,GAA4B,WAARA,GAA6B,WAARA,EAEhDnH,EAAI,SAASijG,EAAGjnG,GACZ,OAAOiH,EAAKjH,EAChB,OACG,GAAIu3B,MAAM4T,QAAQhgC,GACrB,GAAgB,GAAZpD,EAAEjK,OACFkG,EAAI,SAASijG,GACT,OAAO97F,GAAMpD,EAAE,GAAGsoD,OAAS42C,GAAK97F,EAAKrN,OACzC,MACG,CAEH,IAAI4wB,EA7ChB,SAAkB3mB,GAEd,IADA,IAAI2mB,EAAO3mB,EAAE,GAAKA,EAAE,GACX/H,EAAI,EAAGA,EAAI+H,EAAEjK,SAAUkC,EAC5B,GAAI+H,EAAE/H,GAAK+H,EAAE/H,EAAE,IAAM0uB,EACjB,OAAO,KAGf,OAAOA,CACX,CAqCuBq1F,CAAS/8F,EAAQjf,IAGxB/D,EAFQ,MAAR0qB,EAEI,SAASu4E,GACT,OAAOl/F,EAAE,EAAMA,EAAEjK,QAAQa,KAC7B,EAEI,SAASsoG,GACT,IAAIt/C,EAAM5/C,EAAE,GAAGsoD,OAAS3hC,EAAOu4E,EAC/B,OAAO97F,EAAKw8C,EAAMx8C,EAAKrN,OAC3B,CAER,KACe,QAARqN,GAEc,IADrBvH,EAASojB,EAAQjf,IACNjK,QACP8F,EAAOxG,KAAKwG,EAAO,GAAK,GAE5BA,EAAS+/G,GAAiB//G,GAC1BI,EAAI,SAASijG,EAAGjnG,GACZ,OAAOiH,EAAKjH,GAAGT,QAAQ,iBAAkB,KAAOqE,EAAOqjG,EAAGjnG,GAC9D,GAEAgE,EAAI,WAAa,OAAO,IAAM,EAGlC,IADA,IAAIspC,EAAI,CAAEtpC,EAAGA,EAAGge,MAAOA,EAAOC,IAAKA,EAAKqB,IAAKrB,EAAMD,GAC1ChiB,EAAIgiB,EAAOhiB,EAAIiiB,IAAOjiB,EAC3BkrB,EAAOlrB,GAAKstC,CAEpB,IACO,SAAS25D,EAAGjnG,GACf,IAsBS4E,EACT8T,EAvBI40B,EAAIpiB,EAAOlrB,GACXy9F,EAAIwJ,EAAIhgG,EAAKnJ,OAAS,EACtBgF,EAAImkG,EAAIhgG,EAAKnJ,OACb4F,EAAI+5F,EAAInwD,EAAEhqB,IAAMxgB,EAAIwqC,EAAEtrB,MACtBrjB,EAAQ2uC,EAAEtpC,EAAEN,EAAG1D,GACfoZ,GAiBKxU,EAjBW2tB,EAAWvyB,GAkB/B0Y,EAAO,CAAC,EACZxU,OAAO2b,KAAKjb,GAAO,CAAC,GAAG2G,SAAQ,SAAS7M,GACpCga,EAAKha,GAAOkG,EAAIlG,EACpB,IACOga,GAfH,cANOU,EAAMzJ,OACThR,aAAiBwqC,GACjB/vB,EAAMsZ,QAAU/zB,EAEhBya,EAAMza,MAAQA,EAEXya,CACX,CACJ,CA8BA,SAASyqG,GAAQtgG,GACb,GAAiB,iBAANA,EACP,MAAO,CAAEpY,KAAM,SAAUklD,OAAQ9sC,GAErC,GAAiB,iBAANA,EAAgB,CACvB,IAAIygG,EAkCZ,SAAwBlkH,GAGpB,IAFA,IAAImkH,EAAOnkH,EAAIiD,cACXyvB,GAXAjB,WAAU70B,MAAM60B,UACb,CACHA,EAAQg8D,UAAUC,SAASC,KAAKC,UAChCn8D,EAAQg8D,UAAUC,SAASC,KAAKrsB,MAChC7vC,EAAQg8D,UAAUC,SAAS9C,OAAOgD,UAClCn8D,EAAQg8D,UAAUC,SAAS9C,OAAOtpB,QAO7BphE,EAAI,EAAGA,EAAIwyB,EAAM10B,SAAUkC,EAEhC,IADA,IAAI+H,EAAIyqB,EAAMxyB,GACLsH,EAAIS,EAAEjK,SAAUwJ,GAAK,GAAI,CAE9B,GADSS,EAAET,GAAGvE,eACJkhH,EACN,MAAO,CAAE94G,KAAMpD,EAAGsoD,OAAQ/oD,EAAG3I,MAAOmB,EAE5C,CApBR,IACQyxB,CAqBR,CA9CkB2yF,CAAe3gG,GACzB,GAAIygG,EACA,OAAOA,EAEX,IAAI1gH,EAAI,eAAeoH,KAAK6Y,GAC5B,OAAIjgB,EAEO,CAAE6H,KADToY,EAAKA,EAAGhkB,QAAQ,aAAc,aACXoe,MAAOra,EAAG+sD,OAAQC,WAAWhtD,EAAE,KAE/C,CAAE6H,KAAM,SACnB,CACA,GAAiB,kBAANoY,EACP,MAAO,CAAEpY,KAAM,WAEnB,GAAU,MAANoY,EACA,MAAO,CAAEpY,KAAM,QAEnB,GAAIoY,aAAc4lB,GACd,MAAO,CAAEh+B,KAAM,WAGnB,MADAjN,OAAO+yC,QAAQ/F,MAAM3nB,GACf,IAAI3b,MAAM,mBACpB,CA0BA,SAASulC,GAAUplC,GAGf,IAFA,IAAIlH,EAASkH,EAAEjK,OAAQ8C,EAAQmH,EAAE,GAAGjK,OAChCiwC,EAAI,GACC/tC,EAAI,EAAGA,EAAIY,IAASZ,EAAG,CAC5B+tC,EAAE/tC,GAAK,GACP,IAAK,IAAIsH,EAAI,EAAGA,EAAIzG,IAAUyG,EAC1BymC,EAAE/tC,GAAGsH,GAAKS,EAAET,GAAGtH,EAEvB,CACA,OAAO+tC,CACX,CA7SAx0B,GAAM9J,UAAU0J,iBAAmB,SAASgrG,EAAU1mF,GAClD,IAAI2mF,EAAY3nH,KAAMgP,EAAQ24G,EAAUt4G,OACjB,iBAAZq4G,IACPA,EAAW14G,EAAMnB,MAAM65G,IAE3B,IAAIniE,EAAMmiE,EAAS74G,KAAKI,aAAaQ,QAAQ+d,SAASxe,EAAM9C,QACxD0Q,EAAO+qG,EAAU94G,KAAKI,aAAaQ,QAAQ+d,SAASxe,EAAM9C,QAE9D,GAAIq5C,EAAIpzB,WAAWvV,GAAO,CAGtB,GAAI2oC,EAAIpnC,GAAGvB,GACP,OAAO,KAGX,GADAA,EAAOA,EAAKnN,QACR81C,EAAI10C,QAAQsN,GAAGvB,EAAK/L,SACpB,GAAI00C,EAAIphD,SAAWyY,EAAKzY,QACpByY,EAAK/L,QAAQ6C,KAAO6xC,EAAInhD,SACxB48B,EAAY,MACT,IAAIukB,EAAInhD,UAAYwY,EAAKxY,SAI5B,MAAM,IAAI2Y,GAAUkqG,IAHpBrqG,EAAK/L,QAAQwE,KAAOkwC,EAAIphD,QACxB68B,EAAY,CAGhB,KACG,KAAIukB,EAAIhrC,YAAY4D,GAAGvB,EAAKrC,aAW/B,MAAM,IAAIwC,GAAUkqG,IAVpB,GAAI1hE,EAAIphD,SAAWyY,EAAKzY,QACpByY,EAAKrC,YAAY7G,KAAO6xC,EAAInhD,SAC5B48B,EAAY,MACT,IAAIukB,EAAInhD,UAAYwY,EAAKxY,SAI5B,MAAM,IAAI2Y,GAAUkqG,IAHpBrqG,EAAKrC,YAAYlF,KAAOkwC,EAAIphD,QAC5B68B,EAAY,CAGhB,CAGJ,CACA,OAAOhyB,EAAMnB,MAAM+O,GAAMF,iBAAiBgrG,EAAU1mF,EACxD,CAEA,GAAiB,MAAbA,EAEA,GAAIukB,EAAI10C,QAAQwE,KAAOuH,EAAK/L,QAAQwE,IAEhC2rB,EAAYukB,EAAI10C,QAAQ6C,IAAMkJ,EAAK/L,QAAQ6C,IAAM,EAAI,MAClD,IAAI6xC,EAAI10C,QAAQ6C,KAAOkJ,EAAK/L,QAAQ6C,IAGvC,MAAM,IAAIqJ,GA1DC,mBAwDXikB,EAAYukB,EAAI10C,QAAQwE,IAAMuH,EAAK/L,QAAQwE,IAAM,EAAI,CAGzD,CAEJ,IAAIuxD,EAAyB,EAAZ5lC,EACb60D,EAAyB,EAAZ70D,EACjB,GAAK4lC,GAAcrhB,EAAInhD,UAAYwY,EAAKxY,WAClCwiE,GAAcrhB,EAAIphD,SAAWyY,EAAKzY,QACpC,MAAM,IAAI4Y,GAAUkqG,IAExB,IAAmChgH,EAA/BuD,EAAOk9G,EAAS7qG,cACf+pD,EAID3/D,EAAI2V,EAAKzY,SAHTqG,EAAOkmC,GAAUlmC,GACjBvD,EAAI2V,EAAKxY,UAMb,IAFA,IAAIkhE,EAAO,IAAIxqC,MAAMtwB,EAAKnJ,QACtBgiC,EAAO,KACF9/B,EAAI,EAAGA,EAAIiH,EAAKnJ,SAAUkC,EAI/B,IAHA,IAAIstC,EAAIrmC,EAAKjH,GACTgE,EAAI4/G,GAAWt2E,GACfvlC,EAAIg6D,EAAK/hE,GAAK,IAAIu3B,MAAM7zB,GACnB4D,EAAI,EAAGA,EAAI5D,IAAK4D,EAAG,CACxB,IAAIqgD,EAAM2qC,GAAchrF,EAAI,EAAIgmC,EAAExvC,OAASwJ,EACvC+8G,EAAS/xB,EAAahlD,EAAExvC,OAAUwJ,EAAIgmC,EAAExvC,OAAU,EAAKwJ,EAAIgmC,EAAExvC,OAC7DyS,EAAOxI,EAAEuqF,EAAa5uF,EAAI4D,EAAI,EAAIA,GAAKtD,EAAE2jD,EAAK08D,GAChC,MAAd9zG,EAAK5R,QACLmhC,EAAOvvB,EAAK5R,MAEpB,CAKJ,OAHK0kE,IACDtB,EAAO50B,GAAU40B,IAEd,CAAE3oD,MAAO2oD,EAAMtkC,UAAWA,EAAWpkB,KAAM+qG,EAAWtkF,KAAMA,EACvE,EAEAvmB,GAAM9J,UAAU60G,SAAW,SAASH,EAAU1mF,GAC1C,IAAIv6B,EAAIzG,KAAK0c,iBAAiBgrG,EAAU1mF,GAExC,OADAv6B,EAAEmW,KAAKC,YAAYpW,EAAEkW,OAAO,GACrBlW,EAAEmW,IACb,EAqNJ,SAAU3c,GAEN,IAAIuB,EAAIvB,EAAMwF,OAEVqiH,EACO,4BAIPvpC,EAAat+E,EAAMqiB,GAAGC,OAAOniB,OAAO,CACpCC,KAAM,SAAS+d,EAAS9d,GACpBL,EAAMqiB,GAAGC,OAAO/hB,KAAKR,KAAMoe,EAAS9d,GACpC8d,EAAQoE,SAASslG,GAEjB,IAAIC,EAAgBznH,EAAQ2iB,SAASs4D,SAAW,WAC5CrzD,EAAa,IAAIjoB,EAAMuK,KAAK4c,WAAW,CACvC4gG,UAAW,CACPv+B,KAAM,SAASnpF,GACX,IAAIkK,EAAO,GACXxK,KAAKwN,UAAUm9D,aAAY,SAAS1U,IAC3BA,EAAI3xB,QAAU2xB,EAAI/zD,iBAAiBjC,EAAMsN,YAAYkwB,KACtDjzB,EAAK7J,KAAK,CAAEuL,KAAM+pD,EAAI/pD,MAE9B,IACA5L,EAAQ2nH,QAAQz9G,EACpB,EAAE0E,KAAKlP,MACPwH,OAAO,KAIX0gH,EAAe1mH,EAAE,aAChBiiB,KAAK,QAASskG,GACdtkG,KAAK,aAAcskG,GAExB/nH,KAAKmoH,MAAQD,EAAallG,SAAS5E,GAC9BgqG,cAAc,CACXzY,aAAa,EACb/wB,cAAe,OACfz2D,eAAgB,OAChBC,SAAU,mEAAqEnoB,EAAMqiB,GAAGK,KAAK,KAAO,OACpGuF,WAAYA,EACZJ,UAAU,EACVugG,YAAY,EACZrgG,OAAQhoB,KAAKsoH,eAAep5G,KAAKlP,MACjCuoH,eAAgB,cAChBn/F,KAAM,WACFlB,EAAWuhE,MACf,IACD++B,mBAEPxoH,KAAKmoH,MAAM7zG,MACNsP,GAAG,UAAW5jB,KAAKyoH,YAAYv5G,KAAKlP,OACpC4jB,GAAG,QAAS5jB,KAAK0oH,UAAUx5G,KAAKlP,OAErCA,KAAKmoH,MAAMp/F,MAAM3K,QACZoE,SAAS,6BAEToB,GAAG,aAAa,SAASyF,GAItBA,EAAGyhC,iBACP,IAEClnC,GAAG,QAAS,mBAAoB,SAASyF,GACtCA,EAAGjQ,iBACHiQ,EAAGyhC,kBACH,IAAIiD,EAAOvsD,EAAE6nB,EAAGrX,QAAQi7C,QAAQ,gBAChCc,EAAO/tD,KAAKmoH,MAAM/M,SAASrtD,GAC3B/tD,KAAK2oH,YAAY56D,EAAK7hD,KAC1B,EAAEgD,KAAKlP,MACf,EACAkjB,QAAS,WACDljB,KAAKmoH,OACLnoH,KAAKmoH,MAAMjlG,UAGfjjB,EAAMqiB,GAAGC,OAAOhiB,GAAG2iB,QAAQ1iB,KAAKR,KACpC,EACAkC,MAAO,SAASuoB,GACZ,QAAY3d,IAAR2d,EACA,OAAOzqB,KAAKmoH,MAAMjmH,QAElBlC,KAAKmoH,MAAMjmH,MAAMuoB,EAEzB,EACAk+F,YAAa,SAASz8G,GAClBlM,KAAKkB,QAAQ,SAAU,CAAEgL,KAAMA,GACnC,EACAu8G,YAAa,SAASp/F,GAClB,OAAQA,EAAGI,SACT,KAAK,GACHzpB,KAAKmoH,MAAMjmH,MAAMlC,KAAK4oH,YACtB5oH,KAAKkB,QAAQ,UACb,MACF,KAAK,GACHlB,KAAKkB,QAAQ,SAGrB,EACAwnH,UAAW,WACP1oH,KAAK4oH,WAAa5oH,KAAKmoH,MAAMjmH,OACjC,EACAomH,eAAgB,WACZ,IAAIp8G,EAAOlM,KAAKmoH,MAAMjmH,QAClBgK,GACAlM,KAAKkB,QAAQ,SAAU,CAAEgL,KAAMA,GAEvC,IAGJjM,EAAMsN,YAAYgxE,WAAaA,CAClC,CAhHD,CAgHG98E,OAAOxB,OAIN,IAslBI4oH,GAtlBAt7G,GAActN,MAAMsN,YACpBowB,GAAUpwB,GAAYowB,QACtBmrF,GAAO7oH,MAAMsP,QACb2F,GAAa3H,GAAY2H,WACzB6zG,GAAM9oH,MAAM+oH,SAEZC,GAAkB,GAoBtB,SAASC,GAAiBC,EAASC,EAAYC,EAAUC,EAAYC,GACjE,IAAIC,EAAO,EACPvgH,EAAM,GACN+W,EAASopG,EACTK,EAAS,EAyBb,OAxBIL,GAAcC,IACdA,GAAYD,GAEhBD,EAAQr6G,SAAQ,SAASkhC,EAAGzsC,GACN,MAAd+lH,GAAsB/lH,EAAI+lH,IAC1BG,GAAUz5E,GAEVo5E,GAAcI,EAAOx5E,EAAIhwB,IACrBA,EAASwpG,EAAOH,IAEhBG,EAAOJ,EAAa34G,KAAK4jF,KAAKm1B,EAAOJ,GAAcK,EAC/CA,EAAS,GACTF,EAAa5oH,KAAK6oH,EAAOC,IAMjCzpG,GAAUopG,EAAa34G,KAAK4jF,KAAKrkD,EAAIo5E,IAEzCngH,EAAItI,KAAK6oH,GACTA,GAAQx5E,CACZ,IACA/mC,EAAItI,KAAK6oH,GACFvgH,CACX,CAEA,SAASi9E,GAASl3E,EAAOnB,EAAOvN,GAE5B,IAAIu9B,EAAO7uB,EAAM8uB,MACjBjwB,EAAQgwB,EAAKnD,UAAU7sB,GAEvB,IAAI67G,EAAY7rF,EAAKlR,UAAU9e,GAC3B8D,EAAW,GACf3C,EAAMsC,UAAUxC,SAAQ,SAASlI,GAC7B,IAAInC,EAAMuK,EAAMy0C,mBAAmB78C,GAC/BnC,EAAI0tB,WAAWu3F,IACf/3G,EAAShR,KAAK,CACV4O,QAAS3I,EACTnC,IAAKA,EAAIu4E,QAAQ0sC,EAAUjqG,MAAOiqG,EAAU3pG,MAGxD,IAOA,IAAI1I,EAAQ,GACRsyG,EAAa,GACbC,EAAY,GACZ9hF,EAAc94B,EAAM88B,gBAAgBj+B,GAEpC42C,GAAU,EAAGC,GAAU,EAC3B11C,EAAMF,QAAQjB,GAAO,SAAS6F,EAAK2B,EAAKvB,GACpC,IAAI+1G,EAASn2G,EAAM7F,EAAMgD,QAAQ6C,IAC7Bo2G,EAASz0G,EAAMxH,EAAMgD,QAAQwE,IAC7B00G,EAAK/6G,EAAMqD,UAAUqB,GACrBs2G,EAAKh7G,EAAMmD,YAAYkD,GACtB/U,EAAQ6lF,YAITryE,EAAKnC,SAAWA,EAASwL,QAAO,SAASvW,GACrC,IAAI2zB,EAAK3zB,EAAE2I,QAAQqB,YACnB,GAAI2pB,GAAMA,EAAG7mB,KAAOA,GAAO6mB,EAAGllB,KAAOA,EAGjC,OAFAovC,EAASh0C,KAAKmK,IAAI6pC,EAAQz1C,EAAMwL,MAAM9P,MAAM9D,EAAEnC,IAAIub,SAClD0kC,EAASj0C,KAAKmK,IAAI8pC,EAAQ11C,EAAM0L,SAAShQ,MAAM9D,EAAEnC,IAAIkb,SAC9C,CAEf,KAECmqG,GACDH,EAAWhpH,KAAKopH,GAEfF,GACDD,EAAUjpH,KAAKqpH,GAEnB,IAAIriH,EAAK,IAAIg2B,GAAQjqB,EAAK2B,GAAKoY,QAC/B,IAAIqa,EAAYkE,UAAUrkC,GAA1B,CAGAmM,EAAKJ,IAAMm2G,EACX/1G,EAAKuB,IAAMy0G,EACX,IAAIjjH,EAAIihC,EAAYiE,QAAQpkC,GAc5B,GAbId,UACOihC,EAAYiE,QAAQpkC,GAC3BmM,EAAKsvB,QAAS,EACdtvB,EAAKuwE,QAAUx9E,EAAEzC,SACjB0P,EAAKswE,QAAUv9E,EAAE1C,QACb7D,EAAQ6lF,YACRryE,EAAK3P,MAAQ6K,EAAM0L,SAASoyB,IAAIjmC,EAAEgK,QAAQwE,IAAKxO,EAAE0T,YAAYlF,KAC7DvB,EAAK1P,OAAS4K,EAAMwL,MAAMsyB,IAAIjmC,EAAEgK,QAAQ6C,IAAK7M,EAAE0T,YAAY7G,QAG/DI,EAAKuwE,QAAU,EACfvwE,EAAKswE,QAAU,GAEdp1E,EAAM8uB,MAAMpjB,SAASoyB,IAAIz3B,EAAKA,EAAMvB,EAAKswE,QAAU,IACnDp1E,EAAM8uB,MAAMtjB,MAAMsyB,IAAIp5B,EAAKA,EAAMI,EAAKuwE,QAAU,GADrD,CAIA,IAAI4lC,EAAW3pH,EAAQ6lF,WA+K/B,SAAwBryE,GACpB,OAAqB,MAAdA,EAAK5R,OACL4R,EAAKsvB,QACc,MAAnBtvB,EAAK80B,YACe,MAApB90B,EAAKyC,aACgB,MAArBzC,EAAK+C,cACY,MAAjB/C,EAAK8mE,UACe,MAAnB9mE,EAAKkN,aAAuBlN,EAAKkN,WAAW9e,OAC5C4R,EAAKnC,UAAYmC,EAAKnC,SAAStQ,MAC3C,CAxL4C6oH,CAAep2G,IAC7CxT,EAAQ6pH,YAAcF,KAGxBA,GACAxlE,EAASh0C,KAAKmK,IAAI6pC,EAAQolE,EAAS/1G,EAAKuwE,QAAU,GAClD3/B,EAASj0C,KAAKmK,IAAI8pC,EAAQolE,EAASh2G,EAAKswE,QAAU,IAElDtwE,EAAKqpB,OAAQ,EAEjB9lB,EAAM1W,KAAKmT,GAXX,CApBA,CAgCJ,IAEKxT,EAAQ6lF,YAETwjC,EAAaA,EAAW7oH,MAAM,EAAG2jD,EAAS,GAC1CmlE,EAAYA,EAAU9oH,MAAM,EAAG4jD,EAAS,IAG5C,IAAI0lE,EAAY9pH,EAAQ8pH,UACpBhB,EAAa9oH,EAAQ8oH,WACrBiB,EAAc/pH,EAAQujB,OAAS,EAKnC,GAAIvjB,EAAQw9G,SAAU,CAClB,IAAI35G,EAAQylH,EAAU/yF,OAAOiW,GAAK,GAC9B3oC,EAAQimH,IACRC,EAAcD,EAAYjmH,EAElC,CACAimH,EAAY35G,KAAK4jF,KAAK+1B,EAAYC,GAClCjB,EAAa34G,KAAK4jF,KAAK+0B,EAAaiB,GASpC,IAAIC,EAAW,GACXhkC,EAAU4iC,GAAiBS,EAAYP,GAAc,EAAG9oH,EAAQ+oH,SACrC/oH,EAAQgpH,WAAYgB,GAC/ClkC,EAAU8iC,GAAiBU,EAAWQ,GAAa,EAAG9pH,EAAQ+oH,UAC9DkB,EAAW,EACXC,EAAY,EACZC,EAAc,GA2FlB,OA1FApzG,EAAQA,EAAM8F,QAAO,SAASrJ,GAC1B,QAAIA,EAAKqpB,SAAUrpB,EAAKJ,IAAM+wC,GAAU3wC,EAAKuB,IAAMqvC,MAG/CpkD,EAAQgpH,YAAcx1G,EAAKJ,IAAMpT,EAAQgpH,YACzCmB,EAAY9pH,KAAKmT,GAErBA,EAAK2L,KAAO2mE,EAAQtyE,EAAKuB,KACzBvB,EAAKiM,IAAMumE,EAAQxyE,EAAKJ,KACpBI,EAAKsvB,OACA9iC,EAAQ6lF,WAMTryE,EAAK6L,MAAQ7L,EAAK2L,KAAO3L,EAAK3P,MAC9B2P,EAAKkM,OAASlM,EAAKiM,IAAMjM,EAAK1P,SAN9B0P,EAAK6L,MAAQ+qG,GAAOtkC,EAAStyE,EAAKuB,IAAMvB,EAAKswE,SAC7CtwE,EAAKkM,OAAS0qG,GAAOpkC,EAASxyE,EAAKJ,IAAMI,EAAKuwE,SAC9CvwE,EAAK3P,MAAQ2P,EAAK6L,MAAQ7L,EAAK2L,KAC/B3L,EAAK1P,OAAS0P,EAAKkM,OAASlM,EAAKiM,MAMrCjM,EAAK3P,MAAQylH,EAAU91G,EAAKuB,KAC5BvB,EAAK1P,OAASulH,EAAW71G,EAAKJ,KAC9BI,EAAKkM,OAASlM,EAAKiM,IAAMjM,EAAK1P,OAC9B0P,EAAK6L,MAAQ7L,EAAK2L,KAAO3L,EAAK3P,OAE7B7D,EAAQ6lF,WAGTryE,EAAKnC,SAAS7C,SAAQ,SAASlI,GAC3B,IAAInC,EAAMmC,EAAEnC,IACZA,EAAIgb,KAAO3L,EAAK2L,KAAO7Y,EAAE2I,QAAQuB,QACjCrM,EAAIsb,IAAMjM,EAAKiM,IAAMnZ,EAAE2I,QAAQwB,QAC/BtM,EAAIkb,MAAQlb,EAAIgb,KAAOhb,EAAIN,MAC3BM,EAAIub,OAASvb,EAAIsb,IAAMtb,EAAIL,MAC/B,IAEJmmH,EAAW95G,KAAKmK,IAAI2vG,EAAUz2G,EAAK6L,OACnC6qG,EAAY/5G,KAAKmK,IAAI4vG,EAAW12G,EAAKkM,SAC9B,EACX,IAKAvY,OAAO2b,KAAK0kB,EAAYiE,SAASj9B,SAAQ,SAASnH,GAC9C,IAAIoH,EAAM+4B,EAAYiE,QAAQpkC,GAC9BqH,EAAMF,QAAQC,EAAI8B,QAAQ5B,cAAc,SAASyE,EAAK2B,EAAKvB,GACvD,IAAI+1G,EAASn2G,EAAM7F,EAAMgD,QAAQ6C,IAC7Bo2G,EAASz0G,EAAMxH,EAAMgD,QAAQwE,IACjCvB,EAAKsvB,QAAS,EACdtvB,EAAKswE,QAAUr1E,EAAI5K,QACnB2P,EAAKuwE,QAAUt1E,EAAI3K,SAEf0P,EAAKiM,IADL8pG,EAAS,GACG76G,EAAMwL,MAAMsyB,IAAIp5B,EAAKA,EAAMm2G,EAAS,GAErCvjC,EAAQujC,GAGnB/1G,EAAK2L,KADLqqG,EAAS,GACI96G,EAAM0L,SAASoyB,IAAIz3B,EAAKA,EAAMy0G,EAAS,GAExC1jC,EAAQ0jC,GAExBh2G,EAAK1P,OAAS4K,EAAMwL,MAAMsyB,IAAI/9B,EAAI8B,QAAQ6C,IAAK3E,EAAIwL,YAAY7G,KAC/DI,EAAK3P,MAAQ6K,EAAM0L,SAASoyB,IAAI/9B,EAAI8B,QAAQwE,IAAKtG,EAAIwL,YAAYlF,KAC7DvB,EAAK1P,OAAS,GAAK0P,EAAK3P,MAAQ,IAGhC2P,EAAK6L,MAAQ7L,EAAK2L,KAAO3L,EAAK3P,MAC9B2P,EAAKkM,OAASlM,EAAKiM,IAAMjM,EAAK1P,OAC9B0P,EAAKJ,IAAMm2G,EACX/1G,EAAKuB,IAAMy0G,EACXzyG,EAAM1W,KAAKmT,GAEnB,GACJ,IAGIxT,EAAQgpH,aACRgB,EAASx7G,SAAQ,SAASgiB,GACtB25F,EAAY37G,SAAQ,SAASgF,IACzBA,EAAOrE,GAAMqE,IACRiM,KAAO+Q,EACZhd,EAAKkM,OAASlM,EAAKiM,IAAMjM,EAAK1P,OAC9BiT,EAAM1W,KAAKmT,EACf,IACAwyE,EAAQ3lF,KAAKmwB,EACjB,IACAw1D,EAAQpjF,KAAKynH,KAGV,CACHxmH,MAAWomH,EACXnmH,OAAWomH,EACXnzG,MAAWA,EAAMnU,KAAK0nH,IACtB/mG,MAAWwmG,EACXjkC,QAAWA,EACXE,QAAWA,EACX30E,SAAWA,EAEnB,CAEA,SAASlC,GAAMnM,EAAM0O,GAIjB,OAHKA,IACDA,EAAS,CAAC,GAEVvK,OAAOojH,OACApjH,OAAOojH,OAAO74G,EAAQ1O,GAE1BmE,OAAO2b,KAAK9f,GAAMuzB,QAAO,SAAS5a,EAAMha,GAE3C,OADAga,EAAKha,GAAOqB,EAAKrB,GACVga,CACX,GAAGjK,EACP,CAEA,SAAS84G,GAAWx/G,EAAG4O,GACnB,OAAO5O,EAAE1J,OAASsY,EAAEtY,MAAQ0J,EAAEsK,QAAUsE,EAAEtE,KAC9C,CAEA,SAASk3B,GAAIxhC,EAAG4O,GACZ,OAAO5O,EAAI4O,CACf,CAEA,SAASwwG,GAAOp/G,EAAG/H,GACf,OAAOA,EAAI+H,EAAEjK,OAASiK,EAAE/H,GAAK+H,EAAEA,EAAEjK,OAAS,EAC9C,CAaA,SAASupH,GAAWt/G,EAAG4O,GACnB,OAAI5O,EAAEyU,IAAM7F,EAAE6F,KACF,EACDzU,EAAEyU,KAAO7F,EAAE6F,IACdzU,EAAEmU,KAAOvF,EAAEuF,MACH,EACDnU,EAAEmU,MAAQvF,EAAEuF,KACZ,EAEA,EAGJ,CAEf,CAEA,SAASkrG,GAAYr/G,EAAG4O,GACpB,OAAO5O,EAAI4O,GAAK,EAAI5O,EAAI4O,EAAI,EAAI,CACpC,CAEA,SAAS6wG,GAAW/7G,EAAOe,EAAQy8D,EAAOlsE,GAYtC,IALA,IAAI0qH,EAAQv6G,KAAK4jF,KAAKtkF,EAAO5L,MAAQ7D,EAAQ8pH,WACzCa,EAAQx6G,KAAK4jF,KAAKtkF,EAAO3L,OAAS9D,EAAQ8oH,YAC1CgB,EAAY35G,KAAK4jF,KAAK/zF,EAAQ8pH,UAAYr6G,EAAO8T,OACjDulG,EAAa34G,KAAK4jF,KAAK/zF,EAAQ8oH,WAAar5G,EAAO8T,OAE9ChZ,EAAI,EAAGA,EAAIogH,IAASpgH,EACzB,IAAK,IAAItH,EAAI,EAAGA,EAAIynH,IAASznH,EACzB2nH,EAAQrgH,EAAGtH,GAInB,SAAS2nH,EAAQx3G,EAAK2B,GAClB,IAAIoK,EAAOpK,EAAM+0G,EACbzqG,EAAQF,EAAO2qG,EACfrqG,EAAMrM,EAAM01G,EACZppG,EAASD,EAAMqpG,EACf+B,EAAY,EAAGC,EAAW,EAE9B,SAASC,EAAS5mH,GACd,QAAIA,EAAIkb,OAASF,GAAQhb,EAAIgb,MAAQE,GACjClb,EAAIub,QAAUD,GAAOtb,EAAIsb,KAAOC,KAGpCmrG,EAAY16G,KAAKmK,IAAInW,EAAIub,OAAQmrG,GACjCC,EAAW36G,KAAKmK,IAAInW,EAAIkb,MAAOyrG,IACxB,EACX,CAKA,IAAI/zG,EAAQtH,EAAOsH,MAAM8F,OAAOkuG,GAE5B15G,EAAW5B,EAAO4B,SAASwL,QAAO,SAASvW,GAC3C,OAAOykH,EAASzkH,EAAEnC,IACtB,IAMA,GAHA0mH,EAAY16G,KAAKC,IAAIy6G,EAAWnrG,GAChCorG,EAAW36G,KAAKC,IAAI06G,EAAUzrG,GAE1BtI,EAAMhW,QAAUsQ,EAAStQ,OAAQ,CACjC,IAAIiqH,EAAO,IAAIxC,GAAKyC,MACpB/+C,EAAM8Q,OAAOguC,GAKb,IAAI5sC,EAAU,IAAIoqC,GAAKyC,MACvBD,EAAKhuC,OAAOoB,GAEZA,EAAQ8sC,KAAK1C,GAAK2C,KAAKC,SACnB,IAAI3C,GAAI4C,KAAK,CAAElsG,EAAO,EAAGM,EAAM,GAAK,CAAEqrG,EAAW,EAAGD,EAAY,MAGpE,IAAIv3B,EAASm1B,GAAIzhF,OAAOzjB,MAAM9T,EAAO8T,MAAO9T,EAAO8T,OAC9C+nG,aAAa7C,GAAIzhF,OAAOgwE,WAAW73F,GAAOM,IAY/C,IAVIzf,EAAQ49G,SAAW59G,EAAQ69G,WAC3BvqB,EAASA,EAAOg4B,aACZ7C,GAAIzhF,OAAOgwE,UACPh3G,EAAQ49G,SAAWv+F,EAAQyrG,GAAY,EAAI,EAC3C9qH,EAAQ69G,SAAWn+F,EAASmrG,GAAa,EAAI,KAIzDzsC,EAAQsI,UAAU4M,GAEdtzF,EAAQs1G,WAAY,CACpB,IAAI9uG,EAAO,KACXiJ,EAAOq2E,QAAQt3E,SAAQ,SAASrI,IAC5BA,EAAIgK,KAAKC,IAAIjK,EAAG2kH,MACNtkH,GAAQL,GAAKgZ,GAAQhZ,GAAKkZ,IAChC7Y,EAAOL,EACPi4E,EAAQpB,QACJ,IAAIwrC,GAAK2C,MACJI,OAAOplH,EAAGsZ,GACV+rG,OAAOrlH,EAAG0kH,GACVniG,QACA+iG,OAAOzrH,EAAQ0rH,WAAY/C,KAG5C,IACIniH,EAAO,KACXiJ,EAAOu2E,QAAQx3E,SAAQ,SAASgiB,IAC5BA,EAAIrgB,KAAKC,IAAIogB,EAAGq6F,MACNrkH,GAAQgqB,GAAK/Q,GAAO+Q,GAAK9Q,IAC/BlZ,EAAOgqB,EACP4tD,EAAQpB,QACJ,IAAIwrC,GAAK2C,MACJI,OAAOpsG,EAAMqR,GACbg7F,OAAOV,EAAUt6F,GACjB9H,QACA+iG,OAAOzrH,EAAQ0rH,WAAY/C,KAG5C,GACJ,CAEA,IAAIxgF,EAAU89C,KACdlvE,EAAMvI,SAAQ,SAASgF,IAsDnC,SAAkBA,EAAM4qE,EAASp+E,GAC7B,IAAIm1D,EAAI,IAAIqzD,GAAKyC,MACjB7sC,EAAQpB,OAAO7nB,GACf,IAAI+iB,EAAO,IAAIuwC,GAAI4C,KAAK,CAAE73G,EAAK2L,KAAM3L,EAAKiM,KAClB,CAAEjM,EAAK3P,MAAO2P,EAAK1P,SAC3C,GAAI0P,EAAK80B,YAAc90B,EAAKsvB,OAAQ,CAChC,IAAI6oF,EAAOzzC,EACPl4E,EAAQs1G,cACRqW,EAAOzzC,EAAK/oE,SACP6M,OAAO7V,GAAKwiH,GAAgB,EAAI,GACrCgD,EAAK3vG,OAAOwU,GAAKm4F,GAAgB,EAAI,GACrCgD,EAAKrqH,KAAKuC,OAAS8kH,GAAkB,GACrCgD,EAAKrqH,KAAKwC,QAAU6kH,GAAkB,IAE1CxzD,EAAE6nB,OACE,IAAIwrC,GAAK6C,KAAKM,GACT3mD,KAAKxxD,EAAK80B,YAAc,QACxBmjF,OAAO,MAEpB,CACIj4G,EAAK8mE,WACoB,EAArB9mE,EAAK8mE,SAASlsE,MACd+mD,EAAE6nB,QACE,IAAIwrC,GAAK2C,MACJI,OAAO/3G,EAAK2L,KAAM3L,EAAKkM,QACvB8rG,OAAOh4G,EAAK6L,MAAO7L,EAAKiM,KACxBgsG,OAAOj4G,EAAK8mE,SAAShlE,MAAO9B,EAAK8mE,SAASh5E,OAG9B,EAArBkS,EAAK8mE,SAASlsE,MACd+mD,EAAE6nB,QACE,IAAIwrC,GAAK2C,MACJI,OAAO/3G,EAAK2L,KAAM3L,EAAKiM,KACvB+rG,OAAOh4G,EAAK6L,MAAO7L,EAAKkM,QACxB+rG,OAAOj4G,EAAK8mE,SAAShlE,MAAO9B,EAAK8mE,SAASh5E,QAI3D,IAAI6oB,EAAM3W,EAAK5R,MACf,GAAW,MAAPuoB,EAAa,CACb,IAAI/b,EAAqB,iBAAP+b,EAAkB,SAAW,KAC3C+gG,EAAO,IAAI1C,GAAKyC,MACpBC,EAAKA,KAAK1C,GAAK2C,KAAKC,SAASlzC,IAC7B/iB,EAAE6nB,OAAOkuC,GACT,IAAIjkH,EAAG+N,EAASxB,EAAKwB,OAarB,GAZKA,GAAkB,UAAR5G,GAAoB+b,GAAOha,KAAKgnB,MAAMhN,KACjDnV,EAAS,oBAETA,GAEAmV,GADAljB,EAAI2N,GAAWi9E,aAAa1nE,EAAKnV,IACzB1S,KACJ2E,EAAEmH,OACFA,EAAOnH,EAAEmH,OAGb+b,GAAO,IAEN3W,EAAK+0B,UACN,OAAQn6B,GACN,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,WACHoF,EAAK+0B,UAAY,QACjB,MACF,IAAK,UACH/0B,EAAK+0B,UAAY,UAgCjC,SAAkBjmC,EAAMgT,EAAO9B,EAAM04D,GAC5Bq8C,MACDA,GAAOjlH,SAASC,cAAc,QACzBC,MAAMgoB,SAAW,QACtB+8F,GAAK/kH,MAAM2b,KAAO,MAClBopG,GAAK/kH,MAAMic,IAAM,MACjB8oG,GAAK/kH,MAAMioB,WAAa,SACxB88F,GAAK/kH,MAAMqrG,SAAW,SACtB0Z,GAAK/kH,MAAMooH,UAAY,aACvBrD,GAAK/kH,MAAMqoH,WAAa,SACxBvoH,SAASoB,KAAKD,YAAY8jH,KAG1BA,GAAK/iG,YACL+iG,GAAKxjH,YAAYwjH,GAAK/iG,YAG1B+iG,GAAK/kH,MAAMsoH,QAAU,UACrBvD,GAAK/kH,MAAM8R,MAAQA,EACnBizG,GAAK/kH,MAAMuhE,KAoCf,SAAqBvxD,GACjB,IAAIuxD,EAAO,GACPvxD,EAAKk1B,QACLq8B,EAAK1kE,KAAK,UAEVmT,EAAKm1B,MACLo8B,EAAK1kE,KAAK,QAId,OAFA0kE,EAAK1kE,MAAMmT,EAAK60B,UAAY,IAAM,MAClC08B,EAAK1kE,KAAMmT,EAAKm5B,YAAc,SACvBo4B,EAAKliE,KAAK,IACrB,CA/CsBkpH,CAAYv4G,GAC9B+0G,GAAK/kH,MAAMK,MAAQ2P,EAAK3P,MAAQ,KAChC0kH,GAAK/kH,MAAM+kC,UAAY/0B,EAAK+0B,WAAa,OACzCggF,GAAK/kH,MAAM22E,eAAiB3mE,EAAKnB,UAAY,YAAc,OAE3D0oE,GAAYvnE,EAAM+0G,GAAK/kH,OAEnBgQ,EAAKS,MACLs0G,GAAK/kH,MAAMkoB,WAAa,WACxB68F,GAAK/kH,MAAMo3E,aAAe2tC,GAAK/kH,MAAMq3E,SAAW,eAEhD0tC,GAAK/kH,MAAMkoB,WAAa,MACxB68F,GAAK/kH,MAAMo3E,aAAe2tC,GAAK/kH,MAAMq3E,SAAW,UAGpD0tC,GAAK9jH,YAAYnB,SAAS0oH,eAAe1pH,IAEzC,IAAI2pH,EAAS,EACb,OAAQz4G,EAAKg1B,eACX,IAAK,SACHyjF,EAAUz4G,EAAK1P,OAASykH,GAAK3jH,cAAiB,EAC9C,MAEF,UAAK4H,EACL,KAAK,KACL,IAAK,SACHy/G,EAAUz4G,EAAK1P,OAASykH,GAAK3jH,aAG7BqnH,EAAS,IAAKA,EAAS,GAE3B,IAAIC,EAAcvsH,MAAMsP,QAAQk9G,QAAQC,SAAS7D,IACjD2D,EAAWxlC,UAAU+hC,GAAIzhF,OAAOgwE,UAAUxjG,EAAK2L,KAAM3L,EAAKiM,IAAMwsG,IAChE//C,EAAM8Q,OAAOkvC,EACjB,CAjFQE,CAASjiG,EAAMljB,GAAKA,EAAEqO,OAAU9B,EAAK8B,OAAS,OAAQ9B,EAAM03G,EAChE,CACJ,CA7HgBnxC,CAASvmE,EAAM4qE,EAASp+E,GACxBmoC,EAAQsG,IAAIj7B,EAAM9E,EACtB,IAEA,IAAI29G,EAAe,IAAI7D,GAAKyC,MAC5B9iF,EAAQo+C,KAAK/3E,SAAQ,SAASxD,GAC1BA,EAAEwD,SAAQ,SAASoL,GACVA,EAAE4sE,WACH5sE,EAAE4sE,UAAW,EACb6lC,EAAarvC,QACT,IAAIwrC,GAAK2C,MACJI,OAAO3xG,EAAEzT,EAAGyT,EAAE6F,KACd+rG,OAAO5xG,EAAEzT,EAAGyT,EAAE8F,QACdgJ,QACA+iG,OAAO7xG,EAAEtE,MAAOsE,EAAEtY,OAGnC,GACJ,IACA6mC,EAAQw+C,MAAMn4E,SAAQ,SAASxD,GAC3BA,EAAEwD,SAAQ,SAASoL,GACVA,EAAE4sE,WACH5sE,EAAE4sE,UAAW,EACb6lC,EAAarvC,QACT,IAAIwrC,GAAK2C,MACJI,OAAO3xG,EAAEuF,KAAMvF,EAAE4W,GACjBg7F,OAAO5xG,EAAEyF,MAAOzF,EAAE4W,GAClB9H,QACA+iG,OAAO7xG,EAAEtE,MAAOsE,EAAEtY,OAGnC,GACJ,IACA88E,EAAQpB,OAAOqvC,GAEfh7G,EAAS7C,SAAQ,SAASlI,GACtB,IAAI2I,EAAU3I,EAAE2I,QACZU,EAAQV,EAAQU,MACpB,GAAa,MAATA,EAAe,CACf,IAAIxL,EAAMmC,EAAEnC,IACRwmE,EAAMj8D,EAAMxB,UAAUk/D,SAASz8D,GACnCyuE,EAAQpB,OACJ,IAAIwrC,GAAKnyC,MAAM1L,EAAK,IAAI89C,GAAI4C,KACxB,CAAElnH,EAAIgb,KAAMhb,EAAIsb,KAChB,CAAEtb,EAAIN,MAAOM,EAAIL,UAClB4M,QAAQzB,EAAQyB,SAE3B,CACJ,GACJ,CACJ,CACJ,CA4EA,SAASqqE,GAAYvnE,EAAMhQ,GACvB,GAAIgQ,EAAKmrD,OAAQ,CAKb,IAAIA,EAAS,IAAMnrD,EAAKmrD,OACxB,OAAQn7D,EAAM+kC,WACZ,KAAK,KACL,IAAK,OACH/kC,EAAM8oH,YAAc3tD,EAAS,KAC7B,MACF,IAAK,QACHn7D,EAAM+oH,aAAe5tD,EAAS,KAC9B,MACF,IAAK,SACHn7D,EAAM8oH,YAAc3tD,EAAO,EAAI,KAC/Bn7D,EAAM+oH,aAAe5tD,EAAO,EAAI,KAGxC,CACJ,CAuEA,SAAS3xB,GAAKt+B,EAAOnB,EAAOvN,EAASsO,GAClB,MAAXtO,GAA+B,MAAZsO,IACnBA,EAAWf,EACXvN,EAAU,CAAC,EACXuN,EAAQN,GAAYgwB,UAER,MAAZ3uB,IACAA,EAAWtO,EACPuN,aAAiBN,GAAYuP,OAC1BjP,aAAiBN,GAAYkwB,KACb,iBAAT5vB,EACVvN,EAAU,CAAC,GAEXA,EAAUuN,EACVA,EAAQN,GAAYgwB,WAG5Bj9B,EAAUL,MAAMwF,OAAOrF,OAAO,CAC1Bq1G,UAAa,KACbwI,WAAa,EACb/I,OAAa,MACbU,YAAa,EACboW,WAAa,OACb7B,YAAa,EACbrM,UAAa,EACbjI,QAAa,EACbyT,WAAa,KACbD,SAAa,GACbxlG,MAAa,GACdvjB,GACH,IAAIksE,EAAQ,IAAIs8C,GAAKyC,MACjBjX,EAAQr0G,MAAM4hB,IAAIirG,gBAAgBxsH,GACtCksE,EAAMlsE,QAAQg0B,IAAI,MAAO,CACrB6rC,OAAY7/D,EAAQ6/D,OACpB09C,QAAYv9G,EAAQu9G,QACpB3nE,KAAY51C,EAAQ41C,KACpB0nE,SAAYt9G,EAAQs9G,SACpB1I,OAAYZ,EAAMY,OAClB6X,WAAY,EACZtX,UAAYnB,EAAMmB,UAClBkI,QAAYr9G,EAAQq9G,QACpBpvG,MAAYjO,EAAQiO,MACpBmvG,UAAYp9G,EAAQo9G,YAExB,IAAI0M,EAAY9V,EAAMmB,UAAU,GAC5B2T,EAAa9U,EAAMmB,UAAU,GAC7BnB,EAAMY,SACNkV,GAAa9V,EAAMY,OAAOz1F,KAAO60F,EAAMY,OAAOv1F,MAAQ,EACtDypG,GAAc9U,EAAMY,OAAOn1F,IAAMu0F,EAAMY,OAAOl1F,OAAS,GAE3D1f,EAAQ8pH,UAAYA,EACpB9pH,EAAQ8oH,WAAaA,EACrB,IAAIr5G,EAASm2E,GAASl3E,EAAOA,EAAMH,KAAKhB,GAAQvN,GAChDyqH,GAAW/7G,EAAOe,EAAQy8D,EAAOlsE,GACjCsO,EAAS49D,EACb,CAiBA,SAASwgD,KAAa,CAStB,SAASzmC,KACL,IAAIU,EAAQ,IAAI+lC,GACZnmC,EAAO,IAAImmC,GA6Bf,SAASC,EAAQv5G,EAAK2B,EAAKK,EAAQjP,EAAGsZ,EAAKC,GACvC,IAAI1U,EAAIu7E,EAAKxxE,KAASwxE,EAAKxxE,GAAO,IAAI23G,IAClClmH,EAAO4M,EAAM,GAAKpI,EAAEoI,EAAM,GAC1B5M,GAAQgkH,GAAWhkH,EAAM4O,IACzBpK,EAAEoI,GAAO5M,EACTA,EAAKkZ,OAASA,GAEd1U,EAAEoI,GAAO,CACL9R,KAAM8T,EAAO9T,KACbgU,MAAOF,EAAOE,OAAS,OACvBnP,EAAGA,EACHsZ,IAAKA,EACLC,OAAQA,EAGpB,CACA,SAASktG,EAASx5G,EAAK2B,EAAKK,EAAQob,EAAGrR,EAAME,GACzC,IAAIrU,EAAI27E,EAAMvzE,KAASuzE,EAAMvzE,GAAO,IAAIs5G,IACpClmH,EAAOuO,EAAM,GAAK/J,EAAE+J,EAAM,GAC1BvO,GAAQgkH,GAAWhkH,EAAM4O,IACzBpK,EAAE+J,GAAOvO,EACTA,EAAK6Y,MAAQA,GAEbrU,EAAE+J,GAAO,CACLzT,KAAM8T,EAAO9T,KACbgU,MAAOF,EAAOE,OAAS,OACvBkb,EAAGA,EACHrR,KAAMA,EACNE,MAAOA,EAGnB,CACA,MAAO,CAAEovB,IA5DT,SAAaj7B,EAAM9E,GACf,GAAIA,EAAO,CAGP,IAAIm+G,EAAKn+G,EAAM6N,YACXghB,EAAO7uB,EAAM8uB,MACjBhqB,EAAKsC,WAAgB+2G,EAAG1qH,IAAI,WAAYo7B,EAAKnzB,MAAMoJ,EAAKJ,IAAKI,EAAKuB,MAClEvB,EAAKyC,YAAgB42G,EAAG1qH,IAAI,WAAYo7B,EAAKnzB,MAAMoJ,EAAKJ,IAAKI,EAAKuB,IAAMvB,EAAKswE,UAC7EtwE,EAAK4C,UAAgBy2G,EAAG1qH,IAAI,WAAYo7B,EAAKnzB,MAAMoJ,EAAKJ,IAAKI,EAAKuB,MAClEvB,EAAK+C,aAAgBs2G,EAAG1qH,IAAI,WAAYo7B,EAAKnzB,MAAMoJ,EAAKJ,IAAMI,EAAKuwE,QAASvwE,EAAKuB,KACrF,CACIvB,EAAKsC,YACL62G,EAAQn5G,EAAKJ,IAAKI,EAAKuB,IAAKvB,EAAKsC,WACzBtC,EAAK2L,KAAM3L,EAAKiM,IAAKjM,EAAKkM,QAElClM,EAAKyC,aACL02G,EAAQn5G,EAAKJ,IAAKI,EAAKuB,IAAMvB,EAAKswE,QAAStwE,EAAKyC,YACxCzC,EAAK6L,MAAO7L,EAAKiM,IAAKjM,EAAKkM,QAEnClM,EAAK4C,WACLw2G,EAASp5G,EAAKJ,IAAKI,EAAKuB,IAAKvB,EAAK4C,UACzB5C,EAAKiM,IAAKjM,EAAK2L,KAAM3L,EAAK6L,OAEnC7L,EAAK+C,cACLq2G,EAASp5G,EAAKJ,IAAMI,EAAKuwE,QAASvwE,EAAKuB,IAAKvB,EAAK+C,aACxC/C,EAAKkM,OAAQlM,EAAK2L,KAAM3L,EAAK6L,MAE9C,EAiCmBsnE,MAAOA,EAAOJ,KAAMA,EAC3C,CAxFAt5E,GAAYuvC,MAAM9pC,UAAUs6B,KAAO,SAASz/B,EAAOvN,EAASsO,GACxD,IAAII,EAAQhP,KACRgP,EAAMxB,UACNwB,EAAMiI,OAAOjI,EAAMxB,UAAUg7D,UAAU,WACnCl7B,GAAKt+B,EAAOnB,EAAOvN,EAASsO,EAChC,IAEA0+B,GAAKt+B,EAAOnB,EAAOvN,EAASsO,EAEpC,EAOAo+G,GAAUh6G,UAAY,CAClBlE,QAAS,SAASvH,GACdE,OAAO2b,KAAKpjB,MAAM8O,SAAQ,SAAS7M,GAC/BsF,EAAEvH,KAAKiC,GAAMA,EAAKjC,KACtB,GAAGA,KACP,GAyOJ,IAAIotH,GAAmB,CAAC,EAEpBC,GAAoB,SAASpgF,EAAYtE,GACzC,IAAIhhC,EAAKghC,EAAW,IAAMsE,EACtB0C,EAAOy9E,GAAiBzlH,GAC5B,IAAKgoC,EAAM,CACP,IAAIuiD,EAAMntE,EAAMnhB,SAASC,cAAc,OACvCkhB,EAAIjhB,MAAMgoB,SAAW,QACrB/G,EAAIjhB,MAAM2b,KAAO,WACjBsF,EAAIjhB,MAAMic,IAAM,WAChBgF,EAAIjhB,MAAMmpC,WAAaA,EACvBloB,EAAIjhB,MAAM6kC,SAAWA,EAAW,KAChC5jB,EAAIjhB,MAAMkoB,WAAa,MACvB,IAAK,IAAIzoB,EAAI,GAAIA,EAAI,MAAOA,GACxB2uF,EAAOtuF,SAASC,cAAc,SACzBkB,YAAYnB,SAAS0oH,eAAezpH,OAAO2F,aAAajF,KAC7DwhB,EAAIhgB,YAAYmtF,GAEpBtuF,SAASoB,KAAKD,YAAYggB,GAC1B,IAAIuoG,EAAS,CAAC,EACd,IAAK/pH,EAAI,GAAI2uF,EAAOntE,EAAIe,WAAYviB,EAAI,KAAO2uF,IAAQ3uF,EAAG2uF,EAAOA,EAAKnsE,YAClEunG,EAAO/pH,GAAK2uF,EAAKjtF,YAErB,KAAQitF,EAAOntE,EAAIe,YACff,EAAI1f,YAAY6sF,GAEpBviD,EAAOy9E,GAAiBzlH,GAAM,SAASI,GACnC,IAAIoB,EAAOpB,EAAGvE,WAAW,GACrBW,EAAQmpH,EAAOnkH,GASnB,OARa,MAAThF,KAEA+tF,EAAOtuF,SAASC,cAAc,SACzBkB,YAAYnB,SAAS0oH,eAAezpH,OAAO2F,aAAaW,KAC7D4b,EAAIhgB,YAAYmtF,GAChB/tF,EAAQmpH,EAAOnkH,GAAQ+oF,EAAKjtF,YAC5B8f,EAAI1f,YAAY6sF,IAEb/tF,CACX,CACJ,CACA,OAAOwrC,CACX,EAEApiC,GAAY+/B,KAAO,CACfi5C,QAAkBA,GAClBL,SAAkBA,GAClB7K,YAAkBA,IAGtB9tE,GAAYggH,gBArNZ,SAAyBjtH,GACrB,IAAIg5D,EAAW,IAAI93D,EAAE05D,SACjBK,EAAUjC,EAASiC,UAEvBj7D,EAAUmP,GAAMnP,EAAS,CACrB4nB,WAAmB,KACnB0tF,YAAmB,EACnBoW,WAAmB,OACnBh0G,QAAmB,KACnBw1G,iBAAmB,OACnBC,YAAmB,OACnBC,cAAmB,KACnBC,eAAmB,KACnB1gF,WAAmB,QACnBtE,SAAmB,GACnB8sE,UAAmB,KACnBP,OAAmB,MACnB+I,WAAmB,EACnBH,UAAmB,EACnBj6F,MAAmB,EACnBxR,UAAmB,GACnBg3G,SAAmB,EACnBuE,eAAmB,IAIvB3tH,MAAMsP,QAAQsS,IAAIgsG,WACd5tH,MAAMsP,QAAQk9G,QAAQqB,aAAalqH,WAGvC,IAAImqH,EAAYV,GAAkB/sH,EAAQ2sC,WAAY3sC,EAAQqoC,UAE9D,SAASqlF,EAAU9rH,GACf,GAAa,MAATA,EAAe,CAEf,IADA,IAAIiC,EAAQ,GACHZ,EAAIrB,EAAMb,SAAUkC,GAAK,GAC9BY,GAAS4pH,EAAU7rH,EAAM6E,OAAOxD,IAEpC,OAAOY,CACX,CACA,OAAO,CACX,CAEA,IAAIuR,EAASpV,EAAQs1G,WAAa,CAAEh0G,KAAM,EAAGgU,MAAOtV,EAAQ0rH,YAAe,KAE3E,SAASiC,EAAOzjH,GACZ,OAAKkL,EAGEjG,GAAMjF,EAAM,CACf4L,WAAYV,EACZgB,UAAWhB,EACXa,YAAab,EACbmB,aAAcnB,IANPlL,CAQf,CA0GA,OAxGAlK,EAAQ4nB,WAAWiyF,OAAM,WACrB,IAAI3vG,EAAOlK,EAAQ4nB,WAAW1d,OAC9B,IAAKA,EAAKnJ,OACN,OAAOi4D,EAASiS,OAAO,iBAI3B,IAAIvzD,EAAU1X,EAAQ0X,QAAQ7V,KAAI,SAASkT,GACvC,MAAkB,iBAAPA,EACA,CAAE9G,MAAO8G,EAAKmX,MAAOnX,GAErBA,CAEf,IACI64G,EAAel2G,EAAQ7V,KAAI,SAASkT,GACpC,OAAOA,EAAI9G,OAAS8G,EAAImX,KAC5B,IACI2hG,EAAeD,EAAa/rH,IAAI6rH,GAGhCj2G,EAAOvN,EAAKrI,KAAI,SAASuR,EAAK0H,GAC9B,MAAO,CACH/D,MAAOW,EAAQ7V,KAAI,SAASkT,EAAKkiB,GAC7B,IAAIr1B,EAAQwR,EAAI2B,EAAImX,OAuBpB,OAlBIlsB,EAAQstH,gBACK,MAAT1rH,IACImT,EAAIC,OACJpT,EAAQjC,MAAMqV,OAAOD,EAAIC,OAAQpT,GAEjCA,GAAS,IAIjBisH,EAAa52F,GAAY9mB,KAAKmK,IAC1BozG,EAAU9rH,GACVisH,EAAa52F,KAOd02F,EAAO,CACV/rH,MAAOA,EACPoT,OAAQhV,EAAQstH,cAAgB,KAAOv4G,EAAIC,OAC3CszB,WAAYxtB,EAAW,EAAI9a,EAAQqtH,eAAiBrtH,EAAQotH,eAEpE,IAER,IAGA31G,EAAKgX,QAAQ,CACT1X,MAAO62G,EAAa/rH,KAAI,SAASgvG,GAC7B,OAAO8c,EAAO,CACV/rH,MAAOivG,EACPvoE,WAAYtoC,EAAQktH,iBACpB53G,MAAOtV,EAAQmtH,aAEvB,MAMJ,IAAIz+G,EAAQ,IAAI/O,MAAMsN,YAAYuvC,MAC9B/kC,EAAK1W,OAAS,EACd2W,EAAQ3W,OAAS,EACjBf,EAAQ+R,UACR,GACA,GACA,GACA,CACI46B,WAAY3sC,EAAQ2sC,WACpBtE,SAAUroC,EAAQqoC,SAClBG,cAAe,WAKvB95B,EAAM8kB,SAAS,CACX5nB,KAAM,SACN6L,KAAMA,EACNC,QAASm2G,EAAahsH,KAAI,SAASo9E,EAAGh8E,GAClC,MAAO,CAAEmH,MAAOnH,EAAGY,MAAOo7E,EAC9B,MAGJvwE,EAAMs+B,KAAK,CACPmoE,UAAan1G,EAAQm1G,UACrBwI,UAAa39G,EAAQ29G,UACrB/I,OAAa50G,EAAQ40G,OACrBU,YAAa,EACb/xF,MAAavjB,EAAQujB,MACrBi6F,SAAax9G,EAAQw9G,SACrBuL,SAAa/oH,EAAQ+oH,SACrBC,WAAa,GACdhwD,EAAShrB,QAAQp/B,KAAKoqD,GAC7B,IAEOiC,CACX,EA6nBJ,OA7jBI,SAAUt7D,EAAOmuH,GACb,KAAInuH,EAAMqb,QAAQ8O,QAAQC,MAAQpqB,EAAMqb,QAAQ8O,QAAQikG,QAAU,GAAlE,CAIA,IAAI7sH,EAAIvB,EAAMwF,OACV2d,EAAO5hB,EAAEpB,OAAO,CAAEkuH,IAAK,IAAK3pB,EAAG,GAAI4pB,EAAG,GAAIC,EAAG,GAAIhkB,EAAG,GAAIikB,EAAG,GAAIC,EAAG,GAAIvjG,SAAU,GAAID,OAAQ,GAAIyjG,OAAQ,GAAIC,EAAG,IAAM3uH,EAAMmjB,MAC3Hb,EAAStiB,EAAMqiB,GAAGC,OAClB2lD,EAAWjoE,EAAMsN,YAAY26D,SAC7BmI,EAAapwE,EAAMsN,YAAY8iE,WAC/B8M,EAAOl9E,EAAMsN,YAAY4vE,KACzB0xC,EAAK,oBAEL9nE,EAAc,CACd9vC,QAAQ,EACR0B,WAAW,EACXxB,YAAY,EACZpH,QAAQ,EACRq6D,gBAAgB,EAChBzvD,QAAQ,EACRqvB,cAAc,EACdyoC,aAAa,GAObq8C,EAAc7uH,EAAMqiB,GAAGC,OAAOniB,OAAO,CACrCC,KAAM,SAAS+d,EAAS9d,GACpBiiB,EAAOhiB,GAAGF,KAAKG,KAAKR,KAAMoe,EAAS9d,GAEnCL,EAAMsN,YAAY4mC,eAElBn0C,KAAKoe,QAAQoE,SAASssG,EAAYrsG,WAAWC,SAC7C1iB,KAAKoe,QAAQqF,KAAK,OAAQ,eAE1BzjB,KAAKwb,MAAQ,IAAI2hE,EAAKn9E,KAAKoe,QAAS,CAChC6E,SAAUjjB,KAAKM,QAAQ2iB,SAAS8G,KAChCy0D,QAASx+E,KAAKM,QAAQk+E,QACtB3N,UAAW7wE,KAAKM,QAAQuwE,YAG5B7wE,KAAKwN,UAAY,IAAI06D,EAASloE,KAAKM,QAASN,KAAKwb,OAEjDxb,KAAK+uH,YAAc,IAAI1+C,EAAWrwE,KAAKwb,MAAOxb,KAAKwN,WAEnDxN,KAAKgvH,cAAe,EAEpBhvH,KAAKivH,sBAELjvH,KAAKwb,MAAM/N,SAASzN,KAAKwN,WAEzBxN,KAAKwb,MAAMqiE,iBAAgB,GAC3B79E,KAAKgqE,UACLhqE,KAAKwb,MAAMqiE,iBAAgB,GAE3B79E,KAAKkvH,eAAiB,WAAalvH,KAAK2a,QAAU,EAAEzL,KAAKlP,MACzDwB,EAAEC,QAAQmiB,GAAG,SAAWirG,EAAI7uH,KAAKkvH,gBAEjClvH,KAAKoe,QAAQwF,GAAG,UAAYirG,EAAI7uH,KAAKmvH,SAASjgH,KAAKlP,OAE/CA,KAAKovH,uBACLpvH,KAAKovH,sBAAsBpvH,KAAKoe,QAAQ,GAEhD,EAEA+wG,SAAU,SAAS9mG,GACf,IAAIpmB,EAAMomB,EAAEoB,QAEZ,GAAIxnB,IAAQmhB,EAAKkrG,KAAOjmG,EAAEkJ,SAGtB,OAFAvxB,KAAKwb,MAAMq1D,UAAU/nB,oBACrBzgC,EAAEjP,iBAEC,GAAIiP,EAAEkI,QAAUtuB,IAAQmhB,EAAK+H,SAChCnrB,KAAKwb,MAAMq1D,UAAU3vE,QAAQ,SAAU,CACnCgL,KAAMlM,KAAKwb,MAAMq1D,UAAUzwB,QAAQpgD,KAAKwb,MAAMq1D,UAAU1nB,eAAiB,GAAGj9C,OAC5EyhD,aAAa,SAEd,GAAItlC,EAAEkI,QAAUtuB,IAAQmhB,EAAK8H,OAChClrB,KAAKwb,MAAMq1D,UAAU3vE,QAAQ,SAAU,CACnCgL,KAAMlM,KAAKwb,MAAMq1D,UAAUzwB,QAAQpgD,KAAKwb,MAAMq1D,UAAU1nB,eAAiB,GAAGj9C,OAC5EyhD,aAAa,QAEd,IAAItlC,EAAEkI,QAAUtuB,IAAQmhB,EAAKurG,OAAQ,CACxC,IAAIthE,EAAgB,SAAShlC,GACfA,EAAEilC,OAEJC,eACJvtD,KAAKwb,MAAMq1D,UAAU3vE,QAAQ,SAAU,CAAEgL,KAAMlM,KAAK0Y,cAAcqJ,QAASyrC,cAAc,GAEjG,EAAEt+C,KAAKlP,MAMP,OAJAA,KAAKwb,MAAMq1D,UAAUjpB,YAAY,eAAgB,CAC7C5+B,MAAOqkC,SAEXhlC,EAAEjP,gBAEN,CAAO,GAAIiP,EAAEkI,QAAUtuB,IAAQmhB,EAAKwrG,EAGhC,OAFA5uH,KAAKwb,MAAMq1D,UAAUjoB,qBACrBvgC,EAAEjP,iBAEC,GAAIiP,EAAEiJ,SAAWrvB,IAAQmhB,EAAKuhF,EACjCnjG,EAAE,wBAAwB,GAAGivG,aAC1B,GAAIpoF,EAAEiJ,SAAWrvB,IAAQmhB,EAAKmrG,EACjC/sH,EAAE,0BAA0B,GAAGivG,aAC5B,GAAIpoF,EAAEiJ,SAAWrvB,IAAQmhB,EAAKorG,EACjChtH,EAAE,6BAA6B,GAAGivG,YAC/B,IAAIpoF,EAAEkI,QAAUtuB,IAAQmhB,EAAKqrG,EAGhC,OAFAzuH,KAAKwb,MAAMo1D,SAAS5iE,OAAO,QAC3Bqa,EAAEjP,iBAEC,GAAIiP,EAAEkI,QAAUtuB,IAAQmhB,EAAKonF,EAGhC,OAFAxqG,KAAKwb,MAAMo1D,SAAS5iE,OAAO,QAC3Bqa,EAAEjP,iBAEC,GAAIiP,EAAEkI,QAAUtuB,IAAQmhB,EAAKsrG,EAGhC,OAFA1uH,KAAKwb,MAAMo1D,SAAS5iE,OAAO,QAC3Bqa,EAAEjP,iBAEKnX,IAAQmhB,EAAKisG,MACpBhnG,EAAEjP,iBACFpZ,KAAKwb,MAAMo1D,SAASluD,QAAQkgB,KAAK,wDAAwD1hC,QAAQ,SACrG,EACJ,EAEAg1B,QAAS,WACLl2B,KAAKgqE,QAAQ,CAAEj6D,QAAQ,GAC3B,EAEAu/G,kBAAmB,SAASjnG,GACpBroB,KAAKkB,QAAQ,WAAYmnB,IACzBA,EAAEjP,gBAEV,EAEAm2G,gBAAiB,SAASlnG,GAKtB,GAJIroB,KAAKgvH,cACLhvH,KAAKgqE,QAAQ3hD,GAGbA,EAAEpR,QAAUoR,EAAEtZ,IAAK,CACnB,IAAIlB,EAAQwa,EAAExa,OAAS,IAAI5N,EAAMsN,YAAYuP,MAAMuL,EAAEtZ,IAAK/O,KAAK0Y,eAC/D1Y,KAAKkB,QAAQ,SAAU,CAAE2M,MAAOA,GACpC,CACJ,EAEA2hH,aAAc,SAASnnG,GACnBroB,KAAKkB,QAAQ,MAAOmnB,EACxB,EAEAonG,cAAe,SAASpnG,GACpBroB,KAAKkB,QAAQ,OAAQmnB,EACzB,EAEAqnG,eAAgB,SAASrnG,GACrBroB,KAAKkB,QAAQ,QAASmnB,EAC1B,EAEA3P,YAAa,SAAS1J,GAClB,OAAOhP,KAAKwN,UAAUkL,YAAY1J,EACtC,EAEAi7D,iBAAkB,SAASj7D,EAAOtE,GAC9B,OAAO1K,KAAKwN,UAAUy8D,iBAAiBj7D,EAAOtE,EAClD,EAEA4wD,YAAa,SAASh7D,GAClB,OAAON,KAAKwN,UAAU8tD,YAAYh7D,EACtC,EAEAqpD,OAAQ,WACJ,OAAO3pD,KAAKwN,UAAUm8C,QAC1B,EAEAkhB,YAAa,SAAS77D,GAClB,OAAOhP,KAAKwN,UAAUq9D,YAAY77D,EACtC,EAEAixC,YAAa,SAASoqB,GAClB,OAAOrqE,KAAKwN,UAAUyyC,YAAYoqB,EACtC,EAEAzc,WAAY,SAAS5+C,GACjB,OAAOhP,KAAKwN,UAAUogD,WAAW5+C,EACrC,EAEA07D,aAAc,SAAShgE,GACnB,OAAO1K,KAAKwN,UAAUk9D,aAAahgE,EACvC,EAEAkvB,YAAa,SAAS5qB,EAAO8qB,GACzB,OAAO95B,KAAKwN,UAAUosB,YAAY5qB,EAAO8qB,EAC7C,EAEAkwC,QAAS,SAASv7D,GAoBd,OAnBKA,IACDA,EAASs4C,GAGRt4C,EAAOgkE,cACRzyE,KAAKwb,MAAMxM,MAAMhP,KAAKwN,UAAUkL,eAChC1Y,KAAK+uH,YAAY//G,MAAMhP,KAAKwN,UAAUkL,eAEtC1Y,KAAKwN,UAAUw8D,QAAQv7D,IAGtBA,EAAOu7B,eACRhqC,KAAKwb,MAAMwuD,QAAQv7D,GACnBzO,KAAK+uH,YAAY/kD,UAEjBhqE,KAAKwb,MAAMwsC,OAAOv5C,GAClBzO,KAAKkB,QAAQ,WAGVlB,IACX,EAEAuhB,WAAY,SAASrV,EAAM5L,GACvB,OAAON,KAAKwb,MAAM+F,WAAWrV,EAAM5L,EACvC,EAEAqvH,YAAa,SAASztH,GAClB,OA/NZ,YA+NgBA,GACAlC,KAAKgvH,aAAe9sH,GAEN,IAAVA,GACAlC,KAAKgqE,UAGFhqE,MAGJA,KAAKgvH,YAChB,EAEAn7F,OAAQ,WACJ,OAAO7zB,KAAKwN,UAAUqmB,QAC1B,EAEAC,SAAU,SAAS4xB,GACXA,EAAKiE,QACL3pD,KAAKwN,UAAU0V,UAEfljB,KAAKwN,UAAY,IAAI06D,EAAS1mE,EAAEpB,OAAO,CAAC,EAAGJ,KAAKM,QAASolD,IAEzD1lD,KAAKivH,sBAELjvH,KAAKwb,MAAM/N,SAASzN,KAAKwN,WACzBxN,KAAK+uH,YAAYthH,SAASzN,KAAKwN,WAE/BxN,KAAK0Y,YAAY1Y,KAAK0Y,gBAEtB1Y,KAAKgqE,SAEb,EAEAoB,SAAU,WACN,OAAOprE,KAAKwN,UAAU49D,UAC1B,EAEAjqD,SAAU,SAAS9Q,EAAMnE,GACrB,OAAOlM,KAAKwN,UAAU2T,SAAS9Q,EAAMnE,EACzC,EAEA0V,UAAW,SAASthB,GAChBN,KAAKwN,UAAUoU,UACXpgB,EAAEpB,OAAO,CAAC,EAAGJ,KAAKM,QAAQuhB,IAAKvhB,EAAS,CAAEmN,SAAUzN,KAAKwN,YAEjE,EAEAmU,YAAa,SAASrhB,GAClBN,KAAKwN,UAAUmU,YAAYrhB,EAC/B,EAEAgtC,KAAM,SAAShtC,EAASsO,GACpB5O,KAAKwN,UAAU8/B,KAAKhtC,EAASsO,EACjC,EAEAghH,qBAAsB,SAASvnG,GACvBroB,KAAKkB,QAAQ,cAAemnB,IAC5BA,EAAEjP,gBAEV,EAEAy2G,qBAAsB,SAASxnG,GACvBroB,KAAKkB,QAAQ,cAAemnB,GAC5BA,EAAEjP,iBAEFpZ,KAAK8vH,cAAcznG,EAAEkzC,QAE7B,EAEAu0D,cAAe,SAASp0D,GACpB,IAAIT,EACAz5D,EAAE,oHAIDwhB,SAAShjB,KAAKoe,SAEf+uG,EAAK3rH,EAAE,oCACVwhB,SAASi4C,GACT80D,iBAAiB,CACdrhH,KAAM,QAASshH,WAAY,GAC3Bt/G,IAAK,EAAGkK,IAAK,EAAG1Y,MAAO,IACxBsI,KAAK,oBAERkxD,EAASpC,UAAS,SAASjxC,GACvB8kG,EAAGjrH,MAAMmmB,EAAEixC,SACf,IACC22D,QAAO,WACJhwH,EAAMijB,QAAQ+3C,GACdA,EAAQjpC,QACZ,GACJ,EAEAk+F,mBAAoB,SAAS7nG,GACrBroB,KAAKkB,QAAQ,YAAamnB,IAC1BA,EAAEjP,gBAEV,EAEA+2G,qBAAsB,SAAS9nG,GACvBroB,KAAKkB,QAAQ,cAAemnB,IAC5BA,EAAEjP,gBAEV,EAEAg3G,qBAAsB,SAAS/nG,GACvBroB,KAAKkB,QAAQ,cAAemnB,IAC5BA,EAAEjP,gBAEV,EAEAi3G,qBAAsB,SAAShoG,GACvBroB,KAAKkB,QAAQ,cAAemnB,IAC5BA,EAAEjP,gBAEV,EAEAk3G,qBAAsB,SAASjoG,GACvBroB,KAAKkB,QAAQ,cAAemnB,IAC5BA,EAAEjP,gBAEV,EAEAm3G,mBAAoB,SAASloG,GACrBroB,KAAKkB,QAAQ,YAAamnB,IAC1BA,EAAEjP,gBAEV,EAEAo3G,sBAAuB,SAASnoG,GACxBroB,KAAKkB,QAAQ,eAAgBmnB,IAC7BA,EAAEjP,gBAEV,EAEAq3G,mBAAoB,SAASpoG,GACrBroB,KAAKkB,QAAQ,YAAamnB,IAC1BA,EAAEjP,gBAEV,EAEAs3G,sBAAuB,SAASroG,GACxBroB,KAAKkB,QAAQ,eAAgBmnB,IAC7BA,EAAEjP,gBAEV,EAEAu3G,iBAAkB,SAAStoG,GACnBroB,KAAKkB,QAAQ,UAAWmnB,IACxBA,EAAEjP,gBAEV,EAEAw3G,oBAAqB,SAASvoG,GACtBroB,KAAKkB,QAAQ,aAAcmnB,IAC3BA,EAAEjP,gBAEV,EAEAy3G,mBAAoB,SAASxoG,GACrBroB,KAAKkB,QAAQ,YAAamnB,IAC1BA,EAAEjP,gBAEV,EAEA03G,sBAAuB,SAASzoG,GACxBroB,KAAKkB,QAAQ,eAAgBmnB,IAC7BA,EAAEjP,gBAEV,EAEA23G,gBAAiB,SAAS1oG,GACtBroB,KAAKkB,QAAQ,SAAUmnB,EAC3B,EAEA2oG,sBAAuB,SAAS3oG,GAC7BroB,KAAKkB,QAAQ,eAAgBmnB,EAChC,EAEA4oG,qBAAsB,SAAS5oG,GACvBroB,KAAKkB,QAAQ,cAAemnB,IAC5BA,EAAEjP,gBAEV,EAEA83G,mBAAoB,SAAS7oG,GACzBroB,KAAKkB,QAAQ,YAAamnB,EAC9B,EAEA8oG,kBAAmB,SAAS9oG,GACxBpoB,EAAMqiB,GAAGg3C,SAASt5D,KAAKoe,QAASiK,EAAEiE,OACtC,EAEA2iG,oBAAqB,WACjBjvH,KAAKwN,UAAU0B,KAAK,MAAOlP,KAAKwvH,aAAatgH,KAAKlP,OAClDA,KAAKwN,UAAU0B,KAAK,OAAQlP,KAAKyvH,cAAcvgH,KAAKlP,OACpDA,KAAKwN,UAAU0B,KAAK,QAASlP,KAAK0vH,eAAexgH,KAAKlP,OACtDA,KAAKwN,UAAU0B,KAAK,WAAYlP,KAAKsvH,kBAAkBpgH,KAAKlP,OAC5DA,KAAKwN,UAAU0B,KAAK,SAAUlP,KAAKuvH,gBAAgBrgH,KAAKlP,OACxDA,KAAKwN,UAAU0B,KAAK,cAAelP,KAAK4vH,qBAAqB1gH,KAAKlP,OAClEA,KAAKwN,UAAU0B,KAAK,cAAelP,KAAK6vH,qBAAqB3gH,KAAKlP,OAClEA,KAAKwN,UAAU0B,KAAK,YAAalP,KAAKkwH,mBAAmBhhH,KAAKlP,OAC9DA,KAAKwN,UAAU0B,KAAK,cAAelP,KAAKmwH,qBAAqBjhH,KAAKlP,OAClEA,KAAKwN,UAAU0B,KAAK,cAAelP,KAAKowH,qBAAqBlhH,KAAKlP,OAClEA,KAAKwN,UAAU0B,KAAK,cAAelP,KAAKqwH,qBAAqBnhH,KAAKlP,OAClEA,KAAKwN,UAAU0B,KAAK,cAAelP,KAAKswH,qBAAqBphH,KAAKlP,OAClEA,KAAKwN,UAAU0B,KAAK,YAAalP,KAAKuwH,mBAAmBrhH,KAAKlP,OAC9DA,KAAKwN,UAAU0B,KAAK,eAAgBlP,KAAKwwH,sBAAsBthH,KAAKlP,OACpEA,KAAKwN,UAAU0B,KAAK,YAAalP,KAAKywH,mBAAmBvhH,KAAKlP,OAC9DA,KAAKwN,UAAU0B,KAAK,eAAgBlP,KAAK0wH,sBAAsBxhH,KAAKlP,OACpEA,KAAKwN,UAAU0B,KAAK,UAAWlP,KAAK2wH,iBAAiBzhH,KAAKlP,OAC1DA,KAAKwN,UAAU0B,KAAK,aAAclP,KAAK4wH,oBAAoB1hH,KAAKlP,OAChEA,KAAKwN,UAAU0B,KAAK,YAAalP,KAAK6wH,mBAAmB3hH,KAAKlP,OAC9DA,KAAKwN,UAAU0B,KAAK,eAAgBlP,KAAK8wH,sBAAsB5hH,KAAKlP,OACpEA,KAAKwN,UAAU0B,KAAK,SAAUlP,KAAK+wH,gBAAgB7hH,KAAKlP,OACxDA,KAAKwN,UAAU0B,KAAK,eAAgBlP,KAAKgxH,sBAAsB9hH,KAAKlP,OACpEA,KAAKwN,UAAU0B,KAAK,cAAelP,KAAKixH,qBAAqB/hH,KAAKlP,OAClEA,KAAKwN,UAAU0B,KAAK,YAAalP,KAAKkxH,mBAAmBhiH,KAAKlP,OAC9DA,KAAKwN,UAAU0B,KAAK,WAAYlP,KAAKmxH,kBAAkBjiH,KAAKlP,MAChE,EAEAkjB,QAAS,WACLjjB,EAAMqiB,GAAGC,OAAOhiB,GAAG2iB,QAAQ1iB,KAAKR,MAEhCA,KAAKwN,UAAU0V,UACfljB,KAAK+uH,YAAY7rG,UACjBljB,KAAKwb,MAAM0H,UAEPljB,KAAKkvH,gBACL1tH,EAAEC,QAAQusB,IAAI,SAAW6gG,EAAI7uH,KAAKkvH,eAE1C,EAEA5uH,QAAS,CACL4L,KAAM,cACNsyE,SAAS,EACT3N,WAAW,EACX94D,KAAM,IACNC,QAAS,GACT3F,UAAW,GACXF,YAAa,GACb6qC,aAAc,GACdC,YAAa,GACbuuB,MAAO,CACHU,SAAU,GACVzqD,SAAU,iBAEdwB,SAAU,CAAC,EACXpB,IAAK,CAEDwrD,KAAM,WACN5rD,SAAU,eACVyqD,SAAU,GAKVupC,UAAW,KAEXwI,WAAW,EAEX/I,OAAQ,KAER3mG,MAAO,KACP4xD,OAAQ,KACRw9C,QAAS,KACTC,SAAU,KACVC,QAAS,4BAA8B59G,EAAMouH,QAE7Cn4E,KAAM,MAEVgH,iBAAkB,CACdjQ,WAAY,QACZtE,SAAU,IAEdse,oBAAoB,GAGxB/kC,WAAY,SAAShW,EAAMhK,EAAOoiC,GAC9B,OAAOtkC,KAAKwN,UAAU0U,WAAWhW,EAAMhK,EAAOoiC,EAClD,EAEAliB,aAAc,SAASlW,GACnB,OAAOlM,KAAKwN,UAAU4U,aAAalW,EACvC,EAEAqjC,UAAW,SAASrjC,GAChB,OAAOlM,KAAKwN,UAAU+hC,UAAUrjC,EACpC,EAEAy+D,YAAa,SAASh7B,GAClB,OAAO3vC,KAAKwN,UAAUm9D,YAAYh7B,EACtC,EAEA4gC,gBAAiB,WACb,OAAOvwE,KAAKwb,MAAM+0D,eACtB,EAEAC,qBAAsB,WAClB,OAAOxwE,KAAKwb,MAAMg1D,oBACtB,EAEAC,qBAAsB,WAClB,OAAOzwE,KAAKwb,MAAMi1D,oBACtB,EAEAx/D,SAAU,SAAShB,GACf,OAAOjQ,KAAKwN,UAAUyD,SAAShB,EACnC,EAEA85D,cAAe,WACX,OAAO/pE,KAAKwN,UAAUu8D,eAC1B,EAEArpE,OAAQ,CACJ,MACA,OACA,QACA,YACA,cACA,cACA,WACA,SACA,SACA,cACA,cACA,cACA,YACA,eACA,YACA,cACA,eACA,UACA,aACA,YACA,eACA,SACA,eACA,cACA,eAIRT,EAAMsN,YAAYw5C,YAAcA,EAChC9mD,EAAMqiB,GAAG8uG,OAAOtC,GAChBttH,EAAEpB,QAAO,EAAM0uH,EAAa,CAAErsG,WAjiBb,CACbC,QAAS,gDAtBb,CAujBH,CA1jBD,CA0jBGjhB,OAAOxB,OACIA,KAIrB","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('kendo.core.js'), require('kendo.excel.js'), require('kendo.progressbar.js'), require('kendo.pdf.js'), require('kendo.binder.js'), require('kendo.window.js'), require('kendo.list.js'), require('kendo.tabstrip.js'), require('kendo.icons.js'), require('kendo.color.js'), require('kendo.sortable.js'), require('kendo.menu.js'), require('kendo.popup.js'), require('kendo.calendar.js'), require('kendo.listview.js'), require('kendo.data.js'), require('kendo.dom.js'), require('kendo.toolbar.js'), require('kendo.colorpicker.js'), require('kendo.combobox.js'), require('kendo.dropdownlist.js'), require('kendo.togglebutton.js'), require('kendo.validator.js'), require('kendo.treeview.js'), require('kendo.numerictextbox.js'), require('kendo.datepicker.js'), require('kendo.datetimepicker.js')) :\n    typeof define === 'function' && define.amd ? define(['kendo.core', 'kendo.excel', 'kendo.progressbar', 'kendo.pdf', 'kendo.binder', 'kendo.window', 'kendo.list', 'kendo.tabstrip', 'kendo.icons', 'kendo.color', 'kendo.sortable', 'kendo.menu', 'kendo.popup', 'kendo.calendar', 'kendo.listview', 'kendo.data', 'kendo.dom', 'kendo.toolbar', 'kendo.colorpicker', 'kendo.combobox', 'kendo.dropdownlist', 'kendo.togglebutton', 'kendo.validator', 'kendo.treeview', 'kendo.numerictextbox', 'kendo.datepicker', 'kendo.datetimepicker'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, (global.kendospreadsheet = global.kendospreadsheet || {}, global.kendospreadsheet.js = factory()));\n})(this, (function () {\n    (function(kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function(options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [ \"undo\", \"redo\" ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger(\"undo\", { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger(\"redo\", { command: command });\n                }\n            },\n            clear: function() {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n\n        kendo.deepExtend(kendo, {\n            util: {\n                UndoRedoStack: UndoRedoStack\n            }\n        });\n    })(kendo);\n\n    /***********************************************************************\n     * WARNING: this file is auto-generated.  If you change it directly,\n     * your modifications will eventually be lost.  The source code is in\n     * `kendo-drawing` repository, you should make your changes there and\n     * run `src-modules/sync.sh` in this repository.\n     */\n\n    (function($) {\n    /* eslint-disable space-before-blocks, space-before-function-paren */\n\n    window.kendo.util = window.kendo.util || {};\n\n    var LRUCache = kendo.Class.extend({\n        init: function(size) {\n\n            this._size = size;\n            this._length = 0;\n            this._map = {};\n        },\n\n        put: function(key, value) {\n            var map = this._map;\n            var entry = { key: key, value: value };\n\n            map[key] = entry;\n\n            if (!this._head) {\n                this._head = this._tail = entry;\n            } else {\n                this._tail.newer = entry;\n                entry.older = this._tail;\n                this._tail = entry;\n            }\n\n            if (this._length >= this._size) {\n                map[this._head.key] = null;\n                this._head = this._head.newer;\n                this._head.older = null;\n            } else {\n                this._length++;\n            }\n        },\n\n        get: function(key) {\n            var entry = this._map[key];\n\n            if (entry) {\n                if (entry === this._head && entry !== this._tail) {\n                    this._head = entry.newer;\n                    this._head.older = null;\n                }\n\n                if (entry !== this._tail) {\n                    if (entry.older) {\n                        entry.older.newer = entry.newer;\n                        entry.newer.older = entry.older;\n                    }\n\n                    entry.older = this._tail;\n                    entry.newer = null;\n\n                    this._tail.newer = entry;\n                    this._tail = entry;\n                }\n\n                return entry.value;\n            }\n        }\n    });\n\n    var REPLACE_REGEX = /\\r?\\n|\\r|\\t/g;\n    var SPACE = ' ';\n\n    function normalizeText(text) {\n        return String(text).replace(REPLACE_REGEX, SPACE);\n    }\n\n    function objectKey(object) {\n        var parts = [];\n        for (var key in object) {\n            parts.push(key + object[key]);\n        }\n\n        return parts.sort().join(\"\");\n    }\n\n    // Computes FNV-1 hash\n    // See http://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\n    function hashKey(str) {\n        // 32-bit FNV-1 offset basis\n        // See http://isthe.com/chongo/tech/comp/fnv/#FNV-param\n        var hash = 0x811C9DC5;\n\n        for (var i = 0; i < str.length; ++i) {\n            hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n            hash ^= str.charCodeAt(i);\n        }\n\n        return hash >>> 0;\n    }\n\n    function zeroSize() {\n        return { width: 0, height: 0, baseline: 0 };\n    }\n\n    var DEFAULT_OPTIONS = {\n        baselineMarkerSize: 1\n    };\n\n    var defaultMeasureBox;\n\n    if (typeof document !== \"undefined\") {\n        defaultMeasureBox = document.createElement(\"div\");\n        defaultMeasureBox.style.cssText = \"position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;\" +\n                  \"padding: 0 !important; margin: 0 !important; border: 0 !important;\" +\n                  \"line-height: normal !important; visibility: hidden !important; white-space: pre!important;\";\n    }\n\n    var TextMetrics = kendo.Class.extend({\n        init: function(options) {\n\n            this._cache = new LRUCache(1000);\n            this.options = $.extend({}, DEFAULT_OPTIONS, options);\n        },\n\n        measure: function(text, style, options) {\n            if (options === void 0) { options = {}; }\n\n            if (typeof text === 'undefined' || text === null) {\n                return zeroSize();\n            }\n\n            var styleKey = objectKey(style);\n            var cacheKey = hashKey(text + styleKey);\n            var cachedResult = this._cache.get(cacheKey);\n\n            if (cachedResult) {\n                return cachedResult;\n            }\n\n            var size = zeroSize();\n            var measureBox = options.box || defaultMeasureBox;\n            var baselineMarker = this._baselineMarker().cloneNode(false);\n\n            for (var key in style) {\n                var value = style[key];\n                if (typeof value !== \"undefined\") {\n                    measureBox.style[key] = value;\n                }\n            }\n\n            var textStr = options.normalizeText !== false ? normalizeText(text) : String(text);\n\n            measureBox.textContent = textStr;\n            measureBox.appendChild(baselineMarker);\n            document.body.appendChild(measureBox);\n\n            if (textStr.length) {\n                size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                size.height = measureBox.offsetHeight;\n                size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n            }\n\n            if (size.width > 0 && size.height > 0) {\n                this._cache.put(cacheKey, size);\n            }\n\n            measureBox.parentNode.removeChild(measureBox);\n\n            return size;\n        },\n\n        _baselineMarker: function() {\n            var marker = document.createElement(\"div\");\n            marker.style.cssText = \"display: inline-block; vertical-align: baseline;width: \" +\n                this.options.baselineMarkerSize + \"px; height: \" + this.options.baselineMarkerSize + \"px;overflow: hidden;\";\n\n            return marker;\n        }\n    });\n\n    TextMetrics.current = new TextMetrics();\n\n    function measureText(text, style, measureBox) {\n        return TextMetrics.current.measure(text, style, measureBox);\n    }\n\n    kendo.deepExtend(kendo.util, {\n        LRUCache: LRUCache,\n        TextMetrics: TextMetrics,\n        measureText: measureText,\n        objectKey: objectKey,\n        hashKey: hashKey,\n        normalizeText: normalizeText\n    });\n\n    })(window.kendo.jQuery);\n\n    (function () {\r\n        // Imports ================================================================\r\n        var kendo = window.kendo,\r\n            deepExtend = kendo.deepExtend;\r\n\r\n        function sqr(value) {\r\n            return value * value;\r\n        }\r\n\r\n        var now = Date.now;\r\n        if (!now) {\r\n            now = function() {\r\n                return new Date().getTime();\r\n            };\r\n        }\r\n\r\n        // Template helpers =======================================================\r\n\r\n        function renderSize(size) {\r\n            if (typeof size !== \"string\") {\r\n                size += \"px\";\r\n            }\r\n\r\n            return size;\r\n        }\r\n\r\n        function renderPos(pos) {\r\n            var result = [];\r\n\r\n            if (pos) {\r\n                var parts = kendo.toHyphens(pos).split(\"-\");\r\n\r\n                for (var i = 0; i < parts.length; i++) {\r\n                    result.push(\"k-pos-\" + parts[i]);\r\n                }\r\n            }\r\n\r\n            return result.join(\" \");\r\n        }\r\n\r\n        function arabicToRoman(n) {\r\n            var literals = {\r\n                1    : \"i\",       10   : \"x\",       100  : \"c\",\r\n                2    : \"ii\",      20   : \"xx\",      200  : \"cc\",\r\n                3    : \"iii\",     30   : \"xxx\",     300  : \"ccc\",\r\n                4    : \"iv\",      40   : \"xl\",      400  : \"cd\",\r\n                5    : \"v\",       50   : \"l\",       500  : \"d\",\r\n                6    : \"vi\",      60   : \"lx\",      600  : \"dc\",\r\n                7    : \"vii\",     70   : \"lxx\",     700  : \"dcc\",\r\n                8    : \"viii\",    80   : \"lxxx\",    800  : \"dccc\",\r\n                9    : \"ix\",      90   : \"xc\",      900  : \"cm\",\r\n                1000 : \"m\"\r\n            };\r\n            var values = [ 1000,\r\n                           900 , 800, 700, 600, 500, 400, 300, 200, 100,\r\n                           90  , 80 , 70 , 60 , 50 , 40 , 30 , 20 , 10 ,\r\n                           9   , 8  , 7  , 6  , 5  , 4  , 3  , 2  , 1 ];\r\n            var roman = \"\";\r\n            while (n > 0) {\r\n                if (n < values[0]) {\r\n                    values.shift();\r\n                } else {\r\n                    roman += literals[values[0]];\r\n                    n -= values[0];\r\n                }\r\n            }\r\n            return roman;\r\n        }\r\n\r\n        function romanToArabic(r) {\r\n            r = r.toLowerCase();\r\n            var digits = {\r\n                i: 1,\r\n                v: 5,\r\n                x: 10,\r\n                l: 50,\r\n                c: 100,\r\n                d: 500,\r\n                m: 1000\r\n            };\r\n            var value = 0, prev = 0;\r\n            for (var i = 0; i < r.length; ++i) {\r\n                var v = digits[r.charAt(i)];\r\n                if (!v) {\r\n                    return null;\r\n                }\r\n                value += v;\r\n                if (v > prev) {\r\n                    value -= 2 * prev;\r\n                }\r\n                prev = v;\r\n            }\r\n            return value;\r\n        }\r\n\r\n        function memoize(f) {\r\n            var cache = Object.create(null);\r\n            return function() {\r\n                var id = \"\";\r\n                for (var i = arguments.length; --i >= 0;) {\r\n                    id += \":\" + arguments[i];\r\n                }\r\n                return id in cache ? cache[id] : (cache[id] = f.apply(this, arguments));\r\n            };\r\n        }\r\n\r\n        function isUnicodeLetter(ch) {\r\n            return RX_UNICODE_LETTER.test(ch);\r\n        }\r\n\r\n        function withExit(f, obj) {\r\n            try {\r\n                return f.call(obj, function(value){\r\n                    throw new Return(value);\r\n                });\r\n            } catch(ex) {\r\n                if (ex instanceof Return) {\r\n                    return ex.value;\r\n                }\r\n                throw ex;\r\n            }\r\n            function Return(value) {\r\n                this.value = value;\r\n            }\r\n        }\r\n\r\n        // Exports ================================================================\r\n        deepExtend(kendo, {\r\n            util: {\r\n                now: now,\r\n                renderPos: renderPos,\r\n                renderSize: renderSize,\r\n                sqr: sqr,\r\n                romanToArabic: romanToArabic,\r\n                arabicToRoman: arabicToRoman,\r\n                memoize: memoize,\r\n                isUnicodeLetter: isUnicodeLetter,\r\n                withExit: withExit\r\n            }\r\n        });\r\n\r\n        var RX_UNICODE_LETTER = new RegExp(\"[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]\");\r\n\r\n    })();\n\n    \"use strict\";\n\n        // SAX-style XML parser ====================================================\n        var STRING = String.fromCharCode;\n\n        // XXX: add more here?\n        var ENTITIES = {\n            \"amp\"  : 38,\n            \"lt\"   : 60,\n            \"gt\"   : 62,\n            \"quot\" : 34,\n            \"apos\" : 39,\n            \"nbsp\" : 160\n        };\n\n        function CODE(str) {\n            var out = [];\n            for (var i = 0; i < str.length; ++i) {\n                out.push(str.charCodeAt(i));\n            }\n            return out;\n        }\n\n        function UCS2(out, code) {\n            if (code > 0xFFFF) {\n                code -= 0x10000;\n                out.push(code >>> 10 & 0x3FF | 0xD800,\n                         0xDC00 | code & 0x3FF);\n            } else {\n                out.push(code);\n            }\n        }\n\n        var START_CDATA     = CODE(\"<![CDATA[\");\n        var END_CDATA       = CODE(\"]]>\");\n        var END_COMMENT     = CODE(\"-->\");\n        var START_COMMENT   = CODE(\"!--\");\n        var END_SHORT_TAG   = CODE(\"/>\");\n        var END_TAG         = CODE(\"</\");\n        var END_DECLARATION = CODE(\"?>\");\n        var QUESTION_MARK   = CODE(\"?\");\n        var LESS_THAN       = CODE(\"<\");\n        var GREATER_THAN    = CODE(\">\");\n        var SEMICOLON       = CODE(\";\");\n        var EQUAL           = CODE(\"=\");\n        var AMPERSAND       = CODE(\"&\");\n        var QUOTE           = CODE('\"');\n        var APOSTROPHE      = CODE(\"'\");\n        var SHARP           = CODE(\"#\");\n        var LOWERCASE_X     = CODE(\"x\");\n        var UPPERCASE_X     = CODE(\"X\");\n\n        var EXIT = {};\n\n        function parse$2(data, callbacks) {\n            var index = 0;\n            var stack = [];\n            var object = {\n                is: function(selector) {\n                    var i = stack.length, j = selector.length;\n                    while (--i >= 0 && --j >= 0) {\n                        if (stack[i].$tag != selector[j] && selector[j] != \"*\") {\n                            return false;\n                        }\n                    }\n                    return j < 0 ? stack[stack.length - 1] : null;\n                },\n                exit: function() {\n                    throw EXIT;\n                },\n                stack: stack\n            };\n\n            function readChar(body) {\n                var code = data[index++];\n                if (!(code & 0xF0 ^ 0xF0)) {// 4 bytes\n                    UCS2(body,\n                         ((code & 0x03) << 18) |\n                         ((data[index++] & 0x3F) << 12) |\n                         ((data[index++] & 0x3F) << 6) |\n                         (data[index++] & 0x3F));\n                } else if (!(code & 0xE0 ^ 0xE0)) {// 3 bytes\n                    UCS2(body,\n                         ((code & 0x0F) << 12) |\n                         ((data[index++] & 0x3F) << 6) |\n                         (data[index++] & 0x3F));\n                } else if (!(code & 0xC0 ^ 0xC0)) {// 2 bytes\n                    UCS2(body,\n                         ((code & 0x1F) << 6) |\n                         (data[index++] & 0x3F));\n                } else {\n                    body.push(code);\n                }\n            }\n\n            function croak(msg) {\n                throw new Error(msg + \", at \" + index);\n            }\n\n            function readWhile(pred) {\n                var a = [];\n                while (index < data.length && pred(data[index])) {\n                    a.push(data[index++]);\n                }\n                return a;\n            }\n\n            function readAsciiWhile(pred) {\n                return STRING.apply(0, readWhile(pred));\n            }\n\n            function skipWhitespace() {\n                readWhile(isWhitespace);\n            }\n\n            function eat(a) {\n                var save = index;\n                for (var i = 0; i < a.length; ++i) {\n                    if (data[index++] != a[i]) {\n                        index = save;\n                        return false;\n                    }\n                }\n                return a;\n            }\n\n            function skip(code) {\n                if (!eat(code)) {\n                    croak(\"Expecting \" + code.join(\", \"));\n                }\n            }\n\n            function isWhitespace(code) {\n                return code == 9 || code == 10 || code == 13 || code == 32;\n            }\n\n            function isDigit(code) {\n                return code >= 48 && code <= 57;\n            }\n\n            function isHexDigit(code) {\n                return (code >= 48 && code <= 57) ||\n                       ((code|=32) >= 97 && code <= 102); // a..f or A..F\n            }\n\n            function isNameStart(code) {\n                return code == 58 ||                      // :\n                       code == 95 ||                      // _\n                       ((code|=32) >= 97 && code <= 122); // a..z or A..Z\n            }\n\n            function isName(code) {\n                return code == 45 ||                      // -\n                       isDigit(code) ||\n                       isNameStart(code);\n            }\n\n            function xmlComment() {\n                var body = [];\n                while (index < data.length) {\n                    if (eat(END_COMMENT)) {\n                        return call(\"comment\", STRING.apply(0, body));\n                    }\n                    readChar(body);\n                }\n            }\n\n            function xmlTag() {\n                var name, attrs;\n                if (eat(QUESTION_MARK)) {\n                    xmlDecl();\n                } else if (eat(START_COMMENT)) {\n                    xmlComment();\n                } else {\n                    name = xmlName();\n                    attrs = xmlAttrs(name);\n                    stack.push(attrs);\n                    if (eat(END_SHORT_TAG)) {\n                        call(\"enter\", name, attrs, true);\n                    } else {\n                        skip(GREATER_THAN);\n                        call(\"enter\", name, attrs);\n                        xmlContent(name);\n                        if (name != xmlName()) {\n                            croak(\"Bad closing tag\");\n                        }\n                        call(\"leave\", name, attrs);\n                        skipWhitespace();\n                        skip(GREATER_THAN);\n                    }\n                    stack.pop();\n                }\n            }\n\n            function xmlContent(name) {\n                var body = [];\n                while (index < data.length) {\n                    if (eat(END_TAG)) {\n                        return body.length && call(\"text\", STRING.apply(0, body));\n                    } else if (eat(START_CDATA)) {\n                        while (index < data.length && !eat(END_CDATA)) {\n                            readChar(body);\n                        }\n                    } else if (eat(LESS_THAN)) {\n                        if (body.length) {\n                            call(\"text\", STRING.apply(0, body));\n                        }\n                        xmlTag();\n                        body = [];\n                    } else if (eat(AMPERSAND)) {\n                        xmlEntity(body);\n                    } else {\n                        readChar(body);\n                    }\n                }\n                croak(\"Unclosed tag \" + name);\n            }\n\n            function xmlName() {\n                if (!isNameStart(data[index])) {\n                    croak(\"Expecting XML name\");\n                }\n                return readAsciiWhile(isName);\n            }\n\n            function xmlString() {\n                var quote = eat(QUOTE) || eat(APOSTROPHE);\n                if (!quote) {\n                    croak(\"Expecting string\");\n                }\n                var body = [];\n                while (index < data.length) {\n                    if (eat(quote)) {\n                        return STRING.apply(0, body);\n                    } else if (eat(AMPERSAND)) {\n                        xmlEntity(body);\n                    } else {\n                        readChar(body);\n                    }\n                }\n                croak(\"Unfinished string\");\n            }\n\n            function xmlEntity(body) {\n                var code;\n                if (eat(SHARP)) {\n                    if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                        code = parseInt(readAsciiWhile(isHexDigit), 16);\n                    } else {\n                        code = parseInt(readAsciiWhile(isDigit), 10);\n                    }\n                    if (isNaN(code)) {\n                        croak(\"Bad numeric entity\");\n                    }\n                } else {\n                    var name = xmlName();\n                    code = ENTITIES[name];\n                    if (code === undefined) {\n                        croak(\"Unknown entity \" + name);\n                    }\n                }\n                UCS2(body, code);\n                skip(SEMICOLON);\n            }\n\n            function xmlDecl() {\n                call(\"decl\", xmlName(), xmlAttrs());\n                skip(END_DECLARATION);\n            }\n\n            function xmlAttrs(name) {\n                var map = { $tag: name };\n                while (index < data.length) {\n                    skipWhitespace();\n                    var code = data[index];\n                    if (code == 63 || code == 62 || code == 47) { // ?, > or /\n                        break;\n                    }\n                    map[xmlName()] = ( skip(EQUAL), xmlString() );\n                }\n                return map;\n            }\n\n            function call(what, thing, arg1, arg2) {\n                var f = callbacks && callbacks[what];\n                if (f) {\n                    f.call(object, thing, arg1, arg2);\n                }\n            }\n\n            // skip BOM\n            var tmp = [];\n            readChar(tmp);\n            if (tmp[0] != 65279) {\n                index = 0;\n            }\n\n            while (index < data.length) {\n                skipWhitespace();\n                skip(LESS_THAN);\n                xmlTag();\n                skipWhitespace();\n            }\n        }\n\n        // Exports ================================================================\n        kendo.util.parseXML = function parseXML() {\n            try {\n                return parse$2.apply(this, arguments);\n            } catch(ex) {\n                if (ex !== EXIT) {\n                    throw ex;\n                }\n            }\n        };\n\n    (function(kendo) {\n        var $ = kendo.jQuery;\n\n        var COMMAND_TYPES = {\n            AUTO_FILL: \"autoFill\",\n            CLEAR: \"clear\",\n            CUT: \"cut\",\n            EDIT: \"edit\",\n            PASTE: \"paste\",\n            VALIDATION: \"validation\"\n        };\n\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function(options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function(range) {\n                if (range !== undefined) {\n                    this._setRange(range);\n                }\n\n                return this._range;\n            },\n            _setRange: function(range) {\n                this._range = range;\n            },\n            redo: function() {\n                this.range().select();\n                this.exec();\n            },\n            undo: function() {\n                this.setState(this._state);\n            },\n            getState: function() {\n                this._state = this.range().getState(this._property);\n            },\n            setState: function(state) {\n                this.range().setState(state);\n            },\n            rejectState: function(validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: \"error\",\n                    type: \"validationError\"\n                };\n            },\n            _forEachCell: function(callback) {\n                var range = this.range();\n                var ref = range._ref;\n\n                ref.forEach(function(ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            usesImage: function(/* image id from workbook._images */) {\n                return false;\n            }\n        });\n\n        kendo.spreadsheet.DrawingUpdateCommand = Command.extend({\n            init: function(options) {\n                this._sheet = options.sheet;\n                this._drawing = options.drawing;\n                this._orig = this._drawing.clone();\n                this._previous = options.previous;\n            },\n            exec: function() {},\n            undo: function() {\n                this._drawing.reset(this._previous);\n                this._sheet._activeDrawing = this._drawing;\n                this._sheet.triggerChange({ layout: true });\n            },\n            redo: function() {\n                this._drawing.reset(this._orig);\n                this._sheet._activeDrawing = this._drawing;\n                this._sheet.triggerChange({ layout: true });\n            },\n            usesImage: function(img) {\n                return this._drawing.image === img\n                    || this._orig.image === img\n                    || this._previous.image === img;\n            }\n        });\n\n        var DrawingCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._drawing = options.drawing;\n            },\n            usesImage: function(img) {\n                return this._drawing.image === img;\n            }\n        });\n\n        kendo.spreadsheet.InsertImageCommand = DrawingCommand.extend({\n            init: function(options) {\n                DrawingCommand.fn.init.call(this, options);\n                this._blob = options.blob;\n                this._width = options.width;\n                this._height = options.height;\n            },\n            exec: function() {\n                var range = this.range();\n                var sheet = range.sheet();\n                var width = this._width;\n                var height = this._height;\n                var aspect = width / height;\n                if (width > height) {\n                    width = Math.min(width, 300);\n                    height = width / aspect;\n                } else {\n                    height = Math.min(height, 300);\n                    width = height * aspect;\n                }\n                this._drawing = sheet.addDrawing({\n                    topLeftCell : range.topLeft(),\n                    offsetX     : 5,\n                    offsetY     : 5,\n                    width       : width,\n                    height      : height,\n                    opacity     : 1,\n                    image       : this._workbook.addImage(this._blob)\n                }, true);\n                this._blob = null;\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = null;\n                sheet.removeDrawing(this._drawing);\n            },\n            redo: function() {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = this._drawing;\n                sheet.addDrawing(this._drawing);\n            }\n        });\n\n        kendo.spreadsheet.DeleteDrawingCommand = DrawingCommand.extend({\n            exec: function() {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = null;\n                sheet.removeDrawing(this._drawing);\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = this._drawing;\n                sheet.addDrawing(this._drawing);\n            },\n            redo: function() {\n                this.exec();\n            }\n        });\n\n        var ReorderDrawingsCommand = DrawingCommand.extend({\n            exec: function() {\n                var sheet = this.range().sheet();\n                this._origIndex = sheet._drawings.indexOf(this._drawing);\n                sheet._drawings.splice(this._origIndex, 1);\n                this._newIndex = this._reorder();\n                sheet._drawings.splice(this._newIndex, 0, this._drawing);\n                sheet.triggerChange({ drawings: true });\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet._drawings.splice(this._newIndex, 1);\n                sheet._drawings.splice(this._origIndex, 0, this._drawing);\n                sheet.triggerChange({ drawings: true });\n            }\n        });\n\n        kendo.spreadsheet.BringToFrontCommand = ReorderDrawingsCommand.extend({\n            _reorder: function() {\n                return this.range().sheet()._drawings.length;\n            }\n        });\n\n        kendo.spreadsheet.SendToBackCommand = ReorderDrawingsCommand.extend({\n            _reorder: function() {\n                return 0;\n            }\n        });\n\n        var TargetValueCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._target = options.target;\n                this._value = options.value;\n            },\n            exec: function() {\n                this.getState();\n                this.setState(this._value);\n            }\n        });\n\n        kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n            getState: function() {\n                this._state = this.range().sheet().columnWidth(this._target);\n            },\n            setState: function(state) {\n                this.range().sheet().columnWidth(this._target, state);\n            }\n        });\n\n        kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n            getState: function() {\n                this._state = this.range().sheet().rowHeight(this._target);\n            },\n            setState: function(state) {\n                this.range().sheet().rowHeight(this._target, state);\n            }\n        });\n\n        kendo.spreadsheet.HyperlinkCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._link = options.link;\n            },\n            exec: function() {\n                var range = this.range();\n                this._prevLink = range.link();\n                this._prevUnderline = range.underline();\n                range.link(this._link);\n                range.underline(true);\n                if (range.value() == null) {\n                    this._hasSetValue = true;\n                    range.value(this._link);\n                }\n            },\n            undo: function() {\n                var range = this.range();\n                range.link(this._prevLink);\n                range.underline(this._prevUnderline);\n                if (this._hasSetValue) {\n                    range.value(null);\n                }\n            }\n        });\n\n        kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n            getState: function() {\n                this._state = this._range.sheet().showGridLines();\n            },\n            setState: function(v) {\n                this._range.sheet().showGridLines(v);\n            }\n        });\n\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            _setRange: function(range) {\n                Command.prototype._setRange.call(this, range.skipHiddenCells());\n            },\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function() {\n                var range = this.range();\n                if (range.enable()) {\n                    this.getState();\n\n                    if (this.options.property === \"format\") {\n                        this._workbook.trigger(\"changeFormat\", { range: range });\n                    }\n\n                    range[this._property](this._value);\n                }\n            }\n        });\n\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function() {\n                var values = [], range, rowValues, nullValues, validationState, currentRange;\n                if (!this.range().enable()) {\n                    return { reason: \"error\", type: \"cannotModifyDisabled\" };\n                }\n                if (!this.range().canEditArrayFormula()) {\n                    return { reason: \"error\", type: \"intersectsArray\" };\n                }\n                this.getState();\n                range = this.range().skipHiddenCells();\n\n                if(range._ref.refs && range._ref.refs.length > 1) {\n                    range._ref.refs.forEach(function(ref) {\n                        currentRange = range.sheet().range(ref);\n                        values = values.concat(currentRange.values());\n                    });\n                } else {\n                    values = range.values();\n                }\n                nullValues = [];\n                values.forEach(function(row) {\n                    rowValues = [];\n                    row.forEach(function() {\n                        rowValues.push(null);\n                    });\n                    nullValues.push(rowValues);\n                });\n                if (range.sheet().trigger(\"changing\", { data: nullValues, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n                    return;\n                }\n                range.clearContent();\n                validationState = range._getValidationState();\n                if (validationState) {\n                    return this.rejectState(validationState);\n                }\n            },\n            undo: function() {\n                var range = this.range().skipHiddenCells();\n                var sheet = range.sheet();\n                var data = this._state.data;\n                var values = [];\n                var rowValues;\n                data.forEach(function(row) {\n                    rowValues = [];\n                    row.forEach(function(cell) {\n                        rowValues.push(cell.value);\n                    });\n                    values.push(rowValues);\n                });\n                if (sheet.trigger(\"changing\", { data: values, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function(options) {\n                options.property = options.property || \"input\";\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            _setRange: function(range) {\n                PropertyChangeCommand.prototype._setRange.apply(this, arguments);\n                this._editRange = this.options.arrayFormula ? range : range.sheet().activeCellSelection();\n            },\n            getState: function() {\n                this._state = this.range().getState();\n            },\n            exec: function() {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            undo: function() {\n                var editRange = this._editRange;\n                var state = this._state;\n                if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].value, range: editRange, changeType: COMMAND_TYPES.EDIT })) {\n                    return;\n                }\n                this.setState(this._state);\n            },\n            _exec: function() {\n                var arrayFormula = this.options.arrayFormula;\n                var editRange = this._editRange;\n\n                if (!editRange.enable()) {\n                    return { reason: \"error\", type: \"rangeDisabled\" };\n                }\n\n                if (!editRange.canEditArrayFormula()) {\n                    return { reason: \"error\", type: \"intersectsArray\" };\n                }\n\n                var value = this._value;\n                this.getState();\n                if (this.range().sheet().trigger(\"changing\", { data: value, range: this._editRange, changeType: COMMAND_TYPES.EDIT })) {\n                    return;\n                }\n\n                if (this._property == \"value\") {\n                    editRange.value(value);\n                    return;\n                }\n\n                try {\n                    editRange.link(null);\n                    if (value === \"\") {\n                        editRange.value(null);\n                    } else {\n                        editRange.input(value, { arrayFormula: arrayFormula });\n                        if (/\\n/.test(editRange.value())) {\n                            editRange.wrap(true);\n                        }\n                    }\n                    editRange._adjustRowHeight();\n\n                    var validationState = editRange._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch(ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title : \"Error in formula\",\n                            body  : ex+\"\",\n                            reason: \"error\"\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            }\n        });\n\n        kendo.spreadsheet.InsertCommentCommand = PropertyChangeCommand.extend({\n            init: function(options) {\n                options.property = \"comment\";\n                PropertyChangeCommand.fn.init.call(this, options);\n            }\n        });\n\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function(options) {\n                options.property = \"wrap\";\n                PropertyChangeCommand.fn.init.call(this, options);\n\n                this._value = options.value;\n            },\n            getState: function() {\n                var rowHeight = {};\n                this.range().forEachRow(function(range) {\n                    var index = range.topLeft().row;\n\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n\n                this.range().setState(this._state);\n\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function(options) {\n                this._delta = options.value;\n                options.property = \"format\";\n                Command.fn.init.call(this, options);\n            },\n            exec: function() {\n                var sheet = this.range().sheet();\n                var delta = this._delta;\n                var formatting = kendo.spreadsheet.formatting;\n\n                this.getState();\n\n                sheet.batch(function() {\n                    this.range().forEachCell(function(row, col, cell) {\n                        var format = cell.format;\n\n                        if (!format) {\n                            var value = cell.value;\n                            if (typeof value == \"number\" && /\\./.test(value)) {\n                                format = \"0.\" + String(value).split(\".\")[1].replace(/\\d/g, \"0\");\n                            }\n                        }\n\n                        if (format || delta > 0) {\n                            format = formatting.adjustDecimals(format || \"0\", delta);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function(options) {\n                options.property = \"border\";\n                Command.fn.init.call(this, options);\n                this._type = options.border || options.value.type;\n                this._style = options.style || { color: options.value.color, size: 1 };\n            },\n            _batch: function(f) {\n                return this.range().sheet().batch(f, {});\n            },\n            exec: function() {\n                var self = this;\n\n                if (!self._type) {\n                    return;\n                }\n\n                self.getState();\n                self._batch(function(){\n                    self[self._type](self._style);\n                });\n            },\n            noBorders: function() {\n                this.range().insideBorders(null);\n                this.outsideBorders(null);\n            },\n            allBorders: function(style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(style);\n            },\n            leftBorder: function(style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function(style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function(style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function(style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function(style) {\n                var range = this.range();\n                range.leftColumn().borderLeft(style);\n                range.topRow().borderTop(style);\n                range.rightColumn().borderRight(style);\n                range.bottomRow().borderBottom(style);\n            },\n            insideBorders: function(style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(null);\n            },\n            insideHorizontalBorders: function(style) {\n                this.range().insideHorizontalBorders(style);\n            },\n            insideVerticalBorders: function(style) {\n                this.range().insideVerticalBorders(style);\n            }\n        });\n\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function() {\n                this.getState();\n                this[this._type]();\n                this.range().sheet().triggerChange({ recalc: true });\n            },\n            activate: function(ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function() {\n                this._state = this.range().getState();\n            },\n            undo: function() {\n                if (this._type !== \"unmerge\") {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function() {\n                var range = this.range();\n                var ref = range._ref;\n\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function() {\n                var ref = this.range().topRow()._ref;\n\n                this.range().forEachRow(function(range) {\n                    range.merge();\n                });\n\n                this.activate(ref);\n            },\n            vertically: function() {\n                var ref = this.range().leftColumn()._ref;\n\n                this.range().forEachColumn(function(range) {\n                    range.merge();\n                });\n\n                this.activate(ref);\n            },\n            unmerge: function() {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function() {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function() {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function() {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function() {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function() {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function() {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function() {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._clipboard.parse();\n                this._event = options.event;\n                this._clipboardContent = this._clipboard._content;\n                this._sheet = this._workbook.activeSheet();\n                this._range = this._sheet.selection ? this._sheet.selection() : this._sheet.range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n                this._targetRangeRefs = (this._range._ref instanceof kendo.spreadsheet.UnionRef ? this._range._ref.refs : [this._range._ref]).map(function(ref){\n                    return ref.toRangeRef();\n                });\n            },\n            exec: function() {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            undo: function() {\n                var sheet = this._sheet;\n                var range = this._range;\n\n                if (sheet.trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n                    return;\n                }\n\n                this.setState(this._state);\n            },\n            _exec: function() {\n                var status = this._clipboard.canPaste();\n\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return { reason: \"error\", type: \"useKeyboard\" };\n                    }\n                    if (status.pasteOnMerged) {\n                        return { reason: \"error\", type: \"modifyMerged\" };\n                    }\n                    if (status.pasteOnDisabled) {\n                        this._event.preventDefault();\n                        return { reason: \"error\", type: \"cannotModifyDisabled\" };\n                    }\n                    return { reason: \"error\" };\n                }\n\n                var sheet = this._sheet;\n                var range = this._range;\n\n                if(this._workbook.trigger(\"paste\", {range: range, clipboardContent: this._clipboardContent}) ||\n                    sheet.trigger(\"changing\", { data: this._clipboardContent.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n                    this._event.preventDefault();\n                    return;\n                } else {\n                    this._processPaste();\n                }\n            },\n            _adjustPasteTarget: function(multipliers, sourceRows, sourceCols) {\n                var that = this;\n                var targetRangeRefs = that._targetRangeRefs;\n                var sheet = that._sheet;\n                var RangeRef = kendo.spreadsheet.RangeRef;\n                var UnionRef = kendo.spreadsheet.UnionRef;\n                var refs = [];\n                var compare = function (a, b) {\n                    var result = 0;\n                    var topLeftA = a.topLeft;\n                    var topLeftB = b.topLeft;\n\n                    if (topLeftA.row > topLeftB.row) {\n                        result = 1;\n                    } else if (topLeftA.row < topLeftB.row) {\n                        result = -1;\n                    } else if (topLeftA.col > topLeftB.col) {\n                        result = 1;\n                    } else if (topLeftA.col < topLeftB.col) {\n                        result = -1;\n                    }\n\n                    return result;\n                };\n\n                var refToSelect, rangeToSelect, ref, topLeft, multiplier, i, bottomRight;\n\n                for(i = 0; i < targetRangeRefs.length; i += 1) {\n                    ref = targetRangeRefs[i];\n                    multiplier = multipliers[i];\n                    topLeft = ref.topLeft;\n                    bottomRight = {\n                        row: multiplier.rows * sourceRows + topLeft.row - 1,\n                        col: multiplier.cols * sourceCols + topLeft.col - 1\n                    };\n\n                    refToSelect = new RangeRef(topLeft, bottomRight);\n                    refs.push(refToSelect);\n                }\n\n                if(refs.length === 1) {\n                    rangeToSelect = sheet.range(refToSelect);\n                } else {\n                    refs.sort(compare);\n                    rangeToSelect = sheet.range(new UnionRef(refs));\n                }\n\n                rangeToSelect.select();\n                that._range = rangeToSelect;\n                that._state = that._range.getState();\n            },\n            _processPaste: function() {\n                var that = this;\n                var sheet = that._sheet;\n                var clipboardContent = that._clipboardContent;\n                var range = that._range;\n                var sourceData = clipboardContent.data;\n                var sourceRows = sourceData.length;\n                var sourceCols = sourceData[0].length;\n                var targetRangeRefs = that._targetRangeRefs;\n                var multipliers = that._targetRanges(sourceRows, sourceCols);\n                var i;\n\n                var pasteRef = this._clipboard.pasteRef();\n                if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n                    sheet.resize(\n                        Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                        Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n                    );\n                }\n\n                that._adjustPasteTarget(multipliers, sourceRows, sourceCols);\n\n                sheet.batch(function() {\n                    for(i = 0; i < targetRangeRefs.length; i++) {\n                        that._populateTargetRange(targetRangeRefs[i], sourceRows, sourceCols, multipliers[i]);\n                    }\n                }, {\n                    recalc: true,\n                    ref: that._range._ref\n                });\n\n                range._adjustRowHeight();\n            },\n            _populateTargetRange: function(ref, sourceRows, sourceCols, multipliers) {\n                var topLeft = ref.topLeft;\n                var range, i, j;\n\n                for(i = 0; i < multipliers.rows; i++) {\n                    for(j = 0; j < multipliers.cols; j++) {\n                        range = this._sheet.range(topLeft.row + sourceRows * i, topLeft.col + sourceCols * j);\n                        range.setState(this._clipboardContent, this._clipboard);\n                    }\n                }\n            },\n            _targetRangeDimensions: function(ref, sourceRows, sourceCols) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var targetRangeRows = bottomRight.row - topLeft.row + 1;\n                var targetRangeCols = bottomRight.col - topLeft.col + 1;\n                var rowsMultiplier = 1;\n                var colsMultiplier = 1;\n\n                if((targetRangeRows % sourceRows === 0 && targetRangeCols % sourceCols === 0)) {\n                    rowsMultiplier = targetRangeRows / sourceRows;\n                    colsMultiplier = targetRangeCols / sourceCols;\n                }\n\n                return {\n                    rows: rowsMultiplier,\n                    cols: colsMultiplier\n                };\n            },\n            _targetRanges: function(sourceRows, sourceCols) {\n                var targetRangeRefs = this._targetRangeRefs;\n                var multipliers = [];\n                var i;\n\n                for(i = 0; i < targetRangeRefs.length; i++) {\n                    multipliers.push(this._targetRangeDimensions(targetRangeRefs[i], sourceRows, sourceCols));\n                }\n\n                return multipliers;\n            }\n        });\n\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function() {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n\n                range._adjustRowHeight();\n            }\n        });\n\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function() {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    //reason : focusclipbord\n                    document.execCommand('paste');\n                } else {\n                    return { reason: \"error\", type: \"useKeyboard\" };\n                }\n            }\n        });\n\n        kendo.spreadsheet.CutCommand = Command.extend({\n            _eventType: \"cut\",\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            exec: function() {\n                var status = this._clipboard.canCopy();\n                var data = [], rangeValues, currentRow;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return { reason: \"error\", type: \"useKeyboard\" };\n                    } else if (status.multiSelection) {\n                        return { reason: \"error\", type: \"unsupportedSelection\" };\n                    }\n                    return;\n                }\n                var range = this._workbook.activeSheet().selection();\n                if (this._eventType == \"cut\") {\n                    if (!range.enable()) {\n                        this._event.preventDefault();\n                        return { reason: \"error\", type: \"cannotModifyDisabled\" };\n                    }\n                    this.getState();\n                }\n                if (this._workbook.trigger(this._eventType, { range: range })) {\n                    this._event.preventDefault();\n                } else if (this._eventType == \"cut\") {\n                    rangeValues = range.values();\n                    rangeValues.forEach(function(row){\n                        currentRow = [];\n                        row.forEach(function(){\n                            currentRow.push({});\n                        });\n                        data.push(currentRow);\n                    });\n                    if (range.sheet().trigger(\"changing\", { data: data, range: range, changeType: COMMAND_TYPES.CUT })) {\n                        return;\n                    }\n                    this._clipboard.cut();\n                } else {\n                    this._clipboard.copy();\n                }\n            },\n            undo: function() {\n                var range = this.range();\n                if (range.sheet().trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.CUT })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n\n        kendo.spreadsheet.CopyCommand = kendo.spreadsheet.CutCommand.extend({\n            _eventType: \"copy\",\n            undo: $.noop\n        });\n\n        // function copyToClipboard(html) {\n        //     var textarea = document.createElement('textarea');\n        //     $(textarea).addClass(\"k-spreadsheet-clipboard\")\n        //         .val(html)\n        //         .appendTo(document.body)\n        //         .trigger(\"focus\")\n        //         .select();\n\n        //     document.execCommand('copy');\n\n        //     $(textarea).remove();\n        // }\n\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function() {\n                if (kendo.support.clipboard.copy) {\n                    document.execCommand('copy');\n                } else {\n                    return { reason: \"error\", type: \"useKeyboard\" };\n                }\n            }\n        });\n\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function(origin) {\n                this._origin = origin;\n            },\n            exec: function() {\n                var range = this.range(), autoFillData;\n                if (!range.enable()) {\n                    return { reason: \"error\", type: \"rangeDisabled\" };\n                }\n                if (range.intersectingArrayFormula()) {\n                    return { reason: \"error\", type: \"intersectsArray\" };\n                }\n                this.getState();\n                try {\n                    autoFillData = range._previewFillFrom(this._origin);\n                    if (range.sheet().trigger(\"changing\", { data: autoFillData.props, range: autoFillData.dest, changeType: COMMAND_TYPES.AUTO_FILL })) {\n                        return;\n                    }\n                    autoFillData.dest._properties(autoFillData.props, true);\n                } catch(ex) {\n                    if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                        return { reason: \"error\", type: ex.code };\n                    }\n                    throw ex;\n                }\n            },\n            undo: function() {\n                var range = this.range();\n                var state = this._state;\n                if (range.sheet().trigger(\"changing\", { data: state.data, range: range, changeType: COMMAND_TYPES.AUTO_FILL })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            cannotUndo: true,\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function() {\n                if (kendo.support.clipboard.copy) {\n                    document.execCommand('cut');\n                } else {\n                    return { reason: \"error\", type: \"useKeyboard\" };\n                }\n            }\n        });\n\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function() {\n                this.range().filter(this._state);\n            },\n            exec: function() {\n                var range = this.range();\n                this._state = range.hasFilter();\n                range.filter(!this._state);\n            }\n        });\n\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function() {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : (this.options.column || 0);\n                var ascending = this.options.value === \"asc\" ? true : false;\n\n                this._state = sheet.getState();\n\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n\n                var reason = range.cantSort();\n                if (reason) {\n                    return { reason: \"error\", type: reason.code };\n                }\n\n                range.sort({ column: col, ascending: ascending });\n            },\n            expandRange: function() {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function() {\n                return this.options.column || 0;\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n\n                sheet.clearFilter(this.column());\n\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function() {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n\n                if (current) {\n                    this._state = current.columns.filter(function(c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function() {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n\n                if (this.options.valueFilter) {\n                    filterRule = { column: column, filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter) };\n                } else if (this.options.customFilter) {\n                    filterRule = { column: column, filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter) };\n                }\n\n                this.getState();\n\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function(element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n\n                    options = current.columns.map(function(element) {\n                        return element.index === column ? filterRule : { column: element.index, filter: element.filter };\n                    });\n\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n\n                range.filter(options);\n            }\n        });\n\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function() {\n                var range = this.range();\n                var column = this.column();\n\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n\n            exec: function() {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n\n                if (this.axis == \"row\") {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function() {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n\n                if (this.axis == \"row\") {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n\n        var DeleteCommand = Command.extend({\n            exec: function() {\n                this._expandedRange = this._expand(this.range());\n                this._state = this._expandedRange.getState();\n                this._indexes = this._exec(this._expandedRange.sheet());\n            },\n            undo: function() {\n                var self = this;\n                var range = self._expandedRange;\n                var sheet = range.sheet();\n                sheet.batch(function(){\n                    self._indexes.forEach(function(x){\n                        self._undoOne(sheet, x);\n                        sheet._restoreModifiedFormulas(x.formulas);\n                    });\n                    range.setState(self._state);\n                }, { layout: true, recalc: true, ref: range._ref, isValue: true });\n            }\n        });\n\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            _expand: function(range) {\n                return range.resize({ left: -Infinity, right: +Infinity });\n            },\n            _exec: function(sheet) {\n                return sheet.axisManager().deleteSelectedRows();\n            },\n            _undoOne: function(sheet, x) {\n                sheet.insertRow(x.index);\n                sheet.rowHeight(x.index, x.height);\n            }\n        });\n\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            _expand: function(range) {\n                return range.resize({ top: -Infinity, bottom: +Infinity });\n            },\n            _exec: function(sheet) {\n                return sheet.axisManager().deleteSelectedColumns();\n            },\n            _undoOne: function(sheet, x) {\n                sheet.insertColumn(x.index);\n                sheet.columnWidth(x.index, x.width);\n            }\n        });\n\n        var AddCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function() {\n                var self = this;\n                var sheet = self.range().sheet();\n                sheet.batch(function(){\n                    for (var i = self._pos.count; --i >= 0;) {\n                        self._undoOne(sheet, self._pos.base);\n                    }\n                }, { layout: true, recalc: true });\n            }\n        });\n\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function() {\n                var value = this._value;\n                var sheet = this.range().sheet();\n\n                if (value === \"left\") {\n                    this._pos = sheet.axisManager().addColumnLeft();\n                } else {\n                    this._pos = sheet.axisManager().addColumnRight();\n                }\n            },\n            _undoOne: function(sheet, index) {\n                sheet.deleteColumn(index);\n            }\n        });\n\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function() {\n                var value = this._value;\n                var sheet = this.range().sheet();\n\n                if (value === \"above\") {\n                    this._pos = sheet.axisManager().addRowAbove();\n                } else {\n                    this._pos = sheet.axisManager().addRowBelow();\n                }\n            },\n            _undoOne: function(sheet, index) {\n                sheet.deleteRow(index);\n            }\n        });\n\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function() {\n                var self = this, sheet = self.range().sheet();\n                this.getState();\n                if (sheet.trigger(\"changing\", { data: self._value, range: self.range(), changeType: COMMAND_TYPES.VALIDATION })) {\n                    return;\n                }\n                try {\n                    sheet.withCultureDecimals(function(){\n                        self.range().validation(self._value);\n                    });\n                } catch(ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title : \"Error in formula\",\n                            body  : ex+\"\",\n                            reason: \"error\"\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            },\n            undo: function() {\n                var editRange = this.range();\n                var state = this._state;\n                if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].validation, range: editRange, changeType: COMMAND_TYPES.VALIDATION })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            cannotUndo: true,\n            exec: function() {\n                var file = this.options.value;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return { reason: \"error\", type: \"openUnsupported\" };\n                }\n\n                var workbook = this.options.workbook;\n                workbook.fromFile(this.options.value).then(function(){\n                    var errors = workbook.excelImportErrors;\n                    if (errors && errors.length) {\n                        workbook._view.openDialog(\"importError\", {\n                            errors: errors\n                        });\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            cannotUndo: true,\n            exec: function() {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === \".xlsx\") {\n                    this.options.workbook.saveAsExcel({\n                        fileName: fileName\n                    });\n                } else if (this.options.extension === \".pdf\") {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {workbook: this.options.workbook, fileName: fileName}));\n                }\n            }\n        });\n\n        var NameCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._name = options.name;\n                this._value = options.value;\n            },\n            getState: function() {\n                this._state = this._workbook.nameDefinition(this._name);\n            },\n            setState: function() {\n                this._workbook.nameDefinition(this._name, this._state);\n                this._workbook.trigger(\"change\", { recalc: true });\n            }\n        });\n\n        kendo.spreadsheet.DefineNameCommand = NameCommand.extend({\n            exec: function() {\n                this.getState();\n                try {\n                    this._workbook.defineName(this._name, this._value);\n                    this._workbook.trigger(\"change\", { recalc: true });\n                } catch(ex) {\n                    return {\n                        title: \"Error\",\n                        body: ex+\"\",\n                        reason: \"error\"\n                    };\n                }\n            }\n        });\n\n        kendo.spreadsheet.DeleteNameCommand = NameCommand.extend({\n            exec: function() {\n                this.getState();\n                this._workbook.undefineName(this._name);\n                this._workbook.trigger(\"change\", { recalc: true });\n            }\n        });\n\n    })(kendo);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n\n        var classNames = {\n            wrapper: \"k-spreadsheet-formula-bar\"\n        };\n\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                kendo.ui.Widget.call(this, element, options);\n\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n\n                $(kendo.ui.icon(\"formula-fx\")).prependTo(element);\n\n                var formulaBarWidth = element.width();\n\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($(\"<div/>\")\n                    .appendTo(element), { formulaBarWidth: formulaBarWidth, messages: (options || {}).messages });\n            },\n\n            destroy: function() {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    })(window.kendo);\n\n    (function(kendo, window) {\n\n\n\n\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = \".kendoFormulaInput\";\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: \"k-spreadsheet-formula-input\",\n            listWrapper: \"k-spreadsheet-formula-list\"\n        };\n        var styles = [\n            \"font-family\",\n            \"font-size\",\n            \"font-stretch\",\n            \"font-style\",\n            \"font-weight\",\n            \"letter-spacing\",\n            \"text-transform\",\n            \"line-height\"\n        ];\n\n        //move to core\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n\n        var FormulaInput = Widget.extend({\n            init: function(element, options) {\n                Widget.call(this, element, options);\n                var formulaInputTitle = ((options || {}).messages || {}).formulaInput || \"Formula Input\";\n\n                element = this.element;\n\n                element.addClass(FormulaInput.classNames.wrapper)\n                    .attr('aria-haspopup', 'menu')\n                    .attr('role', 'combobox')\n                    .attr('title', formulaInputTitle)\n                    .attr('aria-expanded', false)\n                    .attr(\"contenteditable\", true)\n                    .attr(\"spellcheck\", false)\n                    .css(\"white-space\", \"pre\");\n\n                if (options && options.formulaBarWidth) {\n                    element.css(\"max-width\", options.formulaBarWidth - 16 + \"px\");\n                }\n\n                if (this.options.autoScale) {\n                    element.on(\"input\", this.scale.bind(this));\n                }\n\n                this._highlightedRefs = [];\n\n                this._formulaSource();\n\n                this._formulaList();\n\n                this._popup();\n\n                this._tooltip();\n\n                element\n                    .on(\"keydown\", this._keydown.bind(this))\n                    .on(\"keyup\", this._keyup.bind(this))\n                    .on(\"blur\", this._blur.bind(this))\n                    .on(\"input click\", this._input.bind(this))\n                    .on(\"focus\", this._focus.bind(this))\n                    .on(\"paste\", this._paste.bind(this));\n            },\n\n            options: {\n                name: \"FormulaInput\",\n                autoScale: false,\n                filterOperator: \"startswith\",\n                scalePadding: 30,\n                minLength: 1,\n                formulaBarWidth: null\n            },\n\n            events: [\n                \"keyup\",\n                \"focus\"\n            ],\n\n            enable: function(enable) {\n                if (enable === undefined) {\n                    return this.element.attr(\"contenteditable\") === \"true\";\n                }\n\n                if (enable) {\n                    this.element.attr(\"contenteditable\", enable);\n                } else {\n                    this.element.removeAttr(\"contenteditable\");\n                }\n\n                this.element.toggleClass(\"k-disabled\", !enable);\n            },\n\n            getPos: function() {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return { begin: a, end: b, collapsed: a == b };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node){\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1 /* Element */) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3 /* Text */) {\n                                pos += node.nodeValue.length;\n                            }\n                        })(div);\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n\n            setPos: function(begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange))  {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return (\n                        a.startOffset != b.startOffset ||\n                        a.endOffset != b.endOffset ||\n                        a.startContainer != b.endContainer ||\n                        a.endContainer != b.endContainer\n                    );\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node){\n                            if (node.nodeType == 3 /* Text */) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1 /* Element */) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        })(node);\n                    } catch (el) {\n                        return { node: el, pos: pos };\n                    }\n                }\n            },\n\n            end: function() {\n                this.setPos(this.length());\n            },\n\n            home: function() {\n                this.setPos(0);\n            },\n\n            select: function() {\n                this.setPos(0, this.length());\n            },\n\n            length: function() {\n                return this.value().length;\n            },\n\n            _formulaSource: function() {\n                var result = [];\n                var value;\n\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({ value: value, text: value });\n                    }\n                }\n\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n\n            _formulaList: function() {\n                var listId = kendo.guid();\n                this.element.attr(\"aria-controls\", listId);\n                this.list = new kendo.ui.StaticList($(`<ul id=\"${listId}\" />`)\n                    .addClass(FormulaInput.classNames.listWrapper)\n                    .insertAfter(this.element), {\n                        aria: {\n                            role: 'menu',\n                            itemRole: 'menuitem'\n                        },\n                        autoBind: false,\n                        selectable: true,\n                        change: this._formulaListChange.bind(this),\n                        dataSource: this.formulaSource,\n                        dataValueField: \"value\",\n                        template: \"#:data.value#\"\n                    });\n\n                this.list.element.on(\"mousedown\", function(e) {\n                    e.preventDefault();\n                });\n            },\n\n            _formulaListChange: function() {\n                var tokenCtx = this._tokenContext();\n\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != \"(\") {\n                    completion += \"(\";\n                }\n\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n\n            _popup: function() {\n                var formulaInputEl = this.element;\n                this.popup = new kendo.ui.Popup(this.list.element, {\n                    anchor: this.element,\n                    open: function(ev) { formulaInputEl.attr(\"aria-expanded\", true); },\n                    close: function(ev) { formulaInputEl.attr(\"aria-expanded\", false); }\n                });\n            },\n\n            _blur: function() {\n                this.popup.close();\n                clearTimeout(this._focusId);\n                this.trigger(\"blur\");\n            },\n\n            _isFormula: function() {\n                return /^=/.test(this.value());\n            },\n\n            _keydown: function(e) {\n                var key = e.keyCode;\n                var that = this;\n\n                if (KEY_NAMES[key]) {\n                    that.popup.close();\n                    that._navigated = true;\n                } else if (that._move(key)) {\n                    that._navigated = true;\n                    e.preventDefault();\n                }\n\n                that._keyDownTimeout = setTimeout(that._syntaxHighlight.bind(that));\n            },\n\n            _keyup: function() {\n                var popup = this.popup;\n                var value;\n\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n\n                    this.filter(value);\n\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? \"position\" : \"open\"]();\n                        this.list.focusFirst();\n                    }\n                }\n\n                this._navigated = false;\n                this._syntaxHighlight();\n\n                this.trigger(\"keyup\");\n            },\n\n            _input: function() {\n                this._syntaxHighlight();\n            },\n\n            _focus: function() {\n                setTimeout(this._sync.bind(this));\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger(\"focus\");\n            },\n\n            _paste: function(ev) {\n                ev.preventDefault();\n                var pos = this.getPos();\n                var text;\n                if (kendo.support.browser.msie) {\n                    text = window.clipboardData.getData(\"Text\");\n                } else {\n                    text = ev.originalEvent.clipboardData.getData(\"text/plain\");\n                }\n                var val = this.value();\n                val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n                this.value(val);\n                this.setPos(pos.begin + text.length);\n                this.scale();\n            },\n\n            _move: function(key) {\n                var list = this.list;\n                var popup = this.popup;\n                if (popup.visible()) {\n                    if (key === keys.DOWN) {\n                        list.focusNext();\n                        if (!list.focus()) {\n                            list.focusFirst();\n                        }\n                        return true;\n                    }\n                    if (key === keys.UP) {\n                        list.focusPrev();\n                        if (!list.focus()) {\n                            list.focusLast();\n                        }\n                        return true;\n                    }\n                    if (key === keys.ENTER) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.TAB) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.PAGEUP) {\n                        list.focusFirst();\n                        return true;\n                    }\n                    if (key === keys.PAGEDOWN) {\n                        list.focusLast();\n                        return true;\n                    }\n                }\n                return key === keys.ENTER || key === keys.TAB;\n            },\n\n            _tokenContext: function() {\n                var point = this.getPos();\n                var value = this.value();\n\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return { token: tok, nextToken: tokens[i + 1] };\n                    }\n                }\n\n                return null;\n            },\n\n            _sync: function() {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n\n            _textContainer: function() {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n\n                computedStyles.position = \"absolute\";\n                computedStyles.visibility = \"hidden\";\n                computedStyles.whiteSpace = \"pre\";\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n\n                this._span = $(\"<span style='white-space: pre'/>\").css(computedStyles).insertAfter(this.element);\n            },\n\n            _tooltip: function() {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n\n            tooltip: function(value) {\n                this._cellTooltip.text(value);\n            },\n\n            toggleTooltip: function(show) {\n                this._cellTooltip.toggle(show);\n            },\n\n            isActive: function() {\n                return this.element[0] === kendo._activeElement();\n            },\n\n            filter: function(value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n\n            hide: function() {\n                this.enable(false);\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n\n            show: function() {\n                this.enable(true);\n                this.element.show();\n            },\n\n            row: function() {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n\n            col: function() {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n\n            position: function(rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n\n                this.show();\n\n                this.element\n                    .css({\n                        \"top\": rectangle.top + 1 + \"px\",\n                        \"left\": rectangle.left + 1 + \"px\"\n                    });\n\n                this._cellTooltip.css({\n                    \"top\": (rectangle.top - this._cellTooltip.height() - 10) + \"px\",\n                    \"left\": rectangle.left\n                });\n            },\n\n            resize: function(rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n\n            canInsertRef: function(isKeyboardAction) {\n                return this._canInsertRef(isKeyboardAction);\n            },\n\n            _canInsertRef: function(isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i-1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n\n                return null;\n\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return { replace: true, token: tok, end: tok.end };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i+1]);\n                            }\n                            return canInsertBetween(tokens[i-1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return { token: left, end: point.end };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == \"op\" && /^(?:punc|op)$/.test(right.type)) {\n                            return { token: left, end: point.end };\n                        }\n                    } else {\n                        if (left.type == \"startexp\") {\n                            return { token: left, end: point.end };\n                        }\n                        if (/^(?:op|punc)$/.test(left.type) && /^[,;({]$/.test(left.value)) {\n                            return { token: left, end: point.end };\n                        }\n                        if (/^(?:ref|sym)/.test(left.type)) {\n                            return { token: left, replace: true, end: left.end };\n                        }\n                        if (/^(?:ref|sym)/.test(right.type)) {\n                            return { token: right, replace: true, end: right.end };\n                        }\n                    }\n                    return false;\n                }\n            },\n\n            refAtPoint: function(sheet) {\n                var x = this._canInsertRef();\n                if (x) {\n                    var ref = sheet.selection()._ref.simplify().clone().relative(0, 0, 3);\n                    if (sheet.isMerged(ref)) {\n                        ref = ref.topLeft;\n                    }\n                    if (sheet !== this.activeSheet) {\n                        ref = ref.setSheet(sheet.name(), true);\n                    }\n                    this._replaceAt(x, ref.print(0, 0));\n                }\n            },\n\n            _replaceAt: function(ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n            },\n\n            syncWith: function(formulaInput) {\n                var self = this;\n\n                // IE does not support \"input\" event on elements with contenteditable\n                // https://developer.mozilla.org/en-US/docs/Web/Events/input#Browser_compatibility\n                var eventName = \"input\" + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = \"keydown\" + ns;\n                    iehandler = function() {\n                        setTimeout(handler);\n                    };\n                }\n\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n\n            scale: function() {\n                var element = this.element;\n                var width, height;\n                var horizontalBorders = $(\".k-spreadsheet-haxis\", element.context);\n\n                if (!this._span) {\n                    this._textContainer();\n                }\n\n                this._span.html(element.html());\n\n                width = this._span.width() + this.options.scalePadding;\n                height = this._span.height() - horizontalBorders.outerHeight();\n\n                if (width > element.width()) {\n                    element.width(width);\n                }\n                if (height > element.height()) {\n                    element.height(height);\n                }\n\n                this._sync();\n            },\n\n            _value: function(value) {\n                this.element.text(value);\n            },\n\n            value: function(value) {\n                if (value === undefined) {\n                    // jQuery's .text() discards the newlines for some reason\n                    var txt = this.element[0].innerText;\n                    return txt.replace(/\\n$/, \"\");\n                }\n\n                this._value(value);\n                this._syntaxHighlight();\n            },\n\n            highlightedRefs: function() {\n                return this._highlightedRefs.slice();\n            },\n\n            _syntaxHighlight: function() {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n\n                if (pos && !pos.collapsed) {\n                    // Backward selection (hold shift, move right to left)\n                    // will not work properly if we continuously re-set\n                    // the HTML.  If the selection is on, presumably the\n                    // text has already been highlighted, so stop here.\n                    return;\n                }\n\n                if (!(/^=/.test(value))) {\n                    // if an user deleted the initial =, reset the text to\n                    // discard any highlighting.  Only do that once.\n                    if (this._highlightedRefs.length) {\n                        this._highlightedRefs = [];\n                        this.element.text(value);\n                    }\n\n                    // also make sure the completion popup goes away\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n\n                    return; // avoid messing with the cursor position below\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function(tok){\n                        tok.active = false;\n                        tok.cls = [ \"k-syntax-\" + tok.type ];\n\n                        if (tok.type == \"ref\") {\n                            tok.colorClass = refClasses[(refIndex++) % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == \"punc\") {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push(\"k-syntax-paren-match\");\n                                            open.cls.push(\"k-syntax-paren-match\");\n                                        }\n                                    } else {\n                                        tok.cls.push(\"k-syntax-error\");\n                                        open.cls.push(\"k-syntax-error\");\n                                    }\n                                } else {\n                                    tok.cls.push(\"k-syntax-error\");\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push(\"k-syntax-at-point\");\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == \"func\" && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push(\"k-syntax-error\");\n                        }\n                    });\n                    tokens.reverse().forEach(function(tok){\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) +\n                            \"<span class='\" + tok.cls.join(\" \") + \"'>\" + text + \"</span>\" +\n                            value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n\n                this._highlightedRefs = highlightedRefs;\n            },\n\n            destroy: function() {\n                this._editorToSync = null;\n\n                this.element.off(ns);\n\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n\n                this._cellTooltip = null;\n                this._span = null;\n\n                this.popup.destroy();\n                this.popup = null;\n\n                if (this.list) {\n                    this.list.destroy();\n                }\n\n                Widget.fn.destroy.call(this);\n            },\n\n            insertNewline: function() {\n                var val = this.value();\n                var pos = this.getPos();\n                var eof = pos.end == val.length;\n                val = val.substr(0, pos.begin) + (eof ? \"\\n\\n\" : \"\\n\" + val.substr(pos.end));\n                this.value(val);\n                this.setPos(pos.begin + 1);\n            }\n        });\n\n        function isOpenParen(ch) {\n            return ch == \"(\" || ch == \"[\" || ch == \"{\";\n        }\n\n        function isCloseParen(ch) {\n            return ch == \")\" || ch == \"]\" || ch == \"}\";\n        }\n\n        function isMatchingParen(close, open) {\n            return open == \"(\" ? close == \")\"\n                :  open == \"[\" ? close == \"]\"\n                :  open == \"{\" ? close == \"}\"\n                :  false;\n        }\n\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    })(kendo, window);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n        var isAlphaNum = function(keyCode) {\n            if ((keyCode > 47 && keyCode < 58)   || // number keys\n                (keyCode > 64 && keyCode < 91)   || // letter keys\n                (keyCode > 95 && keyCode < 112)  || // numpad keys\n                (keyCode > 185 && keyCode < 193) || // ;=,-./` (in order)\n                (keyCode > 218 && keyCode < 223) || // [\\]' (in order)\n                (keyCode === 229)                   // combined key event?\n               ) {\n                return true;\n            }\n\n            return false;\n        };\n\n        var keyName = function(event) {\n            var keyCode = event.keyCode;\n            var name = KEY_NAMES[keyCode];\n\n            if (!name && isAlphaNum(keyCode)) {\n                name = \":alphanum\";\n            }\n\n            // https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key\n            //\n            // Fix for https://github.com/telerik/kendo-ui-core/issues/2284\n            // (starting editor with `=` on Firefox)\n            if (!name && event.key && event.key.length == 1) {\n                name = \":alphanum\";\n            }\n\n            return name;\n        };\n\n        var EventListener = kendo.Class.extend({\n            init: function(target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.touchProxy = this.touch.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n\n                target.on(\"keydown\", this.keyDownProxy);\n                target.on(\"contextmenu mousedown cut copy paste scroll wheel click dblclick focus\", this.mouseProxy);\n                target.on(\"touchmove touchend\", this.touchProxy);\n\n                $(document.documentElement).on(\"mousemove mouseup\", this.mouseProxy);\n                $(document.documentElement).on(\"touchmove touchend\", this.touchProxy);\n\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n\n            keyDown: function(e) {\n                // Do not handle keys for Toolbar Tab switch shortcuts\n                if (e.altKey && (e.key === \"n\" || e.key === \"h\" || e.key === \"a\")) {\n                    return;\n                }\n\n                this.handleEvent(e, keyName(e.originalEvent));\n            },\n\n            touch: function(e) {\n                this.handleEvent(e, e.type);\n            },\n\n            mouse: function(e) {\n                var rightClick;\n\n                if (e.which) {\n                    rightClick = (e.which == 3);\n                } else if (e.button) {\n                    rightClick = (e.button == 2);\n                }\n\n                var type = e.type;\n\n                if (type === \"mousedown\") {\n                    if (rightClick) {\n                       type = \"rightmousedown\";\n                    } else {\n                        this._pressLocation = { x: e.pageX, y: e.pageY };\n                    }\n                }\n\n                if (type === \"mouseup\") {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n\n                if (type === \"mousemove\" && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx*dx + dy*dy);\n\n                    if (distance > this.threshold) {\n                        type = \"mousedrag\";\n                    }\n                }\n\n                this.handleEvent(e, type);\n            },\n\n            handleEvent: function(e, name) {\n                var eventKey = \"\";\n\n                e.mod = Mac ? e.metaKey : (e.ctrlKey && !e.altKey);\n\n                if (e.altKey) {\n                    eventKey += \"alt+\";\n                }\n\n                if (e.shiftKey) {\n                    eventKey += \"shift+\";\n                }\n\n                if (e.ctrlKey) {\n                    eventKey += \"ctrl+\";\n                }\n\n                eventKey += name;\n\n                var catchAllHandler = this._handlers['*+' + name];\n\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n\n                var handler = this._handlers[eventKey];\n\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n\n            on: function(event, callback) {\n                var handlers = this._handlers;\n\n                if (typeof callback === \"string\") {\n                    callback = this._observer[callback];\n                }\n\n                if (typeof event === \"string\") {\n                    event = event.split(\",\");\n                }\n\n                event.forEach(function(e) {\n                    handlers[e] = callback;\n                });\n            },\n\n            destroy: function() {\n                this.target.off(\"keydown\", this.keyDownProxy);\n                this.target.off(\"keydown\", this.mouseProxy);\n                $(document.documentElement).off(\"mousemove mouseup\", this.mouseProxy);\n            }\n        });\n\n        kendo.spreadsheet.EventListener = EventListener;\n    })(window.kendo);\n\n    (function(kendo) {\n\n\n\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n\n        var NilNode = new (function NIL() { \n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        })();\n\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n\n            return node;\n        }\n\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n\n            return node;\n        }\n\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start > value.start) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n\n            return split(skew(node));\n        }\n\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n\n            if (node.left.level < (node.level - 1) || node.right.level < (node.level - 1)) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n\n            return node;\n        }\n\n        var Range = kendo.Class.extend({\n            init: function ValueRange(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n\n            intersects: function(range) {\n                return range.start <= this.end && range.end >= this.start;\n            },\n\n            clone: function() {\n                return new Range(this.start, this.end, this.value);\n            }\n        });\n\n        var RangeTree = kendo.Class.extend({\n            init: function RangeTree() {\n                this.root = NilNode;\n            },\n\n            insert: function(value) {\n                this.root = insert(this.root, value);\n            },\n\n            remove: function(value) {\n                this.root = remove(this.root, value);\n            },\n\n            findrange: function(value) {\n                var node = this.root;\n\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n\n                return null;\n            },\n\n            values: function() {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n\n            intersecting: function(start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n\n            map: function(callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n\n            forEach: function(callback) {\n                forEach(this.root, callback);\n            },\n\n            clone: function() {\n                return this.map(function(value) {\n                    return value.clone();\n                });\n            },\n\n            first: function() {\n                var first = this.root;\n                while(first.left != NilNode) {\n                    first = first.left;\n                }\n\n                return first;\n            },\n\n            last: function() {\n                var last = this.root;\n                while(last.right != NilNode) {\n                    last = last.right;\n                }\n\n                return last;\n            }\n        });\n\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n\n            var value = node.value;\n\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n\n        function forEach(root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            forEach(root.left, callback);\n            callback(root.value);\n            forEach(root.right, callback);\n        }\n\n        var RangeList = kendo.Class.extend({\n            init: function RangeList(start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n\n            values: function() {\n                return this.tree.values();\n            },\n\n            map: function(callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n\n            forEach: function(callback) {\n                this.tree.forEach(callback);\n            },\n\n            intersecting: function(start, end) {\n                return this.tree.intersecting(start, end);\n            },\n\n            first: function() {\n                return this.tree.first().value;\n            },\n\n            last: function() {\n                return this.tree.last().value;\n            },\n\n            insert: function(start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n\n            value: function(start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n\n                        this.tree.remove(range);\n\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n\n                this.insert(start, end, value);\n            },\n\n            expandedValues: function(start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n\n                var rangeIndex = 0;\n\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex ++;\n                    }\n\n                    result.push({ index: i - start, value: ranges[rangeIndex].value });\n                }\n\n                return result;\n            },\n\n            sortedIndices: function(start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n\n                var comparer = function(a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n\n                    return valueComparer(a.value, b.value);\n                };\n\n                if (indices) {\n                    comparer = function(a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n\n                        return a.index - b.index;\n                    };\n                }\n\n                result.sort(comparer);\n\n                return result;\n            },\n\n            sort: function(start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n\n                var values = this.expandedValues(start, end);\n\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n\n            copy: function(sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n\n                var start = targetStart;\n                var end;\n\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n\n                    var rangeEnd = values[i].end;\n\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n\n                    end = start + (rangeEnd - rangeStart);\n\n                    this.value(start, end, values[i].value);\n\n                    start = ++end;\n                }\n            },\n\n            iterator: function(start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n\n            getState: function() {\n                return this.tree.clone();\n            },\n\n            setState: function(state) {\n                this.tree = state.clone();\n            },\n\n            toJSON: function() {\n                return this.values();\n            },\n\n            fromJSON: function(values) {\n                values.forEach(function(v){\n                    this.value(v.start, v.end, v.value);\n                }, this);\n            }\n        });\n\n        var Iterator = kendo.Class.extend({\n            init: function(start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n\n            unique: function() {\n                return this.ranges.map(function(range) {\n                    return range.value;\n                });\n            },\n\n            at: function(index) {\n                while (this.ranges[this.index] && this.ranges[this.index].end < index) {\n                    this.index ++;\n                }\n\n                return this.ranges[this.index] && this.ranges[this.index].value;\n            },\n\n            forEach: function(callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n\n                this.index = 0;\n            }\n        });\n\n        var SparseRangeList = RangeList.extend({\n            init: function(start, end, value) {\n                this._defaultValue = value;\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n\n            intersecting: function(start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n\n                if (!ranges.length) {\n                    return [this.range];\n                }\n\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n\n                    result.push(range);\n                    start = range.end + 1;\n                }\n\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n\n                return result;\n            },\n\n            insert: function(start, end, value) {\n                if (value == null) {\n                    value = this._defaultValue;\n                }\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n\n            lastRangeStart: function() {\n                var node = this.tree.root;\n\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n\n                while(node.right !== NilNode) {\n                    node = node.right;\n                }\n\n                return node.value.end + 1;\n            }\n        });\n\n\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    })(kendo);\n\n    (function(kendo) {\n\n        var Property = kendo.Class.extend({\n            init: function(list) {\n                this.list = list;\n            },\n\n            get: function(index) {\n                return this.parse(this.list.value(index, index));\n            },\n\n            set: function(start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n\n                this.list.value(start, end, value);\n            },\n\n            parse: function(value) {\n                return value;\n            },\n\n            copy: function(start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n\n            iterator: function(start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n\n        var JsonProperty = Property.extend({\n            set: function(start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n\n            parse: function(value) {\n                return JSON.parse(value);\n            }\n        });\n\n        var ValueProperty = Property.extend({\n            init: function(values, formats) {\n                Property.prototype.init.call(this, values);\n                this.formats = formats;\n            },\n\n            set: function(start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    if (!this.formats.value(start,end)) {\n                        this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                    }\n                } else if (typeof value == \"number\") {\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n\n                this.list.value(start, end, value);\n            }\n        });\n\n        function toExcelFormat(format) {\n            return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n        }\n\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                { property: Property, name: \"format\", value: null, sortable: true, serializable: true },\n                { property: ValueProperty, name: \"value\", value: null, sortable: true, serializable: true, depends: \"format\" },\n                { property: Property, name: \"formula\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"background\", value: null, sortable: true, serializable: true },\n                { property: JsonProperty, name: \"vBorders\", value: null, sortable: false, serializable: false },\n                { property: JsonProperty, name: \"hBorders\", value: null, sortable: false, serializable: false },\n                { property: JsonProperty, name: \"dBorders\", value: null, sortable: false, serializable: true },\n                { property: Property, name: \"color\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"fontFamily\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"underline\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"fontSize\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"italic\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"bold\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"textAlign\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"indent\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"verticalAlign\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"wrap\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"validation\", value: null, sortable: false, serializable: true },\n                { property: Property, name: \"enable\", value: null, sortable: false, serializable: true },\n                { property: Property, name: \"link\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"editor\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"comment\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"html\", value: null, sortable: true, serializable: true }\n            ],\n\n            init: function(rowCount, columnCount, defaultValues) {\n                defaultValues = defaultValues || {};\n                var cellCount = rowCount * columnCount - 1;\n\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this.cellCount = cellCount;\n                this.properties = {};\n                this.lists = {};\n\n                this.specs.forEach(function(spec) {\n                    var name = spec.name;\n                    var value = defaultValues[name];\n                    if (value === undefined) {\n                        value = spec.value;\n                    }\n                    this.lists[name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, value);\n                    var prop = this.properties[name] = new spec.property(this.lists[name], this.lists[spec.depends]);\n                    prop.spec = spec;\n                }, this);\n\n                // XXX: this is a hack but I have no better ideas at this\n                // point.  The getState() method in a SparseRangeList\n                // clones the tree (which just copies values over), but\n                // formulas are objects maintaining complex state.\n                // https://github.com/telerik/kendo-ui-core/issues/2816\n                this.lists.formula.tree.clone = cloneFormulaTree;\n                this.lists.validation.tree.clone = cloneFormulaTree;\n            },\n\n            _resize: function(new_rows, new_cols) {\n                var self = this;\n                var old_rows = self.rowCount;\n                var cell_count = new_rows * new_cols - 1;\n                function scaleIndex(index) {\n                    var col = index / old_rows | 0;\n                    var row = index % old_rows;\n                    return col * new_rows + row;\n                }\n                function scaleNode(node) {\n                    // node is a ValueRange from rangelist.js\n                    // start/end are rowCount * col + row\n                    node.start = scaleIndex(node.start);\n                    node.end = scaleIndex(node.end);\n                }\n                Object.keys(self.lists).forEach(function(name) {\n                    var list = self.lists[name];\n                    if (new_rows != old_rows) {\n                        list.forEach(scaleNode);\n                    }\n                    list.range.end = cell_count;\n                });\n                self.rowCount = new_rows;\n                self.columnCount = new_cols;\n                self.cellCount = cell_count;\n            },\n\n            getState: function() {\n                var state = {};\n\n                this.specs.forEach(function(spec) {\n                   state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n\n                return state;\n            },\n\n            setState: function(state) {\n                this.specs.forEach(function(spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n\n            get: function(name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n\n                switch (name) {\n                  case \"borderRight\":\n                    index += this.rowCount;\n                    /* falls through */\n                  case \"borderLeft\":\n                    name = \"vBorders\";\n                    break;\n\n                  case \"borderBottom\":\n                    index++;\n                    /* falls through */\n                  case \"borderTop\":\n                    name = \"hBorders\";\n                    break;\n                }\n                return index > this.cellCount ? null : this.properties[name].get(index);\n            },\n\n            set: function(name, start, end, value) {\n                switch (name) {\n                  case \"borderRight\":\n                    start += this.rowCount;\n                    end += this.rowCount;\n                    /* falls through */\n                  case \"borderLeft\":\n                    name = \"vBorders\";\n                    break;\n\n                  case \"borderBottom\":\n                    start++;\n                    end++;\n                    /* falls through */\n                  case \"borderTop\":\n                    name = \"hBorders\";\n                    break;\n                }\n                if (start <= end && end <= this.cellCount) {\n                    this.properties[name].set(start, end, value);\n                }\n            },\n\n            fromJSON: function(index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n\n                [ \"borderLeft\", \"borderRight\", \"borderTop\", \"borderBottom\" ].forEach(function(b){\n                    if (value[b] !== undefined) {\n                        this.set(b, index, index, value[b]);\n                    }\n                }, this);\n            },\n\n            copy: function(sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function(spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n\n            iterator: function(name, start, end) {\n                var prop = this.properties[name];\n                var iter = prop.iterator(start, end), at = iter.at;\n                var cellCount = this.cellCount;\n                iter.at = function(index) {\n                    return index > cellCount ? null : prop.parse(at.call(iter, index));\n                };\n                iter.name = name;\n                iter.value = prop.spec.value;\n                return iter;\n            },\n\n            sortable: function() {\n                return this.specs.filter(function(spec) { return spec.sortable; })\n                    .map(function(spec) {\n                        return this.lists[spec.name];\n                    }, this);\n            },\n\n            iterators: function(start, end) {\n                return this.specs.reduce(function(ret, spec) {\n                    if (spec.serializable) {\n                        ret.push(this.iterator(spec.name, start, end));\n                    }\n                    return ret;\n                }.bind(this), []);\n            },\n\n            forEach: function(start, end, callback) {\n                var iterators = this.iterators(start, end);\n                var hBorders = this.iterator(\"hBorders\", start, end + 1);\n                var leftBorders = this.iterator(\"vBorders\", start, end);\n                var rightBorders = this.iterator(\"vBorders\", start + this.rowCount, end + this.rowCount);\n                var values, index;\n\n                function addBorder(name, iterator, index) {\n                    var val = iterator.at(index);\n                    if (val !== iterator.value) {\n                        values[name] = val;\n                    }\n                }\n\n                for (index = start; index <= end; index++) {\n                    values = {};\n\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n\n                    addBorder(\"borderLeft\", leftBorders, index);\n                    addBorder(\"borderRight\", rightBorders, index + this.rowCount);\n                    addBorder(\"borderTop\", hBorders, index);\n                    if ((index + 1) % this.rowCount) {\n                        addBorder(\"borderBottom\", hBorders, index + 1);\n                    }\n\n                    callback(values);\n                }\n            },\n\n            forEachProperty: function(callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n\n        function cloneFormulaValue(x) {\n            x = x.clone();\n            x.value = x.value.deepClone(); // x.value is Formula or Validation\n            return x;\n        }\n\n        function cloneFormulaTree() {\n            var tree = this.map(cloneFormulaValue);\n            tree.clone = cloneFormulaTree; // because it's a new RangeTree now\n            return tree;\n        }\n\n        kendo.spreadsheet.ALL_PROPERTIES = kendo.spreadsheet.PropertyBag.prototype.specs.reduce(function(a, spec) {\n            if (spec.serializable) {\n                a.push(spec.name);\n            }\n            return a;\n        }, [ \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\" ]);\n\n    })(window.kendo);\n\n    // -*- fill-column: 100 -*-\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n        \"use strict\";\n\n        var spreadsheet$8 = kendo.spreadsheet;\n        var Class$2 = kendo.Class;\n\n        function columnName(colIndex) {\n            var letter = Math.floor(colIndex / 26) - 1;\n            return (letter >= 0 ? columnName(letter) : \"\") + String.fromCharCode(65 + (colIndex % 26));\n        }\n\n        function displaySheet(sheet) {\n            if (/^[a-z_][a-z0-9_]*$/i.test(sheet)) {\n                return sheet;\n            }\n            return \"'\" + sheet.replace(/\\x27/g, \"\\\\'\") + \"'\";\n        }\n\n        function displayRef(sheet, row, col, rel) {\n            var aa = \"\";\n\n            ++row;\n\n            if (!isFinite(row)) {\n                row = \"\";\n            }\n            else if (rel != null && !(rel & 2)) {\n                row = \"$\" + row;\n            }\n\n            if (!isFinite(col)) {\n                col = \"\";\n            }\n            else {\n                aa = columnName(col);\n                if (rel != null && !(rel & 1)) {\n                    aa = \"$\" + aa;\n                }\n            }\n\n            if (sheet) {\n                return displaySheet(sheet) + \"!\" + aa + row;\n            } else {\n                return aa + row;\n            }\n        }\n\n        /* -----[ References ]----- */\n\n        var Ref$4 = Class$2.extend({\n            type: \"ref\",\n            sheet: \"\",\n            clone: function() {\n                return this;\n            },\n            hasSheet: function() {\n                return this._hasSheet;\n            },\n            simplify: function() {\n                return this;\n            },\n            setSheet: function(sheet, hasSheet) {\n                this.sheet = sheet;\n                if (hasSheet != null) {\n                    this._hasSheet = hasSheet;\n                }\n                return this;\n            },\n            absolute: function(){\n                return this;\n            },\n            relative: function(){\n                return this;\n            },\n            adjust: function(){\n                return this;\n            },\n            toString: function() {\n                return this.relative(0, 0, 3, 3).print(0, 0);\n            },\n            forEach: function(callback, obj) {\n                callback.call(obj, this);\n            },\n            map: function(callback, obj) {\n                return callback.call(obj, this);\n            },\n            intersects: function(ref) {\n                return this.intersect(ref) !== NULL$1;\n            },\n            isCell: function() {\n                return false;\n            },\n            toRow: function() {\n                return this;\n            },\n            toColumn: function() {\n                return this;\n            },\n\n            // UnionRef overrides these, to access its subranges.\n            first: function() {\n                return this;\n            },\n            lastRange: function() {\n                return this;\n            },\n            size: function() {\n                return 1;\n            },\n            rangeAt: function() {\n                return this;\n            },\n            nextRangeIndex: function() {\n                return 0;\n            },\n            previousRangeIndex: function() {\n                return 0;\n            },\n            eq: function(reference) {\n                var r1 = this;\n                var r2 = reference;\n\n                if (r1 === NULL$1 || r2 === NULL$1) {\n                    return r1 === r2;\n                }\n\n                // make positions consistent\n                if ((r2 instanceof CellRef$5) || (r2 instanceof RangeRef$4 && !(r1 instanceof CellRef$5))) {\n                   r1 = reference;\n                   r2 = this;\n                }\n\n                if (r1 instanceof CellRef$5) { // cell eq *\n                    r2 = r2.simplify();\n                    return r2 instanceof CellRef$5 && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n                }\n                else if (r1 instanceof RangeRef$4) { // range eq range/union\n                    if (r2 instanceof RangeRef$4) {\n                        return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                    }\n                    if (r2 instanceof UnionRef$3) {\n                        return r2.single() && r1.eq(r2.refs[0]);\n                    }\n                }\n                else if (r1 instanceof UnionRef$3 && r2 instanceof UnionRef$3) { // union eq union\n                    var refs1 = r1.refs;\n                    var refs2 = r2.refs;\n                    if (refs1.length != refs2.length) {\n                       return false;\n                    }\n\n                    for (var i = 0, len = refs1.length; i < len; i++) {\n                        if (!refs1[i].eq(refs2[i])) {\n                            return false;\n                        }\n                    }\n\n                    return true;\n                }\n\n                return r1 === r2;   // XXX: possibly NameRef when we'll support it.\n            },\n\n            concat: function(ref) {\n                return new UnionRef$3([this, ref]);\n            },\n\n            replaceAt: function(index, ref) {\n                return ref;\n            },\n\n            forEachColumnIndex: function(callback) {\n                this.forEachAxisIndex('col', callback);\n            },\n\n            forEachRowIndex: function(callback) {\n                this.forEachAxisIndex('row', callback);\n            },\n\n            forEachAxisIndex: function(axis, callback) {\n                var sorted = [];\n\n                var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n\n                this[method](function(ref) {\n                    var index = ref.first()[axis];\n                    if (sorted.indexOf(index) === -1) {\n                        sorted.push(index);\n                    }\n                });\n\n                sorted.sort(function(a,b) {\n                    return a > b ? 1 : (a < b ? -1 : 0);\n                }).forEach(callback);\n            },\n\n            valid: function() {\n                return false;\n            },\n\n            renameSheet: function(oldSheetName, newSheetName) {\n                if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n                    this.sheet = newSheetName;\n                    return true;\n                }\n            }\n        });\n\n        Ref$4.display = displayRef;\n\n        /* -----[ Null reference ]----- */\n\n        var NULL$1 = new (Ref$4.extend({\n            init: function NullRef(){},\n            print: function() {\n                return \"#NULL!\";\n            },\n            eq: function(ref) {\n                return ref === this;\n            },\n            forEach: function() {}\n        }))();\n\n        /* -----[ Name reference ]----- */\n\n        var NameRef$3 = Ref$4.extend({\n            ref: \"name\",\n            init: function NameRef(name){\n                this.name = name;\n            },\n            clone: function() {\n                return new NameRef$3(this.name)\n                    .setSheet(this.sheet, this.hasSheet());\n            },\n            print: function() {\n                var ret = displaySheet(this.name);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + \"!\" + ret;\n                }\n                return ret;\n            }\n        });\n\n        /* -----[ Cell reference ]----- */\n\n        var CellRef$5 = Ref$4.extend({\n            ref: \"cell\",\n            init: function CellRef(row, col, rel) {\n                this.row = row;\n                this.col = col;\n                this.rel = rel || 0;\n            },\n            clone: function() {\n                return new CellRef$5(this.row, this.col, this.rel)\n                    .setSheet(this.sheet, this.hasSheet());\n            },\n            intersect: function(ref) {\n                if (ref instanceof CellRef$5) {\n                    if (this.eq(ref)) {\n                        return this;\n                    } else {\n                        return NULL$1;\n                    }\n                }\n                return ref.intersect(this);\n            },\n            print: function(trow, tcol, mod) {\n                var col = this.col, row = this.row, rel = this.rel, abs;\n                if (trow == null && rel) {\n                    var sheet = this.hasSheet() ? displaySheet(this.sheet) + \"!\" : \"\";\n                    if (isFinite(col)) {\n                        col = rel & 1 ? (\"C[\" + col + \"]\") : (\"C\" + (col + 1));\n                    } else {\n                        col = \"\";\n                    }\n                    if (isFinite(row)) {\n                        row = rel & 2 ? (\"R[\" + row + \"]\") : (\"R\" + (row + 1));\n                    } else {\n                        row = \"\";\n                    }\n                    return sheet + row + col;\n                } else {\n                    abs = this.absolute(trow, tcol);\n                    if (mod) {\n                        // Hacks: see the big comment below in `absolute()`\n                        row = abs.row % 0x100000;\n                        col = abs.col % 0x4000;\n                        if (row < 0) {\n                            row += 0x100000;\n                        }\n                        if (col < 0) {\n                            col += 0x4000;\n                        }\n                        return displayRef(this._hasSheet && this.sheet, row, col, rel);\n                    }\n                    return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : \"#REF!\";\n                }\n            },\n            absolute: function(arow, acol) {\n                var ret = this.clone();\n                if (ret.rel & 3 === 0) {\n                    return ret;    // already absolute\n                }\n\n                // Hacks: we make coordinates modulo 0x4000 (max col) and 0x100000 (max row).  This\n                // fixes importing relative references in definedName-s from Excel.  Example in\n                // Excel: select cell E3, open the Name Manager (in Formula tab) and define name\n                // TEST with value Sheet1!A1:C3.  The serialization of this name in XLSX is:\n                //\n                //     <definedName name=\"TEST\">Sheet1!XFA1048575:XFC1</definedName>\n                //\n                // This is insane, of course, but oh well.  Excel.  If you type in E3 =SUM(TEST) it\n                // works (it actually sums the cells), but if you type =SUM(Sheet1!XFA1048575:XFC1)\n                // you get back zero.  Let's see why SUM(TEST) works:\n                //\n                //     XFA1048575:XFC1                   E3\n                //     (zero-based indexes below)\n                //\n                //     R[1048574]C[16380]:R[0]C[16382] + R2C4 = R1048576C16384:R2C16386\n                //                                            % (0x100000, 0x4000)\n                //                                            = R0C0:R2C2 (== A1:C3)\n                //\n                // So XFA1048575:XFC1 is relocated to E3 at evaluation time, and because we take\n                // rows modulo 0x100000 and cols modulo 0x4000, we get back the correct range.\n                //\n                // IMO Excel should disallow A1-style relative references in name definitions\n                // (simply because the meaning of the A1:C3 you type in Name Manager depends on the\n                // active cell) and only allow R1C1 notation  that's unambiguous.  But it doesn't.\n                // Moreover, R1C1-style refs in XLSX are explicitly forbidden by the spec, and the\n                // hacks above are not documented  how else could we have fun implementing a XLSX\n                // reader?\n                if (ret.rel & 1) {\n                    // relative col, add anchor\n                    ret.col = (ret.col + acol) % 0x4000;\n                }\n                if (ret.rel & 2) {\n                    // relative row, add anchor\n                    ret.row = (ret.row + arow) % 0x100000;\n                }\n\n                ret.rel = 0;\n                return ret;\n            },\n            toRangeRef: function() {\n                return new RangeRef$4(this, this);\n            },\n            relative: function(arow, acol, rel) {\n                if (rel == null) {\n                    rel = this.rel;\n                }\n                var row = rel & 2 ? this.row - arow : this.row;\n                var col = rel & 1 ? this.col - acol : this.col;\n                return new CellRef$5(row, col, rel)\n                    .setSheet(this.sheet, this.hasSheet());\n            },\n            height: function() {\n                return 1;\n            },\n            width: function() {\n                return 1;\n            },\n            toString: function() {\n                return displayRef(null, this.row, this.col, 3);\n            },\n            isCell: function() {\n                return true;\n            },\n            leftColumn: function() {\n                return this;\n            },\n            rightColumn: function() {\n                return this;\n            },\n            topRow: function() {\n                return this;\n            },\n            bottomRow: function() {\n                return this;\n            },\n            forEachRow: function(callback) {\n                callback(this.toRangeRef());\n            },\n            forEachColumn: function(callback) {\n                callback(this.toRangeRef());\n            },\n            adjust: function(row, col, trow, tcol, forRow, start, delta) {\n                var ref = this.absolute(row, col);\n                if (forRow) {\n                    if (ref.row >= start) {\n                        if (delta < 0 && ref.row < start - delta) {\n                            return NULL$1;\n                        }\n                        ref.row += delta;\n                    }\n                } else {\n                    if (ref.col >= start) {\n                        if (delta < 0 && ref.col < start - delta) {\n                            return NULL$1;\n                        }\n                        ref.col += delta;\n                    }\n                }\n                if (trow != null && tcol != null) {\n                    ref = ref.relative(trow, tcol, this.rel);\n                }\n                return ref;\n            },\n            valid: function() {\n                if (this.rel) {\n                    throw new Error(\"valid() called on relative reference\");\n                }\n                var col = this.col, row = this.row;\n                return !((isFinite(col) && col < 0) || (isFinite(row) && row < 0));\n            }\n        });\n\n        /* -----[ Range reference ]----- */\n\n        var RangeRef$4 = Ref$4.extend({\n            ref: \"range\",\n            init: function RangeRef(tl, br) {\n                if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                    // \"3D\" reference\n                    this.endSheet = br.sheet;\n                }\n                // we want to drop any sheet information from the cells here.\n                this.topLeft = new CellRef$5(tl.row, tl.col, tl.rel);\n                this.bottomRight = new CellRef$5(br.row, br.col, br.rel);\n                this.normalize();\n            },\n            clone: function() {\n                return new RangeRef$4(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n            },\n            _containsRange: function(range) {\n                return this._containsCell(range.topLeft)\n                    && this._containsCell(range.bottomRight);\n            },\n            _containsCell: function(cell) {\n                return cell.sheet == this.sheet\n                    && cell.row >= this.topLeft.row\n                    && cell.col >= this.topLeft.col\n                    && cell.row <= this.bottomRight.row\n                    && cell.col <= this.bottomRight.col;\n            },\n            contains: function(ref) {\n                if (ref instanceof Array) {\n                    var that = this;\n\n                    return ref.some(function(_ref) { return that.contains(_ref); });\n                }\n                if (ref instanceof CellRef$5) {\n                    return this._containsCell(ref);\n                }\n                if (ref instanceof RangeRef$4) {\n                    return this._containsRange(ref);\n                }\n                return false;\n            },\n            _intersectRange: function(ref) {\n                if (this.sheet != ref.sheet) {\n                    return NULL$1;\n                }\n                var a_left    = this.topLeft.col;\n                var a_top     = this.topLeft.row;\n                var a_right   = this.bottomRight.col;\n                var a_bottom  = this.bottomRight.row;\n                var b_left    = ref.topLeft.col;\n                var b_top     = ref.topLeft.row;\n                var b_right   = ref.bottomRight.col;\n                var b_bottom  = ref.bottomRight.row;\n                if (a_left <= b_right &&\n                    b_left <= a_right &&\n                    a_top <= b_bottom &&\n                    b_top <= a_bottom)\n                {\n                    return new RangeRef$4(\n                        // topLeft\n                        new CellRef$5(Math.max(a_top, b_top),\n                                    Math.max(a_left, b_left)),\n                        // bottomRight\n                        new CellRef$5(Math.min(a_bottom, b_bottom),\n                                    Math.min(a_right, b_right))\n                    ).setSheet(this.sheet, this.hasSheet());\n                } else {\n                    return NULL$1;\n                }\n            },\n            intersect: function(ref) {\n                if (ref instanceof CellRef$5) {\n                    return this._containsCell(ref) ? ref : NULL$1;\n                }\n                if (ref instanceof RangeRef$4) {\n                    return this._intersectRange(ref).simplify();\n                }\n                if (ref instanceof UnionRef$3) {\n                    return ref.intersect(this);\n                }\n                return NULL$1;        // can't handle NameRef-s here.\n            },\n            simplify: function() {\n                if (this.isCell()) {\n                    return new CellRef$5(\n                        this.topLeft.row,\n                        this.topLeft.col,\n                        this.topLeft.rel\n                    ).setSheet(this.sheet, this.hasSheet());\n                }\n                return this;\n            },\n            normalize: function() {\n                var a = this.topLeft, b = this.bottomRight;\n                var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n                var rr1 = a.rel & 2, rc1 = a.rel & 1;\n                var rr2 = b.rel & 2, rc2 = b.rel & 1;\n                var tmp, changes = false;\n                // do not attempt to normalize unless relativeness of rows and cols are the same.\n                // https://github.com/telerik/kendo-ui-core/issues/4278\n                if (rr1 === rr2 && rc1 === rc2) {\n                    if (r1 > r2) {\n                        changes = true;\n                        tmp = r1; r1 = r2; r2 = tmp;\n                        tmp = rr1; rr1 = rr2; rr2 = tmp;\n                    }\n                    if (c1 > c2) {\n                        changes = true;\n                        tmp = c1; c1 = c2; c2 = tmp;\n                        tmp = rc1; rc1 = rc2; rc2 = tmp;\n                    }\n                    if (changes) {\n                        this.topLeft = new CellRef$5(r1, c1, rc1 | rr1);\n                        this.bottomRight = new CellRef$5(r2, c2, rc2 | rr2);\n                    }\n                }\n                return this;\n            },\n            print: function(trow, tcol, mod) {\n                if (mod || this.absolute(trow, tcol).valid()) {\n                    var ret = this.topLeft.print(trow, tcol, mod)\n                        + \":\"\n                        + this.bottomRight.print(trow, tcol, mod);\n                    if (this.hasSheet()) {\n                        ret = displaySheet(this.sheet)\n                            + (this.endSheet ? \":\" + displaySheet(this.endSheet) : \"\")\n                            + \"!\" + ret;\n                    }\n                    return ret;\n                }\n                return \"#REF!\";\n            },\n            absolute: function(arow, acol) {\n                return new RangeRef$4(\n                    this.topLeft.absolute(arow, acol),\n                    this.bottomRight.absolute(arow, acol)\n                ).setSheet(this.sheet, this.hasSheet());\n            },\n            relative: function(arow, acol, relTL, relBR) {\n                if (relBR == null) {\n                    relBR = relTL;\n                }\n                return new RangeRef$4(\n                    this.topLeft.relative(arow, acol, relTL),\n                    this.bottomRight.relative(arow, acol, relBR)\n                ).setSheet(this.sheet, this.hasSheet());\n            },\n            height: function() {\n                if (this.topLeft.rel != this.bottomRight.rel) {\n                    throw new Error(\"Mixed relative/absolute references\");\n                }\n                return this.bottomRight.row - this.topLeft.row + 1;\n            },\n            width: function() {\n                if (this.topLeft.rel != this.bottomRight.rel) {\n                    throw new Error(\"Mixed relative/absolute references\");\n                }\n                return this.bottomRight.col - this.topLeft.col + 1;\n            },\n            collapse: function() {\n                return this.topLeft.toRangeRef();\n            },\n            leftColumn: function() {\n                return new RangeRef$4(this.topLeft, new CellRef$5(this.bottomRight.row, this.topLeft.col));\n            },\n            rightColumn: function() {\n                return new RangeRef$4(new CellRef$5(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n            },\n            topRow: function() {\n                return new RangeRef$4(this.topLeft, new CellRef$5(this.topLeft.row, this.bottomRight.col));\n            },\n            bottomRow: function() {\n                return new RangeRef$4(new CellRef$5(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n            },\n            toRangeRef: function() {\n                return this;\n            },\n            toRow: function(row) {\n                row += Math.max(0, this.topLeft.row);\n                return new RangeRef$4(\n                    new CellRef$5(row, this.topLeft.col),\n                    new CellRef$5(row, this.bottomRight.col)\n                ).setSheet(this.sheet, this.hasSheet());\n            },\n            toColumn: function(col) {\n                col += Math.max(0, this.topLeft.col);\n                return new RangeRef$4(\n                    new CellRef$5(this.topLeft.row, col),\n                    new CellRef$5(this.bottomRight.row, col)\n                ).setSheet(this.sheet, this.hasSheet());\n            },\n            toCell: function(row, col) {\n                row += Math.max(0, this.topLeft.row);\n                col += Math.max(0, this.topLeft.col);\n                return new CellRef$5(row, col, 0)\n                    .setSheet(this.sheet, this.hasSheet());\n            },\n            forEachRow: function(callback) {\n                var startRow = this.topLeft.row;\n                var endRow = this.bottomRight.row;\n                var startCol = this.topLeft.col;\n                var endCol = this.bottomRight.col;\n\n                for (var i = startRow; i <= endRow; i++) {\n                    callback(new RangeRef$4(\n                        new CellRef$5(i, startCol),\n                        new CellRef$5(i, endCol)\n                    ));\n                }\n            },\n            forEachColumn: function(callback) {\n                var startRow = this.topLeft.row;\n                var endRow = this.bottomRight.row;\n                var startCol = this.topLeft.col;\n                var endCol = this.bottomRight.col;\n\n                for (var i = startCol; i <= endCol; i++) {\n                    callback(new RangeRef$4(\n                        new CellRef$5(startRow, i),\n                        new CellRef$5(endRow, i)\n                    ));\n                }\n            },\n            intersecting: function(refs) {\n                return refs.filter(function(ref) {\n                    return ref.toRangeRef().intersects(this);\n                }, this);\n            },\n\n            union: function(refs, callback) {\n                var intersecting = this.intersecting(refs);\n\n                var topLeftRow = this.topLeft.row;\n                var topLeftCol = this.topLeft.col;\n                var bottomRightRow = this.bottomRight.row;\n                var bottomRightCol = this.bottomRight.col;\n\n                var modified = false;\n\n                intersecting.forEach(function(ref) {\n                    ref = ref.toRangeRef();\n                    if (ref.topLeft.row < topLeftRow) {\n                        modified = true;\n                        topLeftRow = ref.topLeft.row;\n                    }\n\n                    if (ref.topLeft.col < topLeftCol) {\n                        modified = true;\n                        topLeftCol = ref.topLeft.col;\n                    }\n\n                    if (ref.bottomRight.row > bottomRightRow) {\n                        modified = true;\n                        bottomRightRow = ref.bottomRight.row;\n                    }\n\n                    if (ref.bottomRight.col > bottomRightCol) {\n                        modified = true;\n                        bottomRightCol = ref.bottomRight.col;\n                    }\n\n                    if (callback) {\n                        callback(ref);\n                    }\n                });\n\n                var result = new RangeRef$4(\n                    new CellRef$5(topLeftRow, topLeftCol),\n                    new CellRef$5(bottomRightRow, bottomRightCol)\n                );\n\n                if (modified) {\n                    return result.union(refs, callback);\n                } else {\n                    return result;\n                }\n            },\n            resize: function(options) {\n                var limit = Math.max.bind(Math, 0);\n                function num(value) { return value || 0; }\n\n                var top = this.topLeft.row + num(options.top);\n                var left = this.topLeft.col + num(options.left);\n                var bottom = this.bottomRight.row + num(options.bottom);\n                var right = this.bottomRight.col + num(options.right);\n\n                if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                    return NULL$1;\n                } else if (top <= bottom && left <= right) {\n                    return new RangeRef$4(new CellRef$5(limit(top), limit(left)),\n                                        new CellRef$5(limit(bottom), limit(right)));\n                } else {\n                    return NULL$1;\n                }\n            },\n            move: function(rows, cols) {\n                return new RangeRef$4(\n                    new CellRef$5(this.topLeft.row + rows,\n                                this.topLeft.col + cols),\n                    new CellRef$5(this.bottomRight.row + rows,\n                                this.bottomRight.col + cols)\n                );\n            },\n            first: function() {\n                return this.topLeft.clone().setSheet(this.sheet, this.hasSheet());\n            },\n            isCell: function() {\n                return !this.endSheet && this.topLeft.eq(this.bottomRight);\n            },\n            toString: function() {\n                return this.topLeft + \":\" + this.bottomRight;\n            },\n            adjust: function(row, col, trow, tcol, forRow, start, delta) {\n                var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n                var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n                if (tl === NULL$1 && tr === NULL$1) {\n                    return NULL$1;\n                }\n                if (tl === NULL$1) {\n                    tl = this.topLeft.absolute(row, col);\n                    if (forRow) {\n                        tl.row = start;\n                    } else {\n                        tl.col = start;\n                    }\n                    if (trow != null && tcol != null) {\n                        tl = tl.relative(trow, tcol, this.topLeft.rel);\n                    }\n                }\n                else if (tr === NULL$1) {\n                    tr = this.bottomRight.absolute(row, col);\n                    if (forRow) {\n                        tr.row = start - 1;\n                    } else {\n                        tr.col = start - 1;\n                    }\n                    if (trow != null && tcol != null) {\n                        tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                    }\n                }\n                return new RangeRef$4(tl, tr)\n                    .setSheet(this.sheet, this.hasSheet())\n                    .simplify();\n            },\n            valid: function() {\n                return this.topLeft.valid() && this.bottomRight.valid();\n            }\n        });\n\n        /* -----[ Union reference ]----- */\n\n        var UnionRef$3 = Ref$4.extend({\n            init: function UnionRef(refs){\n                this.refs = refs;\n                this.length = refs.length;\n            },\n            clone: function() {\n                return new UnionRef$3(this.refs.slice());\n            },\n            intersect: function(ref) {\n                var a = [];\n                for (var i = 0; i < this.length; ++i) {\n                    var x = ref.intersect(this.refs[i]);\n                    if (x !== NULL$1) {\n                        a.push(x);\n                    }\n                }\n                if (a.length > 0) {\n                    return new UnionRef$3(a).simplify();\n                }\n                return NULL$1;\n            },\n            simplify: function() {\n                var u = new UnionRef$3(this.refs.reduce(function(a, ref){\n                    ref = ref.simplify();\n                    if (ref !== NULL$1) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []));\n                if (u.empty()) {\n                    return NULL$1;\n                }\n                if (u.single()) {\n                    return u.refs[0];\n                }\n                return u;\n            },\n            absolute: function(arow, acol) {\n                return new UnionRef$3(this.refs.map(function(ref){\n                    return ref.absolute(arow, acol);\n                }));\n            },\n            forEach: function(callback, obj) {\n                this.refs.forEach(function(ref){\n                    if (ref instanceof UnionRef$3) {\n                        ref.forEach(callback, obj);\n                    } else {\n                        callback.call(obj, ref);\n                    }\n                }, obj);\n            },\n            toRangeRef: function() {\n                return this.refs[0].toRangeRef();\n            },\n            contains: function(theRef) {\n                return this.refs.some(function(ref) { return ref.contains(theRef); });\n            },\n            map: function(callback, obj) {\n                var refs = [];\n                this.forEach(function(ref){\n                    refs.push(callback.call(obj, ref));\n                });\n                return new UnionRef$3(refs);\n            },\n            first: function() {\n                return this.refs[0].first();\n            },\n            lastRange: function() {\n                return this.refs[this.length - 1];\n            },\n            size: function() {\n                return this.length;\n            },\n            single: function() {\n                return this.length == 1;\n            },\n            empty: function() {\n                return this.length === 0;\n            },\n            isCell: function() {\n                return this.single() && this.refs[0].isCell();\n            },\n            rangeAt: function(index) {\n                return this.refs[index];\n            },\n            nextRangeIndex: function(index) {\n                if (index === this.length - 1) {\n                    return 0;\n                } else {\n                    return index + 1;\n                }\n            },\n            previousRangeIndex: function(index) {\n                if (index === 0) {\n                    return this.length - 1;\n                } else {\n                    return index - 1;\n                }\n            },\n            concat: function(ref) {\n                return new UnionRef$3(this.refs.concat([ref]));\n            },\n            print: function(row, col, mod) {\n                return this.refs.map(function(ref) { return ref.print(row, col, mod); }).join(\",\");\n            },\n\n            replaceAt: function(index, ref) {\n                var newRefs = this.refs.slice();\n                newRefs.splice(index, 1, ref);\n                return new UnionRef$3(newRefs);\n            },\n\n            leftColumn: function() {\n                return this.map(function(ref) {\n                    return ref.leftColumn();\n                });\n            },\n            rightColumn: function() {\n                return this.map(function(ref) {\n                    return ref.rightColumn();\n                });\n            },\n            topRow: function() {\n                return this.map(function(ref) {\n                    return ref.topRow();\n                });\n            },\n            bottomRow: function() {\n                return this.map(function(ref) {\n                    return ref.bottomRow();\n                });\n            },\n            forEachRow: function(callback) {\n                this.forEach(function(ref) {\n                    ref.forEachRow(callback);\n                });\n            },\n            forEachColumn: function(callback) {\n                this.forEach(function(ref) {\n                    ref.forEachColumn(callback);\n                });\n            },\n            adjust: function(row, col, trow, tcol, forRow, start, delta) {\n                return this.map(function(ref){\n                    return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n                }).simplify();\n            },\n            toString: function() {\n                return this.refs.map(function(ref){\n                    return ref.toString();\n                }).join(\", \");\n            },\n            valid: function() {\n                for (var i = this.refs.length; --i >= 0;) {\n                    if (this.refs[i].valid()) {\n                        return false;\n                    }\n                }\n                return true;\n            },\n            renameSheet: function(oldSheetName, newSheetName) {\n                this.refs.forEach(function(ref){\n                    ref.renameSheet(oldSheetName, newSheetName);\n                });\n            }\n        });\n\n        /* -----[ exports ]----- */\n\n        spreadsheet$8.NULLREF = NULL$1;\n        spreadsheet$8.SHEETREF = new RangeRef$4(new CellRef$5(0, 0), new CellRef$5(Infinity, Infinity));\n        spreadsheet$8.FIRSTREF = new CellRef$5(0, 0);\n        spreadsheet$8.Ref = Ref$4;\n        spreadsheet$8.NameRef = NameRef$3;\n        spreadsheet$8.CellRef = CellRef$5;\n        spreadsheet$8.RangeRef = RangeRef$4;\n        spreadsheet$8.UnionRef = UnionRef$3;\n\n        spreadsheet$8.SHEETREF.print = function() {\n            return \"#SHEET\";\n        };\n\n    (function(kendo) {\n\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function(grid) {\n                this._grid = grid;\n            },\n\n            rectIsVertical: function(start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n\n            autoFillDest: function(selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n\n                var pivot, opposite, cornerResult, expanding;\n\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) { // vertical\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) { // vertical\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2){\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) { // horizontal\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) { // horizontal\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    })(kendo);\n\n    (function(kendo) {\n\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n\n        var EdgeNavigator = kendo.Class.extend({\n            init: function(field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n\n                this.prevLeft = function(index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n\n                this.nextRight = function(index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n\n                // these two don't look like the other ones, as they \"shrink\"\n                this.nextLeft = function(index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n\n                this.prevRight = function(index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n\n            boundary: function(top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n\n            range: function(index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n\n        var SheetNavigator = kendo.Class.extend({\n            init: function(sheet) {\n                this._sheet = sheet;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n\n                this.colEdge = new EdgeNavigator(\"col\", this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator(\"row\", this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n\n            height: function(height) {\n                this._viewPortHeight = height;\n            },\n\n            union: function(ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n\n            columnRange: function(col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n\n            rowRange: function(row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n\n            selectionIncludesMergedCells: function() {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n\n            setSelectionValue: function(value) {\n                var selection = this._sheet.selection();\n\n                setTimeout(function() {\n                    selection.value(value());\n                });\n            },\n\n            selectAll: function() {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n\n            select: function(ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n\n                this._sheet.select(ref);\n            },\n\n            refForMode: function(ref, mode) {\n                var grid = this._sheet._grid;\n\n                switch(mode) {\n                    case \"range\":\n                        ref = grid.normalize(ref);\n                        break;\n                    case \"row\":\n                        ref = grid.rowRef(ref.row);\n                        break;\n                    case \"column\":\n                        ref = grid.colRef(ref.col);\n                        break;\n                    case \"sheet\":\n                        ref = this._sheet._sheetRef;\n                        break;\n                }\n\n                return ref;\n            },\n\n            startSelection: function(ref, mode, addToExisting, shiftKey, view) {\n                if (mode == \"autofill\") {\n                    this._sheet.startAutoFill();\n                } else if (shiftKey && mode == \"range\") {\n                    var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                    this._sheet.select(range, false, false);\n                    this._sheet.startSelection(view);\n                } else {\n                    this._sheet.startSelection(view);\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n\n            completeSelection: function() {\n                this._sheet.completeSelection();\n            },\n\n            selectForContextMenu: function(ref, mode) {\n                var sheet = this._sheet;\n                sheet._activeDrawing = null;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n\n            selectDrawingForContextMenu: function(drawing) {\n                var sheet = this._sheet;\n                sheet._activeDrawing = drawing;\n                sheet.triggerChange({ selection: true });\n            },\n\n            modifySelection: function(action) {\n                var direction = this.determineDirection(action);\n\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var bottomLeft = new CellRef(bottomRight.row, topLeft.col);\n\n                var scrollInto;\n\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n\n                switch (direction) {\n                  case \"expand-left\": // <| |\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                  case \"shrink-right\": // |>|\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                  case \"expand-right\": // | |>\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                  case \"shrink-left\": // |<|\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n\n                    // four actions below mirror the upper ones, on the vertical axis\n                  case \"expand-up\":\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                  case \"shrink-down\":\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                  case \"expand-down\":\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                  case \"shrink-up\":\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n\n                    // pageup/down - may need improvement\n                  case \"expand-page-up\":\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                  case \"shrink-page-up\":\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                  case \"expand-page-down\":\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                  case \"shrink-page-down\":\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n\n                  case \"first-col\":\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                  case \"last-col\":\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                  case \"first-row\":\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                  case \"last-row\":\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                  case \"last\":\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                  case \"first\":\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n\n                  case \"expand-word-right\":\n                    bottomRight.col = columns.nextUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n                    scrollInto = bottomRight;\n                    break;\n                  case \"shrink-word-right\":\n                    topLeft.col = columns.nextUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n                    scrollInto = topLeft;\n                    break;\n                  case \"expand-word-left\":\n                    topLeft.col = columns.prevUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n                    scrollInto = topLeft;\n                    break;\n                  case \"shrink-word-left\":\n                    bottomRight.col = columns.prevUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n                    scrollInto = bottomRight;\n                    break;\n                  case \"expand-word-up\":\n                    topLeft.row = rows.prevUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n                    scrollInto = topLeft;\n                    break;\n                  case \"shrink-word-up\":\n                    bottomRight.row = rows.prevUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n                    scrollInto = bottomRight;\n                    break;\n                  case \"expand-word-down\":\n                    bottomRight.row = rows.nextUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n                    scrollInto = bottomRight;\n                    break;\n                  case \"shrink-word-down\":\n                    topLeft.row = rows.nextUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n                    scrollInto = topLeft;\n                    break;\n                }\n\n                var newSelection = new RangeRef(topLeft, bottomRight);\n\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    // throw new Error(newSelection.print() + \" does not contain \" + activeCell.print());\n                    this.modifySelection(direction.replace(\"shrink\", \"expand\"));\n                    return;\n                }\n\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n\n                this.updateCurrentSelectionRange(newSelection);\n            },\n\n            moveActiveCell: function(direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n\n                var row = cell.row;\n                var column = cell.col;\n\n                switch (direction) {\n                  case \"left\":\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                  case \"up\":\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                  case \"right\":\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                  case \"down\":\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                  case \"first-col\":\n                    column = columns.firstVisible();\n                    break;\n                  case \"last-col\":\n                    column = columns.lastVisible();\n                    break;\n                  case \"first-row\":\n                    row = rows.firstVisible();\n                    break;\n                  case \"last-row\":\n                    row = rows.lastVisible();\n                    break;\n                  case \"last\":\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                  case \"first\":\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                  case \"next-page\":\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                  case \"prev-page\":\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n\n                  case \"word-right\":\n                    column = columns.nextUntil(column, makeWordMovement(sheet, bottomRight, true));\n                    break;\n                  case \"word-left\":\n                    column = columns.prevUntil(column, makeWordMovement(sheet, bottomRight, true));\n                    break;\n                  case \"word-up\":\n                    row = rows.prevUntil(row, makeWordMovement(sheet, bottomRight, false));\n                    break;\n                  case \"word-down\":\n                    row = rows.nextUntil(row, makeWordMovement(sheet, bottomRight, false));\n                    break;\n                }\n\n                sheet.select(new CellRef(row, column));\n            },\n\n            navigateInSelection: function(direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n\n                var row = cell.row;\n                var column = cell.col;\n\n                var isFirstCell = false;\n                var isLastCell = false;\n\n                var selTopLeft, selBottomRight;\n\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                var tmp;\n\n                function setSelection(sel) {\n                    selTopLeft = sel.topLeft;\n                    selBottomRight = sel.bottomRight;\n                }\n\n                setSelection(sheet.currentNavigationRange());\n\n                var done = false;\n                var navigatedAway = false;\n\n                while (!done && !navigatedAway) {\n                    var current = new CellRef(row, column);\n                    var isSingleCellSelected = sheet.singleCellSelection();\n\n                    if(isSingleCellSelected) {\n                        isFirstCell = selTopLeft.eq(current) && sheet._sheetRef.topLeft.eq(current);\n                        isLastCell = selBottomRight.eq(current) && sheet._sheetRef.bottomRight.eq(current);\n\n                        if(!isFirstCell) {\n                            isFirstCell = columns.firstVisible() === column && rows.firstVisible() === row;\n                        }\n\n                        if(!isLastCell) {\n                            isLastCell = columns.lastVisible() === column && rows.lastVisible() === row;\n                        }\n                    }\n\n                    switch (direction) {\n                        case \"next\":\n                            if(isLastCell) {\n                                navigatedAway = true;\n                                kendo.focusNextElement();\n                            } else if (selBottomRight.eq(current)) {\n                                setSelection(sheet.nextNavigationRange());\n                                row = selTopLeft.row;\n                                column = selTopLeft.col;\n                            } else {\n                                column = columns.nextVisible(topLeftCol);\n                                if (column == topLeftCol || column > selBottomRight.col) {\n                                    column = selTopLeft.col;\n                                    tmp = rows.nextVisible(row);\n                                    if (tmp == row || tmp > selBottomRight.row) {\n                                        row = selTopLeft.row;\n                                    } else {\n                                        row = tmp;\n                                    }\n                                }\n                            }\n                            break;\n                        case \"previous\":\n                            if(isFirstCell) {\n                                navigatedAway = true;\n                                this._sheet._workbook._view.element.find('.k-spreadsheet-name-editor .k-input-inner').trigger(\"focus\");\n                            } else if (selTopLeft.eq(current)) {\n                                setSelection(sheet.previousNavigationRange());\n                                row = selBottomRight.row;\n                                column = selBottomRight.col;\n                            } else {\n                                column = columns.prevVisible(topLeftCol);\n                                if (column == topLeftCol || column < selTopLeft.col) {\n                                    column = selBottomRight.col;\n                                    tmp = rows.prevVisible(row);\n                                    if (tmp == row || tmp < selTopLeft.row) {\n                                        row = selBottomRight.row;\n                                    } else {\n                                        row = tmp;\n                                    }\n                                }\n                            }\n                            break;\n                        case \"lower\":\n                            if (selBottomRight.eq(current)) {\n                                setSelection(sheet.nextNavigationRange());\n                                row = selTopLeft.row;\n                                column = selTopLeft.col;\n                            } else {\n                                row = rows.nextVisible(topLeftRow);\n                                if (row == topLeftRow || row > selBottomRight.row) {\n                                    row = selTopLeft.row;\n                                    tmp = columns.nextVisible(column);\n                                    if (tmp == column || tmp > selBottomRight.col) {\n                                        column = selTopLeft.col;\n                                    } else {\n                                        column = tmp;\n                                    }\n                                }\n                            }\n                            break;\n                        case \"upper\":\n                            if (selTopLeft.eq(current)) {\n                                setSelection(sheet.previousNavigationRange());\n                                row = selBottomRight.row;\n                                column = selBottomRight.col;\n                            } else {\n                                row = rows.prevVisible(topLeftRow);\n                                if (row == topLeftRow || row < selTopLeft.row) {\n                                    row = selBottomRight.row;\n                                    tmp = columns.prevVisible(column);\n                                    if (tmp == column || tmp < selTopLeft.col) {\n                                        column = selBottomRight.col;\n                                    } else {\n                                        column = tmp;\n                                    }\n                                }\n                            }\n                            break;\n                        default:\n                            throw new Error(\"Unknown entry navigation: \" + direction);\n                    }\n\n                    done = !this.shouldSkip(row, column);\n                    // if (!done) { console.log(\"skipping\", row, column); }\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n\n                if(done) {\n                    if (sheet.singleCellSelection()) {\n                        sheet.select(new CellRef(row, column));\n                    } else {\n                        sheet.activeCell(new CellRef(row, column));\n                    }\n                }\n            },\n\n            extendSelection: function(ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n\n                if (mode === \"autofill\") {\n                   this.resizeAutoFill(ref);\n                   return;\n                }\n                if (mode === \"range\") {\n                    ref = grid.normalize(ref);\n                }\n                else if (mode === \"row\") {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === \"column\") {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n\n            shouldSkip: function(row, col) {\n                if (this._sheet.isHiddenRow(row) || this._sheet.isHiddenColumn(col)) {\n                    return true;\n                }\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function(merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n\n                return isMerged;\n            },\n\n            resizeAutoFill: function(ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n\n                var punch = this.punch(selection, dest);\n                var hint, direction;\n\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        hint = preview.hint;\n                    }\n                }\n\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n\n            determineDirection: function(action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n\n                // There may be a third, indeterminate state, caused by a merged cell.\n                // In this state, all key movements are treated as shrinks.\n                // The navigator will reverse them if it detects this it will cause the selection to exclude the active cell.\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n\n                switch (action) {\n                  case \"left\":\n                    action = rightMode ? \"expand-left\" : \"shrink-left\";\n                    break;\n                  case \"right\":\n                    action = leftMode ? \"expand-right\" : \"shrink-right\";\n                    break;\n                  case \"up\":\n                    action = bottomMode ? \"expand-up\" : \"shrink-up\";\n                    break;\n                  case \"down\":\n                    action = topMode ? \"expand-down\" : \"shrink-down\";\n                    break;\n                  case \"prev-page\":\n                    action = bottomMode ? \"expand-page-up\" : \"shrink-page-up\";\n                    break;\n                  case \"next-page\":\n                    action = topMode ? \"expand-page-down\" : \"shrink-page-down\";\n                    break;\n                  case \"word-left\":\n                    action = rightMode ? \"expand-word-left\" : \"shrink-word-left\";\n                    break;\n                  case \"word-right\":\n                    action = leftMode ? \"expand-word-right\" : \"shrink-word-right\";\n                    break;\n                  case \"word-up\":\n                    action = bottomMode ? \"expand-word-up\" : \"shrink-word-up\";\n                    break;\n                  case \"word-down\":\n                    action = topMode ? \"expand-word-down\" : \"shrink-word-down\";\n                    break;\n                }\n\n                return action;\n            },\n\n            updateCurrentSelectionRange: function(ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n\n            punch: function(selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n\n                        punch = new RangeRef(\n                            new CellRef(bottomRow, selection.topLeft.col),\n                            selection.bottomRight\n                        );\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n\n                        punch = new RangeRef(\n                            new CellRef(selection.topLeft.row, bottomCol),\n                            selection.bottomRight\n                        );\n                    }\n                }\n\n                return punch;\n            }\n        });\n\n        function makeWordMovement(sheet, pivot, isCol) {\n            // the general idea is:\n            //\n            // - if we start on a non-empty cell, we should select the\n            //   range of non-empty cells that follow it.  If, however,\n            //   the second cell is empty, then we don't stop there; we\n            //   should skip all the empty cells and stop at the first\n            //   non-empty cell (and select it).\n            //\n            // - if we start on an empty cell, then skip all empty cells\n            //   and select the first non-empty one.\n\n            var firstVal = sheet.range(pivot).value();\n            return function(pos, advanced, hidden) {\n                if (hidden) { return true; }   // skip hidden cells\n                var val = ( isCol ?\n                            sheet.range(pivot.row, pos) :\n                            sheet.range(pos, pivot.col) ).value();\n                if (firstVal === null) {\n                    return val === null ? false : pos;\n                } else if (!advanced && val === null) {\n                    firstVal = null; // switch to the other mode\n                    return false;\n                } else {\n                    return val === null;\n                }\n            };\n        }\n\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    })(kendo);\n\n    (function(kendo) {\n\n        var AxisManager = kendo.Class.extend({\n            init: function(sheet) {\n                this._sheet = sheet;\n            },\n\n            forEachSelectedColumn: function(callback) {\n                var sheet = this._sheet;\n\n                sheet.batch(function() {\n                    sheet.select().forEachColumnIndex(function(index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, { layout: true, recalc: true });\n            },\n\n            forEachSelectedRow: function(callback) {\n                var sheet = this._sheet;\n\n                sheet.batch(function() {\n                    sheet.select().forEachRowIndex(function(index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, { layout: true, recalc: true });\n            },\n\n            includesHiddenColumns: function(ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n\n            includesHiddenRows: function(ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n\n            selectionIncludesHiddenColumns: function() {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n\n            selectionIncludesHiddenRows: function() {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n\n            deleteSelectedColumns: function() {\n                var indexes = [], delta = 0;\n                this.forEachSelectedColumn(function(sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenColumn(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index    : index,\n                        formulas : formulas,\n                        width    : sheet.columnWidth(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function(){\n                        sheet.deleteColumn(index);\n                    });\n                });\n                return indexes;\n            },\n\n            deleteSelectedRows: function() {\n                var indexes = [], delta = 0;\n                this.forEachSelectedRow(function(sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenRow(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index    : index,\n                        formulas : formulas,\n                        height   : sheet.rowHeight(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function(){\n                        sheet.deleteRow(index);\n                    });\n                });\n                return indexes;\n            },\n\n            hideSelectedColumns: function() {\n                this.forEachSelectedColumn(function(sheet, index) {\n                    sheet.hideColumn(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var left = ref.topLeft.col;\n                var right = ref.bottomRight.col;\n                var sel = null;\n                while (true) {\n                    var hasRight = right < sheet._columns._count;\n                    var hasLeft = left >= 0;\n                    if (!hasLeft && !hasRight) {\n                        break;\n                    }\n                    if (hasRight && !sheet.isHiddenColumn(right)) {\n                        sel = right;\n                        break;\n                    }\n                    if (hasLeft && !sheet.isHiddenColumn(left)) {\n                        sel = left;\n                        break;\n                    }\n                    left--;\n                    right++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(\n                        new kendo.spreadsheet.CellRef(0, sel),\n                        new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel)\n                    );\n                    sheet.range(ref).select();\n                }\n            },\n\n            hideSelectedRows: function() {\n                this.forEachSelectedRow(function(sheet, index) {\n                    sheet.hideRow(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var top = ref.topLeft.row;\n                var bottom = ref.bottomRight.row;\n                var sel = null;\n                while (true) {\n                    var hasBottom = bottom < sheet._rows._count;\n                    var hasTop = top >= 0;\n                    if (!hasTop && !hasBottom) {\n                        break;\n                    }\n                    if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                        sel = bottom;\n                        break;\n                    }\n                    if (hasTop && !sheet.isHiddenRow(top)) {\n                        sel = top;\n                        break;\n                    }\n                    top--;\n                    bottom++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(\n                        new kendo.spreadsheet.CellRef(sel, 0),\n                        new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1)\n                    );\n                    sheet.range(ref).select();\n                }\n            },\n\n            unhideSelectedColumns: function() {\n                this.forEachSelectedColumn(function(sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n\n            unhideSelectedRows: function() {\n                this.forEachSelectedRow(function(sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n\n            addColumnLeft: function() {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function(){\n                    sheet.select().forEachColumnIndex(function(index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertColumn(base);\n                        ++count;\n                    });\n                }, { recalc: true, layout: true });\n                return { base: base, count: count };\n            },\n\n            addColumnRight: function() {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function(){\n                    sheet.select().forEachColumnIndex(function(index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertColumn(base);\n                    }\n                }, { recalc: true, layout: true });\n                return { base: base, count: count };\n            },\n\n            addRowAbove: function() {\n                var sheet = this._sheet;\n                var base, count = 0;\n                var selectedRows = sheet.select();\n\n                sheet.batch(function(){\n                    selectedRows.forEachRowIndex(function(index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertRow(base);\n                        ++count;\n                    });\n                }, { recalc: true, layout: true });\n\n                return { base: base, count: count };\n            },\n\n            addRowBelow: function() {\n                var sheet = this._sheet;\n                var base, count = 0;\n\n                sheet.batch(function(){\n                    sheet.select().forEachRowIndex(function(index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertRow(base);\n                    }\n                }, { recalc: true, layout: true });\n\n                return { base: base, count: count };\n            }\n        });\n\n        kendo.spreadsheet.AxisManager = AxisManager;\n    })(kendo);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n\n        var Clipboard = kendo.Class.extend({\n            init: function(workbook) {\n                this._content = {};\n                this._externalContent = {};\n                this._internalContent = {};\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement(\"iframe\");\n                this.iframe.className = \"k-spreadsheet-clipboard-paste\";\n                this.iframe.setAttribute(\"title\", \"Spreadsheet clipboard iframe\");\n                this.menuInvoked = false;\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n\n            destroy: function() {\n                $(this.iframe).remove();\n            },\n\n            canCopy: function() {\n                var status = {canCopy: true};\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n\n            canPaste: function() {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var range = sheet.range(ref);\n                var status = { canPaste: true, pasteOnMerged: false, pasteOnDisabled: false };\n\n                if (!range.enable()) {\n                    status.canPaste =  false;\n                    status.pasteOnDisabled = true;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n\n            intersectsMerged: function() {\n                var sheet = this.workbook.activeSheet();\n                this.parse();\n                this.origin = this._content.origRef;\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n\n            copy: function() {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this._internalContent = sheet.selection().getState();\n                delete this._externalContent.html;\n                delete this._externalContent.plain;\n            },\n\n            cut: function() {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n\n            pasteRef: function() {\n                var sheet = this.workbook.activeSheet();\n\n                // When pasting from an external source, origin will be\n                // NULLREF.  Just return the destination range.\n                // https://github.com/telerik/kendo-ui-core/issues/3486\n                if (this.origin === kendo.spreadsheet.NULLREF) {\n                    return sheet.select();\n                }\n\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n\n            paste: function() {\n                var sheet = this.workbook.activeSheet();\n                var pasteRef = this.pasteRef();\n                if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n                    sheet.resize(\n                        Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                        Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n                    );\n                }\n                sheet.range(pasteRef).setState(this._content, this);\n                sheet.triggerChange({ recalc: true, ref: pasteRef });\n            },\n\n            external: function(data) {\n                if (data && (data.html || data.plain)) {\n                    this._externalContent = data;\n                } else {\n                    return this._externalContent;\n                }\n            },\n\n            isExternal: function() {\n                return !this._isInternal();\n            },\n\n            parse: function() {\n                var state;\n\n                if (this._isInternal()) {\n                    state = this._internalContent;\n                } else {\n                    var data = this._externalContent;\n                    state = data.plain ? parseTSV(data.plain) : newState();\n                    if (data.html) {\n                        var doc = this.iframe.contentWindow.document;\n                        doc.open();\n                        doc.write(data.html);\n                        doc.close();\n                        var table = doc.querySelector(\"table\");\n                        if (table) {\n                            var richState = parseHTML(table);\n\n                            // fixup #### values that are sent by Excel when the column is too\n                            // narrow. It turns out that the plain text clipboard data contains the\n                            // actual values. https://github.com/telerik/kendo-ui-core/issues/5277\n                            richState.data.forEach(function(rowData, rowIndex){\n                                rowData.forEach(function(colData, colIndex){\n                                    if (/^\\s*#+\\s*$/.test(colData.value)) {\n                                        colData.value = state.data[rowIndex][colIndex].value;\n                                    }\n                                });\n                            });\n                            state = richState;\n                        }\n                    }\n                    this.origin = state.origRef;\n                }\n\n                this._content = state;\n            },\n\n            _isInternal: function() {\n                if (this._externalContent.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $(\"<div/>\").html(this._externalContent.html).find(\"table.kendo-clipboard-\"+ this._uid).length ? true : false;\n                var internalPlain = $(\"<div/>\").html(this._externalContent.plain).find(\"table.kendo-clipboard-\"+ this._uid).length ? true : false;\n                return (internalHTML || internalPlain);\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n\n        function newState() {\n            var ref = new CellRef(0, 0, 0);\n            return {\n                ref         : ref,\n                mergedCells : [],\n                data        : [],\n                foreign     : true,\n                origRef     : ref.toRangeRef()\n            };\n        }\n\n        function setStateData(state, row, col, value) {\n            var data = state.data || (state.data = []);\n            if (!data[row]) {\n                data[row] = [];\n            }\n            data[row][col] = value;\n            var br = state.origRef.bottomRight;\n            br.row = Math.max(br.row, row);\n            br.col = Math.max(br.col, col);\n        }\n\n        function stripStyle(style) {\n            return style.replace(/^-(?:ms|moz|webkit)-/, \"\");\n        }\n\n        function borderObject(element, styles) {\n            // MS Office uses class name and writes borders in the <style> section, so for it we need to\n            // use the computed styles.  For Google Sheets / LibreOffice, however, the inline styles are\n            // more accurate.\n            if (!element.className) {\n                styles = element.style;\n            }\n            var obj = {};\n            [\n                \"borderBottom\",\n                \"borderRight\",\n                \"borderLeft\",\n                \"borderTop\"\n            ].forEach(function(key) {\n                var width = styles[key + \"Width\"];\n                if (width) {\n                    width = parseInt(width, 10);\n                }\n                if (width) {\n                    obj[key] = {\n                        size: width,\n                        color: styles[key + \"Color\"] || \"#000\"\n                    };\n                }\n            });\n            return obj;\n        }\n\n        function cellState(row, col, element, hBorders, vBorders) {\n            var styles = window.getComputedStyle(element);\n            var value, format, formula;\n\n            // google sheets\n            if ((value = element.getAttribute(\"data-sheets-value\"))) {\n                value = JSON.parse(value);\n                value = value[value[1]];\n            }\n            if ((format = element.getAttribute(\"data-sheets-numberformat\"))) {\n                format = JSON.parse(format);\n                format = format[format[1]];\n            }\n            formula = element.getAttribute(\"data-sheets-formula\");\n\n            // libre office\n            if (value == null && format == null && formula == null) {\n                value = element.getAttribute(\"sdval\");\n                format = element.getAttribute(\"sdnum\");\n                if (format) {\n                    // for ungoogable reasons, libreoffice prepends format strings with\n                    // \"1033;\" and sometimes with \"1033;0;\". discard it below.\n                    format = format.replace(/^1033;(?:0;)?/, \"\");\n                }\n            }\n\n            // note: Chrome 70 appends a \\t to a cell's text, which is actually mandated by the standard\n            // ([1] item 6).  We remove it below.  In [2] it's suggested they might switch back to\n            // previous behavior, but removing an eventual last TAB won't hurt anyway.\n            //\n            // [1] https://www.w3.org/TR/html53/dom.html#dom-htmlelement-innertext\n            // [2] https://bugs.chromium.org/p/chromium/issues/detail?id=897373\n            if (value == null) {\n                value = element.innerText.replace(/\\t$/, \"\");\n            }\n\n            var borders = borderObject(element, styles);\n            var state = {\n                value: value === \"\" ? null : value,\n                formula: formula,\n\n                borderTop    : borders.borderTop    || hBorders.get(row, col)     || null,\n                borderBottom : borders.borderBottom || hBorders.get(row + 1, col) || null,\n                borderLeft   : borders.borderLeft   || vBorders.get(row, col)     || null,\n                borderRight  : borders.borderRight  || vBorders.get(row, col + 1) || null,\n\n                fontSize : parseInt(styles[\"fontSize\"], 10)\n            };\n\n            if (format != null) {\n                state.format = format;\n            }\n\n            hBorders.set(row, col, state.borderTop);\n            hBorders.set(row + 1, col, state.borderBottom);\n            vBorders.set(row, col, state.borderLeft);\n            vBorders.set(row, col + 1, state.borderRight);\n\n            if (styles[\"backgroundColor\"] !== \"rgb(0, 0, 0)\" && styles[\"backgroundColor\"] !== \"rgba(0, 0, 0, 0)\") {\n                state.background = styles[\"backgroundColor\"];\n            }\n            if (stripStyle(styles[\"textAlign\"]) !== \"right\") {\n                state.textAlign = stripStyle(styles[\"textAlign\"]);\n            }\n            if (styles[\"verticalAlign\"] !== \"middle\") {\n                state.verticalAlign = styles[\"verticalAlign\"];\n            }\n            if (styles[\"wordWrap\"] !== \"normal\" ) {\n                state.wrap = true;\n            }\n\n            var txtElem = element.querySelector(\"font\"); // libre office\n            if (txtElem) {\n                styles = window.getComputedStyle(txtElem);\n            }\n\n            if (styles.color !== \"rgb(0, 0, 0)\" && styles.color !== \"rgba(0, 0, 0, 0)\") {\n                state.color = styles.color;\n            }\n            if (/^underline/.test(styles[\"textDecoration\"])) {\n                state.underline = true;\n            }\n            if (styles[\"fontStyle\"] == \"italic\") {\n                state.italic = true;\n            }\n            if (/^(?:bold|[67]00)$/i.test(styles[\"fontWeight\"])) {\n                state.bold = true;\n            }\n\n            return state;\n        }\n\n        function parseHTML(table) {\n            var state = newState();\n\n            var done = [], row = 0, col = 0;\n            for (var i = 0; i < table.rows.length; ++i) {\n                done.push([]);\n            }\n            var hBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n            var vBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n\n            for (var ri = 0; ri < table.rows.length; ++ri, ++row) {\n                var tr = table.rows[ri];\n                col = 0;\n                for (var ci = 0; ci < tr.cells.length; ++ci) {\n                    var td = tr.cells[ci];\n                    var rowSpan = td.rowSpan;\n                    var colSpan = td.colSpan;\n                    while (done[row][col]) {\n                        col++;\n                    }\n\n                    // A cell containing a long text overflowing the next (empty) cell will weirdly be\n                    // reported as merged by Excel (has colspan=2).  Then, Excel informatively suggests\n                    // us to ignore the colSpan by passing mso-ignore:colspan in the style.  Much thanks!\n                    // https://github.com/telerik/kendo-ui-core/issues/3760\n                    var style = td.getAttribute(\"style\");\n                    var ignoreColspan = /mso-ignore:colspan/.test(style);\n\n                    setStateData(state, row, col, cellState(row, col, td, hBorders, vBorders));\n                    if (rowSpan > 1 || (colSpan > 1 && !ignoreColspan)) {\n                        state.mergedCells.push(\n                            new kendo.spreadsheet.RangeRef(\n                                new CellRef(row, col),\n                                new CellRef(row + rowSpan - 1, col + colSpan - 1)\n                            ).toString());\n                    }\n                    for (var dr = row + rowSpan; --dr >= row;) {\n                        for (var dc = col + colSpan; --dc >= col;) {\n                            if (dr < done.length) {\n                                done[dr][dc] = true;\n                                if (!(dr == row && dc == col)) {\n                                    setStateData(state, dr, dc, {});\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            return state;\n        }\n\n        function parseTSV(data) {\n            var state = newState();\n            if (data.indexOf(\"\\t\") === -1 && data.indexOf(\"\\n\") == -1) {\n                setStateData(state, 0, 0, { value: data });\n            } else {\n                var rows = data.split(\"\\n\");\n                for (var ri = 0; ri < rows.length; ri++) {\n                    var cols = rows[ri].split(\"\\t\");\n                    for (var ci = 0; ci < cols.length; ci++) {\n                        setStateData(state, ri, ci, { value: cols[ci] });\n                    }\n                }\n            }\n            return state;\n        }\n\n    })(kendo);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n\n        var PROPERTIES = [\n            \"color\", \"fontFamily\", \"underline\",\n            \"italic\", \"bold\", \"textAlign\", \"indent\",\n            \"verticalAlign\", \"background\", \"format\", \"link\", \"editor\",\n            \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\",\n            \"comment\", \"html\"\n        ];\n\n        var Range = kendo.Class.extend({\n            init: function(ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n\n            clone: function() {\n                return new Range(this._ref.clone(), this._sheet);\n            },\n\n            skipHiddenCells: function() {\n                var refs = [];\n                var self = this, sheet = self._sheet;\n                var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n                var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n                self._ref.forEach(function(ref){\n                    ref = self._normalize(ref.toRangeRef());\n                    var tl = ref.topLeft, br = ref.bottomRight;\n                    var rows = partition(tl.row, br.row, skipHiddenRows);\n                    var cols = partition(tl.col, br.col, skipHiddenCols);\n                    for (var i = 0; i < rows.length; ++i) {\n                        for (var j = 0; j < cols.length; ++j) {\n                            refs.push(new RangeRef(\n                                new CellRef(rows[i].begin, cols[j].begin),\n                                new CellRef(rows[i].end, cols[j].end)\n                            ));\n                        }\n                    }\n                });\n                return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n            },\n\n            _normalize: function(ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n\n            _set: function(name, value, noTrigger) {\n                var self = this;\n                var sheet = self._sheet;\n                self._ref.forEach(function(ref) {\n                    var result = ref;\n                    var valueProp = name === \"value\" || name === \"formula\" || name === \"link\";\n\n                    // Set values/formulas/links only to the topLeft cell when merged\n                    if(valueProp && ref.topLeft) {\n                        var topLeftRef = new CellRef(ref.topLeft.row, ref.topLeft.col);\n\n                        sheet.forEachMergedCell(function(f){\n                            if(f.intersects(topLeftRef)) {\n                                result = topLeftRef;\n                            }\n                        });\n                    }\n\n                    sheet._set(result.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc  : name == \"formula\" || name == \"value\" || name == \"validation\",\n                        value   : value,\n                        range   : self,\n                        ref     : self._ref,\n                        isValue : name == \"value\"\n                    });\n                }\n                return self;\n            },\n\n            _get: function(name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n\n            _property: function(name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n\n            value: function(value) {\n                if (value !== undefined) {\n                    // When value is set through the public API we must clear the\n                    // formula.  Don't trigger change (third parameter), it'll be\n                    // done when setting the value below\n                    this._set(\"formula\", null, true);\n                }\n                return this._property(\"value\", value);\n            },\n\n            html: function(value) {\n                return this._property(\"html\", value);\n            },\n\n            resize: function(direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n\n            _resizedRef: function(direction) {\n                return this._ref.map(function(ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n\n            input: function(value, options) {\n                options = $.extend({\n                    arrayFormula: false\n                }, options);\n                var existingFormat = this._get(\"format\"), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value, existingFormat);\n                    this._sheet.batch(function() {\n                        var formula = null;\n                        if (x.type == \"exp\") {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (existingFormat != \"@\") {\n                            var existingFormatType = existingFormat &&\n                                kendo.spreadsheet.formatting.type(x.value, existingFormat);\n                            if (x.type == \"date\" && existingFormatType != \"date\") {\n                                this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                            } else if (x.type == \"percent\" && existingFormatType != \"percent\") {\n                                this.format(x.value*100 == (x.value*100|0) ? \"0%\" : \"0.00%\");\n                            } else if (x.format) {\n                                if (!existingFormat || x.currency ||\n                                    (existingFormatType == \"number\" && x.type == \"number\" &&\n                                     x.format.length > existingFormat.length)) {\n                                    this.format(x.format);\n                                }\n                            }\n                        } else if (x.type != \"string\") {\n                            x.value = value;\n                        }\n                        this.formula(formula, options.arrayFormula);\n                        if (!formula) {\n                            // value() will clear the formula.  Lucky for us,\n                            // x.value is undefined so it actually won't, but let's\n                            // be explicit and only set value if formula is not\n                            // present.\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc       : true,\n                        value        : value,\n                        ref          : this._ref,\n                        editorChange : this._sheet.isInEditMode(),\n                        isValue      : true\n                    });\n\n                    return this;\n                } else {\n                    value = this._get(\"value\");\n                    var formula = this._get(\"formula\");\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n\n                    if (formula) {\n                        // it's a Formula object which stringifies to the\n                        // formula as text (without the starting `=`).\n                        value = \"=\" + formula;\n                    } else OUT: {\n                        if (existingFormat && type == \"date\") {\n                            // check if we could parse back the displayed value.\n                            // https://github.com/telerik/kendo/issues/5335\n                            var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                            x = kendo.spreadsheet.calc.parse(null, null, null, t1, existingFormat); // it's not a formula so we don't need sheet/row/col\n                            var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                            if (t1 == t2) {\n                                value = t1;\n                                break OUT;\n                            }\n                        }\n                        if (type === \"date\") {\n                            value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                        } else if (type === \"percent\") {\n                            value = kendo.spreadsheet.calc.runtime.limitPrecision(value * 100) + \"%\";\n                        } else if (typeof value == \"string\" &&\n                                   (/^[=']/.test(value) ||\n                                    (/^(?:true|false)$/i).test(value) ||\n                                    looksLikeANumber(value))) {\n                            value = \"'\" + value;\n                        } else if (this._sheet._useCultureDecimals() &&\n                                   typeof value == \"number\" &&\n                                   value != Math.floor(value)) {\n                            value = String(value).replace(\".\", kendo.culture().numberFormat[\".\"]);\n                        }\n                    }\n\n                    return value;\n                }\n            },\n\n            enable: function(value) {\n                if (value === undefined) {\n                    return !kendo.util.withExit(function(exit){\n                        this._sheet.forEach(this._ref, function(_, __, data) {\n                            if (data.enable === false) {\n                                exit(true);\n                            }\n                        });\n                    }, this);\n                }\n\n                return this._property(\"enable\", value);\n            },\n\n            formula: function(value, arrayFormula) {\n                var self = this;\n                if (value === undefined) {\n                    var f = self._get(\"formula\");\n                    return f ? \"\" + f : null; // stringify if present\n                }\n                if (arrayFormula) {\n                    // when setting an array formula, we want to set it on\n                    // the first cell only, as it will fill the whole\n                    // range.\n                    var ref = this._ref.toRangeRef();\n                    value = self._sheet.range(ref.topLeft)\n                        ._set(\"formula\", value)\n                        ._get(\"formula\"); // make sure we get the compiled Formula, not a string\n\n                    if (value) {    // could be null.\n                        // this will be used in FormulaContext -- it's the\n                        // range that the formula must populate.\n                        value.setArrayFormulaRange(ref);\n                    }\n                } else {\n                    self._set(\"formula\", value);\n                }\n                return self;\n            },\n\n            intersectingArrayFormula: function() {\n                var ref = this._ref.clone().simplify().setSheet(this._sheet.name());\n                return kendo.util.withExit(function(exit){\n                    this._sheet._forFormulas(function(f){\n                        var r = f.arrayFormulaRange;\n                        if (r && (r = ref.intersect(r)) !== kendo.spreadsheet.NULLREF) {\n                            exit({ formula: f, intersection: r });\n                        }\n                    });\n                }, this);\n            },\n\n            canEditArrayFormula: function() {\n                var x = this.intersectingArrayFormula();\n                if (x) {\n                    // we want to allow editing only when the new range is\n                    // at least as big as the original range (i.e. no\n                    // cells removed)\n                    return x.formula.arrayFormulaRange.eq(x.intersection);\n                }\n                return true;\n            },\n\n            validation: function(value) {\n                //TODO: Accept objects only?\n\n                if (value === undefined) {\n                    var f = this._get(\"validation\");\n\n                    return f ? f.toJSON() : null; // stringify if present\n                }\n                return this._property(\"validation\", value);\n            },\n\n            _getValidationState: function() {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n\n                for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                        var validation = this._sheet._validation(ri, ci);\n\n                        if (validation && validation.type === \"reject\" && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n\n                return false;\n            },\n\n            merge: function() {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n\n            unmerge: function() {\n                var mergedCells = this._sheet._mergedCells;\n\n                this._ref.forEach(function(ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function(mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n\n                this._sheet.triggerChange({});\n\n                return this;\n            },\n\n            select: function() {\n                this._sheet.select(this._ref);\n\n                return this;\n            },\n\n            values: function(values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error(\"Unsupported for multiple ranges.\");\n                }\n\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error(\"Unsupported for NULLREF.\");\n                    } else {\n                        return [];\n                    }\n                }\n\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n\n                if (values === undefined) {\n                    values = new Array(ref.height());\n\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n\n                    return values;\n                } else {\n                    this._sheet._set(ref, \"formula\", null);\n\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                            var row = values[ri - topLeftRow];\n\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n\n                    this._sheet.triggerChange({ recalc: true, ref: ref });\n\n                    return this;\n                }\n            },\n\n            _properties: function(props, isAutofill) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error(\"Unsupported for multiple ranges.\");\n                }\n\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error(\"Unsupported for NULLREF.\");\n                    } else {\n                        return [];\n                    }\n                }\n\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function(row, col, data){\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                }\n                else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function(propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n\n                        if (propName == \"value\") {\n                            sheet._set(ref, \"formula\", null);\n                        }\n\n                        sheet._set(ref, propName, propValue);\n                    };\n\n                    var isValue = false;\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                        if (!isAutofill && sheet.isHiddenColumn(ci)) {\n                            continue;\n                        }\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                            if (!isAutofill && sheet.isHiddenRow(ri)) {\n                                continue;\n                            }\n                            if (isAutofill && sheet.isFilteredRow(ri)) {\n                                continue;\n                            }\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    var keys = Object.keys(data);\n                                    keys.forEach(setProp);\n                                    isValue = isValue || keys.includes(\"value\");\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({ recalc: true, ref: this._ref, isValue: isValue });\n                    return this;\n                }\n            },\n\n            clear: function(options) {\n                options = options || {};\n                var clearAll = options.clearAll || !Object.keys(options).length;\n\n                var sheet = this._sheet;\n\n                var reason = {\n                    recalc: clearAll || options.contentsOnly,\n                    ref: this._ref,\n                    isValue: true\n                };\n\n                sheet.batch(function() {\n\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n\n                    if (clearAll || options.formatOnly) {\n                        PROPERTIES.forEach(function(x) {\n                            if (!(options.keepBorders && /^border/i.test(x))) {\n                                this[x](null);\n                            }\n                        }.bind(this));\n                        this.fontSize(null);\n                        this.wrap(null);\n                        this.unmerge();\n                    }\n\n                }.bind(this), reason);\n\n                return this;\n            },\n\n            clearContent: function() {\n                return this.clear({ contentsOnly: true });\n            },\n\n            clearFormat: function() {\n                return this.clear({ formatOnly: true });\n            },\n\n            isSortable: function() {\n                return !this.cantSort();\n            },\n\n            cantSort: function() {\n                if (this._ref instanceof UnionRef) {\n                    return { code: \"cantSortMultipleSelection\",\n                             message: \"Unsupported for multiple ranges.\" };\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    return { code: \"cantSortNullRef\",\n                             message: \"Unsupported for NULLREF.\" };\n                }\n                var mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                var width = null, height = null;\n                var cant = {};\n                try {\n                    this._sheet.forEach(this, function(row, col){\n                        var id = new CellRef(row, col).print();\n                        var merged = primary[id];\n                        if (merged) {\n                            if (width === null) {\n                                width = merged.width();\n                                height = merged.height();\n                            } else if (!(width == merged.width() && height == merged.height())) {\n                                throw cant;\n                            }\n                        }\n                        else if (!secondary[id] && mc.hasMerged) {\n                            throw cant;\n                        }\n                    });\n                } catch(ex) {\n                    if (ex !== cant) {\n                        throw ex;\n                    }\n                    return {\n                        code: \"cantSortMixedCells\",\n                        message: \"Unsupported for range containing cells of different shapes.\"\n                    };\n                }\n                return false;\n            },\n\n            sort: function(spec) {\n                var reason = this.cantSort();\n                if (reason) {\n                    throw new Error(reason.message);\n                }\n\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n\n                spec = spec instanceof Array ? spec : [spec];\n\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n                    if (typeof spec === \"number\") {\n                        spec = { column: spec };\n                    }\n\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n\n                return this;\n            },\n\n            isFilterable: function() {\n                return !(this._ref instanceof UnionRef);\n            },\n\n            filter: function(spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error(\"Unsupported for multiple ranges.\");\n                }\n\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n                        return {\n                            index: spec.column === undefined ? spec.index === undefined ? index : spec.index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n\n                return this;\n            },\n\n            clearFilter: function(spec) {\n                this._sheet.clearFilter(spec);\n            },\n\n            clearFilters: function() {\n                var filter = this._sheet.filter();\n                var spec = [];\n\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(filter.columns[i].index);\n                    }\n\n                    this._sheet.batch(function() {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, { layout: true, filter: true });\n                }\n            },\n\n            hasFilter: function() {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n\n            leftColumn: function() {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n\n            rightColumn: function() {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n\n            topRow: function() {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n\n            bottomRow: function() {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n\n            column: function(column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n\n            row: function(row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n\n            forEachRow: function(callback) {\n                this._ref.forEachRow(function(ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n\n            forEachColumn: function(callback) {\n                this._ref.forEachColumn(function(ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n\n            sheet: function() {\n                return this._sheet;\n            },\n\n            topLeft: function() {\n                return this._ref.toRangeRef().topLeft;\n            },\n\n            intersectingMerged: function() {\n                var sheet = this._sheet;\n                var mergedCells = [];\n\n                sheet._mergedCells.forEach(function(ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n\n                return mergedCells;\n            },\n\n            getState: function(propertyName) {\n                var topLeft = this._ref.first();\n                var state = {\n                    ref     : topLeft,\n                    data    : [],\n                    origRef : this._ref,\n\n                    // save row heights\n                    rows    : this._sheet._rows.getState()\n                };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === \"input\") {\n                    properties = [\"value\", \"formula\"];\n                } else if (propertyName === \"border\") {\n                    properties = [\"borderLeft\", \"borderTop\", \"borderRight\", \"borderBottom\"];\n                } else {\n                    properties = [propertyName];\n                }\n\n                var data = state.data;\n                this.forEachCell(function(row, col, cell) {\n                    var cellState = {};\n                    var dr = row - topLeft.row;\n                    var dc = col - topLeft.col;\n                    if (!data[dr]) {\n                        data[dr] = [];\n                    }\n                    data[dr][dc] = cellState;\n\n                    properties.forEach(function(property) {\n                        var value = typeof cell[property] == \"undefined\" ? null : cell[property];\n                        if (value instanceof kendo.spreadsheet.calc.runtime.Formula ||\n                            value instanceof kendo.spreadsheet.validation.Validation)\n                        {\n                            value = value.deepClone();\n                        }\n                        cellState[property] = value;\n                    });\n                });\n\n                return state;\n            },\n\n            setState: function(state, clipboard) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                var internalClipboard = clipboard && !clipboard.isExternal();\n                var externalClipboard = clipboard && !internalClipboard;\n\n                sheet.batch(function() {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n\n                    if (!clipboard) {\n                        // restore row heights.  they won't be available\n                        // when this function is called from the clipboard\n                        // code.\n                        this._sheet._rows.setState(state.rows);\n                    }\n\n                    var row = origin.row;\n                    var hasFilter = this.hasFilter();\n                    state.data.forEach(function(data, dr){\n                        if (hasFilter && internalClipboard && sheet.isHiddenRow(state.ref.row + dr)) {\n                            return;\n                        }\n                        var col = origin.col;\n                        data.forEach(function(cellState, dc){\n                            if (hasFilter && internalClipboard && sheet.isHiddenColumn(state.ref.col + dc)) {\n                                return;\n                            }\n                            var range = clipboard ? sheet.range(row, col)\n                                : sheet.range(origin.row + dr, origin.col + dc);\n                            if (range.enable()) {\n                                for (var property in cellState) {\n                                    if (property != \"value\") {\n                                        // make sure value comes last (after the loop),\n                                        // because if we set value here and get get to\n                                        // formula later and cellState.formula is null,\n                                        // it'll clear the value.\n\n                                        // when pasting, do not copy \"disabled\" state\n                                        if (!(clipboard && property == \"enable\")) {\n                                            range._set(property, cellState[property]);\n                                        }\n                                    }\n                                }\n                                if (!cellState.formula) {\n                                    // only need to set the value if we don't have a\n                                    // formula.  Go through the lower level setter rather\n                                    // than range.value(...), because range.value will clear\n                                    // the formula!  chicken and egg issues.\n                                    if (externalClipboard) {\n                                        // https://github.com/telerik/kendo-ui-core/issues/1688\n                                        // if we have a paste from external source, we should parse the\n                                        // value as if it were inputted.  This allows to treat numbers\n                                        // as numbers, or `=sum(a1:b2)` as formula (Google Sheets does\n                                        // the same).  A difference though is that we can't store an\n                                        // invalid Formula and display #ERROR, like G.S. does, so in\n                                        // case of a parse error we'll just set the value as string.\n                                        try {\n                                            if (cellState.value == null) {\n                                                range._set(\"value\", null);\n                                            } else {\n                                                range.input(cellState.value);\n                                            }\n                                        } catch(ex) {\n                                            range._set(\"value\", cellState.value);\n                                        }\n                                    } else {\n                                        range._set(\"value\", cellState.value);\n                                    }\n                                }\n                            }\n                            col++;\n                        });\n                        row++;\n                    });\n\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function(merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), { recalc: true, ref: this._ref });\n            },\n\n            _adjustRowHeight: function() {\n                var that = this;\n                var sheet = that._sheet;\n                var mc = sheet._getMergedCells(that._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n\n                sheet.batch(function() {\n                    that.forEachRow(function(rowRange){\n                        var row = rowRange._ref.topLeft.row;\n                        var height = sheet.rowHeight(row);\n                        if (!height) {\n                            // do not adjust if hidden.\n                            // https://github.com/telerik/kendo-ui-core/issues/6272\n                            // (case 2)\n                            return;\n                        }\n                        rowRange.forEachCell(function(row, col, cell){\n                            var id = new CellRef(row, col).print();\n                            if (secondary[id]) {\n                                return;\n                            }\n                            var merged = primary[id];\n                            var width;\n                            if (merged) {\n                                width = sheet._columns.sum(merged.topLeft.col,\n                                                           merged.bottomRight.col);\n                            } else {\n                                width = sheet.columnWidth(col);\n                            }\n                            var data = cell.value;\n                            if (cell.format && data != null) {\n                                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                            }\n                            var textHeight = kendo.spreadsheet.util.getTextHeight(\n                                data, width, cell.fontFamily, cell.fontSize, cell.wrap);\n                            height = Math.max(height, textHeight);\n                        });\n                        sheet.rowHeight(row, height);\n                    });\n                }, { layout: true });\n            },\n\n            forEachCell: function(callback) {\n                this._ref.forEach(function(ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n\n            hasValue: function() {\n                var defStyle = this._sheet._defaultCellStyle;\n                return kendo.util.withExit(function(exit){\n                    this.forEachCell(function(row, col, cell) {\n                        // we must not consider cells that only have same values\n                        // as defaultCellStyle, or otherwise we will forbid\n                        // inserting rows/cols in an empty sheet.\n                        for (var key in cell) {\n                            var val = cell[key];\n                            if (val !== undefined && val !== null && val !== defStyle[key]) {\n                                exit(true);\n                            }\n                        }\n                    });\n                }, this);\n            },\n\n            wrap: function(flag) {\n                if (flag === undefined) {\n                    return !!this._property(\"wrap\");\n                }\n                this._property(\"wrap\", flag);\n                if (flag !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n\n            fontSize: function(size) {\n                if (size === undefined) {\n                    return this._property(\"fontSize\");\n                }\n                this._property(\"fontSize\", size);\n                if (size !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n\n            draw: function(options, callback) {\n                this._sheet.draw(this, options, callback);\n            },\n\n            insideBorders: function(value) {\n                return this.insideVerticalBorders(value).insideHorizontalBorders(value);\n            },\n\n            insideVerticalBorders: function(value) {\n                this._ref.forEach(function(ref){\n                    if (ref instanceof RangeRef && ref.width() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.col++;\n                        this._sheet.range(ref)._set(\"vBorders\", value);\n                    }\n                }, this);\n                return this;\n            },\n\n            insideHorizontalBorders: function(value) {\n                this._ref.forEach(function(ref){\n                    if (ref instanceof RangeRef && ref.height() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.row++;\n                        this._sheet.range(ref)._set(\"hBorders\", value);\n                    }\n                }, this);\n                return this;\n            }\n        });\n\n        function partition(begin, end, predicate) {\n            while (begin <= end && predicate(begin)) {\n                begin++;\n            }\n            if (begin > end) {\n                return [];\n            }\n            for (var i = begin + 1; i <= end; ++i) {\n                if (predicate(i)) {\n                    return [\n                        { begin: begin, end: i - 1 }\n                    ].concat(partition(i + 1, end, predicate));\n                }\n            }\n            return [{ begin: begin, end: end }];\n        }\n\n        // use $.each instead of forEach to work in oldIE\n        $.each(PROPERTIES, function(i, property) {\n            Range.prototype[property] = function(value) {\n                return this._property(property, value);\n            };\n        });\n\n        function toExcelFormat(format) {\n            return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n        }\n\n        function looksLikeANumber(str) {\n            // XXX: could do with just a regexp instead of calling parse.\n            return !(/^=/.test(str)) && (/number|percent/).test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n\n        var measureBox = $('<div></div>')[0];\n        measureBox.style.cssText = 'position: absolute !important; top: -4000px !important; height: auto !important;' +\n        'padding: 1px 3px !important; box-sizing: border-box; margin: 0 !important; border: 1px solid black !important;' +\n        'line-height: normal !important; visibility: hidden !important;' +\n        'white-space: pre-wrap;';\n\n        function getTextHeight(text, width, fontFamily, fontSize, wrap) {\n            var styles = {\n                \"baselineMarkerSize\" : 0,\n                \"width\" : (wrap === true) ? width + \"px\" : \"auto\",\n                \"font-size\" : (fontSize || 12) + \"px\",\n                \"font-family\" : fontFamily || \"Arial\",\n                \"white-space\" : (wrap === true) ? \"pre-wrap\" : \"pre\",\n                \"overflow-wrap\" : (wrap === true) ? \"break-word\" : \"normal\",\n                \"word-wrap\" : (wrap === true) ? \"break-word\" : \"normal\"\n            };\n\n            return kendo.util.measureText(text, styles, { box: measureBox, normalizeText: false }).height;\n        }\n\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    })(window.kendo);\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n        /* global console */\n\n\n        var calc$4 = {};\n        var spreadsheet$7 = kendo.spreadsheet;\n        spreadsheet$7.calc = calc$4;\n        var exports$3 = calc$4.runtime = {};\n        var Class$1 = kendo.Class;\n\n        var Ref$3 = spreadsheet$7.Ref;\n        var CellRef$4 = spreadsheet$7.CellRef;\n        var RangeRef$3 = spreadsheet$7.RangeRef;\n        var UnionRef$2 = spreadsheet$7.UnionRef;\n        var NULL = spreadsheet$7.NULLREF;\n\n        /* -----[ Errors ]----- */\n\n        function CalcError$2(code) {\n            if (code instanceof CalcError$2) {\n                return code;\n            }\n            this.code = code;\n        }\n\n        CalcError$2.prototype.toString = function() {\n            return \"#\" + this.code + (this.code == \"NAME\" ? \"?\" : \"!\");\n        };\n\n        /* -----[ Context ]----- */\n\n        var Context = Class$1.extend({\n            init: function Context(callback, formula, ss, parent) {\n                this.callback = callback;\n                this.formula = formula;\n                this.ss = ss;\n                this.parent = parent;\n            },\n\n            resolve: function(val) {\n                var self = this;\n                if (val instanceof Ref$3) {\n                    self.resolveCells([ val ], function(){\n                        self._resolve(val);\n                    });\n                } else {\n                    self._resolve(val);\n                }\n            },\n\n            error: function(val) {\n                return new CalcError$2(val);\n            },\n\n            _resolve: function(val) {\n                if (val === undefined) {\n                    val = null;\n                } else if (Array.isArray(val)) {\n                    val = this.asMatrix(val);\n                } else {\n                    val = maybeRoundFloatErrors(val);\n                }\n                var f = this.formula;\n                if (f.arrayFormulaRange) {\n                    // when this is an array formula, make sure we return a Matrix.  The value already\n                    // *should* be a Matrix, so this won't incur speed penalty in normal cases.\n                    val = this.asMatrix(val) || this.asMatrix([[ val ]]);\n                } else if (val instanceof RangeRef$3) {\n                    val = this._arrayArg(val);\n                }\n                f.value = val;\n                if (this.ss.onFormula(f) && this.callback) {\n                    this.callback.call(f, val);\n                }\n            },\n\n            resolveCells: function(a, f) {\n                var context = this, formulas = [];\n\n                (function loop(a){\n                    for (var i = 0; i < a.length; ++i) {\n                        var x = a[i];\n                        if (x instanceof Ref$3) {\n                            add(context.getRefCells(x));\n                        }\n                        if (Array.isArray(x)) {\n                            // make sure we resolve cells in literal matrices\n                            loop(x);\n                        }\n                    }\n                })(a);\n\n                if (!formulas.length) {\n                    return f.call(context);\n                }\n\n                for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                    fetch(formulas[i]);\n                }\n                function fetch(formula) {\n                    formula.exec(context.ss, function(){\n                        if (!--pending) {\n                            f.call(context);\n                        }\n                    }, context);\n                }\n                function add(a) {\n                    for (var i = 0; i < a.length; ++i) {\n                        var cell = a[i];\n                        if (cell.formula) {\n                            formulas.push(cell.formula);\n                        }\n                    }\n                    return true;\n                }\n            },\n\n            cellValues: function(a, wantNulls) {\n                var ret = [];\n                for (var i = 0; i < a.length; ++i) {\n                    var val = a[i];\n                    if (val instanceof Ref$3) {\n                        val = this.getRefData(val, wantNulls);\n                        ret = ret.concat(val);\n                    } else if (Array.isArray(val)) {\n                        ret = ret.concat(this.cellValues(val, wantNulls));\n                    } else if (val instanceof Matrix$1) {\n                        ret = ret.concat(this.cellValues(val.data, wantNulls));\n                    } else {\n                        ret.push(val);\n                    }\n                }\n                return ret;\n            },\n\n            fetchName: function(ref, callback) {\n                var f = this.formula;\n                var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n                if (val instanceof Formula$1) {\n                    // clone and relocate to calling formula, so that relative references in a named\n                    // formula would work as expected.\n                    val = val.clone(f.sheet, f.row, f.col, true);\n\n                    // XXX: I don't like this dependency here; basically we only need ss.onFormula to\n                    // return true and do nothing else.\n                    var ss = new spreadsheet$7.ValidationFormulaContext(this.ss.workbook);\n\n                    val.exec(ss, callback, this);\n                } else {\n                    if (val instanceof Ref$3) {\n                        // relocate for relative refs\n                        val = val.absolute(f.row, f.col);\n                        if (val instanceof RangeRef$3 && this.ss.isMerged(val)) {\n                            val = val.topLeft;\n                        }\n                        if (!val.sheet) {\n                            val.sheet = f.sheet;\n                        }\n                    }\n                    callback(val == null ? new CalcError$2(\"NAME\") : val);\n                }\n            },\n\n            force: function(val) {\n                if (val instanceof Ref$3) {\n                    return this.getRefData(val);\n                }\n                return val;\n            },\n\n            func: function(fname, callback, args) {\n                fname = fname.toLowerCase();\n                var f = FUNCS[fname];\n                if (f) {\n                    return f.call(this, callback, args);\n                }\n                callback(new CalcError$2(\"NAME\"));\n            },\n\n            bool: function(val) {\n                if (val instanceof Ref$3) {\n                    val = this.getRefData(val);\n                }\n                if (typeof val == \"string\") {\n                    return val.toLowerCase() == \"true\";\n                }\n                if (typeof val == \"number\") {\n                    return val !== 0;\n                }\n                if (typeof val == \"boolean\") {\n                    return val;\n                }\n                return val != null;\n            },\n\n            _arrayArg: function(ref) { // not necessarily a reference though\n                var f = this.formula;\n                if (!f.arrayFormulaRange && ref instanceof RangeRef$3) {\n                    // if formula wasn't saved with Ctrl-Shift-Enter but a range is passed, Excel does\n                    // something special:\n                    //\n                    // - if range is Wx1 (horizontal array) and current formula resides within the\n                    //   horizontal bounds of the range, the appropriate cell is selected.  Example:\n                    //   A1..D1 contain 1, 2, 3, 4 and we have in B2: =A1:D1, then B2 will get 2 (the\n                    //   value in A2).  If the same formula is typed outside the horizontal span of the\n                    //   range, say in E2: =A1:D1, then #VALUE! is returned.\n                    //\n                    // - similarly, if the range is 1xH (vertical array), the formula must reside within\n                    //   the vertical bounds of the range and it gets the corresponding cell; otherwise,\n                    //   #VALUE!.\n                    if (ref.height() == 1 && f.col >= ref.topLeft.col && f.col <= ref.bottomRight.col) {\n                        return this.getRefData(new CellRef$4(ref.topLeft.row, f.col).setSheet(ref.sheet));\n                    }\n                    if (ref.width() == 1 && f.row >= ref.topLeft.row && f.row <= ref.bottomRight.row) {\n                        return this.getRefData(new CellRef$4(f.row, ref.topLeft.col).setSheet(ref.sheet));\n                    }\n                    return new CalcError$2(\"VALUE\");\n                } else {\n                    return this.asMatrix(ref);\n                }\n            },\n\n            asMatrix: function(range) {\n                if (range instanceof Matrix$1) {\n                    return range;\n                }\n                var self = this;\n                if (range instanceof RangeRef$3) {\n                    var tl = range.topLeft;\n                    var top = tl.row, left = tl.col;\n                    var cells = self.getRefCells(range);\n                    var m = new Matrix$1(self);\n                    if (isFinite(range.width())) {\n                        m.width = range.width();\n                    }\n                    if (isFinite(range.height())) {\n                        m.height = range.height();\n                    }\n                    if (!isFinite(top)) {\n                        top = 0;\n                    }\n                    if (!isFinite(left)) {\n                        left = 0;\n                    }\n                    cells.forEach(function(cell){\n                        m.set(cell.row - top,\n                              cell.col - left,\n                              cell.value);\n                    });\n                    return m;\n                }\n                if (Array.isArray(range) && range.length > 0) {\n                    var m = new Matrix$1(self), row = 0;\n                    range.forEach(function(line){\n                        var col = 0;\n                        var h = 1;\n                        line.forEach(function(el){\n                            var isRange = el instanceof RangeRef$3;\n                            if (el instanceof Ref$3 && !isRange) {\n                                el = self.getRefData(el);\n                            }\n                            if (isRange || Array.isArray(el)) {\n                                el = self.asMatrix(el);\n                            }\n                            if (el instanceof Matrix$1) {\n                                el.each(function(el, r, c){\n                                    m.set(row + r, col + c, el);\n                                });\n                                h = Math.max(h, el.height);\n                                col += el.width;\n                            } else {\n                                if(typeof el === \"string\" && el.length && !isNaN(el)) {\n                                    el = Number(el);\n                                }\n\n                                m.set(row, col++, el);\n                            }\n                        });\n                        row += h;\n                    });\n                    return m;\n                }\n            },\n\n            getRefCells: function(refs, hiddenInfo, wantNulls) {\n                var f = this.formula;\n                return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col, wantNulls);\n            },\n\n            getRefData: function(ref, wantNulls) {\n                var f = this.formula;\n                return this.ss.getData(ref, f.sheet, f.row, f.col, wantNulls);\n            },\n\n            workbook: function() {\n                return this.ss.workbook;\n            }\n        });\n\n        var Matrix$1 = Class$1.extend({\n            init: function Matrix(context) {\n                this.context = context;\n                this.height = 0;\n                this.width = 0;\n                this.data = [];\n            },\n            clone: function() {\n                var m = new Matrix$1(this.context);\n                m.height = this.height;\n                m.width = this.width;\n                m.data = this.data.map(function(row){ return row.slice(); });\n                return m;\n            },\n            get: function(row, col) {\n                var line = this.data[row];\n                var val = line ? line[col] : null;\n                return val instanceof Ref$3 ? this.context.getRefData(val) : val;\n            },\n            getNA: function(row, col) {\n                if (this.height == 1) {\n                    row = 0;\n                }\n                if (this.width == 1) {\n                    col = 0;\n                }\n                if (row < this.height && col < this.width) {\n                    return this.get(row, col);\n                }\n                return new CalcError$2(\"N/A\");\n            },\n            set: function(row, col, data) {\n                var line = this.data[row];\n                if (line == null) {\n                    line = this.data[row] = [];\n                }\n                line[col] = data;\n                if (row >= this.height) {\n                    this.height = row + 1;\n                }\n                if (col >= this.width) {\n                    this.width = col + 1;\n                }\n            },\n            each: function(f, includeEmpty) {\n                for (var row = 0; row < this.height; ++row) {\n                    for (var col = 0; col < this.width; ++col) {\n                        var val = this.get(row, col);\n                        if (includeEmpty || val != null) {\n                            val = f.call(this.context, val, row, col);\n                            if (val !== undefined) {\n                                return val;\n                            }\n                        }\n                    }\n                }\n            },\n            map: function(f, includeEmpty) {\n                var m = new Matrix$1(this.context);\n                this.each(function(el, row, col){\n                    // here `this` is actually the context\n                    m.set(row, col, f.call(this, el, row, col));\n                }, includeEmpty);\n                return m;\n            },\n            eachRow: function(f) {\n                for (var row = 0; row < this.height; ++row) {\n                    var val = f.call(this.context, row);\n                    if (val !== undefined) {\n                        return val;\n                    }\n                }\n            },\n            eachCol: function(f) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = f.call(this.context, col);\n                    if (val !== undefined) {\n                        return val;\n                    }\n                }\n            },\n            mapRow: function(f) {\n                var m = new Matrix$1(this.context);\n                this.eachRow(function(row){\n                    m.set(row, 0, f.call(this.context, row));\n                });\n                return m;\n            },\n            mapCol: function(f) {\n                var m = new Matrix$1(this.context);\n                this.eachCol(function(col){\n                    m.set(0, col, f.call(this.context, col));\n                });\n                return m;\n            },\n            toString: function() {\n                return JSON.stringify(this.data);\n            },\n            transpose: function() {\n                var m = new Matrix$1(this.context);\n                this.each(function(el, row, col){\n                    m.set(col, row, el);\n                });\n                return m;\n            },\n            unit: function(n) {\n                this.width = this.height = n;\n                var a = this.data = new Array(n);\n                for (var i = n; --i >= 0;) {\n                    var row = a[i] = new Array(n);\n                    for (var j = n; --j >= 0;) {\n                        row[j] = i == j ? 1 : 0;\n                    }\n                }\n                return this;\n            },\n            multiply: function(b) {\n                var a = this, m = new Matrix$1(a.context);\n                for (var row = 0; row < a.height; ++row) {\n                    for (var col = 0; col < b.width; ++col) {\n                        var s = 0;\n                        for (var i = 0; i < a.width; ++i) {\n                            var va = a.get(row, i);\n                            var vb = b.get(i, col);\n                            if (typeof va != \"number\" || typeof vb != \"number\") {\n                                throw new CalcError$2(\"VALUE\");\n                            }\n                            s += va * vb;\n                        }\n                        m.set(row, col, s);\n                    }\n                }\n                return m;\n            },\n            adds: function(b, s) {\n                var a = this, m = new Matrix$1(a.context);\n                var sign = s ? -1 : 1;\n                for (var row = 0; row < a.height; ++row) {\n                    for (var col = 0; col < a.width; ++col) {\n                        var x = a.get(row, col),\n                            y = b.get(row, col);\n                        m.set(row, col, x + sign * y);\n                    }\n                }\n                return m;\n            },\n            determinant: function() {\n                var a = this.clone().data;\n                var n = a.length;\n                var d = 1, C, L, i, k;\n                for (C = 0; C < n; C++) {\n                    for (L = C; (L < n) && (!a[L][C]); L++) {}\n                    if (L == n) {\n                        return 0;\n                    }\n                    if (L != C) {\n                        d = -d;\n                        for (k = C; k < n; k++) {\n                            var t = a[C][k];\n                            a[C][k] = a[L][k];\n                            a[L][k] = t;\n                        }\n                    }\n                    for (i = C+1; i < n; i++) {\n                        for (k = C+1; k < n; k++) {\n                            a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                        }\n                    }\n                    d *= a[C][C];\n                }\n                return d;\n            },\n            inverse: function() {\n                var n = this.width;\n                var m = this.augment(new Matrix$1(this.context).unit(n));\n                var a = m.data;\n                var tmp;\n\n                // Gaussian elimination\n                // https://en.wikipedia.org/wiki/Gaussian_elimination#Finding_the_inverse_of_a_matrix\n\n                // 1. Get zeros below main diagonal\n                for (var k = 0; k < n; ++k) {\n                    var imax = argmax(k, n, function(i){ return a[i][k]; });\n                    if (!a[imax][k]) {\n                        return null; // singular matrix\n                    }\n                    if (k != imax) {\n                        tmp = a[k];\n                        a[k] = a[imax];\n                        a[imax] = tmp;\n                    }\n                    for (var i = k+1; i < n; ++i) {\n                        for (var j = k+1; j < 2*n; ++j) {\n                            a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                        }\n                        a[i][k] = 0;\n                    }\n                }\n\n                // 2. Get 1-s on main diagonal, dividing by pivot\n                for (var i = 0; i < n; ++i) {\n                    for (var f = a[i][i], j = 0; j < 2*n; ++j) {\n                        a[i][j] /= f;\n                    }\n                }\n\n                // 3. Get zeros above main diagonal.  Actually, we only care to compute the right side\n                // here (that will be the inverse), so in the inner loop below we go while j >= n,\n                // instead of j >= k.\n                for (var k = n; --k >= 0;) {\n                    for (var i = k; --i >= 0;) {\n                        if (a[i][k]) {\n                            for (var j = 2*n; --j >= n;) {\n                                a[i][j] -= a[k][j] * a[i][k];\n                            }\n                        }\n                    }\n                }\n\n                return m.slice(0, n, n, n);\n            },\n            augment: function(m) {\n                var ret = this.clone(), n = ret.width;\n                m.each(function(val, row, col){\n                    ret.set(row, col + n, val);\n                });\n                return ret;\n            },\n            slice: function(row, col, height, width) {\n                var m = new Matrix$1(this.context);\n                for (var i = 0; i < height; ++i) {\n                    for (var j = 0; j < width; ++j) {\n                        m.set(i, j, this.get(row + i, col + j));\n                    }\n                }\n                return m;\n            }\n\n            // XXX: debug\n            // dump: function() {\n            //     this.data.forEach(function(row){\n            //         console.log(row.map(function(val){\n            //             var str = val.toFixed(3).replace(/\\.?0*$/, function(s){\n            //                 return [ \"\", \" \", \"  \", \"   \", \"    \" ][s.length];\n            //             });\n            //             if (val >= 0) { str = \" \" + str; }\n            //             return str;\n            //         }).join(\"  \"));\n            //     });\n            // }\n        });\n\n        function argmax(i, end, f) {\n            var max = f(i), pos = i;\n            while (++i < end) {\n                var v = f(i);\n                if (v > max) {\n                    max = v;\n                    pos = i;\n                }\n            }\n            return pos;\n        }\n\n        /* -----[ Formula ]----- */\n\n        var Formula$1 = Class$1.extend({\n            init: function Formula(refs, handler, printer, sheet, row, col, arrayFormulaRange){\n                this.refs = refs;\n                this.handler = handler;\n                this.print = printer;\n                this.absrefs = null;\n                this.sheet = sheet;\n                this.row = row;\n                this.col = col;\n                this.onReady = [];\n                this.pending = false;\n                this.arrayFormulaRange = arrayFormulaRange;\n            },\n            setArrayFormulaRange: function(ref) {\n                this.arrayFormulaRange = ref.clone().setSheet(this.sheet);\n            },\n            clone: function(sheet, row, col, forceRefs) {\n                var lcsheet = sheet.toLowerCase();\n                var refs = this.refs;\n                var range = this.arrayFormulaRange;\n                if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n                    refs = refs.map(function(ref){\n                        if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                            ref = ref.clone().setSheet(sheet);\n                        }\n                        return ref;\n                    });\n                    if (range) {\n                        range = range.clone().setSheet(sheet);\n                    }\n                }\n                return new Formula$1(refs, this.handler, this.print, sheet, row, col, range);\n            },\n            deepClone: function() {\n                var refs = this.refs.map(function(ref){ return ref.clone(); });\n                return new Formula$1(refs, this.handler, this.print, this.sheet, this.row, this.col, this.arrayFormulaRange);\n            },\n            resolve: function(val) {\n                this.pending = false;\n                this.onReady.forEach(function(callback){\n                    callback(val);\n                });\n            },\n            exec: function(ss, callback, parentContext) {\n                if (\"value\" in this) {\n                    if (callback) {\n                        callback(this.value);\n                    }\n                } else {\n                    if (callback) {\n                        this.onReady.push(callback);\n                    }\n\n                    var ctx = new Context(this.resolve, this, ss, parentContext);\n                    var level = 0;\n                    // if the call chain leads back to this same formula, we have a circular dependency.\n                    while (parentContext) {\n                        if (parentContext.formula === this) {\n                            this.pending = false;\n                            ctx.resolve(new CalcError$2(\"CIRCULAR\"));\n                            return;\n                        }\n                        parentContext = parentContext.parent;\n                        ++level;\n                    }\n\n                    // pending is still useful for ASYNC formulas\n                    if (this.pending) {\n                        return;\n                    }\n                    this.pending = true;\n\n                    var next = function() {\n                        // compute and cache the absolute references\n                        if (!this.absrefs) {\n                            this.absrefs = this.refs.map(function(ref){\n                                return ref.absolute(this.row, this.col);\n                            }, this);\n                        }\n\n                        // finally invoke the handler given to us by the compiler in calc.js\n                        this.handler.call(ctx);\n                    }.bind(this);\n\n                    if (level < 20) {\n                        next();\n                    } else {\n                        setTimeout(next, 0);\n                    }\n                }\n            },\n            reset: function() {\n                this.onReady = [];\n                this.pending = false;\n                delete this.value;\n            },\n            renameSheet: function(oldSheetName, newSheetName) {\n                oldSheetName = oldSheetName.toLowerCase();\n                this.absrefs = null;\n                if (this.sheet.toLowerCase() == oldSheetName) {\n                    this.sheet = newSheetName;\n                }\n                this.refs.forEach(function(ref){\n                    ref.renameSheet(oldSheetName, newSheetName);\n                });\n            },\n            adjust: function(affectedSheet, operation, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                var formulaSheet = this.sheet.toLowerCase();\n                var formulaMoves = false;\n                if (formulaSheet == affectedSheet) {\n                    // move formula if it's after the change point\n                    if (operation == \"row\" && formulaRow >= start) {\n                        this.row += delta;\n                        formulaMoves = true;\n                    }\n                    if (operation == \"col\" && formulaCol >= start) {\n                        this.col += delta;\n                        formulaMoves = true;\n                    }\n                }\n                var newFormulaRow = this.row;\n                var newFormulaCol = this.col;\n                this.absrefs = null;\n                var prevRefs = this.refs;\n                var modified = formulaMoves;\n                this.refs = prevRefs.map(function(ref){\n                    var newRef = adjust(ref);\n                    if (!modified && !sameRef(newRef, ref)) {\n                        modified = true;\n                    }\n                    return newRef;\n                });\n\n                var prevRange = this.arrayFormulaRange;\n                if (prevRange) {\n                    this.arrayFormulaRange = adjust(prevRange);\n                    if (!modified && !sameRef(prevRange, this.arrayFormulaRange)) {\n                        modified = true;\n                    }\n                }\n\n                if (modified) {\n                    // return a clone of the original formula.  needed to undo operations like\n                    // deleteRow, which can transform a reference into NULL.\n                    return new Formula$1(prevRefs, this.handler, this.print, this.sheet, formulaRow, formulaCol, prevRange);\n                }\n\n                function adjust(ref){\n                    if (ref === NULL) {\n                        return ref;\n                    }\n                    if (ref.sheet.toLowerCase() != affectedSheet) {\n                        if (formulaMoves) {\n                            // a reference to another sheet should still point to the same location\n                            // after adjustment; thus if row/col was removed before formula, relative\n                            // references must be adjusted by delta.\n                            if (operation == \"row\" && formulaRow >= start) {\n                                ref = ref.relative(delta, 0);\n                            }\n                            if (operation == \"col\" && formulaCol >= start) {\n                                ref = ref.relative(0, delta);\n                            }\n                        }\n                        return ref;\n                    }\n                    return ref.adjust(\n                        formulaRow, formulaCol,\n                        newFormulaRow, newFormulaCol,\n                        operation == \"row\",\n                        start, delta\n                    );\n                }\n            },\n            toString: function() {\n                return this.print(this.row, this.col);\n            }\n        });\n\n        function sameRef(r1, r2) {\n            // note: r1.eq(r2) will not do, because it returns true for A1 and A1:A1 (CellRef\n            // vs. RangeRef).  To properly undo we need to assert that the references are exactly the\n            // same (including type).\n            if (r1.constructor !== r2.constructor) {\n                return false;\n            }\n            if (r1 instanceof CellRef$4) {\n                return r1.sheet == r2.sheet\n                    && r1.row == r2.row\n                    && r1.col == r2.col\n                    && r1.rel == r2.rel;\n            }\n            if (r1 instanceof RangeRef$3) {\n                return sameRef(r1.topLeft     , r2.topLeft)\n                    && sameRef(r1.bottomRight , r2.bottomRight)\n                    && r1.endSheet == r2.endSheet;\n            }\n            if (r1 instanceof UnionRef$2) {\n                var i = r1.refs.length;\n                if (i != r2.refs.length) {\n                    return false;\n                }\n                while (--i >= 0) {\n                    if (!sameRef(r1.refs[i], r2.refs[i])) {\n                        return false;\n                    }\n                }\n            }\n            return true;\n        }\n\n        // spreadsheet functions --------\n        var FUNCS = Object.create(null);\n        var DEFER_INIT = [];\n\n        FUNCS[\"if\"] = function(callback, args) {\n            var self = this;\n            var co = args[0], th = args[1], el = args[2];\n            // XXX: I don't like this resolveCells here.  We should try to declare IF with\n            // defineFunction.\n            this.resolveCells([ co ], function(){\n                var comatrix = self.asMatrix(co);\n                if (comatrix) {\n                    // XXX: calling both branches in this case, since we'll typically need values from\n                    // both.  We could optimize and call them only when first needed, but oh well.\n                    th(function(th){\n                        el(function(el){\n                            var thmatrix = self.asMatrix(th);\n                            var elmatrix = self.asMatrix(el);\n                            callback(comatrix.map(function(val, row, col){\n                                if (val instanceof CalcError$2) {\n                                    return val;\n                                } else if (self.bool(val)) {\n                                    return thmatrix ? thmatrix.get(row, col) : th;\n                                } else {\n                                    return elmatrix ? elmatrix.get(row, col) : el;\n                                }\n                            }));\n                        });\n                    });\n                } else {\n                    co = this.force(co);\n                    if (co instanceof CalcError$2) {\n                        callback(co);\n                    } else if (self.bool(co)) {\n                        th(callback);\n                    } else {\n                        el(callback);\n                    }\n                }\n            });\n        };\n\n        FUNCS[\"\"] = function(callback) {\n            callback((1+Math.sqrt(5))/2);\n        };\n\n        // Lasciate ogni speranza, voi ch'entrate.\n        //\n        // XXX: document this function.\n        function compileArgumentChecks(functionName, args) {\n            var arrayArgs = \"function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; \";\n            var resolve = \"function resolve(args, callback) { var toResolve = [], i = 0; \";\n            var name, forced, main = \"'use strict'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE'; \", haveForced = false;\n            var canBeArrayArg = false, hasArrayArgs = false;\n            main += args.map(comp).join(\"\");\n            main += \"if (i < args.length) return new CalcError('N/A'); \";\n            main += \"return xargs; } \";\n            arrayArgs += \"return { args: xargs, width: width, height: height, arrays: arrays }; } \";\n\n            var f;\n            if (haveForced) {\n                resolve += \"this.resolveCells(toResolve, callback); } \";\n                f = new Function(\"CalcError\", \"round\", main + resolve + arrayArgs + \" return { resolve: resolve, check: check, arrayArgs: arrayArgs };\");\n            } else {\n                f = new Function(\"CalcError\", \"round\", main + \" return { check: check };\");\n            }\n            f = f(CalcError$2, limitPrecision$1);\n            if (!hasArrayArgs) {\n                delete f.arrayArgs;\n            }\n            return f;\n\n            function comp(x) {\n                name = x[0];\n                var code = \"{ \";\n                if (Array.isArray(name)) {\n                    arrayArgs += \"while (i < args.length) { \";\n                    resolve += \"while (i < args.length) { \";\n                    code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n                    code += \"while (i < args.length) { \";\n                    code += x.map(comp).join(\"\");\n                    code += \"} \";\n                    code += \"xargs = stack.pop(); \";\n                    resolve += \"} \";\n                    arrayArgs += \"} \";\n                } else if (name == \"+\") {\n                    arrayArgs += \"while (i < args.length) { \";\n                    resolve += \"while (i < args.length) { \";\n                    code += \"if (i >= args.length) return new CalcError('N/A'); \";\n                    code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n                    code += \"do { \";\n                    code += x.slice(1).map(comp).join(\"\");\n                    code += \"} while (i < args.length); \";\n                    code += \"xargs = stack.pop(); \";\n                    resolve += \"} \";\n                    arrayArgs += \"} \";\n                } else if (name == \"?\") {\n                    // standalone assertion without a new argument\n                    code += \"if (!(\" + cond(x[1]) + \")) return new CalcError(err); \";\n                } else {\n                    var type = x[1];\n                    if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                        var wantNulls = /!$/.test(type[0]);\n                        var n = type[2];\n                        force();\n                        code += \"try {\"\n                            + \"var $\" + name + \" = this.cellValues(args.slice(i\";\n                        if (n) {\n                            code += \", i + \" + n;\n                        }\n                        code += \")\" + (wantNulls ? \",true\" : \"\") + \").reduce(function(ret, $\"+name+\"){ \";\n                        if (type[0].charAt(0) != \"#\") {\n                            code += \"if ($\"+name+\" instanceof CalcError) throw $\"+name+\"; \";\n                        }\n                        code += \"if (\" + cond(type[1]) + \") ret.push($\"+name+\"); \";\n                        code += \"return ret; \";\n                        code += \"}.bind(this), []); \";\n                        if (n) {\n                            code += \"i += \" + n + \"; \";\n                        } else {\n                            code += \"i = args.length; \";\n                        }\n                        code += \"xargs.push($\"+name+\")\"\n                            + \"} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } \";\n                        resolve += \"toResolve.push(args.slice(i)); \";\n                    } else if (type == \"rest\") {\n                        code += \"xargs.push(args.slice(i)); i = args.length; \";\n                    } else {\n                        if ((canBeArrayArg = /^\\*/.test(name))) {\n                            hasArrayArgs = true;\n                            name = name.substr(1);\n                        }\n                        code += \"var $\" + name + \" = args[i++]; \";\n                        var allowError = false;\n                        if (/!$/.test(type)) {\n                            type = type.substr(0, type.length - 1);\n                            allowError = true;\n                        } else {\n                            code += \"if ($\"+name+\" instanceof CalcError) return $\"+name+\"; \";\n                        }\n                        code += typeCheck(type, allowError) + \"xargs.push($\"+name+\"); \";\n                    }\n                }\n                code += \"} \";\n                return code;\n            }\n\n            function force() {\n                if (forced) {\n                    return \"$\"+name+\"\";\n                }\n                haveForced = true;\n                forced = true;\n                resolve += \"toResolve.push(args[i++]); \";\n                return \"($\"+name+\" = this.force($\"+name+\"))\";\n            }\n\n            function forceNum(round) {\n                return \"(\"\n                    +     (round\n                           ? (\"(typeof \" + force() + \" == 'number' ? ($\"+name+\" = round($\"+name+\"), true) : false) || \")\n                           : (\"(typeof \" + force() + \" == 'number') || \"))\n                    +     \"(typeof $\"+name+\" == 'boolean' ? ($\"+name+\" = +$\" + name + \", true) : false) || \"\n                    +     \"(typeof $\"+name+\" == 'string' && !/^(?:=|true|false)/i.test($\"+name+\") ? (\"\n                    +       \"tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $\"+name+\"), \"\n                    +       \"/^date|number|percent$/.test(tmp.type) ? ($\"+name+\" = +tmp.value, true) : false\"\n                    +     \") : false)\"\n                    +  \")\";\n            }\n\n            function typeCheck(type, allowError) {\n                forced = false;\n                var ret = \"if (!(\" + cond(type) + \")) { \";\n                if (forced && !allowError) {\n                    ret += \" if ($\" + name + \" instanceof CalcError) return $\" + name + \"; \";\n                }\n                ret += \"return new CalcError(err); } \";\n                if (!forced) {\n                    resolve += \"i++; \";\n                }\n                if (canBeArrayArg) {\n                    arrayArgs += \"var $\" + name + \" = this._arrayArg(args[i]); \"\n                        + \"if ($\" + name + \") { \"\n                        + \"xargs.push($\" + name + \"); \"\n                        + \"width = Math.max(width, $\" + name + \".width); \"\n                        + \"height = Math.max(height, $\" + name + \".height); \"\n                        + \"arrays.push(true) } else { \"\n                        + \"xargs.push(args[i]); \"\n                        + \"arrays.push(false); } i++; \";\n                } else {\n                    arrayArgs += \"xargs.push(args[i++]); arrays.push(false); \";\n                }\n                return ret;\n            }\n\n            function cond(type) {\n                if (Array.isArray(type)) {\n                    if (type[0] == \"or\") {\n                        return \"(\" + type.slice(1).map(cond).join(\") || (\") + \")\";\n                    }\n                    if (type[0] == \"and\") {\n                        return \"(\" + type.slice(1).map(cond).join(\") && (\") + \")\";\n                    }\n                    if (type[0] == \"values\") {\n                        return \"(\" + type.slice(1).map(function(val){\n                            return force() + \" === \" + val;\n                        }).join(\") || (\") + \")\";\n                    }\n                    if (type[0] == \"null\") {\n                        return \"(\" + cond(\"null\") + \" ? (($\"+name+\" = \" + type[1] + \"), true) : false)\";\n                    }\n                    if (type[0] == \"between\" || type[0] == \"[between]\") {\n                        return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\"+name+\" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                    }\n                    if (type[0] == \"(between)\") {\n                        return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\"+name+\" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                    }\n                    if (type[0] == \"(between]\") {\n                        return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\"+name+\" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                    }\n                    if (type[0] == \"[between)\") {\n                        return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\"+name+\" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                    }\n                    if (type[0] == \"assert\") {\n                        var err = type[2] || \"N/A\";\n                        return \"((\" + type[1] + \") ? true : (err = \" + JSON.stringify(err) + \", false))\";\n                    }\n                    if (type[0] == \"not\") {\n                        return \"!(\" + cond(type[1]) + \")\";\n                    }\n                    throw new Error(\"Unknown array type condition: \" + type[0]);\n                }\n                if (type == \"number\" || type == \"datetime\") {\n                    return forceNum(true);\n                }\n                if (type == \"number!\") {\n                    return \"(typeof \" + force() + \" == 'number' ? ($\"+name+\" = round($\"+name+\"), true) : false)\";\n                }\n                if (type == \"integer\" || type == \"date\") {\n                    return \"(\" + forceNum() + \" && (($\"+name+\" |= 0), true))\";\n                }\n                if (type == \"divisor\") {\n                    return \"(\" + forceNum(true) + \" && ($\"+name+\" == 0 ? ((err = 'DIV/0'), false) : true))\";\n                }\n                if (type == \"number+\") {\n                    return \"(\" + forceNum(true) + \" && ($\"+name+\" >= 0 ? true : ((err = 'NUM'), false)))\";\n                }\n                if (type == \"integer+\") {\n                    return \"(\" + forceNum() + \" && (($\"+name+\" |= 0) >= 0 ? true : ((err = 'NUM'), false)))\";\n                }\n                if (type == \"number++\") {\n                    return \"(\" + forceNum(true) + \" && ($\"+name+\" > 0 ? true : ((err = 'NUM'), false)))\";\n                }\n                if (type == \"integer++\") {\n                    return \"(\" + forceNum() + \" && (($\"+name+\" |= 0) > 0 ? true : ((err = 'NUM'), false)))\";\n                }\n                if (type == \"string\") {\n                    return \"((typeof \" + force() + \" == 'string' || typeof $\"+name+\" == 'boolean' || typeof $\"+name+\" == 'number') ? ($\"+name+\" += '', true) : ($\"+name+\" === undefined ? (($\"+name+\" = ''), true) : false))\";\n                }\n                if (type == \"boolean\") {\n                    return \"(typeof \" + force() + \" == 'boolean')\";\n                }\n                if (type == \"logical\") {\n                    return \"(typeof \" + force() + \" == 'boolean' || (typeof $\"+name+\" == 'number' ? ($\"+name+\" = !!$\"+name+\", true) : false))\";\n                }\n                if (type == \"matrix\") {\n                    force();\n                    return \"((m = this.asMatrix($\"+name+\")) ? ($\"+name+\" = m) : false)\";\n                }\n                if (type == \"#matrix\") {\n                    return \"((m = this.asMatrix($\"+name+\")) ? ($\"+name+\" = m) : false)\";\n                }\n                if (type == \"ref\") {\n                    return \"($\"+name+\" instanceof kendo.spreadsheet.Ref)\";\n                }\n                if (type == \"area\") {\n                    return \"($\"+name+\" instanceof kendo.spreadsheet.CellRef || $\"+name+\" instanceof kendo.spreadsheet.RangeRef)\";\n                }\n                if (type == \"cell\") {\n                    return \"($\"+name+\" instanceof kendo.spreadsheet.CellRef)\";\n                }\n                if (type == \"null\") {\n                    return \"(\" + force() + \" == null)\";\n                }\n                if (type == \"anyvalue\") {\n                    return \"(\" + force() + \" != null && i <= args.length)\";\n                }\n                if (type == \"forced\") {\n                    return \"(\" + force() + \", i <= args.length)\";\n                }\n                if (type == \"anything\") {\n                    return \"(i <= args.length)\";\n                }\n                if (type == \"blank\") {\n                    return \"(\" + force() + \" == null || $\"+name+\" === '')\";\n                }\n                throw new Error(\"Can't check for type: \" + type);\n            }\n        }\n\n        function limitPrecision$1(num, digits) {\n            return num === parseInt(num, 10) ? num : +num.toPrecision(digits || 16);\n        }\n\n        function maybeRoundFloatErrors(num, digits) {\n            if (typeof num == \"number\") {\n                return limitPrecision$1(num, digits);\n            } else {\n                return num;\n            }\n        }\n\n        function withErrorHandling(obj, f, args) {\n            if (args instanceof CalcError$2) {\n                return args;\n            }\n            try {\n                return f.apply(obj, args);\n            } catch(ex) {\n                if (ex instanceof CalcError$2) {\n                    return ex;\n                } else {\n                    throw ex;\n                }\n            }\n        }\n\n        function makeSyncFunction(handler, resolve, check, arrayArgs) {\n            return function(callback, args) {\n                function doit() {\n                    if (arrayArgs) {\n                        var x = arrayArgs.call(this, args);\n                        args = x.args;\n                        if (x.width > 0 && x.height > 0) {\n                            var result = new Matrix$1(this);\n                            for (var row = 0; row < x.height; ++row) {\n                                for (var col = 0; col < x.width; ++col) {\n                                    var xargs = [];\n                                    for (var i = 0; i < args.length; ++i) {\n                                        if (x.arrays[i]) {\n                                            xargs[i] = args[i].getNA(row, col);\n                                        } else {\n                                            xargs[i] = args[i];\n                                        }\n                                    }\n                                    xargs = check.call(this, xargs);\n                                    result.set(row, col, withErrorHandling(this, handler, xargs));\n                                }\n                            }\n                            return callback(result);\n                        }\n                    }\n                    var xargs = check.call(this, args);\n                    callback(withErrorHandling(this, handler, xargs));\n                }\n                if (resolve) {\n                    resolve.call(this, args, doit);\n                } else {\n                    doit.call(this);\n                }\n            };\n        }\n\n        function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n            return function(callback, args) {\n                function doit() {\n                    if (arrayArgs) {\n                        var x = arrayArgs.call(this, args);\n                        args = x.args;\n                        if (x.width > 0 && x.height > 0) {\n                            var result = new Matrix$1(this);\n                            var count = x.width * x.height;\n                            var makeCallback = function(row, col) {\n                                return function(value) {\n                                    result.set(row, col, value);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                };\n                            };\n                            for (var row = 0; row < x.height && count > 0; ++row) {\n                                for (var col = 0; col < x.width && count > 0; ++col) {\n                                    var xargs = [];\n                                    for (var i = 0; i < args.length; ++i) {\n                                        if (x.arrays[i]) {\n                                            xargs[i] = args[i].getNA(row, col);\n                                        } else {\n                                            xargs[i] = args[i];\n                                        }\n                                    }\n                                    xargs = check.call(this, xargs);\n                                    if (xargs instanceof CalcError$2) {\n                                        result.set(row, col, xargs);\n                                        --count;\n                                        if (count === 0) {\n                                            return callback(result);\n                                        }\n                                    } else {\n                                        xargs.unshift(makeCallback(row, col));\n                                        handler.apply(this, xargs);\n                                    }\n                                }\n                            }\n                            return;\n                        }\n                    }\n                    var x = check.call(this, args);\n                    if (x instanceof CalcError$2) {\n                        callback(x);\n                    } else {\n                        x.unshift(callback);\n                        handler.apply(this, x);\n                    }\n                }\n                if (resolve) {\n                    resolve.call(this, args, doit);\n                } else {\n                    doit.call(this);\n                }\n            };\n        }\n\n        function loadDeferred() {\n            while(DEFER_INIT.length) {\n                DEFER_INIT.shift()();\n            }\n        }\n\n        function deferInit(cb) {\n            DEFER_INIT.push(cb);\n        }\n\n        function defineFunction$2(name, func) {\n            name = name.toLowerCase();\n            FUNCS[name] = func;\n            return {\n                args: function(args, log) {\n                    var code = compileArgumentChecks(name, args);\n                    // XXX: DEBUG\n                    if (log) {\n                        if (code.arrayArgs) {console.log(code.arrayArgs.toString());}\n                        if (code.resolve) {console.log(code.resolve.toString());}\n                        if (code.check) {console.log(code.check.toString());}\n                    }\n                    var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                    f.kendoSpreadsheetArgs = args;\n                    return this;\n                },\n                argsAsync: function(args, log) {\n                    var code = compileArgumentChecks(name, args);\n                    // XXX: DEBUG\n                    if (log) {\n                        if (code.arrayArgs) {console.log(code.arrayArgs.toString());}\n                        if (code.resolve) {console.log(code.resolve.toString());}\n                        if (code.check) {console.log(code.check.toString());}\n                    }\n                    var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                    f.kendoSpreadsheetArgs = args;\n                    return this;\n                }\n            };\n        }\n\n        /* -----[ date calculations ]----- */\n\n        // Julian days algorithms from http://www.hermetic.ch/cal_stud/jdn.htm#comp\n\n        function dateToJulianDays(y, m, d) {\n            m++;\n            return ((1461 * (y + 4800 + ((m - 14) / 12 | 0))) / 4 | 0) +\n                ((367 * (m - 2 - 12 * ((m - 14) / 12 | 0))) / 12 | 0) -\n                ((3 * (((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0))) / 4 | 0) +\n                d - 32075;\n        }\n\n        function julianDaysToDate(jd) {\n            var l, n, j, i, m, d, y;\n            l = jd + 68569;\n            n = (4 * l) / 146097 | 0;\n            l = l - ((146097 * n + 3) / 4 | 0);\n            i = (4000 * (l + 1) / 1461001) | 0;\n            l = l - ((1461 * i) / 4 | 0) + 31;\n            j = (80 * l) / 2447 | 0;\n            d = l - ((2447 * j) / 80 | 0);\n            l = j / 11 | 0;\n            m = j + 2 - (12 * l);\n            y = 100 * (n - 49) + i + l;\n            m--;\n            return {\n                year  : y,\n                month : m,\n                date  : d,\n                day   : (jd + 1) % 7,\n                ord   : ORDINAL_ADD_DAYS[isLeapYear$1(y)][m] + d\n            };\n        }\n\n        // This uses the Google Spreadsheet approach: treat 1899-12-31 as day 1, allowing to avoid\n        // implementing the \"Leap Year Bug\" yet still be Excel compatible for dates starting 1900-03-01.\n        var BASE_DATE = dateToJulianDays(1900, 0, -1);\n\n        var DAYS_IN_MONTH = [ 31, 28, 31,\n                              30, 31, 30,\n                              31, 31, 30,\n                              31, 30, 31 ];\n\n        var ORDINAL_ADD_DAYS = [\n            [ 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 ], // non-leap year\n            [ 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335 ]  // leap year\n        ];\n\n        function isLeapYear$1(yr) {\n            if (yr % 4) {\n                return 0;\n            }\n            if (yr % 100) {\n                return 1;\n            }\n            if (yr % 400) {\n                return 0;\n            }\n            return 1;\n        }\n\n        function daysInYear$2(yr) {\n            return isLeapYear$1(yr) ? 366 : 365;\n        }\n\n        function daysInMonth$2(yr, mo) {\n            return (isLeapYear$1(yr) && mo == 1) ? 29 : DAYS_IN_MONTH[mo];\n        }\n\n        function validDate(yr, mo, da) {\n            return mo >= 1 && mo <= 12 && da >= 1 && da <= daysInMonth$2(yr, mo - 1);\n        }\n\n        function unpackDate$2(serial) {\n            return julianDaysToDate((serial | 0) + BASE_DATE);\n        }\n\n        function packDate$2(year, month, date) {\n            return dateToJulianDays(year, month, date) - BASE_DATE;\n        }\n\n        var MS_IN_MIN = 60 * 1000;\n        var MS_IN_HOUR = 60 * MS_IN_MIN;\n        var MS_IN_DAY = 24 * MS_IN_HOUR;\n\n        function unpackTime(serial) {\n            var frac = serial - (serial|0);\n            if (frac < 0) {\n                frac++;\n            }\n            var ms = Math.round(MS_IN_DAY * frac);\n            var hours = Math.floor(ms / MS_IN_HOUR);\n            ms -= hours * MS_IN_HOUR;\n            var minutes = Math.floor(ms / MS_IN_MIN);\n            ms -= minutes * MS_IN_MIN;\n            var seconds = Math.floor(ms / 1000);\n            ms -= seconds * 1000;\n            return {\n                hours: hours,\n                minutes: minutes,\n                seconds: seconds,\n                milliseconds: ms\n            };\n        }\n\n        function serialToDate(serial) {\n            var d = unpackDate$2(serial), t = unpackTime(serial);\n            return new Date(d.year, d.month, d.date,\n                            t.hours, t.minutes, t.seconds, t.milliseconds);\n        }\n\n        function packTime(hh, mm, ss, ms) {\n            return (hh+(mm+(ss+ms/1000)/60)/60)/24;\n        }\n\n        function dateToSerial(date) {\n            var time = packTime(date.getHours(),\n                                date.getMinutes(),\n                                date.getSeconds(),\n                                date.getMilliseconds());\n            date = packDate$2(date.getFullYear(),\n                            date.getMonth(),\n                            date.getDate());\n            if (date < 0) {\n                return date - 1 + time;\n            } else {\n                return date + time;\n            }\n        }\n\n        function parseDate(str, format) {\n            if (format) {\n                format = kendo.spreadsheet.formatting.makeDateFormat(format);\n            }\n            return kendo.parseExactDate(str, format)\n                || kendo.parseExactDate(str)\n                || kendo.parseExactDate(str, [\n                    \"MMMM dd yyyy\",\n                    \"MMMM dd yy\",\n                    \"MMM dd yyyy\",\n                    \"MMM dd yy\",\n                    \"dd MMMM yyyy\",\n                    \"dd MMMM yy\",\n                    \"dd MMM yyyy\",\n                    \"dd MMM yy\",\n                    \"MMMM dd, yyyy\",\n                    \"MMMM dd, yy\",\n                    \"MMM dd, yyyy\",\n                    \"MMM dd, yy\",\n                    \"MMMM dd\",\n                    \"MMM dd\",\n                    \"MMMM yyyy\",\n                    \"MMM yyyy\",\n                    \"dd MMMM\",\n                    \"dd MMM\"\n                ]);\n        }\n\n        /* -----[ exports ]----- */\n\n        exports$3.CalcError = CalcError$2;\n        exports$3.Formula = Formula$1;\n        exports$3.Matrix = Matrix$1;\n\n        exports$3.packDate = packDate$2;\n        exports$3.unpackDate = unpackDate$2;\n        exports$3.packTime = packTime;\n        exports$3.unpackTime = unpackTime;\n        exports$3.serialToDate = serialToDate;\n        exports$3.dateToSerial = dateToSerial;\n        exports$3.daysInMonth = daysInMonth$2;\n        exports$3.validDate = validDate;\n        exports$3.isLeapYear = isLeapYear$1;\n        exports$3.daysInYear = daysInYear$2;\n        exports$3.parseDate = parseDate;\n        exports$3.limitPrecision = limitPrecision$1;\n\n        spreadsheet$7.dateToNumber = dateToSerial;\n        spreadsheet$7.numberToDate = serialToDate;\n        spreadsheet$7.defineFunction = defineFunction$2;\n        spreadsheet$7.loadDeferred = loadDeferred;\n        spreadsheet$7.deferInit = deferInit;\n        spreadsheet$7.CalcError = CalcError$2;\n\n        exports$3.defineFunction = defineFunction$2;\n        exports$3.loadDeferred = loadDeferred;\n        exports$3.deferInit = deferInit;\n        exports$3.defineAlias = function(alias, name) {\n            var orig = FUNCS[name];\n            if (!orig) {\n                throw new Error(\"Function \" + name + \" is not yet defined\");\n            }\n            if (!orig.kendoSpreadsheetAliases) {\n                orig.kendoSpreadsheetAliases = [ name ];\n            }\n            orig.kendoSpreadsheetAliases.push(alias);\n            FUNCS[alias] = orig;\n        };\n        exports$3.FUNCS = FUNCS;\n\n        /* -----[ Excel operators ]----- */\n\n        var NUMBER_OR_ZERO = [ \"or\", \"number\", [ \"null\", 0 ] ];\n\n        var ARGS_NUMERIC = [\n            [ \"*a\", NUMBER_OR_ZERO ],\n            [ \"*b\", NUMBER_OR_ZERO ]\n        ];\n\n        var ARGS_ANYVALUE = [\n            [ \"*a\", \"forced\" ],\n            [ \"*b\", \"forced\" ]\n        ];\n\n        deferInit(() => {\n            defineFunction$2(\"binary+\", function(a, b){\n                return a + b;\n            }).args(ARGS_NUMERIC);\n\n            defineFunction$2(\"binary-\", function(a, b){\n                return a - b;\n            }).args(ARGS_NUMERIC);\n\n            defineFunction$2(\"binary*\", function(a, b){\n                return a * b;\n            }).args(ARGS_NUMERIC);\n\n            defineFunction$2(\"binary/\", function(a, b){\n                return a / b;\n            }).args([\n                [ \"*a\", NUMBER_OR_ZERO ],\n                [ \"*b\", \"divisor\" ]\n            ]);\n\n            defineFunction$2(\"binary^\", function(a, b){\n                return Math.pow(a, b);\n            }).args(ARGS_NUMERIC);\n\n            defineFunction$2(\"binary&\", function(a, b){\n                if (a == null) { a = \"\"; }\n                if (b == null) { b = \"\"; }\n                return \"\" + a + b;\n            }).args([\n                [ \"*a\", [ \"or\", \"number\", \"string\", \"boolean\", \"null\" ] ],\n                [ \"*b\", [ \"or\", \"number\", \"string\", \"boolean\", \"null\" ] ]\n            ]);\n        });\n\n        function equals(a, b){\n            a = typeof(a) === \"string\" ? a.toLowerCase() : a;\n            b = typeof(b) === \"string\" ? b.toLowerCase() : b;\n\n            // special cases\n            if (a === false && b == null) { return true; }\n            if (b === false && a == null) { return true; }\n            if (a === 0     && b == null) { return true; }\n            if (b === 0     && a == null) { return true; }\n            if (a === \"\"    && b == null) { return true; }\n            if (b === \"\"    && a == null) { return true; }\n\n            return a === b;\n        }\n\n        deferInit(() => {\n            defineFunction$2(\"binary=\", equals).args(ARGS_ANYVALUE);\n\n            defineFunction$2(\"binary<>\", function(a, b){\n                return !equals(a, b);\n            }).args(ARGS_ANYVALUE);\n\n            defineFunction$2(\"binary<\", binaryCompare(function(a, b){\n                return a < b;\n            })).args(ARGS_ANYVALUE);\n\n            defineFunction$2(\"binary<=\", binaryCompare(function(a, b){\n                return a <= b;\n            })).args(ARGS_ANYVALUE);\n\n            defineFunction$2(\"binary>\", binaryCompare(function(a, b){\n                return a > b;\n            })).args(ARGS_ANYVALUE);\n\n            defineFunction$2(\"binary>=\", binaryCompare(function(a, b){\n                return a >= b;\n            })).args(ARGS_ANYVALUE);\n\n            defineFunction$2(\"unary+\", function(a){\n                return a;\n            }).args([\n                [ \"*a\", NUMBER_OR_ZERO ]\n            ]);\n\n            defineFunction$2(\"unary-\", function(a){\n                return -a;\n            }).args([\n                [ \"*a\", NUMBER_OR_ZERO ]\n            ]);\n\n            defineFunction$2(\"unary%\", function(a){\n                return a / 100;\n            }).args([\n                [ \"*a\", NUMBER_OR_ZERO ]\n            ]);\n\n            // range operator\n            defineFunction$2(\"binary:\", function(a, b){\n                return new RangeRef$3(a, b)\n                    .setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n            }).args([\n                [ \"a\", \"cell\" ],\n                [ \"b\", \"cell\" ]\n            ]);\n\n            // union operator\n            defineFunction$2(\"binary,\", function(a, b){\n                return new UnionRef$2([ a, b ]);\n            }).args([\n                [ \"a\", \"ref\" ],\n                [ \"b\", \"ref\" ]\n            ]);\n\n            // intersection operator\n            defineFunction$2(\"binary \", function(a, b){\n                return a.intersect(b);\n            }).args([\n                [ \"a\", \"ref\" ],\n                [ \"b\", \"ref\" ]\n            ]);\n\n            /* -----[ conditionals ]----- */\n\n            defineFunction$2(\"not\", function(a){\n                return !this.bool(a);\n            }).args([\n                [ \"*a\", [ \"or\", \"anyvalue\", [ \"null\", 0 ] ] ]\n            ]);\n\n            /* -----[ the IS* functions ]----- */\n\n            defineFunction$2(\"isblank\", function(val){\n                if (val instanceof CellRef$4) {\n                    val = this.getRefData(val);\n                    return val == null;\n                }\n                return false;\n            }).args([\n                [ \"*value\", \"anything!\" ]\n            ]);\n\n            defineFunction$2(\"iserror\", function(val){\n                return val instanceof CalcError$2;\n            }).args([\n                [ \"*value\", \"forced!\" ]\n            ]);\n\n            defineFunction$2(\"iserr\", function(val){\n                return val instanceof CalcError$2 && val.code != \"N/A\";\n            }).args([\n                [ \"*value\", \"forced!\" ]\n            ]);\n\n            defineFunction$2(\"isna\", function(val){\n                return val instanceof CalcError$2 && val.code == \"N/A\";\n            }).args([\n                [ \"*value\", \"forced!\" ]\n            ]);\n\n            defineFunction$2(\"islogical\", function(val){\n                return typeof val == \"boolean\";\n            }).args([\n                [ \"*value\", \"forced!\" ]\n            ]);\n\n            defineFunction$2(\"isnontext\", function(val){\n                return typeof val != \"string\";\n            }).args([\n                [ \"*value\", \"forced!\" ]\n            ]);\n\n            defineFunction$2(\"istext\", function(val){\n                return typeof val == \"string\";\n            }).args([\n                [ \"*value\", \"forced!\" ]\n            ]);\n\n            defineFunction$2(\"isnumber\", function(val){\n                return typeof val == \"number\";\n            }).args([\n                [ \"*value\", \"forced!\" ]\n            ]);\n\n            defineFunction$2(\"isref\", function(val){\n                // apparently should return true only for cell and range\n                return val instanceof CellRef$4 || val instanceof RangeRef$3;\n            }).args([\n                [ \"*value\", \"anything!\" ]\n            ]);\n        });\n\n        /* -----[ resolve NameRef-s ]----- */\n\n        FUNCS[\",getname\"] = function(callback, args) {\n            this.fetchName(args[0], callback);\n        };\n\n        /// utils\n\n        function binaryCompare(func) {\n            return function(left, right){\n                if (typeof left == \"string\" && typeof right != \"string\") {\n                    right = right == null ? \"\" : right + \"\";\n                }\n                if (typeof left != \"string\" && typeof right == \"string\") {\n                    left = left == null ? \"\" : left + \"\";\n                }\n                if (typeof left == \"number\" && right == null) {\n                    right = 0;\n                }\n                if (typeof right == \"number\" && left == null) {\n                    left = 0;\n                }\n                if (typeof left == \"string\" && typeof right == \"string\") {\n                    // string comparison is case insensitive\n                    left = left.toLowerCase();\n                    right = right.toLowerCase();\n                }\n                if (typeof right == typeof left) {\n                    // for issue https://github.com/telerik/kendo-ui-core/issues/6879, limitPrecision\n                    // digits got bumped to 16, but it's too much for the case 9.302 - 0.002 (issue\n                    // https://github.com/telerik/kendo-ui-core/issues/7170).\n                    left = maybeRoundFloatErrors(left, 15);\n                    right = maybeRoundFloatErrors(right, 15);\n                    return func(left, right);\n                } else {\n                    return new CalcError$2(\"VALUE\");\n                }\n            };\n        }\n\n    \"use strict\";\n\n        var $$2 = kendo.jQuery;\n\n        var spreadsheet$6 = kendo.spreadsheet;\n\n        var exports$2 = {};\n        spreadsheet$6.validation = exports$2;\n        var calc$3 = spreadsheet$6.calc;\n        var Class = kendo.Class;\n        var TRANSPOSE_FORMAT = \"_matrix({0})\";\n        var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n\n        calc$3.runtime.deferInit(() => {\n            calc$3.runtime.defineFunction(\"_matrix\", function(m){\n                if (typeof m == \"string\") {\n                    // for constant list validation, Excel includes a string\n                    // with comma-separated values  make a Matrix from it.\n                    m = this.asMatrix([ m.split(/\\s*,\\s*/) ]);\n                }\n                return m;\n            }).args([\n                [ \"m\", [ \"or\", \"matrix\", \"string\" ] ]\n            ]);\n        });\n\n        function compileValidation(sheet, row, col, validation) {\n            var validationHandler;\n            var comparer;\n            var parsedFromDate;\n            var parsedToDate;\n\n            if (typeof validation === \"string\") {\n                validation = JSON.parse(validation);\n            }\n\n            if (validation.from) {\n                if (validation.dataType === \"list\" && !validation.fromIsListValue) {\n                    // We need to convert the {...} validation.from value to a string, so that it would work when exported to XLSX\n                    if(validation.from.indexOf(\"{\") > -1) {\n                        validation.from = validation.from.replace(/\\\"/g,\"\").replace(\"{\",\"\\\"\").replace(\"}\", \"\\\"\");\n                    }\n                    validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n                    validation.fromIsListValue = true;\n                }\n\n                if (validation.dataType === \"date\") {\n                    parsedFromDate = calc$3.runtime.parseDate(validation.from);\n                    if (parsedFromDate) {\n                        validation.from = kendo.format(DATE_FORMAT, validation.from);\n                        validation.fromIsDateValue = true;\n                    }\n                }\n\n                validation.from = calc$3.compile(calc$3.parseFormula(sheet, row, col, validation.from));\n            }\n\n            if (validation.to) {\n                if (validation.dataType === \"date\") {\n                    parsedToDate = calc$3.runtime.parseDate(validation.to);\n                    if (parsedToDate) {\n                        validation.to = kendo.format(DATE_FORMAT, validation.to);\n                        validation.toIsDateValue = true;\n                    }\n                }\n\n                validation.to = calc$3.compile(calc$3.parseFormula(sheet, row, col, validation.to));\n            }\n\n            if (validation.dataType == \"custom\") {\n                comparer = exports$2.validationComparers.custom;\n            } else if (validation.dataType == \"list\") {\n                comparer = exports$2.validationComparers.list;\n            } else {\n                comparer = exports$2.validationComparers[validation.comparerType];\n            }\n\n            if (!comparer) {\n                throw kendo.format(\"'{0}' comparer is not implemented.\", validation.comparerType);\n            }\n\n            validationHandler = function (valueToCompare) { //add 'valueFormat' arg when add isDate comparer\n                var toValue = this.to && (this.to_value || this.to_value === 0) ? this.to_value : undefined;\n\n                if (valueToCompare === null || valueToCompare === \"\") {\n                    if (this.allowNulls) {\n                        this.value = true;\n                    } else {\n                        this.value = false;\n                    }\n                } else if (this.dataType == \"custom\") {\n                    this.value = comparer(valueToCompare, this.from_value,  toValue);\n                } else if (this.dataType == \"list\") {\n                    var data = this._getListData();\n\n                    this.value = comparer(valueToCompare, data, toValue);\n                } else {\n                    //TODO: TYPE CHECK IS REQUIRED ONLY FOR DATE TYPE WHEN SPECIAL COMPARER (ISDATE) IS USED\n                    this.value = comparer(valueToCompare, this.from_value,  toValue);\n                }\n\n                return this.value;\n            };\n\n            return new kendo.spreadsheet.validation.Validation($$2.extend(validation, {\n                handler: validationHandler,\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        }\n\n        var Validation = Class.extend({\n            init: function Validation(options){\n                this.handler = options.handler;\n                this.from = options.from;\n                this.to = options.to;\n                this.dataType = options.dataType; //date, time etc\n                this.comparerType =  options.comparerType; //greaterThan, EqaulTo etc\n                this.type = options.type ? options.type : \"warning\"; //info, warning, reject\n                this.allowNulls = options.allowNulls ? true : false;\n                this.fromIsDateValue = options.fromIsDateValue ? true : false;\n                this.toIsDateValue = options.toIsDateValue ? true : false;\n                this.showButton = options.showButton;\n                this.fromIsListValue = options.fromIsListValue ? true : false;\n\n                //TODO: address to be range / cell ref, and adjust it based on it\n                this.sheet = options.sheet;\n                this.row = options.row;\n                this.col = options.col;\n\n                if (options.tooltipMessageTemplate) {\n                    this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n                }\n\n                if (options.tooltipTitleTemplate) {\n                    this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n                }\n\n                if (options.messageTemplate) {\n                    this.messageTemplate = options.messageTemplate;\n                }\n\n                if (options.titleTemplate) {\n                    this.titleTemplate = options.titleTemplate;\n                }\n            },\n\n            _formatMessages: function(format) {\n                var from = this.from ? this.from_value : \"\";\n                var to = this.to ? this.to_value : \"\";\n\n                var fromFormula = this.from ? this.from.toString() : \"\";\n                var toFormula = this.to ? this.to.toString() : \"\";\n                var dataType = this.dataType;\n                var type = this.type;\n                var comparerType = this.comparerType;\n\n                return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n            },\n\n            _setMessages: function() {\n                this.title = \"\";\n                this.message = \"\";\n\n                if (this.tooltipTitleTemplate) {\n                    this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n                }\n\n                if (this.tooltipMessageTemplate) {\n                    this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n                }\n\n                if (this.titleTemplate) {\n                    this.title = this._formatMessages(this.titleTemplate);\n                }\n\n                if (this.messageTemplate) {\n                    this.message = this._formatMessages(this.messageTemplate);\n                }\n            },\n\n            _getListData: function() {\n                if (!this.from_value || !this.from_value.data) {\n                    return [];\n                }\n\n                var cube = this.from_value.data;\n                var i;\n                var y;\n                var data = [];\n\n                for (i = 0; i < cube.length; i++ ) {\n                    var array = cube[i];\n\n                    if (array) {\n                        for (y = 0; y < array.length; y++ ) {\n                            data.push(array[y]);\n                        }\n                    }\n                }\n\n                return data;\n            },\n\n            clone: function(sheet, row, col) {\n                var options = this._getOptions();\n\n                if (options.from) {\n                    options.from = options.from.clone(sheet, row, col);\n                }\n\n                if (options.to) {\n                    options.to = options.to.clone(sheet, row, col);\n                }\n\n                return new Validation($$2.extend(options,\n                    { handler: this.handler },\n                    { sheet: sheet, row: row, col: col }\n                ));\n            },\n\n            deepClone: function() {\n                var v = new Validation(this);\n                v.from = v.from.deepClone();\n                if (v.to) {\n                    v.to = v.to.deepClone();\n                }\n                return v;\n            },\n\n            exec: function(ss, compareValue, compareFormat, callback) {\n                var self = this;\n\n                function getValue(val) {\n                    if (val instanceof kendo.spreadsheet.Ref) {\n                        val = ss.getData(val);\n                        if (Array.isArray(val)) {\n                            val = val[0];\n                        }\n                    }\n                    return val;\n                }\n\n                var calculateFromCallBack = function(val) {\n                    self.from_value = getValue(val);\n                    self.value = self.handler.call(self, compareValue, compareFormat);\n                    self._setMessages();\n                    if (callback) {\n                        callback(self.value);\n                    }\n                };\n\n                if (self.to) {\n                    self.to.exec(ss, function(val) {\n                        self.to_value = getValue(val);\n                        self.from.exec(ss, calculateFromCallBack);\n                    });\n                } else {\n                    self.from.exec(ss, calculateFromCallBack);\n                }\n            },\n\n            reset: function() {\n                if (this.from) {\n                    this.from.reset();\n                }\n                if (this.to) {\n                    this.to.reset();\n                }\n                delete this.value;\n            },\n\n            adjust: function(affectedSheet, operation, start, delta) {\n                var prevFrom, prevTo, modified;\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                if (this.from) {\n                    prevFrom = this.from.adjust(affectedSheet, operation, start, delta);\n                }\n                if (this.to) {\n                    prevTo = this.to.adjust(affectedSheet, operation, start, delta);\n                }\n                if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                    switch (operation) {\n                      case \"row\":\n                        if (formulaRow >= start) {\n                            modified = true;\n                            this.row += delta;\n                        }\n                        break;\n                      case \"col\":\n                        if (formulaCol >= start) {\n                            modified = true;\n                            this.col += delta;\n                        }\n                        break;\n                    }\n                }\n                if (modified || prevFrom || prevTo) {\n                    var v = new Validation(this);\n                    v.from = prevFrom;\n                    v.to = prevTo;\n                    v.row = formulaRow;\n                    v.col = formulaCol;\n                    return v;\n                }\n            },\n\n            toJSON: function() {\n                var options = this._getOptions();\n\n                if (options.from) {\n                    options.from = options.from.toString();\n\n                    if (options.dataType === \"list\") {\n                        options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, \"$1\");\n                        delete options.fromIsListValue;\n                    }\n\n                    if (options.dataType === \"date\") {\n                        if (this.fromIsDateValue) {\n                            options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                            delete options.fromIsDateValue;\n                        }\n                    }\n                }\n\n                if (options.to) {\n                    options.to = options.to.toString();\n\n                    if (options.dataType === \"date\") {\n                        if (this.toIsDateValue) {\n                            options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                            delete options.toIsDateValue;\n                        }\n                    }\n                }\n\n                return options;\n            },\n\n            _getOptions: function () {\n                return {\n                    from: this.from,\n                    to: this.to,\n                    dataType: this.dataType,\n                    type: this.type,\n                    comparerType: this.comparerType,\n                    row: this.row,\n                    col: this.col,\n                    sheet: this.sheet,\n                    allowNulls: this.allowNulls,\n                    fromIsListValue: this.fromIsListValue,\n                    fromIsDateValue: this.fromIsDateValue,\n                    toIsDateValue: this.toIsDateValue,\n                    tooltipMessageTemplate: this.tooltipMessageTemplate,\n                    tooltipTitleTemplate: this.tooltipTitleTemplate,\n                    //TODO: export generated messages instead?\n                    messageTemplate: this.messageTemplate,\n                    titleTemplate: this.titleTemplate,\n                    showButton: this.showButton\n                };\n            }\n        });\n        exports$2.compile = compileValidation;\n        exports$2.validationComparers = {\n            greaterThan: function (valueToCompare, from) {\n                return valueToCompare > from;\n            },\n\n            lessThan: function (valueToCompare, from) {\n                return valueToCompare < from;\n            },\n\n            between: function (valueToCompare, from, to) {\n                return valueToCompare >= from && valueToCompare <= to;\n            },\n\n            equalTo: function (valueToCompare, from) {\n                return valueToCompare == from;\n            },\n\n            notEqualTo: function (valueToCompare, from) {\n                return valueToCompare != from;\n            },\n\n            greaterThanOrEqualTo: function (valueToCompare, from) {\n                return valueToCompare >= from;\n            },\n\n            lessThanOrEqualTo: function (valueToCompare, from) {\n                return valueToCompare <= from;\n            },\n\n            notBetween: function (valueToCompare, from, to) {\n                return valueToCompare < from || valueToCompare > to;\n            },\n\n            custom: function (valueToCompare, from) {\n                return from;\n            },\n\n            list: function (valueToCompare, data) {\n                return data.indexOf(valueToCompare) > -1;\n            }\n        };\n\n        exports$2.Validation = Validation;\n\n    (function(kendo) {\n\n\n\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n\n        // This is a dynamic variable (see Greenspun's 10th rule).  It's\n        // bound to an array via sheet._saveModifiedFormulas (which see)\n        // while the callback runs.  The goal is to enable external code\n        // to get a list of formulas or validations that have been\n        // adjusted as an effect of an insert/delete row/column operation,\n        // to be able to undo it.\n        //\n        // The reason why simply saving the state via sheet.getState() or\n        // range.getState() won't suffice is that an insert or delete\n        // operation can have far-reaching effects, like adjusting\n        // formulas from another sheet.\n        var MODIFIED_FORMULAS;\n\n        var Selection = kendo.Class.extend({\n            init: function(sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n\n            currentSelectionRange: function() {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n\n            currentOriginalNavigationRange: function() {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n\n            currentNavigationRange: function() {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n\n            nextNavigationRange: function() {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n\n                return this.currentNavigationRange();\n            },\n\n            previousNavigationRange: function() {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n\n                return this.currentNavigationRange();\n            },\n\n            activeCell: function(ref) {\n                if (ref) {\n                    this.originalActiveCell = ref.first();\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({ activeCell: true, selection: true });\n                }\n\n                return this._activeCell;\n            },\n\n            select: function(ref, expanded, changeActiveCell, view) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n\n                    this._sheet.triggerSelect(new Range(ref, this._sheet));\n\n                    this.originalSelection = ref;\n\n                    this.selection = expanded;\n\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            // when selecting part of a merged cell, i.e. A1:B2 is merged and select(B2)\n                            // is requested, mark A1 as the actually active cell.\n                            // https://github.com/telerik/kendo/issues/7698\n                            this._sheet.forEachMergedCell(ref, function(merged){\n                                ref = merged.topLeft;\n                            });\n                            this.activeCell(ref);\n                        } else {\n                            ref = this.selection.lastRange();\n                            if (view && view._sheet === this._sheet && view.panes[0]) {\n                                // we should intersect this ref with the range that's currently on\n                                // screen, so that the view doesn't scroll (that is, keep the activeCell\n                                // visible) - https://github.com/telerik/kendo-ui-core/issues/5182 \n                                // XXX: fiddling with View internals here is probably bad practice, but\n                                // this whole thing is a mess already, so it can be forgiven. :-/\n                                var panes = view.panes;\n                                var i, pane, rows, cols, visible, newRef;\n\n                                for (i = 0; i < panes.length; i++) {\n                                    pane = panes[i];\n                                    if (!pane._currentView) {\n                                        continue;\n                                    }\n                                    rows = pane._currentView.rows.values;\n                                    cols = pane._currentView.columns.values;\n\n                                    visible = new RangeRef(\n                                        new CellRef(rows.start, cols.start),\n                                        new CellRef(rows.end, cols.end)\n                                    );\n\n                                    newRef = ref.intersect(visible);\n\n                                    if (newRef !== kendo.spreadsheet.NULLREF) {\n                                        break;\n                                    }\n                                }\n\n                                if (newRef && newRef !== kendo.spreadsheet.NULLREF) {\n                                    ref = newRef;\n                                }\n                            }\n                            this.activeCell(ref.first());\n                        }\n\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n\n                return this.selection;\n            },\n\n            singleCellSelection: function() {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n\n        var Sheet = kendo.Observable.extend({\n            init: function() {\n                kendo.Observable.prototype.init.call(this);\n                this._reinit.apply(this, arguments);\n            },\n\n\n            events: [\n                \"changing\",\n                \"commandRequest\",\n                \"afterInsertRow\",\n                \"afterDeleteRow\",\n                \"insertRow\",\n                \"insertColumn\",\n                \"deleteRow\",\n                \"deleteColumn\",\n                \"hideRow\",\n                \"hideColumn\",\n                \"unhideRow\",\n                \"unhideColumn\",\n                \"select\",\n                \"dataBinding\",\n                \"dataBound\",\n                \"progress\"\n            ],\n\n            _reinit: function(rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n                defaultCellStyle = defaultCellStyle || {};\n\n                this._defaultCellStyle = {\n                    background: defaultCellStyle.background,\n                    color: defaultCellStyle.color,\n                    fontFamily: defaultCellStyle.fontFamily,\n                    fontSize: defaultCellStyle.fontSize,\n                    italic: defaultCellStyle.italic,\n                    bold: defaultCellStyle.bold,\n                    underline: defaultCellStyle.underline,\n                    wrap: defaultCellStyle.wrap,\n                    verticalAlign: defaultCellStyle.verticalAlign,\n                    textAlign: defaultCellStyle.textAlign\n                };\n\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._filteredRows = new kendo.spreadsheet.RangeList(0, rowCount - 1, false);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._showGridLines = true;\n                this._gridLinesColor = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n\n                this._viewSelection = new Selection(this);\n\n                this._editSelection = new Selection(this);\n\n                this._formulaSelections = [];\n                this._drawings = [];\n            },\n\n            resize: function(newRows, newCols) {\n                newRows = Math.max(newRows, 1);\n                newCols = Math.max(newCols, 1);\n                var oldRows = this._rows._count;\n                var oldCols = this._columns._count;\n                if (newRows < oldRows) {\n                    this.range(newRows, 0, oldRows - newRows, oldCols).clear();\n                }\n                if (newCols < oldCols) {\n                    this.range(0, newCols, oldRows, oldCols - newCols).clear();\n                }\n                this._rows._resize(newRows);\n                this._columns._resize(newCols);\n                this._grid._resize(newRows, newCols);\n                this._properties._resize(newRows, newCols);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                if (newRows > oldRows) {\n                    this.range(oldRows, 0, newRows - oldRows, newCols).clear();\n                    this._filteredRows.value(oldRows, newRows - 1, false);\n                }\n                if (newCols > oldCols) {\n                    this.range(0, oldCols, newRows, newCols - oldCols).clear();\n                }\n                this.triggerChange({ layout: true });\n            },\n\n            _resizeAddRow: function(count) {\n                this.resize(this._rows._count + (count || 1), this._columns._count);\n            },\n\n            _resizeAddColumn: function(count) {\n                this.resize(this._rows._count, this._columns._count + (count || 1));\n            },\n\n            _resizeDeleteRow: function(count) {\n                this._resizeAddRow(-(count || 1));\n            },\n\n            _resizeDeleteColumn: function(count) {\n                this._resizeAddColumn(-(count || 1));\n            },\n\n            _resizeForJSON: function(rows) {\n                var rowCount = rows.length, colCount = 0;\n                for (var ri = 0; ri < rows.length; ++ri) {\n                    var row = rows[ri];\n                    if (row.index != null) {\n                        rowCount = Math.max(rowCount, row.index + 1);\n                    }\n                    if (row.cells) {\n                        colCount = Math.max(colCount, row.cells.length);\n                        for (var ci = 0; ci < row.cells.length; ++ci) {\n                            var cell = row.cells[ci];\n                            if (cell.index != null) {\n                                colCount = Math.max(colCount, cell.index + 1);\n                            }\n                        }\n                    }\n                }\n                this.resize(Math.max(rowCount, this._rows._count),\n                            Math.max(colCount, this._columns._count));\n            },\n\n            _selectionState: function() {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n\n            navigator: function() {\n                if(!this._navigator) {\n                     this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n\n            axisManager: function() {\n                if(!this._axisManager) {\n                     this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n\n                return this._axisManager;\n            },\n\n            _name: function(value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n\n                this._sheetName = value;\n\n                return this;\n            },\n\n            name: function() {\n                return this._name();\n            },\n\n            _property: function(accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n\n                    return this.triggerChange(reason);\n                }\n            },\n\n            _field: function(name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n\n                    return this.triggerChange(reason);\n                }\n            },\n\n            suspendChanges: function(value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n\n                this._suspendChanges = value;\n\n                return this;\n            },\n\n            triggerChange: function(reason) {\n                if (!this._suspendChanges) {\n                    this.trigger(\"change\", reason);\n                } else if (reason && reason.isValue) {\n                    this._valueChanged = true;\n                }\n                return this;\n            },\n\n            triggerSelect: function(range) {\n                this.trigger(\"select\", { range: range });\n            },\n\n            setDataSource: function(dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n\n                this.dataSource = this.dataSourceBinder.dataSource;\n            },\n\n            hideColumn: function(columnIndex) {\n                if (this.trigger(\"hideColumn\", { index: columnIndex })) {\n                    return;\n                }\n\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n\n            unhideColumn: function(columnIndex) {\n                if (this.trigger(\"unhideColumn\", { index: columnIndex })) {\n                    return;\n                }\n\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n\n            isHiddenColumn: function(columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n\n            _copyRange: function(sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n\n            _saveModifiedFormulas: function(array, callback) {\n                var save = MODIFIED_FORMULAS;\n                MODIFIED_FORMULAS = array;\n                var ret = callback();\n                MODIFIED_FORMULAS = save;\n                return ret;\n            },\n\n            _restoreModifiedFormulas: function(array) {\n                var wb = this._workbook;\n                array.forEach(function(f){\n                    var sheet = wb.sheetByName(f.sheet), index;\n                    if (f instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                        index = sheet._grid.cellRefIndex(f); // f has row, col\n                        sheet._properties.set(\"formula\", index, index, f);\n                    }\n                    if (f instanceof kendo.spreadsheet.validation.Validation) {\n                        index = sheet._grid.cellRefIndex(f); // f has row, col\n                        sheet._properties.set(\"validation\", index, index, f);\n                    }\n                });\n            },\n\n            _adjustReferences: function(operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function(a, ref){\n                    ref = ref.adjust(null, null, null, null, operation == \"row\", start, delta);\n                    if (ref instanceof RangeRef) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function(sheet){\n                        sheet._forFormulas(function(formula){\n                            var prev = formula.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                // if formula.adjust returns non-null,\n                                // that means the formula was indeed\n                                // modified and the returned value is a\n                                // copy of the previous Formula, which we\n                                // can use for undoing the operation.\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n\n                        sheet._forValidations(function(validation){\n                            var prev = validation.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == \"row\", start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == \"row\", start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n                // adjust column widths or row heights and hidden attribute\n                var axis = operation == \"col\" ? this._columns : this._rows;\n                axis.adjust(start, delta);\n\n                if (operation == \"row\") {\n                    if (delta < 0) {\n                        this._filteredRows.copy(start - delta, this._rows._count - 1, start);\n                    } else {\n                        this._filteredRows.copy(start, this._rows._count, start + delta);\n                        this._filteredRows.value(start, start + delta - 1, false);\n                    }\n                }\n\n                // adjust drawing anchor cells\n                this._drawings.forEach(function(drawing){\n                    if (drawing.topLeftCell) {\n                        drawing.topLeftCell = drawing.topLeftCell.adjust(null, null, null, null,\n                                                                         operation == \"row\", start, delta);\n                    }\n                });\n            },\n\n            _forFormulas: function(callback) {\n                var props = this._properties;\n                var formulas = props.get(\"formula\").values();\n                var n = formulas.length;\n                formulas.forEach(function(f, i){\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n\n            _forValidations: function(callback) {\n                var props = this._properties;\n                props.get(\"validation\").values().forEach(function(v){\n                    callback.call(this, v.value);\n                }, this);\n            },\n\n            insertRow: function(rowIndex, skipDataSourceInsert) {\n                if (this.trigger(\"insertRow\", { index: rowIndex })) {\n                    return;\n                }\n\n                this.batch(function() {\n                    this._resizeAddRow();\n\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n\n                    if (rowIndex + 1 == rowCount) {\n                        // we just inserted after the last one, no need to shift data\n                        return;\n                    }\n\n                    var frozenRows = this.frozenRows();\n\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n\n                    var mergedCells = this._mergedCells.slice();\n\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n\n                        var nextRef = new RangeRef(\n                            new CellRef(topLeft.row, topLeft.col),\n                            new CellRef(rowCount - 2, bottomRight.col)\n                        );\n\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n\n                        new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n                    }\n\n                    this._adjustReferences(\"row\", rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n\n                if (!skipDataSourceInsert) {\n                    this.trigger(\"afterInsertRow\", { index: rowIndex });\n                }\n\n                return this;\n            },\n\n            isEnabledRow: function(rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n\n            deleteRow: function(rowIndex, skipDataSourceDelete) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n\n                if (this.trigger(\"deleteRow\", { index: rowIndex })) {\n                    return;\n                }\n\n                this.batch(function() {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n\n                    var mergedCells = this._mergedCells.slice();\n\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                        new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n\n                        var nextRef = new RangeRef(\n                            new CellRef(topLeft.row + 1, topLeft.col),\n                            new CellRef(Infinity, bottomRight.col)\n                        );\n\n                        this._copyRange(nextRef, topLeft);\n\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n\n                    this._adjustReferences(\"row\", rowIndex, -1, mergedCells);\n\n                    this._resizeDeleteRow();\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n\n                if (!skipDataSourceDelete) {\n                    this.trigger(\"afterDeleteRow\", { index: rowIndex });\n                }\n\n                return this;\n            },\n\n            insertColumn: function(columnIndex) {\n                if (this.trigger(\"insertColumn\", { index: columnIndex })) {\n                    return;\n                }\n\n                this.batch(function() {\n                    this._resizeAddColumn();\n\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n\n                    if (columnIndex + 1 == columnCount) {\n                        // we just inserted after the last one, no need to shift data\n                        return;\n                    }\n\n                    var frozenColumns = this.frozenColumns();\n\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n\n                    var mergedCells = this._mergedCells.slice();\n\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                        new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                        if (ci == columnIndex) {\n                            break;\n                        }\n\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n\n                        var nextRef = new RangeRef(\n                            new CellRef(topLeft.row, topLeft.col - 1),\n                            new CellRef(bottomRight.row, bottomRight.col - 1)\n                        );\n\n                        this._copyRange(nextRef, topLeft);\n                    }\n\n                    this._adjustReferences(\"col\", columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n\n                return this;\n            },\n\n            isEnabledColumn: function(columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n\n            deleteColumn: function(columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n\n                if (this.trigger(\"deleteColumn\", { index: columnIndex })) {\n                    return;\n                }\n\n                this.batch(function() {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n\n                    var frozenColumns = this.frozenColumns();\n\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n\n                    var mergedCells = this._mergedCells.slice();\n\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                        new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n\n                        var nextRef = new RangeRef(\n                            new CellRef(topLeft.row, topLeft.col + 1),\n                            new CellRef(bottomRight.row, bottomRight.col + 1)\n                        );\n\n                        this._copyRange(nextRef, topLeft);\n                    }\n\n                    this._adjustReferences(\"col\", columnIndex, -1, mergedCells);\n\n                    this._resizeDeleteColumn();\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n\n                return this;\n            },\n\n            _filterRow: function(rowIndex) {\n                this._rows.hide(rowIndex);\n                this._filteredRows.value(rowIndex, rowIndex, true);\n                this.triggerChange({ layout: true });\n            },\n\n            hideRow: function(rowIndex) {\n                if (this.trigger(\"hideRow\", { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n\n            unhideRow: function(rowIndex) {\n                if (this.trigger(\"unhideRow\", { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n\n            isHiddenRow: function(rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n\n            isFilteredRow: function(rowIndex) {\n                return this._filteredRows.value(rowIndex);\n            },\n\n            columnWidth: function(columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n\n            rowHeight: function(rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n\n            frozenRows: function(value) {\n                return this._field(\"_frozenRows\", value, { layout: true });\n            },\n\n            frozenColumns: function(value) {\n                return this._field(\"_frozenColumns\", value, { layout: true });\n            },\n\n            showGridLines: function(value) {\n                return this._field(\"_showGridLines\", value, { layout: true });\n            },\n\n            gridLinesColor: function(value) {\n                return this._field(\"_gridLinesColor\", value, { layout: true });\n            },\n\n            _ref: function(row, column, numRows, numColumns) {\n                var ref = null;\n\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n\n                if (typeof row === \"string\") {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n\n                return ref;\n            },\n\n            range: function(row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n\n            _getMergedCells: function(range) {\n                var grid = this._grid;\n                var primary = {};\n                var secondary = {};\n                var hasMerged = false;\n\n                this.forEachMergedCell(range, function(ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function(cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primary[cellRef.print()] = ref;\n                            hasMerged = true;\n                        } else if (range.contains(cellRef)) {\n                            secondary[cellRef.print()] = topLeft;\n                            hasMerged = true;\n                        }\n                    });\n                });\n\n                return { primary: primary, secondary: secondary, hasMerged: hasMerged };\n            },\n\n            forEachMergedCell: function(ref, callback) {\n                var selectAll = false;\n\n                if (typeof callback === \"undefined\") {\n                    callback = ref;\n                    selectAll = true;\n                }\n\n                this._mergedCells.forEach(function(merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n\n            forEachFilterHeader: function(ref, callback) {\n                var selectAll = false;\n\n                if (typeof callback === \"undefined\") {\n                    callback = ref;\n                    selectAll = true;\n                }\n\n                if (this._filter) {\n                    var refs = [];\n\n                    // get refs of all columns\n                    this._filter.ref.forEachColumn(function(columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n\n                    // filter out merged references\n                    this._mergedCells.forEach(function(merged) {\n                        refs = refs.map(function(ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n\n                            return ref;\n                        });\n                    });\n\n                    // use only unique refs\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n\n            forEach: function(ref, callback) {\n                var self = this;\n                function forEachRange(ref) {\n                    if (!(ref instanceof RangeRef)) {\n                        ref = ref.toRangeRef();\n                    }\n                    var topLeft = self._grid.normalize(ref.topLeft);\n                    var bottomRight = self._grid.normalize(ref.bottomRight);\n                    var ci, ri;\n\n                    function doIt(value) {\n                        callback(ri++, ci, value);\n                    }\n\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        ri = topLeft.row;\n                        var startCellIndex = self._grid.index(ri, ci);\n                        var endCellIndex = self._grid.index(bottomRight.row, ci);\n                        self._properties.forEach(startCellIndex, endCellIndex, doIt);\n                    }\n                }\n\n                if (!(ref instanceof RangeRef)) {\n                    ref = self._ref(ref);\n                }\n\n                if (ref instanceof UnionRef) {\n                    // _ref() might still return a UnionRef, for instance, if\n                    // `ref` happens to be one.  Probably an oversight, but it\n                    // turns out to be useful.\n                    ref.forEach(forEachRange);\n                } else {\n                    forEachRange(ref);\n                }\n            },\n\n            startResizing: function(initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n\n            startAutoFill: function() {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n\n            updateAutoFill: function(dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n\n            autoFillRef: function() {\n                return this._autoFillDest;\n            },\n\n            autoFillPunch: function() {\n                return this._autoFillPunch;\n            },\n\n            autoFillInProgress: function() {\n                return this._autoFillInProgress;\n            },\n\n            resizingInProgress: function() {\n                return this._resizeInProgress;\n            },\n\n            draggingInProgress: function() {\n                return this._draggingInProgress;\n            },\n\n            completeResizing: function() {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.trigger(\"commandRequest\", {\n                                command: \"ColumnWidthCommand\",\n                                options: {\n                                    target: handlePosition.col,\n                                    value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                                }\n                            });\n                        } else {\n                            this.trigger(\"commandRequest\", {\n                                command: \"RowHeightCommand\",\n                                options: {\n                                    target: handlePosition.row,\n                                    value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                                }\n                            });\n                        }\n                    } else {\n                        this.trigger(\"change\", { resize: true });\n                    }\n                }\n            },\n\n            _visualRange: function(ref) {\n                var merged = this._mergedCells;\n                for (var i = merged.length; --i >= 0;) {\n                    if (merged[i].intersects(ref)) {\n                        return this.range(merged[i]);\n                    }\n                }\n                return this.range(ref);\n            },\n\n            _renderComment: function(ref) {\n                var comment = null;\n                if (ref) {\n                    var range = this._visualRange(ref);\n                    comment = range.comment();\n                    ref = range._ref.toRangeRef().topLeft;\n                }\n                if (comment) {\n                    if (!this._commentRef || !ref.eq(this._commentRef)) {\n                        this._commentRef = ref;\n                        this.trigger(\"change\", { comment: true });\n                    }\n                } else {\n                    if (this._commentRef) {\n                        this._commentRef = null;\n                        this.trigger(\"change\", { comment: true });\n                    }\n                }\n            },\n\n            resizeHandlePosition: function() {\n                return this._resizeHandlePosition;\n            },\n\n            resizeHintPosition: function(location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger(\"change\", { resize: true, overElement: true });\n                }\n                return this._resizeHintPosition;\n            },\n\n            removeResizeHandle: function() {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger(\"change\", { resize: true, overElement: true });\n                }\n            },\n\n            positionResizeHandle: function(ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger(\"change\", { resize: true, overElement: true });\n            },\n\n            startDragging: function(data) {\n                this._draggingInProgress = data;\n            },\n\n            completeDragging: function() {\n                var drag = this._draggingInProgress;\n                if (drag) {\n                    this._draggingInProgress = null;\n                    var drawing = drag.drawing;\n                    if (drawing.eq(drag.copy)) {\n                        return;\n                    }\n                    if (drawing.topLeftCell) {\n                        // adjust reference - in case the top-left corner\n                        // was moving, select the cell beneath it.\n                        var box = this.drawingBoundingBox(drawing);\n                        var row = this._rows.indexVisible(box.top);\n                        var col = this._columns.indexVisible(box.left);\n                        var ref = new CellRef(row, col);\n                        var refBox = this.refBoundingBox(ref);\n                        drawing.offsetX = box.left - refBox.left;\n                        drawing.offsetY = box.top - refBox.top;\n                        drawing.topLeftCell = ref;\n                        this.triggerChange({ dragging: true });\n                    }\n                    this.trigger(\"commandRequest\", {\n                        command: \"DrawingUpdateCommand\",\n                        options: {\n                            sheet    : this,\n                            drawing  : drawing,\n                            previous : drag.copy\n                        }\n                    });\n                }\n            },\n\n            startSelection: function(view) {\n                if (this.frozenRows() || this.frozenColumns()) {\n                    this._currentView = null;\n                } else if (view && view._sheet === this) {\n                    this._currentView = view;\n                }\n                this._selectionInProgress = true;\n            },\n\n            completeSelection: function() {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger(\"change\", { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n\n                    if (this._autoFillPunch) { // we just clear data here\n                        this.trigger(\"commandRequest\", {\n                            command: \"ClearContentCommand\", options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this.trigger(\"commandRequest\", {\n                                command: \"AutoFillCommand\", options: { operatingRange: this.range(dest), origin: this.range(origin) }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n\n                    this.select(dest);\n                }\n            },\n\n            selectionInProgress: function() {\n                return this._selectionInProgress;\n            },\n\n            select: function(ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n\n                var expandedRef;\n\n                if (ref) {\n                    ref = this._ref(ref);\n                    ref = this._grid.normalize(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n\n                return selectionState.select(ref, expandedRef, changeActiveCell, this._currentView);\n            },\n\n            originalSelect: function() {\n                return this._selectionState().originalSelection;\n            },\n\n            currentSelectionRange: function() {\n                return this._selectionState().currentSelectionRange();\n            },\n\n            currentOriginalSelectionRange: function() {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n\n            currentNavigationRange: function() {\n                return this._selectionState().currentNavigationRange();\n            },\n\n            nextNavigationRange: function() {\n                return this._selectionState().nextNavigationRange();\n            },\n\n            previousNavigationRange: function() {\n                return this._selectionState().previousNavigationRange();\n            },\n\n            selectionRangeIndex: function() {\n                return this._selectionState().selectionRangeIndex;\n            },\n\n            activeCell: function(ref) {\n                return this._selectionState().activeCell(ref);\n            },\n\n            originalActiveCell: function() {\n                return this._selectionState().originalActiveCell;\n            },\n\n            singleCellSelection: function() {\n                return this._selectionState().singleCellSelection();\n            },\n\n            unionWithMerged: function(ref) {\n                var mergedCells = this._mergedCells;\n\n                return ref.map(function(ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n\n            trim: function(ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function(property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n\n            focus: function(ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n\n            activeCellSelection: function() {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n\n            selection: function() {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n\n            selectedHeaders: function() {\n                var selection = this.select();\n\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                var maxRow = this._grid.rowCount - 1;\n                var maxCol = this._grid.columnCount - 1;\n\n                selection.forEach(function(ref) {\n                    var i;\n                    var rowState = \"partial\";\n                    var colState = \"partial\";\n                    ref = ref.toRangeRef();\n\n                    var bottomRight = ref.bottomRight;\n                    var topLeft = ref.topLeft;\n\n                    var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                    var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n\n                    if (colSelection) { //column selection\n                        allRows = true;\n                        colState = \"full\";\n                    }\n\n                    if (rowSelection) { //row selection\n                        allCols = true;\n                        rowState = \"full\";\n                    }\n\n                    if (!colSelection) { //column selection\n                        for (i = topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== \"full\") {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n\n                    if (!rowSelection) {\n                        for (i = topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== \"full\") {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n\n            isInEditMode: function(isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n\n                this._inEdit = isInEdit;\n\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n\n            _setFormulaSelections: function(selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n\n            _viewActiveCell: function() {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n\n            toJSON: function() {\n                var positions = {};\n\n                var rows = this._rows.toJSON(\"height\", positions);\n                var columns = this._columns.toJSON(\"width\", {});\n                var viewSelection = this._viewSelection;\n                var hyperlinks = [];\n                var defaultCellStyle = this._defaultCellStyle || {};\n\n                function clearDefaultStyle(cell) {\n                    Object.keys(defaultCellStyle).forEach(function(key){\n                        if (cell[key] === defaultCellStyle[key]) {\n                            delete cell[key];\n                        }\n                    });\n                }\n\n                this.forEach(kendo.spreadsheet.SHEETREF, function(row, col, cell) {\n                    clearDefaultStyle(cell);\n\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n\n                    if (cell.link) {\n                        hyperlinks.push({\n                            ref    : kendo.spreadsheet.Ref.display(null, row, col),\n                            target : cell.link\n                        });\n                    }\n\n                    var position = positions[row];\n\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n\n                    row = rows[position];\n\n                    cell.index = col;\n\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n\n                    if (cell.formula) {\n                        // stringify Formula object.\n                        if (cell.formula.arrayFormulaRange) {\n                            cell.formula = {\n                                src: cell.formula.toString(),\n                                ref: cell.formula.arrayFormulaRange.toString()\n                            };\n                        } else {\n                            cell.formula = cell.formula.toString();\n                        }\n                    }\n\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n\n                    row.cells.push(cell);\n                });\n\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    showGridLines: this.showGridLines(),\n                    gridLinesColor: this.gridLinesColor(),\n                    mergedCells: this._mergedCells.map(function(ref) {\n                        return ref.toString();\n                    }),\n                    hyperlinks: hyperlinks,\n                    defaultCellStyle: defaultCellStyle,\n                    drawings: this._drawings.map(function(dr){\n                        return dr.toJSON();\n                    })\n                };\n\n                if (this._sort) {\n                   json.sort = {\n                       ref: this._sort.ref.toString(),\n                       columns: this._sort.columns.map(function(column) {\n                           return {\n                               index: column.index,\n                               ascending: column.ascending\n                           };\n                       })\n                   };\n                }\n\n                if (this._filter) {\n                   json.filter = {\n                       ref: this._filter.ref.toString(),\n                       columns: this._filter.columns.map(function(column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                       })\n                   };\n                }\n\n                return json;\n            },\n\n            fromJSON: function(json) {\n                this.batch(function() {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON(\"width\", json.columns);\n                    }\n\n                    if (json.rows !== undefined) {\n                        this._resizeForJSON(json.rows);\n                        this._rows.fromJSON(\"height\", json.rows);\n\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n\n                                    if (cell.formula) {\n                                        var isArray = typeof cell.formula != \"string\";\n                                        var src = isArray ? cell.formula.src : cell.formula;\n                                        var formula = this._compileFormula(rowIndex, columnIndex, src);\n                                        if (isArray) {\n                                            formula.setArrayFormulaRange(\n                                                kendo.spreadsheet.calc.parseReference(cell.formula.ref));\n                                        }\n                                        cell.formula = formula;\n                                    }\n\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n\n                    if (json.drawings) {\n                        this._drawings = json.drawings.map(Drawing.fromJSON);\n                    }\n\n                    if (json.selection) {\n                        this._viewSelection.selection =\n                            this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef.first();\n                    }\n\n\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function(ref) {\n                           this.range(ref).merge();\n                        }, this);\n                    }\n\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns  === undefined ? [] : json.filter.columns;\n\n                        if (!ref) {\n                            kendo.logToConsole(\"Dropping filter for sheet '\" + json.name + \"' due to missing ref\");\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function(column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n\n                            this._refreshFilter();\n                        }\n                    }\n\n                    if (json.showGridLines !== undefined) {\n                        this._showGridLines = json.showGridLines;\n                    }\n\n                    this._gridLinesColor = json.gridLinesColor;\n\n                    if (json.sort) {\n                        this._sortBy(this._ref(json.sort.ref), json.sort.columns.slice(0));\n                    }\n                });\n\n                this._rows._refresh();\n                this._columns._refresh();\n            },\n\n            formula: function(ref) {\n                return this._properties.get(\"formula\", this._grid.cellRefIndex(ref));\n            },\n\n            validation: function(ref) {\n                return this._properties.get(\"validation\", this._grid.cellRefIndex(ref));\n            },\n\n            // NOTE: resetFormulas should be called first.  We don't do it in this\n            // function because it should be done from the Workbook object for all\n            // sheets.\n            resetFormulas: function() {\n                this._forFormulas(function(formula){\n                    formula.reset();\n                });\n            },\n\n            resetValidations: function() {\n                this._forValidations(function(validation){\n                    validation.reset();\n                });\n            },\n\n            recalc: function(context, callback) {\n                var formulas = this._properties.get(\"formula\").values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n\n            revalidate: function(context) {\n                var self = this;\n                this._forValidations(function(validation){\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref =  new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, \"value\"), self._get(ref, \"format\"));\n                });\n            },\n\n            _value: function(row, col, value) {\n                var index = this._grid.index(row, col);\n\n                if (value !== undefined) {\n                    this._properties.set(\"value\", index, index, value);\n                } else {\n                    return this._properties.get(\"value\", index);\n                }\n            },\n\n            _validation: function(row, col) {\n                var index = this._grid.index(row, col);\n\n                return this._properties.get(\"validation\", index);\n            },\n\n            _compileValidation: function(row, col, validation) {\n                if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                    // do not alter an existing object.\n                    return validation.clone(this._name(), row, col);\n                }\n\n                if (validation.from != null) {\n                    validation.from = (validation.from + \"\").replace(/^=/, \"\");\n                }\n\n                if (validation.to != null) {\n                    validation.to = (validation.to + \"\").replace(/^=/, \"\");\n                }\n\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n\n            _compileFormula: function(row, col, f) {\n                f = f.replace(/^=/, \"\");\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        // Even if it's the same formula in multiple cells, we\n                        // need to have different Formula objects, hence cloning\n                        // it.  Don't worry, clone() is fast.\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n\n            _set: function(ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n\n                if (typeof value == \"number\") {\n                    // Apparently, Excel (and LibreOffice and Google\n                    // Sheets) will limit precision to 14 digits; type:\n                    // -4.2524999999999995 and you get -4.2525.  The\n                    // formula engine already does something similar for\n                    // intermediate formula results, but we must do it\n                    // here as well for original input values.\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n\n                if (value && name == \"formula\") {\n                    if (typeof value == \"string\") {\n                        // get Formula object.  we don't care about handling errors\n                        // here since it won't be called interactively.\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, \"formula\");\n\n                } else if (value && name == \"validation\") {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, \"validation\");\n\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == \"formula\") {\n                            // removing a formula, must clear value.\n                            this._properties.set(\"value\", start, end, null);\n                        }\n                    }\n                }\n            },\n\n            _get: function(ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n\n                var index = this._grid.index(topLeft.row, topLeft.col);\n\n                return this._properties.get(name, index);\n            },\n\n            batch: function(callback, reason) {\n                var suspended = this.suspendChanges();\n\n                this.suspendChanges(true);\n                this._valueChanged = false;\n\n                callback.call(this);\n\n                if (!reason) {\n                    reason = { recalc: true };\n                }\n                if (this._valueChanged) {\n                    reason.isValue = true;\n                }\n\n                return this.suspendChanges(suspended).triggerChange(reason);\n            },\n\n            _sortBy: function(ref, columns) {\n                var indices = null;\n\n                columns.forEach(function(column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get(\"value\"), column.ascending, indices);\n                }, this);\n\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n\n                this._refreshFilter();\n\n                this.forEach(ref, function(row, col, props) {\n                    var formula = props.formula;\n                    if (formula) {\n                        var diff = row - formula.row;\n                        if (diff !== 0) {\n                            var start = diff > 0 ? formula.row : formula.row + diff;\n                            formula.adjust(this.name(), \"row\", start, diff);\n                        }\n                    }\n                }.bind(this));\n\n                this.triggerChange({ recalc: true });\n            },\n\n            _refreshFilter: function() {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n\n            _filterBy: function(ref, columns) {\n                this.batch(function() {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this.isFilteredRow(ri)) {\n                            this._filteredRows.value(ri, ri, false);\n                            this._rows.unhide(ri);\n                        }\n                    }\n\n                    columns.forEach(function(column) {\n                        // do not filter header row\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n\n                        var cells = [];\n\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n\n                        this.forEach(columnRef, function(row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n\n                        column.filter.prepare(cells);\n\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n\n                            if (column.filter.matches(value) === false) {\n                                this._filterRow(cell.row);\n                            }\n                        }\n                    }, this);\n\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, { recalc: true, layout: true, filter: true });\n            },\n\n            filterColumn: function(ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n\n            filter: function() {\n                return this._filter;\n            },\n\n            clearFilter: function(spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n\n            _clearFilter: function(indices) {\n                if (this._filter) {\n                    this.batch(function() {\n                        this._filter.columns = this._filter.columns.filter(function(column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n\n                        this._refreshFilter();\n                    }, { recalc: true, layout: true, filter: true });\n                }\n            },\n\n            getAxisState: function() {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n\n            setAxisState: function(state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n\n            getState: function() {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function(cell) { return cell.clone(); }),\n                    properties: this._properties.getState()\n                };\n            },\n\n            setState: function(state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n\n            _merge: function(ref) {\n                var mergedCells = this._mergedCells;\n\n                var sheet = this;\n                var mergedRef;\n                this.batch(function() {\n                    mergedRef = ref.map(function(ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n\n                        var currentRef = ref.toRangeRef().union(mergedCells, function(ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get(\"formula\");\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n\n                        if (formula) {\n                            topLeft._set(\"formula\", formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n\n                    var viewSelection = sheet._viewSelection;\n\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, { activeCell: true, selection: true });\n\n                return mergedRef;\n            },\n\n            _useCultureDecimals: function() {\n                return this._workbook && this._workbook.options.useCultureDecimals;\n            },\n\n            withCultureDecimals: function(f) {\n                var dot = \".\";\n                if (this._useCultureDecimals()) {\n                    dot = kendo.culture().numberFormat[\".\"];\n                }\n                return kendo.spreadsheet.calc.withDecimalSeparator(dot, f);\n            },\n\n            drawingBoundingBox: function(drawing) {\n                var left = drawing.offsetX;\n                var top = drawing.offsetY;\n                if (drawing.topLeftCell) {\n                    // offsets are relative to cell\n                    left += this._columns.sum(0, drawing.topLeftCell.col - 1);\n                    top += this._rows.sum(0, drawing.topLeftCell.row - 1);\n                }\n                return new kendo.spreadsheet.Rectangle(left, top, drawing.width, drawing.height);\n            },\n\n            refBoundingBox: function(ref) {\n                return this._grid.rectangle(ref.toRangeRef());\n            },\n\n            addDrawing: function(drw, activate) {\n                if (!(drw instanceof Drawing)) {\n                    drw = new Drawing(drw);\n                }\n                this._drawings.push(drw);\n                if (activate) {\n                    this._activeDrawing = drw;\n                }\n                this.triggerChange({ layout: true });\n                return drw;\n            },\n\n            removeDrawing: function(drawing) {\n                var pos = this._drawings.indexOf(drawing);\n                if (pos >= 0) {\n                    this._drawings.splice(pos, 1);\n                    this.triggerChange({ layout: true });\n                }\n            },\n\n            usesImage: function(img) {\n                for (var i = this._drawings.length; --i >= 0;) {\n                    if (this._drawings[i].image === img) {\n                        return true;\n                    }\n                }\n                return false;\n            },\n\n            isMerged: function(ref) {\n                var merged = this._mergedCells;\n                for (var i = merged.length; --i >= 0;) {\n                    if (merged[i].eq(ref)) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n        });\n\n        var Drawing = kendo.Class.extend({\n            init: function Drawing(args) {\n                this.reset(args);\n            },\n\n            toJSON: function() {\n                return {\n                    topLeftCell: this.topLeftCell.toString(),\n                    offsetX: this.offsetX,\n                    offsetY: this.offsetY,\n                    width: this.width,\n                    height: this.height,\n                    image: this.image,\n                    opacity: this.opacity\n                };\n            },\n\n            clone: function() {\n                return new Drawing(this);\n            },\n\n            reset: function(dr) {\n                var anchor = dr.topLeftCell;\n                if (typeof anchor == \"string\") {\n                    anchor = kendo.spreadsheet.calc.parseReference(anchor);\n                }\n                this.topLeftCell = anchor;\n                this.offsetX = dr.offsetX || 0;\n                this.offsetY = dr.offsetY || 0;\n                this.width = dr.width;\n                this.height = dr.height;\n                this.image = dr.image;\n                this.opacity = dr.opacity != null ? dr.opacity : 1;\n            },\n\n            eq: function(dr) {\n                return ((!this.topLeftCell && !dr.topLeftCell)\n                        || (this.topLeftCell && dr.topLeftCell\n                            && this.topLeftCell.eq(dr.topLeftCell)))\n                    && this.offsetX === dr.offsetX\n                    && this.offsetY === dr.offsetY\n                    && this.width === dr.width\n                    && this.height === dr.height\n                    && this.image === dr.image\n                    && this.opacity === dr.opacity;\n            }\n        });\n\n        Drawing.fromJSON = function(args) {\n            return new Drawing(args);\n        };\n\n        kendo.spreadsheet.Sheet = Sheet;\n        kendo.spreadsheet.Drawing = Drawing;\n    })(kendo);\n\n    (function(kendo) {\n\n            var $ = kendo.jQuery;\n            var outerWidth = kendo._outerWidth;\n            var DOT = \".\";\n            var EMPTYCHAR = \" \";\n            var sheetsBarClassNames = {\n                sheetsBarWrapper: \"k-widget k-header\",\n                sheetsBarSheetsWrapper: \"k-tabstrip k-floatwrap k-tabstrip-bottom\",\n                sheetsBarActive: \"k-spreadsheet-sheets-bar-active\",\n                sheetsBarInactive: \"k-spreadsheet-sheets-bar-inactive\",\n                sheetsBarAdd: \"k-spreadsheet-sheets-bar-add\",\n                sheetsBarRemove: \"k-spreadsheet-sheets-remove\",\n                sheetsBarItems: \"k-spreadsheet-sheets-items\",\n                sheetsBarEditor: \"k-spreadsheet-sheets-editor\",\n                sheetsBarScrollable: \"k-tabstrip-scrollable\",\n                sheetsBarNext: \"k-tabstrip-next\",\n                sheetsBarPrev: \"k-tabstrip-prev\",\n                sheetsBarKItem: \"k-item k-tabstrip-item\",\n                sheetsBarKActive: \"k-active k-state-tab-on-top\",\n                sheetsBarKTextbox: \"k-textbox\",\n                sheetsBarKLink: \"k-link\",\n                sheetsBarKIcon: \"k-icon\",\n                sheetsBarKFontIcon: \"k-icon\",\n                sheetsBarKButton: \"k-button k-icon-button\",\n                sheetsBarKButtonDefaults: \"k-button-md k-rounded-md k-button-solid k-button-solid-base\",\n                sheetsBarKButtonBare: \"k-button-md k-rounded-md k-button-flat k-button-flat-base\",\n                sheetsBarArrowWIcon: \"caret-alt-left\",\n                sheetsBarArrowEIcon: \"caret-alt-right\",\n                sheetsBarKReset: \"k-reset k-tabstrip-items\",\n                sheetsBarXIcon: \"x\",\n                sheetsBarKSprite: \"k-sprite\",\n                sheetsBarPlusIcon: \"plus\",\n                sheetsBarHintWrapper: \"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint\",\n                sheetsBarKResetItems: \"k-reset k-tabstrip-items\"\n            };\n\n            var SheetsBar = kendo.ui.Widget.extend({\n                init: function(element, options) {\n                    var classNames = SheetsBar.classNames;\n\n                    kendo.ui.Widget.call(this, element, options);\n\n                    element = this.element;\n\n                    element.addClass(classNames.sheetsBarWrapper);\n\n                    this._openDialog = options.openDialog;\n\n                    this._tree = new kendo.dom.Tree(element[0]);\n\n                    this._tree.render([this._addButton(), this._createSheetsWrapper([])]);\n\n                    this._toggleScrollEvents(true);\n\n                    this._createSortable();\n\n                    this._sortable.bind(\"start\", this._onSheetReorderStart.bind(this));\n\n                    this._sortable.bind(\"end\", this._onSheetReorderEnd.bind(this));\n\n                    element.on(\"click\", DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n\n                    element.on(\"click\", \"li\", this._onSheetSelect.bind(this));\n\n                    element.on(\"dblclick\", \"li\" + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n\n                    element.on(\"click\", DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n                },\n\n                options: {\n                    name: \"SheetsBar\",\n                    scrollable: {\n                        distance: 200\n                    }\n                },\n\n                events: [\n                    \"select\",\n                    \"reorder\",\n                    \"rename\"\n                ],\n\n                _createEditor: function () {\n                    if (this._editor) {\n                        return;\n                    }\n\n                    this._renderSheets(this._sheets, this._selectedIndex, true);\n                    this._editor = this.element\n                        .find(kendo.format(\"input{0}{1}\",DOT,SheetsBar.classNames.sheetsBarEditor))\n                        .trigger(\"focus\")\n                        .on(\"keydown\", this._onEditorKeydown.bind(this))\n                        .on(\"blur\", this._onEditorBlur.bind(this));\n                },\n\n                _destroyEditor: function(canceled) {\n                    var newSheetName = canceled ? null : this._editor.val();\n                    this._editor.off();\n                    this._editor = null;\n                    this._renderSheets(this._sheets, this._selectedIndex, false);\n                    this._onSheetRename(newSheetName);\n                },\n\n                renderSheets: function(sheets, selectedIndex) {\n                    if (!sheets || selectedIndex < 0) {\n                        return;\n                    }\n\n                    this._renderSheets(sheets, selectedIndex, false);\n                },\n\n                _renderSheets: function(sheets, selectedIndex, isInEditMode) {\n                    var that = this;\n                    var classNames = SheetsBar.classNames;\n\n                    that._isRtl = kendo.support.isRtl(that.element);\n                    that._sheets = sheets;\n                    that._selectedIndex = selectedIndex;\n\n                    that._renderHtml(isInEditMode, true);\n\n                    if (!that._scrollableAllowed()) {\n                        return;\n                    }\n\n                    var sheetsWrapper = that._sheetsWrapper();\n\n                    sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n\n                    that._toggleScrollButtons();\n                },\n\n                _toggleScrollButtons: function (toggle) {\n                    var that = this;\n                    var ul = that._sheetsGroup();\n                    var wrapper = that._sheetsWrapper();\n                    var scrollLeft = kendo.scrollLeft(ul);\n                    var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                    var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n\n                    if (toggle === false) {\n                        prev.addClass( 'k-disabled' );\n                        next.addClass( 'k-disabled' );\n                    } else {\n                        prev.toggleClass( 'k-disabled', !(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0) );\n                        next.toggleClass( 'k-disabled', !(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1) );\n                    }\n\n                },\n\n                _toggleScrollEvents: function(toggle) {\n                    var that = this;\n                    var classNames = SheetsBar.classNames;\n                    var options = that.options;\n                    var scrollPrevButton;\n                    var scrollNextButton;\n                    var sheetsWrapper = that._sheetsWrapper();\n                    scrollPrevButton = sheetsWrapper.find(DOT + classNames.sheetsBarPrev);\n                    scrollNextButton = sheetsWrapper.find(DOT + classNames.sheetsBarNext);\n\n                    if (toggle) {\n                        scrollPrevButton.on(\"mousedown\", function (event) {\n                            event.preventDefault();\n                            event.stopPropagation();\n                            that._nowScrollingSheets = true;\n                            that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                        });\n\n                        scrollNextButton.on(\"mousedown\", function (event) {\n                            event.preventDefault();\n                            event.stopPropagation();\n                            that._nowScrollingSheets = true;\n                            that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                        });\n\n                        scrollPrevButton.add(scrollNextButton).on(\"mouseup\", function () {\n                            that._nowScrollingSheets = false;\n                        });\n                    } else {\n                        scrollPrevButton.off();\n                        scrollNextButton.off();\n                    }\n                },\n\n                _renderHtml: function(isInEditMode, renderScrollButtons) {\n                    var idx;\n                    var sheetElements = [];\n                    var dom = kendo.dom;\n                    var element = dom.element;\n                    var sheets = this._sheets;\n                    var selectedIndex = this._selectedIndex;\n                    var classNames = SheetsBar.classNames;\n\n                    for (idx = 0; idx < sheets.length; idx++) {\n                        var sheet = sheets[idx];\n                        var isSelectedSheet = (idx === selectedIndex);\n                        var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR, role: \"tab\" };\n                        var elementContent = [];\n\n                        if (isSelectedSheet) {\n                            attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                        } else {\n                            attr.className += classNames.sheetsBarInactive;\n                        }\n\n                        if (isSelectedSheet && isInEditMode) {\n                            elementContent.push(element(\"input\", {\n                                type: \"text\",\n                                value: sheet.name(),\n                                className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                                maxlength: 50\n                            }, []));\n                        } else {\n                            elementContent.push(element(\"span\", {\n                                className: classNames.sheetsBarKLink,\n                                title: sheet.name()\n                            }, [dom.text(sheet.name())]));\n\n                            if (sheets.length > 1) {\n                                var deleteIcon = element($(kendo.ui.icon(classNames.sheetsBarXIcon))[0]);\n\n                                elementContent.push(element(\"span\", {\n                                    className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove,\n                                    'data-type': 'remove'\n                                }, [deleteIcon]));\n                            }\n                        }\n\n                        sheetElements.push(element(\"li\", attr, elementContent));\n                    }\n\n                    this._tree.render([this._addButton(),  this._createSheetsWrapper(sheetElements, renderScrollButtons)]);\n                },\n\n                _createSheetsWrapper: function(sheetElements, renderScrollButtons) {\n                    var element = kendo.dom.element;\n                    var classNames = SheetsBar.classNames;\n                    var itemsWrapper = element('div', { className: 'k-tabstrip-items-wrapper k-hstack' } );\n                    var childrenElements = [null, element(\"ul\", {\n                        className: classNames.sheetsBarKReset,\n                        role: \"tablist\"\n                    }, sheetElements), null ];\n\n                    renderScrollButtons = true;\n\n                    if (renderScrollButtons) {\n                        var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n\n                        childrenElements[0] = (element(\"span\", { ariaHidden: \"true\", className: baseButtonClass + classNames.sheetsBarPrev }, [\n                            element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowWIcon, iconClass: \"k-button-icon\" }))[0])\n                        ]));\n\n                        childrenElements[2] = (element(\"span\", { ariaHidden: \"true\", className: baseButtonClass + classNames.sheetsBarNext }, [\n                            element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowEIcon, iconClass: \"k-button-icon\" }))[0])\n                        ]));\n                    }\n\n                    itemsWrapper.children = childrenElements;\n\n                    return element(\"div\", { className: classNames.sheetsBarItems }, [ itemsWrapper ]);\n                },\n\n                _createSortable: function() {\n                    var classNames = SheetsBar.classNames;\n                    this._sortable = new kendo.ui.Sortable(this.element, {\n                        filter: kendo.format(\"ul li.{0},ul li.{1}\", classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                        container: DOT + classNames.sheetsBarItems,\n                        axis: \"x\",\n                        animation: false,\n                        ignore: \"input\",\n                        end: function () {\n                            if (this.draggable.hint) {\n                                this.draggable.hint.remove();\n                            }\n                        },\n                        hint: function (element) {\n                            var hint = $(element).clone();\n                            return hint.wrap(\"<div class='\" + classNames.sheetsBarHintWrapper + \"'><ul class='\" + classNames.sheetsBarKResetItems + \"'></ul></div>\").closest(\"div\");\n                        }\n                    });\n                },\n\n                _onEditorKeydown: function(e) {\n                    if (this._editor) {\n                        if (e.which === 13) {\n                            this._destroyEditor();\n                        }\n\n                        if (e.which === 27) {\n                            this._destroyEditor(true);\n                        }\n                    }\n                },\n\n                _onEditorBlur: function() {\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n                },\n\n                _onSheetReorderEnd: function(e) {\n                    e.preventDefault();\n                    this.trigger(\"reorder\", {oldIndex: e.oldIndex, newIndex: e.newIndex});\n                },\n\n                _onSheetReorderStart: function(e) {\n                    if (this._editor) {\n                        e.preventDefault();\n                    }\n                },\n\n                _onSheetRemove: function(e) {\n                    var removedSheetName = $(e.target).closest(\"li\").text();\n\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n\n                    var closeCallback = function(e) {\n                        var dlg = e.sender;\n\n                        if (dlg.isConfirmed()) {\n                            this.trigger(\"remove\", { name: removedSheetName, confirmation: true });\n                        }\n                    }.bind(this);\n\n                    this._openDialog(\"confirmation\", {\n                        close: closeCallback\n                    });\n                },\n\n                _onSheetSelect: function(e) {\n                    var selectedSheetText = $(e.target).text();\n\n                    if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                        e.preventDefault();\n                        return;\n                    }\n\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n\n                    this._scrollSheetsToItem($(e.target).closest(\"li\"));\n\n                    this.trigger(\"select\", {name: selectedSheetText, isAddButton: false});\n                },\n\n                _onSheetRename: function(newSheetName) {\n                    if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                        return;\n                    }\n\n                    this.trigger(\"rename\", {name: newSheetName, sheetIndex: this._selectedIndex });\n                },\n\n                _onAddSelect: function() {\n                    this.trigger(\"select\", {isAddButton: true});\n                },\n\n                _addButton: function() {\n                    var element = kendo.dom.element;\n                    var classNames = SheetsBar.classNames;\n                    return element(\"a\", {\n                        role: \"button\",\n                        'aria-label': \"Add new sheet\",\n                        className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonDefaults\n                    }, [element($(kendo.ui.icon({ icon: classNames.sheetsBarPlusIcon, iconClass: \"k-button-icon\" }))[0])]);\n                },\n\n                destroy: function() {\n                    this._sortable.destroy();\n                },\n\n                _scrollableAllowed: function() {\n                    var options = this.options;\n                    return options.scrollable && !isNaN(options.scrollable.distance);\n                },\n\n                _scrollSheetsToItem: function (item) {\n                    var that = this;\n                    var sheetsGroup = that._sheetsGroup();\n                    var currentScrollOffset = kendo.scrollLeft(sheetsGroup);\n                    var itemWidth = outerWidth(item);\n                    var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                    var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                    var itemPosition;\n\n                    if (that._isRtl) {\n                        if (itemOffset < 0) {\n                            itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset);\n                        } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                            itemPosition = currentScrollOffset + itemOffset - itemWidth;\n                        }\n                    } else {\n                        if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                            itemPosition = itemOffset + itemWidth - sheetsGroupWidth;\n                        } else if (currentScrollOffset > itemOffset) {\n                            itemPosition = itemOffset;\n                        }\n                    }\n\n                    sheetsGroup.finish().animate({ \"scrollLeft\": itemPosition }, \"fast\", \"linear\", function () {\n                        that._toggleScrollButtons();\n                    });\n                },\n\n                _sheetsGroup: function() {\n                    return this._sheetsWrapper().find(\"ul\");\n                },\n\n                _sheetsWrapper: function() {\n                    return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n                },\n\n                _scrollSheetsByDelta: function (delta) {\n                    var that = this;\n                    var sheetsGroup = that._sheetsGroup();\n                    var scrLeft = kendo.scrollLeft(sheetsGroup);\n\n                    sheetsGroup.finish().animate({ \"scrollLeft\": scrLeft + delta }, \"fast\", \"linear\", function () {\n                        if (that._nowScrollingSheets) {\n                            that._scrollSheetsByDelta(delta);\n                        } else {\n                            that._toggleScrollButtons();\n                        }\n                    });\n                }\n            });\n\n            kendo.spreadsheet.SheetsBar = SheetsBar;\n            $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n        })(window.kendo);\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n        var util$2 = kendo.util;\n        var spreadsheet$5 = kendo.spreadsheet;\n        var Ref$2 = spreadsheet$5.Ref;\n        var RangeRef$2 = spreadsheet$5.RangeRef;\n        var CellRef$3 = spreadsheet$5.CellRef;\n        var NameRef$2 = spreadsheet$5.NameRef;\n        var exports$1 = spreadsheet$5.calc;\n        var runtime$4 = exports$1.runtime;\n\n        // Excel formula parser and compiler to JS.\n        // some code adapted from http://lisperator.net/pltut/\n\n        // these two will hold the same operators, except that when the comma is used as decimal\n        // separator, the union operator must be the semicolon (;) instead of comma.\n        var OPERATORS_STANDARD = Object.create(null);\n        var OPERATORS_COMMA = Object.create(null);\n\n        (function(ops){\n            ops.forEach(function(cls, i){\n                cls.forEach(function(op){\n                    OPERATORS_STANDARD[op] = ops.length - i;\n                    OPERATORS_COMMA[op == \",\" ? \";\" : op] = ops.length - i;\n                });\n            });\n        })([\n            [ \":\" ],\n            [ \" \" ],\n            [ \",\" ],\n            [ \"%\" ],\n            [ \"^\" ],\n            [ \"*\", \"/\" ],\n            [ \"+\", \"-\" ],\n            [ \"&\" ],\n            [ \"=\", \"<\", \">\", \"<=\", \">=\", \"<>\" ]\n        ]);\n\n        var OPERATORS = OPERATORS_STANDARD;\n\n        var SEPARATORS = {\n            DEC: \".\",\n            ARG: \",\",\n            COL: \",\"\n        };\n\n        function setDecimalSeparator(sep) {\n            SEPARATORS.DEC = sep;\n            SEPARATORS.ARG = sep == \",\" ? \";\" : \",\";\n            SEPARATORS.COL = sep == \",\" ? \"\\\\\" : \",\";\n            OPERATORS = sep == \",\" ? OPERATORS_COMMA : OPERATORS_STANDARD;\n        }\n\n        exports$1.withDecimalSeparator = function(sep, f) {\n            if (SEPARATORS.DEC == sep) {\n                return f();\n            }\n            var save = SEPARATORS.DEC;\n            setDecimalSeparator(sep);\n            try {\n                return f();\n            } finally {\n                setDecimalSeparator(save);\n            }\n        };\n\n        exports$1._separators = SEPARATORS;\n\n        var ParseError = kendo.Class.extend({\n            init: function ParseError(message, pos) {\n                this.message = message;\n                this.pos = pos;\n            },\n            toString: function() {\n                return this.message;\n            }\n        });\n\n        var TRUE = { type: \"bool\", value: true };\n        var FALSE = { type: \"bool\", value: false };\n\n        function getcol(str) {\n            str = str.toUpperCase();\n            for (var col = 0, i = 0; i < str.length; ++i) {\n                col = col * 26 + str.charCodeAt(i) - 64;\n            }\n            return col - 1;\n        }\n\n        function getrow(str) {\n            return parseInt(str, 10) - 1;\n        }\n\n        function parseReference$1(name, noThrow) {\n            if (name.toLowerCase() == \"#sheet\") {\n                return spreadsheet$5.SHEETREF;\n            }\n            OUT: {\n                // this is redundant, but let's keep it fast for the most\n                // common case  A1.  If this fails, we'll try to employ the\n                // whole tokenizer.\n                var m;\n                if ((m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name))) {\n                    var row = getrow(m[4]), col = getcol(m[2]);\n                    if (row < 0x100000 && col < 0x4000) {\n                        return new CellRef$3(getrow(m[4]), getcol(m[2]));\n                    }\n                    // no NameRef-s from this function\n                    break OUT;\n                }\n                var stream = TokenStream$1(name, {});\n                var a = [];\n                while (true) {\n                    var ref = stream.next();\n                    if (ref instanceof CellRef$3) {\n                        // this function always makes absolute references\n                        ref.rel = 0;\n                    } else if (ref instanceof RangeRef$2) {\n                        ref.topLeft.rel = 0;\n                        ref.bottomRight.rel = 0;\n                    } else {\n                        break OUT;\n                    }\n                    a.push(ref);\n                    if (stream.eof()) {\n                        break;\n                    }\n                    if (!stream.is(\"op\", SEPARATORS.ARG)) {\n                        break OUT;\n                    }\n                    stream.next();\n                }\n                return a.length == 1 ? a[0] : new spreadsheet$5.UnionRef(a);\n            }\n            if (!noThrow) {\n                throw new Error(\"Cannot parse reference: \" + name);\n            }\n        }\n\n        function parseFormula(sheet, row, col, input) {\n            var refs = [];\n            input = TokenStream$1(input, { row: row, col: col });\n            var is = input.is;\n\n            return {\n                type: \"exp\",\n                ast: parseExpression(true),\n                refs: refs,\n                sheet: sheet,\n                row: row,\n                col: col\n            };\n\n            function addReference(ref) {\n                ref.index = refs.length;\n                refs.push(ref);\n                return ref;\n            }\n\n            function skip(type, value, allowEOF) {\n                if (is(type, value)) {\n                    return input.next();\n                } else {\n                    var tok = input.peek();\n                    if (tok) {\n                        input.croak(\"Expected \" + type + \" \" + value + \" but found \" + tok.type + \" \" + tok.value + \"\");\n                    } else if (!allowEOF) {\n                        input.croak(\"Expected \" + type + \" \" + value + \"\");\n                    }\n                }\n            }\n\n            function parseExpression(commas) {\n                return maybeBinary(maybeIntersect(parseAtom()), 0, commas);\n            }\n\n            function parseSymbol(tok) {\n                if (tok.upper == \"TRUE\" || tok.upper == \"FALSE\") {\n                    return tok.upper == \"TRUE\" ? TRUE : FALSE;\n                }\n                return addReference(new NameRef$2(tok.value));\n            }\n\n            function parseFuncall() {\n                var fname = input.next();\n                fname = fname.value;\n                skip(\"punc\", \"(\");\n                var args = [];\n                while (1) {\n                    if (is(\"punc\", \")\")) {\n                        break;\n                    }\n                    if (is(\"op\", SEPARATORS.ARG)) {\n                        args.push({ type: \"null\" });\n                        input.next();\n                        continue;\n                    }\n                    args.push(parseExpression(false));\n                    if (input.eof() || is(\"punc\", \")\")) {\n                        break;\n                    }\n                    skip(\"op\", SEPARATORS.ARG);\n                }\n                skip(\"punc\", \")\", true);\n                return {\n                    type: \"func\",\n                    func: fname,\n                    args: args\n                };\n            }\n\n            function fixReference(ref) {\n                if (!ref.hasSheet()) {\n                    ref.setSheet(sheet);\n                }\n                return addReference(ref);\n            }\n\n            function parseAtom() {\n                var exp;\n                if (is(\"ref\")) {\n                    exp = fixReference(input.next());\n                }\n                else if (is(\"func\")) {\n                    exp = parseFuncall();\n                }\n                else if (is(\"punc\", \"(\")) {\n                    input.next();\n                    exp = parseExpression(true);\n                    skip(\"punc\", \")\", true);\n                }\n                else if (is(\"punc\", \"{\")) {\n                    input.next();\n                    exp = parseArray();\n                    skip(\"punc\", \"}\", true);\n                }\n                else if (is(\"num\") || is(\"str\") || is(\"error\")) {\n                    exp = input.next();\n                }\n                else if (is(\"sym\")) {\n                    exp = parseSymbol(input.next());\n                }\n                else if (is(\"op\", \"+\") || is(\"op\", \"-\")) {\n                    exp = {\n                        type: \"prefix\",\n                        op: input.next().value,\n                        exp: parseAtom()\n                    };\n                }\n                else if (!input.peek()) {\n                    input.croak(\"Incomplete expression\");\n                }\n                else if (is(\"punc\", \"[\")) {\n                    input.croak(\"External reference not supported\");\n                }\n                else {\n                    input.croak(\"Parse error\");\n                }\n                return maybePercent(exp);\n            }\n\n            function parseArray() {\n                var row = [], value = [ row ], first = true;\n                while (!input.eof() && !is(\"punc\", \"}\")) {\n                    if (first) {\n                        first = false;\n                    } else if (is(null, \";\")) {\n                        value.push(row = []);\n                        input.next();\n                    } else {\n                        skip(null, SEPARATORS.COL);\n                    }\n                    row.push(parseExpression(false));\n                }\n                return {\n                    type: \"matrix\",\n                    value: value\n                };\n            }\n\n            function maybeIntersect(exp) {\n                if (is(\"punc\", \"(\") || is(\"ref\") || is(\"num\") || is(\"func\")) {\n                    return {\n                        type: \"binary\",\n                        op: \" \",\n                        left: exp,\n                        right: parseExpression(false)\n                    };\n                } else {\n                    return exp;\n                }\n            }\n\n            function maybePercent(exp) {\n                if (is(\"op\", \"%\")) {\n                    input.next();\n                    return maybePercent({\n                        type: \"postfix\",\n                        op: \"%\",\n                        exp: exp\n                    });\n                } else {\n                    return exp;\n                }\n            }\n\n            function maybeBinary(left, my_prec, commas) {\n                var tok = is(\"op\");\n                if (tok && (commas || tok.value != SEPARATORS.ARG)) {\n                    var his_prec = OPERATORS[tok.value];\n                    if (his_prec > my_prec) {\n                        input.next();\n                        var right = maybeBinary(parseAtom(), his_prec, commas);\n                        return maybeBinary({\n                            type: \"binary\",\n                            op: tok.value == \";\" ? \",\" : tok.value, // translate union back to comma\n                            left: left,\n                            right: right\n                        }, my_prec, commas);\n                    }\n                }\n                return left;\n            }\n        }\n\n        function parseNameDefinition(name, def) {\n            var nameRef = parseFormula(null, 0, 0, name);\n            if (!(nameRef.ast instanceof NameRef$2)) {\n                throw new ParseError(\"Invalid name: \" + name);\n            }\n            nameRef = nameRef.ast;\n\n            if (!(def instanceof Ref$2)) {\n                var defAST = parseFormula(nameRef.sheet, 0, 0, def);\n                if (defAST.ast instanceof Ref$2) {\n                    def = defAST.ast;   // single reference\n                } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n                    def = defAST.ast.value; // constant\n                } else {\n                    def = makeFormula(defAST); // formula\n                }\n            }\n\n            return {\n                name: nameRef,\n                value: def\n            };\n        }\n\n        var makeClosure = (function(cache){\n            return function(code) {\n                var f = cache[code];\n                if (!f) {\n                    f = cache[code] = new Function(\"'use strict';return(\" + code + \")\")();\n                }\n                return f;\n            };\n        })(Object.create(null));\n\n        function makePrinter(exp) {\n            return makeClosure(\"function(row, col, mod){return(\" + print(exp.ast, exp, 0) + \")}\");\n            function print(node, parent, prec) {\n                switch (node.type) {\n                  case \"num\":\n                    return \"(kendo.spreadsheet.calc._separators.DEC == '.' ? \"\n                        +  JSON.stringify(JSON.stringify(node.value)) + \" : \"\n                        +  JSON.stringify(JSON.stringify(node.value))\n                        +  \".replace('.' , kendo.spreadsheet.calc._separators.DEC))\";\n                  case \"bool\":\n                    return JSON.stringify(node.value);\n                  case \"error\":\n                    return JSON.stringify(\"#\" + node.value);\n                  case \"str\":\n                    return JSON.stringify(JSON.stringify(node.value));\n                  case \"ref\":\n                    return \"this.refs[\" + node.index + \"].print(row, col, mod)\";\n                  case \"prefix\":\n                    return withParens(function(){\n                        return JSON.stringify(node.op) + \" + \" + print(node.exp, node, OPERATORS[node.op]);\n                    });\n                  case \"postfix\":\n                    return withParens(function(){\n                        return print(node.exp, node, OPERATORS[node.op]) + \" + \" + JSON.stringify(node.op);\n                    });\n                  case \"binary\":\n                    return withParens(function(){\n                        var left = parenthesize(\n                            print(node.left, node, OPERATORS[node.op]),\n                            node.left instanceof NameRef$2 && node.op == \":\"\n                        );\n                        var right = parenthesize(\n                            print(node.right, node, OPERATORS[node.op]),\n                            node.right instanceof NameRef$2 && node.op == \":\"\n                        );\n                        if (/^[,;]/.test(node.op)) {\n                            return left + \" + kendo.spreadsheet.calc._separators.ARG + \" + right;\n                        } else {\n                            return left + \" + \" + JSON.stringify(node.op) + \" + \" + right;\n                        }\n                    });\n                  case \"func\":\n                    return JSON.stringify(node.func + \"(\") + \" + \"\n                        + (node.args.length > 0\n                           ? node.args.map(function(arg){\n                               return print(arg, node, 0);\n                           }).join(\" + kendo.spreadsheet.calc._separators.ARG + ' ' + \")\n                           : \"''\")\n                        + \" + ')'\";\n                  case \"matrix\":\n                    return \"'{ ' + \" + node.value.map(function(el){\n                        return el.map(function(el){\n                            return print(el, node, 0);\n                        }).join(\" + kendo.spreadsheet.calc._separators.COL + ' ' + \");\n                    }).join(\" + '; ' + \") + \"+ ' }'\";\n                  case \"null\":\n                    return \"''\";\n                }\n                throw new Error(\"Cannot make printer for node \" + node.type);\n\n                function withParens(f) {\n                    var op = node.op;\n                    var needParens = (OPERATORS[op] < prec\n                                      || (!prec && op == \",\")\n                                      || (parent.type == \"prefix\" && prec == OPERATORS[op] && parent.op == \"-\")\n                                      || (parent.type == \"binary\" && prec == OPERATORS[op] && node === parent.right));\n                    return parenthesize(f(), needParens);\n                }\n            }\n            function parenthesize(code, cond) {\n                return cond ? \"'(' + \" + code + \" + ')'\" : code;\n            }\n        }\n\n        function toCPS(ast, k) {\n            var GENSYM = 0;\n            return cps(ast, k);\n\n            function cps(node, k){\n                switch (node.type) {\n                  case \"ref\"     : return cpsRef(node, k);\n                  case \"num\"     :\n                  case \"str\"     :\n                  case \"null\"    :\n                  case \"error\"   :\n                  case \"bool\"    : return cpsAtom(node, k);\n                  case \"prefix\"  :\n                  case \"postfix\" : return cpsUnary(node, k);\n                  case \"binary\"  : return cpsBinary(node, k);\n                  case \"func\"    : return cpsFunc(node, k);\n                  case \"lambda\"  : return cpsLambda(node, k);\n                  case \"matrix\"  : return cpsMatrix(node.value, k, true);\n                }\n                throw new Error(\"Cannot CPS \" + node.type);\n            }\n\n            function cpsRef(node, k) {\n                return node.ref == \"name\" ? cpsNameRef(node, k) : cpsAtom(node, k);\n            }\n\n            function cpsAtom(node, k) {\n                return k(node);\n            }\n\n            function cpsNameRef(node, k) {\n                return {\n                    type: \"func\",\n                    func: \",getname\",\n                    args: [ makeContinuation(k), node ]\n                };\n            }\n\n            function cpsUnary(node, k) {\n                return cps({\n                    type: \"func\",\n                    func: \"unary\" + node.op,\n                    args: [ node.exp ]\n                }, k);\n            }\n\n            function cpsBinary(node, k) {\n                return cps({\n                    type: \"func\",\n                    func: \"binary\" + node.op,\n                    args: [ node.left, node.right ]\n                }, k);\n            }\n\n            function cpsIf(co, th, el, k) {\n                return cps(co, function(co){\n                    // compile THEN and ELSE into a lambda which takes a callback to invoke with the\n                    // result of the branches, and the IF itself will become a call the internal \"if\"\n                    // function.\n                    var rest = makeContinuation(k);\n                    var thenK = gensym(\"T\");\n                    var elseK = gensym(\"E\");\n                    return {\n                        type: \"func\",\n                        func: \"if\",\n                        args: [\n                            rest,\n                            co, // condition\n                            { // then\n                                type: \"lambda\",\n                                vars: [ thenK ],\n                                body: cps(th || TRUE, function(th){\n                                    return {\n                                        type: \"call\",\n                                        func: { type: \"var\", name: thenK },\n                                        args: [ th ]\n                                    };\n                                })\n                            },\n                            { // else\n                                type: \"lambda\",\n                                vars: [ elseK ],\n                                body: cps(el || FALSE, function(el){\n                                    return {\n                                        type: \"call\",\n                                        func: { type: \"var\", name: elseK },\n                                        args: [ el ]\n                                    };\n                                })\n                            }\n                        ]\n                    };\n                });\n            }\n\n            function cpsAnd(args, k) {\n                if (args.length === 0) {\n                    return cpsAtom(TRUE, k);\n                }\n                return cps({\n                    type: \"func\",\n                    func: \"IF\",\n                    args: [\n                        // first item\n                        args[0],\n                        // if true, apply AND for the rest\n                        {\n                            type: \"func\",\n                            func: \"AND\",\n                            args: args.slice(1)\n                        },\n                        // otherwise return false\n                        FALSE\n                    ]\n                }, k);\n            }\n\n            function cpsOr(args, k) {\n                if (args.length === 0) {\n                    return cpsAtom(FALSE, k);\n                }\n                return cps({\n                    type: \"func\",\n                    func: \"IF\",\n                    args: [\n                        // first item\n                        args[0],\n                        // if true, return true\n                        TRUE,\n                        // otherwise apply OR for the rest\n                        {\n                            type: \"func\",\n                            func: \"OR\",\n                            args: args.slice(1)\n                        }\n                    ]\n                }, k);\n            }\n\n            function cpsFunc(node, k) {\n                switch (node.func.toLowerCase()) {\n                  case \"if\":\n                    return cpsIf(node.args[0], node.args[1], node.args[2], k);\n                  case \"and\":\n                    return cpsAnd(node.args, k);\n                  case \"or\":\n                    return cpsOr(node.args, k);\n                  case \"true\":\n                    return k(TRUE);\n                  case \"false\":\n                    return k(FALSE);\n                }\n                // actual function\n                return (function loop(args, i){\n                    if (i == node.args.length) {\n                        return {\n                            type : \"func\",\n                            func : node.func,\n                            args : args\n                        };\n                    }\n                    else {\n                        return cps(node.args[i], function(value){\n                            return loop(args.concat([ value ]), i + 1);\n                        });\n                    }\n                })([ makeContinuation(k) ], 0);\n            }\n\n            function cpsLambda(node, k) {\n                var cont = gensym(\"K\");\n                var body = cps(node.body, function(body){\n                    return { type: \"call\",\n                             func: { type: \"var\", value: cont },\n                             args: [ body ] };\n                });\n                return k({ type: \"lambda\",\n                           vars: [ cont ].concat(node.vars),\n                           body: body });\n            }\n\n            function cpsMatrix(elements, k, isMatrix) {\n                var a = [];\n                return (function loop(i){\n                    if (i == elements.length) {\n                        return k({\n                            type: \"matrix\",\n                            value: a\n                        });\n                    } else {\n                        return (isMatrix ? cpsMatrix : cps)(elements[i], function(val){\n                            a[i] = val;\n                            return loop(i + 1);\n                        });\n                    }\n                })(0);\n            }\n\n            function makeContinuation(k) {\n                var cont = gensym(\"R\");\n                return {\n                    type : \"lambda\",\n                    vars : [ cont ],\n                    body : k({ type: \"var\", name: cont })\n                };\n            }\n\n            function gensym(name) {\n                if (!name) {\n                    name = \"\";\n                }\n                name = \"_\" + name;\n                return name + (++GENSYM);\n            }\n        }\n\n        var FORMULA_CACHE = Object.create(null);\n\n        function makeFormula(exp) {\n            var printer = makePrinter(exp);\n            var hash = printer.call(exp); // needs .refs\n            var formula = FORMULA_CACHE[hash];\n            if (formula) {\n                // we need to clone because formulas cache the result; even if the formula is the same,\n                // its value will depend on its location, hence we need different objects.  Still, using\n                // this cache is a good idea because we'll reuse the same refs array, handler and\n                // printer instead of allocating new ones (and we skip compiling it).\n                return formula.clone(exp.sheet, exp.row, exp.col);\n            }\n            var code = js(toCPS(exp.ast, function(ret){\n                return {\n                    type: \"return\",\n                    value: ret\n                };\n            }));\n\n            code = [\n                \"function(){\",\n                \"var context = this, refs = context.formula.absrefs\",\n                code,\n                \"}\"\n            ].join(\";\\n\");\n\n            formula = new runtime$4.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n            FORMULA_CACHE[hash] = formula.clone(exp.sheet, exp.row, exp.col);\n            return formula;\n\n            function js(node){\n                var type = node.type;\n                if (type == \"num\") {\n                    return node.value + \"\";\n                }\n                else if (type == \"str\") {\n                    return JSON.stringify(node.value);\n                }\n                else if (type == \"error\") {\n                    return \"context.error(\" + JSON.stringify(node.value) + \")\";\n                }\n                else if (type == \"return\") {\n                    return \"context.resolve(\" + js(node.value) + \")\";\n                }\n                else if (type == \"func\") {\n                    return \"context.func(\" + JSON.stringify(node.func) + \", \"\n                        + js(node.args[0]) + \", \" // the callback\n                        + jsArray(node.args.slice(1)) // the arguments\n                        + \")\";\n                }\n                else if (type == \"call\") {\n                    return js(node.func) + \"(\" + node.args.map(js).join(\", \") + \")\";\n                }\n                else if (type == \"ref\") {\n                    return \"refs[\" + node.index + \"]\";\n                }\n                else if (type == \"bool\") {\n                    return \"\" + node.value;\n                }\n                else if (type == \"if\") {\n                    return \"(context.bool(\" + js(node.co) + \") ? \" + js(node.th) + \" : \" + js(node.el) + \")\";\n                }\n                else if (type == \"lambda\") {\n                    return \"(function(\"\n                        + node.vars.join(\", \")\n                        + \"){ return(\" + js(node.body) + \") })\";\n                }\n                else if (type == \"var\") {\n                    return node.name;\n                }\n                else if (type == \"matrix\") {\n                    return jsArray(node.value);\n                }\n                else if (type == \"null\") {\n                    return \"null\";\n                }\n                else {\n                    throw new Error(\"Cannot compile expression \" + type);\n                }\n            }\n\n            function jsArray(a) {\n                return \"[ \" + a.map(js).join(\", \") + \" ]\";\n            }\n        }\n\n        function identity(x) {\n            return x;\n        }\n\n        function TokenStream$1(input, options) {\n            input = RawTokenStream(InputStream(input), options);\n            var ahead = input.ahead;\n            var skip = input.skip;\n            var token = null;\n            var fixCell = options.row != null && options.col != null\n                ? function(cell) {\n                    if (cell.rel & 1) {\n                        cell.col -= options.col;\n                    }\n                    if (cell.rel & 2) {\n                        cell.row -= options.row;\n                    }\n                    return cell;\n                }\n                : identity;\n\n            var addPos = options.forEditor\n                ? function(thing, startToken, endToken) {\n                    thing.begin = startToken.begin;\n                    thing.end = endToken.end;\n                    return thing;\n                }\n                : identity;\n\n            return {\n                peek  : peek,\n                next  : next,\n                croak : input.croak,\n                eof   : input.eof,\n                is    : is\n            };\n\n            function is(type, value) {\n                var tok = peek();\n                return tok != null\n                    && (type == null || tok.type === type)\n                    && (value == null || tok.value === value)\n                    ? tok : null;\n            }\n\n            function peek() {\n                if (token == null) {\n                    token = readNext();\n                }\n                return token;\n            }\n\n            function next() {\n                if (token != null) {\n                    var tmp = token;\n                    token = null;\n                    return tmp;\n                }\n                return readNext();\n            }\n\n            function readNext() {\n                var ret;\n                var t = input.peek();\n                if (t) {\n                    if (t.type == \"sym\" || t.type == \"rc\" || t.type == \"num\") {\n                        ret =  ahead(8, refRange3D)\n                            || ahead(6, refCell3D)\n                            || ahead(6, refSheetRange)\n                            || ahead(4, refSheetCell)\n                            || ahead(4, refRange)\n                            || ahead(2, refCell)\n                            || ahead(2, funcall);\n                    }\n                    if (!ret) {\n                        ret = input.next();\n                    }\n                }\n                return ret;\n            }\n\n            function toCell(tok, isFirst) {\n                if (tok.type == \"rc\") {\n                    // RC notation is read properly without knowing where\n                    // we are, so no need to fixCell on this one.\n                    // However, if only absolute refs were asked for (from\n                    // i.e. parseReference) I feel it's alright to yell\n                    // about it here.\n                    if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                        input.croak(\"Cannot read relative cell in RC notation\");\n                    }\n                    return new CellRef$3(tok.row, tok.col, tok.rel);\n                }\n                if (tok.type == \"num\") {\n                    if (tok.value <= 1048577) {\n                        // whole row\n                        return fixCell(new CellRef$3(\n                            getrow(tok.value),\n                            isFirst ? -Infinity : +Infinity,\n                            2\n                        ));\n                    } else {\n                        return null;\n                    }\n                }\n                // otherwise it's \"sym\".  The OOXML spec (SpreadsheetML\n                // 18.2.5) defines the maximum value to be interpreted as\n                // a cell reference to be XFD1048576.\n                var name = tok.value;\n                var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n                if (m) {\n                    var row = getrow(m[4]), col = getcol(m[2]);\n                    if (row <= 1048576 && col <= 16383) {\n                        return fixCell(new CellRef$3(\n                            getrow(m[4]),\n                            getcol(m[2]),\n                            (m[1] ? 0 : 1) | (m[3] ? 0 : 2)\n                        ));\n                    } else {\n                        return null;\n                    }\n                }\n                var abs = name.charAt(0) == \"$\";\n                if (abs) {\n                    name = name.substr(1);\n                }\n                if (/^\\d+$/.test(name)) {\n                    var row = getrow(name);\n                    if (row <= 1048576) {\n                        return fixCell(new CellRef$3(\n                            getrow(name),\n                            isFirst ? -Infinity : +Infinity,\n                            (abs ? 0 : 2)\n                        ));\n                    }\n                } else {\n                    var col = getcol(name);\n                    if (col <= 16383) {\n                        return fixCell(new CellRef$3(\n                            isFirst ? -Infinity : +Infinity,\n                            getcol(name),\n                            (abs ? 0 : 1)\n                        ));\n                    }\n                }\n            }\n\n            // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) :(f) C3(g) not followed by paren (h)\n            function refRange3D(a, b, c, d, e, f, g, h) {\n                if (a.type == \"sym\" &&\n                    b.type == \"op\" && b.value == \":\" &&\n                    c.type == \"sym\" &&\n                    d.type == \"punc\" && d.value == \"!\" &&\n                    (e.type == \"sym\" || e.type == \"rc\" || (e.type == \"num\" && e.value == e.value|0)) &&\n                    f.type == \"op\" && f.value == \":\" &&\n                    (g.type == \"sym\" || g.type == \"rc\" || (g.type == \"num\" && g.value == g.value|0)) &&\n                    g.type == e.type &&\n                    !(h.type == \"punc\" && h.value == \"(\" && !g.space))\n                {\n                    var tl = toCell(e, true), br = toCell(g, false);\n                    if (tl && br) {\n                        // skip them except the last one, we only wanted to\n                        // ensure it's not paren.\n                        skip(7);\n                        return addPos(new RangeRef$2(\n                            tl.setSheet(a.value, true),\n                            br.setSheet(c.value, true)\n                        ).setSheet(a.value, true), a, g);\n                    }\n                }\n            }\n\n            // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) not followed by paren (f)\n            function refCell3D(a, b, c, d, e, f) {\n                if (a.type == \"sym\" &&\n                    b.type == \"op\" && b.value == \":\" &&\n                    c.type == \"sym\" &&\n                    d.type == \"punc\" && d.value == \"!\" &&\n                    (e.type == \"sym\" || e.type == \"rc\" || (e.type == \"num\" && e.value == e.value|0)) &&\n                    !(f.type == \"punc\" && f.value == \"(\" && !e.space))\n                {\n                    var tl = toCell(e);\n                    if (tl) {\n                        skip(5);\n                        var br = tl.clone();\n                        return addPos(new RangeRef$2(\n                            tl.setSheet(a.value, true),\n                            br.setSheet(c.value, true)\n                        ).setSheet(a.value, true), a, e);\n                    }\n                }\n            }\n\n            // Sheet1(a) !(b) A1(c) :(d) C3(e) not followed by paren (f)\n            function refSheetRange(a, b, c, d, e, f) {\n                if (a.type == \"sym\" &&\n                    b.type == \"punc\" && b.value == \"!\" &&\n                    (c.type == \"sym\" || c.type == \"rc\" || (c.type == \"num\" && c.value == c.value|0)) &&\n                    d.type == \"op\" && d.value == \":\" &&\n                    (e.type == \"sym\" || e.type == \"rc\" || (e.type == \"num\" && e.value == e.value|0)) &&\n                    !(f.type == \"punc\" && f.value == \"(\" && !e.space))\n                {\n                    var tl = toCell(c, true), br = toCell(e, false);\n                    if (tl && br) {\n                        skip(5);\n                        return addPos(new RangeRef$2(tl, br).setSheet(a.value, true), a, e);\n                    }\n                }\n            }\n\n            // Sheet1(a) !(b) A1(c) not followed by paren (d)\n            function refSheetCell(a, b, c, d) {\n                if (a.type == \"sym\" &&\n                    b.type == \"punc\" && b.value == \"!\" &&\n                    (c.type == \"sym\" || c.type == \"rc\" || (c.type == \"num\" && c.value == c.value|0)) &&\n                    !(d.type == \"punc\" && d.value == \"(\" && !c.space))\n                {\n                    skip(3);\n                    var x = toCell(c);\n                    if (!x || !isFinite(x.row)) {\n                        x = new NameRef$2(c.value);\n                    }\n                    return addPos(x.setSheet(a.value, true), a, c);\n                }\n            }\n\n            // A1(a) :(b) C3(c) not followed by paren (d)\n            function refRange(a, b, c, d) {\n                if ((a.type == \"sym\" || a.type == \"rc\" || (a.type == \"num\" && a.value == a.value|0)) &&\n                    (b.type == \"op\" && b.value == \":\") &&\n                    (c.type == \"sym\" || c.type == \"rc\" || (c.type == \"num\" && c.value == c.value|0)) &&\n                    !(d.type == \"punc\" && d.value == \"(\" && !c.space))\n                {\n                    var tl = toCell(a, true), br = toCell(c, false);\n                    if (tl && br) {\n                        skip(3);\n                        return addPos(new RangeRef$2(tl, br), a, c);\n                    }\n                }\n            }\n\n            // A1(a) not followed by paren (b)\n            function refCell(a, b) {\n                if ((a.type == \"sym\" || a.type == \"rc\") && !(b.type == \"punc\" && b.value == \"(\" && !a.space)) {\n                    var x = toCell(a);\n                    if (x && isFinite(x.row) && isFinite(x.col)) {\n                        skip(1);\n                        return addPos(x, a, a);\n                    }\n                }\n            }\n\n            function funcall(a, b) {\n                if (a.type == \"sym\" && b.type == \"punc\" && b.value == \"(\" && !a.space) {\n                    a.type = \"func\";\n                    skip(1);\n                    return a;       // already has position\n                }\n            }\n        }\n\n        function isWhitespace(ch) {\n            return \" \\t\\r\\n\\xa0\\u200b\".indexOf(ch) >= 0;\n        }\n\n        var EOF = { type: \"eof\" };\n\n        function RawTokenStream(input, options) {\n            var tokens = [], index = 0;\n            var readWhile = input.readWhile;\n\n            return {\n                next  : next,\n                peek  : peek,\n                eof   : eof,\n                croak : input.croak,\n                ahead : ahead,\n                skip  : skip\n            };\n\n            function isDigit(ch) {\n                return (/[0-9]/i.test(ch));\n            }\n\n            function isIdStart(ch) {\n                return (/[a-z$_]/i.test(ch) || util$2.isUnicodeLetter(ch));\n            }\n\n            function isId(ch) {\n                return isIdStart(ch) || isDigit(ch) || ch == \".\";\n            }\n\n            function isOpChar(ch) {\n                return ch in OPERATORS;\n            }\n\n            function isPunc(ch) {\n                return \"\\\\!;(){}[]\".indexOf(ch) >= 0;\n            }\n\n            function readNumber() {\n                // XXX: TODO: exponential notation\n                var has_dot = false;\n                var number = readWhile(function(ch){\n                    if (ch == SEPARATORS.DEC) {\n                        if (has_dot) {\n                            return false;\n                        }\n                        has_dot = true;\n                        return true;\n                    }\n                    return isDigit(ch);\n                });\n                if (number == SEPARATORS.DEC) {\n                    return { type: \"punc\", value: SEPARATORS.DEC };\n                } else {\n                    return { type: \"num\", value: parseFloat(number.replace(SEPARATORS.DEC, \".\")) };\n                }\n            }\n\n            function symbol(id, quote) {\n                return {\n                    type  : \"sym\",\n                    value : id,\n                    upper : id.toUpperCase(),\n                    space : isWhitespace(input.peek()),\n                    quote : quote\n                };\n            }\n\n            function getRC(a, b, c) {\n                if (!a && !b && !c) {\n                    return null;\n                }\n                if ((!a && !c) || (a && c)) {\n                    var num = b ? parseInt(b, 10) : 0;\n                    return a ? num : num - 1;\n                }\n            }\n\n            function readSymbol() {\n                var m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n                if (m) {\n                    var row = getRC(m[1], m[2], m[3]);\n                    var col = getRC(m[4], m[5], m[6]);\n                    if (row != null && col != null) {\n                        input.skip(m);\n                        return {\n                            type: \"rc\",\n                            row: row,\n                            col: col,\n                            rel: ((m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) // col\n                                  |\n                                  (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0) // row\n                                 )\n                        };\n                    }\n                }\n                return symbol(readWhile(isId));\n            }\n\n            function readString() {\n                input.next();\n                return { type: \"str\", value: input.readEscaped('\"') };\n            }\n\n            function readSheetName() {\n                input.next();\n                return symbol(input.readEscaped(\"'\"), true);\n            }\n\n            function readOperator() {\n                return {\n                    type  : \"op\",\n                    value : readWhile(function(ch, op){\n                        return (op + ch) in OPERATORS;\n                    })\n                };\n            }\n\n            function readPunc() {\n                return {\n                    type  : \"punc\",\n                    value : input.next()\n                };\n            }\n\n            function readNext() {\n                if (input.eof()) {\n                    return null;\n                }\n                var ch = input.peek(), m;\n                if (ch == '\"') {\n                    return readString();\n                }\n                if (ch == \"'\") {\n                    return readSheetName();\n                }\n                if (isDigit(ch) || ch == SEPARATORS.DEC) {\n                    return readNumber();\n                }\n                if (isIdStart(ch)) {\n                    return readSymbol();\n                }\n                if (isOpChar(ch)) {\n                    return readOperator();\n                }\n                if (isPunc(ch)) {\n                    return readPunc();\n                }\n                if ((m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i))) {\n                    input.skip(m);\n                    return { type: \"error\", value: m[1] };\n                }\n                if (!options.forEditor) {\n                    input.croak(\"Can't handle character with code: \" + ch.charCodeAt(0));\n                }\n                return { type: \"error\", value: input.next() };\n            }\n\n            function peek() {\n                while (tokens.length <= index) {\n                    readWhile(isWhitespace);\n                    var begin = input.pos();\n                    var tok = readNext();\n                    if (options.forEditor && tok) {\n                        tok.begin = begin;\n                        tok.end = input.pos();\n                    }\n                    tokens.push(tok);\n                }\n                return tokens[index];\n            }\n\n            function next() {\n                var tok = peek();\n                if (tok) {\n                    index++;\n                }\n                return tok;\n            }\n\n            function ahead(n, f) {\n                var pos = index, a = [];\n                while (n-- > 0) {\n                    a.push(next() || EOF);\n                }\n                index = pos;\n                return f.apply(a, a);\n            }\n\n            function skip(n) {\n                index += n;\n            }\n\n            function eof() {\n                return peek() == null;\n            }\n        }\n\n        function InputStream(input) {\n            var pos = 0, line = 1, col = 0;\n            return {\n                next        : next,\n                peek        : peek,\n                eof         : eof,\n                croak       : croak,\n                readWhile   : readWhile,\n                readEscaped : readEscaped,\n                lookingAt   : lookingAt,\n                skip        : skip,\n                forward     : forward,\n                pos         : location\n            };\n            function location() {\n                return pos;\n            }\n            function next() {\n                var ch = input.charAt(pos++);\n                if (ch == \"\\n\") {\n                    line++;\n                    col = 0;\n                } else {\n                    col++;\n                }\n                return ch;\n            }\n            function peek() {\n                return input.charAt(pos);\n            }\n            function eof() {\n                return peek() === \"\";\n            }\n            function croak(msg) {\n                throw new ParseError(msg + \" (input: \" + input + \")\", pos);\n            }\n            function skip(ch) {\n                if (typeof ch == \"string\") {\n                    if (input.substr(pos, ch.length) != ch) {\n                        croak(\"Expected \" + ch);\n                    }\n                    forward(ch.length);\n                } else if (ch instanceof RegExp) {\n                    var m = ch.exec(input.substr(pos));\n                    if (m) {\n                        forward(m[0].length);\n                        return m;\n                    }\n                } else {\n                    // assuming RegExp match data\n                    forward(ch[0].length);\n                }\n            }\n            function forward(n) {\n                while (n-- > 0) {\n                    next();\n                }\n            }\n            function readEscaped(end) {\n                var escaped = false, str = \"\";\n                while (!eof()) {\n                    var ch = next();\n                    if (escaped) {\n                        str += ch;\n                        escaped = false;\n                    } else if (ch == \"\\\\\") {\n                        escaped = true;\n                    } else if (ch == end) {\n                        break;\n                    } else {\n                        str += ch;\n                    }\n                }\n                return str;\n            }\n            function readWhile(predicate) {\n                var str = \"\";\n                while (!eof() && predicate(peek(), str)) {\n                    str += next();\n                }\n                return str;\n            }\n            function lookingAt(rx) {\n                return rx.exec(input.substr(pos));\n            }\n        }\n\n        //// exports\n\n        var FORMAT_PARSERS = [];\n\n        var registerFormatParser = exports$1.registerFormatParser = function(p) {\n            FORMAT_PARSERS.push(p);\n        };\n\n        exports$1.parse = function(sheet, row, col, input, format) {\n            if (input instanceof Date) {\n                return { type: \"date\", value: runtime$4.dateToSerial(input) };\n            }\n            if (typeof input == \"number\") {\n                return { type: \"number\", value: input };\n            }\n            if (typeof input == \"boolean\") {\n                return { type: \"boolean\", value: input };\n            }\n            input += \"\";\n            if (/^'/.test(input)) {\n                return {\n                    type: \"string\",\n                    value: input.substr(1)\n                };\n            }\n            // trivial (integer) percent values; more complex formats are handled below via\n            // registerFormatParser; this case could be dropped completely.\n            if (/^-?[0-9]+%$/.test(input)) {\n                var str = input.substr(0, input.length - 1);\n                var num = parseFloat(str);\n                if (!isNaN(num) && num == str) {\n                    return {\n                        type: \"percent\",\n                        value: num / 100\n                    };\n                }\n            }\n            if (/^=/.test(input)) {\n                input = input.substr(1);\n                if (/\\S/.test(input)) {\n                    return parseFormula(sheet, row, col, input);\n                } else {\n                    return {\n                        type: \"string\",\n                        value: \"=\" + input\n                    };\n                }\n            }\n            for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n                var result = FORMAT_PARSERS[i](input, format);\n                if (result) {\n                    return result;\n                }\n            }\n            if (input.toLowerCase() == \"true\") {\n                return { type: \"boolean\", value: true };\n            }\n            if (input.toLowerCase() == \"false\") {\n                return { type: \"boolean\", value: false };\n            }\n            var date = runtime$4.parseDate(input, format);\n            if (date) {\n                return { type: \"date\", value: runtime$4.dateToSerial(date) };\n            }\n            var num = parseFloat(input);\n            if (!isNaN(num) && input.length > 0 && num == input) {\n                format = null;\n                if (num != Math.floor(num)) {\n                    format = \"0.\" + String(num).split(\".\")[1].replace(/\\d/g, \"0\");\n                }\n                return {\n                    type: \"number\",\n                    value: num,\n                    format: format\n                };\n            }\n            return {\n                type: \"string\",\n                value: input\n            };\n        };\n\n        function tokenize(input, row, col) {\n            var tokens = [];\n            input = TokenStream$1(input, { forEditor: true, row: row, col: col });\n            while (!input.eof()) {\n                tokens.push(next());\n            }\n            var tok = tokens[0];\n            if (tok.type == \"op\" && tok.value == \"=\") {\n                tok.type = \"startexp\";\n            }\n            return tokens;\n\n            function next() {\n                var tok = input.next();\n                if (tok.type == \"sym\") {\n                    if (tok.upper == \"TRUE\") {\n                        tok.type = \"bool\";\n                        tok.value = true;\n                    } else if (tok.upper == \"FALSE\") {\n                        tok.type = \"bool\";\n                        tok.value = false;\n                    }\n                } else if (tok.type == \"ref\") {\n                    tok = {\n                        type  : \"ref\",\n                        ref   : (row != null && col != null ? tok.absolute(row, col) : tok),\n                        begin : tok.begin,\n                        end   : tok.end\n                    };\n                }\n                return tok;\n            }\n        }\n\n        // The `sqref` attribute in dataValidation (XLSX) will contain a space-separated list of\n        // references.  This helper is called from excel-reader.js to parse them.\n        function parseSqref(input, row, col) {\n            row = row || 0;\n            col = col || 0;\n            input = TokenStream$1(input, { row: row, col: col });\n            var refs = [];\n            while (!input.eof()) {\n                var ref = input.next();\n                if (ref.type != \"ref\") {\n                    throw new ParseError(\"Expecting a reference but got: \" + JSON.stringify(ref));\n                }\n                refs.push(ref.absolute(row, col));\n            }\n            return refs;\n        }\n\n        exports$1.parseNameDefinition = parseNameDefinition;\n        exports$1.parseFormula = parseFormula;\n        exports$1.parseReference = parseReference$1;\n        exports$1.compile = makeFormula;\n        exports$1.parseSqref = parseSqref;\n\n        exports$1.InputStream = InputStream;\n        exports$1.ParseError = ParseError;\n        exports$1.tokenize = tokenize;\n\n        /* -----[ a few special formats ]----- */\n\n        // various time formats\n        registerFormatParser(function(input, existingFormat){\n            var m, date = 0, format = \"\";\n            // have date part?\n            if (!existingFormat) {\n                existingFormat = kendo.culture().calendar.patterns.d;\n            }\n            if ((m = /^(\\d+)([-/.])(\\d+)\\2(\\d{2}(?:\\d{2})?)(\\s*)/.exec(input))) {\n                var mo = parseInt(m[1], 10);\n                var sep = m[2];\n                var da = parseInt(m[3], 10);\n                var yr = parseInt(m[4], 10);\n                if (yr < 30) {\n                    yr += 2000;\n                } else if (yr < 100) {\n                    yr += 1900;\n                }\n                var monthFirst = existingFormat ? existingFormat.indexOf(\"M\") < existingFormat.indexOf(\"d\") : true;\n                if (mo > 12 || !monthFirst) {\n                    var tmp = mo;\n                    mo = da;\n                    da = tmp;\n                    monthFirst = false;\n                }\n                if (!runtime$4.validDate(yr, mo, da)) {\n                    return null;\n                }\n                date = runtime$4.packDate(yr, mo - 1, da);\n                if (date < 0) { date--; }\n                if (monthFirst) {\n                    format = [\"mm\", \"dd\", \"yyyy\"].join(sep);\n                } else {\n                    format = [\"dd\", \"mm\", \"yyyy\"].join(sep);\n                }\n                format += m[5];\n                input = input.substr(m[0].length); // skip the date\n            }\n            // hh:mm\n            if ((m = /^(\\d+):(\\d+)$/.exec(input))) {\n                var hh = parseInt(m[1], 10);\n                var mm = parseInt(m[2], 10);\n                return {\n                    type   : \"date\",\n                    format : format + \"hh:mm\",\n                    value  : date + runtime$4.packTime(hh, mm, 0, 0)\n                };\n            }\n            // mm:ss.ms\n            if ((m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n                var mm = parseInt(m[1], 10);\n                var ss = parseInt(m[2], 10);\n                var ms = parseFloat(m[3]) * 1000;\n                return {\n                    type   : \"date\",\n                    format : format + \"mm:ss.00\",\n                    value  : date + runtime$4.packTime(0, mm, ss, ms)\n                };\n            }\n            // hh:mm:ss\n            if ((m = /^(\\d+):(\\d+):(\\d+)$/.exec(input))) {\n                var hh = parseInt(m[1], 10);\n                var mm = parseInt(m[2], 10);\n                var ss = parseInt(m[3], 10);\n                return {\n                    type   : \"date\",\n                    format : format + \"hh:mm:ss\",\n                    value  : date + runtime$4.packTime(hh, mm, ss, 0)\n                };\n            }\n            // hh:mm:ss.ms\n            if ((m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n                var hh = parseInt(m[1], 10);\n                var mm = parseInt(m[2], 10);\n                var ss = parseInt(m[3], 10);\n                var ms = parseFloat(m[4]) * 1000;\n                return {\n                    type   : \"date\",\n                    format : format + \"hh:mm:ss.00\",\n                    value  : date + runtime$4.packTime(hh, mm, ss, ms)\n                };\n            }\n        });\n\n        // Support numeric formats with thousands separator and/or currency symbol, like `1,234,567.00`,\n        // `$1234`, `123,456.78 $` etc.  I apologize for this code.\n        registerFormatParser(function(input){\n            var m, n;\n            var culture = kendo.culture();\n            var comma = culture.numberFormat[\",\"];\n            var dot = culture.numberFormat[\".\"];\n            var currency = culture.numberFormat.currency.symbol;\n            var rxnum = getNumberRegexp(comma, dot);\n            var rxcur = new RegExp(\"^\\\\s*\\\\\" + currency + \"\\\\s*\");\n            var sign = 1;\n            var format = \"\";\n            var suffix = \"\";\n            var has_currency = false;\n            var has_percent = false;\n\n            input = InputStream(input.replace(/^\\s+|\\s+$/g, \"\"));\n\n            // has minus before currency?\n            if (input.skip(/^-\\s*/)) {\n                sign = -1;\n            }\n\n            // has currency before number?\n            if ((m = input.skip(rxcur))) {\n                has_currency = true;\n                format += '\"' + m[0] + '\"';\n            }\n\n            // has minus after currency?\n            if (input.skip(/^-\\s*/)) {\n                if (sign < 0) {\n                    return null;    // not a number\n                }\n                sign = -1;\n            }\n\n            // read the number itself\n            if (!(n = input.skip(rxnum))) {\n                return null;        // not a number\n            }\n            format += \"0\";\n\n            // has currency after number?\n            if ((m = input.skip(rxcur))) {\n                if (has_currency) {\n                    return null;    // either before or after, not both.\n                }\n                has_currency = true;\n                suffix = '\"' + m[0] + '\"';\n            }\n\n            // has percent after number?\n            if (!has_currency && (m = input.skip(/^\\s*%\\s*/))) {\n                has_percent = true;\n                suffix = m[0];      // no quotes this time, % is special in format\n            }\n\n            if (!input.eof()) {\n                return null;        // should anything else follow, not a number\n            }\n\n            if (n[2] || has_currency) {\n                format = format.replace(\"0\", \"#\");\n                format += \",0\";\n            }\n            if (n[3]) {\n                format += \".\" + repeat(\"0\", n[3].length - 1);\n            }\n            var value = n[0]\n                .replace(new RegExp(\"\\\\\" + comma, \"g\"), \"\")\n                .replace(new RegExp(\"\\\\\" + dot, \"g\"), \".\");\n\n            value = parseFloat(value);\n            if (has_percent) {\n                value /= 100;\n            }\n\n            format += suffix;\n            if (has_currency) {\n                format += ';-' + format;\n            }\n\n            return {\n                type: \"number\",\n                currency: has_currency,\n                format: format,\n                value: sign * value\n            };\n        });\n\n        registerFormatParser(function(input){\n            var m;\n            if ((m = /^([0-9]*)\\.([0-9]+)(\\s*%)$/.exec(input))) {\n                return {\n                    type: \"number\",\n                    value: parseFloat(input) / 100,\n                    format: \"0.\" + repeat(\"0\", m[2].length) + m[3]\n                };\n            }\n        });\n\n        var NUMBER_FORMAT_RX = {};\n        function getNumberRegexp(comma, dot) {\n            var id = comma + dot;\n            var rx = NUMBER_FORMAT_RX[id];\n            if (!rx) {\n                rx = \"^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)\";\n                rx = rx.replace(/DOT/g, \"\\\\\" + dot).replace(/COM/g, \"\\\\\" + comma);\n                rx = new RegExp(rx);\n                NUMBER_FORMAT_RX[id] = rx;\n            }\n            return rx;\n        }\n\n        function repeat(str, len) {\n            var out = \"\";\n            while (len-- > 0) {\n                out += str;\n            }\n            return out;\n        }\n\n    \"use strict\";\n\n        /* global JSZip */\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n\n        var $$1 = kendo.jQuery;\n        var parseXML = kendo.util.parseXML;\n        var parseReference = kendo.spreadsheet.calc.parseReference;\n\n        var MAP_EXCEL_OPERATOR = {\n            // includes only what differs; key is Excel's operator, value\n            // is our operator.\n            greaterThanOrEqual : \"greaterThanOrEqualTo\",\n            lessThanOrEqual    : \"lessThanOrEqualTo\"\n        };\n\n        var ERROR_LOG = null;\n\n        function readExcel(file, workbook, deferred) {\n            var reader = new FileReader();\n            reader.onload = async function(e) {\n                JSZip.loadAsync(e.target.result)\n                    .then(async zip => await readWorkbook(zip, workbook, deferred));\n            };\n            reader.readAsArrayBuffer(file);\n        }\n\n        var SEL_CELL = [\"sheetData\", \"row\", \"c\"];\n        var SEL_COL = [\"cols\", \"col\"];\n        var SEL_DEFINED_NAME = [\"definedNames\", \"definedName\"];\n        var SEL_FORMULA = [\"sheetData\", \"row\", \"c\", \"f\"];\n        var SEL_MERGE = [\"mergeCells\", \"mergeCell\"];\n        var SEL_PANE = [\"sheetViews\", \"sheetView\", \"pane\"];\n        var SEL_ROW = [\"sheetData\", \"row\"];\n        var SEL_SELECTION = [\"sheetViews\", \"sheetView\", \"selection\"];\n        var SEL_SHEET = [\"sheets\", \"sheet\"];\n        var SEL_STRING = [\"sheetData\", \"row\", \"c\", \"is\"];\n        var SEL_TEXT = [\"t\"];\n        var SEL_SHARED_STRING = [\"si\"];\n        var SEL_VALUE = [\"sheetData\", \"row\", \"c\", \"v\"];\n        var SEL_VIEW = [\"bookViews\", \"workbookView\"];\n        var SEL_SHEET_VIEW = [\"sheetViews\", \"sheetView\"];\n        var SEL_HYPERLINK = [\"hyperlinks\", \"hyperlink\"];\n        var SEL_PROTECTION = [\"sheetProtection\"];\n\n        /* A validation section looks like this:\n         *\n         * <dataValidations count=\"1\">\n         *   <dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\" sqref=\"B2\">\n         *     <formula1>$E$2:$E$5</formula1>\n         *   </dataValidation>\n         * </dataValidations>\n         */\n        var SEL_VALIDATION = [\"dataValidations\", \"dataValidation\"];\n        var SEL_VALIDATION_FORMULA1 = [\"dataValidations\", \"dataValidation\", \"formula1\"];\n        var SEL_VALIDATION_FORMULA2 = [\"dataValidations\", \"dataValidation\", \"formula2\"];\n\n        /* However, when a validation formula in one sheet references\n         * cells from another sheet, Excel produces this version instead:\n         *\n         * <extLst>\n         *   <ext xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" uri=\"{CCE6A557-97BC-4b89-ADB6-D9C93CAAB3DF}\">\n         *     <x14:dataValidations xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\" count=\"1\">\n         *       <x14:dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\">\n         *         <x14:formula1>\n         *           <xm:f>Sheet2!$B$3:$B$6</xm:f>\n         *         </x14:formula1>\n         *         <xm:sqref>B1</xm:sqref>\n         *       </x14:dataValidation>\n         *     </x14:dataValidations>\n         *   </ext>\n         * </extLst>\n         *\n         * I call it the \"insane version\", because that's what it is.\n         * Barring the case that the engineers who produced this horror\n         * were on LSD, the only plausible reason for it is that Microsoft\n         * does not want third party software to be compatible with Excel\n         * (sentiment I've had over and over while working on the\n         * Spreadsheet widget).\n         */\n        // XXX: technically, the aliases `x14` and `xm` below could be\n        // different, but Excel seems to be hard-coded on these; our\n        // parser does not support proper namespaces for now anyway, so\n        // hard-coded they are.\n        var SEL_VALIDATION_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\"];\n        var SEL_VALIDATION_SQREF_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"xm:sqref\"];\n        var SEL_VALIDATION_FORMULA1_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula1\", \"xm:f\"];\n        var SEL_VALIDATION_FORMULA2_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula2\", \"xm:f\"];\n\n        // comment selectors (in files like comments1.xml)\n        var SEL_COMMENT = [\"commentList\", \"comment\"];\n        var SEL_AUTHOR = [\"authors\", \"author\"];\n        var SEL_COMMENT_TEXT = [\"t\"];\n\n        function xl(file) {\n            if (!/^\\//.test(file)) {\n                if (!/^xl\\//.test(file)) {\n                    file = \"xl/\" + file;\n                }\n            } else {\n                file = file.substr(1);\n            }\n            return file;\n        }\n\n        async function readWorkbook(zip, workbook, progress) {\n            ERROR_LOG = workbook.excelImportErrors = [];\n\n            var strings = await readStrings(zip);\n            var relationships = await readRelationships(zip, \"_rels/workbook.xml\");\n            var theme = await readTheme(zip, relationships.byType.theme[0]);\n            var styles = await readStyles(zip, theme);\n            var items = [];\n            var activeSheet = 0;\n\n            await parse$1(zip, \"xl/workbook.xml\", {\n                enter: function(tag, attrs) {\n                    if (this.is(SEL_SHEET)) {\n                        var relId = attrs[\"r:id\"];\n                        var file = relationships.byId[relId];\n                        var name = attrs.name;\n                        var dim = sheetDimensions(relationships.bytes[file]);\n\n                        workbook.options.columnWidth = dim.columnWidth || workbook.options.columnWidth;\n                        workbook.options.rowHeight = dim.rowHeight || workbook.options.rowHeight;\n\n                        items.push({\n                            workbook: workbook,\n                            zip: zip,\n                            strings: strings,\n                            styles: styles,\n                            file: file,\n                            options: {\n                                name: name,\n                                rows: Math.max(workbook.options.rows || 0, dim.rows),\n                                columns: Math.max(workbook.options.columns || 0, dim.cols),\n                                columnWidth: dim.columnWidth,\n                                rowHeight: dim.rowHeight\n                            }\n                        });\n                    } else if (this.is(SEL_VIEW)) {\n                        if (attrs.activeTab) {\n                            activeSheet = integer(attrs.activeTab);\n                        }\n                    }\n                },\n                text: function(text) {\n                    var attrs = this.is(SEL_DEFINED_NAME);\n                    if (attrs && !(bool(attrs[\"function\"]) || bool(attrs.vbProcedure))) {\n                        var localSheetId = attrs.localSheetId;\n                        var sheet = null;\n                        if (localSheetId != null) {\n                            sheet = items[localSheetId].options.name;\n                        }\n                        var name = attrs.name;\n                        if (name != \"_xlnm._FilterDatabase\") {\n                            if (sheet) {\n                                name = \"'\" + sheet.replace(/\\'/g, \"\\\\'\") + \"'!\" + name;\n                            }\n                            withErrorLog(sheet, null, function(){\n                                workbook.defineName(name, text, bool(attrs.hidden));\n                            }, \"reading user-defined name: \" + name);\n                        }\n                    }\n                }\n            });\n\n            var loading = new $$1.Deferred();\n            loading.progress(function(args) {\n                if (progress) {\n                    progress.notify(args);\n                }\n            })\n            .then(function() {\n                var sheets = workbook.sheets();\n                recalcSheets(sheets);\n\n                workbook.activeSheet(sheets[activeSheet]);\n\n                if (progress) {\n                    progress.resolve();\n                }\n            });\n\n            loadSheets(items, workbook, loading);\n        }\n\n        function loadSheets(items, workbook, progress) {\n            var ready = (new $$1.Deferred()).resolve();\n            for (var i = 0; i < items.length; i++) {\n                (function(entry, i) {\n                    ready = ready.then(function() {\n                        var sheet = workbook.insertSheet(entry.options);\n                        sheet.suspendChanges(true);\n\n                        var promise = queueSheet(sheet, entry);\n                        var args = {\n                            sheet: sheet,\n                            progress: i / (items.length - 1)\n                        };\n\n                        promise.then(function() {\n                            progress.notify(args);\n                        });\n\n                        return promise;\n                    });\n                })(items[i], i);\n            }\n\n            ready.then(function() {\n                progress.resolve();\n            });\n        }\n\n        function queueSheet(sheet, ctx) {\n            var deferred = new $$1.Deferred();\n\n            setTimeout(async function() {\n                await readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n                deferred.resolve();\n            }, 0);\n\n            return deferred;\n        }\n\n        function recalcSheets(sheets) {\n            for (var i = 0; i < sheets.length; i++) {\n                sheets[i]\n                    .suspendChanges(false)\n                    .triggerChange({ recalc: true });\n            }\n        }\n\n        function sheetDimensions(bytes) {\n            var ref, dim = {\n                rows: 0,\n                cols: 0\n            };\n\n            parseXML(bytes, {\n                enter: function(tag, attrs) {\n                    if (tag == \"dimension\") {\n                        ref = parseReference(attrs.ref);\n                        if (ref.bottomRight) {\n                            dim.cols = ref.bottomRight.col + 1;\n                            dim.rows = ref.bottomRight.row + 1;\n                        }\n                    } else if (tag === \"sheetFormatPr\") {\n                        if (attrs.defaultColWidth) {\n                            dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                        }\n\n                        if (attrs.defaultRowHeight) {\n                            dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                        }\n                    } else if (this.is(SEL_ROW) && attrs.r) {\n                        dim.rows = Math.max(dim.rows, +attrs.r);\n                    } else if (this.is(SEL_CELL) && attrs.r) {\n                        ref = parseReference(attrs.r);\n                        dim.rows = Math.max(dim.rows, ref.row + 1);\n                        dim.cols = Math.max(dim.cols, ref.col + 1);\n                    }\n                }\n            });\n\n            return dim;\n        }\n\n        function toColWidth(size) {\n            // No font to compute agains, hence the magic number\n            var maximumDigitWidth = 7;\n\n            // The formula below is taken from the OOXML spec\n            var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n            return fraction * maximumDigitWidth;\n        }\n\n        function toRowHeight(pts) {\n            return pts * (4 / 3);\n        }\n\n        async function readSheet(zip, file, sheet, strings, styles) {\n            var sharedFormulas = {};\n            var ref, type, value, formula, formulaRange, isArrayFormula;\n            var nCols = sheet._columns._count;\n            var prevCellRef = null;\n            var relsFile = file.replace(/worksheets\\//, \"worksheets/_rels/\");\n            var relationships = await readRelationships(zip, relsFile);\n            var formula1, formula2;\n\n            var filterRef;\n            var filterColumn;\n            var customFilterLogic;\n            var customFilterCriteria;\n            var valueFilterBlanks;\n            var valueFilterValues;\n            var filters = [];\n            var deferredStyles = [];\n\n            ERROR_LOG = sheet._workbook.excelImportErrors;\n\n            file = xl(file);\n\n            await parse$1(zip, file, {\n                enter: function(tag, attrs, closed) {\n                    var tmp;\n                    if (this.is(SEL_FORMULA)) {\n                        if (closed) {\n                            if (attrs.t == \"shared\" && attrs.si != null) {\n                                formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                            }\n                        }\n                    }\n                    else if (this.is(SEL_CELL)) {\n                        value = null;\n                        formula = null;\n                        ref = attrs.r;\n                        formulaRange = null;\n\n                        if (ref == null) {\n                            // apparently some tools omit the `r` for\n                            // consecutive cells in a row, so we'll figure\n                            // it out from the previous cell's reference.\n                            // XXX: this could be slightly optimized by\n                            // keeping it parsed instead of stringifying\n                            // it to parse it again later.\n                            ref = parseReference(prevCellRef);\n                            ref.col++;\n                            ref = ref.toString();\n                        }\n                        prevCellRef = ref;\n\n                        // XXX: can't find no type actually, so everything is\n                        // interpreted as string.  Additionally, cells having\n                        // a formula will contain both <f> and <v> nodes,\n                        // which makes the value take precedence because it's\n                        // the second node; hence, the hack is to keep note of\n                        // them in the `text` handler, and apply the\n                        // appropriate one in the `leave` handler below.\n                        type = attrs.t;\n\n                        var styleIndex = attrs.s;\n                        if (styleIndex != null) {\n                            deferredStyles.push({ ref: ref,  sty: +styleIndex });\n                        }\n                    }\n                    else if (this.is(SEL_MERGE)) {\n                        sheet.range(attrs.ref).merge();\n                    }\n                    else if (this.is(SEL_COL)) {\n                        var start = integer(attrs.min) - 1;\n                        var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                        var width;\n                        if (attrs.width) {\n                            width = toColWidth(parseFloat(attrs.width));\n                            if (width !== 0) {\n                                sheet._columns.values.value(start, stop, width);\n                            }\n                        }\n                        if (attrs.hidden === \"1\" || width === 0) {\n                            for (var ci = start; ci <= stop; ci++) {\n                                sheet.hideColumn(ci);\n                            }\n                        }\n                        if (attrs.style != null) {\n                            // apply style on a whole range of columns\n                            deferredStyles.unshift({\n                                ref: new kendo.spreadsheet.RangeRef(\n                                    new kendo.spreadsheet.CellRef(-Infinity, start),\n                                    new kendo.spreadsheet.CellRef(+Infinity, stop)\n                                ),\n                                sty: +attrs.style\n                            });\n                        }\n                    }\n                    else if (this.is(SEL_ROW)) {\n                        var row = integer(attrs.r) - 1;\n                        var height;\n                        if (attrs.ht) {\n                            height = toRowHeight(parseFloat(attrs.ht));\n                            if (height !== 0) {\n                                sheet._rows.values.value(row, row, height);\n                            }\n                        }\n                        if (attrs.hidden === \"1\" || height === 0) {\n                            sheet.hideRow(row);\n                        }\n                    }\n                    else if (this.is(SEL_SELECTION)) {\n                        if (attrs.activeCell) {\n                            var acRef = parseReference(attrs.activeCell);\n                            sheet.select(acRef, true);\n                        }\n                    }\n                    else if (this.is(SEL_PANE)) {\n                        if (attrs.state && attrs.state.indexOf(\"frozen\") > -1) {\n                            if (attrs.xSplit) {\n                                sheet.frozenColumns(integer(attrs.xSplit));\n                            }\n\n                            if (attrs.ySplit) {\n                                sheet.frozenRows(integer(attrs.ySplit));\n                            }\n                        }\n                    }\n                    else if (this.is(SEL_SHEET_VIEW)) {\n                        sheet.showGridLines(bool(attrs.showGridLines, true));\n                    }\n                    else if (this.is(SEL_HYPERLINK)) {\n                        var relId = attrs[\"r:id\"];\n                        var target = relationships.byId[relId];\n                        if (target) {\n                            sheet.range(attrs.ref).link(target);\n                        }\n                    }\n                    else if (this.is(SEL_PROTECTION)) {\n                        if (attrs.sheet) {\n                            sheet.range(kendo.spreadsheet.SHEETREF).enable(false);\n                        }\n                    }\n                    else if (this.is([\"autoFilter\"])) {\n                        filterRef = attrs.ref;\n                        if (closed) {\n                            addAutoFilter();\n                        }\n                    }\n                    else if (filterRef) {\n                        if (this.is([\"filterColumn\"])) {\n                            filterColumn = parseInt(attrs.colId, 10);\n                        }\n                        else if (this.is([\"customFilters\"])) {\n                            customFilterLogic = bool(attrs.and) ? \"and\" : \"or\";\n                            customFilterCriteria = [];\n                        }\n                        else if (this.is([\"customFilter\"])) {\n                            tmp = getCustomFilter(attrs.operator, attrs.val);\n                            if (tmp) {\n                                customFilterCriteria.push({\n                                    operator: tmp.operator,\n                                    value: tmp.value\n                                });\n                            }\n                        }\n                        else if (this.is([\"dynamicFilter\"])) {\n                            filters.push({\n                                column: filterColumn,\n                                filter: new kendo.spreadsheet.DynamicFilter({\n                                    type: dynamicFilterType(attrs.type)\n                                })\n                            });\n                        }\n                        else if (this.is([\"top10\"])) {\n                            filters.push({\n                                column: filterColumn,\n                                filter: new kendo.spreadsheet.TopFilter({\n                                    value: getFilterVal(attrs.val),\n                                    type: (function(percent, top){\n                                        return percent && top ? \"topPercent\"\n                                            :  top ? \"topNumber\"\n                                            :  percent ? \"bottomPercent\"\n                                            :  \"bottomNumber\";\n                                    })(bool(attrs.percent), bool(attrs.top))\n                                })\n                            });\n                        }\n                        else if (this.is([\"filters\"])) {\n                            valueFilterBlanks = bool(attrs.blank);\n                            valueFilterValues = [];\n                        }\n                        else if (this.is([\"filter\"])) {\n                            valueFilterValues.push(getFilterVal(attrs.val));\n                        }\n                    }\n                },\n                leave: function(tag, attrs) {\n                    if (this.is(SEL_FORMULA)) {\n                        if (!formula && attrs.t == \"shared\" && attrs.si != null) {\n                            formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                        }\n                    }\n                    else if (this.is(SEL_CELL)) {\n                        if (formula != null) {\n                            var failed = withErrorLog(sheet, formulaRange || ref, function(){\n                                sheet.range(formulaRange || ref).formula(formula, isArrayFormula);\n                            }, \"parsing formula\");\n                            if (failed) {\n                                sheet.range(formulaRange || ref).value(formula)\n                                    .background(\"#ffaaaa\");\n                            }\n                        } else if (value != null) {\n                            var range = sheet.range(ref);\n\n                            if (!range._get(\"formula\")) {\n                                // Check for \"shared\" formulas before applying a value.\n                                if (!type || type == \"n\") {\n                                    value = parseFloat(value);\n                                } else if (type == \"s\") {\n                                    value = strings[integer(value)];\n                                } else if (type == \"b\") {\n                                    value = value === \"1\";\n                                } else if (type == \"d\") {\n                                    value = kendo.parseDate(value);\n                                }\n\n                                if (value != null) {\n                                    range.value(value);\n                                }\n                            }\n                        }\n                    } else if (this.is(SEL_VALIDATION) ||\n                               this.is(SEL_VALIDATION_INSANE)) {\n                        (function(){\n                            var refs = kendo.spreadsheet.calc.parseSqref(attrs.sqref);\n                            var type = attrs.type.toLowerCase();\n                            var operator = attrs.operator;\n                            if (/^(?:whole|decimal)$/.test(type)) {\n                                // we only support \"number\"\n                                type = \"number\";\n                            } else if (type == \"list\") {\n                                // there'll be no operator from Excel for lists\n                                operator = \"list\";\n                            }\n                            if (!operator && /^(?:number|date)$/.test(type)) {\n                                // Excel skips setting the operator for\n                                // \"between\", because why not.\n                                operator = \"between\";\n                            }\n                            refs.forEach(function(ref){\n                                withErrorLog(sheet, ref, function(){\n                                    sheet.range(ref).validation({\n                                        type             : bool(attrs.showErrorMessage, true) ? \"reject\" : \"warning\",\n                                        from             : formula1,\n                                        to               : formula2,\n                                        dataType         : type,\n                                        comparerType     : MAP_EXCEL_OPERATOR[operator] || operator,\n                                        allowNulls       : bool(attrs.allowBlank),\n                                        showButton       : bool(attrs.showDropDown) || type == \"date\" || type == \"list\",\n                                        messageTemplate  : attrs.error,\n                                        titleTemplate    : attrs.errorTitle\n                                    });\n                                }, \"parsing validation\");\n                            });\n                        })();\n                    } else if (tag == \"cols\") {\n                        sheet._columns._refresh();\n                    } else if (tag == \"sheetData\") {\n                        sheet._rows._refresh();\n                    } else if (tag == \"autoFilter\") {\n                        addAutoFilter();\n                    } else if (filterRef) {\n                        if (tag == \"customFilters\") {\n                            filters.push({\n                                column: filterColumn,\n                                filter: new kendo.spreadsheet.CustomFilter({\n                                    logic: customFilterLogic,\n                                    criteria: customFilterCriteria\n                                })\n                            });\n                        } else if (tag == \"filters\") {\n                            filters.push({\n                                column: filterColumn,\n                                filter: new kendo.spreadsheet.ValueFilter({\n                                    values: valueFilterValues,\n                                    blanks: valueFilterBlanks\n                                })\n                            });\n                        }\n                    }\n                },\n                text: function(text) {\n                    var attrs;\n                    if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                        value = text;\n                    } else if ((attrs = this.is(SEL_FORMULA))) {\n                        formula = text;\n                        isArrayFormula = attrs.t == \"array\";\n                        if (isArrayFormula) {\n                            formulaRange = attrs.ref;\n                        } else if (attrs.t == \"shared\") {\n                            sharedFormulas[attrs.si] = ref;\n                        }\n                    } else if (this.is(SEL_VALIDATION_FORMULA1) ||\n                               this.is(SEL_VALIDATION_FORMULA1_INSANE)) {\n                        formula1 = text;\n                    } else if (this.is(SEL_VALIDATION_FORMULA2) ||\n                               this.is(SEL_VALIDATION_FORMULA2_INSANE)) {\n                        formula2 = text;\n                    } else if (this.is(SEL_VALIDATION_SQREF_INSANE)) {\n                        // put it in <dataValidation>'s attributes where it should be\n                        this.stack[this.stack.length - 2].sqref = text;\n                    }\n                }\n            });\n\n            deferredStyles.forEach(({ ref, sty }) => applyStyle(sheet, ref, styles, sty));\n\n            if (relationships.byType.comments) {\n                var commentFile = relative_file(file, relationships.byType.comments[0]);\n                await readComments(zip, commentFile, sheet);\n            }\n\n            if (relationships.byType.drawing) {\n                var drawingFile = relative_file(file, relationships.byType.drawing[0]);\n                await readDrawings(zip, drawingFile, sheet);\n            }\n\n            function addAutoFilter() {\n                sheet.range(filterRef).filter(filters);\n                filterRef = null;\n            }\n        }\n\n        function getContentType(filename) {\n            var m = /\\.([^.]+)$/.exec(filename);\n            if (m && m[1]) {\n                return {\n                    jpg  : \"image/jpeg\",\n                    jpeg : \"image/jpeg\",\n                    png  : \"image/png\",\n                    gif  : \"image/gif\",\n                    wmf  : \"image/wmf\"\n                }[m[1].toLowerCase()];\n            }\n        }\n\n        function getFileName(filename) {\n            var m = /[^/]+$/.exec(filename);\n            return m && m[0];\n        }\n\n        async function readDrawings(zip, file, sheet) {\n            var sel_two_cell_anchor = [ \"xdr:twoCellAnchor\" ];\n            var sel_ext = [ \"xdr:ext\" ];\n            var sel_one_cell_anchor = [ \"xdr:oneCellAnchor\" ];\n            var sel_from = [ \"xdr:from\" ];\n            var sel_to = [ \"xdr:to\" ];\n            var sel_row = [ \"xdr:row\" ];\n            var sel_col = [ \"xdr:col\" ];\n            var sel_row_offset = [ \"xdr:rowOff\" ];\n            var sel_col_offset = [ \"xdr:colOff\" ];\n            var sel_blip = [ \"xdr:blipFill\", \"a:blip\" ];\n\n            var relsFile = file.replace(/drawings\\//, \"drawings/_rels/\");\n            var relationships = await readRelationships(zip, relsFile);\n\n            if (relationships.byType.image) {\n                let relkeys = Object.keys(relationships.byId);\n                for (let i = 0; i < relkeys.length; ++i) {\n                    let id = relkeys[i];\n                    let img = relative_file(file, relationships.byId[id]);\n                    let type = getContentType(img);\n                    if (type) {\n                        var data = await zip.file(img).async(\"arraybuffer\");\n                        var name = getFileName(img);\n                        var blob = name && !(kendo.support.browser.msie || kendo.support.browser.edge)\n                            ? new window.File([ data ], name, { type: type })\n                            : new window.Blob([ data ], { type: type });\n                        relationships.byId[id] = sheet._workbook.addImage(blob);\n                    }\n                }\n            }\n\n            var cdr, ref, width, height;\n            await parse$1(zip, file, {\n                enter: function(tag, attrs) {\n                    if (this.is(sel_two_cell_anchor) || this.is(sel_one_cell_anchor)) {\n                        cdr = {};\n                    }\n                    else if (this.is(sel_from) || this.is(sel_to)) {\n                        ref = {};\n                    }\n                    else if (this.is(sel_blip)) {\n                        var id = attrs[\"r:embed\"];\n                        cdr.image = relationships.byId[id];\n                    }\n                    else if (this.is(sel_ext)) {\n                        width = excelToPixels(parseFloat(attrs.cx));\n                        height = excelToPixels(parseFloat(attrs.cy));\n                    }\n                },\n                leave: function() {\n                    if (this.is(sel_from)) {\n                        cdr.topLeftCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                        cdr.offsetX = excelToPixels(ref.colOffset);\n                        cdr.offsetY = excelToPixels(ref.rowOffset);\n                    }\n                    else if (this.is(sel_to)) {\n                        cdr.brCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                        cdr.brX = excelToPixels(ref.colOffset);\n                        cdr.brY = excelToPixels(ref.rowOffset);\n                    }\n                    // Add drawing only when it is image\n                    else if (this.is(sel_two_cell_anchor) && cdr.image) {\n                        var left = sheet._columns.sum(0, cdr.topLeftCell.col - 1) + cdr.offsetX;\n                        var top = sheet._rows.sum(0, cdr.topLeftCell.row - 1) + cdr.offsetY;\n                        var right = sheet._columns.sum(0, cdr.brCell.col - 1) + cdr.brX;\n                        var bottom = sheet._rows.sum(0, cdr.brCell.row - 1) + cdr.brY;\n\n                        sheet.addDrawing({\n                            topLeftCell : cdr.topLeftCell,\n                            offsetX     : cdr.offsetX,\n                            offsetY     : cdr.offsetY,\n                            width       : width != null ? width : right - left,\n                            height      : height != null ? height : bottom - top,\n                            image       : cdr.image,\n                            opacity     : 1\n                        });\n                    }\n                    // Add drawing only when it is image\n                    else if (this.is(sel_one_cell_anchor) && cdr.image) {\n                        sheet.addDrawing({\n                            topLeftCell : cdr.topLeftCell,\n                            offsetX     : cdr.offsetX,\n                            offsetY     : cdr.offsetY,\n                            width       : width,\n                            height      : height,\n                            image       : cdr.image,\n                            opacity     : 1\n                        });\n                    }\n                },\n                text: function(text) {\n                    if (this.is(sel_row)) {\n                        ref.row = parseFloat(text);\n                    }\n                    else if (this.is(sel_col)) {\n                        ref.col = parseFloat(text);\n                    }\n                    else if (this.is(sel_row_offset)) {\n                        ref.rowOffset = parseFloat(text);\n                    }\n                    else if (this.is(sel_col_offset)) {\n                        ref.colOffset = parseFloat(text);\n                    }\n                }\n            });\n        }\n\n        async function readComments(zip, file, sheet) {\n            var authors = [];\n            var author;\n            var comment;\n            await parse$1(zip, file, {\n                enter: function(tag, attrs) {\n                    if (this.is(SEL_COMMENT)) {\n                        comment = {\n                            author: authors[attrs.authorId],\n                            ref: attrs.ref,\n                            text: \"\"\n                        };\n                    } else if (this.is(SEL_AUTHOR)) {\n                        author = \"\";\n                    }\n                },\n                leave: function() {\n                    if (this.is(SEL_COMMENT)) {\n                        sheet.range(comment.ref).comment(comment.text);\n                    } else if (this.is(SEL_AUTHOR)) {\n                        authors.push(author);\n                    }\n                },\n                text: function(text) {\n                    if (this.is(SEL_COMMENT_TEXT)) {\n                        comment.text += text;\n                    } else if (this.is(SEL_AUTHOR)) {\n                        author += text;\n                    }\n                }\n            });\n        }\n\n        function getCustomFilter(op, value) {\n            var ourOp = {\n                equal               : \"eq\",\n                notEqual            : \"ne\",\n                greaterThan         : \"gt\",\n                greaterThanOrEqual  : \"gte\",\n                lessThan            : \"lt\",\n                lessThanOrEqual     : \"lte\"\n            }[op];\n\n            value = getFilterVal(value);\n\n            if (ourOp && typeof value == \"number\") {\n                return { operator: ourOp, value: value };\n            }\n\n            if ((op == \"notEqual\" || !op) && typeof value == \"string\") {\n                // Excel text operators support * and ? wildcards.  Since\n                // our startswith/endswith/contains filters do not, we\n                // can't really use them here, so we'll apply the more\n                // generic \"matches\" and \"doesnotmatch\" filters.\n                return {\n                    operator: op ? \"doesnotmatch\" : \"matches\",\n                    value: value\n                };\n            }\n        }\n\n        function dynamicFilterType(type) {\n            return {\n                Q1  : \"quarter1\",\n                Q2  : \"quarter2\",\n                Q3  : \"quarter3\",\n                Q4  : \"quarter4\",\n                M1  : \"january\",\n                M2  : \"february\",\n                M3  : \"march\",\n                M4  : \"april\",\n                M5  : \"may\",\n                M6  : \"june\",\n                M7  : \"july\",\n                M8  : \"august\",\n                M9  : \"september\",\n                M10 : \"october\",\n                M11 : \"november\",\n                M12 : \"december\"\n            }[type.toUpperCase()] || type;\n        }\n\n        function getFilterVal(val) {\n            var tmp = parseFloat(val);\n            if (!isNaN(tmp) && tmp == val) {\n                return tmp;\n            }\n            return val;\n        }\n\n        function withErrorLog(sheet, ref, func, context) {\n            try {\n                func();\n                return false;\n            } catch(ex) {\n                var err = { context: context, error: String(ex) };\n                if (sheet && sheet.name) {\n                    err.sheet = sheet.name();\n                } else if (sheet) {\n                    err.sheet = sheet;\n                }\n                if (ref) {\n                    err.location = String(ref);\n                }\n                ERROR_LOG.push(err);\n                return true;\n            }\n        }\n\n        var BORDER_WIDTHS = {\n            \"none\"            : 0,\n            \"thin\"            : 1,\n            \"medium\"          : 2,\n            \"dashed\"          : 1,\n            \"dotted\"          : 1,\n            \"thick\"           : 3,\n            \"double\"          : 3,\n            \"hair\"            : 1,\n            \"mediumDashed\"    : 2,\n            \"dashDot\"         : 1,\n            \"mediumDashDot\"   : 2,\n            \"dashDotDot\"      : 1,\n            \"mediumDashDotDot\": 2,\n            \"slantDashDot\"    : 1\n        };\n\n        var DEFAULT_FORMATS = {\n            0  : \"General\",\n            1  : \"0\",\n            2  : \"0.00\",\n            3  : \"#,##0\",\n            4  : \"#,##0.00\",\n            9  : \"0%\",\n            10 : \"0.00%\",\n            11 : \"0.00E+00\",\n            12 : \"# ?/?\",\n            13 : \"# ??/??\",\n            14 : \"mm-dd-yy\",\n            15 : \"d-mmm-yy\",\n            16 : \"d-mmm\",\n            17 : \"mmm-yy\",\n            18 : \"h:mm AM/PM\",\n            19 : \"h:mm:ss AM/PM\",\n            20 : \"h:mm\",\n            21 : \"h:mm:ss\",\n            22 : \"m/d/yy h:mm\",\n            37 : \"#,##0 ;(#,##0)\",\n            38 : \"#,##0 ;[Red](#,##0)\",\n            39 : \"#,##0.00;(#,##0.00)\",\n            40 : \"#,##0.00;[Red](#,##0.00)\",\n            45 : \"mm:ss\",\n            46 : \"[h]:mm:ss\",\n            47 : \"mmss.0\",\n            48 : \"##0.0E+0\",\n            49 : \"@\"\n        };\n\n        function applyStyle(sheet, ref, styles, styleIndex) {\n            var range = sheet.range(ref);\n            var xf = styles.inlineStyles[styleIndex], base, value;\n            if (xf.xfId) {\n                base = styles.namedStyles[xf.xfId];\n            }\n            if (shouldSet(\"applyBorder\", \"borderId\")) {\n                setBorder(styles.borders[value]);\n            }\n            if (shouldSet(\"applyFont\", \"fontId\")) {\n                setFont(styles.fonts[value]);\n            }\n            if (shouldSet(\"applyAlignment\", \"textAlign\")) {\n                range.textAlign(value);\n            }\n            if (shouldSet(\"applyAlignment\", \"verticalAlign\")) {\n                range.verticalAlign(value);\n            }\n            if (shouldSet(\"applyAlignment\", \"indent\")) {\n                range.indent(value);\n            }\n            if (shouldSet(\"applyAlignment\", \"wrapText\")) {\n                // don't use range.wrap to avoid recomputing row height\n                range._property(\"wrap\", value);\n            }\n            if (shouldSet(\"applyFill\", \"fillId\")) {\n                setFill(styles.fills[value]);\n            }\n            if (shouldSet(\"applyNumberFormat\", \"numFmtId\")) {\n                setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n            }\n            if (shouldSet(\"applyProtection\", \"protection\")) {\n                range.enable(!xf.protection.locked);\n            }\n\n            function setFormat(f) {\n                var format = typeof f == \"string\" ? f : f.formatCode;\n                if (format != null && !/^general$/i.test(format)) {\n                    // XXX: drop locale info.\n                    // http://stackoverflow.com/questions/894805/excel-number-format-what-is-409\n                    // not supported by the formatting library.\n                    format = format.replace(/^\\[\\$-[0-9]+\\]/, \"\");\n                    range.format(format);\n                }\n            }\n\n            function setFill(f) {\n                if (f.type == \"solid\") {\n                    range.background(f.color);\n                }\n            }\n\n            function setFont(f) {\n                range.fontFamily(f.name);\n                //range.fontSize(f.size); //XXX: will recalc row height.\n                // converting from points to pixels\n                if (f.size) {\n                    range._property(\"fontSize\", f.size * 4 / 3);\n                }\n                if (f.bold) {\n                    range.bold(true);\n                }\n                if (f.italic) {\n                    range.italic(true);\n                }\n                if (f.underline) {\n                    range.underline(true);\n                }\n                if (f.color) {\n                    range.color(f.color);\n                }\n            }\n\n            function setBorder(b) {\n                function set(side, prop) {\n                    var border = b[side];\n                    if (!border) {\n                        return;\n                    }\n\n                    var width = BORDER_WIDTHS[border.style];\n                    if (!width) {\n                        return;\n                    }\n\n                    var color = border.color;\n                    if (color == null) {\n                        color = \"#000\";\n                    }\n\n                    var value = { size: width, color: color };\n                    if (side == \"diagonal\") {\n                        value.type = border.up << 1 | border.down;\n                    }\n\n                    range._property(prop, value);\n                }\n\n                set(\"left\", \"borderLeft\");\n                set(\"top\", \"borderTop\");\n                set(\"right\", \"borderRight\");\n                set(\"bottom\", \"borderBottom\");\n                set(\"diagonal\", \"dBorders\");\n            }\n\n            function shouldSet(applyName, propName) {\n                var t = xf[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = xf[propName];\n                if (base && value == null) {\n                    t = base[applyName];\n                    if (t != null && !t) {\n                        return false;\n                    }\n                    value = base[propName];\n                }\n                return value != null;\n            }\n        }\n\n        function parse$1(zip, file, callbacks) {\n            return new Promise(resolve => {\n                let obj = zip.file(file);\n                if (obj) {\n                    obj.async(\"uint8array\").then(bytes => {\n                        parseXML(bytes, callbacks);\n                        resolve();\n                    });\n                } else {\n                    resolve();\n                }\n            });\n        }\n\n        async function readStrings(zip) {\n            var strings = [];\n            var current = null;\n            await parse$1(zip, \"xl/sharedStrings.xml\", {\n                leave: function() {\n                    if (this.is(SEL_SHARED_STRING)) {\n                        strings.push(current);\n                        current = null;\n                    }\n                },\n                text: function(text) {\n                    if (this.is(SEL_TEXT)) {\n                        if (current == null) {\n                            current = \"\";\n                        }\n                        current += text;\n                    }\n                }\n            });\n            return strings;\n        }\n\n        async function readRelationships(zip, file) {\n            var map = { byId: {}, byType: { theme: [] }, bytes: {} };\n            await parse$1(zip, xl(file) + \".rels\", {\n                enter: function(tag, attrs) {\n                    if (tag == \"Relationship\") {\n                        map.byId[attrs.Id] = attrs.Target;\n\n                        var type = attrs.Type.match(/\\w+$/)[0];\n                        var entries = map.byType[type] || [];\n                        entries.push(attrs.Target);\n                        map.byType[type] = entries;\n                    }\n                }\n            });\n            let names = [];\n            let promises = [];\n            Object.keys(map.byId).forEach(id => {\n                let filename = map.byId[id];\n                let obj = zip.file(xl(filename));\n                if (obj) {\n                    names.push(filename);\n                    promises.push(obj.async(\"uint8array\"));\n                }\n            });\n            let data = await Promise.all(promises);\n            names.forEach((name, i) => map.bytes[name] = data[i]);\n            return map;\n        }\n\n        var SEL_BORDER = [\"borders\", \"border\"];\n        var SEL_FILL = [\"fills\", \"fill\"];\n        var SEL_FONT = [\"fonts\", \"font\"];\n        var SEL_INLINE_STYLE = [\"cellXfs\", \"xf\"];\n        var SEL_NAMED_STYLE = [\"cellStyleXfs\", \"xf\"];\n        var SEL_NUM_FMT = [\"numFmts\", \"numFmt\"];\n\n        var INDEXED_COLORS = [\n            toCSSColor(\"FF000000\"), toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"),\n            toCSSColor(\"FF00FF00\"), toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"),\n            toCSSColor(\"FFFF00FF\"), toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF000000\"),\n            toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"), toCSSColor(\"FF00FF00\"),\n            toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FFFF00FF\"),\n            toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008000\"),\n            toCSSColor(\"FF000080\"), toCSSColor(\"FF808000\"), toCSSColor(\"FF800080\"),\n            toCSSColor(\"FF008080\"), toCSSColor(\"FFC0C0C0\"), toCSSColor(\"FF808080\"),\n            toCSSColor(\"FF9999FF\"), toCSSColor(\"FF993366\"), toCSSColor(\"FFFFFFCC\"),\n            toCSSColor(\"FFCCFFFF\"), toCSSColor(\"FF660066\"), toCSSColor(\"FFFF8080\"),\n            toCSSColor(\"FF0066CC\"), toCSSColor(\"FFCCCCFF\"), toCSSColor(\"FF000080\"),\n            toCSSColor(\"FFFF00FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FF00FFFF\"),\n            toCSSColor(\"FF800080\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008080\"),\n            toCSSColor(\"FF0000FF\"), toCSSColor(\"FF00CCFF\"), toCSSColor(\"FFCCFFFF\"),\n            toCSSColor(\"FFCCFFCC\"), toCSSColor(\"FFFFFF99\"), toCSSColor(\"FF99CCFF\"),\n            toCSSColor(\"FFFF99CC\"), toCSSColor(\"FFCC99FF\"), toCSSColor(\"FFFFCC99\"),\n            toCSSColor(\"FF3366FF\"), toCSSColor(\"FF33CCCC\"), toCSSColor(\"FF99CC00\"),\n            toCSSColor(\"FFFFCC00\"), toCSSColor(\"FFFF9900\"), toCSSColor(\"FFFF6600\"),\n            toCSSColor(\"FF666699\"), toCSSColor(\"FF969696\"), toCSSColor(\"FF003366\"),\n            toCSSColor(\"FF339966\"), toCSSColor(\"FF003300\"), toCSSColor(\"FF333300\"),\n            toCSSColor(\"FF993300\"), toCSSColor(\"FF993366\"), toCSSColor(\"FF333399\"),\n            toCSSColor(\"FF333333\"),\n            toCSSColor(\"FF000000\"), // System Foreground\n            toCSSColor(\"FFFFFFFF\")  // System Background\n        ];\n\n        async function readStyles(zip, theme) {\n            var styles = {\n                fonts        : [],\n                numFmts      : {},\n                fills        : [],\n                borders      : [],\n                namedStyles  : [],\n                inlineStyles : []\n            };\n            var font = null;\n            var fill = null;\n            var border = null;\n            var xf = null;\n            await parse$1(zip, \"xl/styles.xml\", {\n                enter: function(tag, attrs, closed) {\n                    if (this.is(SEL_NUM_FMT)) {\n                        styles.numFmts[attrs.numFmtId] = attrs;\n                    }\n                    else if (this.is(SEL_FONT)) {\n                        styles.fonts.push(font = {});\n                        if (closed) {\n                            // apparently, there's XLSX in the wild with\n                            // <font/>, because why not (also, <border/>).\n                            // if we don't null the variable, we always\n                            // enter below and effectively ignore the rest\n                            // of the file.\n                            font = null;\n                        }\n                    } else if (font) {\n                        if (tag == \"sz\") {\n                            font.size = parseFloat(attrs.val);\n                        } else if (tag == \"name\") {\n                            font.name = attrs.val;\n                        } else if (tag == \"b\") {\n                            font.bold = bool(attrs.val, true);\n                        } else if (tag == \"i\") {\n                            font.italic = bool(attrs.val, true);\n                        } else if (tag == \"u\") {\n                            font.underline = (attrs.val == null || attrs.val == \"single\");\n                        } else if (tag == \"color\") {\n                            font.color = getColor(attrs, null);\n                        }\n                    }\n                    else if (this.is(SEL_FILL)) {\n                        styles.fills.push(fill = {});\n                        if (closed) {\n                            fill = null;\n                        }\n                    } else if (fill) {\n                        if (tag == \"patternFill\") {\n                            fill.type = attrs.patternType;\n                        } else if (tag == \"fgColor\" && fill.type === \"solid\") {\n                            fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                        } else if (tag == \"bgColor\" && fill.type !== \"solid\") {\n                            fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                        }\n                    }\n                    else if (this.is(SEL_BORDER)) {\n                        styles.borders.push(border = {\n                            diagonalUp   : +bool(attrs.diagonalUp, 0),\n                            diagonalDown : +bool(attrs.diagonalDown, 0)\n                        });\n                        if (closed) {\n                            border = null;\n                        }\n                    } else if (border) {\n                        if (/^(?:left|top|right|bottom|diagonal)$/.test(tag)) {\n                            border[tag] = { style: attrs.style || \"none\" };\n                            if (tag == \"diagonal\") {\n                                border.diagonal.up = border.diagonalUp;\n                                border.diagonal.down = border.diagonalDown;\n                            }\n                        }\n                        if (tag == \"color\") {\n                            var side = this.stack[this.stack.length - 2].$tag;\n                            border[side].color = getColor(attrs, INDEXED_COLORS[0]);\n                        }\n                    }\n                    else if (this.is(SEL_NAMED_STYLE)) {\n                        xf = getXf(attrs);\n                        styles.namedStyles.push(xf);\n                        if (closed) {\n                            xf = null;\n                        }\n                    } else if (this.is(SEL_INLINE_STYLE)) {\n                        xf = getXf(attrs);\n                        styles.inlineStyles.push(xf);\n                        if (closed) {\n                            xf = null;\n                        }\n                    } else if (xf) {\n                        if (tag == \"alignment\") {\n                            if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                                xf.textAlign = attrs.horizontal;\n                            }\n                            if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                                xf.verticalAlign = attrs.vertical;\n                            }\n                            if (attrs.wrapText != null) {\n                                xf.wrapText = bool(attrs.wrapText);\n                            }\n                            if (attrs.indent != null) {\n                                xf.indent = integer(attrs.indent);\n                            }\n                        } else if (tag == \"protection\") {\n                            xf.protection = {\n                                locked: bool(attrs.locked)\n                            };\n                        }\n                    }\n                },\n                leave: function(tag) {\n                    if (this.is(SEL_FONT)) {\n                        font = null;\n                    } else if (this.is(SEL_FILL)) {\n                        fill = null;\n                    } else if (this.is(SEL_BORDER)) {\n                        border = null;\n                    } else if (tag == \"xf\") {\n                        xf = null;\n                    }\n                }\n            });\n\n            function getXf(attrs) {\n                var xf = {\n                    borderId          : integer(attrs.borderId),\n                    fillId            : integer(attrs.fillId),\n                    fontId            : integer(attrs.fontId),\n                    numFmtId          : integer(attrs.numFmtId),\n                    pivotButton       : bool(attrs.pivotButton),\n                    quotePrefix       : bool(attrs.quotePrefix),\n                    xfId              : integer(attrs.xfId)\n                };\n                addBool(\"applyAlignment\");\n                addBool(\"applyBorder\");\n                addBool(\"applyFill\");\n                addBool(\"applyFont\");\n                addBool(\"applyNumberFormat\");\n                if (addBool(\"applyProtection\")) {\n                    xf.protection = { locked: true };\n                }\n                function addBool(name) {\n                    if (attrs[name] != null) {\n                        return xf[name] = bool(attrs[name]);\n                    }\n                }\n                return xf;\n            }\n\n            function getColor(attrs, defaultThemeColor) {\n                if (attrs.rgb) {\n                    return toCSSColor(attrs.rgb);\n                } else if (attrs.indexed) {\n                    return INDEXED_COLORS[integer(attrs.indexed)];\n                } else if (attrs.theme) {\n                    var themeColor = theme.colorScheme[integer(attrs.theme)];\n                    if (!themeColor) {\n                        // returning black by default for font color causes\n                        // https://github.com/telerik/kendo-ui-core/issues/5826\n                        // in default cell style, color is undefined\n                        return defaultThemeColor;\n                    }\n\n                    var color = kendo.parseColor(themeColor);\n\n                    if (attrs.tint) {\n                        color = color.toHSL();\n\n                        var tint = parseFloat(attrs.tint);\n                        if (tint < 0) {\n                            color.l = color.l * (1 + tint);\n                        } else {\n                            color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                        }\n                    }\n\n                    return color.toCssRgba();\n                }\n            }\n\n            return styles;\n        }\n\n        var SEL_SCHEME_RGBCLR = [\"a:clrScheme\", \"*\", \"a:srgbClr\"];\n        var SEL_SCHEME_SYSCLR = [\"a:clrScheme\", \"*\", \"a:sysClr\"];\n        async function readTheme(zip, rel) {\n            var scheme = [];\n            var theme = {\n                colorScheme: scheme\n            };\n\n            var file = xl(rel);\n            if (zip.file(file)) {\n                await parse$1(zip, file, {\n                    enter: function(tag, attrs) {\n                        if (this.is(SEL_SCHEME_SYSCLR)) {\n                            scheme.push(toCSSColor(\n                                attrs.val == \"window\" ? \"FFFFFFFF\" : \"FF000000\"\n                            ));\n                        } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                            scheme.push(toCSSColor(\"FF\" + attrs.val));\n                        }\n                    }\n                });\n\n                if (scheme.length > 3) {\n                    // lt1 <-> dk1\n                    swap(scheme, 0, 1);\n                    // lt2 <-> dk2\n                    swap(scheme, 2, 3);\n                }\n            }\n\n            function swap(arr, a, b) {\n                var tmp = arr[a];\n                arr[a] = arr[b];\n                arr[b] = tmp;\n            }\n\n            return theme;\n        }\n\n        function integer(val) {\n            return val == null ? null : parseInt(val, 10);\n        }\n\n        function bool(val, def) {\n            if (val == null) {\n                return def;\n            }\n            return val == \"true\" || val === true || val == 1;\n        }\n\n        function toCSSColor(rgb) {\n            var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n            return \"rgba(\" +\n                parseInt(m[2], 16) + \", \" +\n                parseInt(m[3], 16) + \", \" +\n                parseInt(m[4], 16) + \", \" +\n                parseInt(m[1], 16) / 255 + \")\";\n        }\n\n        function relative_file(base, name) {\n            base = base.split(/\\/+/);\n            name = name.split(/\\/+/);\n            base.pop();\n            while (name.length) {\n                var part = name.shift();\n                if (part === \"\") {\n                    base = [];      // absolute\n                } else if (part === \".\") {\n                    continue;\n                } else if (part === \"..\") {\n                    base.pop();\n                } else {\n                    base.push(part);\n                }\n            }\n            return base.join(\"/\");\n        }\n\n        function excelToPixels(val) {\n            return val / 9525;\n        }\n\n        kendo.spreadsheet.readExcel = readExcel;\n        kendo.spreadsheet._readSheet = readSheet;\n        kendo.spreadsheet._readStrings = readStrings;\n        kendo.spreadsheet._readStyles = readStyles;\n        kendo.spreadsheet._readTheme = readTheme;\n        kendo.spreadsheet._readWorkbook = readWorkbook;\n\n    (function(kendo) {\n\n\n\n\n        var $ = kendo.jQuery;\n        var Formula = kendo.spreadsheet.calc.runtime.Formula;\n        var Ref = kendo.spreadsheet.Ref;\n        var CalcError = kendo.spreadsheet.CalcError;\n\n        kendo.spreadsheet.messages.workbook = {\n            defaultSheetName: \"Sheet\"\n        };\n\n        function loadBinary(url, callback) {\n            var xhr = new XMLHttpRequest();\n            xhr.onload = function() {\n                callback(xhr.response, xhr.getResponseHeader(\"Content-Type\"));\n            };\n            xhr.onerror = function() {\n                callback(null);\n            };\n            xhr.open(\"GET\", url);\n            xhr.responseType = \"arraybuffer\";\n            xhr.send();\n        }\n\n        var Workbook = kendo.Observable.extend({\n            options: {},\n\n            init: function(options, view) {\n                kendo.Observable.fn.init.call(this);\n\n                this.options = options;\n\n                this._view = view;\n                this._sheets = [];\n                this._images = {};\n                this._imgID = 0;\n\n                this._sheetsSearchCache = {};\n\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\"undo\", \"redo\"], this._onUndoRedo.bind(this));\n\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n\n                this.fromJSON(this.options);\n            },\n\n            clipboard: function() {\n                if(!this._clipboard) {\n                     this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n\n            destroy: function() {\n                this.unbind();\n\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n\n            events: [\n                \"cut\",\n                \"copy\",\n                \"paste\",\n                \"changing\",\n                \"change\",\n                \"excelImport\",\n                \"excelExport\",\n                \"insertSheet\",\n                \"removeSheet\",\n                \"selectSheet\",\n                \"renameSheet\",\n                \"insertRow\",\n                \"insertColumn\",\n                \"deleteRow\",\n                \"deleteColumn\",\n                \"hideRow\",\n                \"hideColumn\",\n                \"unhideRow\",\n                \"unhideColumn\",\n                \"select\",\n                \"changeFormat\",\n                \"dataBinding\",\n                \"dataBound\",\n                \"progress\"\n            ],\n\n            _sheetChanging: function(e) {\n                if (this.trigger(\"changing\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetChange: function(e) {\n                this.trigger(\"change\", e);\n            },\n\n            _sheetInsertRow: function(e) {\n                if (this.trigger(\"insertRow\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetInsertColumn: function(e) {\n                if (this.trigger(\"insertColumn\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetDeleteRow: function(e) {\n                if (this.trigger(\"deleteRow\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetDeleteColumn: function(e) {\n                if (this.trigger(\"deleteColumn\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetHideRow: function(e) {\n                if (this.trigger(\"hideRow\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetHideColumn: function(e) {\n                if (this.trigger(\"hideColumn\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetUnhideRow: function(e) {\n                if (this.trigger(\"unhideRow\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetUnhideColumn: function(e) {\n                if (this.trigger(\"unhideColumn\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetSelect: function(e) {\n                this.trigger(\"select\", e);\n            },\n\n            _sheetDataBinding: function(e) {\n                if (this.trigger(\"dataBinding\", {\n                    sheet: e.sender\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetDataBound: function(e) {\n                this.trigger(\"dataBound\", {\n                    sheet: e.sender\n                });\n            },\n\n            _sheetProgress: function(e) {\n                var that = this;\n\n                setTimeout(function() {\n                    that.trigger(\"progress\", {\n                        toggle: e.toggle\n                    });\n                });\n            },\n\n            _sheetCommandRequest: function(e) {\n                this.trigger(\"commandRequest\", e);\n            },\n\n            _inputForRef: function(ref) {\n                var self = this;\n                return self._sheet.withCultureDecimals(function(){\n                    return new kendo.spreadsheet.Range(ref, self._sheet).input();\n                });\n            },\n\n            _onUndoRedo: function(e) {\n                e.command.range().select();\n            },\n\n            execute: function(options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else {\n                    command.range(sheet.selection());\n                }\n\n                if (commandOptions.editRange) {\n                    command._editRange = commandOptions.editRange;\n                }\n\n                var result = command.exec();\n\n                if (!result || result.reason !== \"error\") {\n                    if (!command.cannotUndo) {\n                        this.undoRedoStack.push(command);\n                    }\n                }\n\n                // when the undo/redo stack is truncated (by e.g. adding a\n                // non-redo command after undoing) it's possible to\n                // discard images from the dropped commands.\n                this.cleanupImages();\n\n                return result;\n            },\n\n            resetFormulas: function() {\n                this._sheets.forEach(function(sheet){\n                    sheet.resetFormulas();\n                });\n            },\n\n            resetValidations: function() {\n                this._sheets.forEach(function(sheet){\n                    sheet.resetValidations();\n                });\n            },\n\n            refresh: function(reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n\n            activeSheet: function(sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n\n                this._sheet = sheet;\n\n                //TODO: better way to get all reasons?\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n\n            moveSheetToIndex: function(sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n\n                if (fromIndex === -1) {\n                    return;\n                }\n\n                this._sheetsSearchCache = {};\n\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n\n                this.trigger(\"change\", { sheetSelection: true });\n            },\n\n            insertSheet: function(options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === \"number\" ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n\n                var getUniqueSheetName = function(sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n\n                    var name = kendo.spreadsheet.messages.workbook.defaultSheetName + sheetNameSuffix;\n\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n\n                this._sheetsSearchCache = {};\n\n                sheetName = options.name || getUniqueSheetName();\n\n                var sheet = new kendo.spreadsheet.Sheet(\n                    options.rows || this.options.rows,\n                    options.columns || this.options.columns,\n                    options.rowHeight || this.options.rowHeight,\n                    options.columnWidth || this.options.columnWidth,\n                    options.headerHeight || this.options.headerHeight,\n                    options.headerWidth || this.options.headerWidth,\n                    options.defaultCellStyle || this.options.defaultCellStyle\n                );\n\n                sheet._workbook = this;\n\n                sheet._name(sheetName);\n\n                this._bindSheetEvents(sheet);\n\n                sheets.splice(insertIndex, 0, sheet);\n\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n\n                this.trigger(\"change\", { sheetSelection: true });\n\n                return sheet;\n            },\n\n            _bindSheetEvents: function(sheet) {\n                sheet.bind(\"changing\", this._sheetChanging.bind(this));\n                sheet.bind(\"change\", this._sheetChange.bind(this));\n                sheet.bind(\"insertRow\", this._sheetInsertRow.bind(this));\n                sheet.bind(\"insertColumn\", this._sheetInsertColumn.bind(this));\n                sheet.bind(\"deleteRow\", this._sheetDeleteRow.bind(this));\n                sheet.bind(\"deleteColumn\", this._sheetDeleteColumn.bind(this));\n                sheet.bind(\"hideRow\", this._sheetHideRow.bind(this));\n                sheet.bind(\"hideColumn\", this._sheetHideColumn.bind(this));\n                sheet.bind(\"unhideRow\", this._sheetUnhideRow.bind(this));\n                sheet.bind(\"unhideColumn\", this._sheetUnhideColumn.bind(this));\n                sheet.bind(\"select\", this._sheetSelect.bind(this));\n                sheet.bind(\"commandRequest\", this._sheetCommandRequest.bind(this));\n                sheet.bind(\"dataBinding\", this._sheetDataBinding.bind(this));\n                sheet.bind(\"dataBound\", this._sheetDataBound.bind(this));\n                sheet.bind(\"progress\", this._sheetProgress.bind(this));\n            },\n\n            sheets: function() {\n                return this._sheets.slice();\n            },\n\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n\n            sheetByIndex: function(index) {\n                return this._sheets[index];\n            },\n\n            sheetIndex: function(sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == \"string\" ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n\n                if (idx >= 0) {\n                    return idx;\n                }\n\n                for(idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n\n                return -1;\n            },\n\n            renameSheet: function(sheet, newSheetName) {\n                var oldSheetName = sheet.name().toLowerCase();\n\n                if (!newSheetName ||\n                    oldSheetName === newSheetName.toLowerCase() ||\n                    this.sheetByName(newSheetName)) {\n                    return;\n                }\n\n                sheet = this.sheetByName(oldSheetName);\n\n                if (!sheet) {\n                    return;\n                }\n\n                this._sheetsSearchCache = {};\n\n                if (this.trigger(\"renameSheet\", {\n                    sheet: sheet,\n                    newSheetName: newSheetName\n                })) {\n                    return;\n                }\n\n                // update references\n                this._sheets.forEach(function(sheet){\n                    sheet._forFormulas(function(formula){\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n\n                this.forEachName(function(def, name){\n                    // 1. redefine sheet-local names\n                    if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                        this.undefineName(name);\n                        def.name = def.nameref.print();\n                        this.nameDefinition(def.name, def);\n                    }\n                    // 2. if the value is reference or formula, update it\n                    if (def.value instanceof Ref || def.value instanceof Formula) {\n                        def.value.renameSheet(oldSheetName, newSheetName);\n                    }\n                }.bind(this));\n\n                sheet._name(newSheetName);\n\n                this.trigger(\"change\", { sheetSelection: true });\n\n                return sheet;\n            },\n\n            removeSheet: function(sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n\n                if (sheets.length === 1) {\n                    return;\n                }\n\n                if (this.trigger(\"removeSheet\", { sheet: sheet })) {\n                    return;\n                }\n\n                this._sheetsSearchCache = {};\n\n                if (index > -1) {\n                    sheet.unbind();\n\n                    sheets.splice(index, 1);\n\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index-1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger(\"change\", { recalc: true,  sheetSelection: true });\n                    }\n                }\n            },\n\n            _clearSheets: function() {\n                for (var i = 0; i < this._sheets.length; i++) {\n                    this._sheets[i]._activeDrawing = [];\n                    this._sheets[i]._drawings = [];\n                    this._sheets[i].unbind();\n                }\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._names = {};\n                this._images = {};\n                this._imgID = 0;\n            },\n\n            // _loadImages: function() {\n            //     var self = this;\n            //     var ids = Object.keys(self._images);\n            //     var count = ids.length;\n            //     if (count) {\n            //         ids.forEach(function(id){\n            //             var img = self._images[id];\n            //             if (!img.blob) {\n            //                 loadBinary(img.url, function(data, type) {\n            //                     // XXX: can we do something better in case of error?\n            //                     if (data != null) {\n            //                         img.blob = new Blob([ data ], { type: type });\n            //                         delete img.url;\n            //                     }\n            //                     next();\n            //                 });\n            //             }\n            //         });\n            //     } else {\n            //         next();\n            //     }\n            //     function next() {\n            //         if (--count <= 0) {\n            //             self.activeSheet().triggerChange({ layout: true });\n            //         }\n            //     }\n            // },\n\n            fromJSON: function(json) {\n                if (json.sheets) {\n                    this._clearSheets();\n\n                    if (json.images) {\n                        this._imgID = 0;\n                        this._images = {};\n                        Object.keys(json.images).forEach(function(id){\n                            if (!isNaN(id)) {\n                                var num = parseFloat(id);\n                                if (isFinite(num)) {\n                                    this._imgID = Math.max(this._imgID, num);\n                                }\n                            }\n                            this._images[id] = { url: json.images[id] };\n                        }, this);\n                        // this._loadImages();\n                    }\n\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var data = json.sheets[idx];\n                        var args = sheetParamsFromJSON(data, this.options);\n                        var sheet = this.insertSheet({\n                            rows         : args.rowCount,\n                            columns      : args.columnCount,\n                            rowHeight    : args.rowHeight,\n                            columnWidth  : args.columnWidth,\n                            headerHeight : args.headerHeight,\n                            headerWidth  : args.headerWidth,\n                            data         : data\n                        });\n\n                        if (data.dataSource) {\n                            sheet.setDataSource(data.dataSource);\n                        }\n                    }\n                }\n\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                } else {\n                    this.activeSheet(this._sheets[0]);\n                }\n\n                if (json.names) {\n                    json.names.forEach(function(def){\n                        this.defineName(def.name, def.value, def.hidden);\n                    }, this);\n                }\n            },\n\n            toJSON: function() {\n                this.resetFormulas();\n                this.resetValidations();\n                var names = Object.keys(this._names).map(function(name){\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref || val instanceof Formula) {\n                        val = val.print(0, 0, true);\n                    } else if (val instanceof CalcError) {\n                        val = val + \"\";\n                    } else {\n                        val = JSON.stringify(val);\n                    }\n                    return {\n                        value     : val,\n                        hidden    : def.hidden,\n                        name      : def.name,\n\n                        // these two are not really useful in\n                        // deserialization, but are handy in OOXML export.\n                        sheet     : def.nameref.sheet,\n                        localName : def.nameref.name\n                    };\n                }, this);\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function(sheet) {\n                        sheet.recalc(this._context);\n                        sheet.revalidate(this._validationContext);\n                        return sheet.toJSON();\n                    }, this),\n                    names: names,\n                    columnWidth: this.options.columnWidth,\n                    rowHeight: this.options.rowHeight\n                };\n            },\n\n            saveJSON: function() {\n                var self = this;\n                var deferred = new $.Deferred();\n                var data = self.toJSON();\n                var ids = Object.keys(self._images).filter(function(id){\n                    return self.usesImage(id) === 1;\n                });\n                var count = ids.length;\n                data.images = {};\n                if (count) {\n                    ids.forEach(function(id){\n                        var img = self._images[id];\n                        if (img.blob) {\n                            var reader = new FileReader();\n                            reader.onload = function() {\n                                data.images[id] = reader.result;\n                                next();\n                            };\n                            reader.readAsDataURL(img.blob);\n                        } else {\n                            data.images[id] = img.url;\n                            next();\n                        }\n                    });\n                } else {\n                    next();\n                }\n                return deferred.promise();\n\n                function next() {\n                    if (--count <= 0) {\n                        deferred.resolve(data);\n                    }\n                }\n            },\n\n            fromFile: function(file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = { file: file, promise: promise };\n\n                if (file && !this.trigger(\"excelImport\", args)) {\n                    this._clearSheets();\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n\n                return promise;\n            },\n\n            saveAsExcel: function(options) {\n                var self = this;\n                options = $.extend({}, self.options.excel, options);\n                var data = self.toJSON();\n\n                if (self.trigger(\"excelExport\", { workbook: data })) {\n                    return;\n                }\n\n                var ids = Object.keys(self._images).filter(function(id){\n                    return self.usesImage(id) === 1;\n                });\n                var count = ids.length;\n                var images = count ? {} : null;\n                if (count) {\n                    ids.forEach(function(id){\n                        var img = self._images[id];\n                        if (img.blob) {\n                            var reader = new FileReader();\n                            reader.onload = function() {\n                                images[id] = {\n                                    type: img.blob.type,\n                                    name: img.blob.name,\n                                    data: reader.result\n                                };\n                                next();\n                            };\n                            reader.readAsArrayBuffer(img.blob);\n                        } else {\n                            loadBinary(img.url, function(data, type){\n                                images[id] = { type: type, data: data };\n                                next();\n                            });\n                        }\n                    });\n                } else {\n                    next();\n                }\n\n                function next() {\n                    if (--count <= 0) {\n                        data.images = images;\n                        var workbook = new kendo.ooxml.Workbook(data);\n                        var saveOptions = {\n                            fileName: data.fileName || options.fileName,\n                            proxyURL: options.proxyURL,\n                            forceProxy: options.forceProxy\n                        };\n\n                        if (options.forceProxy) {\n                            workbook.toDataURLAsync().then(function(data) {\n                                kendo.saveAs($.extend(saveOptions, {\n                                    dataURI: data\n                                }));\n                            });\n                        } else {\n                            Promise.resolve(workbook.toBlob()).then(function(data) {\n                                kendo.saveAs($.extend(saveOptions, {\n                                    dataURI: data\n                                }));\n                            });\n                        }\n                    }\n                }\n            },\n\n            draw: function(options, callback) {\n                if (typeof options == \"function\" && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i){\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function(group){\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                })(0);\n            },\n\n            nameForRef: function(ref, sheet) {\n                if (sheet === undefined) {\n                    sheet = ref.sheet;\n                }\n                sheet = sheet.toLowerCase();\n                var str = ref + \"\";\n                for (var name in this._names) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref) {\n                        if (!val.sheet || (val.sheet && sheet == val.sheet.toLowerCase())) {\n                            if (val + \"\" == str) {\n                                return def;\n                            }\n                        }\n                    }\n                }\n                return { name: str };\n            },\n\n            defineName: function(name, value, hidden) {\n                var x = kendo.spreadsheet.calc.parseNameDefinition(name, value);\n                name = x.name.print();\n                this._names[name.toLowerCase()] = {\n                    value   : x.value,\n                    hidden  : hidden,\n                    name    : name,\n                    nameref : x.name\n                };\n            },\n\n            undefineName: function(name) {\n                delete this._names[name.toLowerCase()];\n            },\n\n            nameValue: function(name) {\n                name = name.toLowerCase();\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n\n            nameDefinition: function(name, def) {\n                name = name.toLowerCase();\n                if (arguments.length > 1) {\n                    if (def === undefined) {\n                        delete this._names[name];\n                    } else {\n                        this._names[name] = def;\n                    }\n                }\n                return this._names[name];\n            },\n\n            forEachName: function(func) {\n                Object.keys(this._names).forEach(function(name){\n                    func(this._names[name], name);\n                }, this);\n            },\n\n            adjustNames: function(affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function(name){\n                    var def = this._names[name];\n                    var x = def.value;\n                    if (x instanceof Ref &&\n                        x.sheet.toLowerCase() == affectedSheet) {\n                        def.value = x.adjust(null, null, null, null, forRow, start, delta);\n                    }\n                    else if (x instanceof Formula) {\n                        x.adjust(affectedSheet, forRow ? \"row\" : \"col\", start, delta);\n                    }\n                }, this);\n            },\n\n            addImage: function(image) {\n                var id = String(++this._imgID);\n                if (typeof image == \"string\") {\n                    this._images[id] = { url: image };\n                } else {\n                    this._images[id] = { blob: image };\n                }\n                return id;\n            },\n\n            imageUrl: function(id) {\n                var img = this._images[id];\n                var url = img.url;\n                if (!url) {\n                    url = img.url = window.URL.createObjectURL(img.blob);\n                }\n                return url;\n            },\n\n            cleanupImages: function() {\n                Object.keys(this._images).forEach(function(id){\n                    if (!this.usesImage(id)) {\n                        var url = this._images[id].url;\n                        if (url) {\n                            window.URL.revokeObjectURL(url);\n                        }\n                        delete this._images[id];\n                    }\n                }, this);\n            },\n\n            usesImage: function(img) {\n                var i;\n                var sheets = this._sheets;\n                for (i = sheets.length; --i >= 0;) {\n                    if (sheets[i].usesImage(img)) {\n                        return 1;\n                    }\n                }\n                var stack = this.undoRedoStack.stack;\n                for (i = stack.length; --i >= 0;) {\n                    if (stack[i].usesImage(img)) {\n                        return 2; // signal that it's only in the undo stack\n                    }\n                }\n                return false;\n            }\n\n        });\n\n        function sheetParamsFromJSON(data, options) {\n            function or(a, b, c) {\n                return a !== undefined ? a : b !== undefined ? b : c;\n            }\n\n            var rowCount     = or(data.rowCount, options.rows, 200),\n                columnCount  = or(data.columnCount, options.columns, 50),\n                rowHeight    = or(data.rowHeight, options.rowHeight, 20),\n                columnWidth  = or(data.columnWidth, options.columnWidth, 64),\n                headerHeight = or(data.headerHeight, options.headerHeight, 20),\n                headerWidth  = or(data.headerWidth, options.headerWidth, 32);\n\n            if (data.rows !== undefined) {\n                for (var i = 0; i < data.rows.length; ++i) {\n                    var row = data.rows[i];\n                    var ri = or(row.index, i);\n                    if (ri >= rowCount) { rowCount = ri + 1; }\n                    if (row.cells) {\n                        for (var j = 0; j < row.cells.length; ++j) {\n                            var cell = row.cells[j];\n                            var ci = or(cell.index, j);\n                            if (ci >= columnCount) { columnCount = ci + 1; }\n                        }\n                    }\n                }\n            }\n\n            return {\n                rowCount     : rowCount,\n                columnCount  : columnCount,\n                rowHeight    : rowHeight,\n                columnWidth  : columnWidth,\n                headerHeight : headerHeight,\n                headerWidth  : headerWidth\n            };\n        }\n\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n\n            Workbook.prototype.saveAsPDF = function(options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger(\"pdfExport\", args)) {\n                    return;\n                }\n\n                this._drawPDF(options, progress)\n                .then(function(root) {\n                    return options.forceProxy\n                        ? kendo.pdf.exportPDF(root) // produce data URI for proxy\n                        : kendo.pdf.exportPDFToBlob(root);\n                })\n                .done(function(dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n\n                    progress.resolve();\n                })\n                .fail(function(err) {\n                    progress.reject(err);\n                });\n\n                return promise;\n            };\n\n            Workbook.prototype._drawPDF = function(options) {\n                var result = new $.Deferred();\n                var callback = function(group) {\n                    result.resolve(group);\n                };\n                switch(options.area) {\n                case \"workbook\":\n                    options.workbook.draw(options, callback);\n                    break;\n                case \"sheet\":\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case \"selection\":\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n\n                return result.promise();\n            };\n        }\n    })(kendo);\n\n    var spreadsheet$4 = kendo.spreadsheet;\n        var CellRef$2 = spreadsheet$4.CellRef;\n        var RangeRef$1 = spreadsheet$4.RangeRef;\n        var UnionRef$1 = spreadsheet$4.UnionRef;\n        var NameRef$1 = spreadsheet$4.NameRef;\n        var Ref$1 = spreadsheet$4.Ref;\n\n        var FormulaContext = kendo.Class.extend({\n            init: function (workbook) {\n                this.workbook = workbook;\n            },\n\n            getRefCells: function(ref, hiddenInfo, fsheet, frow, fcol, wantNulls) {\n                var sheet, formula, value, i;\n                if (ref instanceof CellRef$2) {\n                    sheet = this.workbook.sheetByName(ref.sheet);\n                    if (!sheet || !ref.valid()) {\n                        return [{\n                            value: new kendo.spreadsheet.calc.runtime.CalcError(\"REF\")\n                        }];\n                    }\n                    formula = sheet.formula(ref);\n                    value = sheet.range(ref.row, ref.col).value();\n\n                    if (wantNulls || formula != null || value != null) {\n                        return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? (sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0) : false\n                        }];\n                    } else {\n                        return [];\n                    }\n                }\n                if (ref instanceof RangeRef$1) {\n                    i = this.workbook.sheetIndex(ref.sheet);\n                    var states = [], n = i;\n                    if (ref.endSheet) {\n                        // \"3D\" reference.\n                        n = this.workbook.sheetIndex(ref.endSheet);\n                        if (i > n) {\n                            var tmp = i;\n                            i = n;\n                            n = tmp;\n                        }\n                    }\n\n                    if (i < 0 || n < 0 || !ref.valid()) {\n                        return [{\n                            value: new kendo.spreadsheet.calc.runtime.CalcError(\"REF\")\n                        }];\n                    }\n\n                    // XXX: This is nicer, but significantly slower.\n                    // Should investigate why, or add some options to make\n                    // it faster (i.e. probably because it adds all cell\n                    // properties, while we only need value and formula).\n                    //\n                    //     var add = function(row, col, data){\n                    //         data.row = row;\n                    //         data.col = col;\n                    //         data.sheet = sheet.name();\n                    //         states.push(data);\n                    //     };\n                    //     while (i <= n) {\n                    //         sheet = this.workbook.sheetByIndex(i++);\n                    //         sheet.forEach(ref, add);\n                    //     }\n                    //\n                    // For now keep doing it \"manually\".\n\n                    while (i <= n) {\n                        sheet = this.workbook.sheetByIndex(i++);\n                        var tl = sheet._grid.normalize(ref.topLeft);\n                        var br = sheet._grid.normalize(ref.bottomRight);\n\n                        var startCellIndex = sheet._grid.cellRefIndex(tl);\n                        var endCellIndex = sheet._grid.cellRefIndex(br);\n\n                        var values = sheet._properties.iterator(\"value\", startCellIndex, endCellIndex);\n\n                        for (var col = tl.col; col <= br.col; ++col) {\n                            for (var row = tl.row; row <= br.row; ++row) {\n                                var index = sheet._grid.index(row, col);\n                                formula = sheet._properties.get(\"formula\", index);\n                                value = values.at(index);\n                                if (wantNulls || formula != null || value != null) {\n                                    states.push({\n                                        formula : formula,\n                                        value   : value,\n                                        row     : row,\n                                        col     : col,\n                                        sheet   : sheet.name(),\n                                        hidden  : hiddenInfo ? (sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0) : false\n                                    });\n                                }\n                            }\n                        }\n                    }\n\n                    return states;\n                }\n                if (ref instanceof UnionRef$1) {\n                    var a = [];\n                    for (i = 0; i < ref.refs.length; ++i) {\n                        a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n                    }\n                    return a;\n                }\n                if (ref instanceof NameRef$1) {\n                    var val = this.nameValue(ref, fsheet, frow, fcol);\n                    // XXX: revise this\n                    if (val instanceof Ref$1) {\n                        return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n                    }\n                    return [{\n                        value: val == null ? new kendo.spreadsheet.calc.runtime.CalcError(\"NAME\") : val\n                    }];\n                }\n                return [];\n            },\n\n            isMerged: function(ref) {\n                var sheet = this.workbook.sheetByName(ref.sheet);\n                return sheet.isMerged(ref);\n            },\n\n            nameValue: function(ref, fsheet, frow, fcol) {\n                var val;\n                if (ref.hasSheet()) {\n                    // qualified name\n                    val = this.workbook.nameValue(this._displayString(ref.print()));\n                } else {\n                    // try local name\n                    ref = ref.clone().setSheet(fsheet, true);\n                    val = this.workbook.nameValue(this._displayString(ref.print()));\n                    if (val == null) {\n                        // try global name\n                        val = this.workbook.nameValue(this._displayString(ref.name));\n                    }\n                    if (val == null) {\n                        // try without _displayString\n                        val = this.workbook.nameValue(ref.print()) || this.workbook.nameValue(ref.name);\n                    }\n                }\n                if (val instanceof Ref$1) {\n                    val = val.absolute(frow, fcol);\n                }\n                return val;\n            },\n\n            getData: function(ref, fsheet, frow, fcol, wantNulls) {\n                var single = ref instanceof CellRef$2;\n                if (ref instanceof NameRef$1) {\n                    single = this.workbook.nameValue(ref.name) instanceof CellRef$2;\n                }\n                var data = this.getRefCells(ref, false, fsheet, frow, fcol, wantNulls).map(function(cell){\n                    var val = cell.value;\n                    if (val instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                        val = val.value;\n                    }\n                    return val;\n                });\n                return single ? data[0] : data;\n            },\n\n            onFormula: function(f) {\n                var sheet = this.workbook.sheetByName(f.sheet);\n                var row = f.row, col = f.col, value = f.value;\n                var currentFormula = sheet.formula({ row: row, col: col });\n                if (currentFormula !== f) {\n                    // could have been deleted or modified in the mean time,\n                    // if the formula was asynchronous.  ignore this result.\n                    return false;\n                }\n\n                var arrayRange = f.arrayFormulaRange;\n                if (arrayRange) {\n                    // `value` will always be a Matrix in this case;\n                    // enforced in runtime.js (Context::_resolve).  We\n                    // must fill only cells in arrayRange.\n                    var tlRow, tlCol;\n                    var width = value.width;\n                    var height = value.height;\n                    sheet.forEach(arrayRange, function(row, col){\n                        if (tlRow === undefined) {\n                            tlRow = row;\n                            tlCol = col;\n                        }\n                        var vrow = row - tlRow;\n                        var vcol = col - tlCol;\n                        var val;\n                        if (vrow < height && vcol < width) {\n                            val = value.get(vrow, vcol);\n                        } else {\n                            val = new kendo.spreadsheet.calc.runtime.CalcError(\"N/A\");\n                        }\n                        sheet._value(row, col, val);\n                    });\n                }\n                else {\n                    // formulas may return references.  if a range or union,\n                    // we'll just save the first cell.\n                    if (value instanceof Ref$1) {\n                        value = this.getData(value, f.sheet, row, col);\n                        if (Array.isArray(value)) {\n                            value = value[0];\n                        }\n                        if (value === undefined) {\n                            value = null; // clear contents\n                        }\n                    }\n\n                    // when not saved as an array formula, a formula\n                    // returning a Matrix will just save the first value.\n                    if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                        value = value.get(0, 0);\n                    }\n\n                    sheet._value(row, col, value);\n                }\n\n                clearTimeout(sheet._formulaContextRefresh);\n                sheet._formulaContextRefresh = setTimeout(function(){\n                    sheet.batch(function(){}, { layout: true });\n                }, 50);\n\n                return true;\n            },\n            _displayString: function(val) {\n                if (/^[a-z_][a-z0-9_]*$/i.test(val)) {\n                    return val;\n                }\n                return \"'\" + val.replace(/\\x27/g, \"\\\\'\") + \"'\";\n            }\n        });\n\n        var ValidationFormulaContext = FormulaContext.extend({\n            onFormula: function() {\n                return true;\n            }\n        });\n\n        spreadsheet$4.FormulaContext = FormulaContext;\n        spreadsheet$4.ValidationFormulaContext = ValidationFormulaContext;\n\n    (function(kendo) {\n        'use strict';\n\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n\n        var ACTIONS = {\n            \"up\": \"up\",\n            \"down\": \"down\",\n            \"left\": \"left\",\n            \"right\": \"right\",\n            \"home\": \"first-col\",\n            \"end\": \"last-col\",\n            \"ctrl+left\": \"word-left\",\n            \"ctrl+right\": \"word-right\",\n            \"ctrl+up\": \"word-up\",\n            \"ctrl+down\": \"word-down\",\n            \"ctrl+home\": \"first\",\n            \"ctrl+end\": \"last\",\n            \"pageup\": \"prev-page\",\n            \"pagedown\": \"next-page\"\n        };\n\n        var ENTRY_ACTIONS = {\n            \"tab\": \"next\",\n            \"shift+tab\": \"previous\",\n            \"enter\": \"lower\",\n            \"shift+enter\": \"upper\",\n            \"delete\": \"clearContents\",\n            \"backspace\": \"clearContents\",\n            \"shift+:alphanum\": \"edit\",\n            \"alt+:alphanum\": \"edit\",\n            \":alphanum\": \"edit\",\n            \"ctrl+:alphanum\": \"ctrl\",\n            \"alt+ctrl+:alphanum\": \"edit\",\n            \":edit\": \"edit\"\n        };\n\n        var CONTAINER_EVENTS = {\n            \"wheel\": \"onWheel\",\n            \"*+mousedown\": \"onMouseDown\",\n            \"contextmenu\": \"onContextMenu\",\n            \"*+mousedrag\": \"onMouseDrag\",\n            \"*+mouseup\": \"onMouseUp\",\n            \"*+dblclick\": \"onDblClick\",\n            \"mousemove\": \"onMouseMove\"\n        };\n\n        var CLIPBOARD_EVENTS = {\n            \"pageup\": \"onPageUp\",\n            \"pagedown\": \"onPageDown\",\n            \"mouseup\": \"onMouseUp\",\n            \"*+cut\": \"onCut\",\n            \"*+paste\": \"onPaste\",\n            \"*+copy\": \"onCopy\"\n        };\n\n        var EDITOR_EVENTS = {\n            \"esc\": \"onEditorEsc\",\n            \"enter\": \"onEditorBlur\",\n            \"alt+enter\": \"insertNewline\",\n            \"shift+enter\": \"onEditorBlur\",\n            \"tab\": \"onEditorBlur\",\n            \"shift+tab\": \"onEditorBlur\",\n            \"shift+ctrl+enter\": \"onEditorArrayFormula\"\n        };\n\n        var FORMULABAR_EVENTS = $.extend({ focus: \"onEditorBarFocus\" }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: \"onEditorCellFocus\" }, EDITOR_EVENTS);\n\n        var SELECTION_MODES = {\n           cell: \"range\",\n           rowheader: \"row\",\n           columnheader: \"column\",\n           topcorner: \"sheet\",\n           autofill: \"autofill\"\n        };\n\n        function toActionSelector(selectors) {\n            return selectors.map(function(action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(\",\");\n        }\n\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([ 'cut', 'copy', 'paste', 'insert-left', 'insert-right', 'insert-above', 'insert-below' ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([ 'unhide-row', 'unhide-column' ]);\n\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push(\"shift+\" + key);\n        }\n\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n\n        CLIPBOARD_EVENTS[ACTION_KEYS] = \"onAction\";\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = \"onShiftAction\";\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = \"onEntryAction\";\n\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = \"onEditorAction\";\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = \"onEditorShiftAction\";\n\n        var Controller = kendo.Class.extend({\n            init: function(view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.drawingContextMenu = view.drawingContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n\n                view.nameEditor.bind(\"enter\", this.onNameEditorEnter.bind(this));\n                view.nameEditor.bind(\"cancel\", this.onNameEditorCancel.bind(this));\n                view.nameEditor.bind(\"select\", this.onNameEditorSelect.bind(this));\n                view.nameEditor.bind(\"delete\", this.onNameEditorDelete.bind(this));\n\n                this.editor = view.editor;\n                this.editor.bind(\"change\", this.onEditorChange.bind(this));\n                this.editor.bind(\"activate\", this.onEditorActivate.bind(this));\n                this.editor.bind(\"deactivate\", this.onEditorDeactivate.bind(this));\n                this.editor.bind(\"update\", this.onEditorUpdate.bind(this));\n\n                $(view.scroller).on(\"scroll\", this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                $(view.scroller).on(\"mousedown\", this.onMouseDown.bind(this));\n\n                this._enableEditorEvents();\n\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind(\"select\", this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind(\"reorder\", this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind(\"rename\", this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind(\"remove\", this.onSheetBarRemove.bind(this));\n                }\n\n                this.cellContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n                this.drawingContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n\n                // this is necessary for Windows to catch prevent context menu correctly\n                this.cellContextMenu.element\n                    .add(this.rowHeaderContextMenu.element)\n                    .add(this.colHeaderContextMenu.element)\n                    .add(this.drawingContextMenu.element)\n                    .on(\"contextmenu\", false);\n\n                if (this.tabstrip) {\n                    this.tabstrip.bind(\"action\", this.onCommandRequest.bind(this));\n                    this.tabstrip.bind(\"dialog\", this.onDialogRequest.bind(this));\n                }\n            },\n\n            _enableEditorEvents: function (enable) {\n                if (enable === undefined || enable) {\n                    this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                    this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                    this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                } else {\n                    this.keyListener.destroy();\n                    this.barKeyListener.destroy();\n                    this.inputKeyListener.destroy();\n                }\n            },\n\n            _execute: function(options) {\n                var result = this._workbook.execute(options);\n\n                if (options.command === \"EditCommand\" && !result) {\n                    this._workbook.trigger(\"change\", { editorClose: true });\n                }\n\n                if (result) {\n                    this._preventNavigation = true;\n                    if (result.reason === \"error\") {\n                        this.editor.deactivate(true); // make sure we don't call any change hooks\n                        this.view.showError(result, function(){\n                            // we only get here in case of a validation error when the user decided to retry.\n                            this.activateEditor(false);\n                            // reset to last input from user\n                            this.editor.value(this._lastEditorValue);\n                            // however, set _value manually such that it'll detect change properly.  ugly :-\\\n                            this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                            // seems like a nice UX to have the whole input selected\n                            this.editor.select();\n                        }.bind(this));\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n\n                return result;\n            },\n\n            _activeTooltip: function() {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n\n            onContextMenuSelect: function(e) {\n                var action = $(e.item).data(\"action\");\n                var command;\n                switch(action) {\n                  case \"cut\":\n                    command = { command: \"ToolbarCutCommand\", options: { workbook: this._workbook } };\n                    break;\n                  case \"copy\":\n                    command = { command: \"ToolbarCopyCommand\", options: { workbook: this._workbook } };\n                    break;\n                  case \"paste\":\n                    command = { command: \"ToolbarPasteCommand\", options: { workbook: this._workbook } };\n                    break;\n                  case \"delete-drawing\":\n                    command = { command: \"DeleteDrawingCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n                    break;\n                  case \"bring-to-front\":\n                    command = { command: \"BringToFrontCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n                    break;\n                  case \"send-to-back\":\n                    command = { command: \"SendToBackCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n                    break;\n                  case \"unmerge\":\n                    command = { command: \"MergeCellCommand\", options: { value: \"unmerge\" } };\n                    break;\n                  case \"merge\":\n                    this.view.openDialog(\"merge\");\n                    break;\n                  case \"hide-row\":\n                    command = { command: \"HideLineCommand\", options: { axis: \"row\" } };\n                    break;\n                  case \"hide-column\":\n                    command = { command: \"HideLineCommand\", options: { axis: \"column\" } };\n                    break;\n                  case \"unhide-row\":\n                    command = { command: \"UnHideLineCommand\", options: { axis: \"row\" } };\n                    break;\n                  case \"unhide-column\":\n                    command = { command: \"UnHideLineCommand\", options: { axis: \"column\" } };\n                    break;\n                  case \"delete-row\":\n                    command = { command: \"DeleteRowCommand\" };\n                    break;\n                  case \"delete-column\":\n                    command = { command: \"DeleteColumnCommand\" };\n                    break;\n                }\n\n                if (command) {\n                    this._execute(command);\n                }\n            },\n\n            onSheetBarRemove: function(e) {\n                var sheet = this._workbook.sheetByName(e.name);\n\n                //TODO: move to model!\n                if (!sheet) {\n                    return;\n                }\n\n                this._workbook.removeSheet(sheet);\n            },\n\n            destroy: function() {\n                this.listener.destroy();\n                this._enableEditorEvents(false);\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n\n            onSheetBarSelect: function(e) {\n                var sheet;\n                var workbook = this._workbook;\n\n                if (e.isAddButton) {\n                    if (this._workbook.trigger(\"insertSheet\")) {\n                        return;\n                    }\n\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n\n                //TODO: move to model\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    if (this._workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                        return;\n                    }\n\n                    if (!this.editor.canInsertRef(false)) {\n                        this.editor.deactivate();\n                    }\n\n                    workbook.activeSheet(sheet);\n                }\n            },\n\n            onSheetBarReorder: function(e) {\n                var workbook = this._workbook;\n                var sheet = workbook.sheetByIndex(e.oldIndex);\n                var activeSheet = workbook.activeSheet();\n                var activeSheetName = activeSheet.name();\n\n                workbook.moveSheetToIndex(sheet, e.newIndex);\n\n                if (activeSheetName !== sheet.name()) {\n                    if (workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                        workbook.activeSheet(activeSheet);\n                        return;\n                    }\n\n                    if (!this.editor.canInsertRef(false)) {\n                        this.editor.deactivate();\n                    }\n\n                    workbook.activeSheet(sheet);\n                }\n            },\n\n            onSheetBarRename: function(e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n\n                if (this._workbook.sheetByName(e.name)) {\n                    this.view.showError({ reason: \"error\", type: \"duplicateSheetName\" });\n                    return;\n                }\n\n                this._workbook.renameSheet(sheet, e.name);\n\n                this.clipboardElement.focus();\n            },\n\n            sheet: function(sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n\n            workbook: function(workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n                workbook.bind(\"commandRequest\", this.onCommandRequest.bind(this));\n            },\n\n            refresh: function() {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n\n                if (!editor.isActive() && !this.isEditorDisabled) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    this.resetEditorValue();\n                }\n\n                var ref = sheet.selection()._ref.simplify();\n                var def = this._workbook.nameForRef(ref, sheet.name());\n                this.view.nameEditor.value(def.name);\n            },\n\n            onScroll: function() {\n                this.view.render({ scroll: true });\n            },\n\n            onWheel: function(event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n\n                this.scrollWith(deltaX, deltaY);\n\n                event.preventDefault();\n            },\n\n            onAction: function(event, action) {\n                var sheet = this._workbook.activeSheet();\n                sheet._activeDrawing = null;\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n\n            onPageUp: function() {\n                this.scrollDown(-this._viewPortHeight);\n            },\n\n            onPageDown: function() {\n                this.scrollDown(this._viewPortHeight);\n            },\n\n            onEntryAction: function(event, action) {\n                var sheet = this._workbook.activeSheet();\n\n                if (event.mod) {\n                    var key = String.fromCharCode(event.keyCode);\n                    var shouldPrevent = true;\n\n                    switch(key) {\n                      case \"A\":\n                        sheet._activeDrawing = null;\n                        this.navigator.selectAll();\n                        break;\n                      case \"Y\":\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                      case \"Z\":\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                      default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = sheet.selection().enable() === false;\n                    var casual = action !== \":edit\";\n\n                    if (action == \"delete\" || action == \"backspace\") {\n                        if (sheet._activeDrawing) {\n                            this._execute({\n                                command: \"DeleteDrawingCommand\",\n                                options: { drawing: sheet._activeDrawing }\n                            });\n                        } else if (!disabled) {\n                            this._execute({ command: \"ClearContentCommand\" });\n                        }\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || !casual) {\n                        sheet._activeDrawing = null;\n                        if (disabled) {\n                            event.preventDefault();\n                            return;\n                        }\n                        if (casual) {\n                            this.editor.value(\"\");\n                        }\n                        this.activateEditor(casual);\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n\n            onShiftAction: function(event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n                event.preventDefault();\n            },\n\n            onMouseMove: function(event) {\n                var sheet = this._workbook.activeSheet();\n\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n\n                var object = this.objectAt(event);\n                if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n\n                sheet._renderComment(object.type == \"cell\" ? object.ref : null);\n            },\n\n            onMouseDown: function(event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n\n                if (this._startResizingDrawing(event, object)) {\n                    event.stopPropagation();\n                    return;\n                }\n\n                var sheet = this._workbook.activeSheet();\n                var win = this.container.closest('[' + kendo.attr(\"role\") + '=\"window\"]');\n                if (win.length) {\n                    win = kendo.widgetInstance(win);\n                    if (win && win.options.modal) {\n                        event.stopPropagation();\n                    }\n                }\n\n                sheet._activeDrawing = null;\n                if (object.type === \"drawing\") {\n                    sheet._activeDrawing = object.drawing;\n                    object.copy = object.drawing.clone();\n                    object.startBox = sheet.drawingBoundingBox(object.copy);\n                    sheet.startDragging(object);\n                    sheet.triggerChange({ dragging: true });\n                    event.preventDefault();\n                    return;\n                }\n\n                if (object.type === \"outside\") {\n                    event.preventDefault();\n                    event.stopPropagation();\n                    return;\n                }\n\n                if (object.type === \"editor\") {\n                    // XXX: canceling the edits, because they might not\n                    // validate.  Not sure it's the Right Thing.\n                    this.onEditorEsc();\n                    this.openCustomEditor();\n                    event.preventDefault();\n                    return;\n                }\n\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this._preventNavigation = false;\n                    this.editor.deactivate();\n                    if (this._preventNavigation) {\n                        return;     // validation error\n                    }\n                }\n\n                if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n                    sheet.startResizing({ x: object.x, y: object.y });\n                    event.preventDefault();\n                    return;\n                }\n\n                if (object.type === \"filtericon\") {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n            },\n\n            _startResizingDrawing: function(event) {\n                var handle = $(event.target).closest(\".k-spreadsheet-drawing-handle\");\n                if (handle.length) {\n                    var location = this.translateCoords(event);\n                    var direction = handle.data(\"direction\");\n                    var sheet = this._workbook.activeSheet();\n                    var drawing = sheet._activeDrawing;\n                    sheet.startDragging({\n                        pane     : this.originFrame,\n                        drawing  : drawing,\n                        copy     : drawing.clone(),\n                        startBox : sheet.drawingBoundingBox(drawing),\n                        resize   : direction,\n                        //aspect   : drawing.width / drawing.height,\n                        startX   : location.x,\n                        startY   : location.y\n                    });\n                    return true;\n                }\n            },\n\n            onContextMenu: function(event) {\n                var sheet = this._workbook.activeSheet();\n\n                event.preventDefault();\n\n                if (sheet.resizingInProgress() || sheet.draggingInProgress()) {\n                    return;\n                }\n\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                this.drawingContextMenu.close();\n\n                var menu;\n\n                var object = this.objectAt(event);\n\n                if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n                    return;\n                }\n\n                if (object.ref) {\n                    this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                } else if (object.type == \"drawing\") {\n                    this.navigator.selectDrawingForContextMenu(object.drawing);\n                }\n\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n\n                if (object.type == \"columnheader\") {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == \"rowheader\") {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else if (object.type == \"drawing\") {\n                    menu = this.drawingContextMenu;\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n\n                // avoid the immediate close\n                setTimeout(function() {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n\n            prevent: function(event) {\n                event.preventDefault();\n            },\n\n            constrainResize: function(type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n\n                return !resizeHandle || type === \"outside\" || type === \"topcorner\" || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n\n            _dragDrawing: function(event) {\n                var sheet = this._workbook.activeSheet();\n                var drag = sheet.draggingInProgress();\n                if (!drag) {\n                    return false;\n                }\n\n                var location = this.translateCoords(event);\n                var drawing = drag.drawing;\n                var deltaX = location.x - drag.startX;\n                var deltaY = location.y - drag.startY;\n\n                if (drag.resize == \"SE\") {\n                    if (drag.aspect) {\n                        if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                            drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                            drawing.height = drawing.width / drag.aspect;\n                        } else {\n                            drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                            drawing.width = drawing.height * drag.aspect;\n                        }\n                    } else {\n                        drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                        drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                    }\n                }\n                else if (drag.resize == \"E\") {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                }\n                else if (drag.resize == \"S\") {\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                }\n                else if (drag.resize == \"N\") {\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                }\n                else if (drag.resize == \"W\") {\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                }\n                else if (drag.resize == \"NE\") {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                }\n                else if (drag.resize == \"SW\") {\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                }\n                else if (drag.resize == \"NW\") {\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                }\n                // just moving (no resize)\n                else {\n                    drawing.offsetX = drag.copy.offsetX + deltaX;\n                    drawing.offsetY = drag.copy.offsetY + deltaY;\n                }\n\n                sheet.triggerChange({ dragging: true });\n\n                return true;\n            },\n\n            onMouseDrag: function(event) {\n                if (this._selectionMode === \"sheet\") {\n                    return;\n                }\n\n                var location = { clientX: event.clientX, clientY: event.clientY };\n                var sheet = this._workbook.activeSheet();\n\n                if (this._dragDrawing(event)) {\n                    return;\n                }\n\n                var object = this.objectAt(location);\n\n                if (sheet.resizingInProgress()) {\n\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({ x: object.x, y: object.y });\n                    }\n\n                    return;\n                }\n\n                if (object.type === \"outside\") {\n                    this.startAutoScroll(object);\n                    return;\n                }\n\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else { // cross frame selection\n                    var frame = this.originFrame._grid;\n\n                    if (object.x > frame.right) {\n                        kendo.scrollLeft(this);\n                    }\n\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n\n                event.preventDefault();\n            },\n\n            onMouseUp: function(event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                sheet.completeDragging();\n\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n\n            onDblClick: function(event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n\n                if (object.type !== \"cell\" || disabled) {\n                    return;\n                }\n\n                var sel = this._workbook.activeSheet().selection();\n                this.activateEditor(!sel.value() && !sel.formula());\n                this.onEditorUpdate();\n            },\n\n            onCut: function(e) {\n                var self = this;\n                setTimeout(function(){\n                    self.clipboard.menuInvoked = (e === undefined);\n                    self._execute({\n                        command: \"CutCommand\",\n                        options: { workbook: self.view._workbook, event: e.originalEvent || e }\n                    });\n                });\n            },\n\n            clipBoardValue: function() {\n                return this.clipboardElement.html();\n            },\n\n            _pasteImage: function(blob) {\n                var self = this;\n                var img = new window.Image();\n                img.src = window.URL.createObjectURL(blob);\n                img.onload = function() {\n                    self._execute({\n                        command: \"InsertImageCommand\",\n                        options: {\n                            blob: blob,\n                            width: img.width,\n                            height: img.height\n                        }\n                    });\n                };\n                setTimeout(function(){\n                    window.URL.revokeObjectURL(img.src);\n                }, 10);\n            },\n\n            onPaste: function(e) {\n                var self = this;\n                var html = \"\";\n                var plain = \"\";\n                self.clipboard.menuInvoked = (e === undefined);\n                if (e) {\n                    var clipboardData = e.originalEvent.clipboardData;\n                    if (clipboardData && clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        // Firefox uses DOMStringList, needs special handling\n                        if (window.DOMStringList && clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = clipboardData.types.contains(\"text/html\");\n                            hasPlainText = clipboardData.types.contains(\"text/plain\");\n                        } else if (Array.isArray(clipboardData.types)) {\n                            hasHTML = clipboardData.types.indexOf(\"text/html\") >= 0;\n                            hasPlainText = clipboardData.types.indexOf(\"text/plain\") >= 0;\n                        } else {\n                            hasHTML = /text\\/html/.test(clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = clipboardData.getData('text/html').trim();\n                        }\n                        if (hasPlainText) {\n                            plain = clipboardData.getData('text/plain').trim();\n                        }\n                        if (!html && !plain && clipboardData.items && clipboardData.items.length) {\n                            for (var i = 0; i < clipboardData.items.length; ++i) {\n                                var item = clipboardData.items[i];\n                                if (item.kind == \"file\" && /^image\\/(?:png|jpe?g|gif)$/i.test(item.type)) {\n                                    return self._pasteImage(item.getAsFile());\n                                }\n                            }\n                        }\n                    } else {\n                        if (window.clipboardData.files && window.clipboardData.files.length) {\n                            var file = window.clipboardData.files[0];\n                            if (/^image\\/(?:png|jpe?g|gif)$/i.test(file.type)) {\n                                return self._pasteImage(file);\n                            }\n                        }\n\n                        plain = window.clipboardData.getData(\"Text\");\n                        if (plain) {\n                            plain = plain.trim();\n                        }\n\n                        // There's no way to get the HTML clipboard contents in IE other than letting\n                        // the browser handle the event (it pastes into our clipboardElement), and then\n                        // we can read the HTML from there.  Need to allow a small timeout for this.\n                        self.clipboardElement.empty();\n                        setTimeout(function(){\n                            html = self.clipboardElement.html();\n                            if (html || plain) {\n                                self.clipboard.external({ html: html, plain: plain });\n                                self._execute({\n                                    command: \"PasteCommand\",\n                                    options: { workbook: self.view._workbook, event: e.originalEvent || e }\n                                });\n                            }\n                        });\n\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        self.clipboardElement.trigger(\"focus\").select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        self.clipboard.menuInvoked = true;\n                    }\n                }\n\n                if (!html && !plain) {\n                    return;\n                }\n                self.clipboard.external({ html: html, plain:plain });\n                self._execute({\n                    command: \"PasteCommand\",\n                    options: { workbook: self.view._workbook, event: e.originalEvent || e }\n                });\n            },\n\n            onCopy: function(e) {\n                this.clipboard.menuInvoked = (e === undefined);\n                this._execute({\n                    command: \"CopyCommand\",\n                    options: { workbook: this.view._workbook, event: e.originalEvent || e }\n                });\n            },\n\n    ////////////////////////////////////////////////////////////////////\n\n            scrollTop: function() {\n                this.scroller.scrollTop = 0;\n            },\n\n            scrollLeft: function() {\n                this.scroller.scrollLeft = 0;\n            },\n\n            scrollDown: function(value) {\n                this.scroller.scrollTop += value;\n            },\n\n            scrollRight: function(value) {\n                this.scroller.scrollLeft += value;\n            },\n\n            scrollWith: function(right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n\n            translateCoords: function(location) {\n                var box = this.container[0].getBoundingClientRect();\n                return {\n                    x: location.clientX - box.left,\n                    y: location.clientY - box.top\n                };\n            },\n\n            objectAt: function(location, noDrawing) {\n                if (!location) {\n                    return;\n                }\n                location = this.translateCoords(location);\n                return this.view.objectAt(location.x, location.y, noDrawing);\n            },\n\n            selectToLocation: function(cellLocation) {\n                var object = this.objectAt(cellLocation, true);\n\n                if (object.pane && object.ref) { // cell, rowheader or columnheader\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n\n                this.stopAutoScroll();\n            },\n\n            extendSelection: function(object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode);\n            },\n\n            autoScroll: function() {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n\n            startAutoScroll: function(viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n\n                this.finalLocation = location || this.lastKnownCellLocation;\n\n                this._autoScrollTarget = viewObject;\n            },\n\n            stopAutoScroll: function() {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n\n            openCustomEditor: function() {\n                this.view.openCustomEditor();\n            },\n\n            openFilterMenu: function(event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n\n                filterMenu.bind(\"action\", this.onCommandRequest.bind(this));\n                filterMenu.bind(\"action\", filterMenu.close.bind(filterMenu));\n\n                filterMenu.openFor(event.target, event);\n            },\n\n    ////////////////////////////////////////////////////////////////////\n\n            _saveEditorValue: function(arrayFormula) {\n                var sheet = this.editor._range.sheet();\n                var value = this.editor.value();\n                if (this._workbook.activeSheet() !== sheet) {\n                    // remove highlighted refs (XXX: which are mostly wrong, BTW)\n                    this._workbook.activeSheet()._setFormulaSelections();\n                    // go back to the original sheet\n                    this._workbook.activeSheet(sheet);\n                }\n                sheet.isInEditMode(false);\n                this._lastEditorValue = value;\n                this._execute({\n                    command: \"EditCommand\",\n                    options: {\n                        value: value,\n                        arrayFormula: arrayFormula\n                    }\n                });\n            },\n\n            onEditorChange: function() {\n                this._saveEditorValue(false);\n            },\n\n            onEditorArrayFormula: function() {\n                this._saveEditorValue(true);\n                this.editor.deactivate(true);\n            },\n\n            onEditorActivate: function() {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n\n            onEditorDeactivate: function() {\n                var sheet = this._workbook.activeSheet();\n\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n\n            onEditorUpdate: function() {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n\n            onEditorBarFocus: function() {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor\n                    .activate({\n                        range: this._workbook.activeSheet().selection(),\n                        rect: this.view.activeCellRectangle(),\n                        tooltip: this._activeTooltip()\n                    });\n            },\n\n            onEditorCellFocus: function() {\n                this.editor.scale();\n            },\n\n            onEditorEsc: function() {\n                this.resetEditorValue();\n                this.editor.deactivate();\n\n                this.clipboardElement.trigger(\"focus\");\n            },\n\n            insertNewline: function(e) {\n                e.preventDefault();\n                this.editor.insertNewline();\n            },\n\n            onEditorBlur: function(_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n\n                this._preventNavigation = false;\n                this.editor.deactivate();\n\n                if (!this._preventNavigation) {\n                    this.clipboardElement.trigger(\"focus\");\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n\n            onEditorAction: function(event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n\n                if (this._casualEditing && /^(?:up|right|down|left)$/.test(action)) {\n                    this.deactivateEditor();\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    event.preventDefault();\n                }\n                else if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n\n            onEditorShiftAction: function(event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n\n                    event.preventDefault();\n                }\n            },\n\n    ////////////////////////////////////////////////////////////////////\n            resetEditorValue: function() {\n                var sheet = this._workbook.activeSheet();\n                var ref = sheet.activeCell();\n                var input = this._workbook._inputForRef(ref);\n                var x = sheet.range(ref).intersectingArrayFormula();\n                if (x) {\n                    input = \"=\" + x.formula;\n                }\n                this.editor.value(input, !!x);\n            },\n\n            activateEditor: function(casual) {\n                // This flag will be false when F2 has been pressed, and\n                // true when editing is \"casual\", i.e., user just started\n                // typing.  In this case we want arrow keys to do cell\n                // navigation rather than move the cursor.\n                // https://github.com/telerik/kendo-ui-core/issues/3644\n                this._casualEditing = casual;\n\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n            },\n\n            deactivateEditor: function() {\n                this.view.editor.deactivate();\n            },\n\n            onCommandRequest: function(e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n\n            onDialogRequest: function(e) {\n                var additionalOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n\n                if (e.options) {\n                    $.extend(true, e.options, additionalOptions);\n                } else {\n                    e.options = additionalOptions;\n                }\n\n                this.view.openDialog(e.name, e.options);\n            },\n\n            onNameEditorEnter: function() {\n                var ref;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var name = this.view.nameEditor.value();\n\n                // 1. does it look like a reference, or already defined\n                // name?  If so, just select it (don't define/modify any\n                // names)\n                ref = kendo.spreadsheet.calc.parseReference(name, true) || workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        // reference points to another sheet, select it if found\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n\n                ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n\n                // XXX: should we check if a name is already defined for this range, and update it instead?\n                // Excel just adds a new one, and provides a more complete Name Manager dialog.\n                //var def = workbook.nameForRef(ref, sheet.name());\n\n                // just define new name\n                this._execute({\n                    command: \"DefineNameCommand\",\n                    options: { name: name, value: ref }\n                });\n\n                this.clipboardElement.trigger(\"focus\");\n            },\n            onNameEditorCancel: function() {\n                this.clipboardElement.trigger(\"focus\");\n            },\n            onNameEditorSelect: function(ev) {\n                var name = ev.name;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var ref = workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        // reference points to another sheet, select it if found\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                this.clipboardElement.trigger(\"focus\");\n            },\n            onNameEditorDelete: function(ev) {\n                this._execute({\n                    command: \"DeleteNameCommand\",\n                    options: { name: ev.name }\n                });\n                this.clipboardElement.trigger(\"focus\");\n            }\n        });\n\n        kendo.spreadsheet.Controller = Controller;\n    })(window.kendo);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = \".\";\n        var RESIZE_HANDLE_WIDTH = 7;\n        var EDIT_BUTTON_WIDTH = 20;\n        var ERROR = \"Error\";\n        var viewClassNames = {\n            view: \"k-spreadsheet-view\",\n            fixedContainer: \"k-spreadsheet-fixed-container\",\n            editContainer: \"k-spreadsheet-edit-container\",\n            scroller: \"k-spreadsheet-scroller\",\n            viewSize: \"k-spreadsheet-view-size\",\n            clipboard: \"k-spreadsheet-clipboard\",\n            cellEditor: \"k-spreadsheet-cell-editor\",\n            barEditor: \"k-spreadsheet-editor\",\n            topCorner: \"k-spreadsheet-top-corner\",\n            filterHeadersWrapper: \"k-filter-wrapper\",\n            filterRange: \"k-filter-range\",\n            filterButton: \"k-spreadsheet-filter\",\n            filterButtonSelected: \"k-selected\",\n            horizontalResize: \"k-horizontal-resize\",\n            verticalResize: \"k-vertical-resize\",\n            icon: \"k-icon\",\n            iconFilterDefault: \"caret-alt-down\",\n            sheetsBar: \"k-spreadsheet-sheets-bar\",\n            sheetsBarActive: \"k-spreadsheet-sheets-bar-active\",\n            sheetsBarInactive: \"k-spreadsheet-sheets-bar-inactive\",\n            cellContextMenu: \"k-spreadsheet-cell-context-menu\",\n            rowHeaderContextMenu: \"k-spreadsheet-row-header-context-menu\",\n            colHeaderContextMenu: \"k-spreadsheet-col-header-context-menu\",\n            drawingContextMenu: \"k-spreadsheet-drawing-context-menu\"\n        };\n\n        kendo.spreadsheet.messages.view = {\n            nameBox: \"Name Box\",\n            formulaInput: \"Formula Input\",\n            errors: {\n                openUnsupported: \"Unsupported format. Please select an .xlsx file.\",\n                shiftingNonblankCells: \"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.\",\n                insertColumnWhenRowIsSelected: \"Cannot insert column when all columns are selected.\",\n                insertRowWhenColumnIsSelected: \"Cannot insert row when all rows are selected.\",\n                filterRangeContainingMerges: \"Cannot create a filter within a range containing merges\",\n                sortRangeContainingMerges: \"Cannot sort a range containing merges\",\n                cantSortMultipleSelection: \"Cannot sort multiple selection\",\n                cantSortNullRef: \"Cannot sort empty selection\",\n                cantSortMixedCells: \"Cannot sort range containing cells of mixed shapes\",\n                validationError: \"The value that you entered violates the validation rules set on the cell.\",\n                cannotModifyDisabled: \"Cannot modify disabled cells.\",\n                insertRowBelowLastRow: \"Cannot insert row below the last row.\",\n                insertColAfterLastCol: \"Cannot insert column to the right of the last column.\"\n            },\n            tabs: {\n                home: \"Home\",\n                insert: \"Insert\",\n                data: \"Data\"\n            }\n        };\n\n        kendo.spreadsheet.messages.menus = {\n            \"cut\"          : \"Cut\",\n            \"copy\"         : \"Copy\",\n            \"paste\"        : \"Paste\",\n            \"merge\"        : \"Merge\",\n            \"unmerge\"      : \"Unmerge\",\n            \"delete\"       : \"Delete\",\n            \"hide\"         : \"Hide\",\n            \"unhide\"       : \"Unhide\",\n            \"bringToFront\" : \"Bring to front\",\n            \"sendToBack\"   : \"Send to back\"\n        };\n\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n\n            var range = document.createRange();\n            range.selectNodeContents(el);\n\n            sel.addRange(range);\n        }\n\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row-1];\n            var index = table.trs[row].children.length-1;\n\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n\n        function cellBorder(value) {\n            return (value.size || 1) + \"px solid \" + (value.color || \"#000\");\n        }\n\n        function asURL(link) {\n            if (!/:\\/\\//.test(link)) {\n                link = \"http://\" + link;\n            }\n            return link;\n        }\n\n        function drawCell(collection, cell, cls, showGrid) {\n            function maybeLink(el) {\n                var link = cell.link;\n                if (!link) {\n                    if (typeof cell.value == \"object\") {\n                        link = cell.value.link;\n                    }\n                }\n                if (link) {\n                    var style = {\n                        textDecoration: \"none\"\n                    };\n                    if (cell.color) {\n                        style.color = cell.color;\n                    }\n                    if (cell.underline) {\n                        style.textDecoration = \"underline\";\n                    }\n                    return kendo.dom.element(\"a\", {\n                        href   : asURL(link),\n                        style  : style,\n                        target : \"_blank\" // XXX: customizable?\n                    }, el ? [ el ] : []);\n                }\n                return el;\n            }\n\n            var shouldDraw = (cell.value != null || (cell.validation != null && !cell.validation.value) || // jshint ignore:line\n                              cell.background || cell.merged || cell.comment || cell.dBorders);\n            if (!cls && !shouldDraw) {\n                return;\n            }\n\n            var style = { background: [] };\n            var background = cell.background;\n            if (background) {\n                var defaultBorder = background;\n                if (showGrid) {\n                    // darken\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n                style.outline = defaultBorder;\n            }\n\n            if (cell.dBorders) {\n                if (cell.dBorders.type & 2) {\n                    style.background.push(\"linear-gradient(to top left, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                          cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                          cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n                }\n                if (cell.dBorders.type & 1) {\n                    style.background.push(\"linear-gradient(to top right, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                          cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                          cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n                }\n            }\n\n            if (background) {\n                style.background.push(background);\n            }\n\n            if (cell.color) {\n                style.color = cell.color;\n            }\n\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n\n            if (cell.underline) {\n                style.textDecoration = \"underline\";\n            }\n\n            if (cell.italic) {\n                style.fontStyle = \"italic\";\n            }\n\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n\n            if (cell.bold) {\n                style.fontWeight = \"bold\";\n            }\n\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + \"px\";\n            }\n\n            if (cell.wrap === true) {\n                style.whiteSpace = \"pre-wrap\";\n                style.overflowWrap = \"break-word\";\n                style.wordWrap = \"break-word\";\n            } else {\n                style.whiteSpace = \"pre\";\n                style.overflowWrap = \"normal\";\n                style.wordWrap = \"normal\";\n            }\n\n            style.left = (cell.left + 1) + \"px\";\n            style.top = (cell.top + 1) + \"px\";\n            style.width = (cell.width - 1) + \"px\";\n            style.height = (cell.height - 1) + \"px\";\n\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == \"number\" && data != Math.floor(data)) {\n                format = \"0.##############\";\n            }\n            if (format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data != null) {\n                if (cell.html) {\n                    data = kendo.dom.html(data);\n                } else {\n                    data = kendo.dom.text(data);\n                }\n            }\n\n            if (!style.textAlign) {\n                switch (type) {\n                  case \"number\":\n                  case \"date\":\n                  case \"percent\":\n                  case \"currency\":\n                    style.textAlign = \"right\";\n                    break;\n                  case \"boolean\":\n                    style.textAlign = \"center\";\n                    break;\n                }\n            }\n\n            // defined in print.js\n            kendo.spreadsheet.draw.applyIndent(cell, style);\n\n            var classNames = [ paneClassNames.cell ];\n\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push(\"k-disabled\");\n            }\n            if (cell.merged) {\n                classNames.push(\"k-spreadsheet-merged-cell\");\n                if (!cell.enable) {\n                    collection.push(kendo.dom.element(\"div\", {\n                        className: \"k-spreadsheet-disabled-mask\",\n                        style: {\n                            left: (cell.left + 1) + \"px\",\n                            top: (cell.top + 1) + \"px\",\n                            width: (cell.width - 1) + \"px\",\n                            height: (cell.height - 1) + \"px\"\n                        }\n                    }));\n                }\n            }\n            if (cell.comment) {\n                classNames.push(\"k-spreadsheet-has-comment\");\n            }\n\n            var verticalAlign = cell.verticalAlign || \"bottom\";\n\n            if (verticalAlign && data) {\n                data = kendo.dom.element(\"div\", { className: \"k-vertical-align-\" + verticalAlign }, [ maybeLink(data) ]);\n            } else {\n                data = maybeLink(data);\n            }\n\n            if (style.background.length) {\n                style.background = style.background.join(\",\");\n            } else {\n                delete style.background;\n            }\n\n            var children = data ? [ data ] : [];\n            var properties = {\n                style: style\n            };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element(\"span\", { className: \"k-dirty\" }));\n                classNames.push(\"k-dirty-cell\");\n\n                properties.title = validation.message;\n            }\n            properties.className = classNames.join(\" \");\n\n            var div = kendo.dom.element(\"div\", properties, children);\n            collection.push(div);\n            return div;\n        }\n\n        function addCell(table, row, cell) {\n            var style = {};\n\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n\n            if (cell.color) {\n                style.color = cell.color;\n            }\n\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n\n            if (cell.underline) {\n                style.textDecoration = \"underline\";\n            }\n\n            if (cell.italic) {\n                style.fontStyle = \"italic\";\n            }\n\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n\n            if (cell.verticalAlign) {\n                style.verticalAlign = (cell.verticalAlign === \"center\") ? \"middle\" : cell.verticalAlign;\n            }\n\n            if (cell.bold) {\n                style.fontWeight = \"bold\";\n            }\n\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + \"px\";\n            }\n\n            if (cell.wrap === true) {\n                style.whiteSpace = \"pre-wrap\";\n            }\n\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == \"number\" && data != Math.floor(data)) {\n                format = \"0.##############\";\n            }\n            if (format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n\n            var attrs = { style: style };\n\n            if (!style.textAlign) {\n                switch (type) {\n                  case \"number\":\n                  case \"date\":\n                  case \"percent\":\n                  case \"currency\":\n                    style.textAlign = \"right\";\n                    break;\n                  case \"boolean\":\n                    style.textAlign = \"center\";\n                    break;\n                }\n            }\n\n            if (!/^(?:string|undefined)$/.test(type)) {\n                // provide original value and number format for better\n                // interoperability with google sheets and libre office.\n                attrs.sdval = cell.value;\n                attrs[\"data-sheets-value\"] = JSON.stringify({ 1: 3, 3: cell.value });\n                if (format) {\n                    attrs.sdnum = format;\n                    attrs[\"data-sheets-numberformat\"] = JSON.stringify({ 1: 2, 2: format, 3: 1 });\n                }\n            }\n            if (cell.formula) {\n                attrs[\"data-sheets-formula\"] = \"=\" + cell.formula.print();\n            }\n\n            var className = null;\n\n            if (cell.enable === false) {\n                className = \"k-disabled\";\n            }\n\n            var td = table.addCell(row, data, attrs, className, cell.validation);\n\n            var border, sibling;\n\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n\n            return td;\n        }\n\n        var HtmlTable = kendo.Class.extend({\n            init: function() {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n\n            addColumn: function(width) {\n                this._width += width;\n\n                var col = kendo.dom.element(\"col\", { style: { width: width + \"px\" } });\n\n                col.visible = width > 0;\n\n                this.cols.push(col);\n            },\n\n            addRow: function(height) {\n                var attr = null;\n\n                attr = { style: { height: height + \"px\" } };\n\n                this._height += height;\n\n                var tr = kendo.dom.element(\"tr\", attr);\n\n                tr.visible = height > 0;\n\n                this.trs.push(tr);\n            },\n\n            addCell: function(rowIndex, text, attrs, className, validation) {\n                if (text === null || text === undefined) {\n                    text = \"\";\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n\n                var children = [ text ];\n\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element(\"span\", { className: \"k-dirty\" }));\n\n                    className = (className || \"\") + (className ? \" \" : \"\") + \"k-dirty-cell\";\n                    attrs.title = validation.message;\n                }\n\n                if (className) {\n                    attrs.className = className;\n                }\n                var td = kendo.dom.element(\"td\", attrs, children);\n\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n\n            toDomTree: function(x, y, className) {\n                this.trs = this.trs.filter(function(tr) {\n                    return tr.visible;\n                });\n\n                var offset = 0;\n                this.cols = this.cols.filter(function(col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function(tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n\n                    return col.visible;\n                }, this);\n\n                return kendo.dom.element(\"table\", {\n                    style: { left: x + \"px\", top: y + \"px\", height: this._height + \"px\", width: this._width + \"px\" },\n                    className: className,\n                    role: \"presentation\"\n                },[\n                    kendo.dom.element(\"colgroup\", null, this.cols),\n                    kendo.dom.element(\"tbody\", null, this.trs)\n                ]);\n            }\n        });\n\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' +\n            '<li data-action=cut>#: messages.cut #</li>' +\n            '<li data-action=copy>#: messages.copy #</li>' +\n            '<li data-action=paste>#: messages.paste #</li>' +\n            '<li class=\"k-separator\"></li>' +\n            '<li data-action=merge>#: messages.merge #</li>' +\n            '<li data-action=unmerge>#: messages.unmerge #</li>' +\n        '</ul>';\n\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' +\n            '<li data-action=cut>#: messages.cut #</li>' +\n            '<li data-action=copy>#: messages.copy #</li>' +\n            '<li data-action=paste>#: messages.paste #</li>' +\n            '<li class=\"k-separator\"></li>' +\n            '<li data-action=\"delete-row\">#: messages.delete #</li>'+\n            '<li data-action=\"hide-row\">#: messages.hide #</li>'+\n            '<li data-action=\"unhide-row\">#: messages.unhide #</li>'+\n        '</ul>';\n\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' +\n            '<li data-action=cut>#: messages.cut #</li>' +\n            '<li data-action=copy>#: messages.copy #</li>' +\n            '<li data-action=paste>#: messages.paste #</li>' +\n            '<li class=\"k-separator\"></li>' +\n            '<li data-action=\"delete-column\">#: messages.delete #</li>'+\n            '<li data-action=\"hide-column\">#: messages.hide #</li>'+\n            '<li data-action=\"unhide-column\">#: messages.unhide #</li>'+\n        '</ul>';\n\n        var DRAWING_CONTEXT_MENU = '<ul class=\"#=classNames.drawingContextMenu#\">' +\n            // '<li data-action=cut>#: messages.cut #</li>' +\n            // '<li data-action=copy>#: messages.copy #</li>' +\n            // '<li data-action=paste>#: messages.paste #</li>' +\n            // '<li class=\"k-separator\"></li>' +\n            '<li data-action=\"bring-to-front\">#: messages.bringToFront #</li>' +\n            '<li data-action=\"send-to-back\">#: messages.sendToBack #</li>' +\n            '<li class=\"k-separator\"></li>' +\n            '<li data-action=\"delete-drawing\">#: messages.delete #</li>' +\n        '</ul>';\n\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n\n        var VIEW_CONTENTS = '<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' +\n            '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' +\n            CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU + DRAWING_CONTEXT_MENU;\n\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n\n        var View = kendo.Class.extend({\n            init: function(element, options) {\n                var classNames = View.classNames;\n\n                this.element = element;\n\n                this.options = $.extend(true, {\n                    messages: kendo.spreadsheet.messages.view\n                }, this.options, options);\n\n                this._chrome();\n\n                this._dialogs = [];\n\n                element.append(kendo.template(VIEW_CONTENTS)({\n                    classNames: classNames,\n                    messages: kendo.spreadsheet.messages.menus\n                }));\n\n                this._formulaInput();\n\n                this.wrapper =      element.find(DOT + classNames.view);\n                this.container =    element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller =     element.find(DOT + classNames.scroller)[0];\n                this.clipboard =    element.find(DOT + classNames.clipboard);\n\n                this.viewSize = $(this.scroller.firstChild);\n\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n\n                this._sheetsbar();\n\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: \"never\" // this is just an invalid event name to prevent the show\n                };\n\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n\n                this.drawingContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.drawingContextMenu), contextMenuConfig);\n            },\n\n            enableClipboard: function(enable) {\n                this.isClipboardDeactivated = !enable;\n\n                if (enable) {\n                    this.clipboard.attr(\"contenteditable\", enable);\n                } else {\n                    this.clipboard.removeAttr(\"contenteditable\");\n                }\n            },\n\n            _resize: function() {\n                var actionBar = $(this.formulaBar.element).parents(\".k-spreadsheet-action-bar\");\n                var outerHeight = kendo._outerHeight;\n                var tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n                var formulaBarHeight = actionBar ? outerHeight(actionBar) : 0;\n                var sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n\n                this.wrapper.height(\n                    this.element.height() -\n                        (tabstripHeight + formulaBarHeight + sheetsBarHeight)\n                );\n\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n\n            _chrome: function() {\n                var wrapper = $(\"<div class='k-spreadsheet-action-bar' />\").prependTo(this.element);\n\n                var nameEditor = $(\"<div class='k-spreadsheet-name-editor' />\").appendTo(wrapper);\n                this.nameEditor = new kendo.spreadsheet.NameEditor(nameEditor, this.options);\n\n                var formulaBar = $(\"<div />\").appendTo(wrapper);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar, this.options);\n\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n\n            _formulaInput: function() {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, {\n                    autoScale: true\n                });\n            },\n\n            _sheetsbar: function() {\n                if (this.options.sheetsbar) {\n                    var options = $.extend(true, {\n                        openDialog: this.openDialog.bind(this)\n                    }, this.options.sheetsbar);\n\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), options);\n                }\n            },\n\n            _tabstrip: function() {\n                var messages = this.options.messages.tabs;\n                var options = $.extend(true, { home: true, insert: true, data: true }, this.options.toolbar);\n                var tabs = [];\n\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children(\".k-tabstrip\").remove();\n                }\n\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({ id: name, text: messages[name], content: \"\" });\n                    }\n                }\n\n                this.tabstrip = new kendo.spreadsheet.TabStrip($(\"<div />\").prependTo(this.element), {\n                    animation: false,\n                    dataTextField: \"text\",\n                    dataContentField: \"content\",\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n\n                this.tabstrip.select(0);\n            },\n\n            _executeCommand: function(e) {\n                this._sheet.trigger(\"commandRequest\", e);\n            },\n\n            workbook: function(workbook) {\n                this._workbook = workbook;\n                workbook._view = this;\n                this.nameEditor._workbook = workbook;\n            },\n\n            sheet: function(sheet) {\n                this._sheet = sheet;\n            },\n\n            activeCellRectangle: function() {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n\n            _rectangle: function(pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n\n            isColumnResizer: function(x, pane, col) {\n                // relative to content\n                x -= this._sheet._grid._headerWidth;\n\n                // add scroll if pane is not frozen\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n\n                col = this._sheet._grid._columns.locate(0, col, function(w){\n                    return Math.abs(x - w) <= RESIZE_HANDLE_WIDTH/2;\n                });\n\n                return col !== null && !this._sheet.isHiddenColumn(col) ? col : null;\n            },\n\n            isRowResizer: function(y, pane, row) {\n                // relative to content\n                y -= this._sheet._grid._headerHeight;\n\n                // add scroll if pane is not frozen\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n\n                row = this._sheet._grid._rows.locate(0, row, function(h){\n                    return Math.abs(y - h) <= RESIZE_HANDLE_WIDTH/2;\n                });\n\n                return row !== null && !this._sheet.isHiddenRow(row) ? row : null;\n            },\n\n            isFilterIcon: function(x, y, pane, ref) {\n                var self = this;\n                var theGrid = pane._grid;\n                var scrollTop = theGrid.rows.frozen ? 0 : self.scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : self.scroller.scrollLeft;\n\n                x -= self._sheet._grid._headerWidth - scrollLeft;\n                y -= self._sheet._grid._headerHeight - scrollTop;\n\n                return kendo.util.withExit(function(exit){\n                    self._sheet.forEachFilterHeader(ref, function(ref) {\n                        var rect = self._rectangle(pane, ref);\n                        if (pane.filterIconRect(rect).intersects(x, y)) {\n                            exit(true);\n                        }\n                    });\n                });\n            },\n\n            isAutoFill: function(x, y, pane) {\n                var selection = this._sheet.select();\n\n                if (selection.size > 1) {\n                    return false;\n                }\n\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n\n                var rectangle = this._rectangle(pane, selection);\n\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n\n            isEditButton: function(x, y, pane) {\n                var ed = this._sheet.activeCellCustomEditor();\n                if (ed) {\n                    var r = this.activeCellRectangle();\n                    // XXX: hard-coded button width (20)\n\n                    if (y >= r.top && y <= r.bottom) {\n                        this._editorInLastColumn = pane._editorInLastColumn;\n                        return pane._editorInLastColumn ? x < r.left && x >= r.left - EDIT_BUTTON_WIDTH\n                            : x > r.right && x <= r.right + EDIT_BUTTON_WIDTH;\n                    }\n                }\n            },\n\n            drawingAt: function(x, y, pane) {\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n\n                var sheet = this._sheet;\n                var drawings = this._sheet._drawings;\n                for (var i = drawings.length; --i >= 0;) {\n                    var d = drawings[i];\n                    var box = sheet.drawingBoundingBox(d);\n                    if (box.intersects(x, y)) {\n                        return {\n                            drawing: d,\n\n                            // also include how far is the drawing's\n                            // top-left from the mouse position, as it's\n                            // not easy to compute some place else.\n                            drx: box.left - x,\n                            dry: box.top - y\n                        };\n                    }\n                }\n            },\n\n            objectAt: function(x, y, noDrawing) {\n                var grid = this._sheet._grid;\n                var object, pane;\n\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: \"outside\" };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: \"topcorner\" };\n                } else {\n                    pane = this.paneAt(x, y);\n\n                    if (!pane) {\n                        object = { type: \"outside\" };\n                    } else {\n                        if (!noDrawing) {\n                            var drawing = this.drawingAt(x, y, pane);\n                            if (drawing) {\n                                return {\n                                    type: \"drawing\",\n                                    drawing: drawing.drawing,\n                                    drx: drawing.drx,\n                                    dry: drawing.dry,\n                                    pane: pane,\n                                    startX: x,\n                                    startY: y\n                                };\n                            }\n                        }\n\n                        var row = pane._grid.rows.indexVisible(y, this.scroller.scrollTop);\n                        var column = pane._grid.columns.indexVisible(x, this.scroller.scrollLeft);\n\n                        var type = \"cell\";\n                        var ref = new CellRef(row, column);\n                        var selecting = this._sheet.selectionInProgress();\n\n                        if (this.isAutoFill(x, y, pane)) {\n                            type = \"autofill\";\n                        } else if (this.isFilterIcon(x, y, pane, ref)) {\n                            type = \"filtericon\";\n                        } else if (!selecting && x < grid._headerWidth) {\n                            type = \"rowheader\";\n                            if ((row = this.isRowResizer(y, pane, row)) !== null) {\n                                ref = new CellRef(row, -Infinity);\n                                type = \"rowresizehandle\";\n                            }\n                        } else if (!selecting && y < grid._headerHeight) {\n                            type = \"columnheader\";\n                            if ((column = this.isColumnResizer(x, pane, column)) !== null) {\n                                ref = new CellRef(-Infinity, column);\n                                type = \"columnresizehandle\";\n                            }\n                        } else if (this.isEditButton(x, y, pane)) {\n                            type = \"editor\";\n                        }\n\n                        object = { type: type, ref: ref };\n                    }\n                }\n\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n\n            paneAt: function(x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n\n            containingPane: function(cell) {\n                return this.panes.filter(function(pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n\n            cellRectangle: function(cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n\n                return rectangle.offset(\n                    theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft),\n                    theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop)\n                );\n            },\n\n            refresh: function(reason) {\n                var sheet = this._sheet;\n\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()), reason);\n                }\n\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n\n                this._resize();\n\n                //TODO: refresh sheets list on sheetSelection\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + \"px\";\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + \"px\";\n\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n\n                    // main or bottom or right pane\n                    this.panes = [ this._pane(frozenRows, frozenColumns) ];\n\n                    // left pane\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n\n                    // top pane\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n\n                    // left-top \"fixed\" pane\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n\n            createFilterMenu: function(column) {\n                this._destroyFilterMenu();\n\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $(\"<div />\").appendTo(this.element);\n                var options = { column: column, range: range };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n\n                this._filterMenu = filterMenu;\n\n                return filterMenu;\n            },\n\n            selectClipboardContents: function() {\n                if (!this.isClipboardDeactivated) {\n                    this.clipboard.focus();\n                    selectElementContents(this.clipboard[0]);\n                }\n            },\n\n            scrollIntoView: function(cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n\n                var boundaries = theGrid.scrollBoundaries(cell);\n\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n\n                return willScroll;\n            },\n\n            _destroyDialog: function() {\n                this._dialogs.pop();\n            },\n\n            openCustomEditor: function() {\n                var self = this;\n                var cell = self._sheet.activeCell().first();\n                var editor = self._sheet.activeCellCustomEditor();\n                var range = self._sheet.range(cell);\n                editor.edit({\n                    range      : range,\n                    rect       : self.activeCellRectangle(),\n                    view       : this,\n                    validation : this._sheet.validation(cell),\n                    alignLeft  : this._editorInLastColumn,\n                    callback   : function(value, parse){\n                        self._executeCommand({\n                            command: \"EditCommand\",\n                            options: {\n                                operatingRange: range,\n                                editRange: range,\n                                property: parse ? \"input\" : \"value\",\n                                value: value\n                            }\n                        });\n                    }\n                });\n            },\n\n            openDialog: function(name, options) {\n                var that = this,\n                    sheet = this._sheet;\n\n                return sheet.withCultureDecimals(function(){\n                    var dialog = kendo.spreadsheet.dialogs.create(name, options);\n\n                    if (dialog) {\n                        dialog.bind(\"action\", that._executeCommand.bind(that));\n                        dialog.bind(\"deactivate\", () => {\n                            dialog.destroy();\n                            that._destroyDialog();\n                        });\n                        that._dialogs.push(dialog);\n\n                        var ref = sheet.activeCell();\n                        var range = new kendo.spreadsheet.Range(ref, sheet);\n\n                        dialog.open(range);\n                        return dialog;\n                    }\n                }.bind(this));\n            },\n\n            showError: function(options, reopenEditor) {\n                var currentDialogs = this._dialogs;\n                var errorMessages = this.options.messages.errors;\n                var hasOpenedError = false;\n\n                if (currentDialogs.length > 0) {\n                    currentDialogs.forEach(function(dialog) {\n                        if (dialog.options && dialog.options.title === ERROR) {\n                            hasOpenedError = true;\n                        }\n                    });\n                }\n                if (hasOpenedError) {\n                    return;\n                }\n\n                var focusButton = function(e) {\n                    var cont = e.sender.dialog().element;\n                    cont.find(\".k-button\").first().trigger(\"focus\");\n                    cont.find(\".k-button, input\").on(\"keydown\", function(ev){\n                        if (ev.keyCode == kendo.keys.ESC) {\n                            e.sender.close();\n                        }\n                    });\n                };\n\n                var onClose = function(e) {\n                    var dlg = e.sender;\n                    this.selectClipboardContents();\n                    if (dlg._retry && reopenEditor) {\n                        reopenEditor();\n                    }\n                }.bind(this);\n\n                if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                    var dialogOptions = {\n                        close: onClose\n                    };\n\n                    if (options.type === \"validationError\") {\n                        dialogOptions = $.extend(dialogOptions, {\n                            title: options.title || \"Error\",\n                            text: options.body ? options.body : errorMessages[options.type],\n                            activate: focusButton\n                        });\n                    }\n\n                    this.openDialog(options.type, dialogOptions);\n                } else {\n                    this.openDialog(\"message\", {\n                        title : options.title || \"Error\",\n                        text  : options.body ? options.body : errorMessages[options.type],\n                        activate: focusButton,\n                        close: onClose\n                    });\n                }\n            },\n\n            destroy: function() {\n                this._dialogs.forEach(function(dialog) {\n                    dialog.destroy();\n                });\n\n                if (this.cellContextMenu) {\n                    this.cellContextMenu.destroy();\n                }\n\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                this.drawingContextMenu.destroy();\n\n                this.cellContextMenu = this.rowHeaderContextMenu =\n                                       this.colHeaderContextMenu =\n                                       this.drawingContextMenu = null;\n\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.tabstrip = null;\n                }\n\n                if (this.nameEditor) {\n                    this.nameEditor.destroy();\n                }\n\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n\n                if (this.formulaBar) {\n                    this.formulaBar.destroy();\n                }\n\n                this._destroyFilterMenu();\n            },\n\n            _destroyFilterMenu: function() {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n\n            render: function(reason) {\n                if (!this.element.is(\":visible\")) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                var scrollbarSize = kendo.support.scrollbar();\n                var contentWidth = this.wrapper[0].clientWidth - scrollbarSize;\n                var contentHeight = this.wrapper[0].clientHeight - scrollbarSize;\n\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n\n                var resizeDirection =\n                    !sheet.resizingInProgress() ? \"none\" :\n                    sheet.resizeHandlePosition().col === -Infinity ? \"column\" :\n                    \"row\";\n\n                this.wrapper\n                    .toggleClass(viewClassNames.editContainer, this.editor.isActive())\n                    .toggleClass(viewClassNames.horizontalResize, resizeDirection == \"row\")\n                    .toggleClass(viewClassNames.verticalResize, resizeDirection == \"column\");\n\n                var grid = sheet._grid;\n                var content = [];\n                var args = {\n                    scroller: this.scroller,\n                    toplevelElements: content,\n                    contentWidth: contentWidth,\n                    contentHeight: contentHeight\n                };\n                this.panes.forEach(function(pane) {\n                    content.push(pane.render(args));\n                });\n\n                var topCorner = kendo.dom.element(\"div\", {\n                    style: { width: grid._headerWidth + \"px\", height: grid._headerHeight + \"px\" },\n                    className: View.classNames.topCorner\n                });\n\n                content.push(topCorner);\n\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    content.push(this.renderResizeHint());\n                }\n\n                this.tree.render(content);\n\n                $(this.container).css({\n                    width: contentWidth,\n                    height: contentHeight\n                });\n\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!(reason.resize ||\n                             reason.comment ||\n                             sheet.selectionInProgress() ||\n                             sheet.resizingInProgress() ||\n                             sheet.draggingInProgress() ||\n                             sheet.isInEditMode())) {\n                    this.renderClipboardContents();\n                }\n            },\n\n            // this renders the big blue line during resizing\n            renderResizeHint: function() {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n\n                var horizontal = ref.col !== -Infinity;\n\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + \"px\",\n                        width: RESIZE_HANDLE_WIDTH + \"px\",\n                        left: sheet.resizeHintPosition().x + \"px\",\n                        top: \"0px\"\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + \"px\",\n                        width: this.scroller.clientWidth + \"px\",\n                        top: sheet.resizeHintPosition().y + \"px\",\n                        left: \"0px\"\n                    };\n                }\n\n                var classNames = Pane.classNames;\n\n                return kendo.dom.element(\"div\", {\n                    className: classNames.resizeHint + (!horizontal ? \" \" + classNames.resizeHintVertical : \"\"),\n                    style: style\n                },[\n                    kendo.dom.element(\"div\", { className: classNames.resizeHintHandle }),\n                    kendo.dom.element(\"div\", { className: classNames.resizeHintMarker })\n                ]);\n            },\n\n            renderClipboardContents: function() {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n\n                // if (sheet._activeDrawing && sheet._activeDrawing.image) {\n                //     var url = this._workbook.imageUrl(sheet._activeDrawing.image);\n                //     var img = kendo.dom.element(\"img\", {\n                //         src: url,\n                //         style: {\n                //             width: sheet._activeDrawing.width + \"px\",\n                //             height: sheet._activeDrawing.height + \"px\"\n                //         }\n                //     });\n                //     this.clipboardContents.render([ img ]);\n                //     this.selectClipboardContents();\n                //     return;\n                // }\n\n                var selection = grid.normalize(sheet.select().toRangeRef());\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipboardContents();\n                    return;\n                }\n\n                selection = sheet.trim(selection);\n\n                var table = new HtmlTable();\n\n                var selectionView = grid.rangeDimensions(selection);\n\n                selectionView.rows.forEach(function(height) {\n                    table.addRow(height);\n                });\n\n                selectionView.columns.forEach(function(width) {\n                    table.addColumn(width);\n                });\n\n                var tmp = sheet._getMergedCells(selection);\n                var primaryMergedCells = tmp.primary;\n                var secondaryMergedCells = tmp.secondary;\n\n                sheet.forEach(selection, function(row, col, cell) {\n                    var location = new CellRef(row, col).print();\n\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n\n                        var mergedCell = primaryMergedCells[location];\n\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n\n                if (kendo.support.browser.msie) {\n                    this.clipboard.empty();\n                }\n\n                this.clipboardContents.render([ table.toDomTree(0, 0, \"kendo-clipboard-\" + this._workbook.clipboard()._uid) ]);\n\n                this.selectClipboardContents();\n            },\n\n            _pane: function(row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({ row: row, column: column, rowCount: rowCount, columnCount: columnCount }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n\n        var paneClassNames = {\n            cell: \"k-spreadsheet-cell\",\n            vaxis: \"k-spreadsheet-vaxis\",\n            haxis: \"k-spreadsheet-haxis\",\n            vborder: \"k-spreadsheet-vborder\",\n            hborder: \"k-spreadsheet-hborder\",\n            rowHeader: \"k-spreadsheet-row-header\",\n            columnHeader: \"k-spreadsheet-column-header\",\n            pane: \"k-spreadsheet-pane\",\n            data: \"k-spreadsheet-data\",\n            mergedCell: \"k-spreadsheet-merged-cell\",\n            mergedCellsWrapper: \"k-merged-cells-wrapper\",\n            activeCell: \"k-spreadsheet-active-cell\",\n            selection: \"k-spreadsheet-selection\",\n            selectionWrapper: \"k-selection-wrapper\",\n            autoFillWrapper: \"k-auto-fill-wrapper\",\n            single: \"k-single\",\n            top: \"k-top\",\n            right: \"k-right\",\n            bottom: \"k-bottom\",\n            left: \"k-left\",\n            resizeHandle: \"k-resize-handle\",\n            columnResizeHandle: \"k-column-resize-handle\",\n            rowResizeHandle: \"k-row-resize-handle\",\n            resizeHint: \"k-resize-hint\",\n            resizeHintHandle: \"k-resize-hint-handle\",\n            resizeHintMarker: \"k-resize-hint-marker\",\n            resizeHintVertical: \"k-resize-hint-vertical\",\n            selectionHighlight: \"k-spreadsheet-selection-highlight\",\n            series: [\n                \"k-series-a\",\n                \"k-series-b\",\n                \"k-series-c\",\n                \"k-series-d\",\n                \"k-series-e\",\n                \"k-series-f\"\n            ]\n        };\n\n        var Pane = kendo.Class.extend({\n            init: function(sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n\n            refresh: function(width, height) {\n                this._grid.refresh(width, height);\n            },\n\n            isVisible: function(scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n\n            render: function(args) {\n                var scroller = args.scroller;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n\n                var children = [];\n\n                children.push(this.renderData(args));\n\n                if (!sheet._activeDrawing) {\n                    children.push(this.renderSelection(scroller));\n                }\n\n                children.push(this.renderAutoFill());\n\n                children.push(this.renderEditorSelection());\n\n                children.push(this.renderFilterHeaders());\n\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element(\"div\", {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + \"px\",\n                            top: view.rowOffset + \"px\"\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function(row){\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element(\"div\", {\n                                className: this.headerClassName(row, \"row\"),\n                                style: {\n                                    width: grid.headerWidth + \"px\",\n                                    height: height + \"px\"\n                                }\n                            }, [ kendo.dom.element(\"div\", {\n                                className: \"k-vertical-align-center\"\n                            }, [ kendo.dom.text(text+\"\") ])]));\n                        }\n                    }.bind(this));\n                }\n\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element(\"div\", {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: \"0px\",\n                            left: view.columnOffset + \"px\",\n                            width: this._currentRect.width + \"px\",\n                            height: grid.headerHeight + \"px\"\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function(row, col){\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col),\n                                width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element(\"div\", {\n                                className: this.headerClassName(col, \"col\"),\n                                style: {\n                                    position: \"absolute\",\n                                    left: left + \"px\",\n                                    width: width + \"px\",\n                                    height: grid.headerHeight + \"px\"\n                                }\n                            }, [ kendo.dom.element(\"div\", {\n                                className: \"k-vertical-align-center\"\n                            }, [ kendo.dom.text(text+\"\") ])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    if (!sheet.resizeHintPosition()) {\n                        this.renderResizeHandle(children);\n                    }\n                }\n\n                var paneClasses = [classNames.pane];\n\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n\n                return kendo.dom.element(\"div\", {\n                    style: grid.style,\n                    className: paneClasses.join(\" \")\n                }, children);\n            },\n\n            headerClassName: function(index, type) {\n                var selectedHeaders = this._selectedHeaders;\n\n                var itemSelection;\n                var allHeaders;\n\n                if (type === \"row\") {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n\n                var className = itemSelection || (selectedHeaders.all ? \"full\" : (allHeaders ? \"partial\" : \"none\"));\n\n                if (className) {\n                    className = \"k-selection-\" + className;\n                }\n\n                return className;\n            },\n\n            renderData: function(args) {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                var cont = kendo.dom.element(\"div\", {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: \"relative\",\n                        left: view.columnOffset + \"px\",\n                        top: view.rowOffset + \"px\"\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n                var grid = this._grid;\n                var showGridLines = sheet._showGridLines;\n                if (showGridLines) {\n                    // draw axis first\n                    prev = null;\n                    layout.xCoords.forEach(function(x){\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element(\"div\", {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + \"px\",\n                                    height: rect.height + \"px\",\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function(y){\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element(\"div\", {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + \"px\",\n                                    width: rect.width + \"px\",\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                }\n                var borders = kendo.spreadsheet.draw.Borders();\n                var activeCellRange = sheet.activeCell().toRangeRef();\n                var activeCell = activeCellRange.topLeft;\n\n                layout.cells.forEach(function(cell){\n                    var cls = null;\n                    var absRow = cell.row + view.ref.topLeft.row;\n                    var absCol = cell.col + view.ref.topLeft.col;\n                    if (sheet._activeDrawing) {\n                        var ref = sheet._activeDrawing.topLeftCell;\n                        if (ref && ref.row == absRow && ref.col == absCol) {\n                            cls = \"k-spreadsheet-drawing-anchor-cell\";\n                        }\n                    } else if (absRow == activeCell.row && absCol == activeCell.col) {\n                        // active cell.  normally we enter here only once.\n                        cls = [\n                            Pane.classNames.activeCell\n                        ].concat(this._activeFormulaColor(),\n                                 this._directionClasses(activeCellRange));\n                        if (sheet.singleCellSelection()) {\n                            cls.push(Pane.classNames.single);\n                        }\n                        cls = cls.join(\" \");\n                    }\n                    borders.add(cell);\n                    drawCell(cont.children, cell, cls, showGridLines);\n                    if (cell.comment && sheet._commentRef &&\n                        absRow == sheet._commentRef.row && absCol == sheet._commentRef.col) {\n                        var ttOffset = 4;\n                        var left = cell.right + grid.left + view.columnOffset + ttOffset;\n                        var style = { top: (cell.top + grid.top + view.rowOffset) + \"px\" };\n                        if (left + 200 > args.contentWidth) {\n                            style.right = (args.contentWidth - grid.left - cell.left - view.columnOffset + ttOffset) + \"px\";\n                        } else {\n                            style.left = left + \"px\";\n                        }\n                        var div = kendo.dom.element(\"div\", {\n                            className: \"k-tooltip k-spreadsheet-cell-comment\",\n                            style: style\n                        }, [ kendo.dom.text(cell.comment) ]);\n                        args.toplevelElements.push(div);\n                    }\n                }, this);\n                borders.vert.forEach(function(a){\n                    a.forEach(function(b){\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                left        : b.x + \"px\",\n                                top         : b.top + \"px\",\n                                height      : (b.bottom - b.top + 1) + \"px\",\n                                borderWidth : b.size + \"px\",\n                                borderColor : b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = \"translateX(-\" + (b.size-1)/2 + \"px)\";\n                            }\n                            cont.children.push(kendo.dom.element(\"div\", {\n                                className: paneClassNames.vborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function(a){\n                    a.forEach(function(b){\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                top         : b.y + \"px\",\n                                left        : b.left + \"px\",\n                                width       : (b.right - b.left) + \"px\",\n                                borderWidth : b.size + \"px\",\n                                borderColor : b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = \"translateY(-\" + (b.size-1)/2 + \"px)\";\n                            }\n                            cont.children.push(kendo.dom.element(\"div\", {\n                                className: paneClassNames.hborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                this.renderDrawings(layout, cont.children);\n                return cont;\n            },\n\n            renderDrawings: function(layout, container) {\n                var sheet = this._sheet;\n                var workbook = sheet._workbook;\n                layout.drawings.forEach(function(d){\n                    var drawing = d.drawing;\n                    var box = d.box;\n                    var div = box.toDiv(\"k-spreadsheet-drawing\");\n                    if (drawing.image) {\n                        div.children.push(kendo.dom.element(\"div\", {\n                            className: \"k-spreadsheet-drawing-image\",\n                            style: {\n                                backgroundImage: \"url('\" + workbook.imageUrl(drawing.image) + \"')\",\n                                opacity: drawing.opacity\n                            }\n                        }));\n                    }\n                    if (drawing === sheet._activeDrawing) {\n                        div.attr.className += \" k-spreadsheet-active-drawing\";\n                        drawingResizeHandles(div.children);\n                    }\n                    container.push(div);\n                });\n            },\n\n            renderResizeHandle: function(container) {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var classNames = [ Pane.classNames.resizeHandle ];\n\n                var style;\n                if (ref.col !== -Infinity) {\n                    if (this._grid.rows._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: this._grid.headerHeight + \"px\",\n                        width: RESIZE_HANDLE_WIDTH + \"px\",\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH/2  + \"px\",\n                        top: \"0px\"\n                    };\n                    classNames.push(viewClassNames.horizontalResize);\n                } else {\n                    if (this._grid.columns._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + \"px\",\n                        width:  this._grid.headerWidth + \"px\",\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH/2  + \"px\",\n                        left: \"0px\"\n                    };\n                    classNames.push(viewClassNames.verticalResize);\n                }\n\n                container.push(kendo.dom.element(\"div\", {\n                    className: classNames.join(\" \"),\n                    style: style\n                }));\n            },\n\n            filterIconRect: function(rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n\n                return new kendo.spreadsheet.Rectangle(\n                    rect.right - BUTTON_SIZE - BUTTON_OFFSET,\n                    rect.top + BUTTON_OFFSET,\n                    BUTTON_SIZE,\n                    BUTTON_SIZE\n                );\n            },\n\n            renderFilterHeaders: function() {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n\n                function icon(iconName) {\n                    return kendo.dom.element($(kendo.ui.icon(iconName))[0]);\n                }\n\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + \"px\",\n                        top: position.top + \"px\"\n                    };\n                    var filtered = filter && filter.columns.some(function(c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n\n                    if (filtered) {\n                        classes += \" \" + classNames.filterButtonSelected;\n                    }\n\n                    var button = kendo.dom.element(\n                        \"span\",\n                        { className: classes, style: style },\n                        [ icon(classNames.iconFilterDefault) ]\n                    );\n\n                    return button;\n                }\n\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n\n                sheet.forEachFilterHeader(this._currentView.ref, function(ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n\n                    children.push(button);\n                }.bind(this));\n\n                return kendo.dom.element(\"div\", {\n                    className: classNames.filterHeadersWrapper\n                }, children);\n\n            },\n\n            renderEditorSelection: function() {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n\n                sheet._formulaSelections.forEach(function(range) {\n                    var ref = range.ref;\n\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n\n                    this._addDiv(selections, ref, classNames.selectionHighlight + \" \" + range.colorClass);\n                }.bind(this));\n\n                return kendo.dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n\n            },\n\n            renderSelection: function(scroller) {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var selection = sheet.select();\n\n                selectionClasses = selectionClasses.concat(this._activeFormulaColor());\n\n                if (selection.size() === 1) {\n                    selectionClasses.push(\"k-single-selection\");\n                }\n\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push(\"k-dim-auto-fill-handle\");\n                }\n\n                selection.forEach(function(ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(\" \"));\n                    }\n                }.bind(this));\n\n                this._renderCustomEditorButton(selections, activeCell, scroller);\n\n                return kendo.dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n            },\n\n            renderAutoFill: function() {\n                var autoFillRectangle = [];\n\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n\n                    this._addDiv(autoFillRectangle, autoFillRef, \"k-auto-fill\");\n\n                    if (punch) { // collapsing, add overlay\n                        this._addDiv(autoFillRectangle, punch, \"k-auto-fill-punch\");\n                    } else if (direction !== undefined) { // expanding - add hint\n                        var ref, cssClass;\n\n                        switch(direction) {\n                            case 0:\n                                ref = autoFillRef.bottomRight;\n                                cssClass = \"k-auto-fill-br-hint\";\n                                break;\n                            case 1:\n                                ref = autoFillRef.bottomRight;\n                                cssClass = \"k-auto-fill-br-hint\";\n                                break;\n                            case 2:\n                                ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                                cssClass = \"k-auto-fill-tr-hint\";\n                                break;\n                            case 3:\n                                ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                                cssClass = \"k-auto-fill-bl-hint\";\n                                break;\n                        }\n\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            var hint = kendo.dom.element(\"span\", { className: \"k-tooltip\" }, [ kendo.dom.text(this._sheet._autoFillHint) ]);\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n\n                return kendo.dom.element(\"div\", { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n\n            _addDiv: function(collection, ref, className) {\n                var view = this._currentView, div;\n\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n\n            _renderCustomEditorButton: function(collection, ref, scroller) {\n                var self = this;\n                var sheet = self._sheet;\n                var view = self._currentView;\n                var columnCount = self._grid.columns._axis._count;\n                var ed = sheet.activeCellCustomEditor();\n\n                if (ed && view.ref.intersects(ref)) {\n                    var rectangle = self._rectangle(ref);\n                    sheet.forEach(ref.collapse(), function(row, col, cell) {\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n\n                        var btnClass = \"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-spreadsheet-editor-button\";\n                        var isLastColumn = col == columnCount - 1 || self._buttonOutOfVisiblePane(row, col, scroller);\n                        if (isLastColumn) {\n                            btnClass += \" k-spreadsheet-last-column\";\n                        }\n                        self._editorInLastColumn = isLastColumn;\n                        var btn = kendo.dom.element(\"div\", {\n                            className: btnClass,\n                            style: {\n                                left   : (cell.left + (isLastColumn ? -EDIT_BUTTON_WIDTH : cell.width)) + \"px\",\n                                top    : cell.top + \"px\",\n                                height : cell.height + \"px\"\n                            }\n                        });\n                        if (ed.icon) {\n                            btn.children.push(kendo.dom.element($(kendo.ui.icon(ed.icon.replace(/^k-i-/, \"\")))[0]));\n                        }\n                        collection.push(btn);\n                    });\n                }\n            },\n\n            _activeFormulaColor: function() {\n                var activeFormulaSelection;\n                var colorClasses = [];\n\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function(sel) { return sel.active && sel.type == \"ref\"; })[0];\n\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n\n                return colorClasses;\n            },\n\n            _directionClasses: function(cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n\n                return cellClasses;\n            },\n\n            _rectangle: function(ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            },\n\n            _buttonOutOfVisiblePane: function(row, col, scroller) {\n                var self = this;\n                var theGrid = self._grid;\n                var sheet = self._sheet;\n                var ref = sheet.range(row, col)._ref;\n                var boundaries = theGrid.scrollBoundaries(ref);\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n                if (boundaries.right + EDIT_BUTTON_WIDTH > scrollLeft || col + 1 === sheet.frozenColumns()) {\n                    return true;\n                }\n            }\n        });\n\n        function drawingResizeHandles(container) {\n            [ \"N\", \"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\" ].forEach(function(direction) {\n                container.push(kendo.dom.element(\"div\", {\n                    \"className\": \"k-spreadsheet-drawing-handle \" + direction,\n                    \"data-direction\": direction\n                }));\n            });\n        }\n\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n        \"use strict\";\n\n\n\n        var $ = kendo.jQuery;\n\n        var EDITORS = {};\n\n        var registerEditor = kendo.spreadsheet.registerEditor = function(name, editor) {\n            EDITORS[name] = editor;\n        };\n\n        kendo.spreadsheet.Sheet.prototype.activeCellCustomEditor = function() {\n            var cell = this.activeCell().first();\n\n            if (this.range(cell).enable()) {\n                var val = this.validation(cell);\n                var key = this._properties.get(\"editor\", this._grid.cellRefIndex(cell));\n                var editor;\n\n                if (key != null) {\n                    editor = EDITORS[key];\n                }\n                else if (val && val.showButton) {\n                    key = \"_validation_\" + val.dataType;\n                    editor = EDITORS[key];\n                }\n\n                if (typeof editor == \"function\") {\n                    editor = EDITORS[key] = editor();\n                }\n\n                return editor;\n            }\n        };\n\n        registerEditor(\"_validation_date\", function(){\n            var context, calendar, popup;\n\n            function create() {\n                if (!calendar) {\n                    calendar = $(\"<div>\").kendoCalendar();\n                    popup = $(\"<div>\").kendoPopup();\n                    calendar.appendTo(popup);\n                    calendar = calendar.getKendoCalendar();\n                    popup = popup.getKendoPopup();\n\n                    calendar.bind(\"change\", function(){\n                        popup.close();\n                        var date = calendar.value();\n                        if (!context.range.format()) {\n                            context.range.format(\"yyyy-mm-dd\");\n                        }\n                        context.callback(kendo.spreadsheet.dateToNumber(date));\n                    });\n                }\n                popup.setOptions({\n                    anchor: context.view.element.find(\".k-spreadsheet-editor-button\"),\n                    origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                    position: context.alignLeft ? \"top right\" : \"top left\"\n                });\n            }\n\n            function open() {\n                create();\n\n                var date = context.range.value();\n                var sheet = context.range.sheet();\n                if (date != null) {\n                    calendar.value(kendo.spreadsheet.numberToDate(date));\n                } else {\n                    calendar.value(null);\n                }\n                var val = context.validation;\n                if (val) {\n                    var min = kendo.ui.Calendar.fn.options.min;\n                    var max = kendo.ui.Calendar.fn.options.max;\n                    var fromValidation = val.from;\n                    var toValidation = val.to;\n                    var formula = kendo.spreadsheet.calc.runtime.Formula;\n\n                    if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                        if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            min = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                        } else {\n                            min = kendo.spreadsheet.numberToDate(fromValidation.value);\n                        }\n                    }\n                    if (val.comparerType == \"between\") {\n                        if(toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                            max = kendo.spreadsheet.numberToDate(sheet.range(toValidation.value.row, toValidation.value.col).value());\n                        } else {\n                            max = kendo.spreadsheet.numberToDate(val.to.value);\n                        }\n                    }\n                    if (val.comparerType == \"lessThan\" || val.comparerType == \"lessThanOrEqualTo\") {\n                        if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            max = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                        } else {\n                            max = kendo.spreadsheet.numberToDate(val.from.value);\n                        }\n                    }\n                    calendar.setOptions({\n                        disableDates: function(date) {\n                            var from, to;\n\n                            if(fromValidation && fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                                from = sheet.range(fromValidation.value.row, fromValidation.value.col).value();\n                            } else {\n                                from = fromValidation ? fromValidation.value|0 : 0;\n                            }\n\n                            if(toValidation && toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                                to = sheet.range(toValidation.value.row, toValidation.value.col).value();\n                            } else {\n                                to = toValidation ? toValidation.value|0 : 0;\n                            }\n\n                            date = kendo.spreadsheet.dateToNumber(date) | 0;\n                            return !kendo.spreadsheet.validation\n                                .validationComparers[val.comparerType](date, from, to);\n                        },\n                        min: min,\n                        max: max\n                    });\n                } else {\n                    calendar.setOptions({ disableDates: null, min: null, max: null });\n                }\n                popup.open();\n            }\n\n            function _rowAndColPresent(value) {\n                return (value && value.row !== null && value.col !== null && value.row > -1 && value.col > -1);\n            }\n\n            return {\n                edit: function(options) {\n                    context = options;\n                    open();\n                },\n                icon: \"calendar\"\n            };\n        });\n\n        registerEditor(\"_validation_list\", function(){\n            var context, list, popup;\n            function create() {\n                if (!list) {\n                    list = $(\"<ul class='k-list k-reset'/>\").kendoStaticList({\n                        template   : \"#:value#\",\n                        selectable : true,\n                        autoBind   : false\n                    });\n                    popup = $(\"<div class='k-spreadsheet-list-popup'>\").kendoPopup();\n                    list.appendTo(popup);\n                    popup = popup.getKendoPopup();\n                    list = list.getKendoStaticList();\n\n                    list.bind(\"change\", function(){\n                        popup.close();\n                        var item = list.value()[0];\n                        if (item) {\n                            context.callback(item.value);\n                        }\n                    });\n                }\n                popup.setOptions({\n                    anchor: context.view.element.find(\".k-spreadsheet-editor-button\"),\n                    origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                    position: context.alignLeft ? \"top right\" : \"top left\"\n                });\n            }\n            function open() {\n                create();\n                var items = context.validation.from.value;\n                var data = [], add = function(el){ data.push({ value: el }); };\n                if (items instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    items.each(add);\n                } else {\n                    // actually Excel expects a simple string for list\n                    // validation (comma-separated labels).\n                    (items+\"\").split(/\\s*,\\s*/).forEach(add);\n                }\n                var dataSource = new kendo.data.DataSource({ data: data });\n                list.setDataSource(dataSource);\n                dataSource.read();\n                popup.open();\n            }\n            return {\n                edit: function(options) {\n                    context = options;\n                    open();\n                },\n                icon: \"caret-alt-down\"\n            };\n        });\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n        \n\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n\n        var Rectangle = kendo.Class.extend({\n            init: function Rectangle(left, top, width, height) {\n                this.left = left;\n                this.top = top;\n                this.width = width;\n                this.height = height;\n                this.right = this.left + this.width;\n                this.bottom = this.top + this.height;\n            },\n\n            offset: function(left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n\n            resize: function(width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n\n            intersects: function(x, y) {\n                if (x instanceof Rectangle) {\n                    return this.intersectsRect(x);\n                }\n                return this.left < x && x < this.left + this.width &&\n                       this.top < y && y < this.top + this.height;\n            },\n\n            intersectsRect: function(b) {\n                var a = this;\n                return a.left <= b.right\n                    && b.left <= a.right\n                    && a.top <= b.bottom\n                    && b.top <= a.bottom;\n            },\n\n            toDiv: function(className) {\n                return kendo.dom.element(\"div\", {\n                    className: className,\n                    style: {\n                        width:  this.width + \"px\",\n                        height: this.height + \"px\",\n                        top:    this.top + \"px\",\n                        left:   this.left + \"px\"\n                    }\n                });\n            }\n        });\n\n        // XXX: can we use ES5 yet? :-/\n        //\n        // Object.defineProperty(Rectangle.prototype, \"right\", {\n        //     get() {\n        //         return this.left + this.width;\n        //     }\n        // });\n        // Object.defineProperty(Rectangle.prototype, \"bottom\", {\n        //     get() {\n        //         return this.top + this.height;\n        //     }\n        // });\n\n        var Grid = kendo.Class.extend({\n            init: function(rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n\n            _resize: function(new_rows, new_cols) {\n                this.rowCount = new_rows;\n                this.columnCount = new_cols;\n            },\n\n            isAxis: function(ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return (topLeft.row === 0 && bottomRight.row === this.rowCount - 1) || (topLeft.col === 0 && bottomRight.col === this.columnCount - 1);\n            },\n\n            width: function(start, end) {\n                return this._columns.sum(start, end);\n            },\n\n            height: function(start, end) {\n                return this._rows.sum(start, end);\n            },\n\n            totalHeight: function() {\n                return this._rows.total + this._headerHeight;\n            },\n\n            totalWidth: function() {\n                return this._columns.total + this._headerWidth;\n            },\n\n            index: function(row, column) {\n                return column * this.rowCount + row;\n            },\n\n            cellRef: function(index) {\n                return new CellRef(index % this.rowCount, (index / this.rowCount) >> 0);\n            },\n\n            rowRef: function(row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n\n            colRef: function(col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n\n            cellRefIndex: function(ref) {\n                return this.index(ref.row, ref.col);\n            },\n\n            normalize: function(ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(\n                        this.normalize(ref.topLeft),\n                        this.normalize(ref.bottomRight)\n                    ).setSheet(ref.sheet, ref.hasSheet());\n                }\n\n                if (ref instanceof UnionRef) {\n                    return ref.map(function(ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n\n                if (ref instanceof CellRef) {\n                    ref = ref.clone();\n                    ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                    ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                }\n\n                return ref;\n            },\n\n            rectangle: function(ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(\n                    this.width(0, topLeft.col - 1),\n                    this.height(0, topLeft.row - 1),\n                    this.width(topLeft.col, bottomRight.col),\n                    this.height(topLeft.row, bottomRight.row)\n                );\n            },\n\n            pane: function(options) {\n                return new PaneGrid(\n                    new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight),\n                    new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth),\n                    this\n                );\n            },\n\n            rangeDimensions: function(rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n\n            forEach: function(ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri ++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n\n            trim: function(ref, property) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if(values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n\n        var PaneGrid = kendo.Class.extend({\n            init: function(rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n\n            refresh: function(width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n\n                this.style = {\n                    top: y.offset  + \"px\",\n                    left: x.offset + \"px\",\n                    height: y.length + \"px\",\n                    width: x.length + \"px\"\n                };\n            },\n\n            view: function(left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n\n                return {\n                    rows: rows,\n                    columns: columns,\n\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n\n                    ref: new RangeRef(\n                        new CellRef(rows.values.start, columns.values.start),\n                        new CellRef(rows.values.end, columns.values.end)\n                    )\n                };\n            },\n\n            contains: function(ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) &&\n                    this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n\n            index: function(row, column) {\n                return this._grid.index(row, column);\n            },\n\n            boundingRectangle: function(ref) {\n                return this._grid.rectangle(ref);\n            },\n\n            cellRefIndex: function(ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n\n            scrollBoundaries: function(cell) {\n                var position = this.boundingRectangle(cell);\n\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    })(kendo);\n\n    (function(kendo) {\n\n        var Axis = kendo.Class.extend({\n            init: function(count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n\n            _resize: function(count) {\n                if (count > this._count) {\n                    this.values.value(this._count, count - 1, this._value);\n                    this._hidden.value(this._count, count - 1, 0);\n                } else if (count < this._count) {\n                    this.values.value(count, this._count - 1, 0);\n                    this._hidden.value(count, this._count - 1, 0);\n                }\n                this._count = count;\n                this._refresh();\n            },\n\n            adjust: function(start, delta) {\n                // adjust this axis for insert/remove rows/cols operation\n                if (delta < 0) {\n                    // removing -- copy from start+|delta| to start\n                    this.values.copy(start - delta, this._count - 1, start);\n                    this._hidden.copy(start - delta, this._count - 1, start);\n                } else {\n                    // adding -- copy from start to start+delta, and set\n                    // values for inserted things to default.\n                    this.values.copy(start, this._count, start + delta);\n                    this._hidden.copy(start, this._count, start + delta);\n                    this.values.value(start, start + delta - 1, this._value);\n                    this._hidden.value(start, start + delta - 1, 0);\n                }\n                this._refresh();\n            },\n\n            toJSON: function(field, positions) {\n                var values = [];\n\n                var iterator = this.values.iterator(0, this._count - 1);\n\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    var hidden = this._hidden.value(idx, idx);\n\n                    if (value === this._value && !hidden) {\n                        continue;\n                    }\n\n                    var position = positions[idx];\n\n                    if (position === undefined) {\n                        position = values.length;\n\n                        var item = { index: idx };\n\n                        item[field] = value;\n                        if (hidden) {\n                            item.hidden = hidden;\n                        }\n\n                        values.push(item);\n\n                        positions[idx] = position;\n                    }\n                }\n\n                return values;\n            },\n\n            fromJSON: function(field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var el = values[idx];\n\n                    var index = el.index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n\n                    // when this particular axis is hidden, the value for\n                    // the field (\"height\" or \"width\") will be zero, and\n                    // in the \"hidden\" field we'll have the actual value\n                    // before it was hidden.\n                    // https://github.com/telerik/kendo-ui-core/issues/3523\n                    var value = el[field];\n\n                    if (value === 0) {\n                        this._hidden.value(index, index, el.hidden || this._value);\n                        this.value(index, index, 0);\n                    } else {\n                        this.value(index, index, value);\n                    }\n                }\n            },\n\n            hide: function(index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n\n            hidden: function(index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n\n            includesHidden: function(start, end) {\n                 return this._hidden.intersecting(start, end).length > 1;\n            },\n\n            nextVisible: function(index) {\n                var end = this._count - 1, i = index;\n                while (++i <= end) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n\n            nextUntil: function(index, pred) {\n                var end = this._count - 1, i = index, advanced = false;\n                while (++i <= end) {\n                    var val = pred(i, advanced, this.hidden(i));\n                    if (typeof val == \"number\") {\n                        return val;\n                    } else if (val) {\n                        break;\n                    }\n                    advanced = true;\n                }\n                return i - 1;\n            },\n\n            nextPage: function(index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n\n            prevPage: function(index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n\n            firstVisible: function() {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n\n            lastVisible: function() {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n\n            prevVisible: function(index) {\n                var i = index;\n                while (--i >= 0) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n\n            prevUntil: function(index, pred) {\n                var i = index, advanced = false;\n                while (--i >= 0) {\n                    var val = pred(i, advanced, this.hidden(i));\n                    if (typeof val == \"number\") {\n                        return val;\n                    } else if (val) {\n                        break;\n                    }\n                    advanced = true;\n                }\n                return i + 1;\n            },\n\n            unhide: function(index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n\n            value: function(start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n\n            sum: function(start, end) {\n                var values = this.values.iterator(start, end);\n\n                var sum = 0;\n\n                for (var idx = start; idx <= end; idx ++) {\n                    sum += values.at(idx);\n                }\n\n                return sum;\n            },\n\n            locate: function(start, end, predicate) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                    var val = predicate(sum);\n                    if (val) {\n                        return idx;\n                    }\n                }\n                return null;\n            },\n\n            visible: function(start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n\n                var ranges = this._pixelValues.intersecting(start, end);\n\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n\n                if (!startSegment) {\n                    return { values: this.values.iterator(0, 0), offset: 0 };\n                }\n\n                var startOffset = start - startSegment.start;\n\n                var startIndex = ((startOffset / startSegment.value.value) >> 0) + startSegment.value.start;\n\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n\n                var endOffset = end - endSegment.start;\n                var endIndex = ((endOffset / endSegment.value.value) >> 0) + endSegment.value.start;\n\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n\n                offset = Math.min(-offset, 0);\n\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n\n            index: function(value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n\n                return index;\n            },\n\n            indexVisible: function(value) {\n                var index = this.index(value);\n                if (this.hidden(index)) {\n                    index = this.prevVisible(index);\n                }\n                return index;\n            },\n\n            _refresh: function() {\n                var current = 0;\n                this._pixelValues = this.values.map(function(range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n\n            getState: function() {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState(),\n                    count: this._count\n                };\n            },\n\n            setState: function(state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                var nowCount = this._count;\n                if (nowCount > state.count) {\n                    this._count = state.count;\n                    this._resize(nowCount); // calls _refresh too\n                } else {\n                    this._refresh();\n                }\n            }\n        });\n\n        var PaneAxis = kendo.Class.extend({\n            init: function(axis, start, count, headerSize) {\n               this._axis = axis;\n               this._start = start;\n               this._count = count;\n               this.hasHeader = start === 0;\n               this.headerSize = headerSize;\n               this.defaultValue = axis._value;\n               this.frozen = count > 0;\n            },\n\n            viewSize: function(viewSize) {\n                this._viewSize = viewSize;\n            },\n\n            sum: function(start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n\n            start: function() {\n                return this.sum(0, this._start);\n            },\n\n            size: function() {\n                return this.sum(this._start, this._start + this._count);\n            },\n\n            index: function(value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n\n            indexVisible: function(value, offset) {\n                return this._axis.indexVisible(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n\n            //XXX: rename this method\n            paneSegment: function() {\n                var offset = this.start();\n                var length;\n\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n\n            visible: function(offset) {\n                var start = this.start();\n                var size;\n\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n\n                var result = this._axis.visible(start, start + size - 1);\n\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n\n                result.start = start;\n\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n\n                return result;\n            },\n\n            contains: function(start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n\n    })(kendo);\n\n    (function(kendo) {\n\n\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function() {\n            },\n            value: function(cell) {\n                return cell.value;\n            },\n            matches: function() {\n                throw new Error(\"The 'matches' method is not implemented.\");\n            },\n            toJSON: function() {\n                throw new Error(\"The 'toJSON' method is not implemented.\");\n            }\n        });\n\n        Filter.create = function(options) {\n            var filter = options.filter;\n\n            if (!filter) {\n                throw new Error(\"Filter type not specified.\");\n            }\n\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + \"Filter\"];\n\n            if (!constructor) {\n                throw new Error(\"Filter type not recognized.\");\n            }\n\n            return new constructor(options);\n        };\n\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n\n            _dates: [],\n\n            _blanks: false,\n\n            init: function ValueFilter(options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n\n            value: function(cell) {\n                var value = cell.value;\n\n                if (this._dates.length > 0 && cell.format && typeof value === \"number\") {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n\n                    if (type === \"date\") {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n\n                return value;\n            },\n\n            matches: function(value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n\n                if (value instanceof Date) {\n                    return this._dates.some(function(date) {\n                        return date.year === value.getFullYear() &&\n                            (date.month === undefined || date.month === value.getMonth()) &&\n                            (date.day === undefined || date.day === value.getDate()) &&\n                            (date.hours === undefined || date.hours === value.getHours()) &&\n                            (date.minutes === undefined || date.minutes === value.getMinutes()) &&\n                            (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function() {\n                return {\n                    filter: \"value\",\n                    blanks: this._blanks,\n                    values: this._values.slice(0)\n                };\n            }\n        });\n\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: \"and\",\n            init: function CustomFilter(options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n\n                if (options.criteria === undefined) {\n                    throw new Error(\"Must specify criteria.\");\n                }\n\n                this._criteria = options.criteria;\n\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria,\n                    accentFoldingFiltering: kendo.culture().name\n                }).expression;\n\n                this._matches = new Function(\"d\", \"return \" + expression);\n            },\n            matches: function(value) {\n                if (value === null) {\n                    return false;\n                }\n\n                return this._matches(value);\n            },\n            value: function(cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? \"date\" : typeof criterionValue;\n                var valueType = typeof value;\n\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n\n                if (valueType != criterionType) {\n                    if (criterionType == \"string\") {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + \"\";\n                    }\n                } else if (valueType == \"date\") {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n\n                return value;\n            },\n            toJSON: function() {\n                return {\n                    filter: \"custom\",\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function TopFilter(options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n\n            prepare: function(cells) {\n                var values = cells.map(this.value)\n                .sort()\n                .filter(function(value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n\n                if (this._type === \"topNumber\" || this._type == \"topPercent\") {\n                    values.sort(function(x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function(x, y) {\n                        return x - y;\n                    });\n                }\n\n                var count = this._value;\n\n                if (this._type === \"topPercent\" || this._type === \"bottomPercent\") {\n                    count = (values.length * count / 100) >> 0;\n                }\n\n                this._values = values.slice(0, count);\n            },\n            matches: function(value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function() {\n                return {\n                    filter: \"top\",\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function DynamicFilter(options) {\n                this._type = options.type;\n\n                this._predicate = this[options.type];\n\n                if (typeof this._predicate !== \"function\") {\n                    throw new Error(\"DynamicFilter type '\" + options.type + \"' not recognized.\");\n                }\n            },\n            value: function(cell) {\n                var value = cell.value;\n\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n\n                    if (type === \"date\") {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n\n                return value;\n            },\n            prepare: function(cells) {\n                var sum = 0;\n                var count = 0;\n\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n\n                    if (typeof value === \"number\") {\n                        sum += value;\n                        count ++;\n                    }\n                }\n\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function(value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function(value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n\n                if (typeof value !== \"number\") {\n                    return false;\n                }\n\n                return value > this._average;\n            },\n            belowAverage: function(value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n\n                if (typeof value !== \"number\") {\n                    return false;\n                }\n\n                return value < this._average;\n            },\n            tomorrow: function(value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n\n                return false;\n            },\n            today: function(value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n\n                return false;\n            },\n            yesterday: function(value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n\n                return false;\n            },\n            nextWeek: function(value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function(value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function(value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function(value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function(value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function(value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function(value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n\n                    var diff = quarter(value) - quarter(today);\n\n                    return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                           (diff == -3 && today.getFullYear() + 1 === value.getFullYear());\n                }\n\n                return false;\n            },\n            thisQuarter: function(value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n\n                    var diff = quarter(value) - quarter(today);\n\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n\n                return false;\n            },\n            lastQuarter: function(value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n\n                    var diff = quarter(today) - quarter(value);\n\n                    return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                           (diff == -3 && today.getFullYear() - 1 === value.getFullYear());\n                }\n\n                return false;\n            },\n            nextYear: function(value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function(value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function(value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function(value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n\n                return false;\n            },\n            toJSON: function() {\n                return {\n                    filter: \"dynamic\",\n                    type: this._type\n                };\n            }\n        });\n\n        [1, 2, 3, 4].forEach(function(target) {\n            kendo.spreadsheet.DynamicFilter.prototype[\"quarter\" + target] = function(value) {\n               if (value instanceof Date) {\n                  return quarter(value) === target;\n               }\n\n               return false;\n            };\n        });\n\n        kendo.cultures[\"en-US\"].calendar.months.names.forEach(function(month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function(value) {\n               if (value instanceof Date) {\n                   return value.getMonth() === index;\n               }\n\n               return false;\n            };\n        });\n\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if(month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n\n                today.setFullYear(today.getFullYear() + offset);\n\n                return today.getFullYear() === value.getFullYear();\n            }\n\n            return false;\n        }\n\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n\n                today.setMonth(today.getMonth() + offset, 1);\n\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n\n            return false;\n        }\n\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n\n            return false;\n        }\n\n    })(kendo);\n\n    (function(kendo) {\n\n        var Sorter = kendo.Class.extend({\n            init: function(grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n\n            indices: function(rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft),\n                    this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n\n            sortBy: function(ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n\n                return sortedIndices;\n            }\n        });\n\n        Sorter.ascendingComparer = function(a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n\n            if (a === null) {\n                return 1;\n            }\n\n            if (b === null) {\n                return -1;\n            }\n\n            var typeA = typeof a;\n            var typeB = typeof b;\n\n            if (typeA === \"number\") {\n                if (typeB === \"number\") {\n                    return a - b;\n                } else {\n                   return -1;\n                }\n            }\n\n            if (typeA === \"string\") {\n                switch (typeB) {\n                    case \"number\":\n                        return 1;\n                    case \"string\":\n                        return a.localeCompare(b);\n                    default:\n                        return -1;\n                }\n            }\n\n            if (typeA === \"boolean\") {\n                switch (typeB) {\n                    case \"number\":\n                        return 1;\n                    case \"string\":\n                        return 1;\n                    case \"boolean\":\n                        return a - b;\n                    default:\n                        return -1;\n                }\n            }\n\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n\n            throw new Error(\"Cannot compare \" + a + \" and \" + b);\n        };\n\n        Sorter.descendingComparer = function(a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n\n            if (a === null) {\n                return 1;\n            }\n\n            if (b === null) {\n                return -1;\n            }\n\n            return Sorter.ascendingComparer(b, a);\n        };\n\n        kendo.spreadsheet.Sorter = Sorter;\n    })(kendo);\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n\n        var util$1 = kendo.util;\n        var calc$2 = kendo.spreadsheet.calc;\n        var dom = kendo.dom;\n\n        var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n        var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n\n        /* The proper amount of suffering for whoever designed the Excel\n           Custom Number Format would be to have him implement the\n           formatter himself. */\n\n        function parse(input) {\n            input = calc$2.InputStream(input);\n            var sections = [], haveConditional = false, decimalPart;\n\n            while (!input.eof()) {\n                var sec = readSection();\n                sections.push(sec);\n                if (sec.cond) {\n                    haveConditional = true;\n                }\n            }\n\n            // From https://support.office.com/en-us/article/Create-or-delete-a-custom-number-format-78f2a361-936b-4c03-8772-09fab54be7f4:\n            //\n            //    A number format can have up to four sections of code, separated by semicolons. These\n            //    code sections define the format for positive numbers, negative numbers, zero values,\n            //    and text, in that order.\n            //\n            //    You do not have to include all code sections in your custom number format. If you\n            //    specify only two code sections for your custom number format, the first section is\n            //    used for positive numbers and zeros, and the second section is used for negative\n            //    numbers. If you specify only one code section, it is used for all numbers. If you want\n            //    to skip a code section and include a code section that follows it, you must include\n            //    the ending semicolon for the section that you skip.\n            //\n            // However, if sections have conditionals, it is not clear if:\n            //\n            //    - still at most four are allowed\n            //    - is the last section still for text\n            //\n            // We will assume that if no sections have conditionals, then there must be at most 4, and\n            // they will be interpreted in the order above.  If the first section contains a\n            // conditional, then there can be any number of them; if the last one is not conditional\n            // then it will be interpreted as text format.\n\n            if (!haveConditional) {\n                if (sections.length == 1) {\n                    sections[0].cond = \"num\";\n                }\n                else if (sections.length == 2) {\n                    sections[0].cond = { op: \">=\", value: 0 };\n                    sections[1].cond = { op: \"<\", value: 0 };\n                }\n                else if (sections.length >= 3) {\n                    sections[0].cond = { op: \">\", value: 0 };\n                    sections[1].cond = { op: \"<\", value: 0 };\n                    sections[2].cond = { op: \"=\", value: 0 };\n                    if (sections.length > 3) {\n                        sections[3].cond = \"text\";\n                        sections = sections.slice(0, 4);\n                    }\n                }\n            }\n\n            return sections;\n\n            function maybeColor() {\n                var m = input.skip(RX_COLORS);\n                if (m) {\n                    return m[1].toLowerCase();\n                }\n            }\n\n            function maybeCondition() {\n                var m = input.skip(RX_CONDITION);\n                if (m) {\n                    var val = parseFloat(m[2]);\n                    if (!isNaN(val)) {\n                        return { op: m[1], value: val, custom: true };\n                    }\n                }\n            }\n\n            function readFormat() {\n                var format = [], tok, prev = null;\n                while (!input.eof() && (tok = readNext())) {\n                    // disambiguate: m/mm might mean month or minutes depending on surrounding context.\n                    if (tok.type == \"date\") {\n                        if (prev && /^(el)?time$/.test(prev.type) && prev.part == \"h\"\n                            && tok.part == \"m\" && tok.format < 3) {\n                            // m or mm that follows hours should display minutes\n                            tok.type = \"time\";\n                        }\n                    } else if (/^(el)?time$/.test(tok.type) && tok.part == \"s\") {\n                        if (prev && prev.type == \"date\" && prev.part == \"m\"\n                            && prev.format < 3) {\n                            // m or mm followed by seconds should display minutes\n                            prev.type = \"time\";\n                        }\n                    }\n                    if (!(/^(?:str|space|fill)$/.test(tok.type))) {\n                        prev = tok;\n                    }\n                    format.push(tok);\n                }\n                return format;\n            }\n\n            function maybeFraction(tok) {\n                if (tok.type != \"date\" || (tok.part == \"m\" && tok.format < 3)) {\n                    var m = input.skip(/^\\.(0+)/);\n                    if (m) {\n                        tok.fraction = m[1].length;\n                        if (tok.type == \"date\") {\n                            tok.type = \"time\";\n                        }\n                    }\n                }\n                return tok;\n            }\n\n            function readNext() {\n                var ch, m;\n                // numbers\n                if ((m = input.skip(/^([#0?]+)(?:,([#0?]+))+/))) {\n                    // thousands separator.  seems convenient to treat\n                    // this as a single token.\n                    return { type: \"digit\", sep: true, format: m[1] + m[2], decimal: decimalPart };\n                }\n                if ((m = input.skip(/^[#0?]+/))) {\n                    return { type: \"digit\", sep: false, format: m[0], decimal: decimalPart };\n                }\n                // XXX: handle this one!\n                if ((m = input.skip(/^(e)([+-])/i))) {\n                    return { type: \"exp\", ch: m[1], sign: m[2] };\n                }\n                // dates\n                if ((m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i))) {\n                    m = m[1].toLowerCase();\n                    return maybeFraction({ type: \"date\", part: m.charAt(0), format: m.length });\n                }\n                // time (interpret as a date)\n                if ((m = input.skip(/^(hh?|ss?)/i))) { // m and mm are handled above\n                    m = m[1].toLowerCase();\n                    return maybeFraction({ type: \"time\", part: m.charAt(0), format: m.length });\n                }\n                // elapsed time (interpret as interval of days)\n                if ((m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i))) {\n                    m = m[1].toLowerCase();\n                    return maybeFraction({ type: \"eltime\", part: m.charAt(0), format: m.length });\n                }\n                if ((m = input.skip(/^(a[.]?m[.]?\\/p[.]?m[.]?|a\\/p)/i))) {\n                    m = m[1].split(\"/\");\n                    return { type: \"ampm\", am: m[0], pm: m[1] };\n                }\n                switch ((ch = input.next())) { // JSHint sadness\n                  case \";\":\n                    return null;\n                  case \"\\\\\":\n                    // quotes next character\n                    return { type: \"str\", value: input.next() };\n                  case '\"':\n                    return { type: \"str\", value: input.readEscaped(ch) };\n                  case \"@\":\n                    return { type: \"text\" };\n                  case \"_\":\n                    // whitespace of the width of following character\n                    return { type: \"space\", value: input.next() };\n                  case \"*\":\n                    // fills cell width with the following character\n                    return { type: \"fill\", value: input.next() };\n                  case \".\":\n                    if (input.lookingAt(/^\\s*[#0?]/)) {\n                        decimalPart = true;\n                        return { type: \"dec\" };\n                    }\n                    return { type: \"str\", value: \".\" };\n                  case \"%\":\n                    return { type: \"percent\" };\n                  case \",\":\n                    return { type: \"comma\" };\n                }\n\n                // whatever we can't make sense of, output literally.\n                return { type: \"str\", value: ch };\n            }\n\n            function readSection() {\n                decimalPart = false;\n                var color = maybeColor(), cond = maybeCondition();\n                if (!color && cond) {\n                    color = maybeColor();\n                }\n                return {\n                    color : color,\n                    cond  : cond,\n                    body  : readFormat()\n                };\n            }\n        }\n\n        function print(sections) {\n            return sections.map(printSection).join(\";\");\n\n            function printSection(sec) {\n                var out = \"\";\n                if (sec.color) {\n                    out += \"[\" + sec.color + \"]\";\n                }\n                if (sec.cond) {\n                    if (!(sec.cond == \"text\" || sec.cond == \"num\")) {\n                        out += \"[\" + sec.cond.op + sec.cond.value + \"]\";\n                    }\n                }\n                out += sec.body.map(printToken).join(\"\");\n                return out;\n            }\n\n            function maybeFraction(fmt, tok) {\n                if (tok.fraction) {\n                    fmt += \".\" + padLeft(\"\", tok.fraction, \"0\");\n                }\n                return fmt;\n            }\n\n            function printToken(tok) {\n                if (tok.type == \"digit\") {\n                    if (tok.sep) {\n                        return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n                    } else {\n                        return tok.format;\n                    }\n                }\n                else if (tok.type == \"exp\") {\n                    return tok.ch + tok.sign;\n                }\n                else if (tok.type == \"date\" || tok.type == \"time\") {\n                    return maybeFraction(padLeft(\"\", tok.format, tok.part), tok);\n                }\n                else if (tok.type == \"eltime\") {\n                    return maybeFraction(\"[\" + padLeft(\"\", tok.format, tok.part) + \"]\", tok);\n                }\n                else if (tok.type == \"ampm\") {\n                    return tok.am + \"/\" + tok.pm;\n                }\n                else if (tok.type == \"str\") {\n                    return JSON.stringify(tok.value);\n                }\n                else if (tok.type == \"text\") {\n                    return \"@\";\n                }\n                else if (tok.type == \"space\") {\n                    return \"_\" + tok.value;\n                }\n                else if (tok.type == \"fill\") {\n                    return \"*\" + tok.value;\n                }\n                else if (tok.type == \"dec\") {\n                    return \".\";\n                }\n                else if (tok.type == \"percent\") {\n                    return \"%\";\n                }\n                else if (tok.type == \"comma\") {\n                    return \",\";\n                }\n            }\n        }\n\n        function adjustDecimals(sections, x) {\n            sections.forEach(function(sec) {\n                var diff = x;\n                if (sec.cond == \"text\") {\n                    return;\n                }\n                var body = sec.body, adjusted = false, i = body.length;\n                while (diff !== 0 && --i >= 0) {\n                    var tok = body[i];\n                    if (tok.type == \"digit\") {\n                        if (tok.decimal) {\n                            adjusted = true;\n                            if (diff > 0) {\n                                tok.format += padLeft(\"\", diff, \"0\");\n                            } else if (diff < 0) {\n                                var tmp = tok.format.length;\n                                tok.format = tok.format.substr(0, tmp + diff);\n                                diff += tmp - tok.format.length;\n                            }\n                            if (tok.format.length === 0) {\n                                body.splice(i, 1);\n                                while (--i >= 0) {\n                                    tok = body[i];\n                                    if (tok.type == \"digit\" && tok.decimal) {\n                                        ++i;\n                                        break;\n                                    }\n                                    if (tok.type == \"dec\") {\n                                        body.splice(i, 1);\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                        if (diff > 0) {\n                            break;\n                        }\n                    }\n                }\n                if (!adjusted && diff > 0) {\n                    // no decimal part was found, insert one after the last digit token.\n                    body.splice(\n                        i + 1, 0, {\n                            type    : \"dec\"\n                        }, {\n                            type    : \"digit\",\n                            sep     : false,\n                            decimal : true,\n                            format  : padLeft(\"\", diff, \"0\")\n                        }\n                    );\n                }\n            });\n        }\n\n        function TokenStream(parts) {\n            var index = 0;\n            return {\n                next: function() {\n                    return parts[index++];\n                },\n                eof: function() {\n                    return index >= parts.length;\n                },\n                ahead: function(n, f) {\n                    if (index + n <= parts.length) {\n                        var val = f.apply(null, parts.slice(index, index + n));\n                        if (val) {\n                            index += n;\n                        }\n                        return val;\n                    }\n                },\n                restart: function() {\n                    index = 0;\n                }\n            };\n        }\n\n        function compileFormatPart(format) {\n            var input = TokenStream(format.body);\n            var hasDate = false;\n            var hasTime = false;\n            var hasAmpm = false;\n            var percentCount = 0;\n            var currency = /[\\$\\xA2-\\xA5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BD\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]/;\n            var scaleCount = 0;\n            var code = \"var intPart, decPart, isNegative, date, time; \";\n            var separeThousands = false;\n            var declen = 0;\n            var intFormat = [], decFormat = [];\n            var condition = format.cond;\n            var preamble = \"\";\n\n            if (condition == \"text\") {\n                preamble = \"if (typeof value == 'string' || value instanceof kendo.spreadsheet.CalcError) { \";\n            }\n            else if (condition == \"num\") {\n                preamble = \"if (typeof value == 'number') { \";\n            }\n            else if (condition) {\n                var op = condition.op == \"=\" ? \"==\" : condition.op;\n                preamble = \"if (typeof value == 'number' && value \"\n                    + op + \" \" + condition.value + \") { \";\n                if (!condition.custom) {\n                    code += \"value = Math.abs(value); \";\n                }\n            }\n\n            if (format.color) {\n                code += \"result.color = \" + JSON.stringify(format.color) + \"; \";\n            }\n\n            function checkComma(a, b) {\n                if ((a.type == \"digit\" && b.type == \"comma\") ||\n                    (a.type == \"comma\" && a.hidden && b.type == \"comma\"))\n                {\n                    b.hidden = true;\n                    scaleCount++;\n                }\n            }\n\n            while (!input.eof()) {\n                input.ahead(2, checkComma);\n                var tok = input.next();\n                if (tok.type == \"percent\") {\n                    percentCount++;\n                }\n                else if (tok.type == \"digit\") {\n                    if (tok.decimal) {\n                        declen += tok.format.length;\n                        decFormat.push(tok.format);\n                    } else {\n                        intFormat.push(tok.format);\n                        if (tok.sep) {\n                            separeThousands = true;\n                        }\n                    }\n                }\n                else if (tok.type == \"time\") {\n                    hasTime = true;\n                }\n                else if (tok.type == \"date\") {\n                    hasDate = true;\n                }\n                else if (tok.type == \"ampm\") {\n                    hasAmpm = hasTime = true;\n                }\n            }\n\n            if (percentCount > 0) {\n                code += \"value *= \" + Math.pow(100, percentCount) + \"; \";\n            }\n            if (scaleCount > 0) {\n                code += \"value /= \" + Math.pow(1000, scaleCount) + \"; \";\n            }\n            if (intFormat.length) {\n                code += \"intPart = runtime.formatInt(culture, value, \" + JSON.stringify(intFormat) + \", \" + declen + \", \" + separeThousands + \"); \";\n                code += \"isNegative = parseInt(intPart[0]) < 0;\";\n            }\n            if (decFormat.length) {\n                code += \"decPart = runtime.formatDec(value, \" + JSON.stringify(decFormat) + \", \" + declen + \"); \";\n            }\n            if (intFormat.length || decFormat.length) {\n                code += \"type = 'number'; \";\n            }\n            if (hasDate) {\n                code += \"date = runtime.unpackDate(value); \";\n            }\n            if (hasTime) {\n                code += \"time = runtime.unpackTime(value); \";\n            }\n            if (hasDate || hasTime) {\n                code += \"type = 'date'; \";\n            }\n\n            if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n                if (!preamble) {\n                    preamble = \"if (typeof value == 'number') { \";\n                }\n            }\n\n            input.restart();\n            code += \"var matchedCurrency = false;\";\n            while (!input.eof()) {\n                var tok = input.next();\n                if (tok.type == \"dec\") {\n                    code += \"output += culture.numberFormat['.']; \";\n                }\n                else if (tok.type == \"comma\" && !tok.hidden) {\n                    code += \"output += ','; \";\n                }\n                else if (tok.type == \"percent\") {\n                    code += \"type = 'percent'; \";\n                    code += \"output += culture.numberFormat.percent.symbol; \";\n                }\n                else if (tok.type == \"str\") {\n                    if (currency.test(tok.value)) {\n                        code += \"type = 'currency'; \";\n                        code += \"if (isNegative) { output += '-'; matchedCurrency = true; }\";\n                    }\n                    code += \"output += \" + JSON.stringify(tok.value) + \"; \";\n                }\n                else if (tok.type == \"text\") {\n                    code += \"type = 'text'; \";\n                    code += \"output += value; \";\n                }\n                else if (tok.type == \"space\") {\n                    code += \"if (output) result.body.push(output); \";\n                    code += \"output = ''; \";\n                    code += \"result.body.push({ type: 'space', value: \" + JSON.stringify(tok.value) + \" }); \";\n                }\n                else if (tok.type == \"fill\") {\n                    code += \"output += runtime.fill(\" + JSON.stringify(tok.value) + \"); \";\n                }\n                else if (tok.type == \"digit\") {\n                    code += \"if (isNegative && intPart[0] && matchedCurrency) {intPart[0] = intPart[0].replace('-', '');}\";\n                    code += \"output += \" + (tok.decimal ? \"decPart\" : \"intPart\") + \".shift(); \";\n                }\n                else if (tok.type == \"date\") {\n                    code += \"output += runtime.date(culture, date, \"\n                        + JSON.stringify(tok.part) + \", \" + tok.format + \"); \";\n                }\n                else if (tok.type == \"time\") {\n                    code += \"output += runtime.time(time, \"\n                        + JSON.stringify(tok.part) + \", \" + tok.format + \", \" + hasAmpm + \", \" + tok.fraction + \"); \";\n                }\n                else if (tok.type == \"eltime\") {\n                    code += \"output += runtime.eltime(value, \"\n                        + JSON.stringify(tok.part) + \", \" + tok.format + \", \" + tok.fraction + \"); \";\n                }\n                else if (tok.type == \"ampm\") {\n                    // XXX: should use culture?  As per the \"spec\", Excel\n                    // displays whatever the token was (AM/PM, a/p etc.)\n                    code += \"output += time.hours < 12 ? \" + JSON.stringify(tok.am) + \" : \" + JSON.stringify(tok.pm) + \"; \";\n                }\n            }\n\n            code += \"if (output) result.body.push(output); \";\n            code += \"result.type = type; \";\n            code += \"return result; \";\n\n            if (preamble) {\n                code = preamble + code + \"}\";\n            }\n\n            return code;\n        }\n\n        var TEXT = compileFormatPart({ cond: \"text\", body: [ { type: \"text\" } ] });\n\n        var compile = util$1.memoize(function(format) {\n            var tree = parse(format);\n            var code = tree.map(compileFormatPart);\n            code.push(TEXT);\n            code = code.join(\"\\n\");\n            code = \"'use strict'; return function(value, culture){ \"\n                + \"if (!culture) culture = kendo.culture(); \"\n                + \"var output = '', type = null, result = { body: [] }; \" + code + \"; return result; };\";\n            return new Function(\"runtime\", code)(runtime$3);\n        });\n\n        // Attempts to produce a format compatible with kendo.parseDate from our Excel format.  Needed\n        // in runtime.parseDate (passing Excel format to kendo.parseDate will mess up the month or\n        // minutes).  https://github.com/telerik/kendo-ui-core/issues/3797\n        var makeDateFormat = util$1.memoize(function(format){\n            var tree = parse(format);\n            var section, found = false, hasAmpm = false;\n\n            // locate a section that contains date/time formatting.  only the first will be converted.\n            for (var i = 0; i < tree.length; ++i) {\n                section = tree[i];\n                for (var j = 0; j < section.body.length; ++j) {\n                    if (/^(?:date|time|ampm)$/.test(section.body[j].type)) {\n                        found = true;\n                        if (section.body[j].type == \"ampm\") {\n                            hasAmpm = true;\n                        }\n                    }\n                }\n                if (found) {\n                    break;\n                }\n            }\n            if (!found) {\n                return null;\n            }\n\n            return section.body.map(printToken).join(\"\");\n\n            // a little copy/paste goes a long way\n\n            function maybeFraction(fmt, tok) {\n                if (tok.fraction) {\n                    fmt += padLeft(\"\", Math.max(tok.fraction, 3), \"f\");\n                }\n                return fmt;\n            }\n\n            function printToken(tok) {\n                if (tok.type == \"digit\") {\n                    if (tok.sep) {\n                        return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n                    } else {\n                        return tok.format;\n                    }\n                }\n                else if (tok.type == \"exp\") {\n                    return tok.ch + tok.sign;\n                }\n                else if (tok.type == \"date\" || tok.type == \"time\") {\n                    var part = tok.part;\n                    if (tok.type == \"date\" && /^m/.test(part)) {\n                        part = \"M\"; // month, not minutes\n                    }\n                    else if (tok.type == \"time\" && /^h/.test(part)) {\n                        if (!hasAmpm) {\n                            // 24-hours clock is H or HH\n                            part = part.toUpperCase();\n                        }\n                    }\n                    return maybeFraction(padLeft(\"\", tok.format, part), tok);\n                }\n                else if (tok.type == \"ampm\") {\n                    return \"tt\";\n                }\n                else if (tok.type == \"str\") {\n                    // XXX: this is a bit wrong.  it doesn't look like kendo.toString / kendo.parseDate\n                    // support arbitrary text (in Excel formats that's quoted), for example:\n                    //    kendo.toString(new Date(), \"here's the day dude: dd\")\n                    //   \"3ere'8 t3e 19ay 19u19e: 19\"   (it's 19th June, 3 o'clock, probably 8 seconds)\n                    return tok.value;\n                }\n                else if (tok.type == \"space\") {\n                    return \" \";\n                }\n                else if (tok.type == \"dec\") {\n                    return \".\";\n                }\n                else if (tok.type == \"percent\") {\n                    return \"%\";\n                }\n                else if (tok.type == \"comma\") {\n                    return \",\";\n                }\n                else {\n                    return \"\";\n                }\n            }\n        });\n\n        var runtime$3 = {\n\n            unpackDate: calc$2.runtime.unpackDate,\n            unpackTime: calc$2.runtime.unpackTime,\n\n            date: function(culture, d, part, length) {\n                switch (part) {\n                  case \"d\":\n                    switch (length) {\n                      case 1: return d.date;\n                      case 2: return padLeft(d.date, 2, \"0\");\n                      case 3: return culture.calendars.standard.days.namesAbbr[d.day];\n                      case 4: return culture.calendars.standard.days.names[d.day];\n                    }\n                    break;\n                  case \"m\":\n                    switch (length) {\n                      case 1: return d.month + 1;\n                      case 2: return padLeft(d.month + 1, 2, \"0\");\n                      case 3: return culture.calendars.standard.months.namesAbbr[d.month];\n                      case 4: return culture.calendars.standard.months.names[d.month];\n                      case 5: return culture.calendars.standard.months.names[d.month].charAt(0);\n                    }\n                    break;\n                  case \"y\":\n                    switch (length) {\n                      case 2: return d.year % 100;\n                      case 4: return d.year;\n                    }\n                    break;\n                }\n                return \"##\";\n            },\n\n            time: function(t, part, length, ampm, fraclen) {\n                var ret, fraction;\n                switch (part) {\n                  case \"h\":\n                    ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, \"0\");\n                    if (fraclen) {\n                        fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                    }\n                    break;\n                  case \"m\":\n                    ret = padLeft(t.minutes, length, \"0\");\n                    if (fraclen) {\n                        fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                    }\n                    break;\n                  case \"s\":\n                    ret = padLeft(t.seconds, length, \"0\");\n                    if (fraclen) {\n                        fraction = t.milliseconds / 1000;\n                    }\n                    break;\n                }\n                if (fraction) {\n                    ret += runtime$3.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n                }\n                return ret;\n            },\n\n            eltime: function(value, part, length, fraclen) {\n                var ret, fraction;\n                switch (part) {\n                  case \"h\":\n                    ret = value * 24;\n                    break;\n                  case \"m\":\n                    ret = value * 24 * 60;\n                    break;\n                  case \"s\":\n                    ret = value * 24 * 60 * 60;\n                    break;\n                }\n                if (fraclen) {\n                    fraction = ret - (ret | 0);\n                }\n                ret = padLeft(ret | 0, length, \"0\");\n                if (fraction) {\n                    ret += runtime$3.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n                }\n                return ret;\n            },\n\n            fill: function(ch) {\n                // XXX: how to implement this?\n                return ch;\n            },\n\n            // formatting integer part is slightly different than decimal\n            // part, so they're implemented in two functions.  For the\n            // integer part we need to walk the value and the format\n            // backwards (right-to-left).\n\n            formatInt: function(culture, value, parts, declen, sep) {\n                // toFixed is perfect for rounding our value; if there is\n                // no format for decimals, for example, we want the number\n                // rounded up.\n                value = runtime$3.toFixed(value, declen).replace(/\\..*$/, \"\");\n                var lastPart = parts[parts.length - 1];\n\n                if (declen > 0 && lastPart[parts.length - 1] != \"0\") {\n                    // if the rounded number is zero and we have decimal\n                    // format, consider it a non-significant digit (Excel\n                    // won't display the leading zero for 0.2 in format #.#).\n                    // the zero won't e omitted if using 0.0 format\n                    if (value === \"0\") { value = \"\"; }\n                    else if (value === \"-0\") { value = \"-\"; }\n                }\n\n                var shouldInsertMinus = false;\n                var iv = value.length - 1;\n                var result = [];\n                var len = 0, str;\n\n                function add(ch, skipMinus) {\n                    if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                        str = culture.numberFormat[\",\"] + str;\n                    }\n                    if(skipMinus && ch === \"-\") {\n                        shouldInsertMinus = true;\n                        ch = \"0\";\n                    }\n                    str = ch + str;\n                    len++;\n                }\n\n                for (var j = parts.length; --j >= 0;) {\n                    var format = parts[j];\n                    str = \"\";\n                    for (var k = format.length; --k >= 0;) {\n                        var chf = format.charAt(k);\n                        if (iv < 0) {\n                            if (chf == \"0\") {\n                                add(\"0\");\n                            } else if (chf == \"?\") {\n                                add(\" \");\n                            }\n                        } else {\n                            if (value == \"0\" && chf == \"?\") {\n                                add(\" \");\n                            } else if (chf == \"0\") {\n                                add(value.charAt(iv), true);\n                            } else {\n                                add(value.charAt(iv));\n                            }\n                            iv--;\n                        }\n                    }\n                    if (j === 0) {\n                        while (iv >= 0) {\n                            add(value.charAt(iv--));\n                        }\n                    }\n                    result.unshift(str);\n                }\n\n                if(shouldInsertMinus) {\n                    result[0] = \"-\" + result[0];\n                }\n\n                return result;\n            },\n\n            // for decimal part we walk in normal direction and pad on the\n            // right if required (for '0' or '?' chars).\n\n            formatDec: function(value, parts, declen) {\n                value = runtime$3.toFixed(value, declen);\n                var pos = value.indexOf(\".\");\n                if (pos >= 0) {\n                    value = value.substr(pos + 1).replace(/0+$/, \"\");\n                } else {\n                    value = \"\";\n                }\n\n                var iv = 0;\n                var result = [];\n\n                for (var j = 0; j < parts.length; ++j) {\n                    var format = parts[j];\n                    var str = \"\";\n                    for (var k = 0; k < format.length; ++k) {\n                        var chf = format.charAt(k);\n                        if (iv < value.length) {\n                            str += value.charAt(iv++);\n                        } else if (chf == \"0\") {\n                            str += \"0\";\n                        } else if (chf == \"?\") {\n                            str += \" \";\n                        }\n                    }\n                    result.push(str);\n                }\n\n                return result;\n            },\n\n            // JS's toFixed is broken, it's only OK to use it on integers.\n            toFixed: function(value, decimals) {\n                return (function toFixed(value, last) {\n                    if (!isFinite(value)) {\n                        return \"#NUM!\";\n                    }\n\n                    // deal early with the trivial cases\n                    if (value < 0) {    // JS's Math.round is broken with negative numbers\n                        return \"-\" + toFixed(-value);\n                    }\n\n                    if (decimals === 0) { // no decimals\n                        return String(Math.round(value));\n                    }\n\n                    if (value === Math.round(value) && !/e/i.test(String(value))) { // value is integer and not too big\n                        return value.toFixed(decimals);\n                    }\n\n                    // this handles cases like 0.3.toFixed(20) == \"0.29999999999999998890\", or\n                    // 2.1825.toFixed(20) = \"2.18250000000000010658\".\n                    // https://github.com/telerik/kendo-ui-core/issues/3520#issuecomment-333768221\n                    // https://twitter.com/mcbazon/status/1035828655652593665\n                    var num = digNumber(value);\n                    var intpart = num.intpart;\n                    var decpart = num.decpart;\n                    if (decpart.length <= decimals) {\n                        while (decpart.length < decimals) {\n                            decpart += \"0\";\n                        }\n                        return intpart + \".\" + decpart;\n                    }\n\n                    if (last) {\n                        // \"we should definitely not get here\" (famous last words).  Let's MAKE SURE\n                        // there's no more recursion.\n                        return intpart + \".\" + decpart.substr(0, decimals);\n                    }\n\n                    // if there are more decimals than wanted, round and try again.\n                    // it should not recurse more than once.\n                    var f = Math.pow(10, decimals);\n                    return toFixed(Math.round(value * f) / f, true);\n\n                })(Number(value.toFixed(14))); /* restrict to 14 decimals, because 0.1 + 0.2 ===\n                                                     * 0.30000000000000004 */\n            }\n\n        };\n\n        function padLeft(val, width, ch) {\n            val += \"\";\n            while (val.length < width) {\n                val = ch + val;\n            }\n            return val;\n        }\n\n        function padRight(val, width, ch) {\n            val += \"\";\n            while (val.length < width) {\n                val += ch;\n            }\n            return val;\n        }\n\n        // given a number, return { intpart, decpart } as strings.  the main difficulty here is that JS\n        // will stringify really large values in scientific notation (e.g. 1.23e+30, which is actually\n        // the integer 1230000000000000000000000000000).\n        function digNumber(num) {\n            var str = String(num).toLowerCase();\n            var intpart, decpart, m;\n            var pos = str.indexOf(\".\");\n            if (pos < 0) {\n                pos = str.indexOf(\"e\");\n                if (pos < 0) {\n                    intpart = str;\n                    decpart = \"\";\n                } else {\n                    intpart = str.substr(0, pos);\n                    decpart = str.substr(pos);\n                }\n            } else {\n                intpart = str.substr(0, pos);\n                decpart = str.substr(pos + 1);\n            }\n            if ((m = /(\\d*)e([-+]?\\d+)/.exec(decpart))) {\n                var exp = parseInt(m[2], 10);\n                if (exp >= 0) {\n                    decpart = padRight(m[1], exp, \"0\");\n                    intpart += decpart.substr(0, exp);\n                    decpart = decpart.substr(exp);\n                } else {\n                    intpart = padLeft(intpart, -exp, \"0\");\n                    decpart = intpart.substr(exp) + m[1];\n                    intpart = intpart.substr(0, intpart.length + exp);\n                }\n            }\n            return { intpart: intpart || \"0\", decpart: decpart };\n        }\n\n        /* -----[ exports ]----- */\n\n        function text(f) {\n            var a = f.body;\n            var text = \"\";\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == \"string\") {\n                    text += el;\n                } else if (el.type == \"space\") {\n                    text += \" \";\n                }\n            }\n            return text;\n        }\n\n        kendo.spreadsheet.formatting = {\n            compile : compile,\n            parse: parse,\n            format: function(value, format, culture) {\n                var f = compile(format)(value, culture);\n                var span = dom.element(\"span\");\n                span.__dataType = f.type;\n                var a = f.body;\n                if (f.color) {\n                    span.attr.style = { color: f.color };\n                }\n                for (var i = 0; i < a.length; ++i) {\n                    var el = a[i];\n                    if (typeof el == \"string\") {\n                        span.children.push(dom.text(el));\n                    } else if (el.type == \"space\") {\n                        span.children.push(dom.element(\"span\", {\n                            style: { visibility: \"hidden\" }\n                        }, [ dom.text(el.value) ]));\n                    }\n                }\n                return span;\n            },\n            text: function(value, format, culture) {\n                var f = compile(format)(value, culture);\n                return text(f);\n            },\n            textAndColor: function(value, format, culture) {\n                var f = compile(format)(value, culture);\n                return { text: text(f), color: f.color, type: f.type };\n            },\n            type: function(value, format) {\n                return compile(format)(value).type;\n            },\n            adjustDecimals: function(format, diff) {\n                var ast = parse(format);\n                adjustDecimals(ast, diff);\n                return print(ast);\n            },\n            makeDateFormat: makeDateFormat\n        };\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n\n        var util = kendo.util;\n        var spreadsheet$3 = kendo.spreadsheet;\n        var calc$1 = spreadsheet$3.calc;\n        var runtime$2 = calc$1.runtime;\n        var defineFunction$1 = runtime$2.defineFunction;\n        var defineAlias = runtime$2.defineAlias;\n        var CalcError$1 = runtime$2.CalcError;\n        var RangeRef = spreadsheet$3.RangeRef;\n        var CellRef$1 = spreadsheet$3.CellRef;\n        var UnionRef = spreadsheet$3.UnionRef;\n        var Matrix = runtime$2.Matrix;\n        var Ref = spreadsheet$3.Ref;\n        var NameRef = spreadsheet$3.NameRef;\n        var daysInMonth$1 = runtime$2.daysInMonth;\n        var packDate$1 = runtime$2.packDate;\n        var unpackDate$1 = runtime$2.unpackDate;\n        var daysInYear$1 = runtime$2.daysInYear;\n        var limitPrecision = runtime$2.limitPrecision;\n\n        function _days_360$1(start, end, method) {\n            var d1 = unpackDate$1(start);\n            var d2 = unpackDate$1(end);\n\n            // https://en.wikipedia.org/wiki/360-day_calendar\n            // humanity is a mess.\n            if (method) {\n                // EU method\n                if (d1.date == 31) {\n                    d1.date = 30;\n                }\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                // US method\n                if (d1.month == 1 && d2.month == 1\n                    && d1.date == daysInMonth$1(d1.year, 1)\n                    && d2.date == daysInMonth$1(d2.year, 1)) {\n                    d2.date = 30;\n                }\n                if (d1.date == daysInMonth$1(d1.year, d1.month)) {\n                    d1.date = 30;\n                    if (d2.date == 31) {\n                        d2.date = 30;\n                    }\n                } else {\n                    if (d1.date == 30 && d2.date == 31) {\n                        d2.date = 30;\n                    }\n                }\n            }\n\n            return (360 * (d2.year - d1.year)\n                    + 30 * (d2.month - d1.month)\n                    + (d2.date - d1.date));\n        }\n\n        runtime$2._days_360 = _days_360$1;\n\n        runtime$2.deferInit(() => {\n            /* -----[ Math functions ]----- */\n\n            [ \"abs\", \"cos\", \"sin\", \"acos\", \"asin\", \"tan\", \"atan\", \"exp\", \"sqrt\" ].forEach(function(name){\n                defineFunction$1(name, Math[name]).args([\n                    [ \"*n\", \"number\" ]\n                ]);\n            });\n\n            defineFunction$1(\"ln\", Math.log).args([\n                [ \"*n\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"log\", function(num, base){\n                return Math.log(num) / Math.log(base);\n            }).args([\n                [ \"*num\", \"number++\" ],\n                [ \"*base\", [ \"or\", \"number++\", [ \"null\", 10 ] ] ],\n                [ \"?\", [ \"assert\", \"$base != 1\", \"DIV/0\" ] ]\n            ]);\n\n            defineFunction$1(\"log10\", function(num){\n                return Math.log(num) / Math.log(10);\n            }).args([\n                [ \"*num\", \"number++\" ]\n            ]);\n\n            defineFunction$1(\"pi\", function(){\n                return Math.PI;\n            }).args([]);\n\n            defineFunction$1(\"sqrtpi\", function(n){\n                return Math.sqrt(n * Math.PI);\n            }).args([\n                [ \"*num\", \"number+\" ]\n            ]);\n\n            defineFunction$1(\"degrees\", function(rad){\n                return ((180 * rad) / Math.PI) % 360;\n            }).args([\n                [ \"*radians\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"radians\", function(deg){\n                return Math.PI * deg / 180;\n            }).args([\n                [ \"*degrees\", \"number\" ]\n            ]);\n\n            function _cosh(n){\n                return (Math.exp(n) + Math.exp(-n)) / 2;\n            }\n\n            defineFunction$1(\"cosh\", _cosh).args([\n                [ \"*num\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"acosh\", function(n){\n                return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n            }).args([\n                [ \"*num\", \"number\" ],\n                [ \"?\", [ \"assert\", \"$num >= 1\" ] ]\n            ]);\n\n            function _sinh(n){\n                return (Math.exp(n) - Math.exp(-n)) / 2;\n            }\n\n            defineFunction$1(\"sinh\", _sinh).args([\n                [ \"*num\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"asinh\", function(n){\n                return Math.log(n + Math.sqrt(n * n + 1));\n            }).args([\n                [ \"*num\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"sec\", function(n){\n                return 1 / Math.cos(n);\n            }).args([\n                [ \"*num\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"sech\", function(n){\n                return 1 / _cosh(n);\n            }).args([\n                [ \"*num\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"csc\", function(n){\n                return 1 / Math.sin(n);\n            }).args([\n                [ \"*num\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"csch\", function(n){\n                return 1 / _sinh(n);\n            }).args([\n                [ \"*num\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"atan2\", function(x, y){\n                return Math.atan(y / x);\n            }).args([\n                [ \"*x\", \"divisor\" ],\n                [ \"*y\", \"number\" ]\n            ]);\n\n            function _tanh(n) {\n                return _sinh(n) / _cosh(n);\n            }\n\n            defineFunction$1(\"tanh\", _tanh).args([\n                [ \"*num\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"atanh\", function(n){\n                return Math.log(Math.sqrt(1 - n*n) / (1 - n));\n            }).args([\n                [ \"*num\", [ \"and\", \"number\", [ \"(between)\", -1, 1 ] ] ]\n            ]);\n\n            defineFunction$1(\"cot\", function(n){\n                return 1 / Math.tan(n);\n            }).args([\n                [ \"*num\", \"divisor\" ]\n            ]);\n\n            defineFunction$1(\"coth\", function(n){\n                return 1 / _tanh(n);\n            }).args([\n                [ \"*num\", \"divisor\" ]\n            ]);\n\n            defineFunction$1(\"acot\", function(n){\n                return Math.PI / 2 - Math.atan(n);\n            }).args([\n                [ \"*num\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"acoth\", function(n){\n                return Math.log((n + 1) / (n - 1)) / 2;\n            }).args([\n                [ \"*num\", \"number\" ],\n                [ \"?\", [ \"or\",\n                        [ \"assert\", \"$num < -1\"],\n                        [ \"assert\", \"$num > 1\" ] ] ]\n            ]);\n\n            defineFunction$1(\"power\", function(a, b){\n                return Math.pow(a, b);\n            }).args([\n                [ \"*a\", \"number\" ],\n                [ \"*b\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"mod\", function(a, b){\n                return a % b;\n            }).args([\n                [ \"*a\", \"number\" ],\n                [ \"*b\", \"divisor\" ]\n            ]);\n\n            defineFunction$1(\"quotient\", function(a, b){\n                return Math.floor(a / b);\n            }).args([\n                [ \"*a\", \"number\" ],\n                [ \"*b\", \"divisor\" ]\n            ]);\n\n            defineFunction$1(\"ceiling\", function(num, s){\n                return s ? s * Math.ceil(num / s) : 0;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*significance\", \"number\" ],\n                [ \"?\", [ \"assert\", \"$significance >= 0 || $number < 0\" ] ]\n            ]);\n\n            defineFunction$1(\"ceiling.precise\", function(num, s){\n                s = Math.abs(s);\n                return s ? s * Math.ceil(num / s) : 0;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*significance\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n            ]);\n\n            defineAlias(\"iso.ceiling\", \"ceiling.precise\");\n\n            // XXX: how do we know if this function is correct?\n            //\n            // https://support.office.com/en-gb/article/CEILING-MATH-function-80f95d2f-b499-4eee-9f16-f795a8e306c8\n            //\n            // There are many combinations of Significance and Mode values that affect rounding of negative\n            // numbers in different ways.  right, thanks for the info. :-\\\n            defineFunction$1(\"ceiling.math\", function(num, s, mode){\n                if (!s || !num) {\n                    return 0;\n                }\n                if (num < 0 && ((!mode && s < 0) || (mode && s > 0))) {\n                    s = -s;\n                }\n                return s ? s * Math.ceil(num / s) : 0;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*significance\", [ \"or\", \"number\", [ \"null\", \"$number < 0 ? -1 : 1\" ] ] ],\n                [ \"*mode\", [ \"or\", \"logical\", [ \"null\", 0 ] ] ]\n            ]);\n\n            defineFunction$1(\"floor\", function(num, s){\n                return s ? s * Math.floor(num / s) : 0;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*significance\", \"number\" ],\n                [ \"?\", [ \"assert\", \"$significance >= 0 || $number < 0\" ] ]\n            ]);\n\n            defineFunction$1(\"floor.precise\", function(num, s){\n                s = Math.abs(s);\n                return s ? s * Math.floor(num / s) : 0;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*significance\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n            ]);\n\n            // XXX: check this\n            defineFunction$1(\"floor.math\", function(num, s, mode){\n                if (!s || !num) {\n                    return 0;\n                }\n                if (num < 0 && ((!mode && s < 0) || (mode && s > 0))) {\n                    s = -s;\n                }\n                return s ? s * Math.floor(num / s) : 0;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*significance\", [ \"or\", \"number\", [ \"null\", \"$number < 0 ? -1 : 1\" ] ] ],\n                [ \"*mode\", [ \"or\", \"logical\", [ \"null\", 0 ] ] ]\n            ]);\n\n            defineFunction$1(\"int\", Math.floor).args([\n                [ \"*number\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"mround\", function(num, mult){\n                return mult ? mult * Math.round(num / mult) : 0;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*multiple\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"round\", function(num, digits){\n                var sign = num < 0 ? -1 : 1;\n                if (sign < 0) { num = -num; }\n                digits = Math.pow(10, digits);\n                num = limitPrecision(num * digits);\n                num = Math.round(num);\n                return sign * num / digits;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*digits\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"roundup\", function(num, digits){\n                digits = Math.pow(10, digits);\n                num = limitPrecision(num * digits);\n                num = num < 0 ? Math.floor(num) : Math.ceil(num);\n                return num / digits;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*digits\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"rounddown\", function(num, digits){\n                digits = Math.pow(10, digits);\n                num = limitPrecision(num * digits);\n                num = num < 0 ? Math.ceil(num) : Math.floor(num);\n                return num / digits;\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*digits\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"even\", function(num){\n                var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n                return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n            }).args([\n                [ \"*number\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"odd\", function(num){\n                var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n                return n % 2 ? n : n + (n < 0 ? -1 : 1);\n            }).args([\n                [ \"*number\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"sign\", function(num){\n                return num < 0 ? -1 : num > 0 ? 1 : 0;\n            }).args([\n                [ \"*number\", \"number\" ]\n            ]);\n\n            function _gcd(a, b) {\n                while (b) {\n                    var r = a % b;\n                    a = b;\n                    b = r;\n                }\n                return a;\n            }\n\n            function _lcm(a, b) {\n                return Math.abs(a * b) / _gcd(a, b);\n            }\n\n            defineFunction$1(\"gcd\", function(args){\n                var a = args[0];\n                for (var i = 1; i < args.length; ++i) {\n                    a = _gcd(a, args[i]);\n                }\n                return a;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ]\n            ]);\n\n            defineFunction$1(\"lcm\", function(args){\n                var a = args[0];\n                for (var i = 1; i < args.length; ++i) {\n                    a = _lcm(a, args[i]);\n                }\n                return a;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ]\n            ]);\n\n            defineFunction$1(\"sum\", function(numbers){\n                return numbers.reduce(function(sum, num){\n                    return sum + num;\n                }, 0);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ]\n            ]);\n\n            defineFunction$1(\"product\", function(numbers){\n                return numbers.reduce(function(prod, num){\n                    return prod * num;\n                }, 1);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ]\n            ]);\n\n            defineFunction$1(\"sumproduct\", function(first, rest) {\n                var sum = 0;\n                first.each(function(p, row, col){\n                    if (typeof p == \"number\") {\n                        for (var i = 0; i < rest.length; ++i) {\n                            var v = rest[i].get(row, col);\n                            if (typeof v != \"number\") {\n                                return;\n                            }\n                            p *= v;\n                        }\n                        sum += p;\n                    }\n                });\n                return sum;\n            }).args([\n                [ \"a1\", \"matrix\" ],\n                [ \"+\",\n                [ \"a2\", [ \"and\", \"matrix\",\n                            [ \"assert\", \"$a2.width == $a1.width\" ],\n                            [ \"assert\", \"$a2.height == $a1.height\" ] ] ] ]\n            ]);\n\n            defineFunction$1(\"sumsq\", function(numbers){\n                return numbers.reduce(function(sum, num){\n                    return sum + num * num;\n                }, 0);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ]\n            ]);\n\n            defineFunction$1(\"sumx2my2\", function(a, b){\n                var sum = 0;\n                a.each(function(x, row, col){\n                    var y = b.get(row, col);\n                    if (typeof x == \"number\" && typeof y == \"number\") {\n                        sum += x*x - y*y;\n                    }\n                });\n                return sum;\n            }).args([\n                [ \"a\", \"matrix\" ],\n                [ \"b\", [ \"and\", \"matrix\",\n                        [ \"assert\", \"$b.width == $a.width\" ],\n                        [ \"assert\", \"$b.height == $a.height\" ] ] ]\n            ]);\n\n            defineFunction$1(\"sumx2py2\", function(a, b){\n                var sum = 0;\n                a.each(function(x, row, col){\n                    var y = b.get(row, col);\n                    if (typeof x == \"number\" && typeof y == \"number\") {\n                        sum += x*x + y*y;\n                    }\n                });\n                return sum;\n            }).args([\n                [ \"a\", \"matrix\" ],\n                [ \"b\", [ \"and\", \"matrix\",\n                        [ \"assert\", \"$b.width == $a.width\" ],\n                        [ \"assert\", \"$b.height == $a.height\" ] ] ]\n            ]);\n\n            defineFunction$1(\"sumxmy2\", function(a, b){\n                var sum = 0;\n                a.each(function(x, row, col){\n                    var y = b.get(row, col);\n                    if (typeof x == \"number\" && typeof y == \"number\") {\n                        sum += (x - y) * (x - y);\n                    }\n                });\n                return sum;\n            }).args([\n                [ \"a\", \"matrix\" ],\n                [ \"b\", [ \"and\", \"matrix\",\n                        [ \"assert\", \"$b.width == $a.width\" ],\n                        [ \"assert\", \"$b.height == $a.height\" ] ] ]\n            ]);\n\n            defineFunction$1(\"seriessum\", function(x, n, m, a){\n                var sum = 0;\n                a.each(function(coef){\n                    if (typeof coef != \"number\") {\n                        throw new CalcError$1(\"VALUE\");\n                    }\n                    sum += coef * Math.pow(x, n);\n                    n += m;\n                });\n                return sum;\n            }).args([\n                [ \"x\", \"number\" ],\n                [ \"y\", \"number\" ],\n                [ \"m\", \"number\" ],\n                [ \"a\", \"matrix\" ]\n            ]);\n\n            defineFunction$1(\"min\", function(numbers){\n                return numbers.length ? Math.min.apply(Math, numbers) : 0;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number!\" ] ]\n            ]);\n\n            defineFunction$1(\"max\", function(numbers){\n                return numbers.length ? Math.max.apply(Math, numbers) : 0;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number!\" ] ]\n            ]);\n\n            defineFunction$1(\"counta\", function(values){\n                return values.length;\n            }).args([\n                [ \"values\", [ \"#collect\", \"anyvalue\" ] ]\n            ]);\n\n            defineFunction$1(\"count\", function(numbers){\n                return numbers.length;\n            }).args([\n                [ \"numbers\", [ \"#collect\", \"number\" ] ]\n            ]);\n\n            defineFunction$1(\"countunique\", function(values){\n                var count = 0, seen = [];\n                values.forEach(function(val){\n                    if (seen.indexOf(val) < 0) {\n                        count++;\n                        seen.push(val);\n                    }\n                });\n                return count;\n            }).args([\n                [ \"values\", [ \"#collect\", \"anyvalue\" ] ]\n            ]);\n\n            defineFunction$1(\"countblank\", function(a){\n                var count = 0;\n                function add(val) {\n                    if (val == null || val === \"\") {\n                        count++;\n                    }\n                }\n                function loop(args){\n                    for (var i = 0; i < args.length; ++i) {\n                        var x = args[i];\n                        if (x instanceof Matrix) {\n                            x.each(add, true);\n                        } else {\n                            add(x);\n                        }\n                    }\n                }\n                loop(a);\n                return count;\n            }).args([\n                [ \"+\", [ \"args\", [ \"or\", \"matrix\", \"anyvalue\" ] ] ]\n            ]);\n\n            defineFunction$1(\"iseven\", function(num){\n                return num % 2 === 0;\n            }).args([\n                [ \"*number\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"isodd\", function(num){\n                return num % 2 !== 0;\n            }).args([\n                [ \"*number\", \"number\" ]\n            ]);\n\n            defineFunction$1(\"n\", function(val){\n                if (typeof val == \"boolean\") {\n                    return val ? 1 : 0;\n                }\n                if (typeof val == \"number\") {\n                    return val;\n                }\n                return 0;\n            }).args([\n                [ \"*value\", \"anyvalue\" ]\n            ]);\n\n            defineFunction$1(\"na\", function(){\n                return new CalcError$1(\"N/A\");\n            }).args([]);\n\n            /* -----[ the \"*IFS\" functions ]----- */\n\n            // helper function: take `args` like COUNTIFS (see Excel docs) and\n            // calls `f` for each cell matching all criteria.  `f` receives\n            // `chunks` (parsed args containing matrix and predicate) and\n            // row,col of matching cells.\n            function forIFS(args, f) {\n                var chunks = [], i = 0, matrix = args[0];\n                while (i < args.length) {\n                    chunks.push({\n                        matrix: args[i++],\n                        pred: parseCriteria(args[i++])\n                    });\n                }\n                ROW: for (var row = 0; row < matrix.height; ++row) {\n                    COL: for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === \"\" ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n                }\n            }\n\n            var ARGS_COUNTIFS = [\n                [ \"m1\", \"matrix\" ],\n                [ \"c1\", \"anyvalue\" ],\n                [ [ \"m2\", \"matrix\" ],\n                [ \"c2\", \"anyvalue\" ] ]\n            ];\n\n            defineFunction$1(\"countifs\", function(m1, c1, rest){\n                var count = 0;\n                rest.unshift(m1, c1);\n                forIFS(rest, function(){ count++; });\n                return count;\n            }).args(ARGS_COUNTIFS);\n\n            var ARGS_SUMIFS = [\n                [ \"range\", \"matrix\" ]\n            ].concat(ARGS_COUNTIFS);\n\n            defineFunction$1(\"sumifs\", function(range, m1, c1, args){\n                // hack: insert a predicate that filters out non-numeric\n                // values; should also accept blank cells.  it's safe to\n                // modify args.\n                args.unshift(range, numericPredicate, m1, c1);\n                var sum = 0;\n                forIFS(args, function(row, col){\n                    var val = range.get(row, col);\n                    if (val) {\n                        sum += val;\n                    }\n                });\n                return sum;\n            }).args(ARGS_SUMIFS);\n\n            // similar to sumifs, but compute average of matching cells\n            defineFunction$1(\"averageifs\", function(range, m1, c1, args){\n                args.unshift(range, numericPredicate, m1, c1);\n                var sum = 0, count = 0;\n                forIFS(args, function(row, col){\n                    var val = range.get(row, col);\n                    if (val == null || val === \"\") {\n                        val = 0;\n                    }\n                    sum += val;\n                    count++;\n                });\n                return count ? sum / count : new CalcError$1(\"DIV/0\");\n            }).args(ARGS_SUMIFS);\n\n            defineFunction$1(\"countif\", function(matrix, criteria){\n                criteria = parseCriteria(criteria);\n                var count = 0;\n                matrix.each(function(val){\n                    if (criteria(val)) {\n                        count++;\n                    }\n                });\n                return count;\n            }).args([\n                [ \"range\", \"matrix\" ],\n                [ \"*criteria\", \"anyvalue\" ]\n            ]);\n\n            var ARGS_SUMIF = [\n                [ \"range\", \"matrix\" ],\n                [ \"*criteria\", \"anyvalue\" ],\n                [ \"sumRange\", [ \"or\", \"area\", \"#matrix\", [ \"null\", \"$range\" ] ] ]\n            ];\n\n            function fetchSumRange(continuation) {\n                return function(callback, range, criteria, sumRange) {\n                    var self = this;\n                    if (sumRange instanceof Ref) {\n                        // make sure it covers the same area as `range`, as the spec mentions:\n                        //\n                        //     The sum_range argument does not have to be the same size and shape as the\n                        //     range argument. The actual cells that are added are determined by using the\n                        //     upper leftmost cell in the sum_range argument as the beginning cell, and then\n                        //     including cells that correspond in size and shape to the range argument.\n                        //\n                        // It does make one wonder, since only the top-left cell in `sumRange` matters, why\n                        // should it be a range at all?  Oh well, Excel.\n                        var r = sumRange.clone().toRangeRef();\n                        if (r.width() != range.width || r.height() != range.height) {\n                            if (!isFinite(r.topLeft.row)) {\n                                r.topLeft.row = 0;\n                            }\n                            if (!isFinite(r.topLeft.col)) {\n                                r.topLeft.col = 0;\n                            }\n                            r.bottomRight.row = r.topLeft.row + range.height - 1;\n                            r.bottomRight.col = r.topLeft.col + range.width - 1;\n                            return self.resolveCells([ r ], function(){\n                                callback(continuation(range, criteria, self.asMatrix(r)));\n                            });\n                        }\n                    }\n                    callback(continuation(range, criteria, self.asMatrix(sumRange)));\n                };\n            }\n\n            defineFunction$1(\"sumif\", fetchSumRange(function(range, criteria, sumRange){\n                var sum = 0;\n                criteria = parseCriteria(criteria);\n                range.each(function(val, row, col){\n                    if (criteria(val)) {\n                        var v = sumRange.get(row, col);\n                        if (numericPredicate(v)) {\n                            sum += v || 0;\n                        }\n                    }\n                });\n                return sum;\n            })).argsAsync(ARGS_SUMIF);\n\n            defineFunction$1(\"averageif\", fetchSumRange(function(range, criteria, sumRange){\n                var sum = 0, count = 0;\n                criteria = parseCriteria(criteria);\n                range.each(function(val, row, col){\n                    if (criteria(val)) {\n                        var v = sumRange.get(row, col);\n                        if (numericPredicate(v)) {\n                            sum += v || 0;\n                            count++;\n                        }\n                    }\n                });\n                return count ? sum / count : new CalcError$1(\"DIV/0\");\n            })).argsAsync(ARGS_SUMIF);\n\n            (function(def){\n                def(\"large\", function(numbers, nth){\n                    return numbers.sort(descending)[nth];\n                });\n                def(\"small\", function(numbers, nth){\n                    return numbers.sort(ascending)[nth];\n                });\n            })(function(name, handler){\n                defineFunction$1(name, function(matrix, nth){\n                    var numbers = [];\n                    var error = matrix.each(function(val){\n                        if (val instanceof CalcError$1) {\n                            return val;\n                        }\n                        if (typeof val == \"number\") {\n                            numbers.push(val);\n                        }\n                    });\n                    if (error) {\n                        return error;\n                    }\n                    if (nth > numbers.length) {\n                        return new CalcError$1(\"NUM\");\n                    }\n                    return handler(numbers, nth - 1);\n                }).args([\n                    [ \"array\", \"matrix\" ],\n                    [ \"*nth\", \"number++\" ]\n                ]);\n            });\n\n            function _avg(numbers) {\n                return numbers.reduce(function(sum, num){\n                    return sum + num;\n                }, 0) / numbers.length;\n            }\n\n            function _var_sp(numbers, divisor, avg) {\n                if (avg == null) {\n                    avg = _avg(numbers);\n                }\n                return numbers.reduce(function(sum, num){\n                    return sum + Math.pow(num - avg, 2);\n                }, 0) / divisor;\n            }\n\n            function _stdev_sp(numbers, divisor) {\n                return Math.sqrt(_var_sp(numbers, divisor));\n            }\n\n            // https://support.office.com/en-sg/article/STDEV-S-function-7d69cf97-0c1f-4acf-be27-f3e83904cc23\n            defineFunction$1(\"stdev.s\", function(numbers){\n                return _stdev_sp(numbers, numbers.length - 1);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n            ]);\n\n            // https://support.office.com/en-sg/article/STDEV-P-function-6e917c05-31a0-496f-ade7-4f4e7462f285\n            defineFunction$1(\"stdev.p\", function(numbers){\n                return _stdev_sp(numbers, numbers.length);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number!\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length >= 1\", \"NUM\" ] ]\n            ]);\n\n            defineFunction$1(\"var.s\", function(numbers){\n                return _var_sp(numbers, numbers.length - 1);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n            ]);\n\n            defineFunction$1(\"var.p\", function(numbers){\n                return _var_sp(numbers, numbers.length);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n            ]);\n\n            defineFunction$1(\"median\", function(numbers){\n                var n = numbers.length;\n                numbers.sort(ascending);\n                if (n % 2) {\n                    // when length is odd, the median is the number in the middle\n                    return numbers[n >> 1];\n                }\n                // that's the average of the two middle numbers, written in in a fancy way\n                return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"N/A\" ] ]\n            ]);\n\n            defineFunction$1(\"mode.sngl\", function(numbers){\n                numbers.sort(ascending);\n                var prev = null, count = 0, max = 1, mode = null;\n                for (var i = 0; i < numbers.length; ++i) {\n                    var n = numbers[i];\n                    if (n != prev) {\n                        count = 1;\n                        prev = n;\n                    } else {\n                        count++;\n                    }\n                    if (count > max) {\n                        max = count;\n                        mode = n;\n                    }\n                }\n                return mode == null ? new CalcError$1(\"N/A\") : mode;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ]\n            ]);\n\n            defineFunction$1(\"mode.mult\", function(numbers){\n                var seen = Object.create(null), max = 2, res = [];\n                numbers.forEach(function(num){\n                    var s = seen[num] || 0;\n                    seen[num] = ++s;\n                    if (s == max) {\n                        res.push(num);\n                    } else if (s > max) {\n                        max = s;\n                        res = [ num ];\n                    }\n                });\n                var m = new Matrix(this);\n                res.forEach(function(num, i){\n                    m.set(i, 0, num);\n                });\n                return m;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ]\n            ]);\n\n            defineFunction$1(\"geomean\", function(numbers){\n                var n = numbers.length;\n                var p = numbers.reduce(function(p, num){\n                    if (num < 0) {\n                        throw new CalcError$1(\"NUM\");\n                    }\n                    return p * num;\n                }, 1);\n                return Math.pow(p, 1/n);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n            ]);\n\n            defineFunction$1(\"harmean\", function(numbers){\n                var n = numbers.length;\n                var s = numbers.reduce(function(s, num){\n                    if (!num) {\n                        throw new CalcError$1(\"DIV/0\");\n                    }\n                    return s + 1 / num;\n                }, 0);\n                return n / s;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n            ]);\n\n            defineFunction$1(\"trimmean\", function(numbers, p){\n                var n = numbers.length;\n                numbers.sort(ascending);\n                var discard = Math.floor(n * p);\n                if (discard % 2) {\n                    --discard;\n                }\n                discard /= 2;\n                var sum = 0;\n                for (var i = discard; i < n-discard; ++i) {\n                    sum += numbers[i];\n                }\n                return sum / (n - discard * 2);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n                [ \"percent\", [ \"and\", \"number\", [ \"[between)\", 0, 1 ] ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n            ]);\n\n            defineFunction$1(\"frequency\", function(data, bins){\n                // apparently this always returns a vertical matrix in Excel, so we collect all numbers in\n                // bins instead of receiving it as a Matrix and try to mimic its shape.\n                data.sort(ascending);\n                bins.sort(ascending);\n                var prev = -Infinity;\n                var i = 0;\n                function count(max) {\n                    var n = 0;\n                    while (i < data.length && data[i] > prev && data[i] <= max) {\n                        ++n; ++i;\n                    }\n                    return n;\n                }\n                var m = new Matrix(this);\n                bins.forEach(function(val, i){\n                    var n = count(val);\n                    prev = val;\n                    m.set(i, 0, n);\n                });\n                m.set(m.height, 0, data.length - i);\n                return m;\n            }).args([\n                [ \"data\", [ \"collect\", \"number\", 1 ] ],\n                [ \"bins\", [ \"collect\", \"number\", 1 ] ]\n            ]);\n\n            defineFunction$1(\"rank.eq\", function(val, numbers, asc) {\n                numbers.sort(asc ? ascending : descending);\n                var pos = numbers.indexOf(val);\n                return pos < 0 ? new CalcError$1(\"N/A\") : pos + 1;\n            }).args([\n                [ \"value\", \"number\" ],\n                [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n                [ \"order\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n            ]);\n\n            defineAlias(\"rank\", \"rank.eq\");\n\n            defineFunction$1(\"rank.avg\", function(val, numbers, asc) {\n                numbers.sort(asc ? ascending : descending);\n                var pos = numbers.indexOf(val);\n                if (pos < 0) {\n                    return new CalcError$1(\"N/A\");\n                }\n                for (var i = pos; numbers[i] == val; ++i){}\n                return (pos + i + 1) / 2;\n            }).args([\n                [ \"value\", \"number\" ],\n                [ \"numbers\", [ \"collect\", \"number\" ] ],\n                [ \"order\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n            ]);\n\n            // formula available at https://support.office.microsoft.com/en-us/article/KURT-function-cbbc2312-dfa6-4cc4-b5c0-1b3c59cc9377\n            defineFunction$1(\"kurt\", function(numbers){\n                var n = numbers.length;\n                var avg = _avg(numbers);\n                var variance = _var_sp(numbers, n-1, avg);\n                var stddev = Math.sqrt(variance);\n                var sum = numbers.reduce(function(sum, num){\n                    return sum + Math.pow((num - avg) / stddev, 4);\n                }, 0);\n                return n*(n+1)/((n-1)*(n-2)*(n-3)) * sum\n                    - 3*Math.pow(n-1, 2)/((n-2)*(n-3));\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length >= 4\", \"NUM\" ] ]\n            ]);\n\n            function _percentrank(numbers, x, exc) {\n                var nlt = 0, ngt = 0, left = null, right = null, found = false;\n                numbers.forEach(function(num){\n                    if (num < x) {\n                        nlt++;\n                        left = left == null ? num : Math.max(left, num);\n                    } else if (num > x) {\n                        ngt++;\n                        right = right == null ? num : Math.min(right, num);\n                    } else {\n                        found = true;\n                    }\n                });\n                if (!nlt && !ngt) {\n                    return new CalcError$1(\"N/A\");\n                }\n                if (found) {\n                    if (exc) {\n                        return (nlt + 1) / (numbers.length + 1);\n                    }\n                    return nlt / (nlt + ngt);\n                }\n                return ((right - x) * _percentrank(numbers, left, exc) +\n                        (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n            }\n\n            var ARGS_PERCENTRANK = [\n                [ \"array\", [ \"collect\", \"number\", 1 ] ],\n                [ \"x\", \"number\" ],\n                [ \"significance\", [ \"or\", [ \"null\", 3 ], \"integer++\" ] ],\n                [ \"?\", [ \"assert\", \"$array.length > 0\", \"NUM\" ] ]\n            ];\n\n            defineFunction$1(\"percentrank.inc\", function(numbers, x, significance) {\n                var p = _percentrank(numbers, x, 0);\n                p = p.toFixed(significance + 1);\n                return parseFloat(p.substr(0, p.length - 1));\n            }).args(ARGS_PERCENTRANK);\n\n            defineFunction$1(\"percentrank.exc\", function(numbers, x, significance) {\n                var p = _percentrank(numbers, x, 1);\n                p = p.toFixed(significance + 1);\n                return parseFloat(p.substr(0, p.length - 1));\n            }).args(ARGS_PERCENTRANK);\n\n            defineAlias(\"percentrank\", \"percentrank.inc\");\n\n            function _covariance(x, y, divisor) {\n                var sum = 0;\n                var ax = _avg(x);\n                var ay = _avg(y);\n                var n = x.length;\n                for (var i = 0; i < n; ++i) {\n                    sum += (x[i] - ax) * (y[i] - ay);\n                }\n                return sum / divisor;\n            }\n\n            defineFunction$1(\"covariance.p\", function(x, y){\n                return _covariance(x, y, x.length);\n            }).args([\n                [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n                [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$array1.length == $array2.length\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$array1.length > 0\", \"DIV/0\" ] ]\n            ]);\n\n            defineFunction$1(\"covariance.s\", function(x, y){\n                return _covariance(x, y, x.length - 1);\n            }).args([\n                [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n                [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$array1.length == $array2.length\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$array1.length > 1\", \"DIV/0\" ] ]\n            ]);\n\n            defineAlias(\"covar\", \"covariance.p\");\n\n            /* -----[ Factorials ]----- */\n\n            var _fact = util.memoize(function(n){\n                for (var i = 2, fact = 1; i <= n; ++i) {\n                    fact *= i;\n                }\n                return fact;\n            });\n\n            defineFunction$1(\"fact\", _fact).args([\n                [ \"*n\", \"integer+\" ]\n            ]);\n\n            defineFunction$1(\"factdouble\", function(n){\n                for (var i = 2 + (n&1), fact = 1; i <= n; i += 2) {\n                    fact *= i;\n                }\n                return fact;\n            }).args([\n                [ \"*n\", \"integer+\" ]\n            ]);\n\n            defineFunction$1(\"multinomial\", function(numbers){\n                var div = 1, sum = 0;\n                numbers.forEach(function(n){\n                    if (n < 0) {\n                        throw new CalcError$1(\"NUM\");\n                    }\n                    sum += n;\n                    div *= _fact(n);\n                });\n                return _fact(sum) / div;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ]\n            ]);\n\n            var _combinations = util.memoize(function (n, k){\n                for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n                    p1 *= f1;\n                    p2 *= f2;\n                }\n                return p1/p2;\n            });\n\n            defineFunction$1(\"combin\", _combinations).args([\n                [ \"*n\", \"integer++\" ],\n                [ \"*k\", [ \"and\", \"integer\", [ \"[between]\", 0, \"$n\" ] ] ]\n            ]);\n\n            defineFunction$1(\"combina\", function(n, k){\n                return _combinations(n + k - 1, n - 1);\n            }).args([\n                [ \"*n\", \"integer++\" ],\n                [ \"*k\", [ \"and\", \"integer\", [ \"[between]\", 1, \"$n\" ] ] ]\n            ]);\n\n            /* -----[ Statistical functions ]----- */\n\n            defineFunction$1(\"average\", function(numbers){\n                var sum = numbers.reduce(function(sum, num){\n                    return sum + num;\n                }, 0);\n                return sum / numbers.length;\n            }).args([\n                // most numeric functions must treat booleans as numbers (1 for TRUE\n                // and 0 for FALSE), but AVERAGE shouldn't.\n                [ \"numbers\", [ \"collect\", \"number!\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"DIV/0\" ] ]\n            ]);\n\n            defineFunction$1(\"averagea\", function(values){\n                var sum = 0, count = 0;\n                values.forEach(function(num){\n                    if (typeof num != \"string\") {\n                        sum += num;\n                    }\n                    ++count;\n                });\n                return count ? sum / count : new CalcError$1(\"DIV/0\");\n            }).args([\n                [ \"values\", [ \"collect\", \"anyvalue\" ] ]\n            ]);\n\n            function _percentile(numbers, rank) {\n                numbers.sort(ascending);\n                var n = numbers.length;\n                var k = rank | 0, d = rank - k;\n                if (k === 0) {\n                    return numbers[0];\n                }\n                if (k >= n) {\n                    return numbers[n - 1];\n                }\n                --k;\n                return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n            }\n\n            function _percentile_inc(numbers, p){\n                // algorithm from https://en.wikipedia.org/wiki/Percentile#Microsoft_Excel_method\n                var rank = p * (numbers.length - 1) + 1;\n                return _percentile(numbers, rank);\n            }\n\n            function _percentile_exc(numbers, p){\n                // https://en.wikipedia.org/wiki/Percentile#NIST_method\n                var rank = p * (numbers.length + 1);\n                return _percentile(numbers, rank);\n            }\n\n            defineFunction$1(\"percentile.inc\", _percentile_inc).args([\n                [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n                [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n            ]);\n\n            defineFunction$1(\"percentile.exc\", _percentile_exc).args([\n                [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n                [ \"p\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ]\n            ]);\n\n            defineFunction$1(\"quartile.inc\", function(numbers, quarter){\n                return _percentile_inc(numbers, quarter / 4);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n                [ \"quarter\", [ \"values\", 0, 1, 2, 3, 4 ] ]\n            ]);\n\n            defineFunction$1(\"quartile.exc\", function(numbers, quarter){\n                return _percentile_exc(numbers, quarter / 4);\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n                [ \"quarter\", [ \"values\", 0, 1, 2, 3, 4 ] ]\n            ]);\n\n            defineAlias(\"quartile\", \"quartile.inc\");\n            defineAlias(\"percentile\", \"percentile.inc\");\n\n            var AGGREGATE_FUNCS = [\n                \"AVERAGE\", \"COUNT\", \"COUNTA\", \"MAX\", \"MIN\", \"PRODUCT\",\n                \"STDEV.S\", \"STDEV.P\", \"SUM\", \"VAR.S\", \"VAR.P\", \"MEDIAN\",\n                \"MODE.SNGL\", \"LARGE\", \"SMALL\", \"PERCENTILE.INC\",\n                \"QUARTILE.INC\", \"PERCENTILE.EXC\", \"QUARTILE.EXC\"\n            ];\n\n            function fetchValuesForAggregate(self, args, options) {\n                var values = [];\n                var opt_ignore_hidden_rows = 1;\n                var opt_ignore_errors = 2;\n                var opt_use_aggregates = 4;\n                (function fetchValues(args) {\n                    if (args instanceof Ref) {\n                        self.getRefCells(args, true).forEach(function(cell){\n                            var value = cell.value;\n                            if ((options & opt_ignore_hidden_rows) && cell.hidden) {\n                                return;\n                            }\n                            if (cell.formula) {\n                                // XXX: formula.print is fast, but still, can't we do any better here?\n                                //      perhaps access the input string directly somehow?\n                                var str = cell.formula.print(cell.row, cell.col);\n                                if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                                    if (!(options & opt_use_aggregates)) {\n                                        return;\n                                    }\n                                }\n                            }\n                            if ((options & opt_ignore_errors) && value instanceof CalcError$1) {\n                                return;\n                            }\n                            if (typeof value == \"number\" || value instanceof CalcError$1) {\n                                values.push(value);\n                            }\n                        });\n                    } else if (Array.isArray(args)) {\n                        for (var i = 0; i < args.length; ++i) {\n                            fetchValues(args[i]);\n                        }\n                    } else if (args instanceof Matrix) {\n                        args.each(fetchValues);\n                    } else if (typeof args == \"number\") {\n                        values.push(args);\n                    } else if (args instanceof CalcError$1 && !(options & opt_ignore_errors)) {\n                        values.push(args);\n                    }\n                })(args);\n                return values;\n            }\n\n            // AGGREGATE function\n            //\n            // https://support.office.com/en-SG/article/aggregate-function-c8caed56-07df-4aeb-9741-23693ffbe525\n            //\n            // we can only partially type-check this function.  also, we need to use the async version in\n            // order to resolve references and delegate values to the function to aggregate.\n            defineFunction$1(\"aggregate\", function(callback, funcId, options, args){\n                // options is a bit field.  that makes sense; it's the documentation which doesn't.\n                var self = this;\n                self.resolveCells(args, function(){\n                    var values;\n                    if (funcId > 12) {\n                        // \"array form\"\n                        values = fetchValuesForAggregate(self, args[0], options);\n                        var k = args[1];\n                        if (k instanceof CellRef$1) {\n                            k = self.getRefData(k);\n                        }\n                        if (typeof k != \"number\") {\n                            return callback(new CalcError$1(\"VALUE\"));\n                        }\n                    } else {\n                        values = fetchValuesForAggregate(self, args, options);\n                    }\n                    self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n                });\n            }).argsAsync([\n                [ \"funcId\", [ \"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,\n                            11, 12, 13, 14, 15, 16, 17, 18, 19 ] ],\n                [ \"options\", [ \"or\",\n                            [ \"null\", 0 ],\n                            [ \"values\", 0, 1, 2, 3, 4, 5, 6, 7  ] ] ],\n                [ \"args\", \"rest\" ]\n            ]);\n\n            defineFunction$1(\"subtotal\", function(callback, funcId){\n                var self = this;\n                var ignoreHidden = funcId > 100;\n                if (ignoreHidden) {\n                    funcId -= 100;\n                }\n                var args = [];\n                for (var i = 2; i < arguments.length; ++i) {\n                    args.push(arguments[i]);\n                }\n                self.resolveCells(args, function(){\n                    var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n                    self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n                });\n            }).argsAsync([\n                [ \"funcId\", [ \"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,\n                            101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111 ] ],\n                [ \"+\", [ \"ref\", [ \"or\", \"ref\", \"#matrix\" ] ] ]\n            ]);\n\n            // https://support.office.com/en-sg/article/AVEDEV-function-ec78fa01-4755-466c-9a2b-0c4f9eacaf6d\n            defineFunction$1(\"avedev\", function(numbers){\n                var avg = numbers.reduce(function(sum, num){\n                    return sum + num;\n                }, 0) / numbers.length;\n                return numbers.reduce(function(sum, num){\n                    return sum + Math.abs(num - avg);\n                }, 0) / numbers.length;\n            }).args([\n                [ \"numbers\", [ \"collect\", \"number\" ] ],\n                [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n            ]);\n\n            function _binom_dist(x, n, p, cumulative) {\n                if (!cumulative) {\n                    return _combinations(n, x) * Math.pow(p, x) * Math.pow(1-p, n-x);\n                } else {\n                    var sum = 0;\n                    for (var j = 0; j <= x; ++j) {\n                        sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1-p, n-j);\n                    }\n                    return sum;\n                }\n            }\n\n            defineFunction$1(\"binom.dist\", _binom_dist).args([\n                [ \"successes\", \"integer+\" ],\n                [ \"trials\", [ \"and\", \"integer\", [ \"assert\", \"$trials >= $successes\" ] ] ],\n                [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineAlias(\"binomdist\", \"binom.dist\");\n\n            defineFunction$1(\"binom.inv\", function(n, p, alpha){\n                // XXX: could a binary search be faster?\n                for (var x = 0; x <= n; ++x) {\n                    if (_binom_dist(x, n, p, true) >= alpha) {\n                        return x;\n                    }\n                }\n                return new CalcError$1(\"N/A\"); // XXX: is this right?\n            }).args([\n                [ \"trials\", \"integer+\" ],\n                [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"alpha\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n            ]);\n\n            defineAlias(\"critbinom\", \"binom.inv\");\n\n            defineFunction$1(\"binom.dist.range\", function(n, p, s, s2){\n                var sum = 0;\n                for (var k = s; k <= s2; ++k) {\n                    sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1-p, n-k);\n                }\n                return sum;\n            }).args([\n                [ \"trials\", \"integer+\" ],\n                [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"successes_min\", [ \"and\", \"integer\", [ \"[between]\", 0, \"$trials\" ] ] ],\n                [ \"successes_max\", [ \"or\",\n                                    [ \"and\", \"integer\",\n                                    [ \"[between]\", \"$successes_min\", \"$trials\" ] ],\n                                    [ \"null\", \"$successes_min\" ] ] ]\n            ]);\n\n            defineFunction$1(\"negbinom.dist\", function(x, k, p, cumulative){\n                if (cumulative) {\n                    var sum = 0;\n                    while (x >= 0) {\n                        sum += _combinations(x+k-1, x) * Math.pow(p, k) * Math.pow(1-p, x);\n                        x--;\n                    }\n                    return sum;\n                }\n                return _combinations(x+k-1, x) * Math.pow(p, k) * Math.pow(1-p, x);\n            }).args([\n                [ \"number_f\", \"integer+\" ],\n                [ \"number_s\", \"integer+\" ],\n                [ \"probability_s\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineAlias(\"negbinomdist\", \"negbinom.dist\");\n\n            /* -----[ lookup functions ]----- */\n\n            defineFunction$1(\"address\", function(row, col, abs, a1, sheet){\n                // by some lucky coincidence, we get the corret `rel` value by just subtracting 1 from the\n                // abs argument\n                var cell = new CellRef$1(row - 1, col - 1, abs - 1);\n                if (sheet) {\n                    cell.setSheet(sheet, true);\n                }\n                return a1 ? cell.print(0, 0) : cell.print();\n            }).args([\n                [ \"row\", \"integer++\" ],\n                [ \"col\", \"integer++\" ],\n                [ \"abs\", [ \"or\", [ \"null\", 1 ], [ \"values\", 1, 2, 3, 4 ]]],\n                [ \"a1\", [ \"or\", [ \"null\", true ], \"logical\" ]],\n                [ \"sheet\", [ \"or\", \"null\", \"string\" ]]\n            ]);\n\n            defineFunction$1(\"areas\", function(ref){\n                var count = 0;\n                (function loop(x){\n                    if (x instanceof CellRef$1 || x instanceof RangeRef) {\n                        count++;\n                    } else if (x instanceof UnionRef) {\n                        x.refs.forEach(loop);\n                    }\n                    // XXX: NameRef if we add support\n                })(ref);\n                return count;\n            }).args([\n                [ \"ref\", \"ref\" ]\n            ]);\n\n            defineFunction$1(\"choose\", function(index, args){\n                if (index > args.length) {\n                    return new CalcError$1(\"N/A\");\n                } else {\n                    return args[index - 1];\n                }\n            }).args([\n                [ \"*index\", \"integer\" ],\n                [ \"+\", [ \"value\", \"anything\" ] ]\n            ]);\n\n            defineFunction$1(\"column\", function(ref){\n                if (!ref) {\n                    return this.formula.col + 1;\n                }\n                if (ref instanceof CellRef$1) {\n                    return ref.col + 1;\n                }\n                return this.asMatrix(ref).mapCol(function(col){\n                    return col + ref.topLeft.col + 1;\n                });\n            }).args([\n                [ \"ref\", [ \"or\", \"area\", \"null\" ]]\n            ]);\n\n            defineFunction$1(\"columns\", function(m){\n                return m instanceof Ref ? m.width() : m.width;\n            }).args([\n                [ \"ref\", [ \"or\", \"area\", \"#matrix\" ] ]\n            ]);\n\n            defineFunction$1(\"formulatext\", function(ref){\n                var cell = this.getRefCells(ref)[0]; // XXX: overkill, but oh well.\n                if (!cell.formula) {\n                    return new CalcError$1(\"N/A\");\n                }\n                return cell.formula.print(cell.row, cell.col);\n            }).args([\n                [ \"ref\", \"ref\" ]\n            ]);\n\n            defineFunction$1(\"hlookup\", function(value, m, row, approx){\n                var resultCol = null;\n                m.eachCol(function(col){\n                    var data = m.get(0, col);\n                    if (approx) {\n                        if (data > value) {\n                            return true;\n                        }\n                        resultCol = col;\n                    } else if (data === value) {\n                        resultCol = col;\n                        return true;\n                    }\n                });\n                if (resultCol == null) {\n                    return new CalcError$1(\"N/A\");\n                }\n                return m.get(row - 1, resultCol);\n            }).args([\n                [ \"value\", \"anyvalue\" ],\n                [ \"range\", \"matrix\" ],\n                [ \"row\", \"integer++\" ],\n                [ \"approx\", [ \"or\", \"logical\", [ \"null\", true ]]]\n            ]);\n\n            defineFunction$1(\"index\", function(callback, ref, row, col, areanum){\n                var self = this;\n                if (ref instanceof UnionRef) {\n                    ref = ref.refs[areanum - 1];\n                }\n                if ((!row && !col) || !ref) {\n                    return callback(new CalcError$1(\"N/A\"));\n                }\n                if (ref instanceof CellRef$1) {\n                    ref = ref.toRangeRef();\n                }\n                if (ref instanceof RangeRef) {\n                    if (row && col) {\n                        if (col > ref.width() || row > ref.height()) {\n                            return callback(new CalcError$1(\"REF\"));\n                        }\n                        // fetching a single cell\n                        var cell = ref.toCell(row - 1, col - 1);\n                        self.resolveCells([ cell ], function(){\n                            callback(self.getRefData(cell));\n                        });\n                        return;\n                    }\n                    if (!row) {\n                        // fetch a full column\n                        var colRange = ref.toColumn(col - 1);\n                        self.resolveCells([ colRange ], function(){\n                            callback(self.asMatrix(colRange));\n                        });\n                        return;\n                    }\n                    if (!col) {\n                        // fetch a full row\n                        var rowRange = ref.toRow(row - 1);\n                        self.resolveCells([ rowRange ], function(){\n                            callback(self.asMatrix(rowRange));\n                        });\n                        return;\n                    }\n                }\n                else if (ref instanceof Matrix) {\n                    if (ref.width > 1 && ref.height > 1) {\n                        if (row && col) {\n                            return callback(ref.get(row - 1, col - 1));\n                        }\n                        if (!row) {\n                            return callback(ref.mapRow(function(row){\n                                return ref.get(row, col - 1);\n                            }));\n                        }\n                        if (!col) {\n                            return callback(ref.mapCol(function(col){\n                                return ref.get(row - 1, col);\n                            }));\n                        }\n                    }\n                    if (ref.width == 1) {\n                        return callback(ref.get((row || 1) - 1, 0));\n                    }\n                    if (ref.height == 1) {\n                        return callback(ref.get(0, (col || 1) - 1));\n                    }\n                }\n                else {\n                    callback(new CalcError$1(\"REF\"));\n                }\n            }).argsAsync([\n                [ \"range\", [ \"or\", \"ref\", \"matrix\" ] ],\n                [ \"row\", [ \"or\", \"integer+\", \"null\" ] ],\n                [ \"col\", [ \"or\", \"integer+\", \"null\" ] ],\n                [ \"areanum\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n            ]);\n\n            defineFunction$1(\"indirect\", function(thing){\n                try {\n                    // XXX: does more work than needed.  we could go for parseReference, but that one\n                    // doesn't (yet?) support \"SheetName!\" prefix.\n                    var f = this.formula;\n                    var exp = calc$1.parseFormula(f.sheet, f.row, f.col, thing);\n                    var ref = exp.ast;\n                    if (ref instanceof NameRef) {\n                        ref = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n                    }\n                    if (!(ref instanceof Ref)) {\n                        throw 1;\n                    }\n                    return ref.absolute(f.row, f.col);\n                } catch(ex) {\n                    return new CalcError$1(\"REF\");\n                }\n            }).args([\n                [ \"thing\", \"string\" ]\n            ]);\n\n            // XXX: LOOKUP.  seems to be deprecated in favor of HLOOKUP/VLOOKUP\n\n            // XXX: double-check this one.\n            defineFunction$1(\"match\", function(val, m, type){\n                var index = 1, cmp;\n                if (type === 0) {\n                    cmp = parseCriteria(val);\n                } else if (type === -1) {\n                    cmp = parseCriteria(\"<=\" + val);\n                } else if (type === 1) {\n                    cmp = parseCriteria(\">=\" + val);\n                }\n                if (m.each(function(el){\n                    if (el != null && cmp(el)) {\n                        if (type !== 0 && val != el) {\n                            --index;\n                        }\n                        return true;\n                    }\n                    index++;\n                }, true) && index > 0) {\n                    return index;\n                } else {\n                    return new CalcError$1(\"N/A\");\n                }\n            }).args([\n                [ \"value\", \"anyvalue\" ],\n                [ \"range\", \"matrix\" ],\n                [ \"type\", [ \"or\",\n                            [ \"values\", -1, 0, 1 ],\n                            [ \"null\", 1 ]]]\n            ]);\n\n            defineFunction$1(\"offset\", function(ref, rows, cols, height, width){\n                var topLeft = (ref instanceof CellRef$1 ? ref : ref.topLeft).clone();\n                topLeft.row += rows;\n                topLeft.col += cols;\n                if (topLeft.row < 0 || topLeft.col < 0) {\n                    return new CalcError$1(\"VALUE\");\n                }\n                if (height > 1 || width > 1) {\n                    return new RangeRef(topLeft, new CellRef$1(topLeft.row + height - 1,\n                                                            topLeft.col + width - 1))\n                        .setSheet(ref.sheet, ref.hasSheet());\n                }\n                return topLeft;\n            }).args([\n                [ \"ref\", \"area\" ],\n                [ \"*rows\", \"integer\" ],\n                [ \"*cols\", \"integer\" ],\n                [ \"*height\", [ \"or\", \"integer++\", [ \"null\", \"$ref.height()\" ]]],\n                [ \"*width\", [ \"or\", \"integer++\", [ \"null\", \"$ref.width()\" ]]]\n            ]);\n\n            defineFunction$1(\"row\", function(ref){\n                if (!ref) {\n                    return this.formula.row + 1;\n                }\n                if (ref instanceof CellRef$1) {\n                    return ref.row + 1;\n                }\n                return this.asMatrix(ref).mapRow(function(row){\n                    return row + ref.topLeft.row + 1;\n                });\n            }).args([\n                [ \"ref\", [ \"or\", \"area\", \"null\" ]]\n            ]);\n\n            defineFunction$1(\"rows\", function(m){\n                return m instanceof Ref ? m.height() : m.height;\n            }).args([\n                [ \"ref\", [ \"or\", \"area\", \"#matrix\" ] ]\n            ]);\n\n            defineFunction$1(\"vlookup\", function(value, m, col, approx){\n                var resultRow = null;\n                if (typeof value != \"number\") {\n                    approx = false;\n                }\n                if (typeof value == \"string\") {\n                    value = value.toLowerCase();\n                }\n                m.eachRow(function(row){\n                    var data = m.get(row, 0);\n                    if (approx) {\n                        if (data > value) {\n                            return true;\n                        }\n                        resultRow = row;\n                    } else {\n                        if (typeof data == \"string\") {\n                            data = data.toLowerCase();\n                        }\n                        if (data === value) {\n                            resultRow = row;\n                            return true;\n                        }\n                    }\n                });\n                if (resultRow == null) {\n                    return new CalcError$1(\"N/A\");\n                }\n                return m.get(resultRow, col - 1);\n            }).args([\n                [ \"value\", \"anyvalue\" ],\n                [ \"range\", \"matrix\" ],\n                [ \"col\", \"integer++\" ],\n                [ \"approx\", [ \"or\", \"logical\", [ \"null\", true ]]]\n            ]);\n\n            /* -----[ Date and time functions ]----- */\n\n            defineFunction$1(\"date\", function(year, month, date){\n                return packDate$1(year, month-1, date);\n            }).args([\n                [ \"*year\", \"integer\" ],\n                [ \"*month\", \"integer\" ],\n                [ \"*date\", \"integer\" ]\n            ]);\n\n            defineFunction$1(\"day\", function(date){\n                return unpackDate$1(date).date;\n            }).args([\n                [ \"*date\", \"date\" ]\n            ]);\n\n            defineFunction$1(\"month\", function(date){\n                return unpackDate$1(date).month + 1;\n            }).args([\n                [ \"*date\", \"date\" ]\n            ]);\n\n            defineFunction$1(\"year\", function(date){\n                return unpackDate$1(date).year;\n            }).args([\n                [ \"*date\", \"date\" ]\n            ]);\n\n            defineFunction$1(\"weekday\", function(date){\n                // XXX: TODO type\n                return unpackDate$1(date).day + 1;\n            }).args([\n                [ \"*date\", \"date\" ]\n            ]);\n\n            // https://support.office.com/en-GB/article/WEEKNUM-function-e5c43a03-b4ab-426c-b411-b18c13c75340\n            // XXX: this is a mess.\n            defineFunction$1(\"weeknum\", function(date, type){\n                var fw = packDate$1(unpackDate$1(date).year, 0, 1);\n                var sy = unpackDate$1(fw);\n                var diff;\n                if (type == 21) {\n                    // Monday-based weeks, first week is the one containing the first Thursday of the year\n                    // we want to place in fw and sy the first Thursday\n                    diff = 3 - (sy.day + 6) % 7;\n                    if (diff < 0) {\n                        diff += 7;\n                    }\n                    fw += diff;\n                    sy.date += diff;\n                    sy.day = 4;         // Thursday.\n                    type = 1;\n                } else {\n                    if (type == 1) {\n                        type = 0;\n                    } else if (type == 2) {\n                        type = 1;\n                    } else {\n                        type = (type - 10) % 7;\n                    }\n                    // finally compatible with what we got:\n                    // type == 0 means week starts on Sunday\n                    //         1                      Monday\n                    //         2                      Tuesday\n                    // ...\n                }\n                diff = sy.day - type;\n                if (diff < 0) {\n                    diff += 7;\n                }\n                fw -= diff;\n                return Math.ceil((date + 1 - fw) / 7);\n            }).args([\n                [ \"*date\", \"date\" ],\n                [ \"*type\", [ \"or\", [ \"null\", 1 ],\n                            [ \"values\", 1, 2, 11, 12, 13, 14, 15, 16, 17, 21 ] ] ]\n            ]);\n\n            function weeksInYear(year) {\n                var d = unpackDate$1(packDate$1(year, 0, 1));\n                if ((d.day == 4) || (d.day == 3 && runtime$2.isLeapYear(year))) {\n                    // long year\n                    return 53;\n                }\n                return 52;\n            }\n\n            defineFunction$1(\"isoweeknum\", function isoweeknum(date){\n                // https://en.wikipedia.org/wiki/ISO_week_date#Calculating_the_week_number_of_a_given_date\n                var d = unpackDate$1(date);\n                var dow = d.day || 7;\n                var wk = Math.floor((d.ord - dow + 10) / 7);\n                if (wk < 1) {\n                    return weeksInYear(d.year - 1);\n                } else if (wk == 53 && wk > weeksInYear(d.year)) {\n                    return 1;\n                }\n                return wk;\n            }).args([\n                [ \"*date\", \"date\" ]\n            ]);\n\n            defineFunction$1(\"now\", function(){\n                return runtime$2.dateToSerial(new Date());\n            }).args([]);\n\n            defineFunction$1(\"today\", function(){\n                return runtime$2.dateToSerial(new Date()) | 0;\n            }).args([]);\n\n            defineFunction$1(\"time\", function(hh, mm, ss){\n                return runtime$2.packTime(hh, mm, ss, 0);\n            }).args([\n                [ \"*hours\", \"integer\" ],\n                [ \"*minutes\", \"integer\" ],\n                [ \"*seconds\", \"integer\" ]\n            ]);\n\n            defineFunction$1(\"hour\", function(time){\n                return runtime$2.unpackTime(time).hours;\n            }).args([\n                [ \"*time\", \"datetime\" ]\n            ]);\n\n            defineFunction$1(\"minute\", function(time){\n                return runtime$2.unpackTime(time).minutes;\n            }).args([\n                [ \"*time\", \"datetime\" ]\n            ]);\n\n            defineFunction$1(\"second\", function(time){\n                return runtime$2.unpackTime(time).seconds;\n            }).args([\n                [ \"*time\", \"datetime\" ]\n            ]);\n\n            defineFunction$1(\"edate\", function(base, months){\n                var d = unpackDate$1(base);\n                var m = d.month + months;\n                var y = d.year + Math.floor(m/12);\n                m %= 12;\n                if (m < 0) {\n                    m += 12;\n                }\n                d = Math.min(d.date, daysInMonth$1(y, m));\n                return packDate$1(y, m, d);\n            }).args([\n                [ \"*start_date\", \"date\" ],\n                [ \"*months\", \"integer\" ]\n            ]);\n\n            defineFunction$1(\"eomonth\", function(base, months){\n                var d = unpackDate$1(base);\n                var m = d.month + months;\n                var y = d.year + Math.floor(m/12);\n                m %= 12;\n                if (m < 0) {\n                    m += 12;\n                }\n                d = daysInMonth$1(y, m);\n                return packDate$1(y, m, d);\n            }).args([\n                [ \"*start_date\", \"date\" ],\n                [ \"*months\", \"integer\" ]\n            ]);\n\n            defineFunction$1(\"workday\", function(date, n, holidays){\n                // XXX: the algorithm here is pretty dumb, can we do better?\n                var inc = n > 0 ? 1 : -1;\n                n = Math.abs(n);\n                var dow = unpackDate$1(date).day;\n                while (n > 0) {\n                    date += inc;\n                    dow = (dow + inc) % 7;\n                    if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                        --n;\n                    }\n                }\n                return date;\n            }).args([\n                [ \"start_date\", \"date\" ],\n                [ \"days\", \"integer\" ],\n                [ \"holidays\", [ \"collect\", \"date\" ] ]\n            ]);\n\n            defineFunction$1(\"networkdays\", function(date, end, holidays){\n                // XXX: the algorithm here is pretty dumb, can we do better?\n                if (date > end) {\n                    var tmp = date;\n                    date = end;\n                    end = tmp;\n                }\n                var count = 0;\n                var dow = unpackDate$1(date).day;\n                while (date <= end) {\n                    if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                        count++;\n                    }\n                    date++;\n                    dow = (dow + 1) % 7;\n                }\n                return count;\n            }).args([\n                [ \"start_date\", \"date\" ],\n                [ \"end_date\", \"date\" ],\n                [ \"holidays\", [ \"collect\", \"date\" ] ]\n            ]);\n\n            defineFunction$1(\"days\", function(end, start){\n                return end - start;\n            }).args([\n                [ \"*start_date\", \"date\" ],\n                [ \"*end_date\", \"date\" ]\n            ]);\n\n            defineFunction$1(\"days360\", _days_360$1).args([\n                [ \"*start_date\", \"date\" ],\n                [ \"*end_date\", \"date\" ],\n                [ \"*method\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n            ]);\n\n            defineFunction$1(\"yearfrac\", function(start, end, method){\n                switch (method) {\n                case 0:\n                    return _days_360$1(start, end, false) / 360;\n                case 1:\n                    return (end - start) / daysInYear$1(unpackDate$1(start).year);\n                case 2:\n                    return (end - start) / 360;\n                case 3:\n                    return (end - start) / 365;\n                case 4:\n                    return _days_360$1(start, end, true) / 360;\n                }\n            }).args([\n                [ \"*start_date\", \"date\" ],\n                [ \"*end_date\", \"date\" ],\n                [ \"*method\", [ \"or\", [ \"null\", 0 ], [ \"values\", 0, 1, 2, 3, 4 ] ] ]\n            ]);\n\n            defineFunction$1(\"datevalue\", function(text){\n                var date = runtime$2.parseDate(text);\n                if (date) {\n                    return runtime$2.dateToSerial(date);\n                }\n                return new CalcError$1(\"VALUE\");\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"timevalue\", function(text){\n                var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n                if (m) {\n                    var hh = parseFloat(m[1]);\n                    var mm = parseFloat(m[2]);\n                    var ss = m[3] ? parseFloat(m[4]) : 0;\n                    //var ms = m[5] ? parseFloat(m[6]) : 0;\n                    var ampm = m[7];\n                    if (ampm && (hh > 12 || hh < 1)) {\n                        return new CalcError$1(\"VALUE\");\n                    }\n                    if (/^p/.test(ampm)) {\n                        hh += 12;\n                    }\n                    return runtime$2.packTime(hh, mm, ss, 0);\n                }\n                return new CalcError$1(\"VALUE\");\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            /* -----[ Matrix functions ]----- */\n\n            defineFunction$1(\"mdeterm\", function(m){\n                var error = m.each(function(val){\n                    if (typeof val != \"number\") {\n                        return new CalcError$1(\"VALUE\");\n                    }\n                }, true);\n                return error || m.determinant();\n            }).args([\n                [ \"m\", [ \"and\", \"matrix\",\n                        [ \"assert\", \"$m.width == $m.height\" ] ] ]\n            ]);\n\n            defineFunction$1(\"transpose\", function(m){\n                return m.transpose();\n            }).args([\n                [ \"range\", \"matrix\" ]\n            ]);\n\n            defineFunction$1(\"mmult\", function(a, b){\n                return a.multiply(b);\n            }).args([\n                [ \"a\", \"matrix\" ],\n                [ \"b\", [ \"and\", \"matrix\",\n                        [ \"assert\", \"$b.height == $a.width\" ] ] ]\n            ]);\n\n            defineFunction$1(\"munit\", function(n){\n                return new Matrix(this).unit(n);\n            }).args([\n                [ \"n\", \"integer+\" ]\n            ]);\n\n            defineFunction$1(\"minverse\", function(m){\n                var error = m.each(function(val){\n                    if (typeof val != \"number\") {\n                        return new CalcError$1(\"VALUE\");\n                    }\n                }, true);\n                return error || m.inverse() || new CalcError$1(\"VALUE\");\n            }).args([\n                [ \"m\", [ \"and\", \"matrix\",\n                        [ \"assert\", \"$m.width == $m.height\" ] ] ]\n            ]);\n\n            /* -----[ Other ]----- */\n\n            defineFunction$1(\"rand\", function() {\n                return Math.random();\n            }).args([]);\n\n            defineFunction$1(\"randbetween\", function(min, max){\n                return min + Math.floor((max - min + 1) * Math.random());\n            }).args([\n                [ \"min\", \"integer\" ],\n                [ \"max\", [ \"and\", \"integer\", [ \"assert\", \"$max >= $min\" ] ] ]\n            ]);\n\n            defineFunction$1(\"true\", function(){\n                return true;\n            }).args([]);\n\n            defineFunction$1(\"false\", function(){\n                return true;\n            }).args([]);\n\n            defineFunction$1(\"roman\", function(num){\n                return util.arabicToRoman(num).toUpperCase();\n            }).args([\n                [ \"*number\", \"integer\" ]\n            ]);\n\n            defineFunction$1(\"arabic\", function(rom){\n                var num = util.romanToArabic(rom);\n                return num == null ? new CalcError$1(\"VALUE\") : num;\n            }).args([\n                [ \"*roman\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"base\", function(number, radix, minLen){\n                var str = number.toString(radix).toUpperCase();\n                while (str.length < minLen) {\n                    str = \"0\" + str;\n                }\n                return str;\n            }).args([\n                [ \"*number\", \"integer\" ],\n                [ \"*radix\", [ \"and\", \"integer\", [ \"[between]\", 2, 36 ] ] ],\n                [ \"*minLen\", [ \"or\", \"integer+\", [ \"null\", 0 ] ] ]\n            ]);\n\n            defineFunction$1(\"decimal\", function(text, radix){\n                text = text.toUpperCase();\n                var val = 0;\n                for (var i = 0; i < text.length; ++i) {\n                    var d = text.charCodeAt(i);\n                    if (d >= 48 && d <= 57) {\n                        d -= 48;\n                    } else if (d >= 65 && d < (55 + radix)) {\n                        d -= 55;\n                    } else {\n                        return new CalcError$1(\"VALUE\");\n                    }\n                    val = val * radix + d;\n                }\n                return val;\n            }).args([\n                [ \"*text\", \"string\" ],\n                [ \"*radix\", [ \"and\", \"integer\", [ \"[between]\", 2, 36 ] ] ]\n            ]);\n\n            /* -----[ String functions ]----- */\n\n            defineFunction$1(\"char\", function(code){\n                return String.fromCharCode(code);\n            }).args([\n                [ \"*code\", \"integer+\" ]\n            ]);\n\n            // From XRegExp\n            var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n\n            defineFunction$1(\"clean\", function(text){\n                return text.replace(RX_NON_PRINTABLE, \"\");\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"code\", function(text){\n                return text.charAt(0);\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineAlias(\"unichar\", \"char\");\n            defineAlias(\"unicode\", \"code\");\n\n            defineFunction$1(\"concatenate\", function(args){\n                var out = \"\";\n                for (var i = 0; i < args.length; ++i) {\n                    out += args[i];\n                }\n                return out;\n            }).args([\n                [ \"+\",\n                [ \"*text\", \"string\" ] ]\n            ]);\n\n            defineFunction$1(\"dollar\", function(number, decimals){\n                var format = \"$#,##0DECIMALS;($#,##0DECIMALS)\";\n                var dec = \"\";\n                var denomitator = 1;\n\n                while (decimals-- > 0) {\n                dec += \"0\";\n                }\n\n                while (++decimals < 0) {\n                denomitator *= 10;\n                }\n\n                if (dec !== \"\") {\n                dec = \".\" + dec;\n                } else if (denomitator !== 1) {\n                    number = Math.round(number / denomitator) * denomitator;\n                }\n\n                format = format.replace(/DECIMALS/g, dec);\n\n                return spreadsheet$3.formatting.text(number, format);\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*decimals\", [ \"or\", \"integer\", [ \"null\", 2 ] ] ]\n            ]);\n\n            defineFunction$1(\"exact\", function(a, b){\n                return a === b;\n            }).args([\n                [ \"*text1\", \"string\" ],\n                [ \"*text2\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"find\", function(substring, string, start){\n                var pos = string.indexOf(substring, start - 1);\n                return pos < 0 ? new CalcError$1(\"VALUE\") : pos + 1;\n            }).args([\n                [ \"*substring\", \"string\" ],\n                [ \"*string\", \"string\" ],\n                [ \"*start\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n            ]);\n\n            defineFunction$1(\"fixed\", function(number, decimals, noCommas){\n                var scale = Math.pow(10, decimals);\n                number = Math.round(number * scale) / scale;\n                var format = noCommas ? \"0\" : \"#,##0\";\n                if (decimals > 0) {\n                    format += \".\";\n                    while (decimals-- > 0) { format += \"0\"; }\n                }\n                return spreadsheet$3.formatting.text(number, format);\n            }).args([\n                [ \"*number\", \"number\" ],\n                [ \"*decimals\", [ \"or\", \"integer\", [ \"null\", 2 ] ] ],\n                [ \"*noCommas\", [ \"or\", \"boolean\", [ \"null\", false ] ] ]\n            ]);\n\n            defineFunction$1(\"left\", function(text, length){\n                return text.substr(0, length);\n            }).args([\n                [ \"*text\", \"string\" ],\n                [ \"*length\", [ \"or\", \"integer+\", [ \"null\", 1 ] ] ]\n            ]);\n\n            defineFunction$1(\"right\", function(text, length){\n                return text.substr(-length);\n            }).args([\n                [ \"*text\", \"string\" ],\n                [ \"*length\", [ \"or\", \"integer+\", [ \"null\", 1 ] ] ]\n            ]);\n\n            defineFunction$1(\"len\", function(text){\n                return text.length;\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"lower\", function(text){\n                return text.toLowerCase();\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"upper\", function(text){\n                return text.toUpperCase();\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"ltrim\", function(text){\n                return text.replace(/^\\s+/, \"\");\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"rtrim\", function(text){\n                return text.replace(/\\s+$/, \"\");\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"trim\", function(text){\n                return text.replace(/^\\s+|\\s+$/, \"\");\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"mid\", function(text, start, length){\n                return text.substr(start - 1, length);\n            }).args([\n                [ \"*text\", \"string\" ],\n                [ \"*start\", \"integer++\" ],\n                [ \"*length\", \"integer+\" ]\n            ]);\n\n            defineFunction$1(\"proper\", function(text){\n                return text.toLowerCase().replace(/\\b./g, function(s){\n                    return s.toUpperCase();\n                });\n            }).args([\n                [ \"*text\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"replace\", function(text, start, length, newText){\n                return text.substr(0, --start) + newText + text.substr(start + length);\n            }).args([\n                [ \"*text\", \"string\" ],\n                [ \"*start\", \"integer++\" ],\n                [ \"*length\", \"integer+\" ],\n                [ \"*newText\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"rept\", function(text, number){\n                var out = \"\";\n                while (number-- > 0) { out += text; }\n                return out;\n            }).args([\n                [ \"*text\", \"string\" ],\n                [ \"*number\", \"integer+\" ]\n            ]);\n\n            defineFunction$1(\"search\", function(substring, string, start){\n                var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n                return pos < 0 ? new CalcError$1(\"VALUE\") : pos + 1;\n            }).args([\n                [ \"*substring\", \"string\" ],\n                [ \"*string\", \"string\" ],\n                [ \"*start\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n            ]);\n\n            defineFunction$1(\"substitute\", function(text, oldText, newText, nth){\n                if (oldText === newText) {\n                    return text;\n                }\n                var a = text.split(oldText);\n                if (nth == null) {\n                    return a.join(newText);\n                }\n                text = \"\";\n                nth--;\n                for (var i = 0; i < a.length; ++i) {\n                    text += a[i];\n                    if (i < a.length - 1) {\n                        if (i === nth) {\n                            text += newText;\n                        } else {\n                            text += oldText;\n                        }\n                    }\n                }\n                return text;\n            }).args([\n                [ \"*text\", \"string\" ],\n                [ \"*oldText\", \"string\" ],\n                [ \"*newText\", \"string\" ],\n                [ \"*nth\", [ \"or\", \"integer++\", \"null\" ] ]\n            ]);\n\n            defineFunction$1(\"t\", function(value){\n                return typeof value == \"string\" ? value : \"\";\n            }).args([\n                [ \"*value\", \"anyvalue\" ]\n            ]);\n\n            defineFunction$1(\"text\", function(value, format){\n                return spreadsheet$3.formatting.text(value, format);\n            }).args([\n                [ \"*value\", \"anyvalue\" ],\n                [ \"*format\", \"string\" ]\n            ]);\n\n            defineFunction$1(\"value\", function(value){\n                if (typeof value == \"number\") {\n                    return value;\n                }\n                if (typeof value == \"boolean\") {\n                    return +value;\n                }\n                // XXX: this is dirty.  we need it so we can parse i.e. \"$12,345.50\"\n                value = (value+\"\").replace(/[$,]/g, \"\");\n                value = parseFloat(value);\n                return isNaN(value) ? new CalcError$1(\"VALUE\") : value;\n            }).args([\n                [ \"*value\", \"anyvalue\" ]\n            ]);\n\n            function Hyperlink(link, text) {\n                this.link = link;\n                this.text = text;\n            }\n            Hyperlink.prototype.toString = function() {\n                return this.text;\n            };\n\n            defineFunction$1(\"hyperlink\", function(link, text){\n                return new Hyperlink(link, text);\n            }).args([\n                [ \"*link\", \"string\" ],\n                [ \"*text\", [ \"or\", \"string\", [ \"null\", \"$link\" ] ] ]\n            ]);\n\n            //// other misc functions\n\n            defineFunction$1(\"iferror\", function(value, valueIfError){\n                return value instanceof CalcError$1 ? valueIfError : value;\n            }).args([\n                [ \"*value\", \"forced!\" ],\n                [ \"*value_if_error\", \"anyvalue!\" ]\n            ]);\n\n            //// utils\n\n            var parseCriteria = (function(){\n                var RXCACHE = Object.create(null);\n\n                function makeComparator(cmp, x) {\n                    if (typeof x == \"string\") {\n                        var num = parseFloat(x);\n                        if (!isNaN(num) && num == x) {\n                            x = num;\n                        }\n                    }\n                    return function(a) {\n                        var b = x;\n                        if (typeof a == \"string\" && typeof b == \"string\") {\n                            a = a.toLowerCase();\n                            b = b.toLowerCase();\n                        }\n                        return cmp(a, b);\n                    };\n                }\n\n                function lc(a) {\n                    var num, str;\n                    if (typeof a == \"string\") {\n                        a = a.toLowerCase();\n                    }\n                    if (/^[0-9.]+%$/.test(a)) {\n                        str = a.substr(0, a.length - 1);\n                        num = parseFloat(str);\n                        if (!isNaN(num) && num == str) {\n                            a = num / 100;\n                        }\n                    } else if (/^[0-9.]+$/.test(a)) {\n                        num = parseFloat(a);\n                        if (!isNaN(num) && num == a) {\n                            a = num;\n                        }\n                    }\n                    return a;\n                }\n\n                function compLT(a, b) { return lc(a) < lc(b); }\n                function compLTE(a, b) { return lc(a) <= lc(b); }\n                function compGT(a, b) { return lc(a) > lc(b); }\n                function compGTE(a, b) { return lc(a) >= lc(b); }\n                function compNE(a, b) { return !compEQ(a, b); }\n                function compEQ(a, b) {\n                    if (b instanceof RegExp) {\n                        return b.test(a);\n                    }\n                    if (typeof a == \"string\" || typeof b == \"string\") {\n                        // if either one is string, make sure both are strings\n                        a = String(a);\n                        b = String(b);\n                    }\n                    return lc(a) == lc(b);\n                }\n\n                return function(cmp) {\n                    if (typeof cmp == \"function\") {\n                        return cmp;\n                    }\n                    var m;\n                    if ((m = /^=(.*)$/.exec(cmp))) {\n                        return makeComparator(compEQ, m[1]);\n                    }\n                    if ((m = /^<>(.*)$/.exec(cmp))) {\n                        return makeComparator(compNE, m[1]);\n                    }\n                    if ((m = /^<=(.*)$/.exec(cmp))) {\n                        return makeComparator(compLTE, m[1]);\n                    }\n                    if ((m = /^<(.*)$/.exec(cmp))) {\n                        return makeComparator(compLT, m[1]);\n                    }\n                    if ((m = /^>=(.*)$/.exec(cmp))) {\n                        return makeComparator(compGTE, m[1]);\n                    }\n                    if ((m = /^>(.*)$/.exec(cmp))) {\n                        return makeComparator(compGT, m[1]);\n                    }\n                    if (/[?*]/.exec(cmp)) {\n                        // has wildchars\n                        var rx = RXCACHE[cmp];\n                        if (!rx) {\n                            rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function(s){\n                                switch (s) {\n                                case \"~?\" : return \"\\\\?\";\n                                case \"~*\" : return \"\\\\*\";\n                                case \"?\"  : return \".\";\n                                case \"*\"  : return \".*\";\n                                default   : return \"\\\\\" + s;\n                                }\n                            });\n                            rx = RXCACHE[cmp] = new RegExp(\"^\" + rx + \"$\", \"i\");\n                        }\n                        return makeComparator(compEQ, rx);\n                    }\n                    return makeComparator(compEQ, cmp);\n                };\n            })();\n\n            function numericPredicate(val) {\n                return typeof val == \"number\"\n                    || typeof val == \"boolean\"\n                    || val == null\n                    || val === \"\";\n            }\n\n            function ascending(a, b) {\n                return a === b ? 0 : a < b ? -1 : 1;\n            }\n\n            function descending(a, b) {\n                return a === b ? 0 : a < b ? 1 : -1;\n            }\n\n            // var m = new Matrix();\n            // m.data = [[1, 2, 3], [4, 1, 6], [7, 8, 9]];\n            // //m.data = [[0, 2, 1], [2, 6, 1], [1, 1, 4]];\n            // //m.data = [[1,4,1,1], [1,4,0,1], [2,3,1,2], [3,2,6,4]];\n            // m.width = m.height = 3;\n            // var x = m.inverse();\n            // x.dump();\n        });\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n\n        var spreadsheet$2 = kendo.spreadsheet;\n        var calc = spreadsheet$2.calc;\n        var runtime$1 = calc.runtime;\n        var defineFunction = runtime$1.defineFunction;\n        var CalcError = runtime$1.CalcError;\n        var packDate = runtime$1.packDate;\n        var unpackDate = runtime$1.unpackDate;\n        var isLeapYear = runtime$1.isLeapYear;\n        var daysInMonth = runtime$1.daysInMonth;\n        var _days_360 = runtime$1._days_360;\n\n        runtime$1.deferInit(() => {\n            /* -----[ Spreadsheet API ]----- */\n            defineFunction(\"ERF\", function(ll, ul) {\n                if (ul == null) {\n                    return ERF(ll);\n                }\n                return ERF(ul) - ERF(ll);\n            }).args([\n                [ \"lower_limit\", \"number\" ],\n                [ \"upper_limit\", [ \"or\", \"number\", \"null\" ] ]\n            ]);\n\n            defineFunction(\"ERFC\", ERFC).args([\n                [ \"x\", \"number\" ]\n            ]);\n\n            defineFunction(\"GAMMALN\", GAMMALN).args([\n                [ \"x\", \"number++\" ]\n            ]);\n\n            defineFunction(\"GAMMA\", GAMMA).args([\n                [ \"x\", \"number\" ]\n            ]);\n\n            defineFunction(\"GAMMA.DIST\", GAMMA_DIST).args([\n                [ \"x\", \"number+\" ],\n                [ \"alpha\", \"number++\" ],\n                [ \"beta\", \"number++\" ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineFunction(\"GAMMA.INV\", GAMMA_INV).args([\n                [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"alpha\", \"number++\" ],\n                [ \"beta\", \"number++\" ]\n            ]);\n\n            defineFunction(\"NORM.S.DIST\", NORM_S_DIST).args([\n                [ \"z\", \"number\" ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineFunction(\"NORM.S.INV\", NORM_S_INV).args([\n                [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n            ]);\n\n            defineFunction(\"NORM.DIST\", NORM_DIST).args([\n                [ \"x\", \"number\" ],\n                [ \"mean\", \"number\" ],\n                [ \"stddev\", \"number++\" ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineFunction(\"NORM.INV\", NORM_INV).args([\n                [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"mean\", \"number\" ],\n                [ \"stddev\", \"number++\" ]\n            ]);\n\n            defineFunction(\"BETADIST\", BETADIST).args([\n                [ \"x\", \"number\" ],\n                [ \"alpha\", \"number++\" ],\n                [ \"beta\", \"number++\" ],\n                [ \"A\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"B\", [ \"or\", \"number\", [ \"null\", 1 ] ] ],\n                [ \"?\", [ \"assert\", \"$x >= $A\", \"NUM\" ] ],\n                [ \"?\", [ \"assert\", \"$x <= $B\", \"NUM\" ] ],\n                [ \"?\", [ \"assert\", \"$A < $B\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"BETA.DIST\", BETA_DIST).args([\n                [ \"x\", \"number\" ],\n                [ \"alpha\", \"number++\" ],\n                [ \"beta\", \"number++\" ],\n                [ \"cumulative\", \"logical\" ],\n                [ \"A\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"B\", [ \"or\", \"number\", [ \"null\", 1 ] ] ],\n                [ \"?\", [ \"assert\", \"$x >= $A\", \"NUM\" ] ],\n                [ \"?\", [ \"assert\", \"$x <= $B\", \"NUM\" ] ],\n                [ \"?\", [ \"assert\", \"$A < $B\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"BETA.INV\", BETA_INV).args([\n                [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"alpha\", \"number++\" ],\n                [ \"beta\", \"number++\" ],\n                [ \"A\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"B\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n            ]);\n\n            defineFunction(\"CHISQ.DIST\", chisq_left).args([\n                [ \"x\", \"number+\" ],\n                [ \"deg_freedom\", \"integer++\" ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineFunction(\"CHISQ.DIST.RT\", chisq_right).args([\n                [ \"x\", \"number+\" ],\n                [ \"deg_freedom\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"CHISQ.INV\", chisq_left_inv).args([\n                [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"deg_freedom\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"CHISQ.INV.RT\", chisq_right_inv).args([\n                [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"deg_freedom\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"CHISQ.TEST\", function(ac, ex){\n                return chisq_test(ac.data, ex.data);\n            }).args([\n                [ \"actual_range\", \"matrix\" ],\n                [ \"expected_range\", \"matrix\" ],\n                [ \"?\", [ \"assert\", \"$actual_range.width == $expected_range.width\" ] ],\n                [ \"?\", [ \"assert\", \"$actual_range.height == $expected_range.height\" ] ]\n            ]);\n\n            defineFunction(\"EXPON.DIST\", expon).args([\n                [ \"x\", \"number+\" ],\n                [ \"lambda\", \"number++\" ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineFunction(\"POISSON.DIST\", poisson).args([\n                [ \"x\", \"integer+\" ],\n                [ \"mean\", \"number+\" ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineFunction(\"F.DIST\", Fdist).args([\n                [ \"x\", \"number+\" ],\n                [ \"deg_freedom1\", \"integer++\" ],\n                [ \"deg_freedom2\", \"integer++\" ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineFunction(\"F.DIST.RT\", Fdist_right).args([\n                [ \"x\", \"number+\" ],\n                [ \"deg_freedom1\", \"integer++\" ],\n                [ \"deg_freedom2\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"F.INV\", Finv).args([\n                [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"deg_freedom1\", \"integer++\" ],\n                [ \"deg_freedom2\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"F.INV.RT\", Finv_right).args([\n                [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n                [ \"deg_freedom1\", \"integer++\" ],\n                [ \"deg_freedom2\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"F.TEST\", Ftest).args([\n                [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n                [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$array1.length >= 2\", \"DIV/0\" ] ],\n                [ \"?\", [ \"assert\", \"$array2.length >= 2\", \"DIV/0\" ] ]\n            ]);\n\n            defineFunction(\"FISHER\", fisher).args([\n                [ \"x\", [ \"and\", \"number\", [ \"(between)\", -1, 1 ] ] ]\n            ]);\n\n            defineFunction(\"FISHERINV\", fisherinv).args([\n                [ \"y\", \"number\" ]\n            ]);\n\n            defineFunction(\"T.DIST\", Tdist).args([\n                [ \"x\", \"number\" ],\n                [ \"deg_freedom\", \"integer++\" ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineFunction(\"T.DIST.RT\", Tdist_right).args([\n                [ \"x\", \"number\" ],\n                [ \"deg_freedom\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"T.DIST.2T\", Tdist_2tail).args([\n                [ \"x\", \"number+\" ],\n                [ \"deg_freedom\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"T.INV\", Tdist_inv).args([\n                [ \"p\", [ \"and\", \"number\", [ \"(between]\", 0, 1 ] ] ],\n                [ \"deg_freedom\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"T.INV.2T\", Tdist_2tail_inv).args([\n                [ \"p\", [ \"and\", \"number\", [ \"(between]\", 0, 1 ] ] ],\n                [ \"deg_freedom\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"T.TEST\", Tdist_test).args([\n                [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n                [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n                [ \"tails\", [ \"and\", \"integer\", [ \"values\", 1, 2 ] ] ],\n                [ \"type\", [ \"and\", \"integer\", [ \"values\", 1, 2, 3 ] ] ],\n                [ \"?\", [ \"assert\", \"$type != 1 || $array1.length == $array2.length\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$array1.length >= 2\", \"DIV/0\" ] ],\n                [ \"?\", [ \"assert\", \"$array2.length >= 2\", \"DIV/0\" ] ]\n            ]);\n\n            defineFunction(\"CONFIDENCE.T\", confidence_t).args([\n                [ \"alpha\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ],\n                [ \"standard_dev\", \"number++\" ],\n                [ \"size\", [ \"and\", \"integer++\",\n                            [ \"assert\", \"$size != 1\", \"DIV/0\" ] ] ]\n            ]);\n\n            defineFunction(\"CONFIDENCE.NORM\", confidence_norm).args([\n                [ \"alpha\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ],\n                [ \"standard_dev\", \"number++\" ],\n                [ \"size\", [ \"and\", \"integer++\" ] ]\n            ]);\n\n            defineFunction(\"GAUSS\", gauss).args([\n                [ \"z\", \"number\" ]\n            ]);\n\n            defineFunction(\"PHI\", phi).args([\n                [ \"x\", \"number\" ]\n            ]);\n\n            defineFunction(\"LOGNORM.DIST\", lognorm_dist).args([\n                [ \"x\", \"number++\" ],\n                [ \"mean\", \"number\" ],\n                [ \"standard_dev\", \"number++\" ],\n                [ \"cumulative\", \"logical\" ]\n            ]);\n\n            defineFunction(\"LOGNORM.INV\", lognorm_inv).args([\n                [ \"probability\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ],\n                [ \"mean\", \"number\" ],\n                [ \"standard_dev\", \"number++\" ]\n            ]);\n\n            defineFunction(\"PROB\", prob).args([\n                [ \"x_range\", [ \"collect\", \"number\", 1 ] ],\n                [ \"prob_range\", [ \"collect\", \"number\", 1 ] ],\n                [ \"lower_limit\", \"number\" ],\n                [ \"upper_limit\", [ \"or\", \"number\", [ \"null\", \"$lower_limit\" ] ] ],\n                [ \"?\", [ \"assert\", \"$prob_range.length == $x_range.length\", \"N/A\" ] ]\n            ]);\n\n            defineFunction(\"SLOPE\", slope).args([\n                [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n                [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ]\n            ]);\n\n            defineFunction(\"INTERCEPT\", intercept).args([\n                [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n                [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ]\n            ]);\n\n            defineFunction(\"PEARSON\", pearson).args([\n                [ \"array1\", [ \"collect!\", \"anything\", 1 ] ],\n                [ \"array2\", [ \"collect!\", \"anything\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$array2.length == $array1.length\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$array2.length > 0 && $array1.length > 0\", \"N/A\" ] ]\n            ]);\n\n            defineFunction(\"RSQ\", rsq).args([\n                [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n                [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length != 1 && $known_y.length != 1\", \"N/A\" ] ]\n            ]);\n\n            defineFunction(\"STEYX\", steyx).args([\n                [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n                [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length >= 3 && $known_y.length >= 3\", \"DIV/0\" ] ]\n            ]);\n\n            defineFunction(\"FORECAST\", forecast).args([\n                [ \"x\", \"number\" ],\n                [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n                [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n                [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ]\n            ]);\n\n            defineFunction(\"LINEST\", linest).args([\n                [ \"known_y\", \"matrix\" ],\n                [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n                [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ],\n                [ \"stats\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n            ]);\n\n            defineFunction(\"LOGEST\", logest).args([\n                [ \"known_y\", \"matrix\" ],\n                [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n                [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ],\n                [ \"stats\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n            ]);\n\n            defineFunction(\"TREND\", trend).args([\n                [ \"known_y\", \"matrix\" ],\n                [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n                [ \"new_x\", [ \"or\", \"matrix\", \"null\" ] ],\n                [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ]\n            ]);\n\n            defineFunction(\"GROWTH\", growth).args([\n                [ \"known_y\", \"matrix\" ],\n                [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n                [ \"new_x\", [ \"or\", \"matrix\", \"null\" ] ],\n                [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ]\n            ]);\n\n            defineFunction(\"FV\", FV).args([\n                [ \"rate\", \"number\" ],\n                [ \"nper\", \"number\" ],\n                [ \"pmt\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"pv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n                [ \"?\", [ \"assert\", \"$pmt || $pv\" ] ]\n            ]);\n\n            defineFunction(\"PV\", PV).args([\n                [ \"rate\", \"number\" ],\n                [ \"nper\", \"number\" ],\n                [ \"pmt\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ]\n            ]);\n\n            defineFunction(\"PMT\", PMT).args([\n                [ \"rate\", \"number\" ],\n                [ \"nper\", \"number\" ],\n                [ \"pmt\", \"number\" ],\n                [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ]\n            ]);\n\n            defineFunction(\"NPER\", NPER).args([\n                [ \"rate\", \"number\" ],\n                [ \"pmt\", \"number\" ],\n                [ \"pv\", \"number\" ],\n                [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ]\n            ]);\n\n            defineFunction(\"RATE\", RATE).args([\n                [ \"nper\", \"number\" ],\n                [ \"pmt\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"pv\", \"number\" ],\n                [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n                [ \"guess\", [ \"or\", \"number++\", [ \"null\", 0.01 ] ] ],\n                [ \"?\", [ \"assert\", \"$pmt || $fv\" ] ]\n            ]);\n\n            defineFunction(\"IPMT\", IPMT).args([\n                [ \"rate\", \"number\" ],\n                [ \"per\", \"number++\" ],\n                [ \"nper\", \"number++\" ],\n                [ \"pv\", \"number\" ],\n                [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n                [ \"?\", [ \"assert\", \"$per >= 1 && $per <= $nper\" ] ]\n            ]);\n\n            defineFunction(\"PPMT\", PPMT).args([\n                [ \"rate\", \"number\" ],\n                [ \"per\", \"number++\" ],\n                [ \"nper\", \"number++\" ],\n                [ \"pv\", \"number\" ],\n                [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n                [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n                [ \"?\", [ \"assert\", \"$per >= 1 && $per <= $nper\" ] ]\n            ]);\n\n            defineFunction(\"CUMPRINC\", CUMPRINC).args([\n                [ \"rate\", \"number++\" ],\n                [ \"nper\", \"number++\" ],\n                [ \"pv\", \"number++\" ],\n                [ \"start_period\", \"number++\" ],\n                [ \"end_period\", \"number++\" ],\n                [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n                [ \"?\", [ \"assert\", \"$end_period >= $start_period\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"CUMIPMT\", CUMIPMT).args([\n                [ \"rate\", \"number++\" ],\n                [ \"nper\", \"number++\" ],\n                [ \"pv\", \"number++\" ],\n                [ \"start_period\", \"number++\" ],\n                [ \"end_period\", \"number++\" ],\n                [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n                [ \"?\", [ \"assert\", \"$end_period >= $start_period\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"NPV\", NPV).args([\n                [ \"rate\", \"number\" ],\n                [ \"values\", [ \"collect\", \"number\" ] ],\n                [ \"?\", [ \"assert\", \"$values.length > 0\", \"N/A\" ] ]\n            ]);\n\n            defineFunction(\"IRR\", IRR).args([\n                [ \"values\", [ \"collect\", \"number\", 1 ] ],\n                [ \"guess\", [ \"or\", \"number\", [ \"null\", 0.1 ] ] ]\n            ]);\n\n            defineFunction(\"EFFECT\", EFFECT).args([\n                [ \"nominal_rate\", \"number++\" ],\n                [ \"npery\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"NOMINAL\", NOMINAL).args([\n                [ \"effect_rate\", \"number++\" ],\n                [ \"npery\", \"integer++\" ]\n            ]);\n\n            defineFunction(\"XNPV\", XNPV).args([\n                [ \"rate\", \"number\" ],\n                [ \"values\", [ \"collect\", \"number\", 1 ] ],\n                [ \"dates\", [ \"collect\", \"date\", 1 ] ],\n                [ \"?\", [ \"assert\", \"$values.length == $dates.length\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"XIRR\", XIRR).args([\n                [ \"values\", [ \"collect\", \"number\", 1 ] ],\n                [ \"dates\", [ \"collect\", \"date\", 1 ] ],\n                [ \"guess\", [ \"or\", \"number\", [ \"null\", 0.1 ] ] ],\n                [ \"?\", [ \"assert\", \"$values.length == $dates.length\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"ISPMT\", ISPMT).args([\n                [ \"rate\", \"number\" ],\n                [ \"per\", \"number++\" ],\n                [ \"nper\", \"number++\" ],\n                [ \"pv\", \"number\" ],\n                [ \"?\", [ \"assert\", \"$per >= 1 && $per <= $nper\" ] ]\n            ]);\n\n            defineFunction(\"DB\", DB).args([\n                [ \"cost\", \"number\" ],\n                [ \"salvage\", \"number\" ],\n                [ \"life\", \"number++\" ],\n                [ \"period\", \"number++\" ],\n                [ \"month\", [ \"or\", \"number\", [ \"null\", 12 ] ] ]\n            ]);\n\n            defineFunction(\"DDB\", DDB).args([\n                [ \"cost\", \"number\" ],\n                [ \"salvage\", \"number\" ],\n                [ \"life\", \"number++\" ],\n                [ \"period\", \"number++\" ],\n                [ \"factor\", [ \"or\", \"number\", [ \"null\", 2 ] ] ]\n            ]);\n\n            defineFunction(\"SLN\", SLN).args([\n                [ \"cost\", \"number\" ],\n                [ \"salvage\", \"number\" ],\n                [ \"life\", \"number++\" ]\n            ]);\n\n            defineFunction(\"SYD\", SYD).args([\n                [ \"cost\", \"number\" ],\n                [ \"salvage\", \"number\" ],\n                [ \"life\", \"number++\" ],\n                [ \"per\", \"number++\" ]\n            ]);\n\n            defineFunction(\"VDB\", VDB).args([\n                [ \"cost\", \"number+\" ],\n                [ \"salvage\", \"number+\" ],\n                [ \"life\", \"number++\" ],\n                [ \"start_period\", \"number+\" ],\n                [ \"end_period\", \"number+\" ],\n                [ \"factor\", [ \"or\", \"number+\", [ \"null\", 2 ] ] ],\n                [ \"no_switch\", [ \"or\", \"logical\", [ \"null\", false ] ] ],\n                [ \"?\", [ \"assert\", \"$end_period >= $start_period\", \"NUM\" ] ]\n            ]);\n\n            var COUPS_ARGS = [\n                [ \"settlement\", \"date\" ],\n                [ \"maturity\", \"date\" ],\n                [ \"frequency\", [ \"and\", \"integer\", [ \"values\", 1, 2, 4 ] ] ],\n                [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                            [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n                [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n            ];\n\n            defineFunction(\"COUPDAYBS\", COUPDAYBS).args(COUPS_ARGS);\n\n            defineFunction(\"COUPDAYS\", COUPDAYS).args(COUPS_ARGS);\n\n            defineFunction(\"COUPDAYSNC\", COUPDAYSNC).args(COUPS_ARGS);\n\n            defineFunction(\"COUPPCD\", COUPPCD).args(COUPS_ARGS);\n\n            defineFunction(\"COUPNCD\", COUPNCD).args(COUPS_ARGS);\n\n            defineFunction(\"COUPNUM\", COUPNUM).args(COUPS_ARGS);\n\n            defineFunction(\"ACCRINTM\", ACCRINTM).args([\n                [ \"issue\", \"date\" ],\n                [ \"settlement\", \"date\" ],\n                [ \"rate\", \"number++\" ],\n                [ \"par\", [ \"or\", [ \"null\", 1000 ], \"number++\" ] ],\n                [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                            [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n                [ \"?\", [ \"assert\", \"$issue < $settlement\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"ACCRINT\", ACCRINT).args([\n                [ \"issue\", \"date\" ],\n                [ \"first_interest\", \"date\" ],\n                [ \"settlement\", \"date\" ],\n                [ \"rate\", \"number++\" ],\n                [ \"par\", [ \"or\", [ \"null\", 1000 ], \"number++\" ] ],\n                [ \"frequency\", [ \"and\", \"integer\", [ \"values\", 1, 2, 4 ] ] ],\n                [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                            [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n                [ \"calc_method\", [ \"or\", \"logical\", [ \"null\", true ] ] ],\n                [ \"?\", [ \"assert\", \"$issue < $settlement\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"DISC\", DISC).args([\n                [ \"settlement\", \"date\" ],\n                [ \"maturity\", \"date\" ],\n                [ \"pr\", \"number++\" ],\n                [ \"redemption\", \"number++\" ],\n                [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                            [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n                [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"INTRATE\", INTRATE).args([\n                [ \"settlement\", \"date\" ],\n                [ \"maturity\", \"date\" ],\n                [ \"investment\", \"number++\" ],\n                [ \"redemption\", \"number++\" ],\n                [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                            [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n                [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"RECEIVED\", RECEIVED).args([\n                [ \"settlement\", \"date\" ],\n                [ \"maturity\", \"date\" ],\n                [ \"investment\", \"number++\" ],\n                [ \"discount\", \"number++\" ],\n                [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                            [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n                [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"PRICE\", PRICE).args([\n                [ \"settlement\", \"date\" ],\n                [ \"maturity\", \"date\" ],\n                [ \"rate\", \"number++\" ],\n                [ \"yld\", \"number++\" ],\n                [ \"redemption\", \"number++\" ],\n                [ \"frequency\", [ \"and\", \"integer\", [ \"values\", 1, 2, 4 ] ] ],\n                [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                            [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n                [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n            ]);\n\n            defineFunction(\"PRICEDISC\", PRICEDISC).args([\n                [ \"settlement\", \"date\" ],\n                [ \"maturity\", \"date\" ],\n                [ \"discount\", \"number++\" ],\n                [ \"redemption\", \"number++\" ],\n                [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                            [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n                [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n            ]);\n        });\n        /* -----[ utils ]----- */\n\n        // function resultAsMatrix(f) {\n        //     return function() {\n        //         var a = f.apply(this, arguments);\n        //         return this.asMatrix(a);\n        //     };\n        // }\n\n        /* -----[ definitions: statistical functions ]----- */\n\n        var MAX_IT = 300,     // Maximum allowed number of iterations\n            EPS = 2.2204e-16, // Relative accuracy; 1-3*(4/3-1) = 2.220446049250313e-16\n            FP_MIN = 1.0e-30, // Near the smallest representable as floating-point, number.\n            f_abs = Math.abs;\n\n        function ERF(x) {\n            if (f_abs(x) >= 3.3) {\n                return 1 - ERFC(x);\n            }\n            var S = x > 0 ? 1 : -1;\n            if (S == -1) {\n                x = -x;\n            }\n            var m = 0, an = 1;\n            for (var n = 1; n < 100; n++) {\n                m += an;\n                an *= 2*x*x/(2*n+1);\n            }\n            return S*2/Math.sqrt(Math.PI)*x*Math.exp(-x*x)*m;\n        }\n\n        function ERFC(x) {\n            if (f_abs(x) < 3.3) {\n                return 1 - ERF(x);\n            }\n            var s = 1;\n            if (x < 0) {\n                s = -1;\n                x = -x;\n            }\n            var frac = x;\n            for (var n = 8; n >= 1; n -= 0.5) {\n                frac = x + n/frac;\n            }\n            frac = 1 / (x + frac);\n            return s == 1\n                ? Math.exp(-x*x)/Math.sqrt(Math.PI)*frac\n                : 2 - Math.exp(-x*x)/Math.sqrt(Math.PI)*frac;\n        }\n\n        function GAMMALN(x) { // Returns the value ln[(x)] for x > 0.\n            var cof = [\n                1.000000000190015, 76.18009172947146, -86.50532032941677,\n                24.01409824083091, -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5\n            ];\n            var y = x, tmp = x + 5.5, ser = cof[0];\n            tmp -= (x + 0.5) * Math.log(tmp);\n            for (var j = 1; j <= 6; j++) {\n                y += 1;\n                ser += cof[j] / y;\n            }\n            return -tmp + Math.log(Math.sqrt(2*Math.PI) * ser / x); // log((x)) = log((x+1)) - log(x)\n        }\n\n        function GAMMA(x) { // returns Infinity for 0 or negative _integer argument.\n            if (x > 0) {\n                return Math.exp(GAMMALN(x));\n            }\n            var pi = Math.PI, y = -x; // For x<0 we use the reflection formula: (x)(1-x) = PI / sin(PI*x)\n            return -pi / (y*GAMMA(y)*Math.sin(pi*y));\n        }\n\n        function BETALN(a, b) {\n            return GAMMALN(a) + GAMMALN(b) - GAMMALN(a+b);\n        }\n\n        function BETA(a, b) {\n            return Math.exp(BETALN(a, b));\n        }\n\n        function gamma_inc(a, x) { // returns the normalized incomplete gamma function P(a, x); x > 0.\n            return x < a+1.0 ? g_series(a, x) : 1 - g_contfrac(a, x);\n        }\n\n        function g_series(a, x) { // evaluate P(a, x) by its series representation (converges quickly for x < a+1).\n            var sum = 1/a,\n                frac = sum,\n                ap = a;\n            var gln = GAMMALN(a), n;\n            for (n = 1; n <= MAX_IT; n++) {\n                ap++;\n                frac *= x/ap;\n                sum += frac;\n                if (f_abs(frac) < f_abs(sum)*EPS) {\n                    break; // already the last frac is too small versus the current sum value\n                }\n            }\n            return sum * Math.exp(-x + a*Math.log(x) - gln); // e^{-x} * x^a * (a) * sum\n        }\n\n        function g_contfrac(a, x) { // Q(a, x) by its continued fraction representation (converges quickly for x > a + 1); modified Lentzs method (Numerical Recipes (The Art of Scientific Computing), 2rd Edition $5.2)\n            var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n            var gln = GAMMALN(a);\n            for (var i = 1; i <= MAX_IT; i++) {\n                d = bj + aj * d;\n    \t    if (f_abs(d) < FP_MIN) {\n                    d = FP_MIN;\n                }\n    \t    c = bj + aj / c;\n    \t    if (f_abs(c) < FP_MIN) {\n                    c = FP_MIN;\n                }\n    \t    d = 1 / d;\n    \t    var delta = c * d;\n    \t    f *= delta;\n        \t    if (f_abs(delta - 1) < EPS) {\n                    break;\n                }\n    \t    bj += 2;\n    \t    aj = -i * (i - a);\n    \t}\n    \treturn f * Math.exp(-x - gln + a * Math.log(x));\n        }\n\n        function GAMMA_DIST(x, a, b, cumulative) { // a > 0, b > 0; x >= 0\n            if (!cumulative) {\n                return Math.pow(x/b, a-1)*Math.exp(-x/b)/(b*GAMMA(a)); // the PDF of the Gamma distribution\n            }\n            return gamma_inc(a, x/b); // (else) compute the CDF (using the incomplete Gamma function)\n        }\n\n        function GAMMA_INV(p, a, b) { // the quantile function of the Gamma distribution\n    \tif (p === 0) {\n                return 0;\n            }\n    \tif (p == 1) {\n                return Infinity;\n            }\n    \tvar m = 0, M = 10, x = 0, ab = a*b;\n    \tif (ab > 1) {\n                M *= ab;\n            }\n    \tfor (var i = 0; i < MAX_IT; i++) {\n    \t    x = 0.5*(m + M); // console.log(x);\n    \t    var q = GAMMA_DIST(x, a, b, true);\n    \t    if (f_abs(p - q) < 1e-16) {\n                    break;\n                }\n    \t    if (q > p) {\n                    M = x;\n                } else {\n                    m = x;\n                }\n    \t}\n    \treturn x;\n        }\n\n        function NORM_S_DIST(x, cumulative) {\n            if (!cumulative) {\n                return Math.exp(-x*x/2)/Math.sqrt(2*Math.PI);\n            }\n            return 0.5 + 0.5*ERF(x/Math.sqrt(2));\n        }\n\n        function NORM_S_INV(p) { // see [1] $26.2.3 and http://home.online.no/~pjacklam/notes/invnorm/#References\n            // Coefficients in rational approximations.\n            var a = [-3.969683028665376e+01,  2.209460984245205e+02,\n                     -2.759285104469687e+02,  1.383577518672690e+02,\n                     -3.066479806614716e+01,  2.506628277459239e+00],\n                b = [-5.447609879822406e+01,  1.615858368580409e+02,\n                     -1.556989798598866e+02,  6.680131188771972e+01,\n                     -1.328068155288572e+01],\n                c = [-7.784894002430293e-03, -3.223964580411365e-01,\n                     -2.400758277161838e+00, -2.549732539343734e+00,\n                     4.374664141464968e+00,  2.938163982698783e+00],\n                d = [ 7.784695709041462e-03,  3.224671290700398e-01,\n                      2.445134137142996e+00,  3.754408661907416e+00];\n            // Define break-points.\n            var plow  = 0.02425,\n                phigh = 1 - plow;\n            var q, r;\n            // Rational approximation for lower region:\n            if (p < plow) {\n                q = Math.sqrt(-2*Math.log(p));\n                return (((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n            }\n            // Rational approximation for upper region:\n            if (phigh < p) {\n                q = Math.sqrt(-2*Math.log(1-p));\n                return -(((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n            }\n            // Rational approximation for central region:\n            q = p - 0.5;\n            r = q*q;\n            return (((((a[0]*r+a[1])*r+a[2])*r+a[3])*r+a[4])*r+a[5])*q / (((((b[0]*r+b[1])*r+b[2])*r+b[3])*r+b[4])*r+1);\n        }\n\n        function NORM_DIST(x, m, s, cumulative) {\n            if (!cumulative) {\n                return Math.exp(-(x-m)*(x-m)/(2*s*s))/(s*Math.sqrt(2*Math.PI)); // NORM_S_DIST((x-m)/s)/s;\n            }\n            return NORM_S_DIST((x-m)/s, true);\n        }\n\n        function NORM_INV(p, m, s) {\n            return m + s*NORM_S_INV(p);\n        }\n\n        function betastd_pdf(x, a, b) {\n            return Math.exp((a-1)*Math.log(x) + (b-1)*Math.log(1-x) - BETALN(a, b));\n        }\n\n        function betastd_cdf(x, a, b) {\n            var k = Math.exp(a*Math.log(x) + b*Math.log(1-x) - BETALN(a, b));\n            return x < (a+1)/(a+b+2) ? k*beta_lentz(a, b, x)/a : 1 - k*beta_lentz(b, a, 1-x)/b;\n        }\n\n        function beta_lentz(a, b, x) { // estimates continued fraction by modified Lentzs method ([2] $8.17.22)\n            var m, m2;\n            var aa, c, d, del, h, qab, qam, qap;\n            qab = a + b; // These qs will be used in factors that occur in the coefficients d_n\n            qap = a + 1;\n            qam = a - 1;\n            c = 1; // First step of Lentzs method.\n            d = 1 - qab * x / qap;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            d = 1/d;\n            h = d;\n            for (m = 1; m <= MAX_IT; m++) {\n                m2 = 2*m;\n                aa = m*(b - m)*x / ((qam + m2)*(a + m2));\n                d = 1 + aa*d; // One step (the even one) of the recurrence.\n                if (f_abs(d) < FP_MIN) {\n                    d = FP_MIN;\n                }\n                c = 1 + aa/c;\n                if (f_abs(c) < FP_MIN) {\n                    c = FP_MIN;\n                }\n                d = 1/d;\n                h *= d*c;\n                aa = -(a + m)*(qab + m)*x / ((a + m2)*(qap + m2));\n                d = 1 + aa*d; // Next step of the recurrence (the odd one).\n                if (f_abs(d) < FP_MIN) {\n                    d = FP_MIN;\n                }\n                c = 1 + aa/c;\n                if (f_abs(c) < FP_MIN) {\n                    c = FP_MIN;\n                }\n                d = 1/d;\n                del = d*c;\n                h *= del;\n                if (f_abs(del - 1) < EPS) {\n                    break;\n                }\n            }\n            return h; // if(m > MAX_IT) throw new Error(\"a or b too big, or MAX_IT too small\");\n        }\n\n        function betastd_inv(p, a, b) { // the quantile function of the standard Beta distribution\n    \tvar m = 0, M = 1, x = 0;\n    \tfor (var i = 0; i < MAX_IT; i++) {\n    \t    x = 0.5*(m + M);\n    \t    var q = betastd_cdf(x, a, b);\n    \t    if (f_abs(p - q) < EPS) {\n                    break;\n                }\n    \t    if (q > p) {\n                    M = x;\n                } else {\n                    m = x;\n                }\n    \t}\n    \treturn x;\n        }\n\n        function BETADIST(x, a, b, m, M) {\n            return betastd_cdf((x-m)/(M-m), a, b);\n        }\n\n        function BETA_DIST(x, a, b, cdf, m, M) {\n            if (cdf) {\n                return betastd_cdf((x-m)/(M-m), a, b);\n            }\n            return betastd_pdf((x-m)/(M-m), a, b) / (M-m);\n        }\n\n        function BETA_INV(p, a, b, m, M) {\n            return m + (M-m)*betastd_inv(p, a, b);\n        }\n\n        function chisq_left(x, n, cds) {  // CHISQ.DIST(x,deg_freedom,cumulative)\n            return GAMMA_DIST(x, n/2, 2, cds);\n        }\n\n        function chisq_right(x, n) { // CHISQ.DIST.RT(x,deg_freedom)\n            return 1 - chisq_left(x, n, true);\n        }\n\n        function chisq_left_inv(p, n) { // CHISQ.INV( probability, degrees_freedom )\n            return GAMMA_INV(p, n/2, 2);\n        }\n\n        function chisq_right_inv(p, n) { // CHISQ.INV.RT(probability,deg_freedom)\n            return chisq_left_inv(1-p, n);\n        }\n\n        function chisq_test(obsv, expect) {\n            var rows = obsv.length, cols = obsv[0].length;\n            var x = 0, i, j;\n            for (i = 0; i < rows; i++) {\n                for (j = 0; j < cols; j++) {\n                    var eij = expect[i][j];\n                    var delta = obsv[i][j] - eij;\n                    delta *= delta;\n                    x += delta/eij;\n                }\n            }\n            var n = (rows - 1)*(cols - 1);\n            return chisq_right(x, n);\n        }\n\n        function expon(x, r, cdf) { // EXPON.DIST(x, lambda, cumulative)\n            if (cdf) {\n                return 1 - Math.exp(-r*x);\n            }\n            return r * Math.exp(-r*x);\n        }\n\n        function poisson(k, m, cdf) { // POISSON.DIST(x, mean, cumulative)\n            if (cdf) {\n                return 1 - chisq_left(2*m, 2*(k+1), true);\n            }\n            //return chisq_left(2*m, 2*k, true) - chisq_left(2*m, 2*(k+1), true);\n            var lnf = 0;\n            for (var i = 2; i <= k; i++) {\n                lnf += Math.log(i); // compute log(k!)\n            }\n            return Math.exp(k*Math.log(m) - m - lnf);\n        }\n\n        function Fdist(x, n, d, cdf) { //F.DIST(x,deg_freedom1,deg_freedom2,cumulative)\n            if (cdf) {\n                return betastd_cdf(n*x/(d+n*x), n/2, d/2);\n            }\n            var u = n/d;\n            n /= 2; d /= 2;\n            return u/BETA(n, d) * Math.pow(u*x, n-1) / Math.pow(1+u*x, n+d);\n        }\n\n        function Fdist_right(x, n, d) { // F.DIST.RT(x,deg_freedom1,deg_freedom2)\n            return 1 - Fdist(x, n, d, true);\n        }\n\n        function Finv_right(p, n, d) { // F.INV.RT(probability,deg_freedom1,deg_freedom2\n            return d/n*(1/BETA_INV(p, d/2, n/2, 0, 1) - 1);\n        }\n\n        function Finv(p, n, d) { // F.INV(probability,deg_freedom1,deg_freedom2\n            return d/n*(1/BETA_INV(1-p, d/2, n/2, 0, 1) - 1);\n        }\n\n        function _mean(arr) {\n            var me = 0, n = arr.length;\n            for (var i = 0; i < n; i++) {\n                me += arr[i];\n            }\n            return me / n;\n        }\n\n        function _var_sq(arr, m) { // returns the (n-1)-part of the sum of the squares of deviations from m (= VAR)\n            var v = 0, n = arr.length;\n            for (var i = 0; i < n; i++) {\n                var delta = arr[i] - m;\n                v += delta*delta;\n            }\n            return v / (n-1);\n        }\n\n        function Ftest(arr1, arr2) { // F.TEST(array1,array2)\n            var n1 = arr1.length - 1, n2 = arr2.length - 1;\n            var va1 = _var_sq(arr1, _mean(arr1)),\n                va2 = _var_sq(arr2, _mean(arr2));\n            if (!va1 || !va2) {\n                throw new CalcError(\"DIV/0\");\n            }\n            return 2*Fdist(va1 / va2, n1, n2, true);\n        }\n\n        function fisher(x) { // FISHER(x)\n            return 0.5*Math.log((1+x)/(1-x));\n        }\n\n        function fisherinv(x) { // FISHERINV(x)\n            var e2 = Math.exp(2*x);\n            return (e2 - 1)/(e2 + 1);\n        }\n\n        function Tdist(x, n, cdf) { // T.DIST(x,deg_freedom, cumulative)\n            if (cdf) {\n                return 1 - 0.5*betastd_cdf(n/(x*x+n), n/2, 0.5);\n            }\n            return 1/(Math.sqrt(n)*BETA(0.5, n/2)) * Math.pow(1 + x*x/n, -(n+1)/2);\n        }\n\n        function Tdist_right(x, n) { // T.DIST.RT(x,deg_freedom)\n            return 1 - Tdist(x, n, true);\n        }\n\n        function Tdist_2tail(x, n) { // T.DIST.2T(x,deg_freedom)\n            if (x < 0) {\n                x = -x;\n            }\n            return 2*Tdist_right(x, n);\n        }\n\n        function Tdist_inv(p, n) { // T.INV(probability,deg_freedom)\n            var x = betastd_inv(2*Math.min(p, 1-p), n/2, 0.5); // ibetainv();\n            x = Math.sqrt(n * (1 - x) / x);\n            return (p > 0.5) ? x : -x;\n        }\n\n        function Tdist_2tail_inv(p, n) { // T.INV.2T(probability,deg_freedom)\n            // T2 = 2T_r = p => T_r(x,n) = p/2 => 1 - T(x,n,true) = p/2 => x = T^-1(1-p/2, n)\n            return Tdist_inv(1-p/2, n);\n        }\n\n        function Tdist_test(gr1, gr2, tail, type) { // T.TEST(array1,array2,tails,type)\n            var n1 = gr1.length, n2 = gr2.length;\n            var t_st, df; // the t-statistic and the \"degree of freedom\"\n            if (type == 1) { // paired (dependent) samples\n                var d = 0, d2 = 0;\n                for (var i = 0; i < n1; i++) {\n                    var delta = gr1[i] - gr2[i];\n                    d += delta;\n                    d2 += delta*delta;\n                }\n                var md = d/n1; //, md2 = d2 / n1;\n                t_st = md / Math.sqrt((d2 - d*md)/(n1*(n1-1))); // has a \"Student T\" distribution\n                return tail == 1 ? Tdist_right(t_st, n1-1) : Tdist_2tail(t_st, n1-1);\n            }\n            // unpaired (independent) samples\n            var m1 = _mean(gr1), m2 = _mean(gr2),\n                v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n            if (type == 3) { // unpaired, unequal variances\n                var u1 = v1/n1, u2 = v2/n2, u = u1 + u2;\n                var q1 = u1/u, q2 = u2/u; // u==0 must be invalidated\n                df = 1/(q1*q1/(n1-1) + q2*q2/(n2-1));\n                t_st =  f_abs(m1-m2)/Math.sqrt(u);\n                return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n            }\n            else { // (type == 2) unpaired, equal variances (\"equal\" in the sense that there is no significant difference in variance in both groups - a prealable F-test could revealed that)\n                df = n1 + n2 - 2;\n                t_st = f_abs(m1-m2)*Math.sqrt(df*n1*n2/((n1+n2)*((n1-1)*v1+(n2-1)*v2)));\n                return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n            }\n        }\n\n        function confidence_t(alpha, stddev, size) { // CONFIDENCE.T(alpha,standard_dev,size)\n            return -Tdist_inv(alpha/2, size-1)*stddev/Math.sqrt(size);\n        }\n\n        function confidence_norm(alpha, stddev, size) { // CONFIDENCE.NORM(alpha,standard_dev,size)\n            return -NORM_S_INV(alpha/2)*stddev/Math.sqrt(size);\n        }\n\n        function gauss(z) { // GAUSS(z)\n            return NORM_S_DIST(z, true) - 0.5;\n        }\n\n        function phi(x) { // PHI(x)\n            return NORM_S_DIST(x);\n        }\n\n        function lognorm_dist(x, m, s, cumulative) { // LOGNORM.DIST(x,mean,standard_dev,cumulative)\n            if (cumulative) {\n                return 0.5 + 0.5*ERF((Math.log(x)-m)/(s*Math.sqrt(2)));\n            }\n            var t = Math.log(x)-m;\n            return Math.exp(-t*t/(2*s*s))/(x*s*Math.sqrt(2*Math.PI));\n        }\n\n        function lognorm_inv(p, m, s) { //LOGNORM.INV(probability, mean, standard_dev)\n            return Math.exp(NORM_INV(p, m, s));\n        }\n\n        function prob(x_, p_, lw, up) { //PROB(x_range, prob_range, [lower_limit], [upper_limit])\n            var n = x_.length;\n            var s = 0, i;\n            for (i = 0; i < n; i++) {\n                if (p_[i] <= 0 || p_[i] > 1) {\n                    throw new CalcError(\"NUM\");\n                }\n                s += p_[i];\n            }\n            if (s != 1) {\n                throw new CalcError(\"NUM\");\n            }\n            var res = 0;\n            for (i = 0; i < n; i++) {\n                var x = x_[i];\n                if (x >= lw && x <= up) {\n                    res += p_[i];\n                }\n            }\n            return res;\n        }\n\n        function slope(y_, x_) { // SLOPE(known_y's, known_x's)\n            var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n            for (var i = 0, n = y_.length; i < n; i++) {\n                var t = x_[i] - mx;\n                b1 += t*(y_[i] - my);\n                b2 += t*t;\n            }\n            return b1/b2;\n        }\n\n        function intercept(y_, x_) { // INTERCEPT(known_y's, known_x's)\n            var mx = _mean(x_), my = _mean(y_);\n            // return my - mx*slope(y_, x_);  //but repeating the calls for _mean()\n            var b1 = 0, b2 = 0;\n            for (var i = 0, n = y_.length; i < n; i++) {\n                var t = x_[i] - mx;\n                b1 += t*(y_[i] - my);\n                b2 += t*t;\n            }\n            return my - b1*mx/b2;\n        }\n\n        function pearson(x_, y_) { // PEARSON(array1, array2)\n            whipNumberArrays(x_, y_);\n            var mx = _mean(x_), my = _mean(y_);\n            var s1 = 0, s2 = 0, s3 = 0;\n            for(var i = 0, n = x_.length; i < n; i++) {\n                var t1 = x_[i] - mx, t2 = y_[i] - my;\n                s1 += t1*t2;\n                s2 += t1*t1;\n                s3 += t2*t2;\n            }\n            return s1/Math.sqrt(s2*s3);\n        }\n\n        function rsq(x_, y_) { // RSQ(known_y's,known_x's)\n            var r = pearson(x_, y_);\n            return r*r;\n        }\n\n        function steyx(y_, x_) { //STEYX(known_y's, known_x's)\n            var n = x_.length;\n            var mx = _mean(x_), my = _mean(y_);\n            var s1 = 0, s2 = 0, s3 = 0;\n            for (var i = 0; i < n; i++) {\n                var t1 = x_[i] - mx, t2 = y_[i] - my;\n                s1 += t2*t2;\n                s2 += t1*t2;\n                s3 += t1*t1;\n            }\n            return Math.sqrt((s1 - s2*s2/s3)/(n-2));\n        }\n\n        function forecast(x, y_, x_) { //FORECAST(x, known_y's, known_x's)\n            var mx = _mean(x_), my = _mean(y_);\n            var s1 = 0, s2 = 0;\n            for (var i = 0, n = x_.length; i < n; i++) {\n                var t1 = x_[i] - mx, t2 = y_[i] - my;\n                s1 += t1*t2;\n                s2 += t1*t1;\n            }\n            if (s2 === 0) {\n                throw new CalcError(\"N/A\");\n            }\n            var b = s1/s2, a = my - b*mx;\n            return a + b*x;\n        }\n\n        function _mat_mean(Mat) { // returns the mean value of a Matrix(n, 1)\n            var n = Mat.height, sum = 0;\n            for (var i=0; i < n; i++) {\n                sum += Mat.data[i][0];\n            }\n            return sum/n;\n        }\n\n        function _mat_devsq(Mat, mean) { // returns the sum of squares of deviations for a Matrix(n, 1)\n            var n = Mat.height, sq = 0;\n            for (var i=0; i < n; i++) {\n                var x = Mat.data[i][0] - mean;\n                sq += x*x;\n            }\n            return sq;\n        }\n\n        function linest(Y, X, konst, stats) { // LINEST(known_y's, [known_x's], [const], [stats])\n            var i = 0;\n\n            if (!X) {\n                // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n                X = Y.map(function(){ return ++i; });\n            }\n\n            if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n                X = X.clone();\n                X.eachRow(function(row){\n                    X.data[row].unshift(1);\n                });\n                ++X.width;\n            }\n\n            var Xt = X.transpose();\n            var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n            var line_1 = [];\n            for (i = B.height-1; i >= 0; i--) {\n                line_1.push(B.data[i][0]); // regression coefficients ('slopes') and the y_intercept\n            }\n            if (!konst) {\n                line_1.push(0); // display 0 for y_intercept, when const==false\n            }\n            if (!stats) {\n                return this.asMatrix([ line_1 ]); // don't display statistics about the regression, when stats==false\n            }\n\n            var Y1 = X.multiply(B); // the predicted Y values\n            var y_y1 = Y.adds(Y1, true); // the errors of the predictions (= Y - Y1)\n            var mp = !konst? 0 : _mat_mean(Y1);\n            var SSreg = _mat_devsq(Y1, mp); // The regression sum of squares\n            var me = !konst? 0 : _mat_mean(y_y1);\n            var SSresid = _mat_devsq(y_y1, me); // The residual sum of squares\n            var line_5 = [];\n            line_5.push(SSreg, SSresid);\n            var R2 = SSreg / (SSreg + SSresid); // The coefficient of determination\n            var degfre = Y.height - X.width; // The degrees of freedom\n            var err_est = Math.sqrt(SSresid / degfre); // The standard error for the y estimate\n            var line_3 = [];\n            line_3.push(R2, err_est);\n            var F_sta = !konst ? (R2/X.width)/((1-R2)/(degfre)) : (SSreg/(X.width-1))/(SSresid/degfre); // The F statistic\n            var line_4 = [];\n            line_4.push(F_sta, degfre);\n            var SCP = Xt.multiply(X).inverse();\n            var line_2 = [];\n            for (i=SCP.height-1; i >= 0; i--) { // The standard errors (of coefficients an y-intercept)\n                line_2.push(Math.sqrt(SCP.data[i][i]*SSresid/degfre));\n            }\n            return this.asMatrix([line_1, line_2, line_3, line_4, line_5]);\n        }\n\n        function logest(Y, X, konst, stats) { // LOGEST(known_y's, [known_x's], [const], [stats])\n            return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n        }\n\n        function trend(Y, X, W, konst) { // TREND(known_y's, [known_x's], [new_x's], [const])\n            var i = 0;\n\n            if (!X) {\n                // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n                X = Y.map(function(){ return ++i; });\n            }\n\n            if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n                X = X.clone();\n                X.eachRow(function(row){\n                    X.data[row].unshift(1);\n                });\n                ++X.width;\n            }\n\n            var Xt = X.transpose();\n            var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n\n            if (!W) {\n                W = X;\n            } else {\n                if (konst) { // for non-zero y_intercept\n                    W = W.clone();\n                    W.eachRow(function(row){\n                        W.data[row].unshift(1);\n                    });\n                    ++W.width;\n                }\n            }\n            return W.multiply(B); // the predicted Y values for the W values\n        }\n\n        function growth(Y, X, new_X, konst) { // GROWTH(known_y's, [known_x's], [new_x's], [const])\n            // = EXP(TREND(LN(Y_), X_, new_X, const))\n            return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n        }\n\n        /*\n          [1] Handbook of Mathematical Functions (NIST, 1964-2010):\n          https://en.wikipedia.org/wiki/Abramowitz_and_Stegun\n          http://dlmf.nist.gov/\n          http://www.aip.de/groups/soe/local/numres/\n\n          [2] https://en.wikibooks.org/wiki/Statistics/Numerical_Methods/Numerics_in_Excel\n        */\n\n        /* -----[ financial functions ]----- */\n\n        //// find the root of a function known an initial guess (Newton's method) ////\n        function root_newton(func, guess, max_it, eps) { // func(x) must return [value_F(x), value_F'(x)]\n            var MAX_IT = max_it || 20, // maximum number of iterations\n                EPS = eps || 1E-7; // accuracy\n            var root = guess;\n            for (var j = 1; j <= MAX_IT; j++) {\n                var f_d = func(root),\n                    f = f_d[0], // the value of the function\n                    df = f_d[1]; // the value of the derivative\n                var dx = f / df;\n                root -= dx;\n                if (Math.abs(dx) < EPS) {\n                    return root;\n                }\n            }\n            return new CalcError(\"NUM\");\n        }\n\n\n        /* https://support.office.com/en-us/article/PV-function-23879d31-0e02-4321-be01-da16e8168cbd\n           if(rate==0):\n           PMT * nper + PV + FV = 0\n           else: //the basic equation (with six variables) implied in financial problems\n           PV * (1+rate)^nper + PMT * (1+rate*type) * ((1+rate)^nper-1) / rate + FV = 0         [1]\n        */\n\n\n\n        //// FV (final or future value) ////\n        /* I initially invest 1000 in a saving scheme and then at the end of each month I invest an\n           extra 50. If the interest rate is 0.5% per month and I continue this process for two year,\n           how much will my saving be worth: =FV(0.005, 24, -50, -1000, 0) */\n        function FV(rate, nper, pmt, pv, type) { // FV(rate,nper,pmt,[pv],[type])\n            var h1 = Math.pow(1+rate, nper);\n            var h2 = rate ? (h1 - 1)/rate : nper;\n            return -(pv * h1 + pmt * h2 * (1 + rate*type));\n        }\n\n        //// PV (present value of investment) ////\n        /* If I wish to accumulate 5000 in four years time by depositing 75 per month in a fixed\n           rate account with interest rate of 0.4% per month, what initial investment must I also\n           make: =PV(0.004, 4*12, -75, 5000, 0) */\n        function PV(rate, nper, pmt, fv, type) { // PV(rate, nper, pmt, [fv], [type])\n            if (!rate) {\n                return -fv - pmt*nper;\n            }\n            var h1 = Math.pow(1+rate, nper);\n            return -(fv + pmt * (h1 - 1)/rate * (1 + rate*type)) / h1;\n        }\n\n        //// PMT monthly payments (= principal part PPMT + interest part IPMT) ////\n        /* How much will the monthly repayments be if I borrow 100,000 over 20 years with an\n           effective monthly interest rate is 0.5%: =PMT(0.005, 12*20, 100000, 0, 0) */\n        function PMT(rate, nper, pv, fv, type) { // PMT(rate, nper, pv, [fv], [type])\n            if (!rate) {\n                return -(fv + pv)/nper;\n            }\n            var h1 = Math.pow(1+rate, nper);\n            return -rate*(fv + pv*h1)/((1 + rate*type)*(h1 - 1));\n        }\n\n        //// NPER (number of periods for an investment) ////\n        /* How long would it take me to pay off a loan of 10,000 at a rate of 0.5% per month if I\n           can afford to pay 100 per month: =NPER(0.5%, -100, 10000, 0, 0) */\n        function NPER(rate, pmt, pv, fv, type) { // NPER(rate,pmt,pv,[fv],[type])\n            if (!rate) {\n                return -(fv + pv) / pmt;\n            }\n            var h1 = pmt*(1 + rate*type);\n            return Math.log((h1 - fv*rate)/(h1 + pv*rate)) / Math.log(1 + rate);\n        }\n\n        //// RATE (the interest rate per period) ////\n        /* I borrow 1000 over 1 year making payments of 100 per month at the end of each\n           month. What is the monthly interest rate: =RATE(12, 100, 1000, 0, 0, 0) */\n\n        function RATE (nper, pmt, pv, fv, type, guess) { // RATE(nper, pmt, pv, [fv], [type], [guess])\n            function xfd(x) { // returns F(x) and F'(x), where F is given by the equation [1]\n                var h2 = Math.pow(1+x, nper-1), h1 = h2*(1+x);\n                return [ pv*h1 + pmt*(1/x + type)*(h1 - 1) + fv,\n                         nper*pv*h2 + pmt*(-(h1 - 1)/(x*x) + (1/x + type)*nper*h2) ];\n            }\n            return root_newton(xfd, guess); // a root of the equation F(x)=0\n        }\n\n        //// IPMT (interest part of a loan or investment) ////\n        //// PPMT (principal part of a loan) ////\n\n        function IPMT(rate, per, nper, pv, fv, type) { // IPMT(rate, per, nper, pv, [fv], [type])\n            if(type==1 && per==1) { // interest before beginnig of the payments... = ZERO\n                return 0;\n            }\n            var pmt = PMT(rate, nper, pv, fv, type);\n            var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n            return type ? ipmt/(1 + rate) : ipmt;\n        }\n\n        function PPMT(rate, per, nper, pv, fv, type) { // PPMT(rate, per, nper, pv, [fv], [type])\n            var pmt = PMT(rate, nper, pv, fv, type);\n            return pmt - IPMT(rate, per, nper, pv, fv, type);\n        }\n\n        //// CUMPRINC (cumulative principal paid) ////\n        /* The amount financed is $200,000 at an interest rate of 7.25% for 30 years. How much is the amount of principal\n           and the amount of interest paid in the first year: CUMPRINC(0.0725/12, 12*30, 200000, 1, 12, 0)\n           and CUMIPMT(0.0725/12, 12*30, 200000, 1, 12, 0) */\n        function CUMPRINC(rate, nper, pv, start, end, type) { // CUMPRINC(rate, nper, pv, start_period, end_period, type)\n            if(type == 1) { // start >= 1 (as in Excel), but if pay at beginning of the period (type==1),\n                start --;    // then periods must be counted from Zero (decreasing given start and end parameters)\n                end --;\n            }\n            var tn = Math.pow(1 + rate, nper),\n                ts = Math.pow(1 + rate, start-1),\n                te = Math.pow(1 + rate, end);\n            var monthlyPayment = rate * pv * tn / (tn - 1);\n            var remainingBalanceAtStart = ts * pv - ((ts - 1) / rate) * monthlyPayment;\n            var remainingBalanceAtEnd = te * pv - ((te - 1) / rate) * monthlyPayment;\n            return remainingBalanceAtEnd - remainingBalanceAtStart;\n        }\n\n        //// CUMIPMT (cumulative  interest paid) ////\n        function CUMIPMT(rate, nper, pv, start, end, type) { // CUMIPMT(rate, nper, pv, start_period, end_period, type)\n            var cip = 0;\n            for(var i=start; i<=end; i++) {\n                cip += IPMT(rate, i, nper, pv, 0, type);\n            }\n            return cip;\n        }\n\n        //// NPV (Net Present Value of an investment based on a series of periodic cash flows and a discount rate) ////\n        function NPV(rate, flows) { // NPV(rate,value1,[value2],...)\n            var npv = 0;\n            for(var i=0, n=flows.length; i < n; i++) {\n                npv += flows[i]*Math.pow(1 + rate, -i-1);\n            }\n            return npv;\n        }\n\n        //// IRR (Internal Rate of Return on an investment based on a series of periodic cash flows) ////\n        function IRR(flows, guess) { // IRR(values, [guess])\n            function xfd(x) {\n                var npv = 0, npv1 = 0;\n                for(var j=0, n=flows.length; j < n; j++) {\n                    npv += flows[j]*Math.pow(1 + x, -j-1); // construct the NPV(x) value,\n                    npv1 += -j*flows[j]*Math.pow(1+x, -j-2); // the value in x of the NPV()-derivative\n                }\n                return [npv, npv1];\n            }\n            return root_newton(xfd, guess);\n        }\n\n        //// EFFECT (effective annual interest rate) ////\n        /* which investment option is better - one that pays 5 percent after one year, or a\n           savings account that pays a monthly interest of 4.75 percent:\n           = (5% - EFFECT(4.75%, 12)) * 10000 */\n        function EFFECT(nominal_rate, npery) { // EFFECT(nominal_rate, npery)\n            return Math.pow(1 + nominal_rate/npery, npery) - 1;\n        }\n\n        //// NOMINAL (nominal annual interest rate) ////\n        function NOMINAL(effect_rate, npery) { // NOMINAL(effect_rate, npery)\n            return npery*(Math.pow(effect_rate + 1, 1/npery) - 1);\n        }\n\n        //// XNPV (Net Present Value of a series of cashflows at irregular intervals) ////\n        function XNPV(rate, values, dates) { // XNPV(rate, values, dates)\n            var npv = 0;\n            for(var i=0, n=values.length; i < n; i++) {\n                npv += values[i]*Math.pow(1 + rate, (dates[0]-dates[i])/365);\n            }\n            return npv;\n        }\n\n        //// XIRR (Internal Rate of Return of a series of cashflows at irregular intervals) ////\n        function XIRR(values, dates, guess) { // XIRR(values, dates, [guess])\n            function xfd(x) {\n                var npv = values[0], npv1 = 0;\n                for(var j=1, n=values.length; j < n; j++) {\n                    var delta = (dates[0] - dates[j]) / 365;\n                    npv += values[j]*Math.pow(1 + x, delta); // construct the XNPV(x) value,\n                    npv1 += delta*values[j]*Math.pow(1+x, delta - 1); // the value in x of the XNPV()-derivative\n                }\n                return [npv, npv1];\n            }\n            return root_newton(xfd, guess); // , 100, 0.1);\n        }\n\n        //// ISPMT (Interest paid during a Specific Period of an investment) ////\n        function ISPMT(rate, per, nper, pv) { // ISPMT(rate, per, nper, pv)\n            var tmp = -pv*rate;\n            return tmp*(1 - per/nper);\n        }\n\n        //// DB (Declining Balance depreciation) ////\n        function DB(cost, salvage, life, period, month) { // DB(cost, salvage, life, period, [month])\n            var rate = 1 - Math.pow(salvage/cost, 1/life);\n            rate = Math.floor(rate*1000 + 0.5) / 1000; // rounded to three decimals\n            var db = cost * rate * month / 12;\n            if(period == 1) {\n                return db;\n            }\n            for(var i=1; i < life; i++) {\n                if(i == period - 1) {\n                    return (cost - db) * rate;\n                }\n                db += (cost - db) * rate;\n            }\n            return (cost - db) * rate * (12 - month) / 12;\n        }\n\n        //// DDB (Double Declining Balance depreciation) ////\n        function DDB(cost, salvage, life, period, factor) { // DDB(cost, salvage, life, period, [factor])\n            var f = factor / life;\n            var prior = -cost * (Math.pow(1-f, period-1) - 1);\n            var dep = (cost - prior) * f;\n            /* Depreciation cannot exceed book value.  */\n            dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n            return dep;\n        }\n\n        //// SLN (straight-line depreciation) ////\n        function SLN(cost, salvage, life) { // SLN(cost, salvage, life)\n            return (cost - salvage) / life;\n        }\n\n        //// SYD (Sum-of-Years' digits Depreciation) ////\n        function SYD(cost, salvage, life, per) { // SYD(cost, salvage, life, per)\n            return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n        }\n\n        //// VDB (Variable Declining Balance) ////\n        //\n        // Code adapted from Gnumeric, which in turn took it from OpenOffice.  The original code is\n        // available under GNU Lesser General Public License (LGPL).\n        // https://github.com/GNOME/gnumeric/blob/master/plugins/fn-financial/sc-fin.c\n        function VDB (cost, salvage, life, start, end, factor, no_switch) {\n            var interest = factor >= life ? 1 : factor / life;\n\n            function _getGDA(value, period) {\n                var gda, oldValue, newValue;\n                if (interest == 1) {\n                    oldValue = period == 1 ? value : 0;\n                } else {\n                    oldValue = value * Math.pow(1 - interest, period - 1);\n                }\n                newValue = value * Math.pow(1 - interest, period);\n                gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n                return gda < 0 ? 0 : gda;\n            }\n\n            function _interVDB(cost, life1, period) {\n                var remValue = cost - salvage;\n                var intEnd = Math.ceil(period);\n                var term, lia = 0, vdb = 0, nowLia = false;\n                for (var i = 1; i <= intEnd; i++) {\n                    if (!nowLia) {\n                        var gda = _getGDA(cost, i);\n                        lia = remValue / (life1 - i + 1);\n                        if (lia > gda) {\n                            term = lia;\n                            nowLia = true;\n                        } else {\n                            term = gda;\n                            remValue -= gda;\n                        }\n                    } else {\n                        term = lia;\n                    }\n                    if (i == intEnd) {\n                        term *= period + 1 - intEnd;\n                    }\n                    vdb += term;\n                }\n                return vdb;\n            }\n\n            var intStart = Math.floor(start), intEnd = Math.ceil(end);\n            var vdb = 0;\n            if (no_switch) {\n                for (var i = intStart + 1; i <= intEnd; i++) {\n                    var term = _getGDA(cost, i);\n                    if (i == intStart + 1) {\n                        term *= Math.min(end, intStart + 1) - start;\n                    } else {\n                        if (i == intEnd) {\n                            term *= end + 1 - intEnd;\n                        }\n                    }\n                    vdb += term;\n                }\n            } else {\n                var life1 = life;\n                if (start != Math.floor(start)) {\n                    if (factor > 1) {\n                        if (start >= life / 2) {\n                            var part = start - life / 2;\n                            start = life / 2;\n                            end -= part;\n                            life1 += 1;\n                        }\n                    }\n                }\n                cost -= _interVDB(cost, life1, start);\n                vdb = _interVDB(cost, life - start, end - start);\n            }\n            return vdb;\n        }\n\n        /*************************************************************************************/\n\n        /*   (from  http://beginnersinvest.about.com)\n             an investor agrees to loan money to a company or government in exchange for a predetermined interest rate for a pre-determined length of time.\n\n             If an investor wanted to buy a $25,000 Coca-Cola bond with a 30 year maturity and an 10% coupon, it would work like this: He would send in the $25,000 from his savings account and get a $25,000 engraved bond certificate in exchange. After 30 years, he would be able to get his whole $25,000 back from the Coca-Cola company (of course, he can always sell it before then if he needs the money).\n\n             Every year, hes entitled to receive 10% interest on the money he lent, or $2,500. Since most companies in the United States pay interest semi-annually, he would likely have 60 coupons attached to his bond for $1,250 each.\n             Every June 30th and December 31st, the investor would go down, clip the proper coupon, send it in, and get their money.\n\n             Although the practice is now defunct, the terminology stuck and interest payments on bonds will forever be known as coupons.\n        */\n\n\n        // \"Use EDATE to calculate maturity dates or due dates that fall on the same day of the month as the date of issue.\"\n        // See also: DATEDIF, DAY, DAYS, DAY360, EOMONTH (wich can be useful to determine limits of coupon periods)\n        function _edate(base, months) { // EDATE(start_date, months)\n            var d = unpackDate(base);\n            var m = d.month + months;\n            var y = d.year + Math.floor(m/12);\n            m %= 12;\n            if (m < 0) {\n                m += 12;\n            }\n            d = Math.min(d.date, daysInMonth(y, m));\n            return packDate(y, m, d);\n        }\n\n        function _daysBetween(from, to, basis) {\n            if (basis == 1 || basis == 2 || basis == 3) { // Actual/Actual || Actual/360 || Actual/365\n                return to - from;\n            }\n            return _days_360(from, to, basis);\n        }\n\n        // Find coupon dates that enclose the settlement date, counting backward from the maturity date.\n        /* independent of the 'basis' convention to count days - here we have no need to count days */\n        function _borderCoupons(settlement, maturity, freq) {\n            var sett = unpackDate(settlement), base = unpackDate(maturity);\n            var periods = base.year - sett.year;\n            if (periods > 0) {\n                periods = (periods - 1) * freq;\n            }\n            var prev, next, months = 12/freq;\n            do {\n                periods++;\n                prev = _edate(maturity, - periods*months);\n            } while (settlement < prev);\n            periods--;\n            next = _edate(maturity, - periods*months);\n            return [ prev, next ];\n        }\n\n        // Find coupon dates that enclose the settlement date, counting forward from the first-coupon payment.\n        /* independent of the 'basis' convention to count days - here we have no need to count days */\n        function _borderCoupons_fw(first, settlement, freq) {\n            var sett = unpackDate(settlement), base = unpackDate(first);\n            var periods = sett.year - base.year;\n            if (periods > 0) {\n                periods = (periods - 1) * freq;\n            }\n            var prev = first, next, months = 12/freq;\n            while (settlement > prev) {\n                next = prev;\n                periods++;\n                prev = _edate(first, periods*months);\n            }\n            return [ next, prev ];\n        }\n\n        //// COUPDAYBS (COUPon DAYs Beginning to Settlement) ////\n        /* returns the number of days from the beginning of the coupon period to the settlement date */\n        function COUPDAYBS(settlement, maturity, frequency, basis) { // COUPDAYBS(settlement, maturity, frequency, [basis])\n            var prev = _borderCoupons(settlement, maturity, frequency)[0];\n            return _daysBetween(prev, settlement, basis);\n        }\n\n        //// COUPDAYS (COUPon DAYs containing Settlement) ////\n        /* Returns the number of days in the coupon period that contains the settlement date */\n        function COUPDAYS(settl, matur, freq, basis) { // COUPDAYS(settlement, maturity, frequency, [basis])\n            if (basis == 1) {\n                var borders = _borderCoupons(settl, matur, freq);\n                return _daysBetween(borders[0], borders[1], 1);\n            }\n            if (basis == 3) {\n                return 365/freq;\n            }\n            return 360/freq;\n        }\n\n        //// COUPDAYSNC (COUPon DAYs Settlement to Next Coupon) ////\n        /* Returns the number of days from the settlement date to the next coupon date */\n        function COUPDAYSNC(settl, matur, freq, basis) { // COUPDAYSNC(settlement, maturity, frequency, [basis])\n            var next = _borderCoupons(settl, matur, freq)[1];\n            return _daysBetween(settl, next, basis);\n        }\n\n        //// COUPPCD (COUPon, Previous Coupon Date) ////\n        /* Returns the previous coupon date before the settlement date */\n        function COUPPCD(settl, matur, freq/*, basis*/) { // COUPPCD(settlement, maturity, frequency, [basis])\n            // It is no need to count days, so 'basis' becomes a inutil parameter.\n            return _borderCoupons(settl, matur, freq)[0];\n        }\n\n        //// COUPNCD (COUPon, Next Coupon Date) ////\n        /* Returns the next coupon date after the settlement date */\n        function COUPNCD(settl, matur, freq/*, basis*/) { // COUPNCD(settlement, maturity, frequency, [basis])\n            // It is no need to count days, so 'basis' becomes a inutil parameter.\n            return _borderCoupons(settl, matur, freq)[1];\n        }\n\n        function COUPNUM(settl, matur, freq/*, basis*/) { // COUPNUM(settlement, maturity, frequency, [basis])\n            var sett = unpackDate(settl),\n                mat = unpackDate(matur);\n            var months = 12*(mat.year - sett.year) + mat.month - sett.month;\n            //// Discount the last month if there are not enough days? Finally - we decide to not discount.\n            //// (if this \"last month\" have 2 days, Excel.COUPNUM returns 6 but GoogleSpreads give only 5)\n            //    var res = _edate(matur, -months);\n            //    if (sett.date >= unpackDate(res).date) {\n            //        months--; // an incomplete last month correspond to a qvasi-coupon period\n            //    }\n            return 1 + (months * freq / 12 | 0);\n        }\n\n        function daysInYear(yr, basis) {\n            if (basis == 3) { return 365; }\n            if (basis == 1) { return isLeapYear(yr) ? 366 : 365; }\n            return 360;\n        }\n\n        //// ACCRINTM  the accrued interest for a security that pays interest at maturity ////\n        function ACCRINTM(issue, maturity, rate, par, basis) { // ACCRINTM(issue, settlement, rate, par, [basis])\n            var year_days = daysInYear(unpackDate(maturity).year, basis); // 360;\n            return rate*par * _daysBetween(issue, maturity, basis) / year_days;\n        }\n\n        function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n            var accr = 0, cost = par * rate / freq;\n            var brace, prev, next, prev1, next1, nrc;\n\n            var annual = basis % 2 === 0 ? 360 : 365; // only if to >> from, we eventually need to count leap years\n            function _numCoupons(from, to) { // better than COUPNUM(from, to, freq, basis)-1\n                return (to - from)*freq/annual | 0;\n            }\n\n            if (settl <= first) {\n                brace = _borderCoupons(settl, first, freq);\n                prev = brace[0];\n                next = brace[1];\n                if (prev <= issue) {\n                    return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n                }\n                brace = _borderCoupons(issue, prev, freq);\n                prev1 = brace[0];\n                next1 = brace[1];\n                nrc = _numCoupons(next1, settl); // when settl==next, days are counted implicitly by nrc\n                return cost *\n                    (nrc +\n                     _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) +\n                     (settl < next? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n            } else {\n                brace = _borderCoupons_fw(first, settl, freq);\n                prev = brace[0];\n                next = brace[1];\n                nrc = _numCoupons(first, settl); // COUPNUM(first, settl, freq, basis) - 1;\n                if (next == settl) {\n                    accr = cost * nrc;\n                } else {\n                    accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n                }\n                if (!calc) { return accr; } // Only the accrued interest between first and settlement dates.\n                brace = _borderCoupons(issue, first, freq); // Add the accrued interest between issue and first dates.\n                prev = brace[0];\n                next = brace[1];\n                nrc = _numCoupons(issue, first);\n                accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n                return accr; // accrued interest between issue and settlement dates\n            }\n        }\n\n        //// DISC  the discount rate for a security (given price and redemption values per 100$ face value) ////\n        function DISC(settl, matur, pr, redemption, basis) { // DISC(settlement, maturity, pr, redemption, [basis])\n            var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate(settl).year) ? 366 : 365);\n            return (redemption - pr)/redemption*annual/_daysBetween(settl, matur, basis);\n        }\n\n        //// INTRATE  the interest rate for a fully invested security ////\n        function INTRATE(settl, matur, investment, redemption, basis) { // INTRATE(settlement, maturity, investment, redemption, [basis])\n            var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate(settl).year) ? 366 : 365);\n            return (redemption - investment)/investment*annual/_daysBetween(settl, matur, basis);\n        }\n\n        //// RECEIVED  the amount received at maturity for a fully invested security ////\n        function RECEIVED(settl, matur, investment, discount, basis) { // RECEIVED(settlement, maturity, investment, discount, [basis])\n            var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate(settl).year) ? 366 : 365);\n            return investment/(1 - discount*_daysBetween(settl, matur, basis)/annual);\n        }\n\n        //// PRICE  the price per $100 face value of a security that pays periodic interest ////\n        function PRICE(settl, matur, rate, yld, redemption, freq, basis) { // PRICE(settlement, maturity, rate, yld, redemption, frequency, [basis])\n            var N = 1 + ((matur - settl)*freq/(basis % 2 === 0 ? 360 : 365) | 0); // coupons playable between settlement and maturity dates\n            var brace = _borderCoupons(settl, matur, freq),\n                prev = brace[0], next = brace[1];\n            var beg_settl = _daysBetween(prev, settl, basis),\n                settl_end = _daysBetween(settl, next, basis),\n                beg_end = _daysBetween(prev, next, basis);\n            var den = 100*rate/freq,\n                yf = yld/freq,\n                frac = settl_end / beg_end;\n            if (N == 1) {\n                return (redemption + den)/(1 + frac*yf) - beg_settl / beg_end * den;\n            }\n            return redemption / Math.pow(1 + yf, N-1+frac)\n                + den * Math.pow(1 + yf, 1-N-frac) * (Math.pow(1+yf, N) - 1) / yf\n                - beg_settl / beg_end * den;\n        }\n\n        //// PRICEDISC  the price per $100 face value of a discounted security ////\n        function PRICEDISC(settl, matur, discount, redemption, basis) { // PRICEDISC(settlement, maturity, discount, redemption, [basis])\n            var dsm = _daysBetween(settl, matur, basis),\n                dy = daysInYear(unpackDate(matur).year, basis);\n            return redemption - discount*redemption*dsm/dy;\n        }\n\n        // Used in PEARSON, more could follow.  In some situations Excel appears to silently ignore\n        // missing or non-numeric values, for example if some value in a is missing a corresponding\n        // value in b, then the one in a is going to be ignored as if not present.  Arrays must have the\n        // same number of elements.  I couldn't come up with a good name for this function.\n        function whipNumberArrays(a, b) {\n            for (var i = a.length; --i >= 0;) {\n                if (typeof a[i] != \"number\" || typeof b[i] != \"number\") {\n                    a.splice(i, 1);\n                    b.splice(i, 1);\n                }\n            }\n        }\n\n    (function(kendo) {\n\n            var $ = kendo.jQuery;\n            var BORDER_TYPES = [\n                \"allBorders\",\n                \"insideBorders\",\n                \"insideHorizontalBorders\",\n                \"insideVerticalBorders\",\n                \"outsideBorders\",\n                \"leftBorder\",\n                \"topBorder\",\n                \"rightBorder\",\n                \"bottomBorder\",\n                \"noBorders\"\n            ];\n            var BORDER_TYPES_ICONS = {\n               allBorders: \"bordersAll\",\n               insideBorders: \"bordersInside\",\n               insideHorizontalBorders: \"bordersInsideHorizontal\",\n               insideVerticalBorders: \"bordersInsideVertical\",\n               outsideBorders: \"bordersOutside\",\n               leftBorder: \"borderLeft\",\n               topBorder: \"borderTop\",\n               rightBorder: \"borderRight\",\n               bottomBorder: \"borderBottom\",\n               noBorders: \"bordersNone\"\n            };\n\n            var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n                allBorders: \"All borders\",\n                insideBorders: \"Inside borders\",\n                insideHorizontalBorders: \"Inside horizontal borders\",\n                insideVerticalBorders: \"Inside vertical borders\",\n                outsideBorders: \"Outside borders\",\n                leftBorder: \"Left border\",\n                topBorder: \"Top border\",\n                rightBorder: \"Right border\",\n                bottomBorder: \"Bottom border\",\n                noBorders: \"No border\"\n            };\n\n            var colorPickerPalette = [ //metro palette\n                \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n                \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n                \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n                \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n                \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n                \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n            ];\n\n            var BorderPalette = kendo.ui.Widget.extend({\n                init: function(element, options) {\n                    kendo.ui.Widget.call(this, element, options);\n\n                    this.element = element;\n                    this.color = \"#000\";\n\n                    this.element.addClass(\"k-spreadsheet-popup\");\n\n                    this._borderTypePalette();\n                    this._borderColorPalette();\n                },\n\n                options: {\n                    name: \"BorderPalette\"\n                },\n\n                events: [\n                    \"change\"\n                ],\n\n                destroy: function() {\n                    this.colorChooser.destroy();\n                    kendo.destroy(this.element.find(\".k-spreadsheet-border-type-palette\"));\n                },\n\n                value: function() {\n                    return { type: this.type, color: this.color };\n                },\n\n                _borderTypePalette: function() {\n                    var that = this;\n                    var messages = BORDER_PALETTE_MESSAGES;\n\n                    var element = $(\"<div />\", {\n                        \"class\": \"k-spreadsheet-border-type-palette\"\n                    });\n\n                    $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border type</span></span>').appendTo(this.element);\n\n                    element.appendTo(this.element);\n\n                    BORDER_TYPES.map(function(type) {\n                        $('<button title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" data-border-type=\"' + type + '\">')\n                            .appendTo(element)\n                            .kendoToggleButton({\n                                icon: kendo.toHyphens(BORDER_TYPES_ICONS[type]),\n                                toggle: that._toggle.bind(that)\n                            });\n                    });\n                },\n\n                _borderColorPalette: function() {\n                    var element = $(\"<div />\", {\n                        \"class\": \"k-spreadsheet-border-color-palette\"\n                    });\n\n                    $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border color</span></span>').appendTo(this.element);\n                    element.appendTo(this.element);\n\n                    this.colorChooser = new kendo.ui.FlatColorPicker(element, {\n                        buttons: !this.options.change,\n                        color: this.color,\n                        view: \"palette\",\n                        palette: colorPickerPalette,\n                        input: false,\n                        change: this._change.bind(this)\n                    });\n\n                    this.colorChooser.wrapper.find(\".k-coloreditor-apply\").on(\"click\", this._apply.bind(this));\n                    this.colorChooser.wrapper.find(\".k-coloreditor-cancel\").on(\"click\", this._cancel.bind(this));\n                },\n\n                _change: function() {\n                    this.color = this.colorChooser.value();\n                },\n\n                _toggle: function(e) {\n                    var type = e.target.data(\"borderType\"),\n                        previous = e.target.siblings(\".k-selected\").data(\"kendoToggleButton\");\n\n                    if (e.checked === true) {\n                        if (previous) {\n                            previous.toggle(false);\n                        }\n\n                        this.type = type;\n                    } else {\n                        this.type = null;\n                    }\n                },\n\n                _apply: function() {\n                    this.trigger(\"change\", { type: this.type, color: this.color });\n                },\n\n                _cancel: function() {\n                    this.trigger(\"change\", { type: null, color: null });\n                }\n            });\n\n            kendo.spreadsheet.BorderPalette = BorderPalette;\n\n        })(window.kendo);\n\n    (function(kendo) {\n        var $ = kendo.jQuery;\n\n        function getDefaultToolElement(firstIconName) {\n            return `<button role=\"button\">${kendo.ui.icon({ icon: firstIconName, iconClass: \"k-button-icon\" })}<span class=\"k-button-text\">${kendo.ui.icon(\"caret-alt-down\")}</span></button>`\n        };\n\n        var ToolBar = kendo.ui.ToolBar;\n\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: \"Add column left\",\n            addColumnRight: \"Add column right\",\n            addRowAbove: \"Add row above\",\n            addRowBelow: \"Add row below\",\n            alignment: \"Alignment\",\n            alignmentButtons: {\n                justifyLeft: \"Align left\",\n                justifyCenter: \"Center\",\n                justifyRight: \"Align right\",\n                justifyFull: \"Justify\",\n                alignTop: \"Align top\",\n                alignMiddle: \"Align middle\",\n                alignBottom: \"Align bottom\"\n            },\n            backgroundColor: \"Background\",\n            bold: \"Bold\",\n            borders: \"Borders\",\n            copy: \"Copy\",\n            cut: \"Cut\",\n            deleteColumn: \"Delete column\",\n            deleteRow: \"Delete row\",\n            filter: \"Filter\",\n            fontFamily: \"Font\",\n            fontSize: \"Font size\",\n            format: \"Custom format...\",\n            formatTypes: {\n                automatic: \"Automatic\",\n                text: \"Text\",\n                number: \"Number\",\n                percent: \"Percent\",\n                financial: \"Financial\",\n                currency: \"Currency\",\n                date: \"Date\",\n                time: \"Time\",\n                dateTime: \"Date time\",\n                duration: \"Duration\",\n                moreFormats: \"More formats...\"\n            },\n            formatDecreaseDecimal: \"Decrease decimal\",\n            formatIncreaseDecimal: \"Increase decimal\",\n            freeze: \"Freeze panes\",\n            freezeButtons: {\n                freezePanes: \"Freeze panes\",\n                freezeRows: \"Freeze rows\",\n                freezeColumns: \"Freeze columns\",\n                unfreeze: \"Unfreeze panes\"\n            },\n            insertComment: \"Insert comment\",\n            insertImage: \"Insert image\",\n            italic: \"Italic\",\n            merge: \"Merge cells\",\n            mergeButtons: {\n                mergeCells: \"Merge all\",\n                mergeHorizontally: \"Merge horizontally\",\n                mergeVertically: \"Merge vertically\",\n                unmerge: \"Unmerge\"\n            },\n            open: \"Open...\",\n            paste: \"Paste\",\n            quickAccess: {\n                redo: \"Redo\",\n                undo: \"Undo\"\n            },\n            exportAs: \"Export...\",\n            toggleGridlines: \"Toggle gridlines\",\n            sort: \"Sort\",\n            sortButtons: {\n                // sortSheetAsc: \"Sort sheet A to Z\",\n                // sortSheetDesc: \"Sort sheet Z to A\",\n                sortRangeAsc: \"Sort range A to Z\",\n                sortRangeDesc: \"Sort range Z to A\"\n            },\n            textColor: \"Text Color\",\n            textWrap: \"Wrap text\",\n            underline: \"Underline\",\n            validation: \"Data validation...\",\n            hyperlink: \"Link\"\n        };\n\n        var defaultTools = {\n            home: [\n                \"open\",\n                \"exportAs\",\n                \"separator\",\n                [ \"cut\", \"copy\", \"paste\" ],\n                \"separator\",\n                \"fontFamily\",\n                \"fontSize\",\n                [ \"bold\", \"italic\", \"underline\" ],\n                \"separator\",\n                \"textColor\",\n                \"separator\",\n                \"backgroundColor\",\n                \"borders\",\n                \"separator\",\n                \"alignment\",\n                \"textWrap\",\n                \"separator\",\n                [ \"formatDecreaseDecimal\", \"formatIncreaseDecimal\" ],\n                \"separator\",\n                \"filter\",\n                \"format\",\n                \"hyperlink\",\n                \"separator\",\n                \"insertImage\",\n                \"insertComment\",\n                \"separator\",\n                \"freeze\",\n                \"merge\",\n                \"toggleGridlines\"\n            ],\n            insert: [\n                [ \"addColumnLeft\", \"addColumnRight\", \"addRowBelow\", \"addRowAbove\" ],\n                \"separator\",\n                [ \"deleteColumn\", \"deleteRow\" ]\n            ],\n            data: [\n                \"sort\",\n                \"separator\",\n                \"filter\",\n                \"separator\",\n                \"validation\"\n            ]\n        };\n\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            text: \"@\",\n            number: \"#,0.00\",\n            percent: \"0.00%\",\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: \"$#,##0.00;[Red]$#,##0.00\",\n            date: \"m/d/yyyy\",\n            time: \"h:mm:ss AM/PM\",\n            dateTime: \"m/d/yyyy h:mm\",\n            duration: \"[h]:mm:ss\"\n        };\n\n        var colorPickerPalette = [ //metro palette\n            \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n            \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n            \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n            \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n            \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n            \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n        ];\n\n        var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n            reset: \"Reset color\",\n            customColor: \"Custom color...\",\n            apply: \"Apply\",\n            cancel: \"Cancel\"\n        };\n\n        var toolDefaults = {\n            separator: { type: \"separator\" },\n            //home tab\n            open: {\n                type: \"open\",\n                name: \"open\",\n                icon: \"folder-open\",\n                extensions: \".xlsx\",\n                command: \"OpenCommand\"\n            },\n            exportAs: {\n                type: \"button\",\n                name: \"exportAs\",\n                dialog: \"exportAs\",\n                overflow: \"never\",\n                icon: \"download\"\n            },\n            bold: {\n                type: \"button\",\n                command: \"PropertyChangeCommand\",\n                property: \"bold\",\n                value: true,\n                icon: \"bold\",\n                togglable: true\n            },\n            italic: {\n                type: \"button\",\n                command: \"PropertyChangeCommand\",\n                property: \"italic\",\n                value: true,\n                icon: \"italic\",\n                togglable: true\n            },\n            underline: {\n                type: \"button\",\n                command: \"PropertyChangeCommand\",\n                property: \"underline\",\n                value: true,\n                icon: \"underline\",\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: \"button\",\n                name: \"formatDecreaseDecimal\",\n                command: \"AdjustDecimalsCommand\",\n                value: -1,\n                icon: \"decimal-decrease\"\n            },\n            formatIncreaseDecimal: {\n                type: \"button\",\n                name: \"formatIncreaseDecimal\",\n                command: \"AdjustDecimalsCommand\",\n                value: +1,\n                icon: \"decimal-increase\"\n            },\n            textWrap: {\n                type: \"button\",\n                name: \"textWrap\",\n                command: \"TextWrapCommand\",\n                property: \"wrap\",\n                value: true,\n                icon: \"text-wrap\",\n                togglable: true\n            },\n            cut: {\n                type: \"button\",\n                name: \"cut\",\n                command: \"ToolbarCutCommand\",\n                icon: \"cut\"\n            },\n            copy: {\n                type: \"button\",\n                name: \"copy\",\n                command: \"ToolbarCopyCommand\",\n                icon: \"copy\"\n            },\n            paste: {\n                type: \"button\",\n                name: \"paste\",\n                command: \"ToolbarPasteCommand\",\n                icon: \"clipboard\"\n            },\n            alignment: {\n                type: \"component\",\n                name: \"alignment\",\n                property: \"alignment\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"align-left\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"alignment\",\n                    icon: \"align-left\"\n                },\n                componentOptions: {\n                    items: [\n                        { attributes: { \"data-value\": \"left\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-left\", text: MESSAGES.alignmentButtons.justifyLeft },\n                        { attributes: { \"data-value\": \"center\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-center\", text: MESSAGES.alignmentButtons.justifyCenter },\n                        { attributes: { \"data-value\": \"right\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-right\", text: MESSAGES.alignmentButtons.justifyRight },\n                        { attributes: { \"data-value\": \"justify\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-justify\", text: MESSAGES.alignmentButtons.justifyFull },\n                        { attributes: { class: \"k-separator\" } },\n                        { attributes: { \"data-value\": \"top\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-top\", text: MESSAGES.alignmentButtons.alignTop },\n                        { attributes: { \"data-value\": \"center\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-middle\", text: MESSAGES.alignmentButtons.alignMiddle },\n                        { attributes: { \"data-value\": \"bottom\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-bottom\", text: MESSAGES.alignmentButtons.alignBottom }\n                    ],\n                    commandOn: \"click\"\n                }\n            },\n            backgroundColor: {\n                type: \"component\",\n                name: \"backgroundColor\",\n                commandOn: \"change\",\n                command: \"PropertyChangeCommand\",\n                property: \"background\",\n                component: \"ColorPicker\",\n                componentOptions: {\n                    view: \"palette\",\n                    toolIcon: \"droplet\",\n                    palette: colorPickerPalette,\n                    clearButton: true,\n                    messages: COLOR_PICKER_MESSAGES,\n                    input: false,\n                    commandOn: \"change\"\n                },\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"colorPicker\",\n                    icon: \"droplet\"\n                }\n            },\n            textColor: {\n                type: \"component\",\n                name: \"textColor\",\n                commandOn: \"change\",\n                command: \"PropertyChangeCommand\",\n                property: \"color\",\n                component: \"ColorPicker\",\n                componentOptions: {\n                    view: \"palette\",\n                    toolIcon: \"foreground-color\",\n                    palette: colorPickerPalette,\n                    clearButton: true,\n                    messages: COLOR_PICKER_MESSAGES,\n                    input: false,\n                    commandOn: \"change\"\n                },\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"colorPicker\",\n                    icon: \"foreground-color\"\n                }\n            },\n            fontFamily: {\n                type: \"component\",\n                name: \"fontFamily\",\n                command: \"PropertyChangeCommand\",\n                property: \"fontFamily\",\n                component: \"DropDownList\",\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"fontFamily\",\n                    icon: \"font-family\"\n                },\n                componentOptions: {\n                    dataSource: [\"Arial\", \"Courier New\", \"Georgia\", \"Times New Roman\", \"Trebuchet MS\", \"Verdana\"],\n                    value: \"Arial\" ,\n                    commandOn: \"change\"\n                }\n            },\n            fontSize: {\n                type: \"component\",\n                name: \"fontSize\",\n                command: \"PropertyChangeCommand\",\n                property: \"fontSize\",\n                component: \"ComboBox\",\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"fontSize\",\n                    icon: \"font-size\"\n                },\n                componentOptions: {\n                    dataSource: [8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72],\n                    value: 12,\n                    commandOn: \"change\"\n                }\n            },\n            format: {\n                type: \"component\",\n                name: \"format\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"custom-format\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"formatCells\",\n                    icon: \"custom-format\"\n                },\n                componentOptions: {\n                    items: [\n                        { attributes: { \"data-value\": defaultFormats.automatic, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.automatic },\n                        { attributes: { \"data-value\": defaultFormats.text, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.text },\n                        { attributes: { \"data-value\": defaultFormats.number, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.number, sample: \"1,499.99\" },\n                        { attributes: { \"data-value\": defaultFormats.percent, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.percent, sample: \"14.50%\" },\n                        { attributes: { \"data-value\": defaultFormats.financial, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.financial, sample: \"(1,000.12)\" },\n                        { attributes: { \"data-value\": defaultFormats.currency, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.currency, sample: \"$1,499.99\" },\n                        { attributes: { \"data-value\": defaultFormats.date, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.date, sample: \"4/21/2012\" },\n                        { attributes: { \"data-value\": defaultFormats.time, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.time, sample: \"5:49:00 PM\" },\n                        { attributes: { \"data-value\": defaultFormats.dateTime, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.dateTime, sample: \"4/21/2012 5:49:00\" },\n                        { attributes: { \"data-value\": defaultFormats.duration, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.duration, sample: \"168:05:00\" },\n                        { attributes: { \"data-value\": \"popup\", \"data-popup\": \"formatCells\" }, text: MESSAGES.formatTypes.moreFormats },\n                    ],\n                    itemTemplate:\n                        '<span class=\"k-link k-menu-link\"><span class=\"k-menu-link-text\">' +\n                            \"# if (data.sample) { #\" +\n                                \"<span class='k-spreadsheet-sample'>#: data.sample #</span>\" +\n                            \"# } #\" +\n                            \"#: data.text #\" +\n                        '</span></span>',\n                    commandOn: \"click\"\n                }\n            },\n            filter: {\n                type: \"button\",\n                name: \"filter\",\n                property: \"hasFilter\",\n                icon: \"filter\",\n                command: \"FilterCommand\",\n                togglable: true,\n                enable: false\n            },\n            merge: {\n                type: \"component\",\n                name: \"merge\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"cells-merge\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"merge\",\n                    icon: \"cells-merge\"\n                },\n                componentOptions: {\n                    items: [\n                        { attributes: { \"data-value\": \"cells\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge\", text: MESSAGES.mergeButtons.mergeCells },\n                        { attributes: { \"data-value\": \"horizontally\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-horizontally\", text: MESSAGES.mergeButtons.mergeHorizontally },\n                        { attributes: { \"data-value\": \"vertically\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-vertically\", text: MESSAGES.mergeButtons.mergeVertically },\n                        { attributes: { \"data-value\": \"unmerge\", \"data-command\": \"MergeCellCommand\" }, icon: \"table-unmerge\", text: MESSAGES.mergeButtons.unmerge }\n                    ],\n                    commandOn: \"click\"\n                }\n            },\n            freeze: {\n                type: \"component\",\n                name: \"freeze\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"pane-freeze\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"freeze\",\n                    icon: \"pane-freeze\"\n                },\n                componentOptions: {\n                    items: [\n                        { attributes: { \"data-value\": \"panes\", \"data-command\": \"FreezePanesCommand\" }, icon: \"pane-freeze\", text: MESSAGES.freezeButtons.freezePanes },\n                        { attributes: { \"data-value\": \"rows\", \"data-command\": \"FreezePanesCommand\" }, icon: \"row-freeze\", text: MESSAGES.freezeButtons.freezeRows },\n                        { attributes: { \"data-value\": \"columns\", \"data-command\": \"FreezePanesCommand\" }, icon: \"column-freeze\", text: MESSAGES.freezeButtons.freezeColumns },\n                        { attributes: { \"data-value\": \"unfreeze\", \"data-command\": \"FreezePanesCommand\" }, icon: \"table-unmerge\", text: MESSAGES.freezeButtons.unfreeze }\n                    ],\n                    commandOn: \"click\"\n                }\n            },\n            borders: {\n                type: \"popupButton\",\n                name: \"borders\",\n                icon: \"borders-all\",\n                popupComponent: kendo.spreadsheet.BorderPalette,\n                commandOn: \"change\",\n                command: \"BorderChangeCommand\",\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"borders\"\n                }\n            },\n            formatCells: {\n                type: \"button\",\n                dialog: \"formatCells\",\n                overflow: \"never\"\n            },\n            hyperlink: {\n                type: \"button\",\n                name: \"hyperlink\",\n                dialog: \"hyperlink\",\n                icon: \"link\"\n            },\n            toggleGridlines: {\n                type: \"button\",\n                name: \"toggleGridlines\",\n                command: \"GridLinesChangeCommand\",\n                property: \"gridLines\",\n                value: true,\n                icon: \"borders-none\",\n                togglable: true,\n                selected: true\n            },\n            insertComment: {\n                type: \"button\",\n                name: \"insertComment\",\n                dialog: \"insertComment\",\n                property: \"comment\",\n                togglable: true,\n                icon: \"comment\"\n            },\n            insertImage: {\n                type: \"button\",\n                name: \"insertImage\",\n                dialog: \"insertImage\",\n                icon: \"image\",\n            },\n\n            //insert tab\n            addColumnLeft: {\n                type: \"button\",\n                name: \"addColumnLeft\",\n                command: \"AddColumnCommand\",\n                value: \"left\",\n                icon: \"table-column-insert-left\"\n            },\n            addColumnRight: {\n                type: \"button\",\n                name: \"addColumnRight\",\n                command: \"AddColumnCommand\",\n                value: \"right\",\n                icon: \"table-column-insert-right\"\n            },\n            addRowBelow: {\n                type: \"button\",\n                name: \"addRowBelow\",\n                command: \"AddRowCommand\",\n                value: \"below\",\n                icon: \"table-row-insert-below\"\n            },\n            addRowAbove: {\n                type: \"button\",\n                name: \"addRowAbove\",\n                command: \"AddRowCommand\",\n                value: \"above\",\n                icon: \"table-row-insert-above\"\n            },\n            deleteColumn: {\n                type: \"button\",\n                name: \"deleteColumn\",\n                command: \"DeleteColumnCommand\",\n                icon: \"table-column-delete\"\n            },\n            deleteRow: {\n                type: \"button\",\n                name: \"deleteRow\",\n                command: \"DeleteRowCommand\",\n                icon: \"table-row-delete\"\n            },\n\n            //data tab\n            sort: {\n                type: \"component\",\n                name: \"sort\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"sort-desc\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"sort\",\n                    icon: \"sort-desc\"\n                },\n                componentOptions: {\n                    items: [\n                        { attributes: { \"data-value\": \"asc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeAsc, icon: \"sort-asc\" },\n                        { attributes: { \"data-value\": \"desc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeDesc, icon: \"sort-desc\" },\n                    ],\n                    commandOn: \"click\"\n                }\n            },\n            validation: {\n                type: \"button\",\n                name: \"validation\",\n                dialog: \"validation\",\n                icon: \"exclamation-circle\"\n            }\n        };\n\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function(element, options) {\n                Object.keys(toolDefaults).forEach((t) => {\n                    if (t !== \"validation\") {\n                        toolDefaults[t].showText = \"overflow\";\n                    }\n                });\n\n                options.tools = options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName];\n                options.parentMessages = MESSAGES;\n                options.defaultTools = toolDefaults;\n\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n\n                this.element.addClass(\"k-spreadsheet-toolbar k-toolbar-md\");\n\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick,\n                    change: handleClick\n                });\n            },\n            _click: function(e) {\n                var target = e.target,\n                    property = target.data(\"property\"),\n                    value = e.value || target.data(\"value\") || e.target.val(),\n                    commandType = target.data(\"command\"),\n                    dialog = target.data(\"dialog\"),\n                    options = target.data(\"options\") || {};\n\n                if (value === \"popup\") {\n                    // Special case to open custom format dialog from option of the format DDL\n                    dialog = target.data(\"popup\");\n                }\n\n                options.property = property || null;\n                options.value = value || null;\n\n                if (dialog) {\n                    this.dialog({\n                        name: dialog,\n                        options: options\n                    });\n                    return;\n                }\n\n                if (!commandType) {\n                    return;\n                }\n\n                var args = {\n                    command: commandType,\n                    options: options\n                };\n\n                if (typeof args.options.value === \"boolean\") {\n                    args.options.value = e.checked ? true : null;\n                }\n\n                this.action(args);\n            },\n            events: [\n                \"action\",\n                \"dialog\"\n            ],\n            options: {\n                name: \"SpreadsheetToolBar\",\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function(args) {\n                this.trigger(\"action\", args);\n            },\n            dialog: function(args) {\n                this.trigger(\"dialog\", args);\n            },\n            refresh: function(activeCell) {\n                var range = activeCell,\n                    tools = this._tools();\n\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property,\n                        tool = tools[i].tool,\n                        value = kendo.isFunction(range[property]) ? range[property]() : range;\n\n                    if (property == \"gridLines\") {\n                        // this isn't really a property of the range, it's per-sheet.\n                        value = range.sheet().showGridLines();\n                    }\n\n                    this._updateTool(tool, value, property, range);\n                }\n\n                this.resize(true);\n            },\n            _tools: function() {\n                return this.element.find(\"[data-property]\").toArray().map(function(element) {\n                    element = $(element);\n                    return {\n                        property: element.attr(\"data-property\"),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            _updateTool: function(tool, value, property, range) {\n                var component = tool.component,\n                    toolbarEl = tool.toolbarEl,\n                    widget = kendo.widgetInstance(toolbarEl.find(\"[data-role]\")),\n                    menuItem = tool.menuItem,\n                    toggle = false,\n                    vertical, text, menu, selection, enabled, label;\n\n                if (property === \"hasFilter\") {\n                    selection = range.sheet().selection();\n\n                    if (selection && selection._ref && selection._ref.height) {\n                        enabled = value || selection._ref.height() > 1;\n\n                        this.enable(toolbarEl, enabled);\n                    }\n                } else if (property === \"alignment\") {\n                    vertical = value.verticalAlign();\n                    text = value.textAlign();\n                    menu = component.menu.element;\n\n                    menu.find(\".k-item .k-link\").removeClass(\"k-selected\");\n                    menu.find(\".k-item[data-property=textAlign][data-value=\" + text + \"] .k-link\").addClass(\"k-selected\");\n                    menu.find(\".k-item[data-property=verticalAlign][data-value=\" + vertical + \"] .k-link\").addClass(\"k-selected\");\n                } else if (property === \"background\" || property === \"color\") {\n                    widget.value(value);\n                } else if (property === \"fontFamily\" || property === \"fontSize\") {\n                    label = menuItem.find(\".k-menu-link-text\").text().split(\"(\")[0].trim();\n                    menuItem.find(\".k-menu-link-text\").text(label + \" (\" + value + \") ...\");\n                    widget.value(value);\n                }\n\n                if (component && component.toggle) {\n                    if (typeof value === \"boolean\") {\n                        toggle = !!value;\n                    } else if (typeof value === \"string\") {\n                        if (toolbarEl.data(\"value\")) {\n                            toggle = toolbarEl.data(\"value\") === value;\n                        } else {\n                            // if no value is specified in the tool options,\n                            // assume it should be ON if the range value is not null, and OFF otherwise.\n                            toggle = value != null;\n                        }\n                    }\n\n                    this.toggle(toolbarEl, toggle);\n                }\n            }\n        });\n\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function(element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass(\"k-spreadsheet-tabstrip\");\n                this._quickAccessButtons();\n\n                this.toolbars = {};\n\n                var tabs = options.dataSource;\n\n                this.contentElements.each(function(idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n\n                this.bind(\"activate\", function(e) { //force resize of the tabstrip after TabStrip tab is opened\n                    var toolbar = $(e.contentElement).find(\".k-toolbar\").data(\"kendoSpreadsheetToolBar\");\n\n                    toolbar._tabIndex();\n                    this.wrapper.removeAttr(\"tabindex\");\n                    this.wrapper.find(\".k-tabstrip-content\").removeAttr(\"tabindex\");\n                });\n            },\n\n            events: kendo.ui.TabStrip.fn.events.concat([ \"action\", \"dialog\" ]),\n\n            destroy: function() {\n                this.quickAccessToolBar.off(\"click\");\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n\n            action: function(args) {\n                this.trigger(\"action\", args);\n            },\n\n            dialog: function(args) {\n                this.trigger(\"dialog\", args);\n            },\n\n            refreshTools: function(range, reason) {\n                var toolbars = this.toolbars;\n\n                if (!reason.overElement && !reason.comment) {\n                    for (var name in toolbars) {\n                        if (toolbars.hasOwnProperty(name)) {\n                            toolbars[name].refresh(range);\n                        }\n                    }\n                }\n            },\n\n            _quickAccessButtons: function() {\n                var buttons = [\n                    { title: MESSAGES.quickAccess.undo, icon: \"undo\", action: \"undo\" },\n                    { title: MESSAGES.quickAccess.redo, icon: \"redo\", action: \"redo\" }\n                ];\n                var buttonTemplate = kendo.template(\"<a role='button' href='\\\\#' title='#= title #' data-action='#= action #' class='k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button' aria-label='#= title #'>#=kendo.ui.icon(icon)#</a>\");\n\n                this.quickAccessToolBar = $(\"<div />\", {\n                    \"class\": \"k-spreadsheet-quick-access-toolbar\",\n                    \"html\": kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n\n                this.quickAccessToolBar.on(\"click\", \".k-button\", function(e) {\n                    e.preventDefault();\n\n                    var action = $(e.currentTarget).attr(\"data-action\");\n                    this.action({ action: action });\n                }.bind(this));\n\n                this.quickAccessAdjust();\n            },\n\n            quickAccessAdjust: function() {\n                this.tabGroup.css(\"padding-left\", kendo._outerWidth(this.quickAccessToolBar));\n            },\n\n            _toolbar: function(container, name, tools) {\n                var element;\n                var options;\n\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children(\".k-toolbar\").remove();\n                }\n\n                if (tools) {\n                    element = container.html(\"<div></div>\").children(\"div\");\n\n                    element.attr(\"aria-label\", name);\n\n                    options = {\n                        tools: typeof tools === \"boolean\" ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n\n        });\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n\n\n\n\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: \"Apply\",\n            save: \"Save\",\n            cancel: \"Cancel\",\n            remove: \"Remove\",\n            retry: \"Retry\",\n            revert: \"Revert\",\n            okText: \"OK\",\n            formatCellsDialog: {\n                title: \"Format\",\n                categories: {\n                    number: \"Number\",\n                    currency: \"Currency\",\n                    date: \"Date\"\n                }\n            },\n            fontFamilyDialog: {\n                title: \"Font\"\n            },\n            fontSizeDialog: {\n                title: \"Font size\"\n            },\n            bordersDialog: {\n                title: \"Borders\"\n            },\n            alignmentDialog: {\n                title: \"Alignment\",\n                buttons: {\n                    justifyLeft: \"Align left\",\n                    justifyCenter: \"Center\",\n                    justifyRight: \"Align right\",\n                    justifyFull: \"Justify\",\n                    alignTop: \"Align top\",\n                    alignMiddle: \"Align middle\",\n                    alignBottom: \"Align bottom\"\n                }\n            },\n            mergeDialog: {\n                title: \"Merge cells\",\n                buttons: {\n                    mergeCells: \"Merge all\",\n                    mergeHorizontally: \"Merge horizontally\",\n                    mergeVertically: \"Merge vertically\",\n                    unmerge: \"Unmerge\"\n                }\n            },\n            freezeDialog: {\n                title: \"Freeze panes\",\n                buttons: {\n                    freezePanes: \"Freeze panes\",\n                    freezeRows: \"Freeze rows\",\n                    freezeColumns: \"Freeze columns\",\n                    unfreeze: \"Unfreeze panes\"\n                }\n            },\n            confirmationDialog: {\n                text: \"Are you sure you want to remove this sheet?\",\n                title: \"Sheet remove\"\n            },\n            validationDialog: {\n                title: \"Data Validation\",\n                hintMessage: \"Please enter a valid {0} value {1}.\",\n                hintTitle: \"Validation {0}\",\n                criteria: {\n                    any: \"Any value\",\n                    number: \"Number\",\n                    text: \"Text\",\n                    date: \"Date\",\n                    custom: \"Custom Formula\",\n                    list: \"List\"\n                },\n                comparers: {\n                    greaterThan: \"greater than\",\n                    lessThan: \"less than\",\n                    between: \"between\",\n                    notBetween: \"not between\",\n                    equalTo: \"equal to\",\n                    notEqualTo: \"not equal to\",\n                    greaterThanOrEqualTo: \"greater than or equal to\",\n                    lessThanOrEqualTo: \"less than or equal to\"\n                },\n                comparerMessages: {\n                    greaterThan: \"greater than {0}\",\n                    lessThan: \"less than {0}\",\n                    between: \"between {0} and {1}\",\n                    notBetween: \"not between {0} and {1}\",\n                    equalTo: \"equal to {0}\",\n                    notEqualTo: \"not equal to {0}\",\n                    greaterThanOrEqualTo: \"greater than or equal to {0}\",\n                    lessThanOrEqualTo: \"less than or equal to {0}\",\n                    custom: \"that satisfies the formula: {0}\"\n                },\n                labels: {\n                    criteria: \"Criteria\",\n                    comparer: \"Comparer\",\n                    min: \"Min\",\n                    max: \"Max\",\n                    value: \"Value\",\n                    start: \"Start\",\n                    end: \"End\",\n                    onInvalidData: \"On invalid data\",\n                    rejectInput: \"Reject input\",\n                    showWarning: \"Show warning\",\n                    showHint: \"Show hint\",\n                    hintTitle: \"Hint title\",\n                    hintMessage: \"Hint message\",\n                    ignoreBlank: \"Ignore blank\",\n                    showListButton: \"Display button to show list\",\n                    showCalendarButton: \"Display button to show calendar\"\n                },\n                placeholders: {\n                    typeTitle: \"Type title\",\n                    typeMessage: \"Type message\"\n                }\n            },\n            exportAsDialog: {\n                title: \"Export...\",\n                defaultFileName: \"Workbook\",\n                xlsx: {\n                    description: \"Excel Workbook (.xlsx)\"\n                },\n                pdf: {\n                    description: \"Portable Document Format (.pdf)\",\n                    area: {\n                        workbook: \"Entire Workbook\",\n                        sheet: \"Active Sheet\",\n                        selection: \"Selection\"\n                    },\n                    paper: {\n                        a2        : \"A2 (420 mm  594 mm)\",\n                        a3        : \"A3 (297 mm x 420 mm)\",\n                        a4        : \"A4 (210 mm x 297 mm)\",\n                        a5        : \"A5 (148 mm x 210 mm)\",\n                        b3        : \"B3 (353 mm  500 mm)\",\n                        b4        : \"B4 (250 mm x 353 mm)\",\n                        b5        : \"B5 (176 mm x 250 mm)\",\n                        folio     : 'Folio (8.5\" x 13\")',\n                        legal     : 'Legal (8.5\" x 14\")',\n                        letter    : 'Letter (8.5\" x 11\")',\n                        tabloid   : 'Tabloid (11\" x 17\")',\n                        executive : 'Executive (7.25\" x 10.5\")'\n                    },\n                    margin: {\n                        normal: \"Normal\",\n                        narrow: \"Narrow\",\n                        wide: \"Wide\"\n                    }\n                },\n                labels: {\n                    scale: \"Scale\",\n                    fit: \"Fit to page\",\n                    fileName: \"File name\",\n                    saveAsType: \"Save as type\",\n                    exportArea: \"Export\",\n                    paperSize: \"Paper size\",\n                    margins: \"Margins\",\n                    orientation: \"Orientation\",\n                    print: \"Print\",\n                    guidelines: \"Guidelines\",\n                    center: \"Center\",\n                    horizontally: \"Horizontally\",\n                    vertically: \"Vertically\"\n                }\n            },\n            modifyMergedDialog: {\n                errorMessage: \"Cannot change part of a merged cell.\"\n            },\n            rangeDisabledDialog: {\n                errorMessage: \"Destination range contains disabled cells.\"\n            },\n            intersectsArrayDialog: {\n                errorMessage: \"You cannot alter part of an array\"\n            },\n            incompatibleRangesDialog: {\n                errorMessage: \"Incompatible ranges\"\n            },\n            noFillDirectionDialog: {\n                errorMessage: \"Cannot determine fill direction\"\n            },\n            duplicateSheetNameDialog: {\n                errorMessage: \"Duplicate sheet name\"\n            },\n            overflowDialog: {\n                errorMessage: \"Cannot paste, because the copy area and the paste area are not the same size and shape.\"\n            },\n            useKeyboardDialog: {\n                title: \"Copying and pasting\",\n                errorMessage: \"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:\",\n                labels: {\n                    forCopy: \"for copy\",\n                    forCut: \"for cut\",\n                    forPaste: \"for paste\"\n                }\n            },\n            unsupportedSelectionDialog: {\n                errorMessage: \"That action cannot be performed on multiple selection.\"\n            },\n            linkDialog: {\n                title: \"Hyperlink\",\n                labels: {\n                    text: \"Text\",\n                    url: \"Address\",\n                    removeLink: \"Remove link\"\n                }\n            },\n            insertCommentDialog: {\n                title: \"Insert comment\",\n                labels: {\n                    comment: \"Comment\",\n                    removeComment: \"Remove comment\"\n                }\n            },\n            insertImageDialog: {\n                title: \"Insert image\",\n                info: \"Drag an image here, or click to select\",\n                typeError: \"Please select a JPEG, PNG or GIF image\"\n            }\n        };\n\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function(name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function(name) {\n                return !!registry[name];\n            },\n            create: function(name, options) {\n                var dialogClass = registry[name];\n\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function(options) {\n                kendo.Observable.fn.init.call(this, options);\n\n                this.options = translate($.extend(true, {}, this.options, options));\n\n                this.bind(this.events, options);\n            },\n            events: [\n                \"close\",\n                \"activate\"\n            ],\n            options: {\n                autoFocus: true\n            },\n            dialog: function() {\n                if (!this._dialog) {\n                    var options = {\n                        autoFocus: false,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function() {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    };\n                    this._dialog = $(\"<div class='k-spreadsheet-window k-action-window k-popup-edit-form' />\")\n                        .addClass(this.options.className || \"\")\n                        .append(kendo.template(this.options.template)({\n                            messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                            ns: kendo.ns,\n\n                            // this is for ImportErrorDialog.  ugly that\n                            // we need this line here, but I couldn't\n                            // figure out a better way\n                            errors: this.options.errors\n                        }))\n                        .kendoWindow(options)\n                        .data(\"kendoWindow\");\n                }\n\n                return this._dialog;\n            },\n            _onDialogClose: function() {\n                this.trigger(\"close\", {\n                    action: this._action\n                });\n            },\n            _onDialogActivate: function() {\n                this.trigger(\"activate\");\n            },\n            _onDialogDeactivate: function() {\n                this.trigger(\"deactivate\");\n                this.destroy();\n            },\n            destroy: function() {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function() {\n                this.dialog().open();\n                this.dialog().element.find(\".k-button-solid-primary\").trigger(\"focus\");\n            },\n            apply: function() {\n                this.close();\n            },\n            close: function() {\n                this._action = \"close\";\n\n                this.dialog().close();\n            }\n        });\n\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function(options) {\n                ObservableObject.fn.init.call(this, options);\n\n                this.useCategory(this.category);\n            },\n            useCategory: function(category) {\n                var type = category && category.type || \"number\";\n                var formatCurrency = type == \"currency\";\n\n                this.category = category;\n\n                this.set(\"showCurrencyFilter\", formatCurrency && this.currencies.length > 1);\n\n                if (!formatCurrency) {\n                    this.set(\"formats\", this.allFormats[type + \"Formats\"]);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n\n                this.useFirstFormat();\n            },\n            useFirstFormat: function() {\n                if (this.formats.length) {\n                    this.set(\"format\", this.formats[0].value);\n                }\n            },\n            currency: function(currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n\n                    var info = currency.value;\n                    var formats = [\n                        { currency: info, decimals: true },\n                        { currency: info, decimals: true, iso: true },\n                        { currency: info, decimals: false }\n                    ];\n\n                    formats = formats.map(function(format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n\n                        return { value: format, name: formattedValue(1000, format) };\n                    });\n\n                    this.set(\"formats\", formats);\n\n                    this.useFirstFormat();\n                }\n\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function(category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n\n                return this.category;\n            },\n            preview: function() {\n                var format = this.get(\"format\");\n                var value = this.value || 0;\n\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n\n        FormatCellsViewModel.convert = {\n            currency: function(options) {\n                function repeat(token, n) {\n                    return new Array(n+1).join(token);\n                }\n\n                // convert culture info to spreadsheet format\n                var info = options.currency;\n                var format = info.pattern[1];\n\n                if (options.decimals) {\n                    format = format.replace(/n/g, \"n\" + info[\".\"] + repeat(\"0\", info.decimals));\n                }\n\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, \"\");\n                } else {\n                    format = format.replace(/\\$/g, JSON.stringify(info.symbol));\n                }\n\n                format = format.replace(/n/g, \"?\");\n\n                return format;\n            },\n            date: function(format) {\n                if ((/T|Z/).test(format)) {\n                    return \"\";\n                }\n\n                return format.toLowerCase().replace(/tt/g, \"AM/PM\").replace(/'/g, '\"');\n            }\n        };\n\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n\n            return result;\n        }\n\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        { type: \"number\", name: messages.categories.number },\n                        { type: \"currency\", name: messages.categories.currency },\n                        { type: \"date\", name: messages.categories.date }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._generateFormats();\n            },\n            options: {\n                className: \"k-spreadsheet-format-cells\",\n                template:\n                    \"<div class='k-edit-form-container'>\" +\n\n                        \"<div class='k-root-tabs' data-#:ns#role='tabstrip' \" +\n                            \"data-#:ns#text-field='name' \" +\n                            \"data-#:ns#bind='source: categories, value: categoryFilter' \" +\n                            \"data-#:ns#animation='false'></div>\" +\n\n                        \"<div class='k-spreadsheet-preview' data-#:ns#bind='text: preview'></div>\" +\n\n                        \"<script type='text/x-kendo-template' id='format-item-template'>\" +\n                            \"\\\\#: data.name \\\\#\" +\n                        \"</script>\" +\n\n                        \"<select data-#:ns#role='dropdownlist' class='k-format-filter' \" +\n                            \"data-#:ns#text-field='description' \" +\n                            \"data-#:ns#value-field='value.name' \" +\n                            \"data-#:ns#bind='visible: showCurrencyFilter, value: currency, source: currencies'></select>\" +\n\n                        \"<ul data-#:ns#role='staticlist' tabindex='0' \" +\n                            \"id='formats-list' \" +\n                            \"aria-label='formats list' \" +\n                            \"class='k-list k-reset' \" +\n                            \"data-#:ns#template='format-item-template' \" +\n                            \"data-#:ns#value-primitive='true' \" +\n                            \"data-#:ns#value-field='value' \" +\n                            \"data-#:ns#bind='source: formats, value: format'></ul>\" +\n\n                        \"<div class='k-actions'>\" +\n                            \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>\" +\n                            \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                        \"</div>\"+\n\n                    \"</div>\"\n            },\n            _generateFormats: function() {\n                var options = this.options;\n\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        { value: \"#.00%\", name: \"100.00%\" },\n                        { value: \"#%\", name: \"100%\" },\n                        { value: \"#.00\", name: \"1024.00\" },\n                        { value: \"#,###.00\", name: \"1,024.00\" }\n                    ];\n                }\n\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n\n                    options.dateFormats = uniqueBy(\"value\", $.map(calendarPatterns, function(format) {\n                        format = FormatCellsViewModel.convert.date(format);\n\n                        if (!format) {\n                            return;\n                        }\n\n                        return { value: format, name: formattedValue(34567.7678, format) };\n                    }));\n                }\n            },\n            open: function(range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n\n                SpreadsheetDialog.fn.open.call(this);\n\n                element = this.dialog().element;\n\n                kendo.bind(element, this.viewModel);\n\n                var currencyFilter = element.find(\"select.k-format-filter\").data(\"kendoDropDownList\");\n\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: \"contains\" });\n                }\n\n                element.find(kendo.roleSelector(\"staticlist\")).parent().addClass(\"k-list-wrapper\");\n\n                element.find(\".k-tabstrip-item\").attr(\"aria-controls\", \"formats-list\");\n            },\n            apply: function() {\n                var format = this.viewModel.format;\n\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: \"format\",\n                        value: format\n                    }\n                });\n            }\n        });\n\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy(\"description\", $.map(cultures, function(culture, name) {\n                if (!(/-/).test(name)) {\n                    return;\n                }\n\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format(\n                    \"{0} ({1}, {2})\",\n                    currency.name,\n                    currency.abbr,\n                    currency.symbol\n                );\n\n                return { description: description, value: currency };\n            }));\n        };\n\n        kendo.spreadsheet.dialogs.register(\"formatCells\", FormatCellsDialog);\n\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: \"k-spreadsheet-message\",\n                title: \"\",\n                messageId: \"\",\n                text: \"\",\n                template:\n                    \"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>\" +\n                    \"<div class='k-actions'>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>\" +\n                            \"<span class='k-button-text'>#= messages.okText #</span>\" +\n                        \"</button>\" +\n                    \"</div>\"\n            },\n            open: function() {\n                SpreadsheetDialog.fn.open.call(this);\n\n                var options = this.options;\n                var text = options.text;\n\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"message\", MessageDialog);\n\n        var ConfirmationDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    text: messages.text\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                className: \"k-spreadsheet-message\",\n                messageId: \"\",\n                template:\n                    \"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>\" +\n                    \"<div class='k-actions'>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: confirm'>\" +\n                            \"<span class='k-button-text'>#= messages.okText #</span>\" +\n                        \"</button>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'>\" +\n                            \"<span class='k-button-text'>#= messages.cancel #</span>\" +\n                        \"</button>\" +\n                    \"</div>\"\n            },\n            open: function() {\n                SpreadsheetDialog.fn.open.call(this);\n\n                var options = this.options;\n                var text = options.text;\n\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    confirm: this.confirm.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            isConfirmed: function() {\n                return this._confirmed;\n            },\n            confirm: function() {\n                this._confirmed = true;\n                this.close();\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"confirmation\", ConfirmationDialog);\n\n        var ValidationErrorDialog = SpreadsheetDialog.extend({\n            options: {\n                className: \"k-spreadsheet-message\",\n                title: \"\",\n                messageId: \"\",\n                text: \"\",\n                template:\n                \"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>\" +\n                \"<div class='k-actions'>\" +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: retry'>\" +\n                        \"<span class='k-button-text'>#= messages.retry #</span>\" +\n                    \"</button>\" +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'>\" +\n                        \"<span class='k-button-text'>#= messages.cancel #</span>\" +\n                    \"</button>\" +\n                \"</div>\"\n            },\n            open: function() {\n                SpreadsheetDialog.fn.open.call(this);\n\n                var options = this.options;\n                var text = options.text;\n\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    retry: this.retry.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            retry: function() {\n                this._retry = true;\n                this.close();\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"validationError\", ValidationErrorDialog);\n\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n                var fonts = this.options.options;\n                var defaultFont = this.options.default;\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: \"#: data #\",\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: \"fontFamily\",\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"fontFamily\", FontFamilyDialog);\n\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n                var sizes = this.options.options;\n                var defaultSize = this.options.default;\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: \"#: data #\",\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: \"fontSize\",\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"fontSize\", FontSizeDialog);\n\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n                this.element = this.dialog().element;\n                this._borderPalette();\n\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n\n                kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n            },\n            options: {\n                template:   \"<div></div>\" +\n                            \"<div class='k-actions'>\" +\n                                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>\" +\n                                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                            \"</div>\"\n            },\n            apply: function() {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                var state = this.borderPalette.value();\n\n                if (state.color && state.type) {\n                    this.trigger(\"action\", {\n                        command: \"BorderChangeCommand\",\n                        options: {\n                            border: state.type,\n                            style: { size: 1, color: state.color }\n                        }\n                    });\n                }\n            },\n            _borderPalette: function() {\n                var element = this.dialog().element.find(\"div\").first();\n\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, {\n                    change: this.value.bind(this)\n                });\n            },\n            value: function(state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"borders\", BordersDialog);\n\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function(options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n\n                kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n            },\n            options: {\n                template:   \"<div></div>\" +\n                            \"<div class='k-actions'>\" +\n                                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>\" +\n                                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                            \"</div>\"\n            },\n            apply: function() {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function(e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function(options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function() {\n                var element = this.dialog().element.find(\"div\").first();\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [ //metro palette\n                        \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n                        \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n                        \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n                        \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n                        \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n                        \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n                    ],\n                    change: this.value.bind(this)\n                }).data(\"kendoColorPalette\");\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"colorPicker\", ColorPickerDialog);\n\n        var CustomColorDialog = ColorChooser.extend({\n            init: function(options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one(\"activate\", this._colorPicker.bind(this));\n            },\n            _colorPicker: function() {\n                var element = this.dialog().element.find(\"div\").first();\n                this.colorPicker = element.kendoFlatColorPicker({\n                    change: this.value.bind(this)\n                }).data(\"kendoFlatColorPicker\");\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"customColor\", CustomColorDialog);\n\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        { property: \"textAlign\",     value: \"left\",    iconClass: \"align-left\",   text: messages.buttons.justifyLeft },\n                        { property: \"textAlign\",     value: \"center\",  iconClass: \"align-center\", text: messages.buttons.justifyCenter },\n                        { property: \"textAlign\",     value: \"right\",   iconClass: \"align-right\",  text: messages.buttons.justifyRight },\n                        { property: \"textAlign\",     value: \"justify\", iconClass: \"align-justify\",   text: messages.buttons.justifyFull },\n                        { property: \"verticalAlign\", value: \"top\",     iconClass: \"align-top\",      text: messages.buttons.alignTop },\n                        { property: \"verticalAlign\", value: \"center\",  iconClass: \"align-middle\",   text: messages.buttons.alignMiddle },\n                        { property: \"verticalAlign\", value: \"bottom\",  iconClass: \"align-bottom\",   text: messages.buttons.alignBottom }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: \"<a role='button' title='#=text#' data-property='#=property#' data-value='#=value#'>\" +\n                                    \"#= kendo.ui.icon(iconClass) #\" +\n                                    \"#=text#\" +\n                               \"</a>\",\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"alignment\", AlignmentDialog);\n\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        { value: \"cells\",        iconClass: \"cells-merge\",        text: messages.buttons.mergeCells },\n                        { value: \"horizontally\", iconClass: \"cells-merge-horizontally\", text: messages.buttons.mergeHorizontally },\n                        { value: \"vertically\",   iconClass: \"cells-merge-vertically\",   text: messages.buttons.mergeVertically },\n                        { value: \"unmerge\",      iconClass: \"table-unmerge\",      text: messages.buttons.unmerge }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: \"<a role='button' title='#=text#' data-value='#=value#'>\" +\n                                \"#= kendo.ui.icon(iconClass) ##=text#\" +\n                              \"</a>\",\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"MergeCellCommand\",\n                    options: {\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"merge\", MergeDialog);\n\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        { value: \"panes\",    iconClass: \"pane-freeze\",  text: messages.buttons.freezePanes },\n                        { value: \"rows\",     iconClass: \"row-freeze\",    text: messages.buttons.freezeRows },\n                        { value: \"columns\",  iconClass: \"column-freeze\",    text: messages.buttons.freezeColumns },\n                        { value: \"unfreeze\", iconClass: \"table-unmerge\", text: messages.buttons.unfreeze }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: \"<a role='button' title='#=text#' data-value='#=value#'>\" +\n                                \"#= kendo.ui.icon(iconClass) ##=text#\" +\n                              \"</a>\",\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"FreezePanesCommand\",\n                    options: {\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"freeze\", FreezeDialog);\n\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function(options) {\n                ObservableObject.fn.init.call(this, options);\n\n                this.bind(\"change\", (function(e) {\n\n                    if (e.field === \"criterion\") {\n                        this.reset();\n\n                        if (this.criterion === \"custom\" || this.criterion === \"list\") {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n\n                    if (e.field === \"comparer\") {\n                        this.setHintMessageTemplate();\n                    }\n\n                    if ((e.field == \"hintMessage\" || e.field == \"hintTitle\") && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n\n                    if ((e.field == \"from\" || e.field == \"to\" || e.field == \"hintMessageTemplate\" || e.field == \"type\") && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }).bind(this));\n\n                this.reset();\n            },\n            buildMessages: function() {\n                this._mute = true;\n                this.set(\"hintTitle\", this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : \"\");\n                this.set(\"hintMessage\", this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : \"\");\n                this._mute = false;\n            },\n            reset: function() {\n                this.setComparers();\n                this.set(\"comparer\", this.comparers[0].type);\n                this.set(\"from\", null);\n                this.set(\"to\", null);\n\n                this.set(\"useCustomMessages\", false);\n\n                this.shouldBuild = true;\n\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            //TODO: refactor\n            setComparers: function() {\n                var all = this.defaultComparers;\n                var comparers = [];\n\n                if (this.criterion === \"text\") {\n                    var text_comparers = [\"equalTo\", \"notEqualTo\"];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n\n                this.set(\"comparers\", comparers);\n            },\n            setHintMessageTemplate: function() {\n               if (this.criterion !== \"custom\" && this.criterion !== \"list\") {\n                   this.set(\"hintMessageTemplate\", kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n               } else {\n                   this.set(\"hintMessageTemplate\", \"\");\n                   this.set(\"hintMessage\", \"\");\n               }\n            },\n            isAny: function() {\n                return this.get(\"criterion\") === \"any\";\n            },\n            isNumber: function() {\n                return this.get(\"criterion\") === \"number\";\n            },\n            showToForNumber: function() {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function() {\n                return this.showTo() && this.isDate();\n            },\n            isText: function() {\n                return this.get(\"criterion\") === \"text\";\n            },\n            isDate: function() {\n                return this.get(\"criterion\") === \"date\";\n            },\n            isList: function() {\n                return this.get(\"criterion\") === \"list\";\n            },\n            isCustom: function() {\n                return this.get(\"criterion\") === \"custom\";\n            },\n            showRemove: function() {\n                return this.get(\"hasValidation\");\n            },\n            showTo: function() {\n                return this.get(\"comparer\") == \"between\" || this.get(\"comparer\") == \"notBetween\";\n            },\n            update: function(validation) {\n                this.set(\"hasValidation\", !!validation);\n\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function(validation) {\n                this.set(\"criterion\", validation.dataType);\n                this.set(\"comparer\", validation.comparerType);\n                this.set(\"from\", validation.from);\n                this.set(\"to\", validation.to);\n                this.set(\"type\", validation.type);\n                this.set(\"ignoreBlank\", validation.allowNulls);\n                this.set(\"showButton\", validation.showButton);\n\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function() {\n                if (this.criterion === \"any\") {\n                    return null;\n                }\n\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank,\n                    showButton: this.showButton\n                };\n\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n\n                return options;\n            }\n        });\n\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        { type: \"any\", name: messages.criteria.any },\n                        { type: \"number\", name: messages.criteria.number },\n                        { type: \"text\", name: messages.criteria.text },\n                        { type: \"date\", name: messages.criteria.date },\n                        { type: \"custom\", name: messages.criteria.custom },\n                        { type: \"list\", name: messages.criteria.list }\n                    ],\n                    comparers: [\n                        { type: \"greaterThan\", name: messages.comparers.greaterThan },\n                        { type: \"lessThan\",    name: messages.comparers.lessThan },\n                        { type: \"between\",     name: messages.comparers.between },\n                        { type: \"notBetween\",  name: messages.comparers.notBetween },\n                        { type: \"equalTo\",     name: messages.comparers.equalTo },\n                        { type: \"notEqualTo\",  name: messages.comparers.notEqualTo },\n                        { type: \"greaterThanOrEqualTo\", name: messages.comparers.greaterThanOrEqualTo },\n                        { type: \"lessThanOrEqualTo\",    name: messages.comparers.lessThanOrEqualTo }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 450,\n                criterion: \"any\",\n                type: \"reject\",\n                ignoreBlank: true,\n                showButton: true,\n                useCustomMessages: false,\n                errorTemplate:\n                    '<div class=\"k-tooltip k-tooltip-error k-validator-tooltip\">' +\n                        kendo.ui.icon({ icon: \"exclamation-circle\", iconClass: \"k-tooltip-icon\" }) +\n                        '<span class=\"k-tooltip-content\">#= message #</span>' +\n                        '<span class=\"k-callout k-callout-n\"></span>' +\n                    '</div>',\n                template:\n                    '<div class=\"k-edit-form-container\">' +\n                        '<div class=\"k-edit-label\"><label for=\"criteria\">#: messages.validationDialog.labels.criteria #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<select id=\"criteria\" data-#:ns#role=\"dropdownlist\" ' +\n                                'title=\"#: messages.validationDialog.labels.criteria #\"' +\n                                'data-#:ns#text-field=\"name\" ' +\n                                'data-#:ns#value-field=\"type\" ' +\n                                'data-#:ns#bind=\"value: criterion, source: criteria\"></select>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isNumber\">' +\n                            '<div class=\"k-edit-label\"><label for=\"number-comparer\">#: messages.validationDialog.labels.comparer #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<select id=\"number-comparer\" data-#:ns#role=\"dropdownlist\" ' +\n                                    'title=\"#: messages.validationDialog.labels.comparer #\"' +\n                                    'data-#:ns#text-field=\"name\" ' +\n                                    'data-#:ns#value-field=\"type\" ' +\n                                    'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' +\n                            '</div>' +\n                            '<div class=\"k-edit-label\"><label for=\"comparer-min\">#: messages.validationDialog.labels.min #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-min\" name=\"#: messages.validationDialog.labels.min #\" title=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isNumber\" required=\"required\" /></span>' +\n                            '</div>' +\n                            '<div data-#:ns#bind=\"visible: showTo\">' +\n                                '<div class=\"k-edit-label\"><label for=\"comparer-max\">#: messages.validationDialog.labels.max #:</label></div>' +\n                                '<div class=\"k-edit-field\">' +\n                                    '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-max\" name=\"#: messages.validationDialog.labels.max #\" title=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-input-inner\" data-#:ns#bind=\"value: to, enabled: showToForNumber\" required=\"required\" /></span>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isText\">' +\n                            '<div class=\"k-edit-label\"><label for=\"text-comparer\">#: messages.validationDialog.labels.comparer #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<select id=\"text-comparer\" data-#:ns#role=\"dropdownlist\" ' +\n                                    'title=\"#: messages.validationDialog.labels.comparer #\"' +\n                                    'data-#:ns#text-field=\"name\" ' +\n                                    'data-#:ns#value-field=\"type\" ' +\n                                    'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' +\n                            '</div>' +\n                            '<div class=\"k-edit-label\"><label for=\"text-comparer-value\">#: messages.validationDialog.labels.value #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"text-comparer-value\" name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isText\" required=\"required\" /></span>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isDate\">' +\n                            '<div class=\"k-edit-label\"><label for=\"date-comparer\">#: messages.validationDialog.labels.comparer #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<select id=\"date-comparer\" data-#:ns#role=\"dropdownlist\" ' +\n                                    'title=\"#: messages.validationDialog.labels.comparer #\"' +\n                                    'data-#:ns#text-field=\"name\" ' +\n                                    'data-#:ns#value-field=\"type\" ' +\n                                    'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' +\n                            '</div>' +\n                            '<div class=\"k-edit-label\"><label for=\"date-comparer-start\">#: messages.validationDialog.labels.start #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-start\" name=\"#: messages.validationDialog.labels.start #\" title=\"#: messages.validationDialog.labels.start #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isDate\" required=\"required\" /></span>' +\n                            '</div>' +\n                            '<div data-#:ns#bind=\"visible: showTo\">' +\n                                '<div class=\"k-edit-label\"><label for=\"date-comparer-end\">#: messages.validationDialog.labels.end #:</label></div>' +\n                                '<div class=\"k-edit-field\">' +\n                                    '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-end\" name=\"#: messages.validationDialog.labels.end #\" title=\"#: messages.validationDialog.labels.end #\" class=\"k-input-inner\" data-#:ns#bind=\"value: to, enabled: showToForDate\" required=\"required\" /></span>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isCustom\">' +\n                            '<div class=\"k-edit-label\"><label for=\"custom-comparer-value\">#: messages.validationDialog.labels.value #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"custom-comparer-value\" name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isCustom\" required=\"required\" /></span>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isList\">' +\n                            '<div class=\"k-edit-label\"><label for=\"list-comparer-value\">#: messages.validationDialog.labels.value #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"list-comparer-value\" name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isList\" required=\"required\" /></span>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isList\">' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: showButton\"/>' +\n                                '<label for=\"listShowButton\" class=\"k-checkbox-label\">' +\n                                    ' #: messages.validationDialog.labels.showListButton #' +\n                                '</label>' +\n                            '</div>' +\n                        \"</div>\" +\n\n                        '<div data-#:ns#bind=\"visible: isDate\">' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: showButton\"/>' +\n                                '<label for=\"dateShowButton\" class=\"k-checkbox-label\">' +\n                                    ' #: messages.validationDialog.labels.showCalendarButton #' +\n                                '</label>' +\n                            '</div>' +\n                        \"</div>\" +\n\n                        '<div data-#:ns#bind=\"invisible: isAny\">' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.ignoreBlank #\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: ignoreBlank\"/>' +\n                                '<label for=\"ignoreBlank\" class=\"k-checkbox-label\">' +\n                                    ' #: messages.validationDialog.labels.ignoreBlank #' +\n                                '</label>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"invisible: isAny\">' +\n                            '<div class=\"k-hr\"></div>' +\n                            '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"radio\" title=\"#: messages.validationDialog.labels.rejectInput #\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-#:ns#bind=\"checked: type\" class=\"k-radio k-radio-md\" />' +\n                                '<label for=\"validationTypeReject\" class=\"k-radio-label\">' +\n                                     \"#: messages.validationDialog.labels.rejectInput #\" +\n                                '</label> ' +\n                                '<input type=\"radio\" title=\"#: messages.validationDialog.labels.showWarning #\" id=\"validationTypeWarning\"  name=\"validationType\" value=\"warning\" data-#:ns#bind=\"checked: type\" class=\"k-radio k-radio-md\" />' +\n                                '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' +\n                                     \"#: messages.validationDialog.labels.showWarning #\" +\n                                '</label>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"invisible: isAny\" class=\"hint-wrapper\">' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.showHint #\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: useCustomMessages\" />' +\n                                '<label class=\"k-checkbox-label\" for=\"useCustomMessages\">'+\n                                    ' #: messages.validationDialog.labels.showHint #' +\n                                '</label>' +\n                            '</div>' +\n                            '<div data-#:ns#bind=\"visible: useCustomMessages\">' +\n                                '<div class=\"k-edit-label\"><label for=\"hint-title\">#: messages.validationDialog.labels.hintTitle #:</label></div>' +\n                                '<div class=\"k-edit-field\">' +\n                                    '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-title\" name=\"hint-title\" class=\"k-input-inner\" title=\"#: messages.validationDialog.labels.hintTitle #\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-#:ns#bind=\"value: hintTitle\" /></span>' +\n                                '</div>' +\n                                '<div class=\"k-edit-label\"><label for=\"hint-message\">#: messages.validationDialog.labels.hintMessage #:</label></div>' +\n                                '<div class=\"k-edit-field\">' +\n                                    '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-message\" class=\"k-input-inner\" title=\"#: messages.validationDialog.labels.hintMessage #\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-#:ns#bind=\"value: hintMessage\" /></span>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div class=\"k-actions\">' +\n                            '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-#:ns#bind=\"visible: showRemove, click: remove\"><span class=\"k-button-text\">#: messages.remove #</span></button>' +\n                            '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\" data-#:ns#bind=\"click: apply\"><span class=\"k-button-text\">#: messages.apply #</span></button>' +\n                            '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-#:ns#bind=\"click: close\"><span class=\"k-button-text\">#: messages.cancel #</span></button>' +\n                        \"</div>\" +\n                    \"</div>\"\n            },\n            open: function(range) {\n                var options = this.options;\n                var element;\n\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    showButton: options.showButton,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n\n                this.viewModel.update(range.validation());\n\n                SpreadsheetDialog.fn.open.call(this);\n\n                element = this.dialog().element;\n\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n\n                kendo.bind(element, this.viewModel);\n\n                this.validatable = new kendo.ui.Validator(element.find(\".k-edit-form-container\"), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function() {\n\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n\n                    this.trigger(\"action\", {\n                        command: \"EditValidationCommand\",\n                        options: {\n                            value: this.viewModel.toValidationObject()\n                        }\n                    });\n                }\n            },\n            remove: function() {\n                this.viewModel.set(\"criterion\", \"any\");\n                this.apply();\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"validation\", ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n\n        function PDF_PAPER_SIZE(size) {\n            return {\n                value: size,\n                text: TEXT(\"exportAsDialog.pdf.paper.\" + size)\n            };\n        }\n\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                options = this.options;\n\n                this.viewModel = kendo.observable({\n                    title: options.title,\n                    name: options.name,\n                    extension: options.extension,\n                    fileFormats:options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        autoPrint: options.pdfExport.autoPrint,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n\n                        fitWidth: options.pdf.fitWidth,\n                        area: options.pdf.area,\n                        areas: options.pdf.areas,\n                        paperSize: options.pdf.paperSize,\n                        paperSizes: options.pdf.paperSizes,\n                        margin: options.pdf.margin,\n                        margins: options.pdf.margins,\n                        landscape: options.pdf.landscape,\n                        guidelines: options.pdf.guidelines,\n                        hCenter: options.pdf.hCenter,\n                        vCenter: options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n\n                var dialog = this.dialog();\n                this.viewModel.bind(\"change\", function(e) {\n                    if (e.field === \"extension\") {\n                        this.set(\"showPdfOptions\", this.extension === \".pdf\" ? true : false);\n                        dialog.center();\n                    }\n                });\n\n                kendo.bind(dialog.element, this.viewModel);\n            },\n            options: {\n                title: TEXT(\"exportAsDialog.title\", \"Export...\"),\n                name: TEXT(\"exportAsDialog.defaultFileName\", \"Workbook\"),\n                extension: \".xlsx\",\n                fileFormats: [{\n                    description: TEXT(\"exportAsDialog.xlsx.description\", \"Excel Workbook (.xlsx)\"),\n                    extension: \".xlsx\"\n                }, {\n                    description: TEXT(\"exportAsDialog.pdf.description\", \"Portable Document Format (.pdf)\"),\n                    extension: \".pdf\"\n                }],\n                pdf: {\n                    fitWidth: true,\n                    area: \"workbook\",\n                    areas: [{\n                        area: \"workbook\",\n                        text: TEXT(\"exportAsDialog.pdf.area.workbook\", \"Entire Workbook\")\n                    },{\n                        area: \"sheet\",\n                        text: TEXT(\"exportAsDialog.pdf.area.sheet\", \"Active Sheet\")\n                    },{\n                        area: \"selection\",\n                        text: TEXT(\"exportAsDialog.pdf.area.selection\", \"Selection\")\n                    }],\n                    paperSize: \"a4\",\n                    paperSizes: [\n                        \"a2\", \"a3\", \"a4\", \"a5\", \"b3\", \"b4\", \"b5\", \"folio\", \"legal\", \"letter\", \"tabloid\", \"executive\"\n                    ].map(PDF_PAPER_SIZE),\n                    margin: {bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\"},\n                    margins: [\n                        { value: { bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\" },\n                          text: TEXT(\"exportAsDialog.pdf.margin.normal\", \"Normal\")\n                        },\n                        { value: { bottom: \"0.75in\", left: \"0.25in\", right: \"0.25in\", top: \"0.75in\" },\n                          text: TEXT(\"exportAsDialog.pdf.margin.narrow\", \"Narrow\")\n                        },\n                        { value: { bottom: \"1in\", left: \"1in\", right: \"1in\", top: \"1in\" },\n                          text: TEXT(\"exportAsDialog.pdf.margin.wide\", \"Wide\")\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template:\n                    \"<div class='k-edit-label'><label id='name-label'>#: messages.exportAsDialog.labels.fileName #:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                        \"<span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input aria-labelledby='name-label' class='k-input-inner' data-#:ns#bind='value: name' /></span>\" +\n                    \"</div>\" +\n                    \"<div >\" +\n                        \"<div class='k-edit-label'><label id='file-format-label'>#: messages.exportAsDialog.labels.saveAsType #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                        \"<select aria-labelledby='file-format-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                            \"data-#:ns#text-field='description' \" +\n                            \"data-#:ns#value-field='extension' \" +\n                            \"data-#:ns#bind='value: extension, source: fileFormats'></select>\" +\n                        \"</div>\" +\n                    \"</div>\" +\n                    \"<div class='k-export-config' data-#:ns#bind='visible: showPdfOptions'>\" +\n                        \"<hr class='k-hr' />\" +\n                        \"<div class='k-edit-label'><label id='export-area-label'>#: messages.exportAsDialog.labels.exportArea #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<select aria-labelledby='export-area-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                                \"data-#:ns#text-field='text' \" +\n                                \"data-#:ns#value-field='area' \" +\n                                \"data-#:ns#bind='value: pdf.area, source: pdf.areas'></select>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label id='paper-size-label'>#: messages.exportAsDialog.labels.paperSize#:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<select aria-labelledby='paper-size-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                                \"data-#:ns#text-field='text' \" +\n                                \"data-#:ns#value-field='value' \" +\n                                \"data-#:ns#bind='value: pdf.paperSize, source: pdf.paperSizes'></select>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label id='margins-label'>#: messages.exportAsDialog.labels.margins #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<select aria-labelledby='margins-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                                \"data-#:ns#value-primitive='true'\" +\n                                \"data-#:ns#text-field='text' \" +\n                                \"data-#:ns#value-field='value' \" +\n                                \"data-#:ns#bind='value: pdf.margin, source: pdf.margins'></select>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<div class='k-button-group'>\" +\n                                \"<input type='radio' id='k-orientation-portrait' aria-label='orientation portrait' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='false' />\" +\n                                `<label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-start k-orientation-button' for='k-orientation-portrait'>${kendo.ui.icon({ icon: \"file\", iconClass: \"k-button-icon\" })}</label>` +\n                                \"<input type='radio' id='k-orientation-landscape' aria-label='orientation landscape' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='true' />\" +\n                                `<label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-end k-orientation-button' for='k-orientation-landscape'>${kendo.ui.icon({ icon: \"file-horizontal\", iconClass: \"k-button-icon\" })}</label>` +\n                            \"</div>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.print #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='guidelines' type='checkbox' data-#:ns#bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>#: messages.exportAsDialog.labels.guidelines#</label>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.scale #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='fitWidth' type='checkbox' data-#:ns#bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>#: messages.exportAsDialog.labels.fit #</label>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.center #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='hCenter' type='checkbox' data-#:ns#bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>#: messages.exportAsDialog.labels.horizontally #</label>\" +\n                            \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='vCenter' type='checkbox' data-#:ns#bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>#: messages.exportAsDialog.labels.vertically #</label>\" +\n                        \"</div>\" +\n                        \"<div class='k-page-orientation'>\" +\n                            kendo.ui.icon($(\"<span data-#:ns#bind='invisible: pdf.landscape'></span>\"), { icon: \"file\" }) +\n                            kendo.ui.icon($(\"<span data-#:ns#bind='visible: pdf.landscape'></span>\"), { icon: \"file-horizontal\" }) +\n                        \"</div>\" +\n                    \"</div>\" +\n                    \"<div class='k-actions'>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.save #</span></button>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                    \"</div>\"\n            },\n            apply: function() {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"SaveAsCommand\",\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register(\"exportAs\", ExportAsDialog);\n\n        function basicErrorDialog(id, msg) {\n            kendo.spreadsheet.dialogs.register(\n                id,\n                MessageDialog.extend({\n                    options: { messageId: msg }\n                })\n            );\n        }\n\n        basicErrorDialog(\"modifyMerged\", \"modifyMergedDialog.errorMessage\");\n        basicErrorDialog(\"rangeDisabled\", \"rangeDisabledDialog.errorMessage\");\n        basicErrorDialog(\"intersectsArray\", \"intersectsArrayDialog.errorMessage\");\n        basicErrorDialog(\"overflow\", \"overflowDialog.errorMessage\");\n        basicErrorDialog(\"unsupportedSelection\", \"unsupportedSelectionDialog.errorMessage\");\n        basicErrorDialog(\"incompatibleRanges\", \"incompatibleRangesDialog.errorMessage\");\n        basicErrorDialog(\"noFillDirection\", \"noFillDirectionDialog.errorMessage\");\n        basicErrorDialog(\"duplicateSheetName\", \"duplicateSheetNameDialog.errorMessage\");\n\n        var ImportErrorDialog = MessageDialog.extend({\n            options: {\n                width: 640,\n                title: \"Errors in import\",\n                template:\n                    \"<div class='k-spreadsheet-message-content k-spreadsheet-import-errors'>\" +\n                      \"<div class='k--header-message'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div>\" +\n                      \"<div class='k--errors'>\" +\n                        \"<table>\" +\n                          \"<thead>\" +\n                            \"<tr><th>Context</th><th>Error message</th></tr>\" +\n                          \"</thead>\" +\n                          \"# for (var i = 0; i < errors.length; ++i) { #\" +\n                            \"# var err = errors[i]; #\" +\n                            \"<tr><td>#: err.context #</td><td>#: err.error #</td></tr>\" +\n                          \"# } #\" +\n                        \"</table>\" +\n                      \"</div>\" +\n                    \"</div>\" +\n                    \"<div class='k-actions'>\" +\n                      \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>\" +\n                        \"<span class='k-button-text'>#: messages.okText #</span>\" +\n                      \"</button>\" +\n                    \"</div>\"\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"importError\", ImportErrorDialog);\n\n        var UseKeyboardDialog = MessageDialog.extend({\n            options: {\n                title: TEXT(\"useKeyboardDialog.title\", \"Copying and pasting\"),\n                template:\n                    \"#: messages.useKeyboardDialog.errorMessage #\" +\n                    \"<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>\" +\n                    \"<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>\" +\n                    \"<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>\" +\n                    '<div class=\"k-actions\">' +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>\" +\n                            \"<span class='k-button-text'>#= messages.okText #</span>\" +\n                        \"</button>\" +\n                    \"</div>\"\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"useKeyboard\", UseKeyboardDialog);\n\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                title: TEXT(\"linkDialog.title\", \"Hyperlink\"),\n                template:\n                (\"<div class='k-edit-label'><label id='url-label'>#: messages.linkDialog.labels.url #:</label></div>\" +\n                 \"<div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input class='k-input-inner' data-#:ns#bind='value: url' title='#: messages.linkDialog.labels.url #' aria-labelledby='url-label'/></span></div>\" +\n                 \"<div class='k-actions'>\" + (\n                     (\"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#= messages.linkDialog.labels.removeLink #</span></button>\" +\n                      \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#= messages.okText #</span></button>\" +\n                      \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\")\n                 ) + \"</div>\"\n                ),\n                autoFocus: false\n            },\n            open: function(range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function() {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger(\"action\", {\n                            command: \"HyperlinkCommand\",\n                            options: {\n                                link: model.url\n                            }\n                        });\n                        self.close();\n                    },\n                    remove: function() {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n\n                // it would be nice if we could easily handle that in one\n                // place for all dialogs, but it doesn't seem easily\n                // doable.\n                element.find(\"input\")\n                    .trigger(\"focus\")\n                    .on(\"keydown\", function(ev){\n                        if (ev.keyCode == 13 /*ENTER*/) {\n                            model.url = $(this).val(); // there won't be a \"change\" event and the model wouldn't update :-\\\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            model.apply();\n                        } else if (ev.keyCode == 27 /*ESC*/) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            model.cancel();\n                        }\n                    });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"hyperlink\", HyperlinkDialog);\n\n        var InsertCommentDialog = SpreadsheetDialog.extend({\n            options: {\n                className: \"k-spreadsheet-insert-comment\",\n                template: \"\\\n<div class='k-edit-label'><label id='comment-label'>#: messages.insertCommentDialog.labels.comment #:</label></div>\\\n<div class='k-edit-field'><span class='k-input k-textarea k-input-solid k-input-md k-rounded-md'><textarea aria-labelledby='comment-label' rows='5' class='k-input-inner' data-#:ns#bind='value: comment'></textarea></span></div>\\\n<div class='k-actions'>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#: messages.insertCommentDialog.labels.removeComment #</span></button>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.okText #</span></button>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\\\n</div>\\\n\",\n                title: TEXT(\"insertCommentDialog.title\", \"Insert comment\"),\n                autoFocus: false,\n                width: 450\n            },\n            open: function(range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    comment: range.comment(),\n                    apply: function() {\n                        if (!/\\S/.test(model.comment)) {\n                            model.comment = null;\n                        }\n                        self.trigger(\"action\", {\n                            command: \"InsertCommentCommand\",\n                            options: {\n                                value: model.comment\n                            }\n                        });\n                        self.close();\n                    },\n                    remove: function() {\n                        model.comment = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n\n                element.find(\"textarea\").trigger(\"focus\");\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"insertComment\", InsertCommentDialog);\n\n        var InsertImageDialog = SpreadsheetDialog.extend({\n            options: {\n                template: \"\\\n<div class='k-spreadsheet-insert-image-dialog'>\\\n  <label data-#:ns#bind='style: { background-image: imageUrl },\\\n                    css: { k-spreadsheet-has-image: hasImage, k-hover: isHovered },\\\n                    events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }'>\\\n    <div data-#:ns#bind='text: info'></div>\\\n    <input type='file' data-#:ns#bind='events: { change: change }'\\\n           accept='image/png, image/jpeg, image/gif' />\\\n  </label>\\\n</div>\\\n<div class='k-actions'>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='enabled: okEnabled, click: apply'><span class='k-button-text'>#: messages.okText #</span></button>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\\\n</div>\",\n                title: TEXT(\"insertImageDialog.title\", \"Insert image\"),\n                width: \"auto\"\n            },\n            open: function() {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    okEnabled: false,\n                    info: kendo.spreadsheet.messages.dialogs.insertImageDialog.info,\n                    imageUrl: \"\",\n                    hasImage: false,\n                    isHovered: false,\n                    _url: null,\n                    _image: null,\n                    apply: function() {\n                        window.URL.revokeObjectURL(model._url);\n                        self.trigger(\"action\", {\n                            command: \"InsertImageCommand\",\n                            options: {\n                                blob   : model._image,\n                                width  : model._width,\n                                height : model._height\n                            }\n                        });\n                        self.close();\n                    },\n                    cancel: self.close.bind(self),\n                    stopEvent: function(ev) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                    },\n                    drop: function(ev) {\n                        model.stopEvent(ev);\n                        model.selectFile(ev.originalEvent.dataTransfer.files);\n                        model.set(\"isHovered\", false);\n                    },\n                    dragEnter: function(ev) {\n                        model.stopEvent(ev);\n                        model.set(\"isHovered\", true);\n                    },\n                    dragLeave: function(ev) {\n                        model.stopEvent(ev);\n                        model.set(\"isHovered\", false);\n                    },\n                    change: function(ev) {\n                        model.selectFile(ev.target.files);\n                    },\n                    selectFile: function(files) {\n                        var image;\n                        for (var i = 0; i < files.length; ++i) {\n                            if (/^image\\//i.test(files[i].type)) {\n                                image = files[i];\n                                break;\n                            }\n                        }\n                        if (model._url) {\n                            window.URL.revokeObjectURL(model._url);\n                        }\n                        if (image) {\n                            model._image = image;\n                            model._url = window.URL.createObjectURL(image);\n                            var img = new Image();\n                            img.src = model._url;\n                            img.onload = function() {\n                                model._width = img.width;\n                                model._height = img.height;\n                                model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.info);\n                                model.set(\"okEnabled\", true);\n                                model.set(\"imageUrl\", \"url('\" + model._url + \"')\");\n                                model.set(\"hasImage\", true);\n                            };\n                        } else {\n                            model._image = null;\n                            model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.typeError);\n                            model.set(\"okEnabled\", false);\n                            model.set(\"imageUrl\", \"\");\n                            model.set(\"hasImage\", false);\n                        }\n                    }\n                });\n                kendo.bind(element, model);\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"insertImage\", InsertImageDialog);\n\n        function Localizable(path, def) {\n            this.path = path.split(\".\");\n            this.def = def;\n        }\n\n        Localizable.prototype.trans = function() {\n            var msg = kendo.spreadsheet.messages.dialogs;\n            for (var i = 0; i < this.path.length; ++i) {\n                msg = msg[this.path[i]];\n                if (!msg) {\n                    return this.def;\n                }\n            }\n            return msg;\n        };\n\n        function TEXT(path, def) {\n            return new Localizable(path, def);\n        }\n\n        function translate(thing) {\n            if (thing instanceof Localizable) {\n                return thing.trans();\n            }\n            else if (Array.isArray(thing)) {\n                return thing.map(translate);\n            }\n            else if (thing != null && typeof thing == \"object\") {\n                return Object.keys(thing).reduce(function(ret, key){\n                    ret[key] = translate(thing[key]);\n                    return ret;\n                }, {});\n            }\n            return thing;\n        }\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n\n\n        var identity = function(o) { return o; };\n\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function(options) {\n\n                this.options = kendo.jQuery.extend({}, this.options, options);\n\n                this.columns = this._normalizeColumns(this.options.columns);\n\n                this._sheet();\n                this._dataSource();\n\n                this._header();\n\n                this._boundRowsCount = 0;\n\n                this.dataSource.fetch();\n            },\n\n            _sheet: function() {\n                this.sheet = this.options.sheet;\n\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n\n                this.sheet.bind(\"change\", this._sheetChangeHandler)\n                    .bind(\"afterDeleteRow\", this._sheetDeleteRowHandler)\n                    .bind(\"afterInsertRow\", this._sheetInsertRowHandler);\n            },\n\n            _sheetInsertRow: function(e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n\n            _sheetDeleteRow: function(e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n\n            _header: function() {\n                this.sheet.batch(function() {\n                    this.columns.forEach(function(column, index) {\n                        this.sheet.range(0,index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n\n            _sheetChange: function(e) {\n                if (e.insertRow || e.deleteRow) {\n                    // these actions are handled via custom events\n                    return;\n                }\n\n                if (e.recalc && e.ref && e.isValue) {\n                    var UnionRef = kendo.spreadsheet.UnionRef;\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    var values = [];\n                    var sheet = this.sheet;\n                    var fields, getters, normalizedRef, i, rangeRef, normalizedRefs;\n                    var setValues = function(ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1]; // skip header row\n\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                var currentValue = values[i][valueIndex][colValueIndex++];\n                                record.set(columns[ci].field, getters[ci](currentValue));\n                            }\n                            valueIndex++;\n                        }\n                    };\n\n                    if (dataSource.reader.model) {\n                        fields = dataSource.reader.model.fields;\n                    }\n\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n\n                    getters = columns.map(function(column) {\n                        var field = column.field;\n                        if (field && fields && fields[field] && fields[field].type == \"date\") {\n                            return numberToDate;\n                        }\n                        return identity;\n                    });\n\n                    this._skipRebind = true;\n                    normalizedRef = sheet._grid.normalize(e.ref);\n\n                    if(!(normalizedRef instanceof UnionRef)) {\n                        normalizedRef = new UnionRef([normalizedRef]);\n                    }\n\n                    normalizedRefs = normalizedRef.refs;\n\n                    normalizedRefs.forEach(function(ref) {\n                        values.push(sheet.range(ref).values());\n                    });\n\n                    for(i = 0; i < normalizedRefs.length; i++) {\n                        rangeRef = normalizedRefs[i];\n                        rangeRef.forEach(setValues);\n                    }\n\n                    this._boundRowsCount = dataSource.view().length;\n\n                    this._skipRebind = false;\n                }\n            },\n\n            _normalizeColumns: function(columns) {\n                return columns.map(function(column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n\n            _dataSource: function() {\n                var options = this.options;\n                var dataSource = options.dataSource;\n\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind(\"change\", this._changeHandler)\n                        .unbind(\"progress\", this._progressHandler)\n                        .unbind(\"error\", this._errorHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                    this._progressHandler = this._requestStart.bind(this);\n                    this._errorHandler = this._error.bind(this);\n                }\n\n                this.dataSource = kendo.data.DataSource.create(dataSource)\n                    .bind(\"change\", this._changeHandler)\n                    .bind(\"progress\", this._progressHandler)\n                    .bind(\"error\", this._errorHandler);\n            },\n\n            _error: function() {\n                this._progress(false);\n            },\n\n            _requestStart: function() {\n                this._progress(true);\n            },\n\n            _progress: function(toggle) {\n                this.sheet.trigger(\"progress\", {\n                    toggle: toggle\n                });\n            },\n\n            _change: function() {\n                if (this._skipRebind) {\n                    return;\n                }\n\n                if (this.sheet.trigger(\"dataBinding\")) {\n                    return;\n                }\n\n                var data = this.dataSource.view();\n                var columns = this.columns;\n\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n\n                var getters = columns.map(function(column) {\n                    return kendo.getter(column.field);\n                });\n\n                this.sheet.batch(function() {\n                    var length = Math.max(data.length, this._boundRowsCount, this.sheet._grid.rowCount - 1);\n\n                    for (var idx = 0; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n\n                            //skip header row\n                            this.sheet.range(idx + 1, getterIdx).value(value);\n                        }\n                    }\n                }.bind(this));\n\n                this._boundRowsCount = data.length;\n\n                this._progress(false);\n                this.sheet.trigger(\"dataBound\");\n            },\n\n            destroy: function() {\n                this.dataSource.unbind(\"change\", this._changeHandler)\n                    .unbind(\"progress\", this._progressHandler)\n                    .unbind(\"error\", this._errorHandler);\n\n                this.sheet.unbind(\"change\", this._sheetChangeHandler)\n                    .unbind(\"deleteRow\", this._sheetDeleteRowHandler)\n                    .unbind(\"insertRow\", this._sheetInsertRowHandler);\n            },\n\n            options: {\n                columns: []\n            }\n        });\n\n        function numberToDate(val) {\n            return val == null ? null : kendo.spreadsheet.numberToDate(val);\n        }\n\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    })(kendo);\n\n    (function(kendo) {\n\n            var $ = kendo.jQuery;\n            var Widget = kendo.ui.Widget;\n            var classNames = {\n                details: \"k-details\",\n                button: \"k-button\",\n                detailsSummary: \"k-details-summary\",\n                detailsContent: \"k-details-content\",\n                icon: \"k-icon\",\n                iconCollapseName: \"caret-br\",\n                iconExpandName: \"caret-alt-right\",\n                iconSearchName: \"search\",\n                textbox: \"k-textbox\",\n                wrapper: \"k-spreadsheet-filter-menu\",\n                filterByCondition: \"k-spreadsheet-condition-filter\",\n                filterByValue: \"k-spreadsheet-value-filter\",\n                valuesTreeViewWrapper: \"k-spreadsheet-value-treeview-wrapper\",\n                actionButtons: \"k-actions\"\n            };\n\n            kendo.spreadsheet.messages.filterMenu = {\n                all: \"All\",\n                sortAscending: \"Sort range A to Z\",\n                sortDescending: \"Sort range Z to A\",\n                filterByValue: \"Filter by value\",\n                filterByCondition: \"Filter by condition\",\n                apply: \"Apply\",\n                search: \"Search\",\n                addToCurrent: \"Add to current selection\",\n                clear: \"Clear\",\n                blanks: \"(Blanks)\",\n                operatorNone: \"None\",\n                and: \"AND\",\n                or: \"OR\",\n                operators: {\n                    string: {\n                        contains: \"Text contains\",\n                        doesnotcontain: \"Text does not contain\",\n                        startswith: \"Text starts with\",\n                        endswith: \"Text ends with\",\n                        matches: \"Text matches\",\n                        doesnotmatch: \"Text does not match\"\n                    },\n                    date: {\n                        eq:  \"Date is\",\n                        neq: \"Date is not\",\n                        lt:  \"Date is before\",\n                        gt:  \"Date is after\"\n                    },\n                    number: {\n                        eq: \"Is equal to\",\n                        neq: \"Is not equal to\",\n                        gte: \"Is greater than or equal to\",\n                        gt: \"Is greater than\",\n                        lte: \"Is less than or equal to\",\n                        lt: \"Is less than\"\n                    }\n                }\n            };\n\n            var Details = Widget.extend({\n                init: function(element, options) {\n                    Widget.fn.init.call(this, element, options);\n\n                    this.element.addClass(FilterMenu.classNames.details);\n\n                    this._summary = this.element.find(\".\" + FilterMenu.classNames.detailsSummary)\n                        .on(\"click\", this._toggle.bind(this));\n\n                    var iconName = options.expanded ? FilterMenu.classNames.iconCollapseName : FilterMenu.classNames.iconExpandName;\n                    this._icon = $(kendo.ui.icon(iconName))\n                        .prependTo(this._summary);\n\n                    this._container = kendo.wrap(this._summary.next(), true);\n\n                    if (!options.expanded) {\n                        this._container.hide();\n                    }\n                },\n                options: {\n                    name: \"Details\"\n                },\n                events: [ \"toggle\" ],\n                visible: function() {\n                    return this.options.expanded;\n                },\n                toggle: function(show) {\n                    var animation = kendo.fx(this._container).expand(\"vertical\");\n\n                    animation.stop()[show ? \"reverse\" : \"play\"]();\n                    kendo.ui.icon(this._icon, { icon: show ? FilterMenu.classNames.iconExpandName : FilterMenu.classNames.iconCollapseName });\n\n                    this.options.expanded = !show;\n                },\n                _toggle: function() {\n                    var show = this.visible();\n                    this.toggle(show);\n                    this.trigger(\"toggle\", { show: show });\n                }\n            });\n\n            kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n                init: function(element, bindings, options) {\n                    kendo.data.Binder.fn.init.call(this, element, bindings, options);\n\n                    this._change = this.change.bind(this);\n                    $(this.element).on(\"change\", this._change);\n                },\n                refresh: function() {\n                    var that = this,\n                        value = that.bindings.spreadsheetFilterValue.get(); //get the value from the View-Model\n\n                    $(that.element).val(value instanceof Date ? \"\" : value);\n                },\n                change: function() {\n                    var value = this.element.value;\n                    this.bindings.spreadsheetFilterValue.set(value); //update the View-Model\n                }\n            });\n\n            kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n                init: function(widget, bindings, options) {\n                    kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n\n                    this.widget = widget;\n                    this._change = this.change.bind(this);\n                    this.widget.first(\"change\", this._change);\n                },\n                refresh: function() {\n                    var binding = this.bindings.spreadsheetFilterValue,\n                        value = binding.get(),\n                        type = $(this.widget.element).data(\"filterType\");\n\n                    if ((type === \"date\" && value instanceof Date) || (type === \"number\" && !isNaN(value))) {\n                        this.widget.value(value);\n                    } else {\n                        this.widget.value(null);\n                    }\n                },\n                change: function() {\n                    var value = this.widget.value(),\n                        binding = this.bindings.spreadsheetFilterValue;\n\n                    binding.set(value);\n                }\n            });\n\n            var templates = {\n                filterByValue:\n                    \"<div class='\" + classNames.detailsSummary + \"'>#= messages.filterByValue #</div>\" +\n                    \"<div class='\" + classNames.detailsContent + \"'>\" +\n                        \"<div class='k-searchbox k-input k-input-md k-rounded-md k-input-solid'>\" +\n                            kendo.ui.icon({ icon: \"search\", iconClass: \"k-input-icon\" }) +\n                            \"<input class='k-input-inner' autocomplete='off' placeholder='#= messages.search #' data-#=ns#bind='events: { input: filterValues }' />\" +\n                        \"</div>\" +\n                        \"<div data-#=ns#bind='visible: hasActiveSearch'><input class='k-checkbox k-checkbox-md k-rounded-md' type='checkbox' data-#=ns#bind='checked: appendToSearch' id='_#=guid#'/><label class='k-checkbox-label' for='_#=guid#'>#= messages.addToCurrent #</label></div>\" +\n                        \"<div class='\" + classNames.valuesTreeViewWrapper + \"'>\" +\n                            \"<div data-#=ns#role='treeview' \" +\n                                \"data-#=ns#checkboxes='{ checkChildren: true }' \"+\n                                \"data-#=ns#bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' \"+\n                                \"></div>\" +\n                        \"</div>\" +\n                    \"</div>\",\n                filterByCondition:\n                    \"<div class='\" + classNames.detailsSummary + \"'>#= messages.filterByCondition #</div>\" +\n                    \"<div class='\" + classNames.detailsContent + \"'>\" +\n                        '<div>' +\n                            '<select ' +\n                                'aria-label=\"#= messages.filterByCondition #\" ' +\n                                'data-#=ns#role=\"dropdownlist\"' +\n                                'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' +\n                                'data-#=ns#value-primitive=\"false\"' +\n                                'data-#=ns#option-label=\"#=messages.operatorNone#\"' +\n                                'data-#=ns#height=\"auto\"' +\n                                'data-#=ns#text-field=\"text\"' +\n                                'data-#=ns#value-field=\"unique\">'+\n                            '</select>'+\n                        '</div>' +\n\n                        '<div data-#=ns#bind=\"visible: isString\">' +\n                            '<input aria-label=\"string-value\" data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />'+\n                        '</div>' +\n\n                        '<div data-#=ns#bind=\"visible: isNumber\">' +\n                            '<input aria-label=\"number-value\" data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />'+\n                        '</div>' +\n\n                        '<div data-#=ns#bind=\"visible: isDate\">' +\n                            '<input aria-label=\"date-value\" data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />'+\n                        '</div>' +\n                    \"</div>\",\n                menuItem:\n                    \"<li data-command='#=command#' data-dir='#=dir#'>\" +\n                        \"#= kendo.ui.icon(iconClass) ##=text#\" +\n                    \"</li>\",\n                actionButtons:\n                    \"<button data-#=ns#bind='click: apply' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'><span class='k-button-text'>#=messages.apply#</span></button>\" +\n                    \"<button data-#=ns#bind='click: clear' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class='k-button-text'>#=messages.clear#</span></button>\"\n            };\n\n            function distinctValues(values) {\n                var hash = {};\n                var result = [];\n\n                for (var i = 0; i < values.length; i++) {\n                    if (!hash[values[i].value]) {\n                        hash[values[i].value] = values[i];\n                        result.push(values[i]);\n                    } else if (!hash[values[i].value].checked && values[i].checked) {\n                        hash[values[i].value].checked = true;\n                    }\n                }\n\n                return result;\n            }\n\n            function filter(dataSource, query) {\n                var hasVisibleChildren = false;\n                var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n                var valuesFilter = this;\n                var values = this.values;\n                for (var i = 0; i < data.length; i++) {\n                    var item = data[i];\n                    var text = item.text.toString().toLocaleLowerCase(kendo.culture().name);\n                    var itemVisible = query === true || query === \"\" || text.indexOf(query) >= 0;\n                    var filterSpread = filter.bind(valuesFilter);\n                    var anyVisibleChildren = filterSpread(item.children, query); // pass true if parent matches\n\n                    hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                    item.hidden = !itemVisible && !anyVisibleChildren;\n\n                    if (query.length || (values && !values.length)) {\n                        item.checked = !item.hidden;\n                    } else if (values && values.indexOf(item.text) != -1){\n                        item.checked = true;\n                    }\n                }\n\n                if (data) {\n                    // re-apply filter on children\n                    dataSource.filter({ field: \"hidden\", operator: \"neq\", value: true });\n                }\n\n                return hasVisibleChildren;\n            }\n\n            function uncheckAll(dataSource) {\n                var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n\n                for (var i = 0; i < data.length; i++) {\n                    var item = data[i];\n                    item.checked = false;\n\n                    if (item.hasChildren) {\n                        uncheckAll(item.children);\n                    }\n                }\n            }\n\n            var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n                valuesChange: function(e) {\n                    var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                    var checked = function(item) {\n                        return item.checked;\n                    };\n                    var value = function(item) {\n                        return item.dataType === \"date\" ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                    };\n                    var unique = function(value, index, array) {\n                        return array.lastIndexOf(value) === index;\n                    };\n                    var data = dataSource.data();\n                    var values = data.toJSON()[0].items;\n                    var blanks = values.filter(function(item) {\n                        return item.dataType === \"blank\";\n                    });\n\n                    blanks = blanks.length ? blanks[0].checked : false;\n                    values = values.filter(checked).map(value);\n\n                    if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                        values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                    }\n\n                    this.set(\"valueFilter\", {\n                        values: values,\n                        blanks: blanks\n                    });\n                },\n                valueSelect: function(e) {\n                    e.preventDefault();\n\n                    var node = e.sender.dataItem(e.node);\n                    node.set(\"checked\", !node.checked);\n                },\n                hasActiveSearch: false,\n                appendToSearch: false,\n                filterValues: function(e) {\n                    var query = typeof e == \"string\" ? e : $(e.target).val().toLocaleLowerCase(kendo.culture().name);\n                    var dataSource = this.valuesDataSource;\n\n                    this.set(\"hasActiveSearch\", !!query);\n\n                    var filterSpread = filter.bind(this.valueFilter);\n                    uncheckAll(dataSource);\n                    filterSpread(dataSource, query);\n                },\n                reset: function() {\n                    this.set(\"customFilter\", { logic: \"and\", criteria: [ { operator: null, value: null } ] });\n                    this.set(\"valueFilter\", { values: [] });\n                },\n                operatorChange: function(e) {\n                    var dataItem = e.sender.dataItem();\n                    this.set(\"operatorType\", dataItem.type);\n\n                    // https://github.com/telerik/kendo-ui-core/issues/3317 - when switching from Value\n                    // filter to filter by condition, the customFilter property is lost.\n                    if (!this.get(\"customFilter\")) {\n                        this.reset();\n                    }\n\n                    this.set(\"customFilter.criteria[0].operator\", dataItem.value);\n                },\n                isNone: function() {\n                    return this.get(\"operatorType\") === undefined;\n                },\n                isString: function() {\n                    return this.get(\"operatorType\") === \"string\";\n                },\n                isNumber: function() {\n                    return this.get(\"operatorType\") === \"number\";\n                },\n                isDate: function() {\n                    return this.get(\"operatorType\") === \"date\";\n                }\n            });\n\n            function flattenOperators(operators) {\n                var messages = kendo.spreadsheet.messages.filterMenu.operators;\n                var result = [];\n                for (var type in operators) {\n                    if (!operators.hasOwnProperty(type)) {\n                        continue;\n                    }\n\n                    for (var operator in operators[type]) {\n                        if (!operators[type].hasOwnProperty(operator)) {\n                            continue;\n                        }\n\n                        result.push({\n                            text: messages[type][operator],\n                            value: operator,\n                            unique: type + \"_\" + operator,\n                            type: type\n                        });\n                    }\n                }\n                return result;\n            }\n\n            var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n                valuesTree: function(range, column) {\n                    return [{\n                        text: kendo.spreadsheet.messages.filterMenu.all,\n                        expanded: true,\n                        checked: false,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n                },\n                values: function(range, column) {\n                    var values = [];\n                    var messages = kendo.spreadsheet.messages.filterMenu;\n                    var columnRange = range.column(column);\n                    var sheet = range.sheet();\n\n                    columnRange.forEachCell(function(row, col, cell) {\n                        var checked = true;\n                        if (sheet.isHiddenRow(row)) {\n                            checked = false;\n                        }\n\n                        var value = cell.value;\n                        var dataType = cell.dataType;\n                        var text = cell.text;\n\n                        if (value === undefined) {\n                            dataType = \"blank\";\n                        } else if (cell.format) {\n                            dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                        } else {\n                            dataType = typeof value;\n                        }\n\n                        if (value !== null && cell.format) {\n                            text = kendo.spreadsheet.formatting.text(value, cell.format);\n                        } else {\n                            text = dataType == \"blank\" ? messages.blanks : value;\n                        }\n\n                        if (dataType === \"percent\" || dataType === \"currency\") { //treat percent as number\n                            dataType = \"number\";\n                        }\n\n                        if (dataType === \"date\") {\n                            value = kendo.spreadsheet.numberToDate(value);\n                        }\n\n                        values.push({\n                            dataType: dataType,\n                            value: value,\n                            text: text,\n                            checked: checked\n                        });\n                    });\n\n                    values = distinctValues(values);\n\n                    values.sort(function(a, b) {\n                        if (a.dataType === b.dataType) {\n                            return 0;\n                        }\n\n                        if (a.dataType === \"blank\" || b.dataType === \"blank\") {\n                            return a.dataType === \"blank\" ? -1 : 1;\n                        }\n\n                        if (a.dataType === \"number\" || b.dataType === \"number\") {\n                            return a.dataType === \"number\" ? -1 : 1;\n                        }\n\n                        if (a.dataType === \"date\" || b.dataType === \"date\") {\n                            return a.dataType === \"date\" ? -1 : 1;\n                        }\n\n                        return 0;\n                    });\n\n                    return values;\n                },\n\n                filterType: function(range, column) {\n                    // 1. try to infer type from current filter\n                    var sheet = range.sheet();\n                    var filter = this.filterForColumn(column, sheet);\n                    var type;\n\n                    filter = filter && filter.filter.toJSON();\n\n                    if (filter && filter.filter == \"custom\") {\n                        var value = filter.criteria[0].value;\n\n                        if (value instanceof Date) {\n                            type = \"date\";\n                        } else if (typeof value == \"string\") {\n                            type = \"string\";\n                        } else if (typeof value == \"number\") {\n                            type = \"number\";\n                        }\n                    }\n\n                    if (!type) {\n                        // 2. try to infer type from column data\n                        var topValue = this.values(range.row(1), column)[0];\n                        type = topValue && topValue.dataType;\n\n                        if (type == \"blank\") {\n                            type = null;\n                        }\n                    }\n\n                    return type;\n                },\n\n                filterForColumn: function(column, sheet) {\n                    var allFilters = sheet.filter();\n                    var filters;\n\n                    if (allFilters) {\n                        filters =  allFilters.columns.filter(function(item) {\n                            return item.index === column;\n                        })[0];\n                    }\n\n                    return filters;\n                },\n\n                filter: function(column, sheet) {\n                    var columnFilters = this.filterForColumn(column, sheet);\n\n                    if (!columnFilters) {\n                        return;\n                    }\n\n                    var options = columnFilters.filter.toJSON();\n                    var type = options.filter;\n\n                    delete options.filter;\n\n                    var result = {\n                        type: type,\n                        options: options\n                    };\n\n                    var criteria = options.criteria;\n                    if (criteria && criteria.length) {\n                        result.operator = criteria[0].operator;\n                    }\n\n                    return result;\n                }\n            };\n\n            var FilterMenu = Widget.extend({\n                init: function(element, options) {\n                    Widget.call(this, element, options);\n\n                    this.element.addClass(FilterMenu.classNames.wrapper);\n\n                    this.viewModel = new FilterMenuViewModel({\n                        active: \"value\",\n                        operator: null,\n                        operators: flattenOperators(this.options.operators),\n                        clear: this.clear.bind(this),\n                        apply: this.apply.bind(this)\n                    });\n\n                    this._filterInit();\n                    this._popup();\n                    this._sort();\n                    this._filterByCondition();\n                    this._filterByValue();\n                    this._actionButtons();\n                },\n\n                options: {\n                    name: \"FilterMenu\",\n                    column: 0,\n                    range: null,\n                    operators: {\n                        string: {\n                            contains: \"Text contains\",\n                            doesnotcontain: \"Text does not contain\",\n                            startswith: \"Text starts with\",\n                            endswith: \"Text ends with\",\n                            matches: \"Text matches\",\n                            doesnotmatch: \"Text does not match\"\n                        },\n                        date: {\n                            eq:  \"Date is\",\n                            neq: \"Date is not\",\n                            lt:  \"Date is before\",\n                            gt:  \"Date is after\"\n                        },\n                        number: {\n                            eq: \"Is equal to\",\n                            neq: \"Is not equal to\",\n                            gte: \"Is greater than or equal to\",\n                            gt: \"Is greater than\",\n                            lte: \"Is less than or equal to\",\n                            lt: \"Is less than\"\n                        }\n                    }\n                },\n\n                events: [\n                    \"action\"\n                ],\n\n                destroy: function() {\n                    Widget.fn.destroy.call(this);\n\n                    this.menu.destroy();\n                    this.valuesTreeView.destroy();\n                    this.popup.destroy();\n                },\n\n                openFor: function(anchor, event) {\n                    if ($(anchor).hasClass(\"k-spreadsheet-view-size\")) {\n                        // on touch devices this element will sit above to\n                        // enable scrolling; it's not useful as an anchor,\n                        // use event coords instead.\n                        this.popup.open(event.pageX, event.pageY);\n                    } else {\n                        this.popup.setOptions({ anchor: anchor });\n                        this.popup.open();\n                    }\n                },\n\n                close: function() {\n                    this.popup.close();\n                },\n\n                clear: function() {\n                    this.action({\n                        command: \"ClearFilterCommand\",\n                        options: {\n                            column: this.options.column\n                        }\n                    });\n                    this.viewModel.reset();\n                    this.close();\n                },\n\n                apply: function() {\n                    this._active();\n\n                    var options = {\n                        operatingRange: this.options.range,\n                        column: this.options.column\n                    };\n\n                    var valueFilter;\n                    var customFilter;\n\n                    if (this.viewModel.active === \"value\") {\n                        this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                        valueFilter = this.viewModel.valueFilter.toJSON();\n\n                        if (valueFilter.blanks || (valueFilter.values && valueFilter.values.length)) {\n                            options.valueFilter = valueFilter;\n                        }\n                    } else if (this.viewModel.active === \"custom\") {\n                        customFilter = this.viewModel.customFilter.toJSON();\n\n                        if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                            options.customFilter = customFilter;\n                        }\n                    }\n\n                    if (options.valueFilter || options.customFilter) {\n                        this.action({ command: \"ApplyFilterCommand\", options: options });\n                    }\n                },\n\n                action: function(options) {\n                    this.trigger(\"action\", $.extend({ }, options));\n                },\n\n                _filterInit: function() {\n                    var column = this.options.column;\n                    var range = this.options.range;\n                    var sheet = range.sheet();\n                    var activeFilter = FilterMenuController.filter(column, sheet);\n\n                    if (activeFilter) {\n                        var filterType = FilterMenuController.filterType(range, column);\n\n                        this.viewModel.set(\"active\", activeFilter.type);\n                        this.viewModel.set(activeFilter.type + \"Filter\", activeFilter.options);\n\n                        if (activeFilter.type == \"custom\") {\n                            this.viewModel.set(\"operator\", filterType + \"_\" + activeFilter.operator);\n                            this.viewModel.set(\"operatorType\", filterType);\n                        }\n                    } else {\n                        this.viewModel.reset();\n                    }\n                },\n\n                _popup: function() {\n                    this.popup = this.element.kendoPopup({\n                        copyAnchorStyles: false\n                    }).data(\"kendoPopup\");\n                },\n\n                _sort: function() {\n                    var template = kendo.template(FilterMenu.templates.menuItem);\n                    var messages = kendo.spreadsheet.messages.filterMenu;\n                    var items = [\n                        { command: \"sort\", dir: \"asc\", text: messages.sortAscending, iconClass: \"sort-asc\" },\n                        { command: \"sort\", dir: \"desc\", text: messages.sortDescending, iconClass: \"sort-desc\" }\n                    ];\n\n                    var ul = $(\"<ul></ul>\", {\n                        \"html\": kendo.render(template, items)\n                    }).appendTo(this.element);\n\n                    this.menu = ul.kendoMenu({\n                        orientation: \"vertical\",\n                        select: function(e) {\n                            var dir = $(e.item).data(\"dir\");\n                            var range = this.options.range.resize({ top: 1 });\n                            var options = {\n                                value: dir,\n                                sheet: false,\n                                operatingRange: range,\n                                column: this.options.column\n                            };\n\n                            this.action({ command: \"SortCommand\", options: options });\n                        }.bind(this)\n                    }).data(\"kendoMenu\");\n                },\n\n                _appendTemplate: function(template, className, details, expanded) {\n                    var compiledTemplate = kendo.template(template);\n                    var wrapper = $(\"<div class='\" + className + \"'/>\").html(compiledTemplate({\n                        messages: kendo.spreadsheet.messages.filterMenu,\n                        guid: kendo.guid(),\n                        ns: kendo.ns\n                    }));\n\n                    this.element.append(wrapper);\n\n                    if (details) {\n                        details = new Details(wrapper, { expanded: expanded, toggle: this._detailToggle.bind(this) });\n                    }\n\n                    kendo.bind(wrapper, this.viewModel);\n\n                    return wrapper;\n                },\n\n                _detailToggle: function(e) {\n                    this.element\n                        .find(\"[\" + kendo.attr(\"role\") + \"=details]\")\n                        .not(e.sender.element)\n                        .data(\"kendoDetails\")\n                        .toggle(!e.show);\n                },\n\n                _filterByCondition: function() {\n                    var isExpanded = this.viewModel.active === \"custom\";\n                    this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n                },\n\n                _filterByValue: function() {\n                    var isExpanded = this.viewModel.active === \"value\";\n                    var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n\n                    this.valuesTreeView = wrapper.find(\"[\" + kendo.attr(\"role\") + \"=treeview]\").data(\"kendoTreeView\");\n\n                    var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n\n                    this.viewModel.set(\"valuesDataSource\", new kendo.data.HierarchicalDataSource({ data: values, accentFoldingFiltering: kendo.culture().name }));\n                },\n\n                _actionButtons: function() {\n                    this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n                },\n\n                _active: function() {\n                    var activeContainer = this.element.find(\"[\" + kendo.attr(\"role\") + \"=details]\").filter(function(index, element) {\n                        return $(element).data(\"kendoDetails\").visible();\n                    });\n\n                    if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                        this.viewModel.set(\"active\", \"value\");\n                    } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                        this.viewModel.set(\"active\", \"custom\");\n                    }\n                }\n            });\n\n            kendo.spreadsheet.FilterMenu = FilterMenu;\n            $.extend(true, FilterMenu, { classNames: classNames, templates: templates });\n\n        })(window.kendo);\n\n    (function(kendo) {\n\n        var SheetEditor = kendo.Observable.extend({\n            init: function(view) {\n                kendo.Observable.fn.init.call(this);\n\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this._active = false;\n\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n\n                this.barInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n                this.cellInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n\n                this.barInput.bind(\"blur\", this._blur.bind(this));\n                this.cellInput.bind(\"blur\", this._blur.bind(this));\n            },\n\n            events: [\n                \"activate\",\n                \"deactivate\",\n                \"change\",\n                \"update\"\n            ],\n\n            _blur: function() {\n                this.deactivate();\n            },\n\n            _triggerUpdate: function() {\n                this.trigger(\"update\", { value: this.value() });\n            },\n\n            activeEditor: function() {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n\n                return editor;\n            },\n\n            activate: function(options) {\n                var viewElement = this.view.element,\n                    viewWidth, scrollerElement, scrollbarWidth;\n\n                this._active = true;\n                this._rect = options.rect;\n                this._range = options.range;\n\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = this._range.topLeft();\n                this.cellInput.activeSheet = this.barInput.activeSheet = this._range._sheet;\n\n                if(viewElement) {\n                    viewWidth = viewElement.width();\n                    scrollerElement = viewElement.find(\".k-spreadsheet-scroller\")[0];\n                    scrollbarWidth = scrollerElement.offsetWidth - scrollerElement.clientWidth;\n\n                    this.cellInput.element.css(\"max-width\", viewWidth - scrollbarWidth - this.cellInput.element.position().left + \"px\");\n                }\n\n                this.trigger(\"activate\");\n\n                return this;\n            },\n\n            deactivate: function(noChange) {\n                var cellInput = this.cellInput;\n\n                if (!this._active) {\n                    return;\n                }\n\n                this._active = false;\n\n                if (!noChange && cellInput.value() != this._value) {\n                    this.trigger(\"change\", {\n                        value: cellInput.value(),\n                        range: this._range\n                    });\n                }\n\n                this._rect = null;\n                cellInput.hide();\n                this.trigger(\"deactivate\");\n            },\n\n            enable: function(enable) {\n                this.barInput.enable(enable);\n                this.cellInput.enable(enable);\n            },\n\n            barElement: function() {\n                return this.barInput.element;\n            },\n\n            cellElement: function() {\n                return this.cellInput.element;\n            },\n\n            focus: function(inputType) {\n                inputType = inputType || \"cell\";\n\n                if (inputType === \"cell\") {\n                    this.cellInput.element.trigger(\"focus\");\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.trigger(\"focus\");\n                }\n            },\n\n            isActive: function() {\n                return this._active;\n            },\n\n            isFiltered: function() {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n\n            canInsertRef: function(isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n\n            highlightedRefs: function() {\n                var editor = this.activeEditor();\n                var refs = [];\n\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n\n                return refs;\n            },\n\n            scale: function() {\n                this.cellInput.scale();\n            },\n\n            toggleTooltip: function(rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n\n            value: function(value, isArrayFormula) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n\n                if (value === null) {\n                    value = \"\";\n                }\n\n                this._value = value;\n\n                this.barInput.value(value);\n                this.cellInput.value(value);\n\n                this.barInput.element.toggleClass(\"k-spreadsheet-array-formula\", !!isArrayFormula);\n            },\n\n            insertNewline: function() {\n                this.activeEditor().insertNewline();\n                this.scale();\n            },\n\n            select: function() {\n                this.activeEditor().select();\n            }\n        });\n\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    })(kendo);\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        var spreadsheet$1 = kendo.spreadsheet;\n        var Range = spreadsheet$1.Range;\n        var runtime = spreadsheet$1.calc.runtime;\n        var Formula = runtime.Formula;\n\n        var ERR_INCOMPATIBLE = \"incompatibleRanges\";\n        var ERR_NO_DIRECTION = \"noFillDirection\";\n\n        var FillError = Range.FillError = function(msg) {\n            this.code = msg;\n        };\n\n        // `srcRange`: the range containing data that we wish to fill.  `direction`: 0, 1, 2, 3.  So\n        // when bit 0 is set we're doing horizontal filling, and when bit 1 is set we're doing it in\n        // reverse order.\n        Range.prototype._previewFillFrom = function(srcRange, direction) {\n            var destRange = this, sheet = destRange._sheet;\n            if (typeof srcRange == \"string\") {\n                srcRange = sheet.range(srcRange);\n            }\n            var src = srcRange._ref.toRangeRef().clone().setSheet(sheet.name());\n            var dest = destRange._ref.toRangeRef().clone().setSheet(sheet.name());\n\n            if (src.intersects(dest)) {\n                // the UI will send e.g. C2:C8.fillFrom(C7:D8) (intersecting ranges).  this figures out\n                // the actual destination range.\n                if (src.eq(dest)) {\n                    return null; // nothing to do\n                }\n                dest = dest.clone();\n                if (src.topLeft.eq(dest.topLeft)) {\n                    if (src.width() == dest.width()) {\n                        dest.topLeft.row += src.height();\n                        direction = 0;\n                    } else if (src.height() == dest.height()) {\n                        dest.topLeft.col += src.width();\n                        direction = 1;\n                    } else {\n                        throw new FillError(ERR_INCOMPATIBLE);\n                    }\n                } else if (src.bottomRight.eq(dest.bottomRight)) {\n                    if (src.width() == dest.width()) {\n                        dest.bottomRight.row -= src.height();\n                        direction = 2;\n                    } else if (src.height() == dest.height()) {\n                        dest.bottomRight.col -= src.width();\n                        direction = 3;\n                    } else {\n                        throw new FillError(ERR_INCOMPATIBLE);\n                    }\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n                return sheet.range(dest)._previewFillFrom(srcRange, direction);\n            }\n\n            if (direction == null) {\n                // try to determine based on ranges location/geometry\n                if (src.topLeft.col == dest.topLeft.col) {\n                    // assume vertical filling\n                    direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n                } else if (src.topLeft.row == dest.topLeft.row) {\n                    direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n                } else {\n                    throw new FillError(ERR_NO_DIRECTION);\n                }\n            }\n            var horizontal = direction & 1;\n            var descending = direction & 2;\n            if ((horizontal && src.height() != dest.height()) ||\n                (!horizontal && src.width() != dest.width())) {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n            var data = srcRange._properties(), n;\n            if (!horizontal) {\n                data = transpose(data);\n                n = dest.height();\n            } else {\n                n = dest.width();\n            }\n            var fill = new Array(data.length);\n            var hint = null;\n            for (var i = 0; i < data.length; ++i) {\n                var s = data[i];\n                var f = findSeries(s);\n                var a = fill[i] = new Array(n);\n                for (var j = 0; j < n; ++j) {\n                    var idx = descending ? -j - 1 : s.length + j;\n                    var srcIdx = descending ? s.length - (j % s.length) - 1 : (j % s.length);\n                    var cell = a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n                    if (cell.value != null) {\n                        hint = cell.value;\n                    }\n                }\n            }\n            if (!horizontal) {\n                fill = transpose(fill);\n            }\n            return { props: fill, direction: direction, dest: destRange, hint: hint };\n        };\n\n        Range.prototype.fillFrom = function(srcRange, direction) {\n            var x = this._previewFillFrom(srcRange, direction);\n            x.dest._properties(x.props, true);\n            return x.dest;\n        };\n\n        // This is essentially the FORECAST function, see ./runtime.functions.2.js.\n        // It receives an array of values, and returns a function that \"predicts\"\n        // the value in cell N.\n        function linearRegression(data) {\n            var N = data.length;\n            var mx = (N + 1) / 2, my = data.reduce(function(a, b){\n                return a + b;\n            }, 0) / N;\n            var s1 = 0, s2 = 0;\n            for (var i = 0; i < N; i++) {\n                var t1 = (i + 1) - mx, t2 = data[i] - my;\n                s1 += t1 * t2;\n                s2 += t1 * t1;\n            }\n            if (!s2) {\n                return function(N){\n                    return data[N % data.length];\n                };\n            }\n            var b = s1 / s2, a = my - b * mx;\n            return function(N) {\n                return a + b * (N + 1);\n            };\n        }\n\n        function findSeries(properties) {\n            function findStep(a) {\n                var diff = a[1] - a[0];\n                for (var i = 2; i < a.length; ++i) {\n                    if (a[i] - a[i-1] != diff) {\n                        return null;\n                    }\n                }\n                return diff;\n            }\n            function getData(a) {\n                return a.map(function(v){\n                    return v.number;\n                });\n            }\n            var series = [];\n            var data = properties.map(function(x){\n                return x.formula || x.value;\n            });\n            forEachSeries(data, function(begin, end, type, a){\n                var f, values;\n                if (type == \"number\") {\n                    values = getData(a);\n\n                    // This code would increase a date even if a single cell was selected.  Seems it's\n                    // not desirable so I commented it out.\n                    // https://github.com/telerik/kendo-ui-core/issues/3565\n                    //\n                    // if (values.length == 1 && (begin > 0 || end < data.length ||\n                    //                            formatType(values[0], properties[begin].format) == \"date\")) {\n                    //     values.push(values[0] + 1);\n                    // }\n\n                    f = linearRegression(values);\n                } else if (type == \"string\" || type == \"formula\" || type == \"boolean\") {\n                    // formulas are simply copied over; the sheet will internally clone the objects\n                    f = function(N, i) {\n                        return data[i];\n                    };\n                } else if (Array.isArray(type)) {\n                    if (a.length == 1) {\n                        f = function(N) {\n                            return type[(a[0].number + N) % type.length];\n                        };\n                    } else {\n                        // figure out the step\n                        var diff = findStep(getData(a));\n                        if (diff == null) {\n                            // seemingly no pattern, just repeat those strings\n                            f = function(N) {\n                                return a[(N) % a.length].value;\n                            };\n                        } else {\n                            f = function(N) {\n                                var idx = a[0].number + diff * N;\n                                return type[idx % type.length];\n                            };\n                        }\n                    }\n                } else if (type != \"null\") {\n                    values = getData(a);\n                    if (values.length == 1) {\n                        values.push(values[0] + 1);\n                    }\n                    values = linearRegression(values);\n                    f = function(N, i) {\n                        return data[i].replace(/^(.*[\\D0]+)\\d+/, \"$1\" + values(N, i));\n                    };\n                } else {\n                    f = function() { return null; };\n                }\n                var s = { f: f, begin: begin, end: end, len: end - begin };\n                for (var i = begin; i < end; ++i) {\n                    series[i] = s;\n                }\n            });\n            return function(N, i) {\n                var s = series[i];\n                var q = N / data.length | 0;\n                var r = N % data.length;\n                var n = q * s.len + r - s.begin;\n                var value = s.f(n, i);\n                var props = clone$1(properties[i]);\n                delete props.enable;\n                if (value instanceof Formula) {\n                    props.formula = value;\n                } else {\n                    props.value = value;\n                }\n                return props;\n            };\n        }\n\n        // function formatType(value, format) {\n        //     if (format != null) {\n        //         return spreadsheet.formatting.type(value, format);\n        //     }\n        // }\n\n        function clone$1(obj) {\n            var copy = {};\n            Object.keys(obj || {}).forEach(function(key){\n                copy[key] = obj[key];\n            });\n            return copy;\n        }\n\n        function forEachSeries(data, f) {\n            var prev = null, start = 0, a = [], type;\n            for (var i = 0; i < data.length; ++i) {\n                type = getType(data[i]);\n                a.push(type);\n                if (prev != null && type.type !== prev.type) {\n                    f(start, i, prev.type, a.slice(start, i));\n                    start = i;\n                }\n                prev = type;\n            }\n            f(start, i, prev.type, a.slice(start, i));\n        }\n\n        function getType(el) {\n            if (typeof el == \"number\") {\n                return { type: \"number\", number: el };\n            }\n            if (typeof el == \"string\") {\n                var lst = findStringList(el);\n                if (lst) {\n                    return lst;\n                }\n                var m = /^(.*\\D)(\\d+)/.exec(el);\n                if (m) {\n                    el = el.replace(/^(.*\\D)\\d+/, \"$1-######\");\n                    return { type: el, match: m, number: parseFloat(m[2]) };\n                }\n                return { type: \"string\" };\n            }\n            if (typeof el == \"boolean\") {\n                return { type: \"boolean\" };\n            }\n            if (el == null) {\n                return { type: \"null\" };\n            }\n            if (el instanceof Formula) {\n                return { type: \"formula\" };\n            }\n            window.console.error(el);\n            throw new Error(\"Cannot fill data\");\n        }\n\n        function stringLists() {\n            var culture = kendo.culture();\n            return [\n                culture.calendars.standard.days.namesAbbr,\n                culture.calendars.standard.days.names,\n                culture.calendars.standard.months.namesAbbr,\n                culture.calendars.standard.months.names\n            ];\n        }\n\n        function findStringList(str) {\n            var strl = str.toLowerCase();\n            var lists = stringLists();\n            for (var i = 0; i < lists.length; ++i) {\n                var a = lists[i];\n                for (var j = a.length; --j >= 0;) {\n                    var el = a[j].toLowerCase();\n                    if (el == strl) {\n                        return { type: a, number: j, value: str };\n                    }\n                }\n            }\n        }\n\n        function transpose(a) {\n            var height = a.length, width = a[0].length;\n            var t = [];\n            for (var i = 0; i < width; ++i) {\n                t[i] = [];\n                for (var j = 0; j < height; ++j) {\n                    t[i][j] = a[j][i];\n                }\n            }\n            return t;\n        }\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n\n        var CLASS_NAMES = {\n            input: \"k-spreadsheet-name-editor\",\n            list: \"k-spreadsheet-name-list\"\n        };\n\n        var NameEditor = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element.addClass(CLASS_NAMES.input);\n\n                var comboBoxTitle = options.messages.nameBox || \"Name Box\";\n                var dataSource = new kendo.data.DataSource({\n                    transport: {\n                        read: function(options) {\n                            var data = [];\n                            this._workbook.forEachName(function(def){\n                                if (!def.hidden && def.value instanceof kendo.spreadsheet.Ref) {\n                                    data.push({ name: def.name });\n                                }\n                            });\n                            options.success(data);\n                        }.bind(this),\n                        cache: false\n                    }\n                });\n\n                var comboElement = $(\"<input />\")\n                    .attr(\"title\", comboBoxTitle)\n                    .attr(\"aria-label\", comboBoxTitle);\n\n                this.combo = comboElement.appendTo(element)\n                    .kendoComboBox({\n                        clearButton: false,\n                        dataTextField: \"name\",\n                        dataValueField: \"name\",\n                        template: \"#:data.name#<a role='button' class='k-button-delete' href='\\\\#'>\" + kendo.ui.icon(\"x\") + \"</a>\",\n                        dataSource: dataSource,\n                        autoBind: false,\n                        ignoreCase: true,\n                        change: this._on_listChange.bind(this),\n                        noDataTemplate: \"<div></div>\",\n                        open: function() {\n                            dataSource.read();\n                        }\n                    }).getKendoComboBox();\n\n                this.combo.input\n                    .on(\"keydown\", this._on_keyDown.bind(this))\n                    .on(\"focus\", this._on_focus.bind(this));\n\n                this.combo.popup.element\n                    .addClass(\"k-spreadsheet-names-popup\")\n\n                    .on(\"mousemove\", function(ev){\n                        // XXX: should remove this when we find a better\n                        // solution for the popup closing as we hover the\n                        // resize handles.\n                        ev.stopPropagation();\n                    })\n\n                    .on(\"click\", \".k-button-delete\", function(ev){\n                        ev.preventDefault();\n                        ev.stopPropagation();\n                        var item = $(ev.target).closest(\".k-list-item\");\n                        item = this.combo.dataItem(item);\n                        this._deleteItem(item.name);\n                    }.bind(this));\n            },\n            destroy: function() {\n                if (this.combo) {\n                    this.combo.destroy();\n                }\n\n                kendo.ui.Widget.fn.destroy.call(this);\n            },\n            value: function(val) {\n                if (val === undefined) {\n                    return this.combo.value();\n                } else {\n                    this.combo.value(val);\n                }\n            },\n            _deleteItem: function(name) {\n                this.trigger(\"delete\", { name: name });\n            },\n            _on_keyDown: function(ev) {\n                switch (ev.keyCode) {\n                  case 27:\n                    this.combo.value(this._prevValue);\n                    this.trigger(\"cancel\");\n                    break;\n                  case 13:\n                    this.trigger(\"enter\");\n                    break;\n                }\n            },\n            _on_focus: function() {\n                this._prevValue = this.combo.value();\n            },\n            _on_listChange: function() {\n                var name = this.combo.value();\n                if (name) {\n                    this.trigger(\"select\", { name: name });\n                }\n            }\n        });\n\n        kendo.spreadsheet.NameEditor = NameEditor;\n    })(window.kendo);\n\n    \"use strict\";\n\n        var spreadsheet = kendo.spreadsheet;\n        var CellRef = spreadsheet.CellRef;\n        var kdrw = kendo.drawing;\n        var formatting = spreadsheet.formatting;\n        var geo = kendo.geometry;\n\n        var GUIDELINE_WIDTH = 0.8;\n\n\n\n\n        // This takes a list of row heights and the page height, and\n        // produces a list of Y coordinates for each row, such that rows\n        // are not truncated across pages.  However, the algorithm will\n        // decide to truncate a row in the event that more than\n        // `maxEmpty` (default 0.2) of the available space would\n        // otherwise be left blank.\n        //\n        // It will be used for horizontal splitting too (will receive\n        // column widths and page width, and produce a list of X coords).\n        //\n        // If the third argument (headerRows) is not null, it specifies a\n        // number of rows to repeat on each page.  On pages other than the\n        // first, the necessary space will be skipped at the top.  Header\n        // coordinates (except for the first page) are pushed in\n        // headerCoords.\n        function distributeCoords(heights, pageHeight, maxEmpty, headerRows, headerCoords) {\n            var curr = 0;\n            var out = [];\n            var bottom = pageHeight;\n            var header = 0;\n            if (pageHeight && maxEmpty) {\n                maxEmpty *= pageHeight;\n            }\n            heights.forEach(function(h, i){\n                if (headerRows != null && i < headerRows) {\n                    header += h;\n                }\n                if (pageHeight && curr + h > bottom) {\n                    if (bottom - curr < maxEmpty) {\n                        // align to next page\n                        curr = pageHeight * Math.ceil(curr / pageHeight) + header;\n                        if (header > 0) {\n                            headerCoords.push(curr - header);\n                        }\n                    }\n                    // update bottom anyway; don't just add pageHeight, as\n                    // we might need multiple pages for the pathological\n                    // case of one row higher than the page.\n                    bottom += pageHeight * Math.ceil(h / pageHeight);\n                }\n                out.push(curr);\n                curr += h;\n            });\n            out.push(curr);\n            return out;\n        }\n\n        function doLayout(sheet, range, options) {\n            // normalize reference so we don't have to deal with Infinity here.\n            var grid = sheet._grid;\n            range = grid.normalize(range);\n\n            var wholeRect = grid.rectangle(range);\n            var drawings = [];\n            sheet._drawings.forEach(function(d) {\n                var box = sheet.drawingBoundingBox(d);\n                if (box.intersects(wholeRect)) {\n                    drawings.push({\n                        drawing: d,\n                        box: box.offset(-wholeRect.left, -wholeRect.top)\n                    });\n                }\n            });\n\n            // 1. obtain the list of cells that need to be printed, the\n            //    row heights and column widths.  Place in each cell row,\n            //    col (relative to range, i.e. first is 0,0), rowspan,\n            //    colspan and merged.  also place a list of drawings\n            //    anchored to that cell.\n            var cells = [];\n            var rowHeights = [];\n            var colWidths = [];\n            var mergedCells = sheet._getMergedCells(range);\n\n            var maxRow = -1, maxCol = -1;\n            sheet.forEach(range, function(row, col, cell){\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                var rh = sheet.rowHeight(row);\n                var cw = sheet.columnWidth(col);\n                if (!options.forScreen) {\n                    // for printing we'll need the list of anchored\n                    // drawings so that we can adjust them after page\n                    // splitting.\n                    cell.drawings = drawings.filter(function(d){\n                        var tl = d.drawing.topLeftCell;\n                        if (tl && tl.row == row && tl.col == col) {\n                            maxRow = Math.max(maxRow, sheet._rows.index(d.box.bottom));\n                            maxCol = Math.max(maxCol, sheet._columns.index(d.box.right));\n                            return true;\n                        }\n                    });\n                }\n                if (!relcol) {\n                    rowHeights.push(rh);\n                }\n                if (!relrow) {\n                    colWidths.push(cw);\n                }\n                var id = new CellRef(row, col).print();\n                if (mergedCells.secondary[id]) {\n                    return;\n                }\n                cell.row = relrow;\n                cell.col = relcol;\n                var m = mergedCells.primary[id];\n                if (m) {\n                    delete mergedCells.primary[id];\n                    cell.merged = true;\n                    cell.rowspan = m.height();\n                    cell.colspan = m.width();\n                    if (options.forScreen) {\n                        cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                        cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                    }\n                } else {\n                    cell.rowspan = 1;\n                    cell.colspan = 1;\n                }\n                if (!sheet._grid._columns.sum(col, col + cell.colspan - 1) ||\n                    !sheet._grid._rows.sum(row, row + cell.rowspan - 1)) {\n                    return;\n                }\n                var nonEmpty = options.forScreen || shouldDrawCell(cell);\n                if (!(options.emptyCells || nonEmpty)) {\n                    return;\n                }\n                if (nonEmpty) {\n                    maxRow = Math.max(maxRow, relrow + cell.rowspan - 1);\n                    maxCol = Math.max(maxCol, relcol + cell.colspan - 1);\n                } else {\n                    cell.empty = true;\n                }\n                cells.push(cell);\n            });\n\n            if (!options.forScreen) {\n                // keep only the drawable area\n                rowHeights = rowHeights.slice(0, maxRow + 1);\n                colWidths = colWidths.slice(0, maxCol + 1);\n            }\n\n            var pageWidth = options.pageWidth;\n            var pageHeight = options.pageHeight;\n            var scaleFactor = options.scale || 1;\n\n            // when fitWidth is requested, we must update the page size\n            // with the corresponding scale factor; the algorithm below\n            // (2) will continue to work, just drawing on a bigger page.\n            if (options.fitWidth) {\n                var width = colWidths.reduce(sum, 0);\n                if (width > pageWidth) {\n                    scaleFactor = pageWidth / width;\n                }\n            }\n            pageWidth = Math.ceil(pageWidth / scaleFactor);\n            pageHeight = Math.ceil(pageHeight / scaleFactor);\n\n            // 2. calculate top, left, bottom, right, width and height for\n            //    printable cells.  Merged cells will be split across\n            //    pages, unless the first row/col is shifted to next page.\n            //    boxWidth and boxHeight get the complete drawing size.\n            //    Note that cell coordinates keep increasing, i.e. they\n            //    are not reset to zero for a new page.  The print\n            //    function translates the view to current page.\n            var hyCoords = []; // will receive header Y coordinates, if needed\n            var yCoords = distributeCoords(rowHeights, pageHeight || 0, options.maxEmpty,\n                                           options.headerRows, hyCoords);\n            var xCoords = distributeCoords(colWidths, pageWidth || 0, options.maxEmpty);\n            var boxWidth = 0;\n            var boxHeight = 0;\n            var headerCells = [];\n            cells = cells.filter(function(cell){\n                if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                    return false;\n                }\n                if (options.headerRows && cell.row < options.headerRows) {\n                    headerCells.push(cell);\n                }\n                cell.left = xCoords[cell.col];\n                cell.top = yCoords[cell.row];\n                if (cell.merged) {\n                    if (!options.forScreen) {\n                        cell.right = orlast(xCoords, cell.col + cell.colspan);\n                        cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                        cell.width = cell.right - cell.left;\n                        cell.height = cell.bottom - cell.top;\n                    } else {\n                        cell.right = cell.left + cell.width;\n                        cell.bottom = cell.top + cell.height;\n                    }\n                } else {\n                    cell.width = colWidths[cell.col];\n                    cell.height = rowHeights[cell.row];\n                    cell.bottom = cell.top + cell.height;\n                    cell.right = cell.left + cell.width;\n                }\n                if (!options.forScreen) {\n                    // page breaking will shift cell coordinates.  adjust\n                    // anchored drawings.\n                    cell.drawings.forEach(function(d){\n                        var box = d.box;\n                        box.left = cell.left + d.drawing.offsetX;\n                        box.top = cell.top + d.drawing.offsetY;\n                        box.right = box.left + box.width;\n                        box.bottom = box.top + box.height;\n                    });\n                }\n                boxWidth = Math.max(boxWidth, cell.right);\n                boxHeight = Math.max(boxHeight, cell.bottom);\n                return true;\n            });\n\n            // 3. if any merged cells remain in \"primary\", they start\n            //    outside the printed range and we should still display\n            //    them partially.\n            Object.keys(mergedCells.primary).forEach(function(id){\n                var ref = mergedCells.primary[id];\n                sheet.forEach(ref.topLeft.toRangeRef(), function(row, col, cell){\n                    var relrow = row - range.topLeft.row;\n                    var relcol = col - range.topLeft.col;\n                    cell.merged = true;\n                    cell.colspan = ref.width();\n                    cell.rowspan = ref.height();\n                    if (relrow < 0) {\n                        cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                    } else {\n                        cell.top = yCoords[relrow];\n                    }\n                    if (relcol < 0) {\n                        cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                    } else {\n                        cell.left = xCoords[relcol];\n                    }\n                    cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                    cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                    if (cell.height > 0 && cell.width > 0) {\n                        // zero means a fully hidden merged cell (all rows/columns are hidden)\n                        // https://github.com/telerik/kendo-ui-core/issues/1794\n                        cell.right = cell.left + cell.width;\n                        cell.bottom = cell.top + cell.height;\n                        cell.row = relrow;\n                        cell.col = relcol;\n                        cells.push(cell);\n                    }\n                });\n            });\n\n            // 4. replicate header rows on all pages\n            if (options.headerRows) {\n                hyCoords.forEach(function(y){\n                    headerCells.forEach(function(cell){\n                        cell = clone(cell);\n                        cell.top += y;\n                        cell.bottom = cell.top + cell.height;\n                        cells.push(cell);\n                    });\n                    yCoords.push(y);\n                });\n                yCoords.sort(orderCoords);\n            }\n\n            return {\n                width    : boxWidth,\n                height   : boxHeight,\n                cells    : cells.sort(orderCells),\n                scale    : scaleFactor,\n                xCoords  : xCoords,\n                yCoords  : yCoords,\n                drawings : drawings\n            };\n        }\n\n        function clone(hash, target) {\n            if (!target) {\n                target = {};\n            }\n            if (Object.assign) {\n                return Object.assign(target, hash);\n            }\n            return Object.keys(hash).reduce(function(copy, key){\n                copy[key] = hash[key];\n                return copy;\n            }, target);\n        }\n\n        function sameBorder(a, b) {\n            return a.size === b.size && a.color === b.color;\n        }\n\n        function sum(a, b) {\n            return a + b;\n        }\n\n        function orlast(a, i) {\n            return i < a.length ? a[i] : a[a.length - 1];\n        }\n\n        function shouldDrawCell(cell) {\n            return cell.value != null\n                || cell.merged\n                || cell.background != null\n                || cell.borderRight != null\n                || cell.borderBottom != null\n                || cell.dBorders != null\n                || (cell.validation != null && !cell.validation.value)\n                || (cell.drawings && cell.drawings.length);\n        }\n\n        function orderCells(a, b) {\n            if (a.top < b.top) {\n                return -1;\n            } else if (a.top == b.top) {\n                if (a.left < b.left) {\n                    return -1;\n                } else if (a.left == b.left) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            } else {\n                return 1;\n            }\n        }\n\n        function orderCoords(a, b) {\n            return a < b ? -1 : a > b ? 1 : 0;\n        }\n\n        function drawLayout(sheet, layout, group, options) {\n            // options:\n            // - pageWidth\n            // - pageHeight\n            // - fitWidth\n            // - hCenter\n            // - vCenter\n            var ncols = Math.ceil(layout.width / options.pageWidth);\n            var nrows = Math.ceil(layout.height / options.pageHeight);\n            var pageWidth = Math.ceil(options.pageWidth / layout.scale);\n            var pageHeight = Math.ceil(options.pageHeight / layout.scale);\n\n            for (var j = 0; j < nrows; ++j) {\n                for (var i = 0; i < ncols; ++i) {\n                    addPage(j, i);\n                }\n            }\n\n            function addPage(row, col) {\n                var left = col * pageWidth;\n                var right = left + pageWidth;\n                var top = row * pageHeight;\n                var bottom = top + pageHeight;\n                var endbottom = 0, endright = 0;\n\n                function isInside(box) {\n                    if (box.right <= left || box.left >= right ||\n                        box.bottom <= top || box.top >= bottom) {\n                        return false;\n                    }\n                    endbottom = Math.max(box.bottom, endbottom);\n                    endright = Math.max(box.right, endright);\n                    return true;\n                }\n\n                // XXX: this can be optimized - discard cells that won't\n                // be used again, and don't walk cells that stand no\n                // chance to fit.\n                var cells = layout.cells.filter(isInside);\n\n                var drawings = layout.drawings.filter(function(d){\n                    return isInside(d.box);\n                });\n\n                // merged cells might stretch beyond page; limit to that\n                endbottom = Math.min(endbottom, bottom);\n                endright = Math.min(endright, right);\n\n                if (cells.length || drawings.length) {\n                    var page = new kdrw.Group();\n                    group.append(page);\n                    // page.clip(drawing.Path.fromRect(\n                    //     new geo.Rect([ 0, 0 ],\n                    //                  [ options.pageWidth, options.pageHeight ])));\n\n                    var content = new kdrw.Group();\n                    page.append(content);\n\n                    content.clip(kdrw.Path.fromRect(\n                        new geo.Rect([ left - 1, top - 1 ], [ endright + 1, endbottom + 1 ])\n                    ));\n\n                    var matrix = geo.Matrix.scale(layout.scale, layout.scale)\n                        .multiplyCopy(geo.Matrix.translate(-left, -top));\n\n                    if (options.hCenter || options.vCenter) {\n                        matrix = matrix.multiplyCopy(\n                            geo.Matrix.translate(\n                                options.hCenter ? (right - endright) / 2 : 0,\n                                options.vCenter ? (bottom - endbottom) / 2 : 0)\n                        );\n                    }\n\n                    content.transform(matrix);\n\n                    if (options.guidelines) {\n                        var prev = null;\n                        layout.xCoords.forEach(function(x){\n                            x = Math.min(x, endright);\n                            if (x !== prev && x >= left && x <= right) {\n                                prev = x;\n                                content.append(\n                                    new kdrw.Path()\n                                        .moveTo(x, top)\n                                        .lineTo(x, endbottom)\n                                        .close()\n                                        .stroke(options.guideColor, GUIDELINE_WIDTH)\n                                );\n                            }\n                        });\n                        var prev = null;\n                        layout.yCoords.forEach(function(y){\n                            y = Math.min(y, endbottom);\n                            if (y !== prev && y >= top && y <= bottom) {\n                                prev = y;\n                                content.append(\n                                    new kdrw.Path()\n                                        .moveTo(left, y)\n                                        .lineTo(endright, y)\n                                        .close()\n                                        .stroke(options.guideColor, GUIDELINE_WIDTH)\n                                );\n                            }\n                        });\n                    }\n\n                    var borders = Borders(); \n                    cells.forEach(function(cell){\n                        drawCell(cell, content, options);\n                        borders.add(cell, sheet);\n                    });\n\n                    var bordersGroup = new kdrw.Group();\n                    borders.vert.forEach(function(a){\n                        a.forEach(function(b){\n                            if (!b.rendered) {\n                                b.rendered = true;\n                                bordersGroup.append(\n                                    new kdrw.Path()\n                                        .moveTo(b.x, b.top)\n                                        .lineTo(b.x, b.bottom)\n                                        .close()\n                                        .stroke(b.color, b.size)\n                                );\n                            }\n                        });\n                    });\n                    borders.horiz.forEach(function(a){\n                        a.forEach(function(b){\n                            if (!b.rendered) {\n                                b.rendered = true;\n                                bordersGroup.append(\n                                    new kdrw.Path()\n                                        .moveTo(b.left, b.y)\n                                        .lineTo(b.right, b.y)\n                                        .close()\n                                        .stroke(b.color, b.size)\n                                );\n                            }\n                        });\n                    });\n                    content.append(bordersGroup);\n\n                    drawings.forEach(function(d){\n                        var drawing = d.drawing;\n                        var image = drawing.image;\n                        if (image != null) {\n                            var box = d.box;\n                            var url = sheet._workbook.imageUrl(image);\n                            content.append(\n                                new kdrw.Image(url, new geo.Rect(\n                                    [ box.left, box.top ],\n                                    [ box.width, box.height ]\n                                )).opacity(drawing.opacity)\n                            );\n                        }\n                    });\n                }\n            }\n        }\n\n        function drawCell(cell, content, options) {\n            var g = new kdrw.Group();\n            content.append(g);\n            var rect = new geo.Rect([ cell.left, cell.top ],\n                                    [ cell.width, cell.height ]);\n            if (cell.background || cell.merged) {\n                var r2d2 = rect;\n                if (options.guidelines) {\n                    r2d2 = rect.clone();\n                    r2d2.origin.x += GUIDELINE_WIDTH/2 + 0.1;\n                    r2d2.origin.y += GUIDELINE_WIDTH/2 + 0.1;\n                    r2d2.size.width -= GUIDELINE_WIDTH + 0.2;\n                    r2d2.size.height -= GUIDELINE_WIDTH + 0.2;\n                }\n                g.append(\n                    new kdrw.Rect(r2d2)\n                        .fill(cell.background || \"#fff\")\n                        .stroke(null)\n                );\n            }\n            if (cell.dBorders) {\n                if (cell.dBorders.type & 2) {\n                    g.append(\n                        new kdrw.Path()\n                            .moveTo(cell.left, cell.bottom)\n                            .lineTo(cell.right, cell.top)\n                            .stroke(cell.dBorders.color, cell.dBorders.size)\n                    );\n                }\n                if (cell.dBorders.type & 1) {\n                    g.append(\n                        new kdrw.Path()\n                            .moveTo(cell.left, cell.top)\n                            .lineTo(cell.right, cell.bottom)\n                            .stroke(cell.dBorders.color, cell.dBorders.size)\n                    );\n                }\n            }\n            var val = cell.value;\n            if (val != null) {\n                var type = typeof val == \"number\" ? \"number\" : null;\n                var clip = new kdrw.Group();\n                clip.clip(kdrw.Path.fromRect(rect));\n                g.append(clip);\n                var f, format = cell.format;\n                if (!format && type == \"number\" && val != Math.floor(val)) {\n                    format = \"0.##############\";\n                }\n                if (format) {\n                    f = formatting.textAndColor(val, format);\n                    val = f.text;\n                    if (f.type) {\n                        type = f.type;\n                    }\n                } else {\n                    val += \"\";\n                }\n                if (!cell.textAlign) {\n                    switch (type) {\n                      case \"number\":\n                      case \"date\":\n                      case \"percent\":\n                      case \"currency\":\n                        cell.textAlign = \"right\";\n                        break;\n                      case \"boolean\":\n                        cell.textAlign = \"center\";\n                        break;\n                    }\n                }\n                drawText(val, (f && f.color) || cell.color || \"#000\", cell, clip);\n            }\n        }\n\n        function applyIndent(cell, style) {\n            if (cell.indent) {\n                // OOXML spec states the indent is \"An integer value,\n                // where an increment of 1 represents 3 spaces\".  This, of\n                // course, bears no resemblance to what Excel actually\n                // does, so we need magic numbers here.\n                var indent = 1.4 * cell.indent;\n                switch (style.textAlign) {\n                  case null:\n                  case \"left\":\n                    style.paddingLeft = indent + \"ch\";\n                    break;\n                  case \"right\":\n                    style.paddingRight = indent + \"ch\";\n                    break;\n                  case \"center\":\n                    style.paddingLeft = indent/2 + \"ch\";\n                    style.paddingRight = indent/2 + \"ch\";\n                    break;\n                }\n            }\n        }\n\n        var CONT;\n        function drawText(text, color, cell, group) {\n            if (!CONT) {\n                CONT = document.createElement(\"div\");\n                CONT.style.position = \"fixed\";\n                CONT.style.left = \"0px\";\n                CONT.style.top = \"0px\";\n                CONT.style.visibility = \"hidden\";\n                CONT.style.overflow = \"hidden\";\n                CONT.style.boxSizing = \"border-box\";\n                CONT.style.lineHeight = \"normal\";\n                document.body.appendChild(CONT);\n            }\n\n            if (CONT.firstChild) {\n                CONT.removeChild(CONT.firstChild);\n            }\n\n            CONT.style.padding = \"2px 4px\";\n            CONT.style.color = color;\n            CONT.style.font = makeFontDef(cell);\n            CONT.style.width = cell.width + \"px\";\n            CONT.style.textAlign = cell.textAlign || \"left\";\n            CONT.style.textDecoration = cell.underline ? \"underline\" : \"none\";\n\n            applyIndent(cell, CONT.style);\n\n            if (cell.wrap) {\n                CONT.style.whiteSpace = \"pre-wrap\";\n                CONT.style.overflowWrap = CONT.style.wordWrap = \"break-word\";\n            } else {\n                CONT.style.whiteSpace = \"pre\";\n                CONT.style.overflowWrap = CONT.style.wordWrap = \"normal\";\n            }\n\n            CONT.appendChild(document.createTextNode(text));\n\n            var vtrans = 0;\n            switch (cell.verticalAlign) {\n              case \"center\":\n                vtrans = (cell.height - CONT.offsetHeight) >> 1;\n                break;\n\n              case undefined:\n              case null:\n              case \"bottom\":\n                vtrans = (cell.height - CONT.offsetHeight);\n                break;\n            }\n            if (vtrans < 0) { vtrans = 0; }\n\n            var text_group  = kendo.drawing.drawDOM.drawText(CONT);\n            text_group.transform(geo.Matrix.translate(cell.left, cell.top + vtrans));\n            group.append(text_group);\n        }\n\n        function makeFontDef(cell) {\n            var font = [];\n            if (cell.italic) {\n                font.push(\"italic\");\n            }\n            if (cell.bold) {\n                font.push(\"bold\");\n            }\n            font.push((cell.fontSize || 12) + \"px\");\n            font.push((cell.fontFamily || \"Arial\"));\n            return font.join(\" \");\n        }\n\n        function draw(sheet, range, options, callback) {\n            if (options == null && callback == null) {\n                callback = range;\n                options = {};\n                range = spreadsheet.SHEETREF;\n            }\n            if (callback == null) {\n                callback = options;\n                if (range instanceof spreadsheet.Range\n                    || range instanceof spreadsheet.Ref\n                    || typeof range == \"string\") {\n                    options = {};\n                } else {\n                    options = range;\n                    range = spreadsheet.SHEETREF;\n                }\n            }\n            options = kendo.jQuery.extend({\n                paperSize  : \"A4\",\n                landscape  : true,\n                margin     : \"1cm\",\n                guidelines : true,\n                guideColor : \"#aaa\",\n                emptyCells : true,\n                fitWidth   : false,\n                center     : false,\n                headerRows : null,\n                maxEmpty   : 0.2,\n                scale      : 1\n            }, options);\n            var group = new kdrw.Group();\n            var paper = kendo.pdf.getPaperOptions(options);\n            group.options.set(\"pdf\", {\n                author    : options.author,\n                creator   : options.creator,\n                date      : options.date,\n                keywords  : options.keywords,\n                margin    : paper.margin,\n                multiPage : true,\n                paperSize : paper.paperSize,\n                subject   : options.subject,\n                title     : options.title,\n                autoPrint : options.autoPrint\n            });\n            var pageWidth = paper.paperSize[0];\n            var pageHeight = paper.paperSize[1];\n            if (paper.margin) {\n                pageWidth -= paper.margin.left + paper.margin.right + 1;\n                pageHeight -= paper.margin.top + paper.margin.bottom + 1;\n            }\n            options.pageWidth = pageWidth;\n            options.pageHeight = pageHeight;\n            var layout = doLayout(sheet, sheet._ref(range), options);\n            drawLayout(sheet, layout, group, options);\n            callback(group);\n        }\n\n        spreadsheet.Sheet.prototype.draw = function(range, options, callback) {\n            var sheet = this;\n            if (sheet._workbook) {\n                sheet.recalc(sheet._workbook._context, function(){\n                    draw(sheet, range, options, callback);\n                });\n            } else {\n                draw(sheet, range, options, callback);\n            }\n        };\n\n        // Hack: since we index the border arrays by relative row/col we\n        // could end up with negative indexes, i.e. horiz[-2] = border.\n        // Array forEach will ignore these, so we provide a simple\n        // container here (outside code only needs forEach at this time).\n        function Container() {}\n        Container.prototype = {\n            forEach: function(f) {\n                Object.keys(this).forEach(function(key){\n                    f(this[key], key, this);\n                }, this);\n            }\n        };\n\n        function Borders() {\n            var horiz = new Container();\n            var vert = new Container();\n            function add(cell, sheet) {\n                if (sheet) {\n                    // reset borders here; the propertybag doesn't keep track of merged cells :-/ this\n                    // is ugly, but the inner details of data storage have leaked everywhere anyway.\n                    var pb = sheet._properties;\n                    var grid = sheet._grid;\n                    cell.borderLeft    = pb.get(\"vBorders\", grid.index(cell.row, cell.col));\n                    cell.borderRight   = pb.get(\"vBorders\", grid.index(cell.row, cell.col + cell.colspan));\n                    cell.borderTop     = pb.get(\"hBorders\", grid.index(cell.row, cell.col));\n                    cell.borderBottom  = pb.get(\"hBorders\", grid.index(cell.row + cell.rowspan, cell.col));\n                }\n                if (cell.borderLeft) {\n                    addVert(cell.row, cell.col, cell.borderLeft,\n                            cell.left, cell.top, cell.bottom);\n                }\n                if (cell.borderRight) {\n                    addVert(cell.row, cell.col + cell.colspan, cell.borderRight,\n                            cell.right, cell.top, cell.bottom);\n                }\n                if (cell.borderTop) {\n                    addHoriz(cell.row, cell.col, cell.borderTop,\n                             cell.top, cell.left, cell.right);\n                }\n                if (cell.borderBottom) {\n                    addHoriz(cell.row + cell.rowspan, cell.col, cell.borderBottom,\n                             cell.bottom, cell.left, cell.right);\n                }\n            }\n            function addVert(row, col, border, x, top, bottom) {\n                var a = vert[col] || (vert[col] = new Container());\n                var prev = row > 0 && a[row - 1];\n                if (prev && sameBorder(prev, border)) {\n                    a[row] = prev;\n                    prev.bottom = bottom;\n                } else {\n                    a[row] = {\n                        size: border.size,\n                        color: border.color || \"#000\",\n                        x: x,\n                        top: top,\n                        bottom: bottom\n                    };\n                }\n            }\n            function addHoriz(row, col, border, y, left, right) {\n                var a = horiz[row] || (horiz[row] = new Container());\n                var prev = col > 0 && a[col - 1];\n                if (prev && sameBorder(prev, border)) {\n                    a[col] = prev;\n                    prev.right = right;\n                } else {\n                    a[col] = {\n                        size: border.size,\n                        color: border.color || \"#000\",\n                        y: y,\n                        left: left,\n                        right: right\n                    };\n                }\n            }\n            return { add: add, horiz: horiz, vert: vert };\n        }\n\n        function drawTabularData(options) {\n            var progress = new $.Deferred();\n            var promise = progress.promise();\n\n            options = clone(options, {\n                dataSource       : null,\n                guidelines       : true,\n                guideColor       : \"#000\",\n                columns          : null,\n                headerBackground : \"#999\",\n                headerColor      : \"#000\",\n                oddBackground    : null,\n                evenBackground   : null,\n                fontFamily       : \"Arial\",\n                fontSize         : 12,\n                paperSize        : \"A4\",\n                margin           : \"1cm\",\n                landscape        : true,\n                fitWidth         : false,\n                scale            : 1,\n                rowHeight        : 20,\n                maxEmpty         : 1,\n                useGridFormat    : true\n            });\n\n            // retrieve fonts; custom fonts should be already loaded\n            kendo.drawing.pdf.defineFont(\n                kendo.drawing.drawDOM.getFontFaces(document)\n            );\n\n            var charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n\n            function textWidth(value) {\n                if (value != null) {\n                    var width = 12;         // magic numbers :-/\n                    for (var i = value.length; --i >= 0;) {\n                        width += charWidth(value.charAt(i));\n                    }\n                    return width;\n                }\n                return 0;\n            }\n\n            var border = options.guidelines ? { size: 1, color: options.guideColor } : null;\n\n            function mkCell(data) {\n                if (!border) {\n                    return data;\n                }\n                return clone(data, {\n                    borderLeft: border,\n                    borderTop: border,\n                    borderRight: border,\n                    borderBottom: border\n                });\n            }\n\n            options.dataSource.fetch(function(){\n                var data = options.dataSource.data();\n                if (!data.length) {\n                    return progress.reject(\"Empty dataset\");\n                }\n\n                // this really must be present\n                var columns = options.columns.map(function(col){\n                    if (typeof col == \"string\") {\n                        return { title: col, field: col };\n                    } else {\n                        return col;\n                    }\n                });\n                var columnTitles = columns.map(function(col){\n                    return col.title || col.field;\n                });\n                var columnWidths = columnTitles.map(textWidth);\n\n                // prepare data for a Sheet object's fromJSON method\n                var rows = data.map(function(row, rowIndex){\n                    return {\n                        cells: columns.map(function(col, colIndex){\n                            var value = row[col.field];\n\n                            // NOTE: value might not be string.  I added option useGridFormat (default\n                            // true), which will use a column's format, if present, to convert the value\n                            // to a string, so that we can measure the width right now.\n                            if (options.useGridFormat) {\n                                if (value != null) {\n                                    if (col.format) {\n                                        value = kendo.format(col.format, value);\n                                    } else {\n                                        value += \"\";\n                                    }\n                                }\n                                // adjust the column widths while we're at it\n                                columnWidths[colIndex] = Math.max(\n                                    textWidth(value),\n                                    columnWidths[colIndex]\n                                );\n                            }\n\n                            // if options.useGridFormat is false and col.format is present, pass it over\n                            // to the spreadsheet.  In that case we should calculate the widths after\n                            // the spreadsheet is created (XXX to be implemented when someone needs it).\n                            return mkCell({\n                                value: value,\n                                format: options.useGridFormat ? null : col.format,\n                                background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n                            });\n                        })\n                    };\n                });\n\n                // insert header line\n                rows.unshift({\n                    cells: columnTitles.map(function(label){\n                        return mkCell({\n                            value: label,\n                            background: options.headerBackground,\n                            color: options.headerColor\n                        });\n                    })\n                });\n\n                // init a Sheet object.  Note that we have to add one\n                // extra-row and column, because the very last ones can't\n                // have right/bottom borders (known limitation).\n                var sheet = new kendo.spreadsheet.Sheet(\n                    rows.length + 1,        // rows\n                    columns.length + 1,     // columns\n                    options.rowHeight,      // row height\n                    50,                     // column width\n                    20,                     // header height\n                    20,                     // header width,\n                    {                       // default cell style\n                        fontFamily: options.fontFamily,\n                        fontSize: options.fontSize,\n                        verticalAlign: \"center\"\n                    }\n                );\n\n                // load data\n                sheet.fromJSON({\n                    name: \"Sheet1\",\n                    rows: rows,\n                    columns: columnWidths.map(function(w, i){\n                        return { index: i, width: w };\n                    })\n                });\n\n                sheet.draw({\n                    paperSize  : options.paperSize,\n                    landscape  : options.landscape,\n                    margin     : options.margin,\n                    guidelines : false, // using borders instead (better contrast)\n                    scale      : options.scale,\n                    fitWidth   : options.fitWidth,\n                    maxEmpty   : options.maxEmpty,\n                    headerRows : 1\n                }, progress.resolve.bind(progress));\n            });\n\n            return promise;\n        }\n\n        var CACHE_CHAR_WIDTH = {};\n\n        var charWidthFunction = function(fontFamily, fontSize) {\n            var id = fontSize + \":\" + fontFamily;\n            var func = CACHE_CHAR_WIDTH[id];\n            if (!func) {\n                var span, div = document.createElement(\"div\");\n                div.style.position = \"fixed\";\n                div.style.left = \"-10000px\";\n                div.style.top = \"-10000px\";\n                div.style.fontFamily = fontFamily;\n                div.style.fontSize = fontSize + \"px\";\n                div.style.whiteSpace = \"pre\";\n                for (var i = 32; i < 128; ++i) {\n                    span = document.createElement(\"span\");\n                    span.appendChild(document.createTextNode(String.fromCharCode(i)));\n                    div.appendChild(span);\n                }\n                document.body.appendChild(div);\n                var widths = {};\n                for (i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n                    widths[i] = span.offsetWidth;\n                }\n                while ((span = div.firstChild)) {\n                    div.removeChild(span);\n                }\n                func = CACHE_CHAR_WIDTH[id] = function(ch) {\n                    var code = ch.charCodeAt(0);\n                    var width = widths[code];\n                    if (width == null) {\n                        // probably not an ASCII character, let's cache its width as well\n                        span = document.createElement(\"span\");\n                        span.appendChild(document.createTextNode(String.fromCharCode(code)));\n                        div.appendChild(span);\n                        width = widths[code] = span.offsetWidth;\n                        div.removeChild(span);\n                    }\n                    return width;\n                };\n            }\n            return func;\n        };\n\n        spreadsheet.draw = {\n            Borders         : Borders,\n            doLayout        : doLayout,\n            applyIndent     : applyIndent\n        };\n\n        spreadsheet.drawTabularData = drawTabularData;\n\n    var __meta__ = {\n            id: \"spreadsheet\",\n            name: \"Spreadsheet\",\n            category: \"web\",\n            description: \"Spreadsheet component\",\n            depends: [\n                \"core\", \"binder\", \"colorpicker\", \"combobox\", \"data\", \"dom\", \"dropdownlist\",\n                \"menu\", \"ooxml\", \"popup\", \"sortable\", \"tabstrip\", \"toolbar\", \"treeview\",\n                \"window\", \"validator\", \"excel\", \"pdf\", \"drawing\" ]\n        };\n\n        (function(kendo, undefined$1) {\n            if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n                return;\n            }\n\n            var $ = kendo.jQuery;\n            var keys = $.extend({ F11: 122, B: 66, I: 73, U: 85, N: 78, H: 72, A: 65, PAGEDOWN: 34, PAGEUP: 33, DELETE: 46, R: 82 }, kendo.keys);\n            var Widget = kendo.ui.Widget;\n            var Workbook = kendo.spreadsheet.Workbook;\n            var Controller = kendo.spreadsheet.Controller;\n            var View = kendo.spreadsheet.View;\n            var NS = \".kendoSpreadsheet\";\n\n            var ALL_REASONS = {\n                recalc: true,\n                selection: true,\n                activeCell: true,\n                layout: true,\n                sheetSelection: true,\n                resize: true,\n                editorChange: false,\n                editorClose: false\n            };\n\n            var classNames = {\n                wrapper: \"k-widget k-spreadsheet k-spreadsheet-legacy\"\n            };\n\n            var Spreadsheet = kendo.ui.Widget.extend({\n                init: function(element, options) {\n                    Widget.fn.init.call(this, element, options);\n\n                    kendo.spreadsheet.loadDeferred();\n\n                    this.element.addClass(Spreadsheet.classNames.wrapper);\n                    this.element.attr(\"role\", \"application\");\n\n                    this._view = new View(this.element, {\n                        messages: this.options.messages.view,\n                        toolbar: this.options.toolbar,\n                        sheetsbar: this.options.sheetsbar\n                    });\n\n                    this._workbook = new Workbook(this.options, this._view);\n\n                    this._controller = new Controller(this._view, this._workbook);\n\n                    this._autoRefresh = true;\n\n                    this._bindWorkbookEvents();\n\n                    this._view.workbook(this._workbook);\n\n                    this._view.enableClipboard(false);\n                    this.refresh();\n                    this._view.enableClipboard(true);\n\n                    this._resizeHandler = function() { this.resize(); }.bind(this);\n                    $(window).on(\"resize\" + NS, this._resizeHandler);\n\n                    this.element.on(\"keydown\" + NS, this._keyDown.bind(this));\n\n                    if (this._showWatermarkOverlay) {\n                        this._showWatermarkOverlay(this.element[0]);\n                    }\n                },\n\n                _keyDown: function(e) {\n                    var key = e.keyCode;\n\n                    if (key === keys.F11 && e.shiftKey) {\n                        this._view.sheetsbar._onAddSelect();\n                        e.preventDefault();\n                        return;\n                    } else if (e.altKey && key === keys.PAGEDOWN) {\n                        this._view.sheetsbar.trigger(\"select\", {\n                            name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex + 1].name(),\n                            isAddButton: false\n                        });\n                    } else if (e.altKey && key === keys.PAGEUP) {\n                        this._view.sheetsbar.trigger(\"select\", {\n                            name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex - 1].name(),\n                            isAddButton: false\n                        });\n                    } else if (e.altKey && key === keys.DELETE) {\n                        var closeCallback = function(e) {\n                            var dlg = e.sender;\n\n                            if (dlg.isConfirmed()) {\n                                this._view.sheetsbar.trigger(\"remove\", { name: this.activeSheet()._name(), confirmation: true });\n                            }\n                        }.bind(this);\n\n                        this._view.sheetsbar._openDialog(\"confirmation\", {\n                            close: closeCallback\n                        });\n                        e.preventDefault();\n                        return;\n                    } else if (e.altKey && key === keys.R) {\n                        this._view.sheetsbar._createEditor();\n                        e.preventDefault();\n                        return;\n                    } else if (e.ctrlKey && key === keys.B) {\n                        $(\"[data-property=bold]\")[0].click();\n                    } else if (e.ctrlKey && key === keys.I) {\n                        $(\"[data-property=italic]\")[0].click();\n                    } else if (e.ctrlKey && key === keys.U) {\n                        $(\"[data-property=underline]\")[0].click();\n                    } else if (e.altKey && key === keys.H) {\n                        this._view.tabstrip.select(0);\n                        e.preventDefault();\n                        return;\n                    } else if (e.altKey && key === keys.N) {\n                        this._view.tabstrip.select(1);\n                        e.preventDefault();\n                        return;\n                    } else if (e.altKey && key === keys.A) {\n                        this._view.tabstrip.select(2);\n                        e.preventDefault();\n                        return;\n                    } else if (key === keys.F10) {\n                        e.preventDefault();\n                        this._view.tabstrip.wrapper.find(\".k-tabstrip-content.k-active .k-toolbar [tabindex=0]\").trigger(\"focus\");\n                    }\n                },\n\n                _resize: function() {\n                    this.refresh({ layout: true });\n                },\n\n                _workbookChanging: function(e) {\n                    if (this.trigger(\"changing\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookChange: function(e) {\n                    if (this._autoRefresh) {\n                        this.refresh(e);\n                    }\n\n                    if (e.recalc && e.ref) {\n                        var range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                        this.trigger(\"change\", { range: range });\n                    }\n                },\n\n                _workbookCut: function(e) {\n                    this.trigger(\"cut\", e);\n                },\n\n                _workbookCopy: function(e) {\n                    this.trigger(\"copy\", e);\n                },\n\n                _workbookPaste: function(e) {\n                    this.trigger(\"paste\", e);\n                },\n\n                activeSheet: function(sheet) {\n                    return this._workbook.activeSheet(sheet);\n                },\n\n                moveSheetToIndex: function(sheet, index) {\n                    return this._workbook.moveSheetToIndex(sheet, index);\n                },\n\n                insertSheet: function(options) {\n                    return this._workbook.insertSheet(options);\n                },\n\n                sheets: function() {\n                    return this._workbook.sheets();\n                },\n\n                removeSheet: function(sheet) {\n                    return this._workbook.removeSheet(sheet);\n                },\n\n                sheetByName: function(sheetName) {\n                    return this._workbook.sheetByName(sheetName);\n                },\n\n                sheetIndex: function(sheet) {\n                    return this._workbook.sheetIndex(sheet);\n                },\n\n                sheetByIndex: function(index) {\n                    return this._workbook.sheetByIndex(index);\n                },\n\n                renameSheet: function(sheet, newSheetName) {\n                    return this._workbook.renameSheet(sheet, newSheetName);\n                },\n\n                refresh: function(reason) {\n                    if (!reason) {\n                        reason = ALL_REASONS;\n                    }\n\n                    if (!reason.editorClose) {\n                        this._view.sheet(this._workbook.activeSheet());\n                        this._controller.sheet(this._workbook.activeSheet());\n\n                        this._workbook.refresh(reason);\n                    }\n\n                    if (!reason.editorChange) {\n                        this._view.refresh(reason);\n                        this._controller.refresh();\n\n                        this._view.render(reason);\n                        this.trigger(\"render\");\n                    }\n\n                    return this;\n                },\n\n                openDialog: function(name, options) {\n                    return this._view.openDialog(name, options);\n                },\n\n                autoRefresh: function(value) {\n                    if (value !== undefined$1) {\n                        this._autoRefresh = value;\n\n                        if (value === true) {\n                            this.refresh();\n                        }\n\n                        return this;\n                    }\n\n                    return this._autoRefresh;\n                },\n\n                toJSON: function() {\n                    return this._workbook.toJSON();\n                },\n\n                fromJSON: function(json) {\n                    if (json.sheets) {\n                        this._workbook.destroy();\n\n                        this._workbook = new Workbook($.extend({}, this.options, json));\n\n                        this._bindWorkbookEvents();\n\n                        this._view.workbook(this._workbook);\n                        this._controller.workbook(this._workbook);\n\n                        this.activeSheet(this.activeSheet());\n                    } else {\n                        this.refresh();\n                    }\n                },\n\n                saveJSON: function() {\n                    return this._workbook.saveJSON();\n                },\n\n                fromFile: function(blob, name) {\n                    return this._workbook.fromFile(blob, name);\n                },\n\n                saveAsPDF: function(options) {\n                    this._workbook.saveAsPDF(\n                        $.extend({}, this.options.pdf, options, { workbook: this._workbook })\n                    );\n                },\n\n                saveAsExcel: function(options) {\n                    this._workbook.saveAsExcel(options);\n                },\n\n                draw: function(options, callback) {\n                    this._workbook.draw(options, callback);\n                },\n\n                _workbookExcelExport: function(e) {\n                    if (this.trigger(\"excelExport\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookExcelImport: function(e) {\n                    if (this.trigger(\"excelImport\", e)) {\n                        e.preventDefault();\n                    } else {\n                        this._initProgress(e.promise);\n                    }\n                },\n\n                _initProgress: function(deferred) {\n                    var loading =\n                        $(\"<div class='k-loading-mask' \" +\n                               \"style='width: 100%; height: 100%; top: 0;'>\" +\n                            \"<div class='k-loading-color'></div>\" +\n                        \"</div>\")\n                        .appendTo(this.element);\n\n                    var pb = $(\"<div class='k-loading-progress'>\")\n                    .appendTo(loading)\n                    .kendoProgressBar({\n                        type: \"chunk\", chunkCount: 10,\n                        min: 0, max: 1, value: 0\n                    }).data(\"kendoProgressBar\");\n\n                    deferred.progress(function(e) {\n                        pb.value(e.progress);\n                    })\n                    .always(function() {\n                        kendo.destroy(loading);\n                        loading.remove();\n                    });\n                },\n\n                _workbookPdfExport: function(e) {\n                    if (this.trigger(\"pdfExport\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookInsertSheet: function(e) {\n                    if (this.trigger(\"insertSheet\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookRemoveSheet: function(e) {\n                    if (this.trigger(\"removeSheet\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookSelectSheet: function(e) {\n                    if (this.trigger(\"selectSheet\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookRenameSheet: function(e) {\n                    if (this.trigger(\"renameSheet\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookInsertRow: function(e) {\n                    if (this.trigger(\"insertRow\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookInsertColumn: function(e) {\n                    if (this.trigger(\"insertColumn\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookDeleteRow: function(e) {\n                    if (this.trigger(\"deleteRow\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookDeleteColumn: function(e) {\n                    if (this.trigger(\"deleteColumn\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookHideRow: function(e) {\n                    if (this.trigger(\"hideRow\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookHideColumn: function(e) {\n                    if (this.trigger(\"hideColumn\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookUnhideRow: function(e) {\n                    if (this.trigger(\"unhideRow\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookUnhideColumn: function(e) {\n                    if (this.trigger(\"unhideColumn\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookSelect: function(e) {\n                    this.trigger(\"select\", e);\n                },\n\n                _workbookChangeFormat: function(e) {\n                   this.trigger(\"changeFormat\", e);\n                },\n\n                _workbookDataBinding: function(e) {\n                    if (this.trigger(\"dataBinding\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookDataBound: function(e) {\n                    this.trigger(\"dataBound\", e);\n                },\n\n                _workbookProgress: function(e) {\n                    kendo.ui.progress(this.element, e.toggle);\n                },\n\n                _bindWorkbookEvents: function() {\n                    this._workbook.bind(\"cut\", this._workbookCut.bind(this));\n                    this._workbook.bind(\"copy\", this._workbookCopy.bind(this));\n                    this._workbook.bind(\"paste\", this._workbookPaste.bind(this));\n                    this._workbook.bind(\"changing\", this._workbookChanging.bind(this));\n                    this._workbook.bind(\"change\", this._workbookChange.bind(this));\n                    this._workbook.bind(\"excelExport\", this._workbookExcelExport.bind(this));\n                    this._workbook.bind(\"excelImport\", this._workbookExcelImport.bind(this));\n                    this._workbook.bind(\"pdfExport\", this._workbookPdfExport.bind(this));\n                    this._workbook.bind(\"insertSheet\", this._workbookInsertSheet.bind(this));\n                    this._workbook.bind(\"removeSheet\", this._workbookRemoveSheet.bind(this));\n                    this._workbook.bind(\"selectSheet\", this._workbookSelectSheet.bind(this));\n                    this._workbook.bind(\"renameSheet\", this._workbookRenameSheet.bind(this));\n                    this._workbook.bind(\"insertRow\", this._workbookInsertRow.bind(this));\n                    this._workbook.bind(\"insertColumn\", this._workbookInsertColumn.bind(this));\n                    this._workbook.bind(\"deleteRow\", this._workbookDeleteRow.bind(this));\n                    this._workbook.bind(\"deleteColumn\", this._workbookDeleteColumn.bind(this));\n                    this._workbook.bind(\"hideRow\", this._workbookHideRow.bind(this));\n                    this._workbook.bind(\"hideColumn\", this._workbookHideColumn.bind(this));\n                    this._workbook.bind(\"unhideRow\", this._workbookUnhideRow.bind(this));\n                    this._workbook.bind(\"unhideColumn\", this._workbookUnhideColumn.bind(this));\n                    this._workbook.bind(\"select\", this._workbookSelect.bind(this));\n                    this._workbook.bind(\"changeFormat\", this._workbookChangeFormat.bind(this));\n                    this._workbook.bind(\"dataBinding\", this._workbookDataBinding.bind(this));\n                    this._workbook.bind(\"dataBound\", this._workbookDataBound.bind(this));\n                    this._workbook.bind(\"progress\", this._workbookProgress.bind(this));\n                },\n\n                destroy: function() {\n                    kendo.ui.Widget.fn.destroy.call(this);\n\n                    this._workbook.destroy();\n                    this._controller.destroy();\n                    this._view.destroy();\n\n                    if (this._resizeHandler) {\n                        $(window).off(\"resize\" + NS, this._resizeHandler);\n                    }\n                },\n\n                options: {\n                    name: \"Spreadsheet\",\n                    toolbar: true,\n                    sheetsbar: true,\n                    rows: 200,\n                    columns: 50,\n                    rowHeight: 20,\n                    columnWidth: 64,\n                    headerHeight: 20,\n                    headerWidth: 32,\n                    excel: {\n                        proxyURL: \"\",\n                        fileName: \"Workbook.xlsx\"\n                    },\n                    messages: {},\n                    pdf: {\n                        // which part of the workbook to be exported\n                        area: \"workbook\",\n                        fileName: \"Workbook.pdf\",\n                        proxyURL: \"\",\n                        // paperSize can be an usual name, i.e. \"A4\", or an array of two Number-s specifying the\n                        // width/height in points (1pt = 1/72in), or strings including unit, i.e. \"10mm\".  Supported\n                        // units are \"mm\", \"cm\", \"in\" and \"pt\".  The default \"auto\" means paper size is determined\n                        // by content.\n                        paperSize: \"a4\",\n                        // True to reverse the paper dimensions if needed such that width is the larger edge.\n                        landscape: true,\n                        // An object containing { left, top, bottom, right } margins with units.\n                        margin: null,\n                        // Optional information for the PDF Info dictionary; all strings except for the date.\n                        title: null,\n                        author: null,\n                        subject: null,\n                        keywords: null,\n                        creator: \"Kendo UI PDF Generator v.\" + kendo.version,\n                        // Creation Date; defaults to new Date()\n                        date: null\n                    },\n                    defaultCellStyle: {\n                        fontFamily: \"Arial\",\n                        fontSize: 12\n                    },\n                    useCultureDecimals: false\n                },\n\n                defineName: function(name, value, hidden) {\n                    return this._workbook.defineName(name, value, hidden);\n                },\n\n                undefineName: function(name) {\n                    return this._workbook.undefineName(name);\n                },\n\n                nameValue: function(name) {\n                    return this._workbook.nameValue(name);\n                },\n\n                forEachName: function(func) {\n                    return this._workbook.forEachName(func);\n                },\n\n                cellContextMenu: function() {\n                    return this._view.cellContextMenu;\n                },\n\n                rowHeaderContextMenu: function() {\n                    return this._view.rowHeaderContextMenu;\n                },\n\n                colHeaderContextMenu: function() {\n                    return this._view.colHeaderContextMenu;\n                },\n\n                addImage: function(image) {\n                    return this._workbook.addImage(image);\n                },\n\n                cleanupImages: function() {\n                    return this._workbook.cleanupImages();\n                },\n\n                events: [\n                    \"cut\",\n                    \"copy\",\n                    \"paste\",\n                    \"pdfExport\",\n                    \"excelExport\",\n                    \"excelImport\",\n                    \"changing\",\n                    \"change\",\n                    \"render\",\n                    \"removeSheet\",\n                    \"selectSheet\",\n                    \"renameSheet\",\n                    \"insertRow\",\n                    \"insertColumn\",\n                    \"deleteRow\",\n                    \"insertSheet\",\n                    \"deleteColumn\",\n                    \"hideRow\",\n                    \"hideColumn\",\n                    \"unhideRow\",\n                    \"unhideColumn\",\n                    \"select\",\n                    \"changeFormat\",\n                    \"dataBinding\",\n                    \"dataBound\"\n                ]\n            });\n\n            kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n            kendo.ui.plugin(Spreadsheet);\n            $.extend(true, Spreadsheet, { classNames: classNames });\n        })(window.kendo);\n        var kendo$1 = kendo;\n\n    return kendo$1;\n\n}));\n"]}